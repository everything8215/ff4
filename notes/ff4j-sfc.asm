
; +-------------------------------------------------------------------------+
; |                                                                         |
; |                            FINAL FANTASY IV                             |
; |                                                                         |
; +-------------------------------------------------------------------------+
; | file: ff4j-sfc.asm                                                      |
; |                                                                         |
; | description: rom disassembly                                            |
; |                                                                         |
; | created: 2/8/2020                                                       |
; |                                                                         |
; | author: everything8215@gmail.com                                        |
; +-------------------------------------------------------------------------+

; --------------------------------------------------------------------------

; [ program start ]

00/8000: 78           SEI 
00/8001: 18           CLC 
00/8002: FB           XCE 
00/8003: C2 10        REP #$10
00/8005: E2 20        SEP #$20
00/8007: 9C 0D 42     STZ $420D
00/800A: 9C 0B 42     STZ $420B
00/800D: 9C 0C 42     STZ $420C
00/8010: A9 8F        LDA #$8F
00/8012: 8D 00 21     STA $2100       ; screen off
00/8015: A9 00        LDA #$00
00/8017: 8D 00 42     STA $4200       ; disable nmi and irq
00/801A: A9 00        LDA #$00
00/801C: EB           XBA 
00/801D: A9 00        LDA #$00
00/801F: 48           PHA 
00/8020: AB           PLB 
00/8021: A2 00 06     LDX #$0600
00/8024: DA           PHX 
00/8025: 2B           PLD 
00/8026: A2 FF 02     LDX #$02FF
00/8029: 9A           TXS 
00/802A: 20 ED 89     JSR $89ED       ; init interrupt jump code
00/802D: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/8031: 22 AA C9 15  JSL $15C9AA     ; clear ram
00/8035: 22 00 80 04  JSL $048000     ; init sound/music
00/8039: 22 1C 80 01  JSL $01801C     ; init controller
00/803D: 20 FA 85     JSR $85FA       ; title screen
00/8040: 22 0C 80 01  JSL $01800C     ; game load menu
00/8044: AD EF 17     LDA $17EF       ; seed battle probability rng
00/8047: 18           CLC 
00/8048: 6D FF 0F     ADC $0FFF
00/804B: 8D EF 17     STA $17EF
00/804E: 0A           ASL 
00/804F: 8D EE 17     STA $17EE       ; seed battle index rng
00/8052: AD FB 17     LDA $17FB
00/8055: C9 00        CMP #$00
00/8057: D0 32        BNE $808B       ; branch if loading a saved game
; new game
00/8059: 20 90 82     JSR $8290       ; init new game
00/805C: 20 EE 94     JSR $94EE       ; init character properties
00/805F: 22 3E C2 15  JSL $15C23E     ; load initial spell lists
00/8063: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/8067: 20 02 83     JSR $8302       ; update player movement speed
00/806A: 20 32 F4     JSR $F432       ; init mode 7 hdma zoom data
00/806D: A9 01        LDA #$01        ; enable event
00/806F: 85 B1        STA $B1
00/8071: A9 01        LDA #$01        ; waiting for vblank
00/8073: 85 7D        STA $7D
00/8075: A9 0F        LDA #$0F        ; set screen brightness
00/8077: 85 80        STA $80
00/8079: A9 81        LDA #$81
00/807B: 8D 00 42     STA $4200       ; enable nmi
00/807E: 58           CLI 
00/807F: 64 AB        STZ $AB         ; clear player movement direction
00/8081: A9 10        LDA #$10        ; intro
00/8083: 20 EB E1     JSR $E1EB       ; execute event
00/8086: 64 B1        STZ $B1         ; no event
00/8088: 4C AF 80     JMP $80AF
; restore saved game
00/808B: 20 32 F4     JSR $F432       ; init mode 7 hdma zoom data
00/808E: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/8092: 20 02 83     JSR $8302       ; update player movement speed
00/8095: A9 01        LDA #$01
00/8097: 85 7D        STA $7D         ; waiting for vblank
00/8099: 64 DF        STZ $DF         ; dialogue window height: 0
00/809B: 64 B1        STZ $B1         ; no event
00/809D: 4C 13 83     JMP $8313       ; load map

; [ field main ]

00/80A0: 64 79        STZ $79         ; clear frame counters
00/80A2: 64 7A        STZ $7A
00/80A4: 64 7B        STZ $7B
00/80A6: A9 81        LDA #$81
00/80A8: 8D 00 42     STA $4200       ; enable nmi
00/80AB: 20 4B 91     JSR $914B       ; wait one frame
00/80AE: 58           CLI 
; start of main field loop
00/80AF: 20 2D 91     JSR $912D       ; wait for vblank
00/80B2: 64 E0        STZ $E0
00/80B4: 22 1D CA 15  JSL $15CA1D     ; reset controller inputs
00/80B8: 20 F4 81     JSR $81F4       ; check menu
00/80BB: A5 E0        LDA $E0
00/80BD: F0 03        BEQ $80C2
00/80BF: 4C AF 80     JMP $80AF
00/80C2: AD 00 17     LDA $1700
00/80C5: C9 03        CMP #$03
00/80C7: D0 03        BNE $80CC
00/80C9: 4C 38 81     JMP $8138
; world map
00/80CC: A9 07        LDA #$07
00/80CE: 8D 05 21     STA $2105
00/80D1: 20 34 9D     JSR $9D34       ; check triggers
00/80D4: A5 E0        LDA $E0
00/80D6: F0 03        BEQ $80DB
00/80D8: 4C AF 80     JMP $80AF
00/80DB: A5 CD        LDA $CD
00/80DD: F0 03        BEQ $80E2
00/80DF: 4C 13 83     JMP $8313       ; load map
00/80E2: 20 3C 8B     JSR $8B3C       ; update random battle
00/80E5: A5 85        LDA $85
00/80E7: F0 06        BEQ $80EF
00/80E9: 20 EB 88     JSR $88EB       ; battle (world map)
00/80EC: 4C 8E 80     JMP $808E
00/80EF: A5 E0        LDA $E0
00/80F1: F0 03        BEQ $80F6
00/80F3: 4C AF 80     JMP $80AF
00/80F6: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/80F9: A5 E0        LDA $E0
00/80FB: F0 06        BEQ $8103
00/80FD: 9C AB 06     STZ $06AB
00/8100: 4C AF 80     JMP $80AF
00/8103: 20 71 A8     JSR $A871       ; move player
00/8106: 20 77 91     JSR $9177       ; reset all sprites
00/8109: 20 C0 94     JSR $94C0       ; draw world map sprites
00/810C: 20 47 8E     JSR $8E47       ; update water/lava animation
00/810F: 22 4C C8 15  JSL $15C84C     ; update showing character
00/8113: A5 CE        LDA $CE
00/8115: D0 03        BNE $811A       ; branch if overworld/underground switch
00/8117: 4C AF 80     JMP $80AF
00/811A: 64 CE        STZ $CE
00/811C: AD 00 17     LDA $1700
00/811F: D0 06        BNE $8127
00/8121: 20 33 95     JSR $9533       ; travel from overworld to underground
00/8124: 4C A0 80     JMP $80A0
00/8127: C9 01        CMP #$01
00/8129: D0 06        BNE $8131
00/812B: 20 27 96     JSR $9627       ; travel from underground to overworld
00/812E: 4C A0 80     JMP $80A0
00/8131: C9 02        CMP #$02
00/8133: D0 00        BNE $8135
00/8135: 4C AF 80     JMP $80AF
; sub-map
00/8138: 20 CF 9B     JSR $9BCF       ; check triggers
00/813B: A5 CD        LDA $CD
00/813D: F0 03        BEQ $8142
00/813F: 4C 13 83     JMP $8313       ; load map
00/8142: 20 3C 8B     JSR $8B3C       ; update random battle
00/8145: A5 85        LDA $85
00/8147: F0 06        BEQ $814F       ; branch if no battle
00/8149: 20 18 89     JSR $8918       ; battle (sub-map)
00/814C: 4C 8E 80     JMP $808E
00/814F: 20 4C 98     JSR $984C       ; check treasures and npcs
00/8152: A5 85        LDA $85
00/8154: F0 06        BEQ $815C       ; branch if no battle
00/8156: 20 18 89     JSR $8918       ; battle (sub-map)
00/8159: 4C 8E 80     JMP $808E
00/815C: A5 E0        LDA $E0
00/815E: F0 03        BEQ $8163
00/8160: 4C AF 80     JMP $80AF
00/8163: 20 41 A9     JSR $A941       ; check player movement (sub-map)
00/8166: 20 0E BE     JSR $BE0E       ; check npc movement
00/8169: 20 71 A8     JSR $A871       ; move player
00/816C: 20 0C C0     JSR $C00C       ; move npcs
00/816F: 20 77 91     JSR $9177       ; reset all sprites
00/8172: 22 E0 B1 15  JSL $15B1E0     ; draw player sprite
00/8176: 20 68 BB     JSR $BB68       ; draw npcs
00/8179: 22 4C C8 15  JSL $15C84C     ; update showing character
00/817D: 20 C4 8A     JSR $8AC4       ; update cave animated water
00/8180: A5 D1        LDA $D1
00/8182: F0 6D        BEQ $81F1
00/8184: AE 2C 17     LDX $172C
00/8187: CA           DEX 
00/8188: CA           DEX 
00/8189: CA           DEX 
00/818A: 8E 2C 17     STX $172C
00/818D: BD 2E 17     LDA $172E,X
00/8190: C9 FB        CMP #$FB
00/8192: 90 03        BCC $8197
00/8194: 20 49 8D     JSR $8D49       ; fade out music (fast)
00/8197: 20 3F 92     JSR $923F
00/819A: 64 D6        STZ $D6
00/819C: BD 2E 17     LDA $172E,X
00/819F: 38           SEC 
00/81A0: E9 FB        SBC #$FB
00/81A2: 90 20        BCC $81C4
00/81A4: 8D 00 17     STA $1700
00/81A7: BD 2F 17     LDA $172F,X
00/81AA: 8D 06 17     STA $1706
00/81AD: A9 02        LDA #$02        ; face down
00/81AF: 8D 05 17     STA $1705
00/81B2: BD 30 17     LDA $1730,X
00/81B5: 8D 07 17     STA $1707
00/81B8: A2 00 00     LDX #$0000
00/81BB: 8E 2C 17     STX $172C
00/81BE: 20 49 8D     JSR $8D49       ; fade out music (fast)
00/81C1: 4C 13 83     JMP $8313       ; load map
00/81C4: A9 03        LDA #$03
00/81C6: 8D 00 17     STA $1700
00/81C9: BD 2E 17     LDA $172E,X
00/81CC: 8D 02 17     STA $1702
00/81CF: BD 2F 17     LDA $172F,X
00/81D2: 29 3F        AND #$3F
00/81D4: 8D 06 17     STA $1706
00/81D7: BD 2F 17     LDA $172F,X
00/81DA: 4A           LSR 
00/81DB: 4A           LSR 
00/81DC: 4A           LSR 
00/81DD: 4A           LSR 
00/81DE: 4A           LSR 
00/81DF: 4A           LSR 
00/81E0: 18           CLC 
00/81E1: 69 02        ADC #$02
00/81E3: 29 03        AND #$03
00/81E5: 8D 05 17     STA $1705       ; set facing direction
00/81E8: BD 30 17     LDA $1730,X
00/81EB: 8D 07 17     STA $1707
00/81EE: 4C 13 83     JMP $8313       ; load map
00/81F1: 4C AF 80     JMP $80AF

; [ check menu ]

00/81F4: A5 D5        LDA $D5
00/81F6: D0 01        BNE $81F9       ; return if player control is disabled
00/81F8: 60           RTS 
00/81F9: A5 50        LDA $50         ; return if X button was already processed
00/81FB: F0 03        BEQ $8200
00/81FD: 4C 8F 82     JMP $828F
00/8200: A5 02        LDA $02         ; return if X button is not pressed
00/8202: 29 40        AND #$40
00/8204: D0 03        BNE $8209
00/8206: 4C 8F 82     JMP $828F
00/8209: A9 01        LDA #$01
00/820B: 85 50        STA $50
00/820D: AD 00 17     LDA $1700
00/8210: C9 03        CMP #$03
00/8212: D0 0A        BNE $821E
00/8214: AD DB 0F     LDA $0FDB
00/8217: 29 30        AND #$30
00/8219: 09 80        ORA #$80
00/821B: 4C 2A 82     JMP $822A
00/821E: AD 04 17     LDA $1704
00/8221: D0 05        BNE $8228
00/8223: A9 40        LDA #$40
00/8225: 4C 2A 82     JMP $822A
00/8228: A9 00        LDA #$00
00/822A: 8D 04 1A     STA $1A04
00/822D: 20 08 8A     JSR $8A08       ; fade out for menu
00/8230: 22 00 80 01  JSL $018000     ; main menu
00/8234: AD 00 17     LDA $1700
00/8237: C9 03        CMP #$03
00/8239: D0 06        BNE $8241
00/823B: AE AA 16     LDX $16AA
00/823E: 8E DD 0C     STX $0CDD
00/8241: 20 11 8A     JSR $8A11       ; reload graphics after menu
00/8244: AD 03 1A     LDA $1A03
00/8247: F0 46        BEQ $828F       ; return if no menu event
00/8249: A9 01        LDA #$01
00/824B: 85 B1        STA $B1
00/824D: 64 AB        STZ $AB
00/824F: AD 03 1A     LDA $1A03       ; menu event
00/8252: C9 03        CMP #$03
00/8254: B0 09        BCS $825F       ; branch if not tent or cabin
00/8256: AD 03 1A     LDA $1A03
00/8259: 18           CLC 
00/825A: 69 76        ADC #$76
00/825C: 4C 87 82     JMP $8287
00/825F: C9 03        CMP #$03
00/8261: D0 05        BNE $8268
00/8263: A9 87        LDA #$87
00/8265: 4C 87 82     JMP $8287
00/8268: C9 04        CMP #$04
00/826A: D0 05        BNE $8271
00/826C: A9 86        LDA #$86
00/826E: 4C 87 82     JMP $8287
00/8271: C9 05        CMP #$05
00/8273: D0 05        BNE $827A
00/8275: A9 FB        LDA #$FB
00/8277: 4C 87 82     JMP $8287
00/827A: C9 06        CMP #$06
00/827C: D0 07        BNE $8285
00/827E: A9 01        LDA #$01
00/8280: 85 C0        STA $C0
00/8282: 4C 8A 82     JMP $828A
00/8285: A9 DB        LDA #$DB
00/8287: 20 EB E1     JSR $E1EB       ; execute event
00/828A: 64 B1        STZ $B1
00/828C: 20 5D 8D     JSR $8D5D       ; play map song
00/828F: 60           RTS 

; [ init new game ]

00/8290: 9C 00 17     STZ $1700
00/8293: 9C 01 17     STZ $1701
00/8296: 9C 03 17     STZ $1703
00/8299: 9C 0F 17     STZ $170F
00/829C: 9C 12 17     STZ $1712
00/829F: 9C 18 17     STZ $1718
00/82A2: 9C 1C 17     STZ $171C
00/82A5: 9C 20 17     STZ $1720
00/82A8: 9C 24 17     STZ $1724
00/82AB: 9C 28 17     STZ $1728
00/82AE: 9C 2B 17     STZ $172B
00/82B1: 9C 1B 17     STZ $171B
00/82B4: 9C 1F 17     STZ $171F
00/82B7: 9C 23 17     STZ $1723
00/82BA: 9C 27 17     STZ $1727
00/82BD: A2 00 00     LDX #$0000
00/82C0: 8E 2C 17     STX $172C
00/82C3: A2 00 00     LDX #$0000
00/82C6: BF 00 F2 12  LDA $12F200,X   ; initial npc switches
00/82CA: 9D E0 12     STA $12E0,X
00/82CD: E8           INX 
00/82CE: E0 40 00     CPX #$0040
00/82D1: D0 F3        BNE $82C6
00/82D3: A2 00 00     LDX #$0000
00/82D6: BF 40 F2 12  LDA $12F240,X   ; initial event switches
00/82DA: 9D 80 12     STA $1280,X
00/82DD: E8           INX 
00/82DE: E0 20 00     CPX #$0020
00/82E1: D0 F3        BNE $82D6
00/82E3: A2 00 00     LDX #$0000
00/82E6: 9E A0 12     STZ $12A0,X
00/82E9: E8           INX 
00/82EA: E0 20 00     CPX #$0020
00/82ED: D0 F7        BNE $82E6
00/82EF: A9 FE        LDA #$FE
00/82F1: 8D 9C 14     STA $149C
00/82F4: A9 FF        LDA #$FF
00/82F6: 8D 9E 14     STA $149E
00/82F9: A9 01        LDA #$01
00/82FB: 8D 9D 14     STA $149D
00/82FE: 8D 9F 14     STA $149F
00/8301: 60           RTS 

; [ update player movement speed ]

00/8302: AD 04 17     LDA $1704       ; vehicle id
00/8305: AA           TAX 
00/8306: BD 0C 83     LDA $830C,X     ; movement speed
00/8309: 85 AC        STA $AC
00/830B: 60           RTS 

; movement speed for each vehicle
00/830C: 00 01 02 01 03 03 03

; [ load map ]

00/8313: AD 00 17     LDA $1700
00/8316: D0 09        BNE $8321
; 0: overworld
00/8318: 20 02 85     JSR $8502       ; load overworld
00/831B: 20 69 92     JSR $9269       ; screen wipe (in)
00/831E: 4C A0 80     JMP $80A0
; 1: underground
00/8321: C9 01        CMP #$01
00/8323: D0 09        BNE $832E
00/8325: 20 3C 85     JSR $853C       ; load underground
00/8328: 20 69 92     JSR $9269       ; screen wipe (in)
00/832B: 4C A0 80     JMP $80A0
; 2: moon
00/832E: C9 02        CMP #$02
00/8330: D0 09        BNE $833B
00/8332: 20 74 85     JSR $8574       ; load moon
00/8335: 20 69 92     JSR $9269       ; screen wipe (in)
00/8338: 4C A0 80     JMP $80A0
; sub-map
00/833B: A5 85        LDA $85
00/833D: F0 06        BEQ $8345
00/833F: 20 52 84     JSR $8452       ; reload sub-map
00/8342: 4C 48 83     JMP $8348
00/8345: 20 A4 83     JSR $83A4       ; load sub-map
00/8348: 20 69 92     JSR $9269       ; screen wipe (in)
00/834B: 4C A0 80     JMP $80A0

; [ init map ram ]

00/834E: A9 80        LDA #$80
00/8350: 8D 00 21     STA $2100       ; screen off
00/8353: 9C 0C 42     STZ $420C
00/8356: 9C 00 42     STZ $4200       ; disable nmi and irq
00/8359: 78           SEI 
00/835A: 20 77 91     JSR $9177       ; reset all sprites
00/835D: 64 7A        STZ $7A         ; animation frame counter
00/835F: 64 94        STZ $94
00/8361: 64 EB        STZ $EB
00/8363: 64 E9        STZ $E9
00/8365: 64 EB        STZ $EB
00/8367: 64 EC        STZ $EC
00/8369: 64 ED        STZ $ED
00/836B: 64 EA        STZ $EA         ; show map name
00/836D: 64 E7        STZ $E7
00/836F: 64 E8        STZ $E8
00/8371: 64 D4        STZ $D4
00/8373: 64 AB        STZ $AB
00/8375: 64 CF        STZ $CF
00/8377: 64 DA        STZ $DA
00/8379: 64 C9        STZ $C9
00/837B: 64 C4        STZ $C4
00/837D: 64 C1        STZ $C1
00/837F: A9 01        LDA #$01
00/8381: 85 54        STA $54
00/8383: 85 55        STA $55
00/8385: 85 50        STA $50
00/8387: 85 51        STA $51
00/8389: 85 52        STA $52
00/838B: 85 53        STA $53
00/838D: 85 56        STA $56
00/838F: 85 57        STA $57
00/8391: 64 66        STZ $66
00/8393: 64 67        STZ $67
00/8395: 64 68        STZ $68
00/8397: 64 69        STZ $69
00/8399: A9 10        LDA #$10
00/839B: 85 AD        STA $AD         ; mode 7 zoom level
00/839D: A2 00 00     LDX #$0000
00/83A0: 8E FB 06     STX $06FB       ; mode 7 rotation angle
00/83A3: 60           RTS 

; [ load sub-map ]

00/83A4: 20 4E 83     JSR $834E       ; init map ram
00/83A7: 20 DB 85     JSR $85DB       ; remove float
00/83AA: 64 AC        STZ $AC
00/83AC: AD 02 17     LDA $1702
00/83AF: 85 18        STA $18
00/83B1: 64 19        STZ $19
00/83B3: AD 01 17     LDA $1701
00/83B6: F0 02        BEQ $83BA
00/83B8: E6 19        INC $19
00/83BA: 06 18        ASL $18
00/83BC: 26 19        ROL $19
00/83BE: 06 18        ASL $18
00/83C0: 26 19        ROL $19
00/83C2: A6 18        LDX $18
00/83C4: 86 1A        STX $1A
00/83C6: 06 18        ASL $18
00/83C8: 26 19        ROL $19
00/83CA: A5 18        LDA $18
00/83CC: 18           CLC 
00/83CD: 65 1A        ADC $1A
00/83CF: 85 18        STA $18
00/83D1: A5 19        LDA $19
00/83D3: 65 1B        ADC $1B
00/83D5: 85 19        STA $19
00/83D7: A5 18        LDA $18
00/83D9: 18           CLC 
00/83DA: 6D 02 17     ADC $1702
00/83DD: 85 18        STA $18
00/83DF: AD 01 17     LDA $1701
00/83E2: F0 02        BEQ $83E6
00/83E4: A9 01        LDA #$01
00/83E6: 65 19        ADC $19
00/83E8: 85 19        STA $19
00/83EA: A6 18        LDX $18
00/83EC: A0 00 00     LDY #$0000
00/83EF: BF 84 9C 15  LDA $159C84,X   ; map properties
00/83F3: 99 DB 0F     STA $0FDB,Y
00/83F6: E8           INX 
00/83F7: C8           INY 
00/83F8: C0 0D 00     CPY #$000D
00/83FB: D0 F2        BNE $83EF
00/83FD: BF 90 9C 15  LDA $159C90,X   ; next map's treasure offset
00/8401: 38           SEC 
00/8402: ED E7 0F     SBC $0FE7       ; subtract treasure offset
00/8405: 8D 11 07     STA $0711       ; number of treasures
00/8408: AD DC 0F     LDA $0FDC
00/840B: 8D F9 06     STA $06F9
00/840E: AD DD 0F     LDA $0FDD
00/8411: 85 19        STA $19
00/8413: 64 18        STZ $18
00/8415: A6 18        LDX $18
00/8417: A0 00 00     LDY #$0000
00/841A: BF 00 8E 14  LDA $148E00,X
00/841E: 99 DB 0E     STA $0EDB,Y
00/8421: E8           INX 
00/8422: C8           INY 
00/8423: C0 00 01     CPY #$0100
00/8426: D0 F2        BNE $841A
00/8428: AD DD 0F     LDA $0FDD
00/842B: 0A           ASL 
00/842C: 0A           ASL 
00/842D: 85 19        STA $19
00/842F: 64 18        STZ $18
00/8431: A6 18        LDX $18
00/8433: A9 7F        LDA #$7F
00/8435: 48           PHA 
00/8436: AB           PLB 
00/8437: A0 00 00     LDY #$0000
00/843A: BF 00 9E 14  LDA $149E00,X   ; map tilesets
00/843E: 99 00 48     STA $4800,Y
00/8441: E8           INX 
00/8442: C8           INY 
00/8443: C0 00 04     CPY #$0400
00/8446: D0 F2        BNE $843A
00/8448: A9 00        LDA #$00
00/844A: 48           PHA 
00/844B: AB           PLB 
00/844C: 20 94 FA     JSR $FA94
00/844F: 20 41 C1     JSR $C141       ; init npcs
; fallthrough

; [ reload sub-map ]

00/8452: 20 4E 83     JSR $834E       ; init map ram
00/8455: A9 17        LDA #$17
00/8457: 8D 2C 21     STA $212C
00/845A: A9 09        LDA #$09
00/845C: 8D 05 21     STA $2105
00/845F: 22 26 C2 15  JSL $15C226     ; load text window palette
00/8463: A2 00 20     LDX #$2000
00/8466: 86 47        STX $47
00/8468: A2 00 10     LDX #$1000
00/846B: 86 45        STX $45
00/846D: A9 0A        LDA #$0A
00/846F: 85 3C        STA $3C
00/8471: A2 00 F0     LDX #$F000
00/8474: 86 3D        STX $3D
00/8476: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/847A: A2 00 28     LDX #$2800
00/847D: 86 47        STX $47
00/847F: A2 00 10     LDX #$1000
00/8482: 86 45        STX $45
00/8484: 64 76        STZ $76
00/8486: 22 B1 CA 15  JSL $15CAB1     ; clear vram
00/848A: 22 88 B0 15  JSL $15B088     ; load map bg graphics
00/848E: AD DF 0F     LDA $0FDF
00/8491: 29 7F        AND #$7F
00/8493: 20 25 F6     JSR $F625       ; clear bg tilemap
00/8496: 22 F9 C1 15  JSL $15C1F9     ; load map palette
00/849A: 22 D5 C6 15  JSL $15C6D5     ; invert map palette
00/849E: A5 85        LDA $85
00/84A0: D0 07        BNE $84A9       ; branch if returning from a battle
00/84A2: A5 B1        LDA $B1
00/84A4: D0 03        BNE $84A9       ; branch if an event is running
00/84A6: 20 D7 B8     JSR $B8D7       ; load map name
00/84A9: 64 D1        STZ $D1
00/84AB: 64 85        STZ $85         ; disable battle
00/84AD: A5 B1        LDA $B1
00/84AF: D0 03        BNE $84B4
00/84B1: 20 5D 8D     JSR $8D5D       ; play map song
00/84B4: A5 81        LDA $81
00/84B6: D0 21        BNE $84D9
00/84B8: A9 11        LDA #$11
00/84BA: 8D 2D 21     STA $212D
00/84BD: AD E4 0F     LDA $0FE4
00/84C0: 4A           LSR 
00/84C1: 90 0D        BCC $84D0
00/84C3: A9 02        LDA #$02
00/84C5: 8D 30 21     STA $2130
00/84C8: A9 43        LDA #$43
00/84CA: 8D 31 21     STA $2131
00/84CD: 4C EA 84     JMP $84EA
00/84D0: 9C 30 21     STZ $2130
00/84D3: 9C 31 21     STZ $2131
00/84D6: 4C EA 84     JMP $84EA
00/84D9: 9C 2D 21     STZ $212D
00/84DC: A9 83        LDA #$83
00/84DE: 8D 31 21     STA $2131
00/84E1: A5 83        LDA $83
00/84E3: 29 E0        AND #$E0
00/84E5: 05 81        ORA $81
00/84E7: 8D 32 21     STA $2132
00/84EA: 20 49 FB     JSR $FB49       ; init bg2 tilemap
00/84ED: 20 94 FA     JSR $FA94       ; init bg1 tilemap
00/84F0: 22 01 CB 15  JSL $15CB01
00/84F4: 20 5E 8A     JSR $8A5E       ; load cave water graphics
00/84F7: 22 5F CB 15  JSL $15CB5F     ; transfer bg animation graphics to vram
00/84FB: 20 A2 97     JSR $97A2       ; load sprite graphics (sub-map)
00/84FE: 20 33 F5     JSR $F533       ; update bg2 scroll
00/8501: 60           RTS 

; [ load overworld ]

00/8502: 20 4E 83     JSR $834E       ; init map ram
00/8505: 20 AB 85     JSR $85AB       ; init world map
00/8508: 9C 01 17     STZ $1701
00/850B: 9C FA 06     STZ $06FA
00/850E: 20 69 8F     JSR $8F69       ; transfer overworld water graphics from vram
00/8511: A9 14        LDA #$14
00/8513: A2 00 89     LDX #$8900
00/8516: 20 B3 91     JSR $91B3       ; load world map palette
00/8519: A9 14        LDA #$14
00/851B: A0 00 80     LDY #$8000
00/851E: 20 0D F6     JSR $F60D       ; load world tileset
00/8521: A2 00 00     LDX #$0000
00/8524: BF 80 8A 14  LDA $148A80,X
00/8528: 9D DB 0E     STA $0EDB,X
00/852B: E8           INX 
00/852C: E0 00 01     CPX #$0100
00/852F: D0 F3        BNE $8524
00/8531: 20 92 97     JSR $9792       ; load sprite graphics (world map)
00/8534: 20 71 F9     JSR $F971
00/8537: 22 63 C1 15  JSL $15C163     ; update mode 7 zoom hdma table
00/853B: 60           RTS 

; [ load underground ]

00/853C: 20 4E 83     JSR $834E       ; init map ram
00/853F: 20 AB 85     JSR $85AB       ; init world map
00/8542: A9 01        LDA #$01
00/8544: 8D 01 17     STA $1701
00/8547: 9C FA 06     STZ $06FA
00/854A: 20 C4 8E     JSR $8EC4       ; transfer underground lava graphics from vram
00/854D: A9 14        LDA #$14
00/854F: A2 80 89     LDX #$8980
00/8552: 20 B3 91     JSR $91B3       ; load world map palette
00/8555: A9 14        LDA #$14
00/8557: A0 00 82     LDY #$8200
00/855A: 20 0D F6     JSR $F60D       ; load world tileset
00/855D: A2 00 00     LDX #$0000
00/8560: BF 80 8B 14  LDA $148B80,X
00/8564: 9D DB 0E     STA $0EDB,X
00/8567: E8           INX 
00/8568: E0 00 01     CPX #$0100
00/856B: D0 F3        BNE $8560
00/856D: 20 92 97     JSR $9792       ; load sprite graphics (world map)
00/8570: 20 71 F9     JSR $F971
00/8573: 60           RTS 

; [ load moon ]

00/8574: 20 4E 83     JSR $834E       ; init map ram
00/8577: 20 AB 85     JSR $85AB       ; init world map
00/857A: A9 02        LDA #$02
00/857C: 8D 01 17     STA $1701
00/857F: A9 02        LDA #$02
00/8581: 8D FA 06     STA $06FA
00/8584: A9 14        LDA #$14
00/8586: A2 00 8A     LDX #$8A00
00/8589: 20 B3 91     JSR $91B3       ; load world map palette
00/858C: A9 14        LDA #$14
00/858E: A0 00 84     LDY #$8400
00/8591: 20 0D F6     JSR $F60D       ; load world tileset
00/8594: A2 00 00     LDX #$0000
00/8597: BF 80 8C 14  LDA $148C80,X
00/859B: 9D DB 0E     STA $0EDB,X
00/859E: E8           INX 
00/859F: E0 00 01     CPX #$0100
00/85A2: D0 F3        BNE $8597
00/85A4: 20 92 97     JSR $9792       ; load sprite graphics (world map)
00/85A7: 20 71 F9     JSR $F971
00/85AA: 60           RTS 

; [ init world map ]

00/85AB: 20 DB 85     JSR $85DB       ; remove float
00/85AE: 64 D1        STZ $D1
00/85B0: A5 85        LDA $85
00/85B2: D0 05        BNE $85B9       ; branch if returning from a battle
00/85B4: A9 02        LDA #$02
00/85B6: 8D 05 17     STA $1705       ; face down
00/85B9: 64 85        STZ $85         ; disable battle
00/85BB: A9 07        LDA #$07        ; bg mode 7
00/85BD: 8D 05 21     STA $2105
00/85C0: A9 11        LDA #$11        ; enable sprites and bg1
00/85C2: 8D 2C 21     STA $212C
00/85C5: 9C 30 21     STZ $2130       ; disable color math
00/85C8: 9C 31 21     STZ $2131
00/85CB: A5 B1        LDA $B1
00/85CD: D0 03        BNE $85D2
00/85CF: 20 5D 8D     JSR $8D5D       ; play map song
00/85D2: 22 81 B1 15  JSL $15B181     ; transfer world map graphics to vram
00/85D6: 22 D5 C6 15  JSL $15C6D5     ; invert map palette
00/85DA: 60           RTS 

; [ remove float ]

00/85DB: A2 00 00     LDX #$0000
00/85DE: BD 04 10     LDA $1004,X     ; clear float status
00/85E1: 29 BF        AND #$BF
00/85E3: 9D 04 10     STA $1004,X
00/85E6: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/85E9: E0 40 01     CPX #$0140
00/85EC: D0 F0        BNE $85DE
00/85EE: 60           RTS 

; [ screen off ]

00/85EF: A9 80        LDA #$80
00/85F1: 8D 00 21     STA $2100       ; screen off
00/85F4: A9 00        LDA #$00
00/85F6: 8D 00 42     STA $4200       ; disable nmi and irq
00/85F9: 60           RTS 

; --------------------------------------------------------------------------

; [ title screen ]

00/85FA: 20 EF 85     JSR $85EF       ; screen off
00/85FD: 9C 0B 42     STZ $420B
00/8600: 9C 0C 42     STZ $420C
00/8603: A9 01        LDA #$01
00/8605: 8D 00 1E     STA $1E00
00/8608: A9 15        LDA #$15        ; play song $15 (the prelude)
00/860A: 8D 01 1E     STA $1E01
00/860D: 22 04 80 04  JSL $048004     ; execute sound command
00/8611: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/8615: A9 03        LDA #$03
00/8617: 8D 00 17     STA $1700
00/861A: A9 13        LDA #$13
00/861C: 8D 2C 21     STA $212C
00/861F: A9 02        LDA #$02
00/8621: 8D 2D 21     STA $212D
00/8624: 8D 30 21     STA $2130
00/8627: A9 43        LDA #$43
00/8629: 8D 31 21     STA $2131
00/862C: A9 01        LDA #$01
00/862E: 8D 05 21     STA $2105
00/8631: 20 77 91     JSR $9177       ; reset all sprites
00/8634: 20 3D 88     JSR $883D       ; load title screen bg graphics
00/8637: A9 80        LDA #$80
00/8639: 8D 15 21     STA $2115
00/863C: A2 00 18     LDX #$1800      ; clear $1800-$3FFF (all tilemaps)
00/863F: 8E 16 21     STX $2116
00/8642: A9 DF        LDA #$DF        ; use tile $DF, palette 0 (black)
00/8644: 8D 18 21     STA $2118
00/8647: 9C 19 21     STZ $2119
00/864A: E8           INX 
00/864B: E0 00 40     CPX #$4000
00/864E: D0 F2        BNE $8642
00/8650: A2 80 18     LDX #$1880      ; load title screen tilemap
00/8653: 86 47        STX $47
00/8655: A2 80 01     LDX #$0180
00/8658: 86 45        STX $45
00/865A: A2 00 E8     LDX #$E800      ; 08/E800 (title screen bg1 tilemap)
00/865D: 86 3D        STX $3D
00/865F: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/8663: A2 80 30     LDX #$3080
00/8666: 86 47        STX $47
00/8668: A2 80 E9     LDX #$E980      ; 08/E980 (title screen bg2 tilemap)
00/866B: 86 3D        STX $3D
00/866D: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/8671: A2 00 00     LDX #$0000      ; load title screen copyright sprite data
00/8674: BF AA 88 00  LDA $0088AA,X
00/8678: 9D 00 03     STA $0300,X
00/867B: E8           INX 
00/867C: E0 24 00     CPX #$0024
00/867F: D0 F3        BNE $8674
00/8681: A0 00 00     LDY #$0000
00/8684: A2 00 EB     LDX #$EB00      ; 08/EB00 (title screen crystal tilemap)
00/8687: 86 3D        STX $3D
00/8689: B9 CE 88     LDA $88CE,Y
00/868C: 85 47        STA $47
00/868E: B9 CF 88     LDA $88CF,Y
00/8691: 85 48        STA $48
00/8693: 20 5E 88     JSR $885E       ; transfer title screen crystal tilemap to vram
00/8696: C0 14 00     CPY #$0014
00/8699: D0 EE        BNE $8689
00/869B: A0 00 00     LDY #$0000
00/869E: A2 50 EB     LDX #$EB50      ; 08/EB50
00/86A1: 86 3D        STX $3D
00/86A3: B9 CE 88     LDA $88CE,Y
00/86A6: 85 47        STA $47
00/86A8: B9 CF 88     LDA $88CF,Y
00/86AB: 18           CLC 
00/86AC: 69 18        ADC #$18
00/86AE: 85 48        STA $48
00/86B0: 20 5E 88     JSR $885E       ; transfer title screen crystal tilemap to vram
00/86B3: C0 14 00     CPY #$0014
00/86B6: D0 EB        BNE $86A3
00/86B8: A2 00 00     LDX #$0000      ; clear color palettes
00/86BB: 9E DB 0C     STZ $0CDB,X
00/86BE: E8           INX 
00/86BF: E0 00 02     CPX #$0200
00/86C2: D0 F7        BNE $86BB
00/86C4: 22 5E CA 15  JSL $15CA5E     ; transfer palettes to ppu
00/86C8: A2 60 00     LDX #$0060
00/86CB: 8E 6D 0A     STX $0A6D
00/86CE: A2 68 00     LDX #$0068
00/86D1: 8E 6F 0A     STX $0A6F
00/86D4: 8E 73 0A     STX $0A73
00/86D7: A2 48 00     LDX #$0048
00/86DA: 8E 71 0A     STX $0A71
00/86DD: A2 00 00     LDX #$0000
00/86E0: 86 5A        STX $5A
00/86E2: 86 5C        STX $5C
00/86E4: E8           INX 
00/86E5: 86 5E        STX $5E
00/86E7: A2 FF FF     LDX #$FFFF
00/86EA: 86 60        STX $60
00/86EC: A9 01        LDA #$01
00/86EE: 85 54        STA $54
00/86F0: 64 7A        STZ $7A
00/86F2: A9 01        LDA #$01
00/86F4: 85 7E        STA $7E
00/86F6: A9 0F        LDA #$0F
00/86F8: 8D 00 21     STA $2100       ; screen on, full brightness
00/86FB: A9 81        LDA #$81
00/86FD: 8D 00 42     STA $4200       ; enable nmi
; start of frame loop (fade in)
00/8700: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/8703: E6 7E        INC $7E
00/8705: A5 02        LDA $02
00/8707: 29 80        AND #$80
00/8709: D0 05        BNE $8710       ; branch if A button is pressed
00/870B: 64 54        STZ $54
00/870D: 4C 17 87     JMP $8717
00/8710: A5 54        LDA $54
00/8712: D0 03        BNE $8717
00/8714: 4C 34 88     JMP $8834
00/8717: A5 7A        LDA $7A
00/8719: 29 07        AND #$07
00/871B: D0 E3        BNE $8700
00/871D: A9 10        LDA #$10        ; copy 16 colors
00/871F: 85 07        STA $07
00/8721: A0 20 00     LDY #$0020
00/8724: AE 6D 0A     LDX $0A6D
00/8727: E0 20 00     CPX #$0020
00/872A: B0 0D        BCS $8739
00/872C: C2 20        REP #$20
00/872E: BF 20 EC 08  LDA $08EC20,X   ; title screen color palette
00/8732: 99 FB 0C     STA $0CFB,Y
00/8735: 7B           TDC 
00/8736: EB           XBA 
00/8737: E2 20        SEP #$20
00/8739: 88           DEY 
00/873A: 88           DEY 
00/873B: CA           DEX 
00/873C: CA           DEX 
00/873D: C6 07        DEC $07
00/873F: D0 E6        BNE $8727
00/8741: AE 6D 0A     LDX $0A6D
00/8744: E0 20 00     CPX #$0020
00/8747: F0 05        BEQ $874E
00/8749: CA           DEX 
00/874A: CA           DEX 
00/874B: 8E 6D 0A     STX $0A6D
00/874E: A9 10        LDA #$10        ; copy 16 colors
00/8750: 85 07        STA $07
00/8752: A0 20 00     LDY #$0020
00/8755: AE 6F 0A     LDX $0A6F
00/8758: E0 20 00     CPX #$0020
00/875B: B0 0D        BCS $876A
00/875D: C2 20        REP #$20
00/875F: BF 40 EC 08  LDA $08EC40,X   ; title screen color palette
00/8763: 99 1B 0D     STA $0D1B,Y
00/8766: 7B           TDC 
00/8767: EB           XBA 
00/8768: E2 20        SEP #$20
00/876A: CA           DEX 
00/876B: CA           DEX 
00/876C: 88           DEY 
00/876D: 88           DEY 
00/876E: C6 07        DEC $07
00/8770: D0 E6        BNE $8758
00/8772: AE 6F 0A     LDX $0A6F
00/8775: E0 20 00     CPX #$0020
00/8778: F0 36        BEQ $87B0
00/877A: CA           DEX 
00/877B: CA           DEX 
00/877C: 8E 6F 0A     STX $0A6F
00/877F: A9 10        LDA #$10        ; copy 16 colors
00/8781: 85 07        STA $07
00/8783: A0 20 00     LDY #$0020
00/8786: AE 71 0A     LDX $0A71
00/8789: E0 20 00     CPX #$0020
00/878C: B0 0D        BCS $879B
00/878E: C2 20        REP #$20
00/8790: BF 60 EC 08  LDA $08EC60,X   ; title screen color palette
00/8794: 99 3B 0D     STA $0D3B,Y
00/8797: 7B           TDC 
00/8798: EB           XBA 
00/8799: E2 20        SEP #$20
00/879B: CA           DEX 
00/879C: CA           DEX 
00/879D: 88           DEY 
00/879E: 88           DEY 
00/879F: C6 07        DEC $07
00/87A1: D0 E6        BNE $8789
00/87A3: AE 71 0A     LDX $0A71
00/87A6: E0 20 00     CPX #$0020
00/87A9: F0 05        BEQ $87B0
00/87AB: CA           DEX 
00/87AC: CA           DEX 
00/87AD: 8E 71 0A     STX $0A71
00/87B0: AE 73 0A     LDX $0A73
00/87B3: E0 20 00     CPX #$0020
00/87B6: B0 1C        BCS $87D4
00/87B8: 8A           TXA 
00/87B9: 4A           LSR 
00/87BA: 29 FE        AND #$FE
00/87BC: AA           TAX 
00/87BD: C2 20        REP #$20
00/87BF: BF E6 FC 14  LDA $14FCE6,X   ; sprite colors
00/87C3: 8D DD 0D     STA $0DDD       ; color 1 is white
00/87C6: BF E6 FC 14  LDA $14FCE6,X
00/87CA: 29 1F 00     AND #$001F
00/87CD: 8D DF 0D     STA $0DDF       ; color 2 is red
00/87D0: 7B           TDC 
00/87D1: EB           XBA 
00/87D2: E2 20        SEP #$20
00/87D4: AE 73 0A     LDX $0A73
00/87D7: CA           DEX 
00/87D8: CA           DEX 
00/87D9: 8E 73 0A     STX $0A73
00/87DC: F0 03        BEQ $87E1
00/87DE: 4C 00 87     JMP $8700
00/87E1: A2 00 00     LDX #$0000
00/87E4: BD FB 0C     LDA $0CFB,X
00/87E7: 9D 6D 0A     STA $0A6D,X
00/87EA: E8           INX 
00/87EB: E0 60 00     CPX #$0060
00/87EE: D0 F4        BNE $87E4
00/87F0: 64 7A        STZ $7A
; start of frame loop (sparkle)
00/87F2: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/87F5: E6 7E        INC $7E
00/87F7: A5 02        LDA $02
00/87F9: 29 80        AND #$80
00/87FB: D0 05        BNE $8802       ; branch if A button is pressed
00/87FD: 64 54        STZ $54
00/87FF: 4C 09 88     JMP $8809
00/8802: A5 54        LDA $54
00/8804: D0 03        BNE $8809
00/8806: 4C 34 88     JMP $8834
00/8809: A2 00 00     LDX #$0000
00/880C: BD 6D 0A     LDA $0A6D,X     ; revert color palettes
00/880F: 9D FB 0C     STA $0CFB,X
00/8812: E8           INX 
00/8813: E0 60 00     CPX #$0060
00/8816: D0 F4        BNE $880C
00/8818: A5 7A        LDA $7A
00/881A: 4A           LSR 
00/881B: 29 7E        AND #$7E
00/881D: C9 16        CMP #$16
00/881F: B0 D1        BCS $87F2
00/8821: A8           TAY 
00/8822: C2 20        REP #$20
00/8824: A9 FF FF     LDA #$FFFF      ; change a color to white (sparkle)
00/8827: 99 3D 0D     STA $0D3D,Y
00/882A: 99 FD 0C     STA $0CFD,Y
00/882D: 7B           TDC 
00/882E: EB           XBA 
00/882F: E2 20        SEP #$20
00/8831: 4C F2 87     JMP $87F2
00/8834: A9 00        LDA #$00
00/8836: 20 D1 8D     JSR $8DD1       ; fade out
00/8839: 20 EF 85     JSR $85EF       ; screen off
00/883C: 60           RTS 

; [ load title screen bg graphics ]

00/883D: A2 00 00     LDX #$0000
00/8840: 86 47        STX $47
00/8842: A2 00 28     LDX #$2800      ; size: $2800 bytes
00/8845: 86 45        STX $45
00/8847: A9 08        LDA #$08
00/8849: 85 3C        STA $3C
00/884B: A2 00 C0     LDX #$C000      ; 08/C000 (title screen bg graphics)
00/884E: 86 3D        STX $3D
00/8850: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/8854: A2 00 40     LDX #$4000
00/8857: 86 47        STX $47
00/8859: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/885D: 60           RTS 

; [ transfer title screen crystal tilemap to vram ]

; transfer 1 row of crystal (4 tiles)

00/885E: A9 80        LDA #$80
00/8860: 8D 15 21     STA $2115
00/8863: A6 47        LDX $47
00/8865: 8E 16 21     STX $2116
00/8868: A6 3D        LDX $3D
00/886A: BF 00 00 08  LDA $080000,X
00/886E: 8D 18 21     STA $2118
00/8871: BF 01 00 08  LDA $080001,X
00/8875: 8D 19 21     STA $2119
00/8878: E8           INX 
00/8879: E8           INX 
00/887A: 8A           TXA 
00/887B: 29 07        AND #$07
00/887D: D0 EB        BNE $886A
00/887F: C2 20        REP #$20
00/8881: A5 3D        LDA $3D
00/8883: 18           CLC 
00/8884: 69 08 00     ADC #$0008
00/8887: 85 3D        STA $3D
00/8889: 7B           TDC 
00/888A: EB           XBA 
00/888B: E2 20        SEP #$20
00/888D: C8           INY 
00/888E: C8           INY 
00/888F: 60           RTS 

; [  ]

00/8890: 85 76        STA $76
00/8892: A2 00 18     LDX #$1800
00/8895: 86 47        STX $47
00/8897: A2 00 10     LDX #$1000
00/889A: 86 45        STX $45
00/889C: 22 B1 CA 15  JSL $15CAB1     ; clear vram
00/88A0: A2 00 30     LDX #$3000
00/88A3: 86 47        STX $47
00/88A5: 22 B1 CA 15  JSL $15CAB1     ; clear vram
00/88A9: 60           RTS 

; sprite data for copyright
00/88AA: 58 CC 213C
00/88AE: 60 CC 213D
00/88B2: 68 CC 213E
00/88B6: 78 CC 2008
00/88BA: 80 CC 2018
00/88BE: 88 CC 2028
00/88C2: 90 CC 206C
00/88C6: 98 CC 207C
00/88CA: A0 CC 208C

; vram location for crystal tilemap (10 rows)
00/88CE: 19CE 19EE 1A0E 1A2E 1A4E 1A6E 1A8E 1AAE
00/88DE: 1ACE 1AEE

; --------------------------------------------------------------------------

; [ next sprite ]

00/88E2: E8           INX 
00/88E3: E8           INX 
00/88E4: E8           INX 
00/88E5: E8           INX 
00/88E6: C8           INY 
00/88E7: C8           INY 
00/88E8: C8           INY 
00/88E9: C8           INY 
00/88EA: 60           RTS 

; [ battle (world map) ]

00/88EB: A9 3F        LDA #$3F
00/88ED: 20 99 8D     JSR $8D99       ; play sound effect
00/88F0: A9 01        LDA #$01
00/88F2: 8D 2C 21     STA $212C       ; main screen only (hide sprites)
00/88F5: 64 79        STZ $79
00/88F7: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/88FA: 9C 0C 42     STZ $420C
00/88FD: A5 79        LDA $79
00/88FF: AA           TAX 
00/8900: BF 5E FB 14  LDA $14FB5E,X   ; world map battle effect zoom values
00/8904: 85 AD        STA $AD
00/8906: 20 BA 90     JSR $90BA       ; calculate mode 7 rotation parameters
00/8909: 20 04 91     JSR $9104       ; update mode 7 registers
00/890C: E6 79        INC $79
00/890E: A5 79        LDA $79
00/8910: C9 28        CMP #$28
00/8912: D0 E3        BNE $88F7
00/8914: 20 59 89     JSR $8959       ; battle
00/8917: 60           RTS 

; [ battle (sub-map) ]

00/8918: A9 3F        LDA #$3F
00/891A: 20 99 8D     JSR $8D99       ; play sound effect
00/891D: A9 03        LDA #$03
00/891F: 8D 2C 21     STA $212C       ; bg1 and bg2 only (hide sprites)
00/8922: 64 79        STZ $79
00/8924: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/8927: A5 79        LDA $79
00/8929: 4A           LSR 
00/892A: AA           TAX 
00/892B: BD 44 89     LDA $8944,X
00/892E: 8D 06 21     STA $2106
00/8931: E6 79        INC $79
00/8933: A5 79        LDA $79
00/8935: C9 2A        CMP #$2A
00/8937: D0 EB        BNE $8924
00/8939: A5 C6        LDA $C6
00/893B: D0 03        BNE $8940
00/893D: 20 B5 8C     JSR $8CB5       ; update battle parameters
00/8940: 20 59 89     JSR $8959       ; battle
00/8943: 60           RTS 

; screen pixelation data for battle blur -> $2106
00/8944: 03 23 43 63 43 23 03 23 43 63 43 23 03 23 43 63
00/8954: 83 A3 C3 E3 F3

; [ battle ]

; there is a bug in v1.0 described here:
; https://tcrf.net/Final_Fantasy_IV_(SNES,_PlayStation)/Version_Differences

00/8959: AE 00 18     LDX $1800
00/895C: E0 B7 01     CPX #$01B7
00/895F: 90 0A        BCC $896B
00/8961: E0 B9 01     CPX #$01B9
00/8964: B0 05        BCS $896B
00/8966: A9 10        LDA #$10        ; use final battle bg
00/8968: 8D 02 18     STA $1802
; *** v1.0 ***
00/896B: AD 01 17     LDA $1701
00/896E: C9 01        CMP #$01
00/8970: D0 21        BNE $8993       ; branch if not an underground/moon map
; *** v1.1 ***
00/896B: AD 00 17     LDA $1700
00/896E: C9 03        CMP #$03
00/8970: D0 21        BNE $8993       ; branch if not a sub-map
00/----: AD 01 17     LDA $1701
00/----: F0 1E        BEQ $8993       ; branch if on overworld
; ************
00/8972: AD 02 17     LDA $1702
00/8975: C9 5A        CMP #$5A        ; cave bahamut maps
00/8977: 90 07        BCC $8980
00/8979: C9 5D        CMP #$5D
00/897B: B0 03        BCS $8980
00/897D: 4C 8B 89     JMP $898B
; *** removed in v1.1 ***
00/8980: AD 02 17     LDA $1702
; ************************
00/8983: C9 67        CMP #$67        ; lunar subterrane/core maps
00/8985: 90 0C        BCC $8993
00/8987: C9 7F        CMP #$7F
00/8989: B0 08        BCS $8993
00/898B: AD 01 18     LDA $1801       ; use moon monster action scripts
00/898E: 09 80        ORA #$80
00/8990: 8D 01 18     STA $1801
00/8993: 20 EF 85     JSR $85EF       ; screen off
00/8996: 08           PHP 
00/8997: 78           SEI 
00/8998: 22 00 80 03  JSL $038000     ; battle
00/899C: 20 ED 89     JSR $89ED       ; init interrupt jump code
00/899F: 28           PLP 
00/89A0: AD 03 18     LDA $1803
00/89A3: 10 0B        BPL $89B0
00/89A5: 22 AA C9 15  JSL $15C9AA     ; clear ram
00/89A9: A2 FF 02     LDX #$02FF
00/89AC: 9A           TXS 
00/89AD: 4C 40 80     JMP $8040
00/89B0: A5 C6        LDA $C6
00/89B2: F0 08        BEQ $89BC
00/89B4: 8D 04 18     STA $1804
00/89B7: 64 C6        STZ $C6
00/89B9: 4C D6 89     JMP $89D6
00/89BC: AD 04 18     LDA $1804
00/89BF: 0D 05 18     ORA $1805
00/89C2: 0D 06 18     ORA $1806
00/89C5: 0D 07 18     ORA $1807
00/89C8: 0D 08 18     ORA $1808
00/89CB: 0D 09 18     ORA $1809
00/89CE: 0D 0A 18     ORA $180A
00/89D1: 0D 0B 18     ORA $180B
00/89D4: F0 07        BEQ $89DD       ; branch if no items obtained
00/89D6: 22 20 80 01  JSL $018020     ; treasure menu
00/89DA: 20 ED 89     JSR $89ED       ; init interrupt jump code
00/89DD: A9 80        LDA #$80
00/89DF: 8D 00 21     STA $2100       ; screen off
00/89E2: AD 00 17     LDA $1700
00/89E5: C9 03        CMP #$03
00/89E7: D0 03        BNE $89EC
00/89E9: 20 1F C1     JSR $C11F       ; reload npcs
00/89EC: 60           RTS 

; [ init interrupt jump code ]

00/89ED: A9 5C        LDA #$5C
00/89EF: 8D 00 02     STA $0200
00/89F2: 8D 04 02     STA $0204
00/89F5: A2 A3 92     LDX #$92A3      ; 00/92A3 (field nmi)
00/89F8: 8E 01 02     STX $0201
00/89FB: 9C 03 02     STZ $0203
00/89FE: A2 7E 94     LDX #$947E      ; 00/947E (field irq)
00/8A01: 8E 05 02     STX $0205
00/8A04: 9C 07 02     STZ $0207
00/8A07: 60           RTS 

; [ fade out for menu ]

00/8A08: A9 00        LDA #$00
00/8A0A: 20 D1 8D     JSR $8DD1       ; fade out
00/8A0D: 20 EF 85     JSR $85EF       ; screen off
00/8A10: 60           RTS 

; [ reload graphics after menu ]

00/8A11: AD 00 17     LDA $1700
00/8A14: C9 03        CMP #$03
00/8A16: F0 0B        BEQ $8A23       ; branch if a sub-map
00/8A18: A9 07        LDA #$07        ; set bg mode 7
00/8A1A: 8D 05 21     STA $2105
00/8A1D: 20 92 97     JSR $9792       ; load sprite graphics (world map)
00/8A20: 4C 3E 8A     JMP $8A3E
00/8A23: A9 09        LDA #$09        ; set bg mode 1
00/8A25: 8D 05 21     STA $2105
00/8A28: 20 A2 97     JSR $97A2       ; load sprite graphics (sub-map)
00/8A2B: 20 1F C1     JSR $C11F       ; reload npcs
00/8A2E: AD E4 0F     LDA $0FE4
00/8A31: 4A           LSR 
00/8A32: 90 0A        BCC $8A3E       ; branch if no color addition
00/8A34: A9 03        LDA #$03
00/8A36: 8D 30 21     STA $2130
00/8A39: A9 43        LDA #$43
00/8A3B: 8D 31 21     STA $2131
00/8A3E: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/8A42: 22 7B C8 15  JSL $15C87B     ; get showing character properties pointer
00/8A46: BD 00 10     LDA $1000,X
00/8A49: D0 04        BNE $8A4F
00/8A4B: 22 5E C8 15  JSL $15C85E     ; validate showing character
00/8A4F: 20 77 91     JSR $9177       ; reset all sprites
00/8A52: A9 81        LDA #$81
00/8A54: 8D 00 42     STA $4200       ; enable nmi
00/8A57: A9 00        LDA #$00
00/8A59: 20 B0 8D     JSR $8DB0       ; fade in
00/8A5C: 58           CLI 
00/8A5D: 60           RTS 

; [ load cave water graphics ]

00/8A5E: A9 7F        LDA #$7F
00/8A60: 48           PHA 
00/8A61: AB           PLB 
00/8A62: A2 00 00     LDX #$0000
00/8A65: A0 00 00     LDY #$0000
00/8A68: BF D0 EE 1F  LDA $1FEED0,X
00/8A6C: 99 00 58     STA $5800,Y
00/8A6F: E8           INX 
00/8A70: C8           INY 
00/8A71: 98           TYA 
00/8A72: 29 0F        AND #$0F
00/8A74: D0 F2        BNE $8A68
00/8A76: BF D0 EE 1F  LDA $1FEED0,X
00/8A7A: 99 00 58     STA $5800,Y
00/8A7D: E8           INX 
00/8A7E: C8           INY 
00/8A7F: A9 00        LDA #$00
00/8A81: 99 00 58     STA $5800,Y
00/8A84: C8           INY 
00/8A85: 98           TYA 
00/8A86: 29 0F        AND #$0F
00/8A88: D0 EC        BNE $8A76
00/8A8A: C0 00 01     CPY #$0100      ; load 8 tiles (only 4 are used)
00/8A8D: D0 D9        BNE $8A68
00/8A8F: A9 00        LDA #$00
00/8A91: 48           PHA 
00/8A92: AB           PLB 
00/8A93: 60           RTS 

; [ transfer cave water graphics to vram ]

00/8A94: AD DD 0F     LDA $0FDD       ; tileset
00/8A97: C9 0E        CMP #$0E
00/8A99: F0 01        BEQ $8A9C       ; branch if overworld cave
00/8A9B: 60           RTS 
00/8A9C: A9 80        LDA #$80
00/8A9E: 8D 15 21     STA $2115
00/8AA1: 20 2A 8B     JSR $8B2A       ; init dma
00/8AA4: A2 30 04     LDX #$0430
00/8AA7: 8E 16 21     STX $2116
00/8AAA: A9 01        LDA #$01
00/8AAC: 8D 00 43     STA $4300
00/8AAF: A2 00 58     LDX #$5800      ; cave animated water graphics buffer
00/8AB2: 8E 02 43     STX $4302
00/8AB5: A9 7F        LDA #$7F
00/8AB7: 8D 04 43     STA $4304
00/8ABA: A2 00 01     LDX #$0100
00/8ABD: 8E 05 43     STX $4305
00/8AC0: 20 36 8B     JSR $8B36       ; execute dma
00/8AC3: 60           RTS 

; [ update cave animated water ]

00/8AC4: A5 7A        LDA $7A
00/8AC6: 29 01        AND #$01
00/8AC8: F0 01        BEQ $8ACB
00/8ACA: 60           RTS 
00/8ACB: A5 7A        LDA $7A
00/8ACD: 29 1E        AND #$1E
00/8ACF: 4A           LSR 
00/8AD0: AA           TAX 
00/8AD1: BF 66 FC 14  LDA $14FC66,X   ; cave animated water data
00/8AD5: 0A           ASL 
00/8AD6: AA           TAX 
00/8AD7: BF 00 58 7F  LDA $7F5800,X
00/8ADB: 85 08        STA $08
00/8ADD: BF 20 58 7F  LDA $7F5820,X
00/8AE1: 20 1D 8B     JSR $8B1D       ; rotate word
00/8AE4: 9F 00 58 7F  STA $7F5800,X
00/8AE8: A5 07        LDA $07
00/8AEA: 9F 20 58 7F  STA $7F5820,X
00/8AEE: BF 01 58 7F  LDA $7F5801,X
00/8AF2: 85 08        STA $08
00/8AF4: BF 21 58 7F  LDA $7F5821,X
00/8AF8: 20 1D 8B     JSR $8B1D       ; rotate word
00/8AFB: 9F 01 58 7F  STA $7F5801,X
00/8AFF: A5 07        LDA $07
00/8B01: 9F 21 58 7F  STA $7F5821,X
00/8B05: BF 10 58 7F  LDA $7F5810,X
00/8B09: 85 08        STA $08
00/8B0B: BF 30 58 7F  LDA $7F5830,X
00/8B0F: 20 1D 8B     JSR $8B1D       ; rotate word
00/8B12: 9F 10 58 7F  STA $7F5810,X
00/8B16: A5 07        LDA $07
00/8B18: 9F 30 58 7F  STA $7F5830,X
00/8B1C: 60           RTS 

; [ rotate word ]

00/8B1D: 85 09        STA $09
00/8B1F: 85 07        STA $07
00/8B21: 66 09        ROR $09
00/8B23: 66 08        ROR $08
00/8B25: 66 07        ROR $07
00/8B27: A5 08        LDA $08
00/8B29: 60           RTS 

; [ init dma ]

00/8B2A: 9C 0B 42     STZ $420B
00/8B2D: A9 18        LDA #$18
00/8B2F: 8D 01 43     STA $4301
00/8B32: 9C 04 43     STZ $4304
00/8B35: 60           RTS 

; [ execute dma ]

00/8B36: A9 01        LDA #$01
00/8B38: 8D 0B 42     STA $420B
00/8B3B: 60           RTS 

; [ update random battle ]

00/8B3C: AD 04 17     LDA $1704
00/8B3F: D0 15        BNE $8B56
00/8B41: A5 A2        LDA $A2
00/8B43: 29 40        AND #$40
00/8B45: F0 0F        BEQ $8B56
00/8B47: A5 C0        LDA $C0
00/8B49: D0 20        BNE $8B6B
00/8B4B: A5 AB        LDA $AB
00/8B4D: F0 07        BEQ $8B56
00/8B4F: A5 D5        LDA $D5
00/8B51: F0 03        BEQ $8B56       ; branch if player control is disabled
00/8B53: 4C 6B 8B     JMP $8B6B
00/8B56: A5 C0        LDA $C0
00/8B58: F0 10        BEQ $8B6A
00/8B5A: 64 C0        STZ $C0
00/8B5C: A9 02        LDA #$02
00/8B5E: 8D 00 1E     STA $1E00
00/8B61: A9 01        LDA #$01        ; play sound effect $01
00/8B63: 8D 01 1E     STA $1E01
00/8B66: 22 04 80 04  JSL $048004     ; execute sound command
00/8B6A: 60           RTS 
00/8B6B: E6 88        INC $88
00/8B6D: E6 86        INC $86
00/8B6F: D0 09        BNE $8B7A
00/8B71: AD EF 17     LDA $17EF
00/8B74: 18           CLC 
00/8B75: 69 11        ADC #$11
00/8B77: 8D EF 17     STA $17EF
00/8B7A: AD 00 17     LDA $1700
00/8B7D: C9 00        CMP #$00
00/8B7F: D0 3A        BNE $8BBB
; overworld
00/8B81: AD 07 17     LDA $1707
00/8B84: 4A           LSR 
00/8B85: 4A           LSR 
00/8B86: 29 F8        AND #$F8
00/8B88: 85 06        STA $06
00/8B8A: AD 06 17     LDA $1706
00/8B8D: 4A           LSR 
00/8B8E: 4A           LSR 
00/8B8F: 4A           LSR 
00/8B90: 4A           LSR 
00/8B91: 4A           LSR 
00/8B92: 18           CLC 
00/8B93: 65 06        ADC $06
00/8B95: AA           TAX 
00/8B96: BF 00 C3 0E  LDA $0EC300,X
00/8B9A: 85 06        STA $06
00/8B9C: DA           PHX 
00/8B9D: 7A           PLY 
00/8B9E: A5 C0        LDA $C0
00/8BA0: D0 10        BNE $8BB2
00/8BA2: A5 86        LDA $86
00/8BA4: AA           TAX 
00/8BA5: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/8BA9: 18           CLC 
00/8BAA: 6D EF 17     ADC $17EF
00/8BAD: C5 06        CMP $06
00/8BAF: 90 01        BCC $8BB2
00/8BB1: 60           RTS 
00/8BB2: 5A           PHY 
00/8BB3: FA           PLX 
00/8BB4: BF 42 C5 0E  LDA $0EC542,X
00/8BB8: 4C 29 8C     JMP $8C29
; underground
00/8BBB: C9 01        CMP #$01
00/8BBD: D0 33        BNE $8BF2
00/8BBF: A5 C0        LDA $C0
00/8BC1: D0 12        BNE $8BD5
00/8BC3: A5 86        LDA $86
00/8BC5: AA           TAX 
00/8BC6: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/8BCA: 18           CLC 
00/8BCB: 6D EF 17     ADC $17EF
00/8BCE: CF 40 C3 0E  CMP $0EC340
00/8BD2: 90 01        BCC $8BD5
00/8BD4: 60           RTS 
00/8BD5: AD 07 17     LDA $1707
00/8BD8: 4A           LSR 
00/8BD9: 4A           LSR 
00/8BDA: 4A           LSR 
00/8BDB: 29 FC        AND #$FC
00/8BDD: 85 06        STA $06
00/8BDF: AD 06 17     LDA $1706
00/8BE2: 4A           LSR 
00/8BE3: 4A           LSR 
00/8BE4: 4A           LSR 
00/8BE5: 4A           LSR 
00/8BE6: 4A           LSR 
00/8BE7: 18           CLC 
00/8BE8: 65 06        ADC $06
00/8BEA: AA           TAX 
00/8BEB: BF 82 C5 0E  LDA $0EC582,X
00/8BEF: 4C 29 8C     JMP $8C29
; moon
00/8BF2: C9 02        CMP #$02
00/8BF4: D0 5D        BNE $8C53
00/8BF6: A5 C0        LDA $C0
00/8BF8: D0 12        BNE $8C0C
00/8BFA: A5 86        LDA $86
00/8BFC: AA           TAX 
00/8BFD: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/8C01: 18           CLC 
00/8C02: 6D EF 17     ADC $17EF
00/8C05: CF 41 C3 0E  CMP $0EC341
00/8C09: 90 01        BCC $8C0C
00/8C0B: 60           RTS 
00/8C0C: 64 06        STZ $06
00/8C0E: AD 07 17     LDA $1707
00/8C11: C9 20        CMP #$20
00/8C13: 90 04        BCC $8C19
00/8C15: A9 02        LDA #$02
00/8C17: 85 06        STA $06
00/8C19: AD 06 17     LDA $1706
00/8C1C: C9 20        CMP #$20
00/8C1E: 90 02        BCC $8C22
00/8C20: E6 06        INC $06
00/8C22: A5 06        LDA $06
00/8C24: AA           TAX 
00/8C25: BF 92 C5 0E  LDA $0EC592,X
00/8C29: 20 F0 8C     JSR $8CF0       ; choose random battle
00/8C2C: 64 3E        STZ $3E
00/8C2E: A6 3D        LDX $3D
00/8C30: BF 96 C7 0E  LDA $0EC796,X
00/8C34: 8D 00 18     STA $1800
00/8C37: AD 01 17     LDA $1701
00/8C3A: F0 02        BEQ $8C3E
00/8C3C: A9 01        LDA #$01
00/8C3E: 8D 01 18     STA $1801
00/8C41: A5 A2        LDA $A2
00/8C43: 29 07        AND #$07
00/8C45: A8           TAY 
00/8C46: B9 AF 8C     LDA $8CAF,Y     ; world map battle backgrounds
00/8C49: 8D 02 18     STA $1802
00/8C4C: 64 C0        STZ $C0
00/8C4E: A9 01        LDA #$01        ; enable battle
00/8C50: 85 85        STA $85
00/8C52: 60           RTS 
; sub-map
00/8C53: AD 02 17     LDA $1702
00/8C56: 85 3D        STA $3D
00/8C58: AD 01 17     LDA $1701
00/8C5B: F0 02        BEQ $8C5F
00/8C5D: A9 01        LDA #$01
00/8C5F: 85 3E        STA $3E
00/8C61: A6 3D        LDX $3D
00/8C63: BF 42 C3 0E  LDA $0EC342,X
00/8C67: F0 15        BEQ $8C7E
00/8C69: 85 06        STA $06
00/8C6B: A5 C0        LDA $C0
00/8C6D: D0 22        BNE $8C91
00/8C6F: A5 86        LDA $86
00/8C71: AA           TAX 
00/8C72: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/8C76: 18           CLC 
00/8C77: 6D EF 17     ADC $17EF
00/8C7A: C5 06        CMP $06
00/8C7C: 90 13        BCC $8C91
00/8C7E: A5 C0        LDA $C0
00/8C80: F0 0E        BEQ $8C90
00/8C82: 64 C0        STZ $C0
00/8C84: A9 02        LDA #$02        ; play sound effect $00
00/8C86: 8D 00 1E     STA $1E00
00/8C89: 9C 01 1E     STZ $1E01
00/8C8C: 22 04 80 04  JSL $048004     ; execute sound command
00/8C90: 60           RTS 
00/8C91: A6 3D        LDX $3D
00/8C93: BF 96 C5 0E  LDA $0EC596,X
00/8C97: 20 F0 8C     JSR $8CF0       ; choose random battle
00/8C9A: A6 3D        LDX $3D
00/8C9C: BF 16 C8 0E  LDA $0EC816,X
00/8CA0: 8D 00 18     STA $1800
00/8CA3: 20 B5 8C     JSR $8CB5       ; update battle parameters
00/8CA6: 64 C0        STZ $C0
00/8CA8: A9 01        LDA #$01        ; enable battle
00/8CAA: 85 85        STA $85
00/8CAC: 64 88        STZ $88
00/8CAE: 60           RTS 

; world map battle backgrounds
00/8CAF: 00 0A 01 09 0F 05

; [ update battle parameters ]

00/8CB5: AD 01 17     LDA $1701
00/8CB8: F0 02        BEQ $8CBC
00/8CBA: A9 01        LDA #$01        ; set msb of battle id
00/8CBC: 8D 01 18     STA $1801
00/8CBF: 20 D4 8C     JSR $8CD4       ; get battle bg (sub-map)
00/8CC2: A9 E1        LDA #$E1
00/8CC4: 20 ED F3     JSR $F3ED       ; check event switch
00/8CC7: C9 00        CMP #$00
00/8CC9: D0 08        BNE $8CD3
00/8CCB: AD 02 18     LDA $1802       ; disable magnetization
00/8CCE: 29 7F        AND #$7F
00/8CD0: 8D 02 18     STA $1802
00/8CD3: 60           RTS 

; [ get battle bg (sub-map) ]

00/8CD4: A5 A2        LDA $A2         ; use cave w/ water battle bg
00/8CD6: 29 20        AND #$20
00/8CD8: 0A           ASL 
00/8CD9: 85 06        STA $06
00/8CDB: AD DB 0F     LDA $0FDB       ; use alternate battle bg palette
00/8CDE: 29 40        AND #$40
00/8CE0: 4A           LSR 
00/8CE1: 05 06        ORA $06
00/8CE3: 85 06        STA $06
00/8CE5: AD DB 0F     LDA $0FDB       ; battle bg id and magnetization flag
00/8CE8: 29 8F        AND #$8F
00/8CEA: 05 06        ORA $06
00/8CEC: 8D 02 18     STA $1802
00/8CEF: 60           RTS 

; [ choose random battle ]

; battle probabilities
;   0: 43/256 (16.8%)
;   1: 43/256 (16.8%)
;   2: 43/256 (16.8%)
;   3: 43/256 (16.8%)
;   4: 32/256 (12.5%)
;   5: 32/256 (12.5%)
;   6: 16/256 (6.25%)
;   7: 4/256  (1.56%)

00/8CF0: 85 3D        STA $3D
00/8CF2: 64 3E        STZ $3E
00/8CF4: 06 3D        ASL $3D
00/8CF6: 26 3E        ROL $3E
00/8CF8: 06 3D        ASL $3D
00/8CFA: 26 3E        ROL $3E
00/8CFC: 06 3D        ASL $3D
00/8CFE: 26 3E        ROL $3E
00/8D00: A5 C0        LDA $C0
00/8D02: D0 1B        BNE $8D1F
00/8D04: A5 87        LDA $87
00/8D06: AA           TAX 
00/8D07: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/8D0B: 18           CLC 
00/8D0C: 6D EE 17     ADC $17EE
00/8D0F: E6 87        INC $87
00/8D11: D0 0E        BNE $8D21
00/8D13: AD EE 17     LDA $17EE
00/8D16: 18           CLC 
00/8D17: 69 11        ADC #$11
00/8D19: 8D EE 17     STA $17EE
00/8D1C: 4C 21 8D     JMP $8D21
00/8D1F: A9 FF        LDA #$FF
00/8D21: A6 3D        LDX $3D
00/8D23: C9 2B        CMP #$2B
00/8D25: 90 1F        BCC $8D46
00/8D27: E8           INX 
00/8D28: C9 56        CMP #$56
00/8D2A: 90 1A        BCC $8D46
00/8D2C: E8           INX 
00/8D2D: C9 81        CMP #$81
00/8D2F: 90 15        BCC $8D46
00/8D31: E8           INX 
00/8D32: C9 AC        CMP #$AC
00/8D34: 90 10        BCC $8D46
00/8D36: E8           INX 
00/8D37: C9 CC        CMP #$CC
00/8D39: 90 0B        BCC $8D46
00/8D3B: E8           INX 
00/8D3C: C9 EC        CMP #$EC
00/8D3E: 90 06        BCC $8D46
00/8D40: E8           INX 
00/8D41: C9 FC        CMP #$FC
00/8D43: 90 01        BCC $8D46
00/8D45: E8           INX 
00/8D46: 86 3D        STX $3D
00/8D48: 60           RTS 

; [ fade out music (fast) ]

00/8D49: A9 86        LDA #$86        ; fade out music (fast)
00/8D4B: 8D 00 1E     STA $1E00
00/8D4E: 22 04 80 04  JSL $048004     ; execute sound command
00/8D52: 60           RTS 

; [ fade out music (slow) ]

00/8D53: A9 85        LDA #$85        ; fade out music (slow)
00/8D55: 8D 00 1E     STA $1E00
00/8D58: 22 04 80 04  JSL $048004     ; execute sound command
00/8D5C: 60           RTS 

; [ play map song ]

00/8D5D: AD 04 17     LDA $1704
00/8D60: F0 0F        BEQ $8D71
00/8D62: AD 04 17     LDA $1704
00/8D65: AA           TAX 
00/8D66: BD 92 8D     LDA $8D92,X     ; vehicle songs
00/8D69: 8D 01 1E     STA $1E01
00/8D6C: A9 03        LDA #$03
00/8D6E: 4C 87 8D     JMP $8D87
00/8D71: AD 00 17     LDA $1700
00/8D74: C9 03        CMP #$03
00/8D76: F0 07        BEQ $8D7F
00/8D78: AA           TAX 
00/8D79: BD 8F 8D     LDA $8D8F,X     ; world map song
00/8D7C: 4C 82 8D     JMP $8D82
00/8D7F: AD E2 0F     LDA $0FE2       ; sub-map song
00/8D82: 8D 01 1E     STA $1E01
00/8D85: A9 01        LDA #$01        ; play song
00/8D87: 8D 00 1E     STA $1E00
00/8D8A: 22 04 80 04  JSL $048004     ; execute sound command
00/8D8E: 60           RTS 

; world map songs
00/8D8F: 0D 06 31

; vehicle songs
00/8D92: 0D 04 05 0D 18 18 0E

; [ play sound effect ]

00/8D99: 8D 01 1E     STA $1E01
00/8D9C: A9 80        LDA #$80
00/8D9E: 8D 02 1E     STA $1E02
00/8DA1: A9 FF        LDA #$FF
00/8DA3: 8D 03 1E     STA $1E03
00/8DA6: A9 02        LDA #$02
00/8DA8: 8D 00 1E     STA $1E00
00/8DAB: 22 04 80 04  JSL $048004     ; execute sound command
00/8DAF: 60           RTS 

; [ fade in ]

; A: fade rate (frame counter mask)

00/8DB0: 85 82        STA $82
00/8DB2: 64 79        STZ $79
00/8DB4: 64 80        STZ $80
00/8DB6: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/8DB9: A5 80        LDA $80
00/8DBB: 8D 00 21     STA $2100       ; set screen brightness
00/8DBE: E6 79        INC $79
00/8DC0: A5 79        LDA $79
00/8DC2: 25 82        AND $82
00/8DC4: D0 F0        BNE $8DB6
00/8DC6: E6 80        INC $80
00/8DC8: A5 80        LDA $80
00/8DCA: C9 10        CMP #$10
00/8DCC: D0 E8        BNE $8DB6
00/8DCE: C6 80        DEC $80
00/8DD0: 60           RTS 

; [ fade out ]

; A: fade rate (frame counter mask)

00/8DD1: 85 82        STA $82
00/8DD3: 64 79        STZ $79
00/8DD5: A9 0F        LDA #$0F
00/8DD7: 85 80        STA $80
00/8DD9: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/8DDC: A5 80        LDA $80
00/8DDE: 8D 00 21     STA $2100       ; set screen brightness
00/8DE1: AD 00 17     LDA $1700
00/8DE4: C9 03        CMP #$03
00/8DE6: F0 05        BEQ $8DED       ; branch if a sub-map
00/8DE8: A9 30        LDA #$30        ; enable mode 7 zoom hdma
00/8DEA: 8D 0C 42     STA $420C
00/8DED: E6 79        INC $79
00/8DEF: A5 79        LDA $79
00/8DF1: 25 82        AND $82
00/8DF3: D0 E4        BNE $8DD9
00/8DF5: C6 80        DEC $80
00/8DF7: 10 E0        BPL $8DD9
00/8DF9: 64 80        STZ $80
00/8DFB: 60           RTS 

; [ wait for key up ]

00/8DFC: A5 02        LDA $02
00/8DFE: D0 FC        BNE $8DFC
00/8E00: A5 03        LDA $03
00/8E02: D0 F8        BNE $8DFC
00/8E04: 60           RTS 

; [ wait for keypress ]

00/8E05: A5 02        LDA $02
00/8E07: D0 04        BNE $8E0D
00/8E09: A5 03        LDA $03
00/8E0B: F0 F8        BEQ $8E05
00/8E0D: 60           RTS 

; --------------------------------------------------------------------------

; [ transfer water/lava tile to vram ]

00/8E0E: BF 00 58 7F  LDA $7F5800,X
00/8E12: 8D 19 21     STA $2119
00/8E15: BF 01 58 7F  LDA $7F5801,X
00/8E19: 8D 19 21     STA $2119
00/8E1C: BF 02 58 7F  LDA $7F5802,X
00/8E20: 8D 19 21     STA $2119
00/8E23: BF 03 58 7F  LDA $7F5803,X
00/8E27: 8D 19 21     STA $2119
00/8E2A: BF 04 58 7F  LDA $7F5804,X
00/8E2E: 8D 19 21     STA $2119
00/8E31: BF 05 58 7F  LDA $7F5805,X
00/8E35: 8D 19 21     STA $2119
00/8E38: BF 06 58 7F  LDA $7F5806,X
00/8E3C: 8D 19 21     STA $2119
00/8E3F: BF 07 58 7F  LDA $7F5807,X
00/8E43: 8D 19 21     STA $2119
00/8E46: 60           RTS 

; [ update water/lava animation ]

00/8E47: AD 00 17     LDA $1700
00/8E4A: D0 03        BNE $8E4F       ; branch if not overworld
00/8E4C: 4C A1 8F     JMP $8FA1       ; update overworld water animation
00/8E4F: C9 01        CMP #$01
00/8E51: D0 03        BNE $8E56       ; branch if not underground
00/8E53: 4C E3 8E     JMP $8EE3       ; update underground lava animation
00/8E56: 60           RTS 

; [ transfer water/lava graphics to vram ]

00/8E57: AD 00 17     LDA $1700
00/8E5A: D0 03        BNE $8E5F       ; branch if not overworld
00/8E5C: 4C 67 8E     JMP $8E67       ; transfer overworld water graphics to vram
00/8E5F: C9 01        CMP #$01
00/8E61: D0 03        BNE $8E66       ; branch if not underground
00/8E63: 4C 34 8F     JMP $8F34       ; transfer underground lava graphics to vram
00/8E66: 60           RTS 

; [ transfer overworld water graphics to vram ]

00/8E67: A9 80        LDA #$80
00/8E69: 8D 15 21     STA $2115
00/8E6C: A5 7C        LDA $7C
00/8E6E: 4A           LSR 
00/8E6F: 29 0F        AND #$0F
00/8E71: AA           TAX 
00/8E72: BD AA 90     LDA $90AA,X
00/8E75: AA           TAX 
00/8E76: 8D 16 21     STA $2116
00/8E79: A9 20        LDA #$20
00/8E7B: 8D 17 21     STA $2117
00/8E7E: 20 0E 8E     JSR $8E0E       ;  transfer water/lava tile to vram
00/8E81: A5 7C        LDA $7C
00/8E83: 4A           LSR 
00/8E84: 29 0F        AND #$0F
00/8E86: AA           TAX 
00/8E87: BD AA 90     LDA $90AA,X
00/8E8A: 18           CLC 
00/8E8B: 69 40        ADC #$40
00/8E8D: AA           TAX 
00/8E8E: 8D 16 21     STA $2116
00/8E91: A9 20        LDA #$20
00/8E93: 8D 17 21     STA $2117
00/8E96: 20 0E 8E     JSR $8E0E       ;  transfer water/lava tile to vram
00/8E99: A9 80        LDA #$80
00/8E9B: 8D 15 21     STA $2115
00/8E9E: A2 80 1E     LDX #$1E80
00/8EA1: 8E 16 21     STX $2116
00/8EA4: 9C 0B 42     STZ $420B
00/8EA7: 9C 00 43     STZ $4300
00/8EAA: A9 19        LDA #$19
00/8EAC: 8D 01 43     STA $4301
00/8EAF: A2 00 59     LDX #$5900
00/8EB2: 8E 02 43     STX $4302
00/8EB5: A9 7F        LDA #$7F
00/8EB7: 8D 04 43     STA $4304
00/8EBA: A2 00 01     LDX #$0100
00/8EBD: 8E 05 43     STX $4305
00/8EC0: 20 36 8B     JSR $8B36       ; execute dma
00/8EC3: 60           RTS 

; [ transfer underground lava graphics from vram ]

00/8EC4: A9 80        LDA #$80
00/8EC6: 8D 15 21     STA $2115
00/8EC9: A2 00 38     LDX #$3800
00/8ECC: 8E 16 21     STX $2116
00/8ECF: AD 3A 21     LDA $213A
00/8ED2: A2 00 00     LDX #$0000
00/8ED5: AD 3A 21     LDA $213A
00/8ED8: 9F 00 58 7F  STA $7F5800,X
00/8EDC: E8           INX 
00/8EDD: E0 00 01     CPX #$0100
00/8EE0: D0 F3        BNE $8ED5
00/8EE2: 60           RTS 

; [ update underground lava animation ]

00/8EE3: A5 7C        LDA $7C
00/8EE5: 29 01        AND #$01
00/8EE7: F0 01        BEQ $8EEA
00/8EE9: 60           RTS 
00/8EEA: A5 7C        LDA $7C
00/8EEC: 4A           LSR 
00/8EED: 29 0F        AND #$0F
00/8EEF: AA           TAX 
00/8EF0: BD AA 90     LDA $90AA,X
00/8EF3: 09 07        ORA #$07
00/8EF5: AA           TAX 
00/8EF6: BF 00 58 7F  LDA $7F5800,X
00/8EFA: 85 06        STA $06
00/8EFC: A0 07 00     LDY #$0007
00/8EFF: BF FF 57 7F  LDA $7F57FF,X
00/8F03: 9F 00 58 7F  STA $7F5800,X
00/8F07: CA           DEX 
00/8F08: 88           DEY 
00/8F09: D0 F4        BNE $8EFF
00/8F0B: 8A           TXA 
00/8F0C: 29 F8        AND #$F8
00/8F0E: 18           CLC 
00/8F0F: 69 47        ADC #$47
00/8F11: AA           TAX 
00/8F12: BF 00 58 7F  LDA $7F5800,X
00/8F16: 9F B9 57 7F  STA $7F57B9,X
00/8F1A: A0 07 00     LDY #$0007
00/8F1D: BF FF 57 7F  LDA $7F57FF,X
00/8F21: 9F 00 58 7F  STA $7F5800,X
00/8F25: CA           DEX 
00/8F26: 88           DEY 
00/8F27: D0 F4        BNE $8F1D
00/8F29: 8A           TXA 
00/8F2A: 29 F8        AND #$F8
00/8F2C: AA           TAX 
00/8F2D: A5 06        LDA $06
00/8F2F: 9F 00 58 7F  STA $7F5800,X
00/8F33: 60           RTS 

; [ transfer underground lava graphics to vram ]

00/8F34: A9 80        LDA #$80
00/8F36: 8D 15 21     STA $2115
00/8F39: A5 7C        LDA $7C
00/8F3B: 4A           LSR 
00/8F3C: 29 0F        AND #$0F
00/8F3E: AA           TAX 
00/8F3F: BD AA 90     LDA $90AA,X
00/8F42: AA           TAX 
00/8F43: 8D 16 21     STA $2116
00/8F46: A9 38        LDA #$38
00/8F48: 8D 17 21     STA $2117
00/8F4B: 20 0E 8E     JSR $8E0E       ;  transfer water/lava tile to vram
00/8F4E: A5 7C        LDA $7C
00/8F50: 4A           LSR 
00/8F51: 29 0F        AND #$0F
00/8F53: AA           TAX 
00/8F54: BD AA 90     LDA $90AA,X
00/8F57: 18           CLC 
00/8F58: 69 40        ADC #$40
00/8F5A: AA           TAX 
00/8F5B: 8D 16 21     STA $2116
00/8F5E: A9 38        LDA #$38
00/8F60: 8D 17 21     STA $2117
00/8F63: 20 0E 8E     JSR $8E0E       ;  transfer water/lava tile to vram
00/8F66: E6 7C        INC $7C
00/8F68: 60           RTS 

; [ transfer overworld water graphics from vram ]

00/8F69: A9 80        LDA #$80
00/8F6B: 8D 15 21     STA $2115
00/8F6E: A2 00 20     LDX #$2000
00/8F71: 8E 16 21     STX $2116
00/8F74: AD 3A 21     LDA $213A
00/8F77: A2 00 00     LDX #$0000
00/8F7A: AD 3A 21     LDA $213A
00/8F7D: 9F 00 58 7F  STA $7F5800,X
00/8F81: E8           INX 
00/8F82: E0 00 01     CPX #$0100
00/8F85: D0 F3        BNE $8F7A
00/8F87: A2 80 1E     LDX #$1E80
00/8F8A: 8E 16 21     STX $2116
00/8F8D: AD 3A 21     LDA $213A
00/8F90: A2 00 00     LDX #$0000
00/8F93: AD 3A 21     LDA $213A
00/8F96: 9F 00 59 7F  STA $7F5900,X
00/8F9A: E8           INX 
00/8F9B: E0 00 01     CPX #$0100
00/8F9E: D0 F3        BNE $8F93
00/8FA0: 60           RTS 

; [ update overworld water animation ]

00/8FA1: A5 7C        LDA $7C
00/8FA3: 29 01        AND #$01
00/8FA5: F0 03        BEQ $8FAA
00/8FA7: 4C F3 8F     JMP $8FF3
00/8FAA: A5 7C        LDA $7C
00/8FAC: 4A           LSR 
00/8FAD: 29 0F        AND #$0F
00/8FAF: AA           TAX 
00/8FB0: BD AA 90     LDA $90AA,X
00/8FB3: 09 07        ORA #$07
00/8FB5: AA           TAX 
00/8FB6: BF 00 58 7F  LDA $7F5800,X
00/8FBA: 85 06        STA $06
00/8FBC: A0 07 00     LDY #$0007
00/8FBF: BF FF 57 7F  LDA $7F57FF,X
00/8FC3: 9F 00 58 7F  STA $7F5800,X
00/8FC7: CA           DEX 
00/8FC8: 88           DEY 
00/8FC9: D0 F4        BNE $8FBF
00/8FCB: 8A           TXA 
00/8FCC: 29 F8        AND #$F8
00/8FCE: 18           CLC 
00/8FCF: 69 47        ADC #$47
00/8FD1: AA           TAX 
00/8FD2: BF 00 58 7F  LDA $7F5800,X
00/8FD6: 9F B9 57 7F  STA $7F57B9,X
00/8FDA: A0 07 00     LDY #$0007
00/8FDD: BF FF 57 7F  LDA $7F57FF,X
00/8FE1: 9F 00 58 7F  STA $7F5800,X
00/8FE5: CA           DEX 
00/8FE6: 88           DEY 
00/8FE7: D0 F4        BNE $8FDD
00/8FE9: 8A           TXA 
00/8FEA: 29 F8        AND #$F8
00/8FEC: AA           TAX 
00/8FED: A5 06        LDA $06
00/8FEF: 9F 00 58 7F  STA $7F5800,X
00/8FF3: A5 7C        LDA $7C
00/8FF5: 29 0F        AND #$0F
00/8FF7: AA           TAX 
00/8FF8: BD 9A 90     LDA $909A,X
00/8FFB: 18           CLC 
00/8FFC: 69 38        ADC #$38
00/8FFE: AA           TAX 
00/8FFF: BF 00 59 7F  LDA $7F5900,X
00/9003: 85 06        STA $06
00/9005: A0 07 00     LDY #$0007
00/9008: BF F8 58 7F  LDA $7F58F8,X
00/900C: 9F 00 59 7F  STA $7F5900,X
00/9010: 8A           TXA 
00/9011: 38           SEC 
00/9012: E9 08        SBC #$08
00/9014: AA           TAX 
00/9015: 88           DEY 
00/9016: D0 F0        BNE $9008
00/9018: A5 7C        LDA $7C
00/901A: 29 0F        AND #$0F
00/901C: AA           TAX 
00/901D: BD 9A 90     LDA $909A,X
00/9020: 18           CLC 
00/9021: 69 B8        ADC #$B8
00/9023: AA           TAX 
00/9024: BF 00 59 7F  LDA $7F5900,X
00/9028: 9F 48 58 7F  STA $7F5848,X
00/902C: A0 07 00     LDY #$0007
00/902F: BF F8 58 7F  LDA $7F58F8,X
00/9033: 9F 00 59 7F  STA $7F5900,X
00/9037: 8A           TXA 
00/9038: 38           SEC 
00/9039: E9 08        SBC #$08
00/903B: AA           TAX 
00/903C: 88           DEY 
00/903D: D0 F0        BNE $902F
00/903F: A5 06        LDA $06
00/9041: 9F 00 59 7F  STA $7F5900,X
00/9045: A5 7C        LDA $7C
00/9047: 29 0F        AND #$0F
00/9049: AA           TAX 
00/904A: BD 9A 90     LDA $909A,X
00/904D: 18           CLC 
00/904E: 69 38        ADC #$38
00/9050: AA           TAX 
00/9051: BF 00 59 7F  LDA $7F5900,X
00/9055: 85 06        STA $06
00/9057: A0 07 00     LDY #$0007
00/905A: BF F8 58 7F  LDA $7F58F8,X
00/905E: 9F 00 59 7F  STA $7F5900,X
00/9062: 8A           TXA 
00/9063: 38           SEC 
00/9064: E9 08        SBC #$08
00/9066: AA           TAX 
00/9067: 88           DEY 
00/9068: D0 F0        BNE $905A
00/906A: A5 7C        LDA $7C
00/906C: 29 0F        AND #$0F
00/906E: AA           TAX 
00/906F: BD 9A 90     LDA $909A,X
00/9072: 18           CLC 
00/9073: 69 B8        ADC #$B8
00/9075: AA           TAX 
00/9076: BF 00 59 7F  LDA $7F5900,X
00/907A: 9F 48 58 7F  STA $7F5848,X
00/907E: A0 07 00     LDY #$0007
00/9081: BF F8 58 7F  LDA $7F58F8,X
00/9085: 9F 00 59 7F  STA $7F5900,X
00/9089: 8A           TXA 
00/908A: 38           SEC 
00/908B: E9 08        SBC #$08
00/908D: AA           TAX 
00/908E: 88           DEY 
00/908F: D0 F0        BNE $9081
00/9091: A5 06        LDA $06
00/9093: 9F 00 59 7F  STA $7F5900,X
00/9097: E6 7C        INC $7C
00/9099: 60           RTS 

; overworld water data (offset of row to shift each frame)
; 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12, 5, 14, 7
00/909A: 00 41 02 43 04 45 06 47 40 01 42 03 44 05 46 07
; 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12, 5, 14, 7
00/90AA: 00 88 10 98 20 A8 30 B8 80 08 90 18 A0 28 B0 38

; --------------------------------------------------------------------------

; [ calculate mode 7 rotation parameters ]

00/90BA: A9 40        LDA #$40        ; zoom * cos(theta)
00/90BC: 20 D0 90     JSR $90D0       ; calculate mode 7 trig function
00/90BF: 84 6E        STY $6E
00/90C1: A9 00        LDA #$00        ; zoom * sin(theta)
00/90C3: 20 D0 90     JSR $90D0       ; calculate mode 7 trig function
00/90C6: 84 70        STY $70
00/90C8: A9 80        LDA #$80        ; -zoom * sin(theta)
00/90CA: 20 D0 90     JSR $90D0       ; calculate mode 7 trig function
00/90CD: 84 72        STY $72
00/90CF: 60           RTS 

; [ calculate mode 7 trig function ]

00/90D0: 18           CLC 
00/90D1: 6D FB 06     ADC $06FB       ; rotation angle
00/90D4: 85 06        STA $06
00/90D6: 29 7F        AND #$7F
00/90D8: 0A           ASL 
00/90D9: AA           TAX 
00/90DA: BF 00 EF 14  LDA $14EF00,X   ; sine table
00/90DE: 8D 1B 21     STA $211B       ; hardware multiply
00/90E1: BF 01 EF 14  LDA $14EF01,X
00/90E5: 8D 1B 21     STA $211B
00/90E8: A5 AD        LDA $AD         ; zoom level
00/90EA: 8D 1C 21     STA $211C
00/90ED: 8D 1C 21     STA $211C
00/90F0: AC 35 21     LDY $2135
00/90F3: A5 06        LDA $06
00/90F5: 10 0C        BPL $9103
00/90F7: C2 20        REP #$20
00/90F9: 98           TYA 
00/90FA: 49 FF FF     EOR #$FFFF
00/90FD: 1A           INC 
00/90FE: A8           TAY 
00/90FF: 7B           TDC 
00/9100: EB           XBA 
00/9101: E2 20        SEP #$20
00/9103: 60           RTS 

; [ update mode 7 registers ]

00/9104: A5 6E        LDA $6E
00/9106: 8D 1B 21     STA $211B
00/9109: A5 6F        LDA $6F
00/910B: 8D 1B 21     STA $211B
00/910E: A5 70        LDA $70
00/9110: 8D 1C 21     STA $211C
00/9113: A5 71        LDA $71
00/9115: 8D 1C 21     STA $211C
00/9118: A5 72        LDA $72
00/911A: 8D 1D 21     STA $211D
00/911D: A5 73        LDA $73
00/911F: 8D 1D 21     STA $211D
00/9122: A5 6E        LDA $6E
00/9124: 8D 1E 21     STA $211E
00/9127: A5 6F        LDA $6F
00/9129: 8D 1E 21     STA $211E
00/912C: 60           RTS 

; --------------------------------------------------------------------------

; [ wait for vblank ]

00/912D: A9 01        LDA #$01
00/912F: 85 7D        STA $7D
00/9131: A5 7D        LDA $7D
00/9133: D0 FC        BNE $9131
00/9135: 22 3D C2 15  JSL $15C23D     ; no effect
00/9139: E6 7D        INC $7D
00/913B: 60           RTS 

; [ wait for vblank (short) ]

; skips most vram transfers, leaving more vblank time for other things

00/913C: A9 01        LDA #$01
00/913E: 85 7E        STA $7E
00/9140: A5 7E        LDA $7E
00/9142: D0 FC        BNE $9140
00/9144: 22 3D C2 15  JSL $15C23D     ; no effect
00/9148: E6 7D        INC $7D
00/914A: 60           RTS 

; [ wait one frame ]

00/914B: 20 3C 91     JSR $913C       ; wait for vblank (short)
; overworld
00/914E: AD 00 17     LDA $1700
00/9151: D0 09        BNE $915C
00/9153: 20 A1 8F     JSR $8FA1       ; update overworld water animation
00/9156: 20 67 8E     JSR $8E67       ; transfer overworld water graphics to vram
00/9159: 4C 6A 91     JMP $916A
; underground
00/915C: C9 01        CMP #$01
00/915E: D0 0A        BNE $916A
00/9160: 20 E3 8E     JSR $8EE3
00/9163: 20 34 8F     JSR $8F34
00/9166: 22 CD C4 15  JSL $15C4CD
00/916A: 22 5F CB 15  JSL $15CB5F     ; transfer bg animation graphics to vram
00/916E: 22 BD C3 15  JSL $15C3BD     ; update big whale palette animation
00/9172: 22 EA C3 15  JSL $15C3EA     ; update tower of bab-il palette animation
00/9176: 60           RTS 

; [ reset all sprites ]

00/9177: A2 00 00     LDX #$0000
00/917A: A9 F0        LDA #$F0
00/917C: 9D 01 03     STA $0301,X
00/917F: E8           INX 
00/9180: E8           INX 
00/9181: E8           INX 
00/9182: E8           INX 
00/9183: E0 00 02     CPX #$0200
00/9186: D0 F4        BNE $917C
00/9188: A2 00 00     LDX #$0000
00/918B: 9E 00 05     STZ $0500,X
00/918E: E8           INX 
00/918F: E0 20 00     CPX #$0020
00/9192: D0 F7        BNE $918B
00/9194: 60           RTS 

; [ reset sprites 0-63 ]

00/9195: A2 00 00     LDX #$0000
00/9198: A9 F0        LDA #$F0
00/919A: 9D 01 03     STA $0301,X
00/919D: E8           INX 
00/919E: E8           INX 
00/919F: E8           INX 
00/91A0: E8           INX 
00/91A1: E0 00 01     CPX #$0100
00/91A4: D0 F4        BNE $919A
00/91A6: A2 00 00     LDX #$0000
00/91A9: 9E 00 05     STZ $0500,X
00/91AC: E8           INX 
00/91AD: E0 20 00     CPX #$0020
00/91B0: D0 F7        BNE $91A9
00/91B2: 60           RTS 

; [ load world map palette ]

;  A: source bank
; +X: source address

00/91B3: 48           PHA 
00/91B4: AB           PLB 
00/91B5: A0 00 00     LDY #$0000
00/91B8: BD 00 00     LDA $0000,X
00/91BB: 99 DB 0C     STA $0CDB,Y
00/91BE: E8           INX 
00/91BF: C8           INY 
00/91C0: C0 00 01     CPY #$0100
00/91C3: D0 F3        BNE $91B8
00/91C5: A9 00        LDA #$00
00/91C7: 48           PHA 
00/91C8: AB           PLB 
00/91C9: 60           RTS 

; [ update screen wipe (irq) ]

00/91CA: A5 7F        LDA $7F
00/91CC: D0 25        BNE $91F3       ; branch if not 1st irq
; 1st irq
00/91CE: A5 79        LDA $79
00/91D0: 0A           ASL 
00/91D1: AA           TAX 
00/91D2: A9 6F        LDA #$6F
00/91D4: 18           CLC 
00/91D5: 7F 1F FB 14  ADC $14FB1F,X
00/91D9: A8           TAY 
00/91DA: 8C 09 42     STY $4209
00/91DD: A5 B1        LDA $B1
00/91DF: D0 05        BNE $91E6
00/91E1: A9 0F        LDA #$0F
00/91E3: 4C E8 91     JMP $91E8
00/91E6: A5 80        LDA $80
00/91E8: A2 03 00     LDX #$0003
00/91EB: CA           DEX 
00/91EC: D0 FD        BNE $91EB
00/91EE: EA           NOP 
00/91EF: 8D 00 21     STA $2100       ; set screen brightness
00/91F2: 60           RTS 
; 2nd irq
00/91F3: A2 0A 00     LDX #$000A
00/91F6: CA           DEX 
00/91F7: D0 FD        BNE $91F6
00/91F9: A9 80        LDA #$80
00/91FB: 8D 00 21     STA $2100       ; screen off
00/91FE: A9 81        LDA #$81
00/9200: 8D 00 42     STA $4200       ; enable nmi
00/9203: 60           RTS 

; [ update screen wipe (nmi) ]

00/9204: A5 79        LDA $79
00/9206: 0A           ASL 
00/9207: AA           TAX 
00/9208: A9 6F        LDA #$6F
00/920A: 38           SEC 
00/920B: FF 1F FB 14  SBC $14FB1F,X
00/920F: A8           TAY 
00/9210: 8C 09 42     STY $4209
00/9213: A9 80        LDA #$80
00/9215: 38           SEC 
00/9216: FF 1E FB 14  SBC $14FB1E,X
00/921A: 8D 26 21     STA $2126
00/921D: A9 7F        LDA #$7F
00/921F: 18           CLC 
00/9220: 7F 1E FB 14  ADC $14FB1E,X
00/9224: 8D 27 21     STA $2127
00/9227: A5 79        LDA $79
00/9229: 4A           LSR 
00/922A: 0A           ASL 
00/922B: 0A           ASL 
00/922C: 0A           ASL 
00/922D: 0A           ASL 
00/922E: 18           CLC 
00/922F: 69 03        ADC #$03
00/9231: 8D 77 06     STA $0677
00/9234: A9 A1        LDA #$A1
00/9236: 8D 00 42     STA $4200       ; enable nmi and irq
00/9239: A9 80        LDA #$80
00/923B: 8D 00 21     STA $2100       ; screen off
00/923E: 60           RTS 

; [ screen wipe (out) ]

00/923F: A9 01        LDA #$01
00/9241: 85 D9        STA $D9
00/9243: A9 07        LDA #$07
00/9245: 8D 2C 21     STA $212C
00/9248: A9 01        LDA #$01
00/924A: 8D 2D 21     STA $212D
00/924D: 64 7A        STZ $7A
00/924F: 64 79        STZ $79
00/9251: A9 81        LDA #$81
00/9253: 8D 00 42     STA $4200       ; enable nmi
00/9256: 58           CLI 
00/9257: 20 2D 91     JSR $912D       ; wait for vblank
00/925A: A5 7F        LDA $7F
00/925C: C9 02        CMP #$02
00/925E: D0 FA        BNE $925A       ; wait for 2nd irq
00/9260: E6 79        INC $79
00/9262: A5 79        LDA $79
00/9264: C9 20        CMP #$20
00/9266: D0 EF        BNE $9257
00/9268: 60           RTS 

; [ screen wipe (in) ]

00/9269: A9 01        LDA #$01
00/926B: 85 D9        STA $D9
00/926D: 64 7A        STZ $7A
00/926F: A9 1F        LDA #$1F
00/9271: 85 79        STA $79
00/9273: A9 80        LDA #$80
00/9275: 8D 00 21     STA $2100       ; screen off
00/9278: A9 81        LDA #$81
00/927A: 8D 00 42     STA $4200       ; enable nmi
00/927D: 58           CLI 
00/927E: 20 2D 91     JSR $912D       ; wait for vblank
00/9281: A5 7F        LDA $7F
00/9283: C9 02        CMP #$02
00/9285: D0 FA        BNE $9281       ; wait for 2nd irq
00/9287: C6 79        DEC $79
00/9289: 10 F3        BPL $927E
00/928B: 64 D9        STZ $D9
00/928D: A5 B1        LDA $B1
00/928F: D0 05        BNE $9296
00/9291: A9 0F        LDA #$0F
00/9293: 4C 98 92     JMP $9298
00/9296: A5 80        LDA $80
00/9298: 8D 00 21     STA $2100       ; set screen brightness
00/929B: 60           RTS 

; [ asl ]

; unused

00/929C: 0A           ASL 
00/929D: 0A           ASL 
00/929E: 0A           ASL 
00/929F: 0A           ASL 
00/92A0: 0A           ASL 
00/92A1: 0A           ASL 
00/92A2: 60           RTS 

; [ field nmi ]

00/92A3: 08           PHP 
00/92A4: C2 20        REP #$20
00/92A6: 48           PHA 
00/92A7: DA           PHX 
00/92A8: 5A           PHY 
00/92A9: 8B           PHB 
00/92AA: 0B           PHD 
00/92AB: A9 00 00     LDA #$0000
00/92AE: E2 20        SEP #$20
00/92B0: AD 10 42     LDA $4210
00/92B3: AD 10 42     LDA $4210
00/92B6: 9C 0B 42     STZ $420B
00/92B9: 9C 0C 42     STZ $420C
00/92BC: A2 00 06     LDX #$0600
00/92BF: DA           PHX 
00/92C0: 2B           PLD 
00/92C1: A9 00        LDA #$00
00/92C3: 48           PHA 
00/92C4: AB           PLB 
00/92C5: 64 7F        STZ $7F         ; clear irq counter
00/92C7: 22 DC CA 15  JSL $15CADC     ; transfer sprite data to ppu
00/92CB: A5 C4        LDA $C4
00/92CD: F0 08        BEQ $92D7
00/92CF: 20 35 EE     JSR $EE35       ; transfer inverted palette to ppu
00/92D2: 64 C4        STZ $C4
00/92D4: 4C DB 92     JMP $92DB
00/92D7: 22 5E CA 15  JSL $15CA5E     ; transfer palettes to ppu
00/92DB: 22 63 C1 15  JSL $15C163     ; update mode 7 zoom hdma table
00/92DF: A5 7E        LDA $7E
00/92E1: F0 05        BEQ $92E8       ; branch if not short vblank
00/92E3: 64 7E        STZ $7E
00/92E5: 4C 7C 93     JMP $937C
00/92E8: A5 D9        LDA $D9
00/92EA: F0 06        BEQ $92F2
00/92EC: 20 04 92     JSR $9204       ; update screen wipe
00/92EF: 4C 7C 93     JMP $937C
00/92F2: AD 00 17     LDA $1700
00/92F5: C9 03        CMP #$03
00/92F7: D0 03        BNE $92FC
00/92F9: 4C 2F 93     JMP $932F
; world map
00/92FC: 20 57 8E     JSR $8E57       ; transfer water/lava graphics to vram
00/92FF: A5 7A        LDA $7A
00/9301: 4A           LSR 
00/9302: 90 03        BCC $9307
00/9304: 4C 1F 93     JMP $931F
00/9307: A5 94        LDA $94
00/9309: F0 05        BEQ $9310
00/930B: 64 94        STZ $94
00/930D: 20 74 FC     JSR $FC74       ; transfer world tilemap to vram
00/9310: 22 BD C3 15  JSL $15C3BD     ; update big whale palette animation
00/9314: 22 EA C3 15  JSL $15C3EA     ; update tower of bab-il palette animation
00/9318: 22 CD C4 15  JSL $15C4CD
00/931C: 4C 7C 93     JMP $937C
00/931F: A5 94        LDA $94
00/9321: F0 05        BEQ $9328
00/9323: 64 94        STZ $94
00/9325: 20 74 FC     JSR $FC74       ; transfer world tilemap to vram
00/9328: 22 8B C8 15  JSL $15C88B     ; load player sprite graphics
00/932C: 4C 7C 93     JMP $937C
; sub-map
00/932F: A5 94        LDA $94
00/9331: F0 05        BEQ $9338
00/9333: 64 94        STZ $94
00/9335: 20 C2 FB     JSR $FBC2       ; transfer bg1 tilemap to vram (scrolling)
00/9338: 22 E5 C7 15  JSL $15C7E5     ; transfer chest/door tilemap to vram
00/933C: 20 9C EF     JSR $EF9C       ; transfer secret door tilemap to vram
00/933F: 20 46 B9     JSR $B946       ; transfer map name window to vram
00/9342: 20 A9 B8     JSR $B8A9       ; hide map name window
00/9345: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/9348: 20 5F B7     JSR $B75F       ; transfer dialogue window to vram
00/934B: A5 DF        LDA $DF
00/934D: F0 03        BEQ $9352
00/934F: 20 F1 B6     JSR $B6F1       ; init irq for dialogue window
00/9352: A5 DA        LDA $DA
00/9354: F0 03        BEQ $9359
00/9356: 20 AC B0     JSR $B0AC
00/9359: A5 7A        LDA $7A
00/935B: 4A           LSR 
00/935C: 90 10        BCC $936E
00/935E: 4C 61 93     JMP $9361
00/9361: 20 0D B8     JSR $B80D       ; transfer dialogue text to vram
00/9364: 20 74 B1     JSR $B174       ; transfer item selection window to vram
00/9367: 22 1A C4 15  JSL $15C41A
00/936B: 4C 7C 93     JMP $937C
00/936E: 22 8B C8 15  JSL $15C88B     ; load player sprite graphics
00/9372: 20 94 8A     JSR $8A94       ; transfer cave water graphics to vram
00/9375: 22 5F CB 15  JSL $15CB5F     ; transfer bg animation graphics to vram
00/9379: 4C 7C 93     JMP $937C
00/937C: A5 CA        LDA $CA
00/937E: C9 02        CMP #$02
00/9380: D0 0D        BNE $938F
00/9382: E6 80        INC $80
00/9384: A5 80        LDA $80
00/9386: 8D 00 21     STA $2100       ; set screen brightness
00/9389: C9 0F        CMP #$0F
00/938B: D0 02        BNE $938F
00/938D: 64 CA        STZ $CA
00/938F: 20 33 F5     JSR $F533       ; update bg2 scroll
00/9392: A5 C2        LDA $C2
00/9394: F0 17        BEQ $93AD
00/9396: A5 D9        LDA $D9
00/9398: D0 13        BNE $93AD
00/939A: A5 B1        LDA $B1
00/939C: D0 0F        BNE $93AD
00/939E: AD 04 17     LDA $1704
00/93A1: D0 0A        BNE $93AD
00/93A3: A5 7B        LDA $7B
00/93A5: 29 0C        AND #$0C
00/93A7: 0A           ASL 
00/93A8: 0A           ASL 
00/93A9: 09 03        ORA #$03
00/93AB: 85 77        STA $77
00/93AD: A5 77        LDA $77
00/93AF: 8D 06 21     STA $2106
00/93B2: 64 10        STZ $10
00/93B4: A5 E3        LDA $E3
00/93B6: F0 0B        BEQ $93C3
00/93B8: A9 01        LDA #$01
00/93BA: 85 10        STA $10
00/93BC: 20 28 C4     JSR $C428       ; random (0..255)
00/93BF: 29 01        AND #$01
00/93C1: D0 21        BNE $93E4
00/93C3: A5 5A        LDA $5A
00/93C5: 18           CLC 
00/93C6: 65 10        ADC $10
00/93C8: 8D 0D 21     STA $210D
00/93CB: A5 5B        LDA $5B
00/93CD: 69 00        ADC #$00
00/93CF: 8D 0D 21     STA $210D
00/93D2: A5 5E        LDA $5E
00/93D4: 18           CLC 
00/93D5: 65 10        ADC $10
00/93D7: 8D 0F 21     STA $210F
00/93DA: A5 5F        LDA $5F
00/93DC: 69 00        ADC #$00
00/93DE: 8D 0F 21     STA $210F
00/93E1: 4C 02 94     JMP $9402
00/93E4: A5 5A        LDA $5A
00/93E6: 38           SEC 
00/93E7: E5 10        SBC $10
00/93E9: 8D 0D 21     STA $210D
00/93EC: A5 5B        LDA $5B
00/93EE: E9 00        SBC #$00
00/93F0: 8D 0D 21     STA $210D
00/93F3: A5 5E        LDA $5E
00/93F5: 38           SEC 
00/93F6: E5 10        SBC $10
00/93F8: 8D 0F 21     STA $210F
00/93FB: A5 5F        LDA $5F
00/93FD: E9 00        SBC #$00
00/93FF: 8D 0F 21     STA $210F
00/9402: A5 5C        LDA $5C
00/9404: 8D 0E 21     STA $210E
00/9407: A5 5D        LDA $5D
00/9409: 8D 0E 21     STA $210E
00/940C: A5 60        LDA $60
00/940E: 8D 10 21     STA $2110
00/9411: A5 61        LDA $61
00/9413: 8D 10 21     STA $2110
00/9416: A5 5A        LDA $5A
00/9418: 18           CLC 
00/9419: 69 78        ADC #$78
00/941B: 85 6A        STA $6A
00/941D: A5 5B        LDA $5B
00/941F: 69 00        ADC #$00
00/9421: 85 6B        STA $6B
00/9423: A5 5C        LDA $5C
00/9425: 18           CLC 
00/9426: 69 78        ADC #$78
00/9428: 85 6C        STA $6C
00/942A: A5 5D        LDA $5D
00/942C: 69 00        ADC #$00
00/942E: 85 6D        STA $6D
00/9430: A5 6A        LDA $6A
00/9432: 8D 1F 21     STA $211F
00/9435: A5 6B        LDA $6B
00/9437: 8D 1F 21     STA $211F
00/943A: A5 6C        LDA $6C
00/943C: 8D 20 21     STA $2120
00/943F: A5 6D        LDA $6D
00/9441: 8D 20 21     STA $2120
00/9444: AD 00 17     LDA $1700
00/9447: C9 03        CMP #$03
00/9449: F0 05        BEQ $9450       ; branch if a sub-map
00/944B: A9 30        LDA #$30        ; enable mode 7 zoom hdma
00/944D: 8D 0C 42     STA $420C
00/9450: 22 10 80 01  JSL $018010     ; update controller
00/9454: E6 7A        INC $7A
00/9456: EE FF 0F     INC $0FFF
00/9459: EE A3 16     INC $16A3       ; increment game time
00/945C: AD A3 16     LDA $16A3
00/945F: C9 3C        CMP #$3C
00/9461: 90 10        BCC $9473
00/9463: 9C A3 16     STZ $16A3
00/9466: EE A4 16     INC $16A4
00/9469: D0 08        BNE $9473
00/946B: EE A5 16     INC $16A5
00/946E: D0 03        BNE $9473
00/9470: EE A6 16     INC $16A6
00/9473: 64 7D        STZ $7D
00/9475: C2 20        REP #$20
00/9477: 2B           PLD 
00/9478: AB           PLB 
00/9479: 7A           PLY 
00/947A: FA           PLX 
00/947B: 68           PLA 
00/947C: 28           PLP 
00/947D: 40           RTI 

; [ field irq ]

00/947E: 08           PHP 
00/947F: C2 20        REP #$20
00/9481: 48           PHA 
00/9482: DA           PHX 
00/9483: 5A           PHY 
00/9484: 8B           PHB 
00/9485: 0B           PHD 
00/9486: A9 00 00     LDA #$0000
00/9489: E2 20        SEP #$20
00/948B: A2 00 06     LDX #$0600
00/948E: DA           PHX 
00/948F: 2B           PLD 
00/9490: A9 00        LDA #$00
00/9492: 48           PHA 
00/9493: AB           PLB 
00/9494: AD 11 42     LDA $4211
00/9497: A5 D9        LDA $D9
00/9499: F0 06        BEQ $94A1
00/949B: 20 CA 91     JSR $91CA       ; update screen wipe
00/949E: 4C B5 94     JMP $94B5
00/94A1: A5 DF        LDA $DF
00/94A3: F0 06        BEQ $94AB
00/94A5: 20 14 B7     JSR $B714       ; update dialogue window
00/94A8: 4C B5 94     JMP $94B5
00/94AB: A5 DA        LDA $DA
00/94AD: F0 06        BEQ $94B5
00/94AF: 20 CF B0     JSR $B0CF       ; update item selection window
00/94B2: 4C B5 94     JMP $94B5
00/94B5: E6 7F        INC $7F         ; set irq flag
00/94B7: C2 20        REP #$20
00/94B9: 2B           PLD 
00/94BA: AB           PLB 
00/94BB: 7A           PLY 
00/94BC: FA           PLX 
00/94BD: 68           PLA 
00/94BE: 28           PLP 
00/94BF: 40           RTI 

; [ draw world map sprites ]

00/94C0: 22 0C B3 15  JSL $15B30C     ; draw player sprite
00/94C4: 22 DC B3 15  JSL $15B3DC     ; draw chocobo sprite
00/94C8: 22 F9 B4 15  JSL $15B4F9     ; draw black chocobo sprite
00/94CC: 22 0F B7 15  JSL $15B70F     ; draw hovercraft sprite
00/94D0: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/94D4: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/94D8: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/94DC: 22 6F B6 15  JSL $15B66F     ; draw ship sprite
00/94E0: A9 3E        LDA #$3E
00/94E2: 20 ED F3     JSR $F3ED       ; check event switch
00/94E5: C9 00        CMP #$00
00/94E7: F0 04        BEQ $94ED
00/94E9: 22 EF B5 15  JSL $15B5EF     ; draw dwarf tank sprites
00/94ED: 60           RTS 

; [ init character properties ]

00/94EE: A2 00 00     LDX #$0000
00/94F1: A0 00 00     LDY #$0000
00/94F4: BF 00 A9 0F  LDA $0FA900,X
00/94F8: 99 00 10     STA $1000,Y
00/94FB: E8           INX 
00/94FC: C8           INY 
00/94FD: C0 14 00     CPY #$0014
00/9500: D0 F2        BNE $94F4
00/9502: A0 00 00     LDY #$0000
00/9505: BF 00 A9 0F  LDA $0FA900,X   ; crit rate, bonus, and ???
00/9509: 99 2D 10     STA $102D,Y
00/950C: E8           INX 
00/950D: C8           INY 
00/950E: C0 03 00     CPY #$0003
00/9511: D0 F2        BNE $9505
00/9513: A0 00 00     LDY #$0000
00/9516: BF 00 A9 0F  LDA $0FA900,X
00/951A: 99 37 10     STA $1037,Y
00/951D: E8           INX 
00/951E: C8           INY 
00/951F: C0 09 00     CPY #$0009
00/9522: D0 F2        BNE $9516
00/9524: A0 00 00     LDY #$0000
00/9527: 84 3D        STY $3D
00/9529: 20 E6 E8     JSR $E8E6
00/952C: A9 00        LDA #$00
00/952E: 22 06 80 03  JSL $038006     ; update character equipment
00/9532: 60           RTS 

; --------------------------------------------------------------------------

; [ travel from overworld to underground ]

00/9533: A9 03        LDA #$03
00/9535: 8D 05 17     STA $1705       ; face left
00/9538: A9 1F        LDA #$1F
00/953A: 85 79        STA $79
00/953C: 20 4B 91     JSR $914B       ; wait one frame
00/953F: A5 79        LDA $79
00/9541: 85 AD        STA $AD
00/9543: AD 04 17     LDA $1704
00/9546: C9 04        CMP #$04
00/9548: D0 07        BNE $9551
00/954A: C6 B7        DEC $B7
00/954C: A5 B7        LDA $B7
00/954E: 4C 55 95     JMP $9555
00/9551: C6 B8        DEC $B8
00/9553: A5 B8        LDA $B8
00/9555: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/9559: 20 77 91     JSR $9177       ; reset all sprites
00/955C: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/9560: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/9564: C6 79        DEC $79
00/9566: A5 79        LDA $79
00/9568: C9 10        CMP #$10
00/956A: B0 D0        BCS $953C
00/956C: A9 1F        LDA #$1F
00/956E: 85 79        STA $79
00/9570: A9 1F        LDA #$1F
00/9572: 38           SEC 
00/9573: E5 79        SBC $79
00/9575: AA           TAX 
00/9576: BF B6 FA 14  LDA $14FAB6,X
00/957A: 8D FB 06     STA $06FB
00/957D: A5 79        LDA $79
00/957F: 85 AD        STA $AD
00/9581: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/9584: 9C 0C 42     STZ $420C
00/9587: 20 BA 90     JSR $90BA       ; calculate mode 7 rotation parameters
00/958A: 20 04 91     JSR $9104       ; update mode 7 registers
00/958D: 20 27 A5     JSR $A527
00/9590: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/9594: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/9598: C6 79        DEC $79
00/959A: A5 79        LDA $79
00/959C: 10 D2        BPL $9570
00/959E: A9 71        LDA #$71
00/95A0: 8D 06 17     STA $1706
00/95A3: A9 10        LDA #$10
00/95A5: 8D 07 17     STA $1707
00/95A8: A9 01        LDA #$01
00/95AA: 8D 00 17     STA $1700
00/95AD: 8D 01 17     STA $1701
00/95B0: AD 04 17     LDA $1704
00/95B3: C9 04        CMP #$04
00/95B5: D0 12        BNE $95C9
00/95B7: A9 01        LDA #$01
00/95B9: 8D 1F 17     STA $171F
00/95BC: AD D0 06     LDA $06D0
00/95BF: F0 0D        BEQ $95CE       ; branch if not holding hovercraft
00/95C1: A9 01        LDA #$01
00/95C3: 8D 1B 17     STA $171B
00/95C6: 4C CE 95     JMP $95CE
00/95C9: A9 01        LDA #$01
00/95CB: 8D 23 17     STA $1723
00/95CE: 20 3C 85     JSR $853C
00/95D1: A9 10        LDA #$10
00/95D3: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/95D7: A9 03        LDA #$03
00/95D9: 8D 05 17     STA $1705       ; face left
00/95DC: A9 81        LDA #$81
00/95DE: 8D 00 42     STA $4200       ; enable nmi
00/95E1: A9 00        LDA #$00
00/95E3: 8D 00 21     STA $2100       ; screen on, zero brightness
00/95E6: A9 20        LDA #$20
00/95E8: 85 AD        STA $AD
00/95EA: A9 2F        LDA #$2F
00/95EC: 85 79        STA $79
00/95EE: 20 4B 91     JSR $914B       ; wait one frame
00/95F1: A9 2F        LDA #$2F
00/95F3: 38           SEC 
00/95F4: E5 79        SBC $79
00/95F6: C9 10        CMP #$10
00/95F8: B0 03        BCS $95FD
00/95FA: 8D 00 21     STA $2100       ; set screen brightness
00/95FD: A5 79        LDA $79
00/95FF: AA           TAX 
00/9600: AD 04 17     LDA $1704
00/9603: C9 04        CMP #$04
00/9605: D0 09        BNE $9610
00/9607: BF 86 FA 14  LDA $14FA86,X
00/960B: 85 B7        STA $B7
00/960D: 4C 16 96     JMP $9616
00/9610: BF 86 FA 14  LDA $14FA86,X
00/9614: 85 B8        STA $B8
00/9616: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/961A: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/961E: C6 79        DEC $79
00/9620: A5 79        LDA $79
00/9622: C9 FF        CMP #$FF
00/9624: D0 C8        BNE $95EE
00/9626: 60           RTS 

; [ travel from underground to overworld ]

00/9627: 20 4B 96     JSR $964B
00/962A: A9 30        LDA #$30
00/962C: 20 ED F3     JSR $F3ED       ; check event switch
00/962F: C9 00        CMP #$00
00/9631: D0 14        BNE $9647
00/9633: A9 3D        LDA #$3D
00/9635: 20 ED F3     JSR $F3ED       ; check event switch
00/9638: C9 00        CMP #$00
00/963A: F0 0B        BEQ $9647
00/963C: A9 01        LDA #$01
00/963E: 85 B1        STA $B1
00/9640: A9 C6        LDA #$C6
00/9642: 20 EB E1     JSR $E1EB       ; execute event
00/9645: 64 B1        STZ $B1
00/9647: 20 90 96     JSR $9690
00/964A: 60           RTS 

; [  ]

; animation to rise from underground

00/964B: A9 03        LDA #$03
00/964D: 8D 05 17     STA $1705       ; face left
00/9650: A9 00        LDA #$00
00/9652: 85 79        STA $79
00/9654: 20 4B 91     JSR $914B       ; wait one frame
00/9657: A9 2F        LDA #$2F
00/9659: 38           SEC 
00/965A: E5 79        SBC $79
00/965C: C9 10        CMP #$10
00/965E: B0 03        BCS $9663
00/9660: 8D 00 21     STA $2100       ; set screen brightness
00/9663: A5 79        LDA $79
00/9665: AA           TAX 
00/9666: AD 04 17     LDA $1704
00/9669: C9 04        CMP #$04
00/966B: D0 09        BNE $9676
00/966D: BF 86 FA 14  LDA $14FA86,X
00/9671: 85 B7        STA $B7
00/9673: 4C 7C 96     JMP $967C
00/9676: BF 86 FA 14  LDA $14FA86,X
00/967A: 85 B8        STA $B8
00/967C: 20 77 91     JSR $9177       ; reset all sprites
00/967F: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/9683: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/9687: E6 79        INC $79
00/9689: A5 79        LDA $79
00/968B: C9 30        CMP #$30
00/968D: D0 C5        BNE $9654
00/968F: 60           RTS 

; [  ]

; animation when using drill to return to the overworld

00/9690: A9 6A        LDA #$6A
00/9692: 8D 06 17     STA $1706
00/9695: A9 D4        LDA #$D4
00/9697: 8D 07 17     STA $1707
00/969A: A9 00        LDA #$00
00/969C: 8D 00 17     STA $1700
00/969F: 8D 01 17     STA $1701
00/96A2: AD 04 17     LDA $1704
00/96A5: C9 04        CMP #$04
00/96A7: D0 0E        BNE $96B7
00/96A9: 9C 1F 17     STZ $171F
00/96AC: AD D0 06     LDA $06D0
00/96AF: F0 09        BEQ $96BA       ; branch if not holding hovercraft
00/96B1: 9C 1B 17     STZ $171B
00/96B4: 4C BA 96     JMP $96BA
00/96B7: 9C 23 17     STZ $1723
00/96BA: 20 02 85     JSR $8502       ; load overworld
00/96BD: A9 03        LDA #$03
00/96BF: 8D 05 17     STA $1705       ; face left
00/96C2: A9 81        LDA #$81
00/96C4: 8D 00 42     STA $4200       ; enable nmi
00/96C7: 64 79        STZ $79
00/96C9: AD 04 17     LDA $1704
00/96CC: C9 04        CMP #$04
00/96CE: D0 05        BNE $96D5
00/96D0: 64 B7        STZ $B7
00/96D2: 4C D7 96     JMP $96D7
00/96D5: 64 B8        STZ $B8
00/96D7: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/96DA: 9C 0C 42     STZ $420C
00/96DD: A9 20        LDA #$20
00/96DF: 38           SEC 
00/96E0: E5 79        SBC $79
00/96E2: AA           TAX 
00/96E3: BF B6 FA 14  LDA $14FAB6,X
00/96E7: 8D FB 06     STA $06FB
00/96EA: A5 79        LDA $79
00/96EC: 85 AD        STA $AD
00/96EE: 20 BA 90     JSR $90BA       ; calculate mode 7 rotation parameters
00/96F1: 20 04 91     JSR $9104       ; update mode 7 registers
00/96F4: 20 27 A5     JSR $A527
00/96F7: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/96FB: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/96FF: E6 79        INC $79
00/9701: A5 79        LDA $79
00/9703: C9 20        CMP #$20
00/9705: D0 D0        BNE $96D7
00/9707: A9 11        LDA #$11
00/9709: 85 79        STA $79
00/970B: 85 AD        STA $AD
00/970D: 20 4B 91     JSR $914B       ; wait one frame
00/9710: A5 79        LDA $79
00/9712: 85 AD        STA $AD
00/9714: AD 04 17     LDA $1704
00/9717: C9 04        CMP #$04
00/9719: D0 07        BNE $9722
00/971B: E6 B7        INC $B7
00/971D: A5 B7        LDA $B7
00/971F: 4C 26 97     JMP $9726
00/9722: E6 B8        INC $B8
00/9724: A5 B8        LDA $B8
00/9726: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/972A: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/972E: 22 CC B9 15  JSL $15B9CC     ; draw falcon sprite
00/9732: E6 79        INC $79
00/9734: A5 79        LDA $79
00/9736: C9 21        CMP #$21
00/9738: D0 D3        BNE $970D
00/973A: 60           RTS 

; [ load vehicle graphics ]

00/973B: A2 00 42     LDX #$4200
00/973E: 86 4C        STX $4C
00/9740: A2 00 01     LDX #$0100
00/9743: 86 4E        STX $4E
00/9745: A2 80 C6     LDX #$C680      ; 1B/C680 (chocobo graphics)
00/9748: 86 4A        STX $4A
00/974A: A9 1B        LDA #$1B
00/974C: 85 49        STA $49
00/974E: 22 00 B0 15  JSL $15B000     ; transfer 3bpp graphics to vram
00/9752: A2 00 43     LDX #$4300
00/9755: 86 4C        STX $4C
00/9757: A2 00 1D     LDX #$1D00
00/975A: 86 4E        STX $4E
00/975C: A2 00 80     LDX #$8000      ; 1C/8000 (vehicle graphics)
00/975F: 86 4A        STX $4A
00/9761: A9 1C        LDA #$1C
00/9763: 85 49        STA $49
00/9765: 22 00 B0 15  JSL $15B000     ; transfer 3bpp graphics to vram
00/9769: A0 00 00     LDY #$0000
00/976C: A2 00 00     LDX #$0000
00/976F: BF 40 80 0D  LDA $0D8040,X
00/9773: 99 5B 0E     STA $0E5B,Y
00/9776: E8           INX 
00/9777: C8           INY 
00/9778: 98           TYA 
00/9779: 29 0F        AND #$0F
00/977B: D0 F2        BNE $976F
00/977D: A9 00        LDA #$00
00/977F: 99 5B 0E     STA $0E5B,Y
00/9782: C8           INY 
00/9783: 98           TYA 
00/9784: 29 0F        AND #$0F
00/9786: D0 F5        BNE $977D
00/9788: C0 80 00     CPY #$0080
00/978B: D0 E2        BNE $976F
00/978D: 22 44 C1 15  JSL $15C144
00/9791: 60           RTS 

; [ load sprite graphics (world map) ]

00/9792: A9 01        LDA #$01        ; enable player graphics update
00/9794: 85 CC        STA $CC
00/9796: 22 8B C8 15  JSL $15C88B     ; load player sprite graphics
00/979A: 22 27 C8 15  JSL $15C827     ; load player sprite palettes
00/979E: 20 3B 97     JSR $973B       ; load vehicle graphics
00/97A1: 60           RTS 

; [ load sprite graphics (sub-map) ]

00/97A2: A9 01        LDA #$01        ; enable player graphics update
00/97A4: 85 CC        STA $CC
00/97A6: 22 8B C8 15  JSL $15C88B     ; load player sprite graphics
00/97AA: 22 27 C8 15  JSL $15C827     ; load player sprite palettes
00/97AE: 22 44 C1 15  JSL $15C144
00/97B2: 60           RTS 

; [ do poison damage ]

00/97B3: 64 C2        STZ $C2
00/97B5: AD 04 17     LDA $1704
00/97B8: D0 44        BNE $97FE
00/97BA: A2 00 00     LDX #$0000
00/97BD: BD 00 10     LDA $1000,X
00/97C0: F0 27        BEQ $97E9
00/97C2: BD 03 10     LDA $1003,X
00/97C5: 29 01        AND #$01
00/97C7: F0 20        BEQ $97E9
00/97C9: E6 C2        INC $C2
00/97CB: C2 20        REP #$20
00/97CD: BD 07 10     LDA $1007,X
00/97D0: F0 12        BEQ $97E4
00/97D2: 38           SEC 
00/97D3: E9 01 00     SBC #$0001
00/97D6: 9D 07 10     STA $1007,X
00/97D9: C9 01 00     CMP #$0001
00/97DC: B0 06        BCS $97E4
00/97DE: A9 01 00     LDA #$0001
00/97E1: 9D 07 10     STA $1007,X
00/97E4: A9 00 00     LDA #$0000
00/97E7: E2 20        SEP #$20
00/97E9: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/97EC: E0 40 01     CPX #$0140
00/97EF: D0 CC        BNE $97BD
00/97F1: A5 C2        LDA $C2
00/97F3: F0 09        BEQ $97FE
00/97F5: A5 B1        LDA $B1
00/97F7: D0 05        BNE $97FE
00/97F9: A9 7A        LDA #$7A
00/97FB: 20 99 8D     JSR $8D99       ; play sound effect
00/97FE: 60           RTS 

; [ do floor damage ]

00/97FF: 64 C1        STZ $C1
00/9801: A5 A2        LDA $A2
00/9803: 29 01        AND #$01
00/9805: F0 3B        BEQ $9842
00/9807: A2 00 00     LDX #$0000
00/980A: BD 00 10     LDA $1000,X
00/980D: F0 2B        BEQ $983A
00/980F: BD 03 10     LDA $1003,X
00/9812: 30 26        BMI $983A
00/9814: BD 04 10     LDA $1004,X
00/9817: 29 40        AND #$40
00/9819: D0 1F        BNE $983A
00/981B: E6 C1        INC $C1
00/981D: C2 20        REP #$20
00/981F: BD 07 10     LDA $1007,X
00/9822: F0 11        BEQ $9835
00/9824: 38           SEC 
00/9825: E9 32 00     SBC #$0032
00/9828: 9D 07 10     STA $1007,X
00/982B: F0 02        BEQ $982F
00/982D: B0 06        BCS $9835
00/982F: A9 01 00     LDA #$0001
00/9832: 9D 07 10     STA $1007,X
00/9835: A9 00 00     LDA #$0000
00/9838: E2 20        SEP #$20
00/983A: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/983D: E0 40 01     CPX #$0140
00/9840: D0 C8        BNE $980A
00/9842: A5 C1        LDA $C1
00/9844: F0 05        BEQ $984B
00/9846: A9 7B        LDA #$7B
00/9848: 20 99 8D     JSR $8D99       ; play sound effect
00/984B: 60           RTS 

; [ check treasures and npcs ]

00/984C: A5 B1        LDA $B1
00/984E: D0 26        BNE $9876
00/9850: A5 5A        LDA $5A
00/9852: 29 0F        AND #$0F
00/9854: D0 20        BNE $9876
00/9856: A5 5C        LDA $5C
00/9858: 29 0F        AND #$0F
00/985A: D0 1A        BNE $9876
00/985C: A5 02        LDA $02
00/985E: 29 80        AND #$80
00/9860: D0 01        BNE $9863
00/9862: 60           RTS 
00/9863: A5 54        LDA $54
00/9865: F0 01        BEQ $9868
00/9867: 60           RTS 
00/9868: E6 54        INC $54
00/986A: A5 EA        LDA $EA         ; close map name window
00/986C: D0 02        BNE $9870
00/986E: E6 EA        INC $EA
00/9870: 20 77 98     JSR $9877       ; check treasures
00/9873: 20 0A BA     JSR $BA0A       ; check npcs
00/9876: 60           RTS 

; [ check treasures ]

00/9877: AD 05 17     LDA $1705       ; facing direction
00/987A: D0 12        BNE $988E
; up
00/987C: A5 A4        LDA $A4
00/987E: 10 52        BPL $98D2
00/9880: AD 06 17     LDA $1706
00/9883: 85 0C        STA $0C
00/9885: AD 07 17     LDA $1707
00/9888: 3A           DEC 
00/9889: 85 0E        STA $0E
00/988B: 4C D3 98     JMP $98D3
; right
00/988E: AD 05 17     LDA $1705
00/9891: C9 01        CMP #$01
00/9893: D0 12        BNE $98A7
00/9895: A5 A6        LDA $A6
00/9897: 10 39        BPL $98D2
00/9899: AD 06 17     LDA $1706
00/989C: 1A           INC 
00/989D: 85 0C        STA $0C
00/989F: AD 07 17     LDA $1707
00/98A2: 85 0E        STA $0E
00/98A4: 4C D3 98     JMP $98D3
; down
00/98A7: AD 05 17     LDA $1705
00/98AA: C9 02        CMP #$02
00/98AC: D0 12        BNE $98C0
00/98AE: A5 A8        LDA $A8
00/98B0: 10 20        BPL $98D2
00/98B2: AD 06 17     LDA $1706
00/98B5: 85 0C        STA $0C
00/98B7: AD 07 17     LDA $1707
00/98BA: 1A           INC 
00/98BB: 85 0E        STA $0E
00/98BD: 4C D3 98     JMP $98D3
; left
00/98C0: A5 AA        LDA $AA
00/98C2: 10 0E        BPL $98D2
00/98C4: AD 06 17     LDA $1706
00/98C7: 3A           DEC 
00/98C8: 85 0C        STA $0C
00/98CA: AD 07 17     LDA $1707
00/98CD: 85 0E        STA $0E
00/98CF: 4C D3 98     JMP $98D3
00/98D2: 60           RTS 
00/98D3: AD 11 07     LDA $0711
00/98D6: D0 01        BNE $98D9       ; return if there are no treasures
00/98D8: 60           RTS 
00/98D9: 20 5B 9B     JSR $9B5B       ; get pointer to treasure properties
00/98DC: A0 00 00     LDY #$0000
00/98DF: A6 3D        LDX $3D
00/98E1: BF 00 85 15  LDA $158500,X   ; pointers to triggers
00/98E5: C5 0C        CMP $0C
00/98E7: D0 0B        BNE $98F4
00/98E9: BF 01 85 15  LDA $158501,X
00/98ED: C5 0E        CMP $0E
00/98EF: D0 03        BNE $98F4
00/98F1: 4C 01 99     JMP $9901
00/98F4: E8           INX             ; next trigger
00/98F5: E8           INX 
00/98F6: E8           INX 
00/98F7: E8           INX 
00/98F8: E8           INX 
00/98F9: C8           INY 
00/98FA: 98           TYA 
00/98FB: CD 11 07     CMP $0711
00/98FE: D0 E1        BNE $98E1
00/9900: 60           RTS 
00/9901: 86 40        STX $40
00/9903: 98           TYA 
00/9904: 18           CLC 
00/9905: 6D E7 0F     ADC $0FE7       ; treasure offset
00/9908: 8D FC 08     STA $08FC
00/990B: 20 1F 9B     JSR $9B1F       ; set treasure switch
00/990E: C9 00        CMP #$00
00/9910: F0 03        BEQ $9915
00/9912: 4C E2 99     JMP $99E2
00/9915: AD 05 17     LDA $1705
00/9918: AA           TAX 
00/9919: BD 0C 07     LDA $070C,X
00/991C: C9 78        CMP #$78
00/991E: D0 29        BNE $9949
00/9920: A5 0C        LDA $0C
00/9922: 85 3D        STA $3D
00/9924: A5 0E        LDA $0E
00/9926: 85 3E        STA $3E
00/9928: A6 3D        LDX $3D
00/992A: A9 77        LDA #$77
00/992C: 9F 71 5C 7F  STA $7F5C71,X
00/9930: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/9933: 8E FE 06     STX $06FE
00/9936: 20 E9 9A     JSR $9AE9       ; get treasure chest tiles
00/9939: A9 30        LDA #$30
00/993B: 20 99 8D     JSR $8D99       ; play sound effect
00/993E: A9 01        LDA #$01
00/9940: 85 D4        STA $D4
00/9942: A9 01        LDA #$01
00/9944: 85 B2        STA $B2
00/9946: 4C 52 99     JMP $9952
00/9949: A9 16        LDA #$16
00/994B: 85 B2        STA $B2
00/994D: A9 37        LDA #$37
00/994F: 20 99 8D     JSR $8D99       ; play sound effect
00/9952: A6 40        LDX $40
00/9954: BF 03 85 15  LDA $158503,X
00/9958: 85 09        STA $09
00/995A: BF 04 85 15  LDA $158504,X
00/995E: 85 08        STA $08
00/9960: A5 09        LDA $09
00/9962: 29 40        AND #$40
00/9964: F0 35        BEQ $999B
00/9966: A5 08        LDA $08
00/9968: 85 C6        STA $C6
00/996A: AD 01 17     LDA $1701
00/996D: 0A           ASL 
00/996E: 0A           ASL 
00/996F: 0A           ASL 
00/9970: 0A           ASL 
00/9971: 0A           ASL 
00/9972: 85 08        STA $08
00/9974: A5 09        LDA $09
00/9976: 29 1F        AND #$1F
00/9978: 18           CLC 
00/9979: 65 08        ADC $08
00/997B: 18           CLC 
00/997C: 69 C0        ADC #$C0
00/997E: 8D 00 18     STA $1800
00/9981: A9 01        LDA #$01
00/9983: 8D 01 18     STA $1801
00/9986: 20 D4 8C     JSR $8CD4       ; get battle bg (sub-map)
00/9989: A9 01        LDA #$01        ; enable battle
00/998B: 85 85        STA $85
00/998D: A9 03        LDA #$03
00/998F: 85 B2        STA $B2
00/9991: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/9994: 20 0B B3     JSR $B30B       ; open dialogue window
00/9997: 20 9E B3     JSR $B39E       ; close dialogue window
00/999A: 60           RTS 
00/999B: A5 09        LDA $09
00/999D: 29 80        AND #$80
00/999F: F0 12        BEQ $99B3
00/99A1: A5 08        LDA $08
00/99A3: 8D FB 08     STA $08FB
00/99A6: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/99A9: 20 0B B3     JSR $B30B       ; open dialogue window
00/99AC: 20 9E B3     JSR $B39E       ; close dialogue window
00/99AF: 20 36 9A     JSR $9A36       ; give item
00/99B2: 60           RTS 
00/99B3: E6 B2        INC $B2
00/99B5: A5 08        LDA $08
00/99B7: 29 7F        AND #$7F
00/99B9: 85 18        STA $18
00/99BB: 64 19        STZ $19
00/99BD: A5 08        LDA $08
00/99BF: 29 80        AND #$80
00/99C1: D0 06        BNE $99C9
00/99C3: A2 0A 00     LDX #$000A
00/99C6: 4C CC 99     JMP $99CC
00/99C9: A2 E8 03     LDX #$03E8
00/99CC: 86 1A        STX $1A
00/99CE: 22 8F C3 15  JSL $15C38F
00/99D2: 20 1D ED     JSR $ED1D
00/99D5: 20 FB 99     JSR $99FB       ; give gp
00/99D8: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/99DB: 20 0B B3     JSR $B30B       ; open dialogue window
00/99DE: 20 9E B3     JSR $B39E       ; close dialogue window
00/99E1: 60           RTS 
00/99E2: AD 05 17     LDA $1705
00/99E5: AA           TAX 
00/99E6: BD 0C 07     LDA $070C,X
00/99E9: C9 77        CMP #$77
00/99EB: D0 0D        BNE $99FA
00/99ED: A9 04        LDA #$04
00/99EF: 85 B2        STA $B2
00/99F1: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/99F4: 20 0B B3     JSR $B30B       ; open dialogue window
00/99F7: 20 9E B3     JSR $B39E       ; close dialogue window
00/99FA: 60           RTS 

; [ give gp ]

00/99FB: AD A0 16     LDA $16A0
00/99FE: 18           CLC 
00/99FF: 65 30        ADC $30
00/9A01: 8D A0 16     STA $16A0
00/9A04: AD A1 16     LDA $16A1
00/9A07: 65 31        ADC $31
00/9A09: 8D A1 16     STA $16A1
00/9A0C: AD A2 16     LDA $16A2
00/9A0F: 65 32        ADC $32
00/9A11: 8D A2 16     STA $16A2
00/9A14: C9 98        CMP #$98
00/9A16: 90 1D        BCC $9A35
00/9A18: AD A1 16     LDA $16A1
00/9A1B: C9 96        CMP #$96
00/9A1D: 90 16        BCC $9A35
00/9A1F: AD A0 16     LDA $16A0
00/9A22: C9 7F        CMP #$7F
00/9A24: 90 0F        BCC $9A35
00/9A26: A9 7F        LDA #$7F
00/9A28: 8D A0 16     STA $16A0
00/9A2B: A9 96        LDA #$96
00/9A2D: 8D A1 16     STA $16A1
00/9A30: A9 98        LDA #$98
00/9A32: 8D A2 16     STA $16A2
00/9A35: 60           RTS 

; [ give item ]

00/9A36: A9 01        LDA #$01
00/9A38: 85 06        STA $06
00/9A3A: AD FB 08     LDA $08FB
00/9A3D: C9 60        CMP #$60
00/9A3F: B0 08        BCS $9A49
00/9A41: C9 54        CMP #$54
00/9A43: 90 04        BCC $9A49
00/9A45: A9 0A        LDA #$0A
00/9A47: 85 06        STA $06
00/9A49: A0 00 00     LDY #$0000
00/9A4C: B9 40 14     LDA $1440,Y
00/9A4F: CD FB 08     CMP $08FB
00/9A52: D0 07        BNE $9A5B
00/9A54: B9 41 14     LDA $1441,Y
00/9A57: C9 63        CMP #$63
00/9A59: D0 73        BNE $9ACE
00/9A5B: C8           INY 
00/9A5C: C8           INY 
00/9A5D: C0 60 00     CPY #$0060
00/9A60: D0 EA        BNE $9A4C
00/9A62: A0 00 00     LDY #$0000
00/9A65: B9 40 14     LDA $1440,Y
00/9A68: F0 5E        BEQ $9AC8
00/9A6A: C8           INY 
00/9A6B: C8           INY 
00/9A6C: C0 60 00     CPY #$0060
00/9A6F: F0 03        BEQ $9A74
00/9A71: 4C 65 9A     JMP $9A65
00/9A74: AD FB 08     LDA $08FB
00/9A77: 8D 04 18     STA $1804
00/9A7A: 9C 05 18     STZ $1805
00/9A7D: 9C 06 18     STZ $1806
00/9A80: 9C 07 18     STZ $1807
00/9A83: 9C 08 18     STZ $1808
00/9A86: 9C 09 18     STZ $1809
00/9A89: 9C 0A 18     STZ $180A
00/9A8C: 9C 0B 18     STZ $180B
00/9A8F: A9 00        LDA #$00
00/9A91: 20 D1 8D     JSR $8DD1       ; fade out
00/9A94: 22 20 80 01  JSL $018020     ; treasure menu
00/9A98: 20 ED 89     JSR $89ED       ; init interrupt jump code
00/9A9B: A2 00 00     LDX #$0000
00/9A9E: 9E 04 18     STZ $1804,X
00/9AA1: E8           INX 
00/9AA2: E0 08 00     CPX #$0008
00/9AA5: D0 F7        BNE $9A9E
00/9AA7: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/9AAB: A9 01        LDA #$01
00/9AAD: 85 C5        STA $C5
00/9AAF: 20 52 84     JSR $8452       ; reload sub-map
00/9AB2: 20 1F C1     JSR $C11F       ; reload npcs
00/9AB5: 58           CLI 
00/9AB6: A9 81        LDA #$81
00/9AB8: 8D 00 42     STA $4200       ; enable nmi
00/9ABB: 22 E0 B1 15  JSL $15B1E0     ; draw player sprite
00/9ABF: 20 68 BB     JSR $BB68       ; draw npcs
00/9AC2: A9 00        LDA #$00
00/9AC4: 20 B0 8D     JSR $8DB0       ; fade in
00/9AC7: 60           RTS 
00/9AC8: AD FB 08     LDA $08FB
00/9ACB: 99 40 14     STA $1440,Y
00/9ACE: B9 41 14     LDA $1441,Y
00/9AD1: 18           CLC 
00/9AD2: 65 06        ADC $06
00/9AD4: C9 64        CMP #$64
00/9AD6: 90 0D        BCC $9AE5
00/9AD8: 38           SEC 
00/9AD9: E9 63        SBC #$63
00/9ADB: 85 06        STA $06
00/9ADD: A9 63        LDA #$63
00/9ADF: 99 41 14     STA $1441,Y
00/9AE2: 4C 49 9A     JMP $9A49
00/9AE5: 99 41 14     STA $1441,Y
00/9AE8: 60           RTS 

; [ get treasure chest tiles ]

00/9AE9: C2 20        REP #$20
00/9AEB: AF EE 48 7F  LDA $7F48EE
00/9AEF: 8D 00 07     STA $0700
00/9AF2: AF EE 49 7F  LDA $7F49EE
00/9AF6: 8D 02 07     STA $0702
00/9AF9: AF EE 4A 7F  LDA $7F4AEE
00/9AFD: 8D 04 07     STA $0704
00/9B00: AF EE 4B 7F  LDA $7F4BEE
00/9B04: 8D 06 07     STA $0706
00/9B07: A9 00 00     LDA #$0000
00/9B0A: E2 20        SEP #$20
00/9B0C: 60           RTS 

; [ check treasure switch ]

00/9B0D: 20 42 9B     JSR $9B42       ; get treasure switch id
00/9B10: BD A0 12     LDA $12A0,X
00/9B13: 85 07        STA $07
00/9B15: 46 07        LSR $07
00/9B17: 88           DEY 
00/9B18: D0 FB        BNE $9B15
00/9B1A: A9 00        LDA #$00
00/9B1C: 69 00        ADC #$00
00/9B1E: 60           RTS 

; [ set treasure switch ]

00/9B1F: 20 42 9B     JSR $9B42       ; get treasure switch id
00/9B22: A9 01        LDA #$01
00/9B24: 88           DEY 
00/9B25: F0 04        BEQ $9B2B
00/9B27: 0A           ASL 
00/9B28: 4C 24 9B     JMP $9B24
00/9B2B: 85 06        STA $06
00/9B2D: BD A0 12     LDA $12A0,X
00/9B30: 25 06        AND $06
00/9B32: 85 07        STA $07
00/9B34: D0 09        BNE $9B3F
00/9B36: BD A0 12     LDA $12A0,X
00/9B39: 18           CLC 
00/9B3A: 65 06        ADC $06
00/9B3C: 9D A0 12     STA $12A0,X
00/9B3F: A5 07        LDA $07
00/9B41: 60           RTS 

; [ get treasure switch id ]

00/9B42: AD FC 08     LDA $08FC
00/9B45: 4A           LSR 
00/9B46: 4A           LSR 
00/9B47: 4A           LSR 
00/9B48: AA           TAX 
00/9B49: AD 01 17     LDA $1701
00/9B4C: F0 05        BEQ $9B53
00/9B4E: 8A           TXA 
00/9B4F: 18           CLC 
00/9B50: 69 20        ADC #$20
00/9B52: AA           TAX 
00/9B53: AD FC 08     LDA $08FC
00/9B56: 29 07        AND #$07
00/9B58: 1A           INC 
00/9B59: A8           TAY 
00/9B5A: 60           RTS 

; [ get pointer to treasure properties ]

00/9B5B: AD 02 17     LDA $1702
00/9B5E: 85 3D        STA $3D
00/9B60: 64 3E        STZ $3E
00/9B62: 06 3D        ASL $3D
00/9B64: 26 3E        ROL $3E
00/9B66: AD 01 17     LDA $1701
00/9B69: F0 04        BEQ $9B6F
00/9B6B: E6 3E        INC $3E
00/9B6D: E6 3E        INC $3E
00/9B6F: A6 3D        LDX $3D
00/9B71: BF 00 82 15  LDA $158200,X   ; pointers to sub-map triggers
00/9B75: 85 3D        STA $3D
00/9B77: BF 01 82 15  LDA $158201,X
00/9B7B: 85 3E        STA $3E
00/9B7D: 60           RTS 

; [ init map treasures ]

00/9B7E: AD 11 07     LDA $0711
00/9B81: D0 01        BNE $9B84       ; return if there are no treasures
00/9B83: 60           RTS 
00/9B84: 20 5B 9B     JSR $9B5B       ; get pointer to treasure properties
00/9B87: A0 00 00     LDY #$0000
00/9B8A: A6 3D        LDX $3D
00/9B8C: 98           TYA 
00/9B8D: 18           CLC 
00/9B8E: 6D E7 0F     ADC $0FE7       ; treasure offset
00/9B91: 8D FC 08     STA $08FC
00/9B94: 5A           PHY 
00/9B95: 20 0D 9B     JSR $9B0D       ; check treasure switch
00/9B98: 7A           PLY 
00/9B99: C9 00        CMP #$00
00/9B9B: F0 1E        BEQ $9BBB
00/9B9D: A6 3D        LDX $3D
00/9B9F: BF 00 85 15  LDA $158500,X
00/9BA3: 85 18        STA $18
00/9BA5: BF 01 85 15  LDA $158501,X
00/9BA9: 85 19        STA $19
00/9BAB: A6 18        LDX $18
00/9BAD: BF 71 5C 7F  LDA $7F5C71,X
00/9BB1: C9 78        CMP #$78
00/9BB3: D0 06        BNE $9BBB
00/9BB5: A9 77        LDA #$77
00/9BB7: 9F 71 5C 7F  STA $7F5C71,X
00/9BBB: A6 3D        LDX $3D
00/9BBD: E8           INX 
00/9BBE: E8           INX 
00/9BBF: E8           INX 
00/9BC0: E8           INX 
00/9BC1: E8           INX 
00/9BC2: 86 3D        STX $3D
00/9BC4: C8           INY 
00/9BC5: 98           TYA 
00/9BC6: CD 11 07     CMP $0711
00/9BC9: F0 03        BEQ $9BCE
00/9BCB: 4C 8A 9B     JMP $9B8A
00/9BCE: 60           RTS 

; [ check triggers (sub-map) ]

00/9BCF: 64 CD        STZ $CD
00/9BD1: A5 AB        LDA $AB
00/9BD3: D0 02        BNE $9BD7
00/9BD5: 64 7B        STZ $7B
00/9BD7: A5 AC        LDA $AC
00/9BD9: AA           TAX 
00/9BDA: A5 7B        LDA $7B
00/9BDC: 3D 0E AD     AND $AD0E,X     ; trigger check frequency
00/9BDF: F0 03        BEQ $9BE4
00/9BE1: 64 D5        STZ $D5         ; disable player control
00/9BE3: 60           RTS 
00/9BE4: A9 01        LDA #$01        ; enable player control
00/9BE6: 85 D5        STA $D5
00/9BE8: 20 6C 9F     JSR $9F6C       ; update local tile properties
00/9BEB: A5 A1        LDA $A1
00/9BED: 29 08        AND #$08
00/9BEF: 8D 02 1A     STA $1A02
00/9BF2: AD 06 17     LDA $1706
00/9BF5: 30 0D        BMI $9C04
00/9BF7: C9 20        CMP #$20
00/9BF9: B0 09        BCS $9C04
00/9BFB: AD 07 17     LDA $1707
00/9BFE: 30 04        BMI $9C04
00/9C00: C9 20        CMP #$20
00/9C02: 90 03        BCC $9C07
00/9C04: E6 D1        INC $D1
00/9C06: 60           RTS 
00/9C07: A5 A2        LDA $A2
00/9C09: 30 11        BMI $9C1C
00/9C0B: A5 A2        LDA $A2
00/9C0D: 29 10        AND #$10
00/9C0F: D0 0B        BNE $9C1C
00/9C11: A5 A1        LDA $A1
00/9C13: 29 08        AND #$08
00/9C15: D0 05        BNE $9C1C
00/9C17: A9 01        LDA #$01
00/9C19: 85 D6        STA $D6
00/9C1B: 60           RTS 
00/9C1C: A5 D6        LDA $D6
00/9C1E: D0 01        BNE $9C21
00/9C20: 60           RTS 
00/9C21: 64 D6        STZ $D6
00/9C23: A5 A1        LDA $A1
00/9C25: 29 08        AND #$08
00/9C27: F0 0C        BEQ $9C35
00/9C29: A9 01        LDA #$01
00/9C2B: 85 B1        STA $B1
00/9C2D: A9 76        LDA #$76
00/9C2F: 20 EB E1     JSR $E1EB       ; execute event
00/9C32: 64 B1        STZ $B1
00/9C34: 60           RTS 
00/9C35: A5 A2        LDA $A2
00/9C37: 30 03        BMI $9C3C
00/9C39: E6 D1        INC $D1
00/9C3B: 60           RTS 
00/9C3C: AD 02 17     LDA $1702
00/9C3F: 85 3D        STA $3D
00/9C41: 64 3E        STZ $3E
00/9C43: 06 3D        ASL $3D
00/9C45: 26 3E        ROL $3E
00/9C47: AD 01 17     LDA $1701
00/9C4A: F0 04        BEQ $9C50
00/9C4C: E6 3E        INC $3E
00/9C4E: E6 3E        INC $3E
00/9C50: A6 3D        LDX $3D
00/9C52: BF 00 82 15  LDA $158200,X   ; pointers to sub-map triggers
00/9C56: 85 3D        STA $3D
00/9C58: BF 01 82 15  LDA $158201,X
00/9C5C: 85 3E        STA $3E
00/9C5E: A6 3D        LDX $3D
00/9C60: BF 00 85 15  LDA $158500,X
00/9C64: CD 06 17     CMP $1706
00/9C67: D0 09        BNE $9C72
00/9C69: BF 01 85 15  LDA $158501,X
00/9C6D: CD 07 17     CMP $1707
00/9C70: F0 08        BEQ $9C7A
00/9C72: E8           INX 
00/9C73: E8           INX 
00/9C74: E8           INX 
00/9C75: E8           INX 
00/9C76: E8           INX 
00/9C77: 4C 60 9C     JMP $9C60
00/9C7A: BF 02 85 15  LDA $158502,X
00/9C7E: C9 FF        CMP #$FF
00/9C80: D0 08        BNE $9C8A
00/9C82: BF 03 85 15  LDA $158503,X
00/9C86: 20 2D F2     JSR $F22D       ; execute trigger script
00/9C89: 60           RTS 
00/9C8A: 20 EB 9C     JSR $9CEB
00/9C8D: BF 02 85 15  LDA $158502,X
00/9C91: C9 FB        CMP #$FB
00/9C93: B0 2D        BCS $9CC2
00/9C95: 8D 02 17     STA $1702
00/9C98: BF 03 85 15  LDA $158503,X
00/9C9C: 29 3F        AND #$3F
00/9C9E: 8D 06 17     STA $1706
00/9CA1: BF 03 85 15  LDA $158503,X
00/9CA5: 29 C0        AND #$C0
00/9CA7: 4A           LSR 
00/9CA8: 4A           LSR 
00/9CA9: 4A           LSR 
00/9CAA: 4A           LSR 
00/9CAB: 4A           LSR 
00/9CAC: 4A           LSR 
00/9CAD: 8D 05 17     STA $1705
00/9CB0: BF 04 85 15  LDA $158504,X
00/9CB4: 8D 07 17     STA $1707
00/9CB7: 20 3F 92     JSR $923F
00/9CBA: A9 03        LDA #$03
00/9CBC: 8D 00 17     STA $1700
00/9CBF: E6 CD        INC $CD
00/9CC1: 60           RTS 
00/9CC2: DA           PHX 
00/9CC3: 20 49 8D     JSR $8D49       ; fade out music (fast)
00/9CC6: 20 3F 92     JSR $923F
00/9CC9: FA           PLX 
00/9CCA: BF 02 85 15  LDA $158502,X
00/9CCE: 38           SEC 
00/9CCF: E9 FB        SBC #$FB
00/9CD1: 8D 00 17     STA $1700
00/9CD4: BF 03 85 15  LDA $158503,X
00/9CD8: 8D 06 17     STA $1706
00/9CDB: BF 04 85 15  LDA $158504,X
00/9CDF: 8D 07 17     STA $1707
00/9CE2: E6 CD        INC $CD
00/9CE4: A2 00 00     LDX #$0000
00/9CE7: 8E 2C 17     STX $172C
00/9CEA: 60           RTS 

; [ push map to stack ]

00/9CEB: DA           PHX 
00/9CEC: AE 2C 17     LDX $172C
00/9CEF: AD 00 17     LDA $1700
00/9CF2: C9 03        CMP #$03
00/9CF4: D0 19        BNE $9D0F
00/9CF6: AD 02 17     LDA $1702
00/9CF9: 9D 2E 17     STA $172E,X
00/9CFC: AD 05 17     LDA $1705
00/9CFF: 0A           ASL 
00/9D00: 0A           ASL 
00/9D01: 0A           ASL 
00/9D02: 0A           ASL 
00/9D03: 0A           ASL 
00/9D04: 0A           ASL 
00/9D05: 18           CLC 
00/9D06: 6D 06 17     ADC $1706
00/9D09: 9D 2F 17     STA $172F,X
00/9D0C: 4C 1E 9D     JMP $9D1E
00/9D0F: AD 00 17     LDA $1700
00/9D12: 18           CLC 
00/9D13: 69 FB        ADC #$FB
00/9D15: 9D 2E 17     STA $172E,X
00/9D18: AD 06 17     LDA $1706
00/9D1B: 9D 2F 17     STA $172F,X
00/9D1E: AD 07 17     LDA $1707
00/9D21: 9D 30 17     STA $1730,X
00/9D24: E8           INX 
00/9D25: E8           INX 
00/9D26: E8           INX 
00/9D27: E0 C0 00     CPX #$00C0
00/9D2A: 90 03        BCC $9D2F
00/9D2C: A2 00 00     LDX #$0000
00/9D2F: 8E 2C 17     STX $172C
00/9D32: FA           PLX 
00/9D33: 60           RTS 

; [ check triggers (world map) ]

00/9D34: 64 CD        STZ $CD
00/9D36: A5 AB        LDA $AB
00/9D38: D0 02        BNE $9D3C
00/9D3A: 64 7B        STZ $7B
00/9D3C: A5 AC        LDA $AC
00/9D3E: AA           TAX 
00/9D3F: A5 7B        LDA $7B
00/9D41: 3D 0E AD     AND $AD0E,X
00/9D44: F0 03        BEQ $9D49
00/9D46: 64 D5        STZ $D5         ; disable player control
00/9D48: 60           RTS 
00/9D49: A9 01        LDA #$01        ; enable player control
00/9D4B: 85 D5        STA $D5
00/9D4D: 20 6C 9F     JSR $9F6C       ; update local tile properties
00/9D50: 9C 02 1A     STZ $1A02
00/9D53: AD 04 17     LDA $1704
00/9D56: D0 03        BNE $9D5B
00/9D58: EE 02 1A     INC $1A02
00/9D5B: AD 04 17     LDA $1704
00/9D5E: C9 04        CMP #$04
00/9D60: D0 1F        BNE $9D81
00/9D62: AD B7 06     LDA $06B7
00/9D65: C9 10        CMP #$10
00/9D67: D0 18        BNE $9D81
00/9D69: AD 00 17     LDA $1700
00/9D6C: C9 00        CMP #$00
00/9D6E: D0 05        BNE $9D75
00/9D70: A9 2D        LDA #$2D
00/9D72: 4C D0 9D     JMP $9DD0
00/9D75: AD 00 17     LDA $1700
00/9D78: C9 01        CMP #$01
00/9D7A: D0 05        BNE $9D81
00/9D7C: A9 2F        LDA #$2F
00/9D7E: 4C D0 9D     JMP $9DD0
00/9D81: A5 A2        LDA $A2
00/9D83: 30 05        BMI $9D8A
00/9D85: A9 01        LDA #$01
00/9D87: 85 D6        STA $D6
00/9D89: 60           RTS 
00/9D8A: AD 04 17     LDA $1704
00/9D8D: F0 01        BEQ $9D90
00/9D8F: 60           RTS 
00/9D90: A5 D6        LDA $D6
00/9D92: D0 01        BNE $9D95
00/9D94: 60           RTS 
00/9D95: 64 D6        STZ $D6
00/9D97: AD 00 17     LDA $1700
00/9D9A: 0A           ASL 
00/9D9B: AA           TAX 
00/9D9C: BF 00 80 15  LDA $158000,X
00/9DA0: 85 3D        STA $3D
00/9DA2: BF 01 80 15  LDA $158001,X
00/9DA6: 85 3E        STA $3E
00/9DA8: A6 3D        LDX $3D
00/9DAA: BF 06 80 15  LDA $158006,X
00/9DAE: CD 06 17     CMP $1706
00/9DB1: D0 09        BNE $9DBC
00/9DB3: BF 07 80 15  LDA $158007,X
00/9DB7: CD 07 17     CMP $1707
00/9DBA: F0 08        BEQ $9DC4
00/9DBC: E8           INX 
00/9DBD: E8           INX 
00/9DBE: E8           INX 
00/9DBF: E8           INX 
00/9DC0: E8           INX 
00/9DC1: 4C AA 9D     JMP $9DAA
00/9DC4: BF 08 80 15  LDA $158008,X
00/9DC8: C9 FF        CMP #$FF
00/9DCA: D0 08        BNE $9DD4
00/9DCC: BF 09 80 15  LDA $158009,X
00/9DD0: 20 2D F2     JSR $F22D       ; execute trigger script
00/9DD3: 60           RTS 
00/9DD4: DA           PHX 
00/9DD5: AE 2C 17     LDX $172C
00/9DD8: AD 00 17     LDA $1700
00/9DDB: F0 02        BEQ $9DDF
00/9DDD: A9 01        LDA #$01
00/9DDF: 8D 01 17     STA $1701
00/9DE2: AD 00 17     LDA $1700
00/9DE5: 18           CLC 
00/9DE6: 69 FB        ADC #$FB
00/9DE8: 9D 2E 17     STA $172E,X
00/9DEB: AF 06 17 00  LDA $001706
00/9DEF: 9D 2F 17     STA $172F,X
00/9DF2: AD 07 17     LDA $1707
00/9DF5: 9D 30 17     STA $1730,X
00/9DF8: E8           INX 
00/9DF9: E8           INX 
00/9DFA: E8           INX 
00/9DFB: E0 C0 00     CPX #$00C0
00/9DFE: 90 03        BCC $9E03
00/9E00: A2 00 00     LDX #$0000
00/9E03: 8E 2C 17     STX $172C
00/9E06: FA           PLX 
00/9E07: BF 08 80 15  LDA $158008,X
00/9E0B: 8D 02 17     STA $1702
00/9E0E: BF 09 80 15  LDA $158009,X
00/9E12: 29 3F        AND #$3F
00/9E14: 8D 06 17     STA $1706
00/9E17: BF 0A 80 15  LDA $15800A,X
00/9E1B: 8D 07 17     STA $1707
00/9E1E: BF 09 80 15  LDA $158009,X
00/9E22: 29 C0        AND #$C0
00/9E24: 4A           LSR 
00/9E25: 4A           LSR 
00/9E26: 4A           LSR 
00/9E27: 4A           LSR 
00/9E28: 4A           LSR 
00/9E29: 4A           LSR 
00/9E2A: 8D 05 17     STA $1705
00/9E2D: 20 49 8D     JSR $8D49       ; fade out music (fast)
00/9E30: 20 3F 92     JSR $923F
00/9E33: E6 CD        INC $CD
00/9E35: A9 03        LDA #$03
00/9E37: 8D 00 17     STA $1700
00/9E3A: 60           RTS 

; --------------------------------------------------------------------------

; [ board/exit vehicle ]

00/9E3B: A5 02        LDA $02
00/9E3D: 29 80        AND #$80
00/9E3F: F0 04        BEQ $9E45       ; return if A button is not pressed
00/9E41: A5 54        LDA $54
00/9E43: F0 01        BEQ $9E46       ; return if A button is not reset
00/9E45: 60           RTS 
00/9E46: E6 54        INC $54         ; reset A button
00/9E48: A9 3D        LDA #$3D
00/9E4A: 20 ED F3     JSR $F3ED       ; check event switch
00/9E4D: C9 00        CMP #$00
00/9E4F: D0 09        BNE $9E5A
00/9E51: A9 30        LDA #$30
00/9E53: 20 ED F3     JSR $F3ED       ; check event switch
00/9E56: C9 00        CMP #$00
00/9E58: F0 4B        BEQ $9EA5
00/9E5A: AD 04 17     LDA $1704       ; falcon and enterprise only
00/9E5D: C9 04        CMP #$04
00/9E5F: F0 04        BEQ $9E65
00/9E61: C9 05        CMP #$05
00/9E63: D0 40        BNE $9EA5
; overworld -> underground
00/9E65: AD 00 17     LDA $1700
00/9E68: D0 19        BNE $9E83
00/9E6A: AD 06 17     LDA $1706
00/9E6D: C9 69        CMP #$69
00/9E6F: 90 34        BCC $9EA5
00/9E71: C9 6C        CMP #$6C
00/9E73: B0 30        BCS $9EA5
00/9E75: AD 07 17     LDA $1707
00/9E78: C9 D3        CMP #$D3
00/9E7A: 90 29        BCC $9EA5
00/9E7C: C9 D6        CMP #$D6
00/9E7E: B0 25        BCS $9EA5
00/9E80: 4C A0 9E     JMP $9EA0
; underground -> overworld
00/9E83: AD 00 17     LDA $1700
00/9E86: C9 01        CMP #$01
00/9E88: D0 1B        BNE $9EA5
00/9E8A: AD 06 17     LDA $1706
00/9E8D: C9 70        CMP #$70
00/9E8F: 90 14        BCC $9EA5
00/9E91: C9 73        CMP #$73
00/9E93: B0 10        BCS $9EA5
00/9E95: AD 07 17     LDA $1707
00/9E98: C9 0F        CMP #$0F
00/9E9A: 90 09        BCC $9EA5
00/9E9C: C9 12        CMP #$12
00/9E9E: B0 05        BCS $9EA5
00/9EA0: A9 01        LDA #$01
00/9EA2: 85 CE        STA $CE         ; enable overworld/underground switch
00/9EA4: 60           RTS 
; try to exit vehicle
00/9EA5: AD 04 17     LDA $1704
00/9EA8: F0 2B        BEQ $9ED5
00/9EAA: C9 01        CMP #$01
00/9EAC: D0 03        BNE $9EB1
00/9EAE: 4C 7B A0     JMP $A07B       ; get off chocobo
00/9EB1: C9 02        CMP #$02
00/9EB3: D0 03        BNE $9EB8
00/9EB5: 4C 20 A1     JMP $A120       ; land black chocobo
00/9EB8: C9 03        CMP #$03
00/9EBA: D0 03        BNE $9EBF
00/9EBC: 4C DE A1     JMP $A1DE       ; land hovercraft
00/9EBF: C9 04        CMP #$04
00/9EC1: D0 03        BNE $9EC6
00/9EC3: 4C 0B A6     JMP $A60B       ; land enterprise / pick up hovercraft
00/9EC6: C9 05        CMP #$05
00/9EC8: D0 03        BNE $9ECD
00/9ECA: 4C 5A A7     JMP $A75A       ; land falcon
00/9ECD: C9 06        CMP #$06
00/9ECF: D0 03        BNE $9ED4
00/9ED1: 4C E2 A7     JMP $A7E2
00/9ED4: 60           RTS 
; try to board vehicle
00/9ED5: 9C 02 1A     STZ $1A02       ; disable tent/save
00/9ED8: A5 AB        LDA $AB
00/9EDA: F0 01        BEQ $9EDD       ; branch if not moving
00/9EDC: 60           RTS 
00/9EDD: AD 01 17     LDA $1701
00/9EE0: C9 00        CMP #$00
00/9EE2: D0 10        BNE $9EF4
00/9EE4: AD 0F 17     LDA $170F
00/9EE7: F0 0B        BEQ $9EF4       ; branch if chocobo is not visible
00/9EE9: AE 06 17     LDX $1706
00/9EEC: EC 10 17     CPX $1710       ; chocobo position
00/9EEF: D0 03        BNE $9EF4
00/9EF1: 4C 3E A0     JMP $A03E       ; board chocobo
00/9EF4: AD 01 17     LDA $1701
00/9EF7: C9 00        CMP #$00
00/9EF9: D0 10        BNE $9F0B
00/9EFB: AD 12 17     LDA $1712
00/9EFE: F0 0B        BEQ $9F0B
00/9F00: AE 06 17     LDX $1706
00/9F03: EC 13 17     CPX $1713
00/9F06: D0 03        BNE $9F0B
00/9F08: 4C 49 A0     JMP $A049       ; board black chocobo
00/9F0B: AD 01 17     LDA $1701
00/9F0E: CD 1B 17     CMP $171B
00/9F11: D0 10        BNE $9F23
00/9F13: AD 18 17     LDA $1718
00/9F16: F0 0B        BEQ $9F23
00/9F18: AE 06 17     LDX $1706
00/9F1B: EC 19 17     CPX $1719
00/9F1E: D0 03        BNE $9F23
00/9F20: 4C 68 A1     JMP $A168       ; board hovercraft
00/9F23: AD 01 17     LDA $1701
00/9F26: CD 1F 17     CMP $171F
00/9F29: D0 10        BNE $9F3B
00/9F2B: AD 1C 17     LDA $171C
00/9F2E: F0 0B        BEQ $9F3B
00/9F30: AE 06 17     LDX $1706
00/9F33: EC 1D 17     CPX $171D
00/9F36: D0 03        BNE $9F3B
00/9F38: 4C 13 A2     JMP $A213       ; board enterprise
00/9F3B: AD 01 17     LDA $1701
00/9F3E: CD 23 17     CMP $1723
00/9F41: D0 10        BNE $9F53
00/9F43: AD 20 17     LDA $1720
00/9F46: F0 0B        BEQ $9F53
00/9F48: AE 06 17     LDX $1706
00/9F4B: EC 21 17     CPX $1721
00/9F4E: D0 03        BNE $9F53
00/9F50: 4C 83 A2     JMP $A283       ; board falcon
00/9F53: AD 01 17     LDA $1701
00/9F56: CD 27 17     CMP $1727
00/9F59: D0 10        BNE $9F6B
00/9F5B: AD 24 17     LDA $1724
00/9F5E: F0 0B        BEQ $9F6B
00/9F60: AE 06 17     LDX $1706
00/9F63: EC 25 17     CPX $1725
00/9F66: D0 03        BNE $9F6B
00/9F68: 4C EB A2     JMP $A2EB       ; enter big whale
00/9F6B: 60           RTS 

; [ update local tile properties ]

; tile above -> +$A3
00/9F6C: AD 06 17     LDA $1706
00/9F6F: 85 1A        STA $1A
00/9F71: AD 07 17     LDA $1707
00/9F74: 3A           DEC 
00/9F75: 85 1B        STA $1B
00/9F77: 20 C0 9F     JSR $9FC0       ; get tile properties
00/9F7A: A6 1E        LDX $1E
00/9F7C: 86 A3        STX $A3
00/9F7E: A5 06        LDA $06
00/9F80: 8D 0C 07     STA $070C
; tile to the left -> +$A9
00/9F83: E6 1B        INC $1B
00/9F85: C6 1A        DEC $1A
00/9F87: 20 C0 9F     JSR $9FC0       ; get tile properties
00/9F8A: A6 1E        LDX $1E
00/9F8C: 86 A9        STX $A9
00/9F8E: A5 06        LDA $06
00/9F90: 8D 0F 07     STA $070F
; current tile -> +$A1
00/9F93: E6 1A        INC $1A
00/9F95: 20 C0 9F     JSR $9FC0       ; get tile properties
00/9F98: A6 1E        LDX $1E
00/9F9A: 86 A1        STX $A1
00/9F9C: A5 06        LDA $06
00/9F9E: 8D 0B 07     STA $070B
; tile to the right -> +$A5
00/9FA1: E6 1A        INC $1A
00/9FA3: 20 C0 9F     JSR $9FC0       ; get tile properties
00/9FA6: A6 1E        LDX $1E
00/9FA8: 86 A5        STX $A5
00/9FAA: A5 06        LDA $06
00/9FAC: 8D 0D 07     STA $070D
; tile to below -> +$A7
00/9FAF: E6 1B        INC $1B
00/9FB1: C6 1A        DEC $1A
00/9FB3: 20 C0 9F     JSR $9FC0       ; get tile properties
00/9FB6: A6 1E        LDX $1E
00/9FB8: 86 A7        STX $A7
00/9FBA: A5 06        LDA $06
00/9FBC: 8D 0E 07     STA $070E
00/9FBF: 60           RTS 

; [ get tile properties ]

;  $06: tile id (out)
;  $1A: x position
;  $1B: y position
; +$1E: tile properties (out)

00/9FC0: AD 00 17     LDA $1700
00/9FC3: C9 03        CMP #$03
00/9FC5: F0 07        BEQ $9FCE       ; branch if a sub-map
00/9FC7: A5 1B        LDA $1B
00/9FC9: 29 3F        AND #$3F        ; y position mod 64
00/9FCB: 4C F1 9F     JMP $9FF1
00/9FCE: A5 1A        LDA $1A
00/9FD0: 30 0C        BMI $9FDE       ; branch if out-of-bounds left
00/9FD2: C9 20        CMP #$20
00/9FD4: B0 08        BCS $9FDE       ; branch if out-of-bounds right
00/9FD6: A5 1B        LDA $1B
00/9FD8: 30 04        BMI $9FDE       ; branch if out-of-bounds top
00/9FDA: C9 20        CMP #$20
00/9FDC: 90 11        BCC $9FEF       ; branch if not out-of-bounds bottom
; out-of bounds
00/9FDE: AD DF 0F     LDA $0FDF
00/9FE1: 10 06        BPL $9FE9       ; branch if out-of-bounds tiles are passable
00/9FE3: A2 00 00     LDX #$0000
00/9FE6: 86 1E        STX $1E
00/9FE8: 60           RTS 
00/9FE9: A2 07 00     LDX #$0007
00/9FEC: 86 1E        STX $1E
00/9FEE: 60           RTS 
; not out of bounds
00/9FEF: A5 1B        LDA $1B
00/9FF1: 85 3E        STA $3E
00/9FF3: A5 1A        LDA $1A
00/9FF5: 85 3D        STA $3D
00/9FF7: A6 3D        LDX $3D
00/9FF9: BF 71 5C 7F  LDA $7F5C71,X   ; bg tilemap
00/9FFD: 85 06        STA $06
00/9FFF: 85 18        STA $18
00/A001: 64 19        STZ $19
00/A003: 06 18        ASL $18
00/A005: 26 19        ROL $19
00/A007: A6 18        LDX $18
00/A009: BD DB 0E     LDA $0EDB,X     ; tile properties
00/A00C: 85 1E        STA $1E
00/A00E: BD DC 0E     LDA $0EDC,X
00/A011: 85 1F        STA $1F
00/A013: 60           RTS 

; [ animate 4 frames ]

00/A014: A9 03        LDA #$03
00/A016: 8D 05 17     STA $1705
00/A019: 20 77 91     JSR $9177       ; reset all sprites
00/A01C: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A01F: 20 4B 91     JSR $914B       ; wait one frame
00/A022: A5 7A        LDA $7A
00/A024: 29 03        AND #$03
00/A026: D0 F1        BNE $A019
00/A028: 60           RTS 

; [ animate 8 frames ]

00/A029: A9 03        LDA #$03
00/A02B: 8D 05 17     STA $1705
00/A02E: 20 77 91     JSR $9177       ; reset all sprites
00/A031: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A034: 20 4B 91     JSR $914B       ; wait one frame
00/A037: A5 7A        LDA $7A
00/A039: 29 07        AND #$07
00/A03B: D0 F1        BNE $A02E
00/A03D: 60           RTS 

; [ board chocobo ]

00/A03E: A9 01        LDA #$01
00/A040: 8D 04 17     STA $1704       ; set vehicle
00/A043: 85 AC        STA $AC         ; set movement speed
00/A045: 20 5D 8D     JSR $8D5D       ; play map song
00/A048: 60           RTS 

; [ board black chocobo ]

00/A049: EE 15 17     INC $1715
00/A04C: AD 15 17     LDA $1715
00/A04F: C9 01        CMP #$01
00/A051: D0 0C        BNE $A05F
00/A053: AD 06 17     LDA $1706
00/A056: 8D 16 17     STA $1716
00/A059: AD 07 17     LDA $1707
00/A05C: 8D 17 17     STA $1717
00/A05F: A9 02        LDA #$02
00/A061: 8D 04 17     STA $1704
00/A064: 85 AC        STA $AC
00/A066: 20 5D 8D     JSR $8D5D       ; play map song
00/A069: 64 79        STZ $79
00/A06B: 64 B5        STZ $B5
00/A06D: 20 14 A0     JSR $A014       ; animate 4 frames
00/A070: E6 B5        INC $B5
00/A072: E6 79        INC $79
00/A074: A5 79        LDA $79
00/A076: C9 10        CMP #$10
00/A078: D0 F3        BNE $A06D
00/A07A: 60           RTS 

; [ get off chocobo ]

00/A07B: A5 A1        LDA $A1
00/A07D: 29 01        AND #$01
00/A07F: D0 01        BNE $A082
00/A081: 60           RTS 
00/A082: 20 49 8D     JSR $8D49       ; fade out music (fast)
00/A085: A9 02        LDA #$02
00/A087: 8D 0F 17     STA $170F
00/A08A: A9 70        LDA #$70        ; set chocobo position
00/A08C: 8D 10 17     STA $1710
00/A08F: 8D 11 17     STA $1711
00/A092: A9 01        LDA #$01        ; facing right
00/A094: 8D 05 17     STA $1705
00/A097: A9 02        LDA #$02
00/A099: 85 2C        STA $2C
00/A09B: 20 28 C4     JSR $C428       ; random (0..255)
00/A09E: 4A           LSR 
00/A09F: 90 0C        BCC $A0AD
00/A0A1: A9 03        LDA #$03
00/A0A3: 8D 05 17     STA $1705
00/A0A6: A5 2C        LDA $2C
00/A0A8: 49 FF        EOR #$FF
00/A0AA: 1A           INC 
00/A0AB: 85 2C        STA $2C
00/A0AD: A9 02        LDA #$02
00/A0AF: 85 2E        STA $2E
00/A0B1: 20 28 C4     JSR $C428       ; random (0..255)
00/A0B4: 4A           LSR 
00/A0B5: 90 07        BCC $A0BE
00/A0B7: A5 2E        LDA $2E
00/A0B9: 49 FF        EOR #$FF
00/A0BB: 1A           INC 
00/A0BC: 85 2E        STA $2E
00/A0BE: 9C 04 17     STZ $1704
; start of frame loop
00/A0C1: 20 2D 91     JSR $912D       ; wait for vblank
00/A0C4: 20 28 C4     JSR $C428       ; random (0..255)
00/A0C7: C9 10        CMP #$10
00/A0C9: B0 07        BCS $A0D2
00/A0CB: A5 2E        LDA $2E
00/A0CD: 49 FF        EOR #$FF
00/A0CF: 1A           INC 
00/A0D0: 85 2E        STA $2E
00/A0D2: AD 10 17     LDA $1710
00/A0D5: 18           CLC 
00/A0D6: 65 2C        ADC $2C
00/A0D8: 8D 10 17     STA $1710
00/A0DB: F0 26        BEQ $A103
00/A0DD: C9 F0        CMP #$F0
00/A0DF: F0 22        BEQ $A103
00/A0E1: AD 11 17     LDA $1711
00/A0E4: 18           CLC 
00/A0E5: 65 2E        ADC $2E
00/A0E7: 8D 11 17     STA $1711
00/A0EA: F0 17        BEQ $A103
00/A0EC: C9 F0        CMP #$F0
00/A0EE: F0 13        BEQ $A103
00/A0F0: A9 01        LDA #$01
00/A0F2: 8D 04 17     STA $1704
00/A0F5: 22 DC B3 15  JSL $15B3DC     ; draw chocobo sprite
00/A0F9: 9C 04 17     STZ $1704
00/A0FC: 22 0C B3 15  JSL $15B30C     ; draw player sprite
00/A100: 4C C1 A0     JMP $A0C1
00/A103: 20 2D 91     JSR $912D       ; wait for vblank
00/A106: 20 77 91     JSR $9177       ; reset all sprites
00/A109: 9C 04 17     STZ $1704
00/A10C: 9C 0F 17     STZ $170F
00/A10F: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A112: 20 2D 91     JSR $912D       ; wait for vblank
00/A115: 64 AC        STZ $AC
00/A117: 64 7B        STZ $7B
00/A119: EE 02 1A     INC $1A02
00/A11C: 20 5D 8D     JSR $8D5D       ; play map song
00/A11F: 60           RTS 

; [ land black chocobo ]

00/A120: 64 79        STZ $79
00/A122: 20 14 A0     JSR $A014       ; animate 4 frames
00/A125: C6 B5        DEC $B5
00/A127: E6 79        INC $79
00/A129: A5 79        LDA $79
00/A12B: C9 10        CMP #$10
00/A12D: D0 F3        BNE $A122
00/A12F: A5 A1        LDA $A1
00/A131: 29 08        AND #$08
00/A133: D0 03        BNE $A138       ; branch if forest tile (can land)
00/A135: 4C 69 A0     JMP $A069
00/A138: 9C 04 17     STZ $1704
00/A13B: 64 AC        STZ $AC
00/A13D: 64 7B        STZ $7B
00/A13F: A9 02        LDA #$02
00/A141: 8D 05 17     STA $1705
00/A144: AE 06 17     LDX $1706
00/A147: 8E 13 17     STX $1713
00/A14A: AD 15 17     LDA $1715
00/A14D: C9 02        CMP #$02
00/A14F: D0 06        BNE $A157
00/A151: 9C 15 17     STZ $1715
00/A154: 9C 12 17     STZ $1712
00/A157: 20 5D 8D     JSR $8D5D       ; play map song
00/A15A: EE 02 1A     INC $1A02       ; enable tent/save
00/A15D: 60           RTS 

; [ board ship ]

00/A15E: A9 07        LDA #$07        ; ship
00/A160: 8D 04 17     STA $1704
00/A163: A9 01        LDA #$01        ; movement speed: 1
00/A165: 85 AC        STA $AC
00/A167: 60           RTS 

; [ board hovercraft ]

00/A168: A9 03        LDA #$03
00/A16A: 8D 04 17     STA $1704
00/A16D: A9 01        LDA #$01
00/A16F: 85 AC        STA $AC
00/A171: AD 01 17     LDA $1701
00/A174: 8D 1B 17     STA $171B
00/A177: A9 03        LDA #$03
00/A179: 8D 05 17     STA $1705
00/A17C: A5 B1        LDA $B1
00/A17E: F0 03        BEQ $A183       ; branch if didn't just acquire vehicle
00/A180: 20 98 A1     JSR $A198       ; vehicle appearing animation
00/A183: 20 5D 8D     JSR $8D5D       ; play map song
00/A186: 64 79        STZ $79
00/A188: 64 B6        STZ $B6
00/A18A: 20 29 A0     JSR $A029
00/A18D: E6 B6        INC $B6
00/A18F: E6 79        INC $79
00/A191: A5 79        LDA $79
00/A193: C9 04        CMP #$04
00/A195: D0 F3        BNE $A18A
00/A197: 60           RTS 

; [ vehicle appearing animation ]

; used for hovercraft, enterprise, and falcon

00/A198: A9 10        LDA #$10
00/A19A: 8D CF 0A     STA $0ACF
00/A19D: A9 03        LDA #$03
00/A19F: 8D D0 0A     STA $0AD0
00/A1A2: A9 03        LDA #$03
00/A1A4: 8D D1 0A     STA $0AD1
00/A1A7: A2 70 70     LDX #$7070
00/A1AA: 8E D4 0A     STX $0AD4
00/A1AD: A2 28 00     LDX #$0028
00/A1B0: 8E D2 0A     STX $0AD2
00/A1B3: A9 06        LDA #$06
00/A1B5: 8D CD 0A     STA $0ACD
00/A1B8: A9 02        LDA #$02        ; sand explosion palette
00/A1BA: 8D CE 0A     STA $0ACE
00/A1BD: 20 75 E0     JSR $E075
; start of frame loop
00/A1C0: 20 4B 91     JSR $914B       ; wait one frame
00/A1C3: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/A1C6: AE D2 0A     LDX $0AD2
00/A1C9: E0 08 00     CPX #$0008
00/A1CC: B0 07        BCS $A1D5
00/A1CE: A9 01        LDA #$01
00/A1D0: 85 E5        STA $E5
00/A1D2: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A1D5: AE D2 0A     LDX $0AD2
00/A1D8: E0 00 00     CPX #$0000
00/A1DB: D0 E3        BNE $A1C0
00/A1DD: 60           RTS 

; [ land hovercraft ]

00/A1DE: A5 A1        LDA $A1
00/A1E0: 29 01        AND #$01
00/A1E2: D0 01        BNE $A1E5
00/A1E4: 60           RTS 
00/A1E5: 64 79        STZ $79
00/A1E7: 20 29 A0     JSR $A029
00/A1EA: C6 B6        DEC $B6
00/A1EC: E6 79        INC $79
00/A1EE: A5 79        LDA $79
00/A1F0: C9 04        CMP #$04
00/A1F2: D0 F3        BNE $A1E7
00/A1F4: 9C 04 17     STZ $1704
00/A1F7: 64 AC        STZ $AC
00/A1F9: 64 7B        STZ $7B
00/A1FB: A9 02        LDA #$02
00/A1FD: 8D 05 17     STA $1705
00/A200: AD 01 17     LDA $1701
00/A203: 8D 1B 17     STA $171B
00/A206: AE 06 17     LDX $1706
00/A209: 8E 19 17     STX $1719
00/A20C: 20 5D 8D     JSR $8D5D       ; play map song
00/A20F: EE 02 1A     INC $1A02
00/A212: 60           RTS 

; [ board enterprise ]

00/A213: AD 86 12     LDA $1286
00/A216: 29 04        AND #$04
00/A218: F0 01        BEQ $A21B
00/A21A: 60           RTS 
00/A21B: A9 04        LDA #$04        ; set vehicle
00/A21D: 8D 04 17     STA $1704
00/A220: A9 03        LDA #$03
00/A222: 85 AC        STA $AC         ; set movement speed
00/A224: 8D 05 17     STA $1705
00/A227: A5 B1        LDA $B1
00/A229: F0 25        BEQ $A250       ; branch if didn't just acquire vehicle
00/A22B: A5 E1        LDA $E1
00/A22D: F0 12        BEQ $A241
00/A22F: A9 20        LDA #$20
00/A231: 85 AD        STA $AD
00/A233: A9 10        LDA #$10
00/A235: 85 B7        STA $B7
00/A237: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A23B: A9 0F        LDA #$0F
00/A23D: 8D FD 06     STA $06FD       ; set airship animation speed
00/A240: 60           RTS 
00/A241: 20 98 A1     JSR $A198       ; vehicle appearing animation
00/A244: A9 20        LDA #$20
00/A246: 85 79        STA $79
00/A248: A9 0F        LDA #$0F
00/A24A: 8D FD 06     STA $06FD       ; set airship animation speed
00/A24D: 4C 55 A2     JMP $A255       ; lift-off enterprise
00/A250: 20 5D 8D     JSR $8D5D       ; play map song
00/A253: 64 79        STZ $79
; lift-off enterprise
00/A255: 64 7A        STZ $7A
00/A257: 64 B7        STZ $B7
00/A259: 20 14 A0     JSR $A014       ; animate 4 frames
00/A25C: A5 79        LDA $79
00/A25E: C9 20        CMP #$20
00/A260: B0 09        BCS $A26B
00/A262: 4A           LSR 
00/A263: 8D FD 06     STA $06FD       ; set airship animation speed
00/A266: E6 79        INC $79
00/A268: 4C 59 A2     JMP $A259
00/A26B: E6 B7        INC $B7
00/A26D: A5 B7        LDA $B7
00/A26F: 18           CLC 
00/A270: 69 10        ADC #$10
00/A272: 85 AD        STA $AD
00/A274: A5 B7        LDA $B7
00/A276: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A27A: E6 79        INC $79
00/A27C: A5 79        LDA $79
00/A27E: C9 30        CMP #$30
00/A280: D0 D7        BNE $A259
00/A282: 60           RTS 

; [ board falcon ]

00/A283: A9 05        LDA #$05
00/A285: 8D 04 17     STA $1704
00/A288: A9 03        LDA #$03
00/A28A: 85 AC        STA $AC
00/A28C: 8D 05 17     STA $1705
00/A28F: A5 B1        LDA $B1
00/A291: F0 25        BEQ $A2B8       ; branch if didn't just acquire vehicle
00/A293: A5 E1        LDA $E1
00/A295: F0 12        BEQ $A2A9
00/A297: A9 20        LDA #$20
00/A299: 85 AD        STA $AD
00/A29B: A9 10        LDA #$10
00/A29D: 85 B8        STA $B8
00/A29F: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A2A3: A9 0F        LDA #$0F
00/A2A5: 8D FD 06     STA $06FD       ; set airship animation speed
00/A2A8: 60           RTS 
00/A2A9: 20 98 A1     JSR $A198       ; vehicle appearing animation
00/A2AC: A9 20        LDA #$20
00/A2AE: 85 79        STA $79
00/A2B0: A9 0F        LDA #$0F
00/A2B2: 8D FD 06     STA $06FD       ; set airship animation speed
00/A2B5: 4C BD A2     JMP $A2BD
00/A2B8: 20 5D 8D     JSR $8D5D       ; play map song
00/A2BB: 64 79        STZ $79
; lift-off falcon
00/A2BD: 64 7A        STZ $7A
00/A2BF: 64 B8        STZ $B8
00/A2C1: 20 14 A0     JSR $A014       ; animate 4 frames
00/A2C4: A5 79        LDA $79
00/A2C6: C9 20        CMP #$20
00/A2C8: B0 09        BCS $A2D3
00/A2CA: 4A           LSR 
00/A2CB: 8D FD 06     STA $06FD       ; set airship animation speed
00/A2CE: E6 79        INC $79
00/A2D0: 4C C1 A2     JMP $A2C1
00/A2D3: E6 B8        INC $B8
00/A2D5: A5 B8        LDA $B8
00/A2D7: 18           CLC 
00/A2D8: 69 10        ADC #$10
00/A2DA: 85 AD        STA $AD
00/A2DC: A5 B8        LDA $B8
00/A2DE: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A2E2: E6 79        INC $79
00/A2E4: A5 79        LDA $79
00/A2E6: C9 30        CMP #$30
00/A2E8: D0 D7        BNE $A2C1
00/A2EA: 60           RTS 

; [ enter big whale ]

00/A2EB: A9 0E        LDA #$0E
00/A2ED: 8D 01 1E     STA $1E01
00/A2F0: A9 01        LDA #$01
00/A2F2: 8D 00 1E     STA $1E00
00/A2F5: 22 04 80 04  JSL $048004     ; execute sound command
00/A2F9: A9 54        LDA #$54
00/A2FB: 20 2D F2     JSR $F22D       ; execute trigger script
00/A2FE: 60           RTS 

; [ board big whale ]

00/A2FF: A9 06        LDA #$06
00/A301: 8D 04 17     STA $1704
00/A304: A9 03        LDA #$03
00/A306: 85 AC        STA $AC
00/A308: A5 E1        LDA $E1
00/A30A: F0 13        BEQ $A31F
00/A30C: A9 30        LDA #$30
00/A30E: 85 AD        STA $AD
00/A310: A9 20        LDA #$20
00/A312: 85 B9        STA $B9
00/A314: 4A           LSR 
00/A315: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A319: A9 0F        LDA #$0F
00/A31B: 8D FD 06     STA $06FD       ; set airship animation speed
00/A31E: 60           RTS 
00/A31F: 20 5D 8D     JSR $8D5D       ; play map song
00/A322: 64 79        STZ $79
00/A324: 64 7A        STZ $7A
00/A326: 64 B9        STZ $B9
00/A328: 20 14 A0     JSR $A014       ; animate 4 frames
00/A32B: A5 79        LDA $79
00/A32D: C9 20        CMP #$20
00/A32F: B0 09        BCS $A33A
00/A331: 4A           LSR 
00/A332: 8D FD 06     STA $06FD       ; set airship animation speed
00/A335: E6 79        INC $79
00/A337: 4C 28 A3     JMP $A328
00/A33A: E6 B9        INC $B9
00/A33C: E6 B9        INC $B9
00/A33E: A5 B9        LDA $B9
00/A340: 18           CLC 
00/A341: 69 10        ADC #$10
00/A343: 85 AD        STA $AD
00/A345: A5 B9        LDA $B9
00/A347: 4A           LSR 
00/A348: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A34C: E6 79        INC $79
00/A34E: A5 79        LDA $79
00/A350: C9 30        CMP #$30
00/A352: D0 D4        BNE $A328
00/A354: AD C3 06     LDA $06C3
00/A357: D0 01        BNE $A35A
00/A359: 60           RTS 
00/A35A: 9C C3 06     STZ $06C3
00/A35D: AD 00 17     LDA $1700
00/A360: F0 03        BEQ $A365
00/A362: 4C B3 A3     JMP $A3B3
; overworld
00/A365: AE 06 17     LDX $1706
00/A368: 8E 08 17     STX $1708
00/A36B: 20 07 A4     JSR $A407
00/A36E: A2 98 FF     LDX #$FF98
00/A371: 86 5A        STX $5A
00/A373: 20 31 A5     JSR $A531
00/A376: 20 65 A4     JSR $A465
00/A379: A2 98 01     LDX #$0198
00/A37C: 86 5A        STX $5A
00/A37E: 20 31 A5     JSR $A531
00/A381: 20 EF A4     JSR $A4EF
00/A384: A9 02        LDA #$02
00/A386: 8D 00 17     STA $1700
00/A389: 8D 27 17     STA $1727
00/A38C: A9 01        LDA #$01
00/A38E: 8D 01 17     STA $1701
00/A391: AE 0C 17     LDX $170C
00/A394: 8E 06 17     STX $1706
00/A397: 20 74 85     JSR $8574
00/A39A: A9 10        LDA #$10
00/A39C: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A3A0: A9 81        LDA #$81
00/A3A2: 8D 00 42     STA $4200       ; enable nmi
00/A3A5: A9 30        LDA #$30
00/A3A7: 85 AD        STA $AD
00/A3A9: 20 37 A4     JSR $A437
00/A3AC: A2 00 00     LDX #$0000
00/A3AF: 8E 2C 17     STX $172C
00/A3B2: 60           RTS 
; moon
00/A3B3: AE 06 17     LDX $1706
00/A3B6: 8E 0C 17     STX $170C
00/A3B9: 20 07 A4     JSR $A407
00/A3BC: A2 98 01     LDX #$0198
00/A3BF: 86 5A        STX $5A
00/A3C1: 20 42 A5     JSR $A542
00/A3C4: 20 65 A4     JSR $A465
00/A3C7: A2 98 FF     LDX #$FF98
00/A3CA: 86 5A        STX $5A
00/A3CC: 20 42 A5     JSR $A542
00/A3CF: 20 EF A4     JSR $A4EF
00/A3D2: A9 80        LDA #$80
00/A3D4: 8D 00 21     STA $2100       ; screen off
00/A3D7: 9C 00 42     STZ $4200       ; disable nmi and irq
00/A3DA: A9 00        LDA #$00
00/A3DC: 8D 00 17     STA $1700
00/A3DF: 8D 01 17     STA $1701
00/A3E2: 8D 27 17     STA $1727
00/A3E5: AE 08 17     LDX $1708
00/A3E8: 8E 06 17     STX $1706
00/A3EB: 20 02 85     JSR $8502       ; load overworld
00/A3EE: A9 10        LDA #$10
00/A3F0: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A3F4: A9 81        LDA #$81
00/A3F6: 8D 00 42     STA $4200       ; enable nmi
00/A3F9: A9 30        LDA #$30
00/A3FB: 85 AD        STA $AD
00/A3FD: 20 37 A4     JSR $A437
00/A400: A2 00 00     LDX #$0000
00/A403: 8E 2C 17     STX $172C
00/A406: 60           RTS 

; [  ]

00/A407: 20 50 A4     JSR $A450
00/A40A: A9 80        LDA #$80
00/A40C: 8D 00 21     STA $2100       ; screen off
00/A40F: 9C 00 42     STZ $4200       ; disable nmi
00/A412: 9C 0C 42     STZ $420C
00/A415: A9 32        LDA #$32
00/A417: 85 76        STA $76
00/A419: A2 00 00     LDX #$0000
00/A41C: 86 47        STX $47
00/A41E: A2 00 80     LDX #$8000
00/A421: 86 45        STX $45
00/A423: 22 B1 CA 15  JSL $15CAB1     ; clear vram
00/A427: A9 02        LDA #$02
00/A429: 8D 00 17     STA $1700
00/A42C: 22 81 B1 15  JSL $15B181     ; transfer world map graphics to vram
00/A430: 20 53 A5     JSR $A553       ; load moon graphics (telescope)
00/A433: 20 AC A5     JSR $A5AC
00/A436: 60           RTS 

; [  ]

00/A437: 64 79        STZ $79
00/A439: A9 04        LDA #$04
00/A43B: 85 A1        STA $A1
00/A43D: 20 1A A5     JSR $A51A
00/A440: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A443: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/A446: 20 27 A5     JSR $A527
00/A449: E6 79        INC $79
00/A44B: C9 28        CMP #$28
00/A44D: D0 EE        BNE $A43D
00/A44F: 60           RTS 

; [  ]

00/A450: A9 28        LDA #$28
00/A452: 85 79        STA $79
00/A454: 20 1A A5     JSR $A51A
00/A457: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A45A: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/A45D: 20 27 A5     JSR $A527
00/A460: C6 79        DEC $79
00/A462: D0 F0        BNE $A454
00/A464: 60           RTS 

; [  ]

00/A465: 20 7E A5     JSR $A57E
00/A468: A2 98 FF     LDX #$FF98
00/A46B: 86 5C        STX $5C
00/A46D: 64 70        STZ $70
00/A46F: 64 71        STZ $71
00/A471: 64 72        STZ $72
00/A473: 64 73        STZ $73
00/A475: A9 81        LDA #$81
00/A477: 8D 00 42     STA $4200       ; enable nmi
00/A47A: A9 0F        LDA #$0F
00/A47C: 8D 00 21     STA $2100       ; screen on, full brightness
00/A47F: A9 00        LDA #$00
00/A481: 85 79        STA $79
00/A483: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/A486: 9C 0C 42     STZ $420C
00/A489: A5 79        LDA $79
00/A48B: 4A           LSR 
00/A48C: 4A           LSR 
00/A48D: 18           CLC 
00/A48E: 69 09        ADC #$09
00/A490: 85 6E        STA $6E
00/A492: 64 6F        STZ $6F
00/A494: 20 04 91     JSR $9104       ; update mode 7 registers
00/A497: A5 79        LDA $79
00/A499: 29 07        AND #$07
00/A49B: D0 0D        BNE $A4AA
00/A49D: A5 5C        LDA $5C
00/A49F: 38           SEC 
00/A4A0: E9 01        SBC #$01
00/A4A2: 85 5C        STA $5C
00/A4A4: A5 5D        LDA $5D
00/A4A6: E9 00        SBC #$00
00/A4A8: 85 5D        STA $5D
00/A4AA: 20 27 A5     JSR $A527
00/A4AD: 20 7E A5     JSR $A57E
00/A4B0: E6 79        INC $79
00/A4B2: A5 79        LDA $79
00/A4B4: C9 60        CMP #$60
00/A4B6: D0 CB        BNE $A483
00/A4B8: A9 5F        LDA #$5F
00/A4BA: 85 79        STA $79
00/A4BC: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/A4BF: 9C 0C 42     STZ $420C
00/A4C2: A5 79        LDA $79
00/A4C4: 4A           LSR 
00/A4C5: 4A           LSR 
00/A4C6: 18           CLC 
00/A4C7: 69 09        ADC #$09
00/A4C9: 85 6E        STA $6E
00/A4CB: 64 6F        STZ $6F
00/A4CD: 20 04 91     JSR $9104       ; update mode 7 registers
00/A4D0: A5 79        LDA $79
00/A4D2: 29 07        AND #$07
00/A4D4: D0 0D        BNE $A4E3
00/A4D6: A5 5C        LDA $5C
00/A4D8: 38           SEC 
00/A4D9: E9 01        SBC #$01
00/A4DB: 85 5C        STA $5C
00/A4DD: A5 5D        LDA $5D
00/A4DF: E9 00        SBC #$00
00/A4E1: 85 5D        STA $5D
00/A4E3: 20 7E A5     JSR $A57E
00/A4E6: C6 79        DEC $79
00/A4E8: A5 79        LDA $79
00/A4EA: C9 FF        CMP #$FF
00/A4EC: D0 CE        BNE $A4BC
00/A4EE: 60           RTS 

; [  ]

00/A4EF: A2 98 FF     LDX #$FF98
00/A4F2: 86 5C        STX $5C
00/A4F4: A9 DF        LDA #$DF
00/A4F6: 85 79        STA $79
00/A4F8: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/A4FB: 9C 0C 42     STZ $420C
00/A4FE: A5 79        LDA $79
00/A500: 85 6E        STA $6E
00/A502: 64 6F        STZ $6F
00/A504: 06 6E        ASL $6E
00/A506: 26 6F        ROL $6F
00/A508: 20 04 91     JSR $9104       ; update mode 7 registers
00/A50B: 20 27 A5     JSR $A527
00/A50E: 20 7E A5     JSR $A57E
00/A511: C6 79        DEC $79
00/A513: A5 79        LDA $79
00/A515: C9 FF        CMP #$FF
00/A517: D0 DF        BNE $A4F8
00/A519: 60           RTS 

; [  ]

00/A51A: A9 28        LDA #$28
00/A51C: 38           SEC 
00/A51D: E5 79        SBC $79
00/A51F: AA           TAX 
00/A520: BF F6 FA 14  LDA $14FAF6,X
00/A524: 85 B9        STA $B9
00/A526: 60           RTS 

; [  ]

00/A527: A5 79        LDA $79
00/A529: C9 10        CMP #$10
00/A52B: B0 03        BCS $A530
00/A52D: 8D 00 21     STA $2100       ; set screen brightness
00/A530: 60           RTS 

; [  ]

00/A531: A2 00 00     LDX #$0000
00/A534: BF E6 FA 14  LDA $14FAE6,X
00/A538: 9D 00 03     STA $0300,X
00/A53B: E8           INX 
00/A53C: E0 10 00     CPX #$0010
00/A53F: D0 F3        BNE $A534
00/A541: 60           RTS 

; [  ]

00/A542: A2 00 00     LDX #$0000
00/A545: BF D6 FA 14  LDA $14FAD6,X
00/A549: 9D 00 03     STA $0300,X
00/A54C: E8           INX 
00/A54D: E0 10 00     CPX #$0010
00/A550: D0 F3        BNE $A545
00/A552: 60           RTS 

; [ load moon graphics (telescope) ]

00/A553: A2 00 40     LDX #$4000
00/A556: 86 47        STX $47
00/A558: A2 00 01     LDX #$0100
00/A55B: 86 45        STX $45
00/A55D: A9 1E        LDA #$1E        ; 1E/FEE0 (moon sprite graphics)
00/A55F: 85 3C        STA $3C
00/A561: A2 E0 FE     LDX #$FEE0
00/A564: 86 3D        STX $3D
00/A566: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/A56A: A2 00 00     LDX #$0000
00/A56D: BF E0 FF 1E  LDA $1EFFE0,X   ; moon sprite palette
00/A571: 9D DB 0C     STA $0CDB,X
00/A574: 9D DB 0D     STA $0DDB,X
00/A577: E8           INX 
00/A578: E0 20 00     CPX #$0020
00/A57B: D0 F0        BNE $A56D
00/A57D: 60           RTS 

; [ draw star sprites ]

00/A57E: A0 10 00     LDY #$0010
00/A581: A2 00 00     LDX #$0000
00/A584: 20 28 C4     JSR $C428       ; random (0..255)
00/A587: 99 00 03     STA $0300,Y
00/A58A: 20 28 C4     JSR $C428       ; random (0..255)
00/A58D: 99 01 03     STA $0301,Y
00/A590: A9 2F        LDA #$2F
00/A592: 99 02 03     STA $0302,Y
00/A595: 20 28 C4     JSR $C428       ; random (0..255)
00/A598: 29 07        AND #$07
00/A59A: 0A           ASL 
00/A59B: 09 01        ORA #$01
00/A59D: 99 03 03     STA $0303,Y
00/A5A0: E8           INX 
00/A5A1: E8           INX 
00/A5A2: C8           INY 
00/A5A3: C8           INY 
00/A5A4: C8           INY 
00/A5A5: C8           INY 
00/A5A6: C0 00 02     CPY #$0200
00/A5A9: D0 D9        BNE $A584
00/A5AB: 60           RTS 

; [  ]

00/A5AC: A9 70        LDA #$70
00/A5AE: 85 07        STA $07
00/A5B0: 9C 15 21     STZ $2115
00/A5B3: A2 00 00     LDX #$0000
00/A5B6: 86 3D        STX $3D
00/A5B8: A6 3D        LDX $3D
00/A5BA: 8E 16 21     STX $2116
00/A5BD: A5 07        LDA $07
00/A5BF: 8D 18 21     STA $2118
00/A5C2: E6 07        INC $07
00/A5C4: A5 07        LDA $07
00/A5C6: 29 03        AND #$03
00/A5C8: D0 F3        BNE $A5BD
00/A5CA: A5 3D        LDA $3D
00/A5CC: 18           CLC 
00/A5CD: 69 80        ADC #$80
00/A5CF: 85 3D        STA $3D
00/A5D1: A5 3E        LDA $3E
00/A5D3: 69 00        ADC #$00
00/A5D5: 85 3E        STA $3E
00/A5D7: C9 02        CMP #$02
00/A5D9: D0 DD        BNE $A5B8
00/A5DB: A9 80        LDA #$80
00/A5DD: 85 07        STA $07
00/A5DF: 9C 15 21     STZ $2115
00/A5E2: A2 40 00     LDX #$0040
00/A5E5: 86 3D        STX $3D
00/A5E7: A6 3D        LDX $3D
00/A5E9: 8E 16 21     STX $2116
00/A5EC: A5 07        LDA $07
00/A5EE: 8D 18 21     STA $2118
00/A5F1: E6 07        INC $07
00/A5F3: A5 07        LDA $07
00/A5F5: 29 03        AND #$03
00/A5F7: D0 F3        BNE $A5EC
00/A5F9: A5 3D        LDA $3D
00/A5FB: 18           CLC 
00/A5FC: 69 80        ADC #$80
00/A5FE: 85 3D        STA $3D
00/A600: A5 3E        LDA $3E
00/A602: 69 00        ADC #$00
00/A604: 85 3E        STA $3E
00/A606: C9 02        CMP #$02
00/A608: D0 DD        BNE $A5E7
00/A60A: 60           RTS 

; [ land enterprise / pick up hovercraft ]

; in enterprise, pressed A button

00/A60B: AD D0 06     LDA $06D0
00/A60E: D0 20        BNE $A630       ; branch if holding hovercraft
00/A610: A9 36        LDA #$36
00/A612: 20 ED F3     JSR $F3ED       ; check event switch
00/A615: C9 00        CMP #$00
00/A617: D0 03        BNE $A61C
00/A619: 4C 5A A6     JMP $A65A
; try to pick up hovercraft
00/A61C: AD 1F 17     LDA $171F
00/A61F: CD 1B 17     CMP $171B
00/A622: D0 36        BNE $A65A
00/A624: AE 19 17     LDX $1719
00/A627: EC 06 17     CPX $1706
00/A62A: D0 2E        BNE $A65A
00/A62C: 20 2D A7     JSR $A72D       ; pick up hovercraft
00/A62F: 60           RTS 
; try to drop hovercraft
00/A630: AD 23 17     LDA $1723
00/A633: CD 01 17     CMP $1701
00/A636: D0 08        BNE $A640
00/A638: AE 06 17     LDX $1706
00/A63B: EC 21 17     CPX $1721
00/A63E: F0 19        BEQ $A659
00/A640: AD 27 17     LDA $1727
00/A643: CD 01 17     CMP $1701
00/A646: D0 08        BNE $A650
00/A648: AE 06 17     LDX $1706
00/A64B: EC 25 17     CPX $1725
00/A64E: F0 09        BEQ $A659
00/A650: A5 A1        LDA $A1
00/A652: 29 10        AND #$10
00/A654: F0 03        BEQ $A659
00/A656: 20 F2 A6     JSR $A6F2       ; drop hovercraft
00/A659: 60           RTS 
; try to land
00/A65A: A9 30        LDA #$30
00/A65C: 85 79        STA $79
00/A65E: 64 7A        STZ $7A
; start of frame loop
00/A660: 20 14 A0     JSR $A014       ; animate 4 frames
00/A663: A5 79        LDA $79
00/A665: C9 21        CMP #$21
00/A667: B0 65        BCS $A6CE       ; branch if descending
; on ground
00/A669: A5 A2        LDA $A2
00/A66B: 29 10        AND #$10
00/A66D: D0 03        BNE $A672       ; branch if airship can land
00/A66F: 4C 55 A2     JMP $A255       ; lift-off enterprise
00/A672: AE 19 17     LDX $1719       ; can't land on hovercraft
00/A675: EC 06 17     CPX $1706
00/A678: D0 03        BNE $A67D
00/A67A: 4C 55 A2     JMP $A255       ; lift-off enterprise
00/A67D: AD 23 17     LDA $1723       ; can't land on falcon
00/A680: CD 1F 17     CMP $171F
00/A683: D0 0B        BNE $A690
00/A685: AE 21 17     LDX $1721
00/A688: EC 06 17     CPX $1706
00/A68B: D0 03        BNE $A690
00/A68D: 4C 55 A2     JMP $A255       ; lift-off enterprise
00/A690: AD 27 17     LDA $1727       ; can't land on big whale
00/A693: CD 1F 17     CMP $171F
00/A696: D0 0B        BNE $A6A3
00/A698: AE 25 17     LDX $1725
00/A69B: EC 06 17     CPX $1706
00/A69E: D0 03        BNE $A6A3
00/A6A0: 4C 55 A2     JMP $A255       ; lift-off enterprise
00/A6A3: A5 79        LDA $79
00/A6A5: 4A           LSR 
00/A6A6: 8D FD 06     STA $06FD       ; set airship animation speed
00/A6A9: C6 79        DEC $79
00/A6AB: C6 79        DEC $79
00/A6AD: D0 B1        BNE $A660
00/A6AF: 9C 04 17     STZ $1704
00/A6B2: 64 AC        STZ $AC
00/A6B4: 64 7B        STZ $7B
00/A6B6: A9 02        LDA #$02
00/A6B8: 8D 05 17     STA $1705
00/A6BB: AE 06 17     LDX $1706
00/A6BE: 8E 1D 17     STX $171D
00/A6C1: AD 01 17     LDA $1701
00/A6C4: 8D 1F 17     STA $171F
00/A6C7: 20 5D 8D     JSR $8D5D       ; play map song
00/A6CA: EE 02 1A     INC $1A02       ; enable tent/save
00/A6CD: 60           RTS 
; descending
00/A6CE: C6 B7        DEC $B7
00/A6D0: A5 B7        LDA $B7
00/A6D2: 18           CLC 
00/A6D3: 69 10        ADC #$10
00/A6D5: 85 AD        STA $AD
00/A6D7: A5 B7        LDA $B7
00/A6D9: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A6DD: C6 79        DEC $79
00/A6DF: 4C 60 A6     JMP $A660

; hook positions
00/A6E2: 00 01 02 03 04 05 06 07 07 06 05 04 03 02 01 00

; [ drop hovercraft ]

00/A6F2: A9 03        LDA #$03
00/A6F4: 8D 05 17     STA $1705
00/A6F7: 64 7A        STZ $7A
00/A6F9: 64 79        STZ $79
00/A6FB: 20 77 91     JSR $9177       ; reset all sprites
00/A6FE: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A701: A5 79        LDA $79
00/A703: 4A           LSR 
00/A704: 4A           LSR 
00/A705: AA           TAX 
00/A706: BD E2 A6     LDA $A6E2,X
00/A709: 8D F8 06     STA $06F8
00/A70C: 20 4B 91     JSR $914B       ; wait one frame
00/A70F: E6 79        INC $79
00/A711: A5 79        LDA $79
00/A713: C9 20        CMP #$20
00/A715: D0 0F        BNE $A726
00/A717: 9C D0 06     STZ $06D0
00/A71A: AD 01 17     LDA $1701       ; set hovercraft world and position
00/A71D: 8D 1B 17     STA $171B
00/A720: AE 06 17     LDX $1706
00/A723: 8E 19 17     STX $1719
00/A726: A5 79        LDA $79
00/A728: C9 40        CMP #$40
00/A72A: D0 CF        BNE $A6FB
00/A72C: 60           RTS 

; [ pick up hovercraft ]

00/A72D: A9 03        LDA #$03
00/A72F: 8D 05 17     STA $1705
00/A732: 64 7A        STZ $7A
00/A734: 64 79        STZ $79
00/A736: 20 77 91     JSR $9177       ; reset all sprites
00/A739: 20 C0 94     JSR $94C0       ; draw world map sprites
00/A73C: A5 79        LDA $79
00/A73E: 4A           LSR 
00/A73F: 4A           LSR 
00/A740: AA           TAX 
00/A741: BD E2 A6     LDA $A6E2,X
00/A744: 8D F8 06     STA $06F8
00/A747: 20 4B 91     JSR $914B       ; wait one frame
00/A74A: E6 79        INC $79
00/A74C: A5 79        LDA $79
00/A74E: C9 20        CMP #$20
00/A750: D0 03        BNE $A755
00/A752: EE D0 06     INC $06D0
00/A755: C9 40        CMP #$40
00/A757: D0 DD        BNE $A736
00/A759: 60           RTS 

; [ land falcon ]

; in falcon, pressed A button

00/A75A: A9 30        LDA #$30
00/A75C: 85 79        STA $79
00/A75E: 64 7A        STZ $7A
00/A760: 20 14 A0     JSR $A014       ; animate 4 frames
00/A763: A5 79        LDA $79
00/A765: C9 21        CMP #$21
00/A767: B0 65        BCS $A7CE
00/A769: A5 A2        LDA $A2
00/A76B: 29 10        AND #$10
00/A76D: D0 03        BNE $A772       ; branch if airship can land
00/A76F: 4C BD A2     JMP $A2BD       ; lift-off falcon
00/A772: AE 19 17     LDX $1719
00/A775: EC 06 17     CPX $1706
00/A778: D0 03        BNE $A77D
00/A77A: 4C BD A2     JMP $A2BD       ; lift-off falcon
00/A77D: AD 1F 17     LDA $171F
00/A780: CD 23 17     CMP $1723
00/A783: D0 0B        BNE $A790
00/A785: AE 1D 17     LDX $171D
00/A788: EC 06 17     CPX $1706
00/A78B: D0 03        BNE $A790
00/A78D: 4C BD A2     JMP $A2BD       ; lift-off falcon
00/A790: AD 27 17     LDA $1727
00/A793: CD 23 17     CMP $1723
00/A796: D0 0B        BNE $A7A3
00/A798: AE 25 17     LDX $1725
00/A79B: EC 06 17     CPX $1706
00/A79E: D0 03        BNE $A7A3
00/A7A0: 4C BD A2     JMP $A2BD       ; lift-off falcon
00/A7A3: A5 79        LDA $79
00/A7A5: 4A           LSR 
00/A7A6: 8D FD 06     STA $06FD       ; set airship animation speed
00/A7A9: C6 79        DEC $79
00/A7AB: C6 79        DEC $79
00/A7AD: D0 B1        BNE $A760
00/A7AF: 9C 04 17     STZ $1704
00/A7B2: 64 AC        STZ $AC
00/A7B4: 64 7B        STZ $7B
00/A7B6: A9 02        LDA #$02
00/A7B8: 8D 05 17     STA $1705
00/A7BB: AE 06 17     LDX $1706
00/A7BE: 8E 21 17     STX $1721
00/A7C1: AD 01 17     LDA $1701
00/A7C4: 8D 23 17     STA $1723
00/A7C7: 20 5D 8D     JSR $8D5D       ; play map song
00/A7CA: EE 02 1A     INC $1A02
00/A7CD: 60           RTS 
00/A7CE: C6 B8        DEC $B8
00/A7D0: A5 B8        LDA $B8
00/A7D2: 18           CLC 
00/A7D3: 69 10        ADC #$10
00/A7D5: 85 AD        STA $AD
00/A7D7: A5 B8        LDA $B8
00/A7D9: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A7DD: C6 79        DEC $79
00/A7DF: 4C 60 A7     JMP $A760

; [  ]

; in big whale, pressed A button

00/A7E2: A9 2F        LDA #$2F
00/A7E4: 85 79        STA $79
00/A7E6: 64 7A        STZ $7A
00/A7E8: 20 14 A0     JSR $A014       ; animate 4 frames
00/A7EB: A5 79        LDA $79
00/A7ED: C9 20        CMP #$20
00/A7EF: B0 69        BCS $A85A
00/A7F1: A5 A2        LDA $A2
00/A7F3: 29 10        AND #$10
00/A7F5: D0 03        BNE $A7FA       ; branch if airship can land
00/A7F7: 4C 24 A3     JMP $A324
00/A7FA: AE 19 17     LDX $1719
00/A7FD: EC 06 17     CPX $1706
00/A800: D0 03        BNE $A805       ; can't land on hovercraft
00/A802: 4C 24 A3     JMP $A324
00/A805: AD 1F 17     LDA $171F
00/A808: CD 27 17     CMP $1727
00/A80B: D0 0B        BNE $A818       ; can't land on big whale
00/A80D: AE 1D 17     LDX $171D
00/A810: EC 06 17     CPX $1706
00/A813: D0 03        BNE $A818
00/A815: 4C 24 A3     JMP $A324
00/A818: AD 23 17     LDA $1723
00/A81B: CD 27 17     CMP $1727
00/A81E: D0 0B        BNE $A82B       ; can't land on falcon
00/A820: AE 21 17     LDX $1721
00/A823: EC 06 17     CPX $1706
00/A826: D0 03        BNE $A82B
00/A828: 4C 24 A3     JMP $A324
00/A82B: A5 79        LDA $79
00/A82D: 4A           LSR 
00/A82E: 8D FD 06     STA $06FD       ; set airship animation speed
00/A831: C6 79        DEC $79
00/A833: D0 B3        BNE $A7E8
00/A835: 9C 04 17     STZ $1704
00/A838: 64 AC        STZ $AC
00/A83A: 64 7B        STZ $7B
00/A83C: A9 02        LDA #$02
00/A83E: 8D 05 17     STA $1705
00/A841: AD 00 17     LDA $1700
00/A844: 8D 27 17     STA $1727
00/A847: AE 06 17     LDX $1706
00/A84A: 8E 25 17     STX $1725
00/A84D: A5 B1        LDA $B1
00/A84F: D0 05        BNE $A856       ; branch if just acquired vehicle
00/A851: A9 52        LDA #$52
00/A853: 20 2D F2     JSR $F22D       ; execute trigger script
00/A856: EE 02 1A     INC $1A02
00/A859: 60           RTS 
00/A85A: C6 B9        DEC $B9
00/A85C: C6 B9        DEC $B9
00/A85E: A5 B9        LDA $B9
00/A860: 18           CLC 
00/A861: 69 10        ADC #$10
00/A863: 85 AD        STA $AD
00/A865: A5 B9        LDA $B9
00/A867: 4A           LSR 
00/A868: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/A86C: C6 79        DEC $79
00/A86E: 4C E8 A7     JMP $A7E8

; --------------------------------------------------------------------------

; [ move player ]

00/A871: A5 AB        LDA $AB
00/A873: D0 03        BNE $A878
00/A875: 4C 40 A9     JMP $A940       ; return if player is not moving
00/A878: A5 C1        LDA $C1
00/A87A: F0 08        BEQ $A884       ; branch if no floor damage
00/A87C: A5 7B        LDA $7B
00/A87E: 29 08        AND #$08
00/A880: D0 02        BNE $A884
00/A882: E6 C4        INC $C4         ; invert map colors every 8 frames
00/A884: E6 7B        INC $7B         ; increment party frame counter
00/A886: A5 AC        LDA $AC         ; party movement speed
00/A888: AA           TAX 
00/A889: A5 AB        LDA $AB
00/A88B: C9 01        CMP #$01
00/A88D: D0 2D        BNE $A8BC
; up
00/A88F: A5 5C        LDA $5C         ; bg1 vertical scroll
00/A891: 85 06        STA $06
00/A893: 38           SEC 
00/A894: FD 12 AD     SBC $AD12,X     ; subtract movement speed
00/A897: 85 5C        STA $5C
00/A899: A5 5D        LDA $5D
00/A89B: E9 00        SBC #$00
00/A89D: 29 07        AND #$07
00/A89F: 85 5D        STA $5D
00/A8A1: A5 06        LDA $06
00/A8A3: 29 0F        AND #$0F
00/A8A5: 38           SEC 
00/A8A6: FD 12 AD     SBC $AD12,X
00/A8A9: B0 39        BCS $A8E4
00/A8AB: AD FA 06     LDA $06FA       ; map size mask id
00/A8AE: AA           TAX 
00/A8AF: AD 07 17     LDA $1707       ; decrement y position
00/A8B2: 3A           DEC 
00/A8B3: 3D 0B AD     AND $AD0B,X     ; size mask
00/A8B6: 8D 07 17     STA $1707
00/A8B9: 4C 40 A9     JMP $A940
; right
00/A8BC: C9 02        CMP #$02
00/A8BE: D0 27        BNE $A8E7
00/A8C0: A5 5A        LDA $5A
00/A8C2: 18           CLC 
00/A8C3: 7D 12 AD     ADC $AD12,X
00/A8C6: 85 5A        STA $5A
00/A8C8: A5 5B        LDA $5B
00/A8CA: 69 00        ADC #$00
00/A8CC: 29 07        AND #$07
00/A8CE: 85 5B        STA $5B
00/A8D0: A5 5A        LDA $5A
00/A8D2: 29 0F        AND #$0F
00/A8D4: D0 6A        BNE $A940
00/A8D6: AD FA 06     LDA $06FA
00/A8D9: AA           TAX 
00/A8DA: AD 06 17     LDA $1706
00/A8DD: 1A           INC 
00/A8DE: 3D 0B AD     AND $AD0B,X
00/A8E1: 8D 06 17     STA $1706
00/A8E4: 4C 40 A9     JMP $A940
; down
00/A8E7: C9 03        CMP #$03
00/A8E9: D0 27        BNE $A912
00/A8EB: A5 5C        LDA $5C
00/A8ED: 18           CLC 
00/A8EE: 7D 12 AD     ADC $AD12,X
00/A8F1: 85 5C        STA $5C
00/A8F3: A5 5D        LDA $5D
00/A8F5: 69 00        ADC #$00
00/A8F7: 29 07        AND #$07
00/A8F9: 85 5D        STA $5D
00/A8FB: A5 5C        LDA $5C
00/A8FD: 29 0F        AND #$0F
00/A8FF: D0 3F        BNE $A940
00/A901: AD FA 06     LDA $06FA
00/A904: AA           TAX 
00/A905: AD 07 17     LDA $1707
00/A908: 1A           INC 
00/A909: 3D 0B AD     AND $AD0B,X
00/A90C: 8D 07 17     STA $1707
00/A90F: 4C 40 A9     JMP $A940
; left
00/A912: C9 04        CMP #$04
00/A914: D0 2A        BNE $A940
00/A916: A5 5A        LDA $5A
00/A918: 85 06        STA $06
00/A91A: 38           SEC 
00/A91B: FD 12 AD     SBC $AD12,X
00/A91E: 85 5A        STA $5A
00/A920: A5 5B        LDA $5B
00/A922: E9 00        SBC #$00
00/A924: 29 07        AND #$07
00/A926: 85 5B        STA $5B
00/A928: A5 06        LDA $06
00/A92A: 29 0F        AND #$0F
00/A92C: 38           SEC 
00/A92D: FD 12 AD     SBC $AD12,X
00/A930: B0 0E        BCS $A940
00/A932: AD FA 06     LDA $06FA
00/A935: AA           TAX 
00/A936: AD 06 17     LDA $1706
00/A939: 3A           DEC 
00/A93A: 3D 0B AD     AND $AD0B,X
00/A93D: 8D 06 17     STA $1706
00/A940: 60           RTS 

; [ check player movement (sub-map) ]

00/A941: A5 D5        LDA $D5
00/A943: D0 03        BNE $A948       ; return if player control is disabled
00/A945: 4C 3F AA     JMP $AA3F
00/A948: 64 C4        STZ $C4
00/A94A: 20 6C 9F     JSR $9F6C       ; update local tile properties
00/A94D: A5 B1        LDA $B1
00/A94F: F0 08        BEQ $A959
00/A951: A5 04        LDA $04
00/A953: 85 02        STA $02
00/A955: A5 05        LDA $05
00/A957: 85 03        STA $03
00/A959: A5 A1        LDA $A1
00/A95B: 29 04        AND #$04
00/A95D: D0 06        BNE $A965       ; branch if a on bridge tile
00/A95F: A5 A1        LDA $A1
00/A961: 29 03        AND #$03
00/A963: 85 D2        STA $D2         ; set current z-level
00/A965: 20 13 AB     JSR $AB13
00/A968: A5 A1        LDA $A1
00/A96A: 29 03        AND #$03
00/A96C: 18           CLC 
00/A96D: 69 04        ADC #$04
00/A96F: 85 0A        STA $0A
; right button
00/A971: A5 03        LDA $03
00/A973: 29 01        AND #$01
00/A975: F0 15        BEQ $A98C
00/A977: A5 CF        LDA $CF
00/A979: D0 05        BNE $A980
00/A97B: A9 01        LDA #$01
00/A97D: 8D 05 17     STA $1705
00/A980: A9 02        LDA #$02
00/A982: 8D 09 07     STA $0709
00/A985: 20 58 AA     JSR $AA58
00/A988: C9 00        CMP #$00
00/A98A: F0 5D        BEQ $A9E9
; left button
00/A98C: A5 03        LDA $03
00/A98E: 29 02        AND #$02
00/A990: F0 15        BEQ $A9A7
00/A992: A5 CF        LDA $CF
00/A994: D0 05        BNE $A99B
00/A996: A9 03        LDA #$03
00/A998: 8D 05 17     STA $1705
00/A99B: A9 04        LDA #$04
00/A99D: 8D 09 07     STA $0709
00/A9A0: 20 58 AA     JSR $AA58
00/A9A3: C9 00        CMP #$00
00/A9A5: F0 42        BEQ $A9E9
; down button
00/A9A7: A5 03        LDA $03
00/A9A9: 29 04        AND #$04
00/A9AB: F0 15        BEQ $A9C2
00/A9AD: A5 CF        LDA $CF
00/A9AF: D0 05        BNE $A9B6
00/A9B1: A9 02        LDA #$02
00/A9B3: 8D 05 17     STA $1705
00/A9B6: A9 03        LDA #$03
00/A9B8: 8D 09 07     STA $0709
00/A9BB: 20 58 AA     JSR $AA58
00/A9BE: C9 00        CMP #$00
00/A9C0: F0 27        BEQ $A9E9
; up button
00/A9C2: A5 03        LDA $03
00/A9C4: 29 08        AND #$08
00/A9C6: F0 15        BEQ $A9DD
00/A9C8: A5 CF        LDA $CF
00/A9CA: D0 05        BNE $A9D1
00/A9CC: A9 00        LDA #$00
00/A9CE: 8D 05 17     STA $1705
00/A9D1: A9 01        LDA #$01
00/A9D3: 8D 09 07     STA $0709
00/A9D6: 20 58 AA     JSR $AA58       ; check tile passability
00/A9D9: C9 00        CMP #$00
00/A9DB: F0 0C        BEQ $A9E9
00/A9DD: 64 AB        STZ $AB
00/A9DF: 20 D8 AA     JSR $AAD8
00/A9E2: A5 B1        LDA $B1
00/A9E4: D0 19        BNE $A9FF
00/A9E6: 4C 3F AA     JMP $AA3F
00/A9E9: A5 E0        LDA $E0
00/A9EB: D0 15        BNE $AA02
00/A9ED: AD 09 07     LDA $0709
00/A9F0: 85 AB        STA $AB
00/A9F2: 20 D8 AA     JSR $AAD8
00/A9F5: A5 EA        LDA $EA         ; close map name window
00/A9F7: D0 02        BNE $A9FB
00/A9F9: E6 EA        INC $EA
00/A9FB: A5 B1        LDA $B1
00/A9FD: F0 03        BEQ $AA02
00/A9FF: 4C 36 AA     JMP $AA36
00/AA02: A5 AB        LDA $AB
00/AA04: 4A           LSR 
00/AA05: 90 2F        BCC $AA36
00/AA07: C9 00        CMP #$00
00/AA09: D0 17        BNE $AA22
00/AA0B: AD 0C 07     LDA $070C
00/AA0E: C9 70        CMP #$70        ; closed door 1
00/AA10: F0 04        BEQ $AA16
00/AA12: C9 71        CMP #$71        ; closed door 2
00/AA14: D0 20        BNE $AA36
00/AA16: AD 07 17     LDA $1707
00/AA19: 3A           DEC 
00/AA1A: 85 0E        STA $0E
00/AA1C: 20 40 AA     JSR $AA40       ; open door
00/AA1F: 4C 36 AA     JMP $AA36
00/AA22: AD 0E 07     LDA $070E
00/AA25: C9 70        CMP #$70        ; closed door 1
00/AA27: F0 04        BEQ $AA2D
00/AA29: C9 71        CMP #$71        ; closed door 2
00/AA2B: D0 09        BNE $AA36
00/AA2D: AD 07 17     LDA $1707
00/AA30: 1A           INC 
00/AA31: 85 0E        STA $0E
00/AA33: 20 40 AA     JSR $AA40       ; open door
00/AA36: 20 B3 97     JSR $97B3       ; do poison damage
00/AA39: 20 FF 97     JSR $97FF       ; do floor damage
00/AA3C: 20 5F F7     JSR $F75F       ; update tilemap scrolling (sub-map)
00/AA3F: 60           RTS 

; [ open door ]

00/AA40: AD 06 17     LDA $1706
00/AA43: 85 0C        STA $0C
00/AA45: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/AA48: 8E FE 06     STX $06FE
00/AA4B: 20 60 AB     JSR $AB60       ; get open door tiles
00/AA4E: A9 45        LDA #$45
00/AA50: 20 99 8D     JSR $8D99       ; play sound effect
00/AA53: A9 01        LDA #$01
00/AA55: 85 D4        STA $D4         ; enable vram map update
00/AA57: 60           RTS 

; [ check tile passability ]

; $0A: z-level
; return 0 if passable, 1 if not

00/AA58: A5 B1        LDA $B1
00/AA5A: F0 03        BEQ $AA5F       ; return 0 if an event is running
00/AA5C: A9 00        LDA #$00
00/AA5E: 60           RTS 
00/AA5F: 20 94 AA     JSR $AA94       ; check if blocked by npc
00/AA62: C9 00        CMP #$00
00/AA64: D0 2B        BNE $AA91
00/AA66: AD 09 07     LDA $0709
00/AA69: 0A           ASL 
00/AA6A: A8           TAY 
00/AA6B: A5 A1        LDA $A1
00/AA6D: 29 04        AND #$04
00/AA6F: F0 0C        BEQ $AA7D       ; branch if not on a bridge tile
00/AA71: B9 A1 06     LDA $06A1,Y
00/AA74: 29 03        AND #$03
00/AA76: 25 D2        AND $D2
00/AA78: F0 0D        BEQ $AA87       ; branch if z-level doesn't match
00/AA7A: A9 00        LDA #$00
00/AA7C: 60           RTS 
00/AA7D: B9 A1 06     LDA $06A1,Y
00/AA80: 25 0A        AND $0A
00/AA82: F0 0D        BEQ $AA91
00/AA84: A9 00        LDA #$00
00/AA86: 60           RTS 
00/AA87: B9 A1 06     LDA $06A1,Y
00/AA8A: 29 04        AND #$04
00/AA8C: F0 03        BEQ $AA91
00/AA8E: A9 00        LDA #$00
00/AA90: 60           RTS 
00/AA91: A9 01        LDA #$01
00/AA93: 60           RTS 

; [ check if blocked by npc ]

00/AA94: AD 09 07     LDA $0709       ; moving direction
00/AA97: A8           TAY 
00/AA98: 0A           ASL 
00/AA99: AA           TAX 
00/AA9A: B5 A1        LDA $A1,X
00/AA9C: 29 04        AND #$04
00/AA9E: F0 09        BEQ $AAA9       ; branch if not moving to a bridge tile
00/AAA0: A5 D2        LDA $D2
00/AAA2: C9 01        CMP #$01
00/AAA4: F0 03        BEQ $AAA9       ; branch if not on lower z-level
00/AAA6: A9 00        LDA #$00
00/AAA8: 60           RTS 
00/AAA9: DA           PHX 
00/AAAA: AD 06 17     LDA $1706       ; x position
00/AAAD: 18           CLC 
00/AAAE: 79 09 AB     ADC $AB09,Y
00/AAB1: 85 0C        STA $0C
00/AAB3: C9 20        CMP #$20
00/AAB5: B0 1D        BCS $AAD4
00/AAB7: AD 07 17     LDA $1707       ; y position
00/AABA: 18           CLC 
00/AABB: 79 0E AB     ADC $AB0E,Y
00/AABE: 85 0E        STA $0E
00/AAC0: C9 20        CMP #$20
00/AAC2: B0 10        BCS $AAD4       ; branch if out of bounds
00/AAC4: 20 55 C3     JSR $C355       ; get pointer to npc map
00/AAC7: A6 3D        LDX $3D
00/AAC9: BF 00 4C 7F  LDA $7F4C00,X
00/AACD: 10 05        BPL $AAD4       ; branch if tile is empty
00/AACF: 85 EE        STA $EE
00/AAD1: 4C D6 AA     JMP $AAD6
00/AAD4: A9 00        LDA #$00
00/AAD6: FA           PLX 
00/AAD7: 60           RTS 

; [ set player position in npc map ]

00/AAD8: A5 AB        LDA $AB
00/AADA: 0A           ASL 
00/AADB: A8           TAY 
00/AADC: B9 A1 06     LDA $06A1,Y
00/AADF: 29 04        AND #$04
00/AAE1: F0 09        BEQ $AAEC       ; branch if not a bridge tile
00/AAE3: B9 A1 06     LDA $06A1,Y
00/AAE6: 29 03        AND #$03
00/AAE8: 25 D2        AND $D2
00/AAEA: F0 1C        BEQ $AB08
00/AAEC: A5 AB        LDA $AB
00/AAEE: A8           TAY 
00/AAEF: AD 06 17     LDA $1706
00/AAF2: 18           CLC 
00/AAF3: 79 09 AB     ADC $AB09,Y
00/AAF6: 85 0C        STA $0C
00/AAF8: AD 07 17     LDA $1707
00/AAFB: 18           CLC 
00/AAFC: 79 0E AB     ADC $AB0E,Y
00/AAFF: 85 0E        STA $0E
00/AB01: A9 FF        LDA #$FF        ; player is $FF in npc map
00/AB03: 85 AE        STA $AE
00/AB05: 20 45 C3     JSR $C345       ; set npc map position
00/AB08: 60           RTS 

; x offset for each movement direction
00/AB09: 00 00 01 00 FF
; y offset for each movement direction
00/AB0E: 00 FF 00 01 00

; [ clear player position in npc map ]

00/AB13: A5 A1        LDA $A1
00/AB15: 29 04        AND #$04
00/AB17: F0 08        BEQ $AB21       ; branch if not on a bridge tile
00/AB19: A5 A1        LDA $A1
00/AB1B: 29 03        AND #$03
00/AB1D: 25 D2        AND $D2
00/AB1F: F0 0D        BEQ $AB2E
00/AB21: AD 06 17     LDA $1706
00/AB24: 85 0C        STA $0C
00/AB26: AD 07 17     LDA $1707
00/AB29: 85 0E        STA $0E
00/AB2B: 20 FD C2     JSR $C2FD       ; clear npc map position
00/AB2E: 60           RTS 

; [ get bg1 tilemap vram address ]

00/AB2F: A5 0E        LDA $0E
00/AB31: 29 0F        AND #$0F
00/AB33: 85 19        STA $19
00/AB35: 64 18        STZ $18
00/AB37: 46 19        LSR $19
00/AB39: 66 18        ROR $18
00/AB3B: 46 19        LSR $19
00/AB3D: 66 18        ROR $18
00/AB3F: A5 0C        LDA $0C
00/AB41: 29 0F        AND #$0F
00/AB43: 0A           ASL 
00/AB44: 18           CLC 
00/AB45: 65 18        ADC $18
00/AB47: 85 18        STA $18
00/AB49: A5 19        LDA $19
00/AB4B: 18           CLC 
00/AB4C: 69 18        ADC #$18
00/AB4E: 85 19        STA $19
00/AB50: A5 0C        LDA $0C
00/AB52: 29 10        AND #$10
00/AB54: F0 07        BEQ $AB5D
00/AB56: A5 19        LDA $19
00/AB58: 18           CLC 
00/AB59: 69 04        ADC #$04
00/AB5B: 85 19        STA $19
00/AB5D: A6 18        LDX $18
00/AB5F: 60           RTS 

; [ get open door tiles ]

00/AB60: C2 20        REP #$20
00/AB62: AF DE 48 7F  LDA $7F48DE
00/AB66: 8D 00 07     STA $0700
00/AB69: AF DE 49 7F  LDA $7F49DE
00/AB6D: 8D 02 07     STA $0702
00/AB70: AF DE 4A 7F  LDA $7F4ADE
00/AB74: 8D 04 07     STA $0704
00/AB77: AF DE 4B 7F  LDA $7F4BDE
00/AB7B: 8D 06 07     STA $0706
00/AB7E: A9 00 00     LDA #$0000
00/AB81: E2 20        SEP #$20
00/AB83: 60           RTS 

; [ check player movement (world map) ]

00/AB84: A5 D5        LDA $D5
00/AB86: D0 01        BNE $AB89       ; return if player control is disabled
00/AB88: 60           RTS 
00/AB89: 20 6C 9F     JSR $9F6C       ; update local tile properties
00/AB8C: A5 B1        LDA $B1
00/AB8E: F0 08        BEQ $AB98
00/AB90: A5 04        LDA $04
00/AB92: 85 02        STA $02
00/AB94: A5 05        LDA $05
00/AB96: 85 03        STA $03
00/AB98: A5 A1        LDA $A1
00/AB9A: 29 41        AND #$41
00/AB9C: 85 D2        STA $D2
00/AB9E: AD 15 17     LDA $1715
00/ABA1: C9 02        CMP #$02
00/ABA3: D0 40        BNE $ABE5
00/ABA5: AD 06 17     LDA $1706
00/ABA8: 38           SEC 
00/ABA9: ED 16 17     SBC $1716
00/ABAC: F0 14        BEQ $ABC2
00/ABAE: 10 09        BPL $ABB9
00/ABB0: A9 01        LDA #$01
00/ABB2: 8D 05 17     STA $1705
00/ABB5: 1A           INC 
00/ABB6: 4C 6B AC     JMP $AC6B
00/ABB9: A9 03        LDA #$03
00/ABBB: 8D 05 17     STA $1705
00/ABBE: 1A           INC 
00/ABBF: 4C 6B AC     JMP $AC6B
00/ABC2: AD 07 17     LDA $1707
00/ABC5: 38           SEC 
00/ABC6: ED 17 17     SBC $1717
00/ABC9: F0 14        BEQ $ABDF
00/ABCB: 10 09        BPL $ABD6
00/ABCD: A9 02        LDA #$02
00/ABCF: 8D 05 17     STA $1705
00/ABD2: 1A           INC 
00/ABD3: 4C 6B AC     JMP $AC6B
00/ABD6: A9 00        LDA #$00
00/ABD8: 8D 05 17     STA $1705
00/ABDB: 1A           INC 
00/ABDC: 4C 6B AC     JMP $AC6B
00/ABDF: A9 80        LDA #$80
00/ABE1: 85 02        STA $02
00/ABE3: 64 54        STZ $54
00/ABE5: 20 3B 9E     JSR $9E3B       ; board/exit vehicle
00/ABE8: A5 03        LDA $03
00/ABEA: 29 0F        AND #$0F
00/ABEC: F0 77        BEQ $AC65
00/ABEE: 29 01        AND #$01
00/ABF0: F0 05        BEQ $ABF7
00/ABF2: A9 01        LDA #$01
00/ABF4: 4C 0F AC     JMP $AC0F
00/ABF7: A5 03        LDA $03
00/ABF9: 29 02        AND #$02
00/ABFB: F0 05        BEQ $AC02
00/ABFD: A9 03        LDA #$03
00/ABFF: 4C 0F AC     JMP $AC0F
00/AC02: A5 03        LDA $03
00/AC04: 29 04        AND #$04
00/AC06: F0 05        BEQ $AC0D
00/AC08: A9 02        LDA #$02
00/AC0A: 4C 0F AC     JMP $AC0F
00/AC0D: A9 00        LDA #$00
00/AC0F: 8D 05 17     STA $1705
00/AC12: 1A           INC 
00/AC13: 8D 09 07     STA $0709
00/AC16: 0A           ASL 
00/AC17: AA           TAX 
00/AC18: A5 B1        LDA $B1
00/AC1A: D0 4C        BNE $AC68
00/AC1C: AD 00 17     LDA $1700
00/AC1F: C9 01        CMP #$01
00/AC21: D0 23        BNE $AC46
00/AC23: AD 04 17     LDA $1704
00/AC26: C9 05        CMP #$05
00/AC28: D0 0C        BNE $AC36
00/AC2A: AD 87 12     LDA $1287
00/AC2D: 29 02        AND #$02
00/AC2F: F0 15        BEQ $AC46
00/AC31: A9 01        LDA #$01
00/AC33: 4C 4B AC     JMP $AC4B
00/AC36: C9 04        CMP #$04
00/AC38: D0 0C        BNE $AC46
00/AC3A: AD 81 12     LDA $1281
00/AC3D: 29 04        AND #$04
00/AC3F: F0 05        BEQ $AC46
00/AC41: A9 01        LDA #$01
00/AC43: 4C 4B AC     JMP $AC4B
00/AC46: AD 04 17     LDA $1704
00/AC49: F0 0B        BEQ $AC56
00/AC4B: A8           TAY 
00/AC4C: B5 A1        LDA $A1,X
00/AC4E: 39 04 AD     AND $AD04,Y
00/AC51: F0 12        BEQ $AC65
00/AC53: 4C 5E AC     JMP $AC5E
00/AC56: B5 A1        LDA $A1,X
00/AC58: 29 41        AND #$41
00/AC5A: 25 D2        AND $D2
00/AC5C: F0 07        BEQ $AC65
00/AC5E: 20 7D AC     JSR $AC7D       ; check if blocked by vehicle
00/AC61: A5 0A        LDA $0A
00/AC63: F0 03        BEQ $AC68       ; branch if not blocked
00/AC65: 64 AB        STZ $AB
00/AC67: 60           RTS 
00/AC68: AD 09 07     LDA $0709
00/AC6B: 85 AB        STA $AB
00/AC6D: 20 B3 97     JSR $97B3       ; do poison damage
00/AC70: AD 07 17     LDA $1707
00/AC73: 8D 0A 07     STA $070A
00/AC76: 20 20 FD     JSR $FD20       ; decompress world tilemap
00/AC79: 20 33 F6     JSR $F633       ; update tilemap scrolling (world map)
00/AC7C: 60           RTS 

; [ check if blocked by vehicle ]

; $0A: 1 if blocked, 0 if not blocked (out)

00/AC7D: AD 09 07     LDA $0709       ; player movement direction
00/AC80: AA           TAX 
00/AC81: AD 06 17     LDA $1706
00/AC84: 18           CLC 
00/AC85: 7D 09 AB     ADC $AB09,X
00/AC88: 85 0C        STA $0C
00/AC8A: AD 07 17     LDA $1707
00/AC8D: 18           CLC 
00/AC8E: 7D 0E AB     ADC $AB0E,X
00/AC91: 85 0E        STA $0E
00/AC93: 64 0A        STZ $0A
00/AC95: AD 04 17     LDA $1704
00/AC98: D0 01        BNE $AC9B       ; return if not in a vehicle
00/AC9A: 60           RTS 
; chocobo
00/AC9B: C9 01        CMP #$01
00/AC9D: D0 11        BNE $ACB0
00/AC9F: A5 0C        LDA $0C
00/ACA1: CD 19 17     CMP $1719
00/ACA4: D0 0A        BNE $ACB0
00/ACA6: A5 0E        LDA $0E
00/ACA8: CD 1A 17     CMP $171A
00/ACAB: D0 03        BNE $ACB0
00/ACAD: E6 0A        INC $0A         ; can't travel over hovercraft
00/ACAF: 60           RTS 
; hovercraft
00/ACB0: AD 04 17     LDA $1704
00/ACB3: C9 02        CMP #$02
00/ACB5: F0 4C        BEQ $AD03
00/ACB7: C9 04        CMP #$04
00/ACB9: B0 48        BCS $AD03
00/ACBB: AD 15 17     LDA $1715
00/ACBE: D0 11        BNE $ACD1
00/ACC0: A5 0C        LDA $0C
00/ACC2: CD 13 17     CMP $1713       ; can't travel over black chocobo
00/ACC5: D0 0A        BNE $ACD1
00/ACC7: A5 0E        LDA $0E
00/ACC9: CD 14 17     CMP $1714
00/ACCC: D0 03        BNE $ACD1
00/ACCE: E6 0A        INC $0A
00/ACD0: 60           RTS 
00/ACD1: A5 0C        LDA $0C
00/ACD3: CD 1D 17     CMP $171D       ; can't travel over enterprise
00/ACD6: D0 0A        BNE $ACE2
00/ACD8: A5 0E        LDA $0E
00/ACDA: CD 1E 17     CMP $171E
00/ACDD: D0 03        BNE $ACE2
00/ACDF: E6 0A        INC $0A
00/ACE1: 60           RTS 
00/ACE2: A5 0C        LDA $0C
00/ACE4: CD 21 17     CMP $1721       ; can't travel over falcon
00/ACE7: D0 0A        BNE $ACF3
00/ACE9: A5 0E        LDA $0E
00/ACEB: CD 22 17     CMP $1722
00/ACEE: D0 03        BNE $ACF3
00/ACF0: E6 0A        INC $0A
00/ACF2: 60           RTS 
00/ACF3: A5 0C        LDA $0C
00/ACF5: CD 25 17     CMP $1725       ; can't travel over big whale
00/ACF8: D0 09        BNE $AD03
00/ACFA: A5 0E        LDA $0E
00/ACFC: CD 26 17     CMP $1726
00/ACFF: D0 02        BNE $AD03
00/AD01: E6 0A        INC $0A
00/AD03: 60           RTS 

; bit mask for vehicle passability
00/AD04: 01 02 04 10 20 20 80

; world map size masks
00/AD0B: FF 7F 3F

; trigger check frequency for each movement speed
00/AD0E: 0F 07 03 01

; player movement speeds (pixels per frame)
00/AD12: 01 02 04 08

; --------------------------------------------------------------------------

; [ open gp window ]

00/AD16: 20 2D 91     JSR $912D       ; wait for vblank
00/AD19: A9 80        LDA #$80
00/AD1B: 8D 15 21     STA $2115
00/AD1E: 20 2A 8B     JSR $8B2A       ; init dma
00/AD21: A9 01        LDA #$01
00/AD23: 8D 00 43     STA $4300
00/AD26: A9 14        LDA #$14
00/AD28: 8D 04 43     STA $4304
00/AD2B: A2 F6 F5     LDX #$F5F6      ; gp window tile data
00/AD2E: 8E 02 43     STX $4302
00/AD31: A2 92 28     LDX #$2892
00/AD34: 8E 16 21     STX $2116
00/AD37: A2 18 00     LDX #$0018
00/AD3A: 8E 05 43     STX $4305
00/AD3D: 20 36 8B     JSR $8B36       ; execute dma
00/AD40: A2 B2 28     LDX #$28B2
00/AD43: 8E 16 21     STX $2116
00/AD46: 9C 0B 42     STZ $420B
00/AD49: A2 0E F6     LDX #$F60E
00/AD4C: 8E 02 43     STX $4302
00/AD4F: A2 18 00     LDX #$0018
00/AD52: 8E 05 43     STX $4305
00/AD55: 20 36 8B     JSR $8B36       ; execute dma
00/AD58: A2 D2 28     LDX #$28D2
00/AD5B: 8E 16 21     STX $2116
00/AD5E: 9C 0B 42     STZ $420B
00/AD61: A2 26 F6     LDX #$F626
00/AD64: 8E 02 43     STX $4302
00/AD67: A2 18 00     LDX #$0018
00/AD6A: 8E 05 43     STX $4305
00/AD6D: 20 36 8B     JSR $8B36       ; execute dma
00/AD70: A2 F2 28     LDX #$28F2
00/AD73: 8E 16 21     STX $2116
00/AD76: 9C 0B 42     STZ $420B
00/AD79: A2 3E F6     LDX #$F63E
00/AD7C: 8E 02 43     STX $4302
00/AD7F: A2 18 00     LDX #$0018
00/AD82: 8E 05 43     STX $4305
00/AD85: 20 36 8B     JSR $8B36       ; execute dma
00/AD88: A2 D3 28     LDX #$28D3
00/AD8B: 8E 16 21     STX $2116
00/AD8E: 64 0A        STZ $0A
00/AD90: A2 00 00     LDX #$0000
00/AD93: BD 34 06     LDA $0634,X
00/AD96: C9 80        CMP #$80
00/AD98: D0 0E        BNE $ADA8
00/AD9A: E0 07 00     CPX #$0007
00/AD9D: F0 09        BEQ $ADA8
00/AD9F: A5 0A        LDA $0A
00/ADA1: D0 07        BNE $ADAA
00/ADA3: A9 FF        LDA #$FF
00/ADA5: 4C AD AD     JMP $ADAD
00/ADA8: E6 0A        INC $0A
00/ADAA: BD 34 06     LDA $0634,X
00/ADAD: 8D 18 21     STA $2118
00/ADB0: A9 20        LDA #$20
00/ADB2: 8D 19 21     STA $2119
00/ADB5: E8           INX 
00/ADB6: E0 08 00     CPX #$0008
00/ADB9: D0 D8        BNE $AD93
00/ADBB: 60           RTS 

; [ close gp window ]

00/ADBC: 20 2D 91     JSR $912D       ; wait for vblank
00/ADBF: A9 80        LDA #$80
00/ADC1: 8D 15 21     STA $2115
00/ADC4: 20 2A 8B     JSR $8B2A       ; init dma
00/ADC7: A9 09        LDA #$09
00/ADC9: 8D 00 43     STA $4300
00/ADCC: 9C 76 06     STZ $0676
00/ADCF: A2 76 06     LDX #$0676
00/ADD2: 8E 02 43     STX $4302
00/ADD5: A2 80 28     LDX #$2880
00/ADD8: 8E 16 21     STX $2116
00/ADDB: A2 00 01     LDX #$0100
00/ADDE: 8E 05 43     STX $4305
00/ADE1: 20 36 8B     JSR $8B36       ; execute dma
00/ADE4: 60           RTS 

; [ show yes/no selection window ]

00/ADE5: 64 DC        STZ $DC
00/ADE7: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/ADEA: 20 F1 B6     JSR $B6F1       ; init irq for dialogue window
00/ADED: 20 AB AE     JSR $AEAB       ; transfer yes/no window to vram
00/ADF0: E6 DC        INC $DC
00/ADF2: A5 DC        LDA $DC
00/ADF4: C9 06        CMP #$06
00/ADF6: D0 EF        BNE $ADE7
00/ADF8: A9 01        LDA #$01
00/ADFA: 85 54        STA $54
00/ADFC: 64 8C        STZ $8C
00/ADFE: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/AE01: 20 F1 B6     JSR $B6F1       ; init irq for dialogue window
00/AE04: 22 1D CA 15  JSL $15CA1D     ; reset controller inputs
00/AE08: A5 02        LDA $02
00/AE0A: 29 80        AND #$80
00/AE0C: F0 09        BEQ $AE17
00/AE0E: A5 54        LDA $54
00/AE10: D0 05        BNE $AE17
00/AE12: E6 54        INC $54
00/AE14: 4C 6E AE     JMP $AE6E
00/AE17: A5 03        LDA $03
00/AE19: 29 80        AND #$80
00/AE1B: F0 0D        BEQ $AE2A
00/AE1D: A5 55        LDA $55
00/AE1F: D0 09        BNE $AE2A
00/AE21: E6 55        INC $55
00/AE23: A9 01        LDA #$01
00/AE25: 85 8C        STA $8C
00/AE27: 4C 6E AE     JMP $AE6E
00/AE2A: A5 01        LDA $01
00/AE2C: 29 0C        AND #$0C
00/AE2E: F0 CE        BEQ $ADFE
00/AE30: A5 8C        LDA $8C
00/AE32: 49 01        EOR #$01
00/AE34: 85 8C        STA $8C
00/AE36: A2 C4 28     LDX #$28C4
00/AE39: 8E 16 21     STX $2116
00/AE3C: A5 8C        LDA $8C
00/AE3E: D0 05        BNE $AE45
00/AE40: A9 14        LDA #$14
00/AE42: 4C 47 AE     JMP $AE47
00/AE45: A9 FF        LDA #$FF
00/AE47: 8D 18 21     STA $2118
00/AE4A: A9 20        LDA #$20
00/AE4C: 8D 19 21     STA $2119
00/AE4F: A2 04 29     LDX #$2904
00/AE52: 8E 16 21     STX $2116
00/AE55: A5 8C        LDA $8C
00/AE57: F0 05        BEQ $AE5E
00/AE59: A9 14        LDA #$14
00/AE5B: 4C 60 AE     JMP $AE60
00/AE5E: A9 FF        LDA #$FF
00/AE60: 8D 18 21     STA $2118
00/AE63: A9 20        LDA #$20
00/AE65: 8D 19 21     STA $2119
00/AE68: 20 7D B0     JSR $B07D       ; move cursor
00/AE6B: 4C FE AD     JMP $ADFE
00/AE6E: 20 73 B0     JSR $B073
00/AE71: A5 8C        LDA $8C
00/AE73: 85 DB        STA $DB
00/AE75: C6 DC        DEC $DC
00/AE77: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/AE7A: 20 F1 B6     JSR $B6F1       ; init irq for dialogue window
00/AE7D: 20 AB AE     JSR $AEAB       ; transfer yes/no window to vram
00/AE80: C6 DC        DEC $DC
00/AE82: 10 F3        BPL $AE77
00/AE84: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/AE87: 20 F1 B6     JSR $B6F1       ; init irq for dialogue window
00/AE8A: A5 3D        LDA $3D
00/AE8C: 38           SEC 
00/AE8D: E9 20        SBC #$20
00/AE8F: 85 3D        STA $3D
00/AE91: A5 3E        LDA $3E
00/AE93: E9 00        SBC #$00
00/AE95: 85 3E        STA $3E
00/AE97: 20 24 AF     JSR $AF24
00/AE9A: A5 3D        LDA $3D
00/AE9C: 38           SEC 
00/AE9D: E9 20        SBC #$20
00/AE9F: 85 3D        STA $3D
00/AEA1: A5 3E        LDA $3E
00/AEA3: E9 00        SBC #$00
00/AEA5: 85 3E        STA $3E
00/AEA7: 20 24 AF     JSR $AF24
00/AEAA: 60           RTS 

; [ transfer yes/no window to vram ]

00/AEAB: A9 80        LDA #$80
00/AEAD: 8D 15 21     STA $2115
00/AEB0: 20 2A 8B     JSR $8B2A       ; init dma
00/AEB3: A9 01        LDA #$01
00/AEB5: 8D 00 43     STA $4300
00/AEB8: A2 10 00     LDX #$0010
00/AEBB: 8E 05 43     STX $4305
00/AEBE: A9 14        LDA #$14
00/AEC0: 8D 04 43     STA $4304
00/AEC3: A5 DC        LDA $DC
00/AEC5: 0A           ASL 
00/AEC6: 0A           ASL 
00/AEC7: 0A           ASL 
00/AEC8: 0A           ASL 
00/AEC9: 18           CLC 
00/AECA: 69 56        ADC #$56
00/AECC: 85 3D        STA $3D
00/AECE: A9 F6        LDA #$F6
00/AED0: 69 00        ADC #$00
00/AED2: 85 3E        STA $3E
00/AED4: A6 3D        LDX $3D
00/AED6: 8E 02 43     STX $4302
00/AED9: A5 DC        LDA $DC
00/AEDB: 0A           ASL 
00/AEDC: 0A           ASL 
00/AEDD: 0A           ASL 
00/AEDE: 0A           ASL 
00/AEDF: 0A           ASL 
00/AEE0: 18           CLC 
00/AEE1: 69 82        ADC #$82
00/AEE3: 85 3D        STA $3D
00/AEE5: A9 28        LDA #$28
00/AEE7: 69 00        ADC #$00
00/AEE9: 85 3E        STA $3E
00/AEEB: A6 3D        LDX $3D
00/AEED: 8E 16 21     STX $2116
00/AEF0: 20 36 8B     JSR $8B36       ; execute dma
00/AEF3: A5 3D        LDA $3D
00/AEF5: 18           CLC 
00/AEF6: 69 20        ADC #$20
00/AEF8: 85 3D        STA $3D
00/AEFA: A5 3E        LDA $3E
00/AEFC: 69 00        ADC #$00
00/AEFE: 85 3E        STA $3E
00/AF00: A6 3D        LDX $3D
00/AF02: 8E 16 21     STX $2116
00/AF05: 9C 0B 42     STZ $420B
00/AF08: A2 B6 F6     LDX #$F6B6
00/AF0B: 8E 02 43     STX $4302
00/AF0E: A2 10 00     LDX #$0010
00/AF11: 8E 05 43     STX $4305
00/AF14: 20 36 8B     JSR $8B36       ; execute dma
00/AF17: A5 3D        LDA $3D
00/AF19: 18           CLC 
00/AF1A: 69 20        ADC #$20
00/AF1C: 85 3D        STA $3D
00/AF1E: A5 3E        LDA $3E
00/AF20: 69 00        ADC #$00
00/AF22: 85 3E        STA $3E
; fallthrough

; [ close yes/no window (one row) ]

00/AF24: A9 80        LDA #$80
00/AF26: 8D 15 21     STA $2115
00/AF29: 20 2A 8B     JSR $8B2A       ; init dma
00/AF2C: A9 01        LDA #$01
00/AF2E: 8D 00 43     STA $4300
00/AF31: A6 3D        LDX $3D
00/AF33: 8E 16 21     STX $2116
00/AF36: A2 C6 F6     LDX #$F6C6
00/AF39: 8E 02 43     STX $4302
00/AF3C: A9 14        LDA #$14
00/AF3E: 8D 04 43     STA $4304
00/AF41: A2 10 00     LDX #$0010
00/AF44: 8E 05 43     STX $4305
00/AF47: 20 36 8B     JSR $8B36       ; execute dma
00/AF4A: 60           RTS 

; [ show item selection window ]

00/AF4B: A5 CC        LDA $CC
00/AF4D: D0 FC        BNE $AF4B       ; wait for player graphics update
00/AF4F: A9 01        LDA #$01
00/AF51: 85 DA        STA $DA
00/AF53: 85 EB        STA $EB
00/AF55: 64 BA        STZ $BA
00/AF57: 64 8B        STZ $8B
00/AF59: 64 8C        STZ $8C
00/AF5B: A9 70        LDA #$70
00/AF5D: 85 BB        STA $BB
00/AF5F: 20 D3 B2     JSR $B2D3       ; init item list
00/AF62: 20 2D 91     JSR $912D       ; wait for vblank
00/AF65: 20 29 B2     JSR $B229
00/AF68: 20 2D 91     JSR $912D       ; wait for vblank
00/AF6B: A5 7F        LDA $7F
00/AF6D: C9 02        CMP #$02
00/AF6F: D0 FA        BNE $AF6B       ; wait for 2nd irq
00/AF71: E6 DA        INC $DA
00/AF73: A5 DA        LDA $DA
00/AF75: C9 08        CMP #$08
00/AF77: D0 EF        BNE $AF68
00/AF79: 20 2D 91     JSR $912D       ; wait for vblank
00/AF7C: A9 01        LDA #$01
00/AF7E: 85 7D        STA $7D
00/AF80: A5 03        LDA $03
00/AF82: 29 80        AND #$80
00/AF84: F0 0B        BEQ $AF91
00/AF86: 20 73 B0     JSR $B073
00/AF89: A9 FF        LDA #$FF
00/AF8B: 8D FB 08     STA $08FB
00/AF8E: 4C 5B B0     JMP $B05B
00/AF91: A5 02        LDA $02
00/AF93: 29 80        AND #$80
00/AF95: F0 17        BEQ $AFAE
00/AF97: 20 73 B0     JSR $B073
00/AF9A: A5 BA        LDA $BA
00/AF9C: 18           CLC 
00/AF9D: 65 8C        ADC $8C
00/AF9F: 0A           ASL 
00/AFA0: 18           CLC 
00/AFA1: 65 8B        ADC $8B
00/AFA3: 0A           ASL 
00/AFA4: AA           TAX 
00/AFA5: BD 12 07     LDA $0712,X
00/AFA8: 8D FB 08     STA $08FB
00/AFAB: 4C 5B B0     JMP $B05B
00/AFAE: A5 03        LDA $03
00/AFB0: 29 01        AND #$01
00/AFB2: F0 1A        BEQ $AFCE
00/AFB4: 20 7D B0     JSR $B07D       ; move cursor
00/AFB7: E6 E7        INC $E7
00/AFB9: A5 8B        LDA $8B
00/AFBB: 1A           INC 
00/AFBC: 29 01        AND #$01
00/AFBE: 85 8B        STA $8B
00/AFC0: D0 B7        BNE $AF79
00/AFC2: A5 8C        LDA $8C
00/AFC4: C9 03        CMP #$03
00/AFC6: F0 43        BEQ $B00B
00/AFC8: 1A           INC 
00/AFC9: 85 8C        STA $8C
00/AFCB: 4C 79 AF     JMP $AF79
00/AFCE: A5 03        LDA $03
00/AFD0: 29 02        AND #$02
00/AFD2: F0 18        BEQ $AFEC
00/AFD4: 20 7D B0     JSR $B07D       ; move cursor
00/AFD7: E6 E7        INC $E7
00/AFD9: A5 8B        LDA $8B
00/AFDB: 3A           DEC 
00/AFDC: 29 01        AND #$01
00/AFDE: 85 8B        STA $8B
00/AFE0: F0 97        BEQ $AF79
00/AFE2: A5 8C        LDA $8C
00/AFE4: F0 5B        BEQ $B041
00/AFE6: 3A           DEC 
00/AFE7: 85 8C        STA $8C
00/AFE9: 4C 79 AF     JMP $AF79
00/AFEC: A5 8C        LDA $8C
00/AFEE: C9 03        CMP #$03
00/AFF0: D0 09        BNE $AFFB
00/AFF2: A5 03        LDA $03
00/AFF4: 29 04        AND #$04
00/AFF6: F0 2C        BEQ $B024
00/AFF8: 4C 0B B0     JMP $B00B
00/AFFB: A5 01        LDA $01
00/AFFD: 29 04        AND #$04
00/AFFF: F0 23        BEQ $B024
00/B001: E6 8C        INC $8C
00/B003: E6 E7        INC $E7
00/B005: 20 7D B0     JSR $B07D       ; move cursor
00/B008: 4C 79 AF     JMP $AF79
00/B00B: A5 BA        LDA $BA
00/B00D: C9 11        CMP #$11
00/B00F: D0 03        BNE $B014
00/B011: 4C 79 AF     JMP $AF79
00/B014: E6 E7        INC $E7
00/B016: E6 BA        INC $BA
00/B018: 20 73 B0     JSR $B073
00/B01B: 20 29 B2     JSR $B229
00/B01E: 20 9C B0     JSR $B09C
00/B021: 4C 7C AF     JMP $AF7C
00/B024: A5 8C        LDA $8C
00/B026: D0 09        BNE $B031
00/B028: A5 03        LDA $03
00/B02A: 29 08        AND #$08
00/B02C: F0 2A        BEQ $B058
00/B02E: 4C 41 B0     JMP $B041
00/B031: A5 01        LDA $01
00/B033: 29 08        AND #$08
00/B035: F0 21        BEQ $B058
00/B037: C6 8C        DEC $8C
00/B039: E6 E7        INC $E7
00/B03B: 20 7D B0     JSR $B07D       ; move cursor
00/B03E: 4C 79 AF     JMP $AF79
00/B041: A5 BA        LDA $BA
00/B043: D0 03        BNE $B048
00/B045: 4C 79 AF     JMP $AF79
00/B048: E6 E7        INC $E7
00/B04A: C6 BA        DEC $BA
00/B04C: 20 73 B0     JSR $B073
00/B04F: 20 29 B2     JSR $B229
00/B052: 20 8C B0     JSR $B08C
00/B055: 4C 7C AF     JMP $AF7C
00/B058: 4C 79 AF     JMP $AF79
00/B05B: 20 2D 91     JSR $912D       ; wait for vblank
00/B05E: A5 7F        LDA $7F
00/B060: C9 02        CMP #$02
00/B062: D0 FA        BNE $B05E       ; wait for 2nd irq
00/B064: C6 DA        DEC $DA
00/B066: A5 DA        LDA $DA
00/B068: C9 00        CMP #$00
00/B06A: D0 EF        BNE $B05B
00/B06C: A9 01        LDA #$01
00/B06E: 85 EC        STA $EC
00/B070: 64 DA        STZ $DA
00/B072: 60           RTS 

; [ play cursor sound effect ]

00/B073: A9 11        LDA #$11        ; system sound effect $11
00/B075: 8D 00 1E     STA $1E00
00/B078: 22 04 80 04  JSL $048004     ; execute sound command
00/B07C: 60           RTS 

; [ move cursor ]

00/B07D: 20 73 B0     JSR $B073
00/B080: A9 07        LDA #$07
00/B082: 85 89        STA $89
00/B084: 20 2D 91     JSR $912D       ; wait for vblank
00/B087: C6 89        DEC $89
00/B089: D0 F9        BNE $B084
00/B08B: 60           RTS 

; [ scroll item list up ]

00/B08C: A9 08        LDA #$08
00/B08E: 85 07        STA $07
00/B090: 20 2D 91     JSR $912D       ; wait for vblank
00/B093: C6 BB        DEC $BB
00/B095: C6 BB        DEC $BB
00/B097: C6 07        DEC $07
00/B099: D0 F5        BNE $B090
00/B09B: 60           RTS 

; [ scroll item list down ]

00/B09C: A9 08        LDA #$08
00/B09E: 85 07        STA $07
00/B0A0: 20 2D 91     JSR $912D       ; wait for vblank
00/B0A3: E6 BB        INC $BB
00/B0A5: E6 BB        INC $BB
00/B0A7: C6 07        DEC $07
00/B0A9: D0 F5        BNE $B0A0
00/B0AB: 60           RTS 

; [ init irq for item selection ]

00/B0AC: A2 8F 00     LDX #$008F
00/B0AF: 8E 09 42     STX $4209
00/B0B2: A9 A1        LDA #$A1
00/B0B4: 8D 00 42     STA $4200       ; enable nmi and irq
00/B0B7: 9C 11 21     STZ $2111
00/B0BA: 9C 11 21     STZ $2111
00/B0BD: A9 88        LDA #$88
00/B0BF: 8D 12 21     STA $2112
00/B0C2: 9C 12 21     STZ $2112
00/B0C5: 64 7F        STZ $7F
00/B0C7: AE F6 08     LDX $08F6
00/B0CA: E8           INX 
00/B0CB: 8E F6 08     STX $08F6
00/B0CE: 60           RTS 

; [ update item selection window (irq) ]

00/B0CF: A5 7F        LDA $7F
00/B0D1: D0 25        BNE $B0F8       ; branch if not 1st irq
; 1st irq
00/B0D3: A5 DA        LDA $DA         ; item selection window height
00/B0D5: 0A           ASL 
00/B0D6: 0A           ASL 
00/B0D7: 0A           ASL 
00/B0D8: 18           CLC 
00/B0D9: 69 90        ADC #$90
00/B0DB: 8D 09 42     STA $4209
00/B0DE: 9C 0A 42     STZ $420A
00/B0E1: A2 08 00     LDX #$0008
00/B0E4: CA           DEX 
00/B0E5: D0 FD        BNE $B0E4
00/B0E7: 9C 11 21     STZ $2111       ; scroll to right screen
00/B0EA: A9 01        LDA #$01
00/B0EC: 8D 11 21     STA $2111
00/B0EF: A5 BB        LDA $BB         ; dialogue window scroll position
00/B0F1: 8D 12 21     STA $2112
00/B0F4: 9C 12 21     STZ $2112
00/B0F7: 60           RTS 
; 2nd irq
00/B0F8: A2 08 00     LDX #$0008
00/B0FB: CA           DEX 
00/B0FC: D0 FD        BNE $B0FB
00/B0FE: 9C 11 21     STZ $2111       ; scroll to left screen
00/B101: 9C 11 21     STZ $2111
00/B104: A5 DA        LDA $DA         ; item selection window height
00/B106: 0A           ASL 
00/B107: 0A           ASL 
00/B108: 0A           ASL 
00/B109: 49 FF        EOR #$FF
00/B10B: 18           CLC 
00/B10C: 69 89        ADC #$89
00/B10E: 8D 12 21     STA $2112
00/B111: 9C 12 21     STZ $2112
00/B114: A9 81        LDA #$81
00/B116: 8D 00 42     STA $4200       ; enable nmi
00/B119: 60           RTS 

; [ draw item select cursor ]

00/B11A: A5 DA        LDA $DA         ; item select window height
00/B11C: C9 08        CMP #$08
00/B11E: F0 01        BEQ $B121       ; return if not fully open
00/B120: 60           RTS 
00/B121: A9 80        LDA #$80
00/B123: 8D 15 21     STA $2115
00/B126: A5 E7        LDA $E7
00/B128: F0 11        BEQ $B13B
00/B12A: A6 8D        LDX $8D
00/B12C: 8E 16 21     STX $2116
00/B12F: 64 E7        STZ $E7
00/B131: A9 FF        LDA #$FF        ; hide previous cursor
00/B133: 8D 18 21     STA $2118
00/B136: A9 20        LDA #$20
00/B138: 8D 19 21     STA $2119
00/B13B: A5 BA        LDA $BA         ; scroll position
00/B13D: 18           CLC 
00/B13E: 65 8C        ADC $8C
00/B140: 85 4B        STA $4B         ; calculate vram address
00/B142: 64 4A        STZ $4A
00/B144: 46 4B        LSR $4B
00/B146: 66 4A        ROR $4A
00/B148: 46 4B        LSR $4B
00/B14A: 66 4A        ROR $4A
00/B14C: A5 8B        LDA $8B
00/B14E: F0 02        BEQ $B152
00/B150: A9 0D        LDA #$0D        ; shift right by 13 for right column
00/B152: 18           CLC 
00/B153: 69 23        ADC #$23        ; shift down one row and right 3 tiles
00/B155: 65 4A        ADC $4A
00/B157: 85 4A        STA $4A
00/B159: A5 4B        LDA $4B
00/B15B: 29 03        AND #$03
00/B15D: 18           CLC 
00/B15E: 69 2C        ADC #$2C
00/B160: 85 4B        STA $4B
00/B162: A6 4A        LDX $4A
00/B164: 86 8D        STX $8D         ; save vram address
00/B166: 8E 16 21     STX $2116
00/B169: A9 14        LDA #$14        ; draw cursor tile in vram
00/B16B: 8D 18 21     STA $2118
00/B16E: A9 20        LDA #$20
00/B170: 8D 19 21     STA $2119
00/B173: 60           RTS 

; [ transfer item selection window to vram ]

00/B174: A5 E6        LDA $E6
00/B176: D0 04        BNE $B17C
00/B178: 20 1A B1     JSR $B11A       ; draw item select cursor
00/B17B: 60           RTS 
00/B17C: 64 E6        STZ $E6
00/B17E: A5 BA        LDA $BA
00/B180: 29 0F        AND #$0F
00/B182: 85 13        STA $13
00/B184: 64 12        STZ $12
00/B186: 46 13        LSR $13
00/B188: 66 12        ROR $12
00/B18A: 46 13        LSR $13
00/B18C: 66 12        ROR $12
00/B18E: A5 12        LDA $12
00/B190: 18           CLC 
00/B191: 69 04        ADC #$04
00/B193: 85 12        STA $12
00/B195: A5 13        LDA $13
00/B197: 29 03        AND #$03
00/B199: 18           CLC 
00/B19A: 69 2C        ADC #$2C
00/B19C: 85 13        STA $13
00/B19E: A2 74 07     LDX #$0774
00/B1A1: 86 14        STX $14
00/B1A3: A2 34 08     LDX #$0834
00/B1A6: 86 16        STX $16
00/B1A8: 9C 15 21     STZ $2115
00/B1AB: 20 2A 8B     JSR $8B2A       ; init dma
00/B1AE: 9C 00 43     STZ $4300
00/B1B1: A9 04        LDA #$04
00/B1B3: 85 11        STA $11
00/B1B5: A6 16        LDX $16
00/B1B7: 8E 02 43     STX $4302
00/B1BA: A6 12        LDX $12
00/B1BC: 8E 16 21     STX $2116
00/B1BF: A2 18 00     LDX #$0018
00/B1C2: 8E 05 43     STX $4305
00/B1C5: 20 36 8B     JSR $8B36       ; execute dma
00/B1C8: A5 12        LDA $12
00/B1CA: 18           CLC 
00/B1CB: 69 20        ADC #$20
00/B1CD: 85 12        STA $12
00/B1CF: A5 13        LDA $13
00/B1D1: 69 00        ADC #$00
00/B1D3: 85 13        STA $13
00/B1D5: 9C 0B 42     STZ $420B
00/B1D8: A6 14        LDX $14
00/B1DA: 8E 02 43     STX $4302
00/B1DD: A6 12        LDX $12
00/B1DF: 8E 16 21     STX $2116
00/B1E2: A2 18 00     LDX #$0018
00/B1E5: 8E 05 43     STX $4305
00/B1E8: 20 36 8B     JSR $8B36       ; execute dma
00/B1EB: A5 12        LDA $12
00/B1ED: 18           CLC 
00/B1EE: 69 20        ADC #$20
00/B1F0: 85 12        STA $12
00/B1F2: A5 13        LDA $13
00/B1F4: 69 00        ADC #$00
00/B1F6: 85 13        STA $13
00/B1F8: 38           SEC 
00/B1F9: E9 30        SBC #$30
00/B1FB: 90 07        BCC $B204
00/B1FD: 29 03        AND #$03
00/B1FF: 18           CLC 
00/B200: 69 2C        ADC #$2C
00/B202: 85 13        STA $13
00/B204: A5 14        LDA $14
00/B206: 18           CLC 
00/B207: 69 18        ADC #$18
00/B209: 85 14        STA $14
00/B20B: A5 15        LDA $15
00/B20D: 69 00        ADC #$00
00/B20F: 85 15        STA $15
00/B211: A5 16        LDA $16
00/B213: 18           CLC 
00/B214: 69 18        ADC #$18
00/B216: 85 16        STA $16
00/B218: A5 17        LDA $17
00/B21A: 69 00        ADC #$00
00/B21C: 85 17        STA $17
00/B21E: C6 11        DEC $11
00/B220: F0 03        BEQ $B225
00/B222: 4C B5 B1     JMP $B1B5
00/B225: 20 1A B1     JSR $B11A       ; draw item select cursor
00/B228: 60           RTS 

; [ update item selection window text ]

00/B229: A2 00 00     LDX #$0000
00/B22C: A9 FF        LDA #$FF
00/B22E: 9D 74 07     STA $0774,X
00/B231: E8           INX 
00/B232: E0 80 01     CPX #$0180
00/B235: D0 F7        BNE $B22E
00/B237: A5 BA        LDA $BA
00/B239: 0A           ASL 
00/B23A: 0A           ASL 
00/B23B: AA           TAX 
00/B23C: 86 3D        STX $3D
00/B23E: A0 00 00     LDY #$0000
00/B241: 84 40        STY $40
00/B243: A9 08        LDA #$08
00/B245: 85 07        STA $07
00/B247: A6 3D        LDX $3D
00/B249: BD 12 07     LDA $0712,X
00/B24C: D0 03        BNE $B251
00/B24E: 4C CE B2     JMP $B2CE
00/B251: 64 19        STZ $19
00/B253: 0A           ASL 
00/B254: 26 19        ROL $19
00/B256: 0A           ASL 
00/B257: 26 19        ROL $19
00/B259: 0A           ASL 
00/B25A: 26 19        ROL $19
00/B25C: 18           CLC 
00/B25D: 7D 12 07     ADC $0712,X
00/B260: 85 18        STA $18
00/B262: A5 19        LDA $19
00/B264: 69 00        ADC #$00
00/B266: 85 19        STA $19
00/B268: A6 18        LDX $18
00/B26A: E8           INX 
00/B26B: A4 40        LDY $40
00/B26D: A9 08        LDA #$08
00/B26F: 85 08        STA $08
00/B271: BF 00 80 0F  LDA $0F8000,X
00/B275: 20 6E B6     JSR $B66E       ; get dakuten
00/B278: 99 74 07     STA $0774,Y
00/B27B: EB           XBA 
00/B27C: 99 34 08     STA $0834,Y
00/B27F: A9 00        LDA #$00
00/B281: EB           XBA 
00/B282: C8           INY 
00/B283: E8           INX 
00/B284: C6 08        DEC $08
00/B286: D0 E9        BNE $B271
00/B288: A4 40        LDY $40
00/B28A: A9 C8        LDA #$C8
00/B28C: 99 7C 07     STA $077C,Y
00/B28F: A6 3D        LDX $3D
00/B291: BD 13 07     LDA $0713,X
00/B294: 85 30        STA $30
00/B296: 64 31        STZ $31
00/B298: 64 32        STZ $32
00/B29A: 22 24 C3 15  JSL $15C324     ; convert hex to decimal
00/B29E: A4 40        LDY $40
00/B2A0: A5 3A        LDA $3A
00/B2A2: 99 7D 07     STA $077D,Y
00/B2A5: A5 3B        LDA $3B
00/B2A7: 99 7E 07     STA $077E,Y
00/B2AA: A5 07        LDA $07
00/B2AC: 29 01        AND #$01
00/B2AE: D0 0A        BNE $B2BA
00/B2B0: A5 40        LDA $40
00/B2B2: 18           CLC 
00/B2B3: 69 0D        ADC #$0D
00/B2B5: 85 40        STA $40
00/B2B7: 4C C1 B2     JMP $B2C1
00/B2BA: A5 40        LDA $40
00/B2BC: 18           CLC 
00/B2BD: 69 0B        ADC #$0B
00/B2BF: 85 40        STA $40
00/B2C1: A6 3D        LDX $3D
00/B2C3: E8           INX 
00/B2C4: E8           INX 
00/B2C5: 86 3D        STX $3D
00/B2C7: C6 07        DEC $07
00/B2C9: F0 03        BEQ $B2CE
00/B2CB: 4C 47 B2     JMP $B247
00/B2CE: A9 01        LDA #$01
00/B2D0: 85 E6        STA $E6
00/B2D2: 60           RTS 

; [ init item list ]

00/B2D3: A2 00 00     LDX #$0000
00/B2D6: 9E 12 07     STZ $0712,X     ; clear item list
00/B2D9: E8           INX 
00/B2DA: E0 60 00     CPX #$0060
00/B2DD: D0 F7        BNE $B2D6
00/B2DF: A2 00 00     LDX #$0000
00/B2E2: A0 00 00     LDY #$0000
00/B2E5: BD 40 14     LDA $1440,X     ; inventory
00/B2E8: C9 CE        CMP #$CE
00/B2EA: 90 17        BCC $B303
00/B2EC: C9 E7        CMP #$E7
00/B2EE: 90 08        BCC $B2F8
00/B2F0: C9 EB        CMP #$EB
00/B2F2: 90 0F        BCC $B303
00/B2F4: C9 FE        CMP #$FE
00/B2F6: B0 0B        BCS $B303
00/B2F8: 99 12 07     STA $0712,Y
00/B2FB: BD 41 14     LDA $1441,X
00/B2FE: 99 13 07     STA $0713,Y
00/B301: C8           INY 
00/B302: C8           INY 
00/B303: E8           INX 
00/B304: E8           INX 
00/B305: E0 60 00     CPX #$0060
00/B308: D0 DB        BNE $B2E5
00/B30A: 60           RTS 

; [ open dialogue window ]

00/B30B: A5 CC        LDA $CC
00/B30D: D0 FC        BNE $B30B
00/B30F: A9 01        LDA #$01        ; close map name window
00/B311: 85 EA        STA $EA
00/B313: 20 2D 91     JSR $912D       ; wait for vblank
00/B316: A5 EA        LDA $EA
00/B318: C9 02        CMP #$02
00/B31A: D0 F7        BNE $B313
00/B31C: A2 00 00     LDX #$0000
00/B31F: 8E F4 08     STX $08F4
00/B322: 64 DE        STZ $DE
00/B324: A9 EC        LDA #$EC
00/B326: 85 BB        STA $BB
00/B328: 64 BA        STZ $BA
00/B32A: 20 59 B4     JSR $B459       ; decode dialogue text
00/B32D: A9 01        LDA #$01
00/B32F: 85 DF        STA $DF
00/B331: 85 EB        STA $EB
00/B333: 20 2D 91     JSR $912D       ; wait for vblank
00/B336: A5 7F        LDA $7F
00/B338: C9 02        CMP #$02
00/B33A: D0 FA        BNE $B336       ; wait for 2nd irq
00/B33C: E6 DF        INC $DF
00/B33E: A5 DF        LDA $DF
00/B340: C9 08        CMP #$08
00/B342: D0 EF        BNE $B333
00/B344: AE F4 08     LDX $08F4
00/B347: F0 0E        BEQ $B357
00/B349: EC F6 08     CPX $08F6
00/B34C: D0 FB        BNE $B349
00/B34E: A2 00 00     LDX #$0000
00/B351: 8E F4 08     STX $08F4
00/B354: 4C 67 B3     JMP $B367
00/B357: A5 DE        LDA $DE
00/B359: C9 02        CMP #$02
00/B35B: F0 40        BEQ $B39D
00/B35D: A5 CB        LDA $CB
00/B35F: D0 06        BNE $B367
00/B361: 20 FC 8D     JSR $8DFC       ; wait for key up
00/B364: 20 05 8E     JSR $8E05       ; wait for keypress
00/B367: A5 DE        LDA $DE
00/B369: D0 32        BNE $B39D
00/B36B: 20 59 B4     JSR $B459       ; decode dialogue text
00/B36E: A9 10        LDA #$10
00/B370: 85 07        STA $07
00/B372: 20 2D 91     JSR $912D       ; wait for vblank
00/B375: A5 CB        LDA $CB
00/B377: D0 0D        BNE $B386
00/B379: E6 BB        INC $BB
00/B37B: E6 BB        INC $BB
00/B37D: E6 BB        INC $BB
00/B37F: E6 BB        INC $BB
00/B381: C6 07        DEC $07
00/B383: 4C 96 B3     JMP $B396
00/B386: A5 7A        LDA $7A
00/B388: 29 07        AND #$07
00/B38A: D0 0A        BNE $B396
00/B38C: E6 BB        INC $BB
00/B38E: A5 7A        LDA $7A
00/B390: 29 1F        AND #$1F
00/B392: D0 02        BNE $B396
00/B394: C6 07        DEC $07
00/B396: A5 07        LDA $07
00/B398: D0 D8        BNE $B372
00/B39A: 4C 44 B3     JMP $B344
00/B39D: 60           RTS 

; [ close dialogue window ]

00/B39E: 20 2D 91     JSR $912D       ; wait for vblank
00/B3A1: A5 7F        LDA $7F
00/B3A3: C9 02        CMP #$02
00/B3A5: D0 FA        BNE $B3A1       ; wait for 2nd irq
00/B3A7: C6 DF        DEC $DF         ; decrement dialogue window height
00/B3A9: A5 DF        LDA $DF
00/B3AB: C9 00        CMP #$00
00/B3AD: D0 EF        BNE $B39E
00/B3AF: A9 01        LDA #$01        ; hide dialogue window
00/B3B1: 85 EC        STA $EC
00/B3B3: 20 2D 91     JSR $912D       ; wait for vblank
00/B3B6: 64 DF        STZ $DF
00/B3B8: 60           RTS 

; [ get pointer to map dialogue (bank 0) ]

00/B3B9: AD 02 17     LDA $1702
00/B3BC: 64 3E        STZ $3E
00/B3BE: 0A           ASL 
00/B3BF: 26 3E        ROL $3E
00/B3C1: 85 3D        STA $3D
00/B3C3: AD 01 17     LDA $1701
00/B3C6: F0 04        BEQ $B3CC
00/B3C8: E6 3E        INC $3E
00/B3CA: E6 3E        INC $3E
00/B3CC: A6 3D        LDX $3D
00/B3CE: BF 00 80 11  LDA $118000,X
00/B3D2: 85 3D        STA $3D
00/B3D4: BF 01 80 11  LDA $118001,X
00/B3D8: 85 3E        STA $3E
00/B3DA: A6 3D        LDX $3D
00/B3DC: A5 B2        LDA $B2
00/B3DE: F0 1C        BEQ $B3FC
00/B3E0: A8           TAY 
00/B3E1: E8           INX 
00/B3E2: BF 00 83 11  LDA $118300,X   ; find null-terminator
00/B3E6: D0 F9        BNE $B3E1
00/B3E8: BF FF 82 11  LDA $1182FF,X
00/B3EC: C9 03        CMP #$03
00/B3EE: F0 F1        BEQ $B3E1
00/B3F0: BF FF 82 11  LDA $1182FF,X
00/B3F4: C9 04        CMP #$04
00/B3F6: F0 E9        BEQ $B3E1
00/B3F8: 88           DEY 
00/B3F9: D0 E6        BNE $B3E1
00/B3FB: E8           INX 
00/B3FC: 8E 72 07     STX $0772
00/B3FF: 64 DD        STZ $DD
00/B401: 60           RTS 

; [ get pointer to event dialogue (bank 1 low) ]

00/B402: 20 4D B4     JSR $B44D
00/B405: BF 00 80 10  LDA $108000,X   ; pointers to event dialogue
00/B409: 85 3D        STA $3D
00/B40B: BF 01 80 10  LDA $108001,X
00/B40F: 85 3E        STA $3E
00/B411: A6 3D        LDX $3D
00/B413: 8E 72 07     STX $0772
00/B416: A9 01        LDA #$01
00/B418: 85 DD        STA $DD
00/B41A: 60           RTS 

; [ get pointer to event dialogue (bank 1 high) ]

00/B41B: 20 4D B4     JSR $B44D
00/B41E: BF 00 82 10  LDA $108200,X
00/B422: 85 3D        STA $3D
00/B424: BF 01 82 10  LDA $108201,X
00/B428: 85 3E        STA $3E
00/B42A: A6 3D        LDX $3D
00/B42C: 8E 72 07     STX $0772
00/B42F: A9 01        LDA #$01
00/B431: 85 DD        STA $DD
00/B433: 60           RTS 

; [ get pointer to event dialogue (bank 2) ]

00/B434: 20 4D B4     JSR $B44D
00/B437: BF 00 A5 13  LDA $13A500,X
00/B43B: 85 3D        STA $3D
00/B43D: BF 01 A5 13  LDA $13A501,X
00/B441: 85 3E        STA $3E
00/B443: A6 3D        LDX $3D
00/B445: 8E 72 07     STX $0772
00/B448: A9 02        LDA #$02
00/B44A: 85 DD        STA $DD
00/B44C: 60           RTS 

; [ get dialogue id ]

00/B44D: A5 B2        LDA $B2
00/B44F: 64 3E        STZ $3E
00/B451: 0A           ASL 
00/B452: 26 3E        ROL $3E
00/B454: 85 3D        STA $3D
00/B456: A6 3D        LDX $3D
00/B458: 60           RTS 

; [ decode dialogue text (one line) ]

00/B459: A0 00 00     LDY #$0000
00/B45C: 84 3D        STY $3D
00/B45E: 20 E1 B4     JSR $B4E1       ; get dialogue byte
00/B461: C9 00        CMP #$00
00/B463: D0 03        BNE $B468
00/B465: 4C 44 B6     JMP $B644
00/B468: C9 01        CMP #$01
00/B46A: D0 03        BNE $B46F
00/B46C: 4C 22 B6     JMP $B622
00/B46F: C9 02        CMP #$02
00/B471: D0 03        BNE $B476
00/B473: 4C 04 B6     JMP $B604
00/B476: C9 03        CMP #$03
00/B478: D0 03        BNE $B47D
00/B47A: 4C 1C B5     JMP $B51C
00/B47D: C9 04        CMP #$04
00/B47F: D0 03        BNE $B484
00/B481: 4C 2E B5     JMP $B52E
00/B484: C9 05        CMP #$05
00/B486: D0 03        BNE $B48B
00/B488: 4C E6 B5     JMP $B5E6
00/B48B: C9 06        CMP #$06
00/B48D: D0 03        BNE $B492
00/B48F: 4C 59 B6     JMP $B659
00/B492: C9 07        CMP #$07
00/B494: D0 03        BNE $B499
00/B496: 4C 68 B5     JMP $B568
00/B499: C9 08        CMP #$08
00/B49B: D0 03        BNE $B4A0
00/B49D: 4C AB B5     JMP $B5AB
00/B4A0: C9 C3        CMP #$C3
00/B4A2: D0 03        BNE $B4A7
00/B4A4: 4C FF B4     JMP $B4FF
; text character
00/B4A7: 20 6E B6     JSR $B66E       ; get dakuten
00/B4AA: 99 74 07     STA $0774,Y
00/B4AD: EB           XBA 
00/B4AE: 99 34 08     STA $0834,Y
00/B4B1: A9 00        LDA #$00
00/B4B3: EB           XBA 
00/B4B4: A4 3D        LDY $3D
00/B4B6: C8           INY 
00/B4B7: 84 3D        STY $3D
00/B4B9: AE 72 07     LDX $0772       ; increment dialogue pointer
00/B4BC: E8           INX 
00/B4BD: 8E 72 07     STX $0772
00/B4C0: A4 3D        LDY $3D
00/B4C2: C0 60 00     CPY #$0060
00/B4C5: F0 03        BEQ $B4CA
00/B4C7: 4C 5E B4     JMP $B45E
00/B4CA: 20 E1 B4     JSR $B4E1       ; get dialogue byte
00/B4CD: C9 00        CMP #$00
00/B4CF: D0 04        BNE $B4D5
00/B4D1: A9 01        LDA #$01        ; close after keypress
00/B4D3: 85 DE        STA $DE
00/B4D5: A9 01        LDA #$01        ; need dialogue text tilemap update in vram
00/B4D7: 85 ED        STA $ED
00/B4D9: 60           RTS 

; [ get next dialogue byte ]

00/B4DA: AE 72 07     LDX $0772       ; increment dialogue pointer
00/B4DD: E8           INX 
00/B4DE: 8E 72 07     STX $0772
; get dialogue byte
00/B4E1: AE 72 07     LDX $0772
00/B4E4: A5 DD        LDA $DD
00/B4E6: D0 07        BNE $B4EF
00/B4E8: BF 00 83 11  LDA $118300,X   ; map dialogue (bank 0)
00/B4EC: 4C FE B4     JMP $B4FE
00/B4EF: C9 01        CMP #$01
00/B4F1: D0 07        BNE $B4FA
00/B4F3: BF 00 84 10  LDA $108400,X   ; event dialogue (bank 1)
00/B4F7: 4C FE B4     JMP $B4FE
00/B4FA: BF 00 A7 13  LDA $13A700,X   ; event dialogue (bank 2)
00/B4FE: 60           RTS 

; $C3: ellipsis
00/B4FF: EB           XBA 
00/B500: A9 FF        LDA #$FF
00/B502: EB           XBA 
00/B503: 99 74 07     STA $0774,Y     ; repeat twice
00/B506: 99 75 07     STA $0775,Y
00/B509: EB           XBA 
00/B50A: 99 34 08     STA $0834,Y
00/B50D: 99 35 08     STA $0835,Y
00/B510: A9 00        LDA #$00
00/B512: EB           XBA 
00/B513: A4 3D        LDY $3D
00/B515: C8           INY 
00/B516: C8           INY 
00/B517: 84 3D        STY $3D
00/B519: 4C B9 B4     JMP $B4B9
; 3: play song
00/B51C: 20 DA B4     JSR $B4DA       ; get next dialogue byte
00/B51F: 8D 01 1E     STA $1E01
00/B522: A9 01        LDA #$01
00/B524: 8D 00 1E     STA $1E00
00/B527: 22 04 80 04  JSL $048004     ; execute sound command
00/B52B: 4C B9 B4     JMP $B4B9
; 4: character name
00/B52E: 20 DA B4     JSR $B4DA       ; get next dialogue byte
00/B531: 0A           ASL 
00/B532: 85 18        STA $18
00/B534: 0A           ASL 
00/B535: 18           CLC 
00/B536: 65 18        ADC $18
00/B538: 85 18        STA $18
00/B53A: 64 19        STZ $19
00/B53C: A6 18        LDX $18
00/B53E: A4 3D        LDY $3D
00/B540: 64 07        STZ $07
00/B542: BD 00 15     LDA $1500,X
00/B545: C9 FF        CMP #$FF
00/B547: F0 1A        BEQ $B563
00/B549: 20 6E B6     JSR $B66E       ; get dakuten
00/B54C: 99 74 07     STA $0774,Y
00/B54F: EB           XBA 
00/B550: 99 34 08     STA $0834,Y
00/B553: A9 00        LDA #$00
00/B555: EB           XBA 
00/B556: C8           INY 
00/B557: E8           INX 
00/B558: E6 07        INC $07
00/B55A: A5 07        LDA $07
00/B55C: C9 06        CMP #$06
00/B55E: F0 03        BEQ $B563
00/B560: 4C 42 B5     JMP $B542
00/B563: 84 3D        STY $3D
00/B565: 4C B9 B4     JMP $B4B9
; 7: item name
00/B568: AD FB 08     LDA $08FB
00/B56B: 64 19        STZ $19
00/B56D: 0A           ASL 
00/B56E: 26 19        ROL $19
00/B570: 0A           ASL 
00/B571: 26 19        ROL $19
00/B573: 0A           ASL 
00/B574: 26 19        ROL $19
00/B576: 18           CLC 
00/B577: 6D FB 08     ADC $08FB
00/B57A: 85 18        STA $18
00/B57C: A5 19        LDA $19
00/B57E: 69 00        ADC #$00
00/B580: 85 19        STA $19
00/B582: A6 18        LDX $18
00/B584: E8           INX 
00/B585: A4 3D        LDY $3D
00/B587: A9 08        LDA #$08
00/B589: 85 07        STA $07
00/B58B: BF 00 80 0F  LDA $0F8000,X
00/B58F: C9 FF        CMP #$FF
00/B591: F0 15        BEQ $B5A8
00/B593: 20 6E B6     JSR $B66E       ; get dakuten
00/B596: 99 74 07     STA $0774,Y
00/B599: EB           XBA 
00/B59A: 99 34 08     STA $0834,Y
00/B59D: A9 00        LDA #$00
00/B59F: EB           XBA 
00/B5A0: C8           INY 
00/B5A1: 84 3D        STY $3D
00/B5A3: E8           INX 
00/B5A4: C6 07        DEC $07
00/B5A6: D0 E3        BNE $B58B
00/B5A8: 4C B9 B4     JMP $B4B9
; 8: gil
00/B5AB: AD F8 08     LDA $08F8
00/B5AE: 85 30        STA $30
00/B5B0: AD F9 08     LDA $08F9
00/B5B3: 85 31        STA $31
00/B5B5: AD FA 08     LDA $08FA
00/B5B8: 85 32        STA $32
00/B5BA: 22 24 C3 15  JSL $15C324     ; convert hex to decimal
00/B5BE: A2 00 00     LDX #$0000
00/B5C1: B5 36        LDA $36,X
00/B5C3: C9 80        CMP #$80
00/B5C5: D0 09        BNE $B5D0
00/B5C7: E8           INX 
00/B5C8: E0 05 00     CPX #$0005
00/B5CB: F0 03        BEQ $B5D0
00/B5CD: 4C C1 B5     JMP $B5C1
00/B5D0: B5 36        LDA $36,X
00/B5D2: 99 74 07     STA $0774,Y
00/B5D5: A9 FF        LDA #$FF
00/B5D7: 99 34 08     STA $0834,Y
00/B5DA: C8           INY 
00/B5DB: E8           INX 
00/B5DC: E0 06 00     CPX #$0006
00/B5DF: D0 EF        BNE $B5D0
00/B5E1: 84 3D        STY $3D
00/B5E3: 4C B9 B4     JMP $B4B9
; 5: wait
00/B5E6: 20 DA B4     JSR $B4DA       ; get next dialogue byte
00/B5E9: 64 19        STZ $19
00/B5EB: 0A           ASL 
00/B5EC: 26 19        ROL $19
00/B5EE: 0A           ASL 
00/B5EF: 26 19        ROL $19
00/B5F1: 0A           ASL 
00/B5F2: 26 19        ROL $19
00/B5F4: 85 18        STA $18
00/B5F6: A6 18        LDX $18
00/B5F8: 8E F4 08     STX $08F4
00/B5FB: A2 00 00     LDX #$0000
00/B5FE: 8E F6 08     STX $08F6
00/B601: 4C B9 B4     JMP $B4B9
; 2: tab
00/B604: 20 DA B4     JSR $B4DA       ; get next dialogue byte
00/B607: 85 07        STA $07
00/B609: A4 3D        LDY $3D
00/B60B: A9 FF        LDA #$FF
00/B60D: 99 74 07     STA $0774,Y
00/B610: 99 34 08     STA $0834,Y
00/B613: C8           INY 
00/B614: C0 60 00     CPY #$0060
00/B617: F0 04        BEQ $B61D
00/B619: C6 07        DEC $07
00/B61B: D0 F0        BNE $B60D
00/B61D: 84 3D        STY $3D
00/B61F: 4C B9 B4     JMP $B4B9
; 1: newline
00/B622: A9 FF        LDA #$FF
00/B624: 99 74 07     STA $0774,Y
00/B627: 99 34 08     STA $0834,Y
00/B62A: C8           INY 
00/B62B: C0 18 00     CPY #$0018
00/B62E: F0 0F        BEQ $B63F
00/B630: C0 30 00     CPY #$0030
00/B633: F0 0A        BEQ $B63F
00/B635: C0 48 00     CPY #$0048
00/B638: F0 05        BEQ $B63F
00/B63A: C0 60 00     CPY #$0060
00/B63D: D0 E5        BNE $B624
00/B63F: 84 3D        STY $3D
00/B641: 4C B9 B4     JMP $B4B9
; 0: end of text
00/B644: A9 FF        LDA #$FF
00/B646: 99 74 07     STA $0774,Y
00/B649: 99 34 08     STA $0834,Y
00/B64C: C8           INY 
00/B64D: C0 C0 00     CPY #$00C0
00/B650: D0 F4        BNE $B646
00/B652: A9 01        LDA #$01        ; wait for keypress
00/B654: 85 DE        STA $DE
00/B656: 4C CA B4     JMP $B4CA
; 6: end of text (don't wait for keypress)
00/B659: A9 FF        LDA #$FF
00/B65B: 99 74 07     STA $0774,Y
00/B65E: 99 34 08     STA $0834,Y
00/B661: C8           INY 
00/B662: C0 C0 00     CPY #$00C0
00/B665: D0 F4        BNE $B65B
00/B667: A9 02        LDA #$02        ; don't wait for keypress
00/B669: 85 DE        STA $DE
00/B66B: 4C CA B4     JMP $B4CA

; [ get dakuten ]

00/B66E: C9 42        CMP #$42
00/B670: B0 14        BCS $B686
00/B672: DA           PHX 
00/B673: 38           SEC 
00/B674: E9 0F        SBC #$0F
00/B676: 0A           ASL 
00/B677: AA           TAX 
00/B678: BF 8B B6 00  LDA $00B68B,X   ; kana
00/B67C: EB           XBA 
00/B67D: BF 8C B6 00  LDA $00B68C,X   ; dakuten
00/B681: EB           XBA 
00/B682: FA           PLX 
00/B683: 4C 8A B6     JMP $B68A
00/B686: EB           XBA 
00/B687: A9 FF        LDA #$FF
00/B689: EB           XBA 
00/B68A: 60           RTS 

; dakuten table (field)
; 2 bytes each, kana then dakuten
00/B68B:                                           CC C0
00/B68D: 8F C0 90 C0 91 C0 92 C0 93 C0 94 C0 95 C0 96 C0  ; $10
00/B69D: 97 C0 98 C0 99 C0 9A C0 9B C0 9C C0 9D C0 A3 C0
00/B6AD: A4 C0 A5 C0 A6 C0 A7 C0 A3 C1 A4 C1 A5 C1 A6 C1  ; $20
00/B6BD: A7 C1 CF C0 D0 C0 D1 C0 D2 C0 D3 C0 D4 C0 D5 C0
00/B6CD: D6 C0 D7 C0 D8 C0 D9 C0 DA C0 DB C0 DC C0 DD C0  ; $30
00/B6DD: E3 C0 E4 C0 E5 C0 E6 C0 E7 C0 E3 C1 E4 C1 E5 C1
00/B6ED: E6 C1 E7 C1                                      ; $40

; [ init irq for dialogue window ]

00/B6F1: A2 13 00     LDX #$0013
00/B6F4: 8E 09 42     STX $4209
00/B6F7: A9 A1        LDA #$A1
00/B6F9: 8D 00 42     STA $4200       ; enable nmi and irq
00/B6FC: 9C 11 21     STZ $2111
00/B6FF: 9C 11 21     STZ $2111
00/B702: A9 03        LDA #$03
00/B704: 8D 12 21     STA $2112
00/B707: 9C 12 21     STZ $2112
00/B70A: 64 7F        STZ $7F
00/B70C: AE F6 08     LDX $08F6
00/B70F: E8           INX 
00/B710: 8E F6 08     STX $08F6
00/B713: 60           RTS 

; [ update dialogue window (irq) ]

00/B714: A5 7F        LDA $7F
00/B716: D0 25        BNE $B73D
; 1st irq
00/B718: A5 DF        LDA $DF         ; dialogue window height
00/B71A: 0A           ASL 
00/B71B: 0A           ASL 
00/B71C: 0A           ASL 
00/B71D: 18           CLC 
00/B71E: 69 14        ADC #$14
00/B720: 8D 09 42     STA $4209       ; set irq scanline
00/B723: 9C 0A 42     STZ $420A
00/B726: A2 08 00     LDX #$0008
00/B729: CA           DEX 
00/B72A: D0 FD        BNE $B729
00/B72C: 9C 11 21     STZ $2111       ; scroll to right screen
00/B72F: A9 01        LDA #$01
00/B731: 8D 11 21     STA $2111
00/B734: A5 BB        LDA $BB         ; dialogue window scroll position
00/B736: 8D 12 21     STA $2112       ; bg3 v-scroll
00/B739: 9C 12 21     STZ $2112
00/B73C: 60           RTS 
; 2nd irq
00/B73D: A2 08 00     LDX #$0008      ; wait a few cycles
00/B740: CA           DEX 
00/B741: D0 FD        BNE $B740
00/B743: 9C 11 21     STZ $2111       ; scroll to left screen
00/B746: 9C 11 21     STZ $2111
00/B749: A5 DF        LDA $DF         ; dialogue window height
00/B74B: 0A           ASL 
00/B74C: 0A           ASL 
00/B74D: 0A           ASL 
00/B74E: 49 FF        EOR #$FF
00/B750: 18           CLC 
00/B751: 69 05        ADC #$05
00/B753: 8D 12 21     STA $2112       ; bg3 v-scroll
00/B756: 9C 12 21     STZ $2112
00/B759: A9 81        LDA #$81
00/B75B: 8D 00 42     STA $4200       ; enable nmi (disable irq)
00/B75E: 60           RTS 

; [ transfer dialogue window to vram ]

00/B75F: A5 CB        LDA $CB
00/B761: F0 01        BEQ $B764
00/B763: 60           RTS 
00/B764: A5 EB        LDA $EB
00/B766: D0 01        BNE $B769
00/B768: 60           RTS 
00/B769: 64 EB        STZ $EB
00/B76B: A9 80        LDA #$80
00/B76D: 8D 15 21     STA $2115
00/B770: 20 2A 8B     JSR $8B2A       ; init dma
00/B773: A9 01        LDA #$01
00/B775: 8D 00 43     STA $4300
00/B778: A2 40 28     LDX #$2840
00/B77B: 8E 16 21     STX $2116
00/B77E: A2 D6 F6     LDX #$F6D6      ; dialogue window tile data
00/B781: 8E 02 43     STX $4302
00/B784: A9 14        LDA #$14
00/B786: 8D 04 43     STA $4304
00/B789: A2 40 00     LDX #$0040
00/B78C: 8E 05 43     STX $4305
00/B78F: 20 36 8B     JSR $8B36       ; execute dma
00/B792: A2 60 28     LDX #$2860
00/B795: 8E 16 21     STX $2116
00/B798: 9C 0B 42     STZ $420B
00/B79B: A2 16 F7     LDX #$F716
00/B79E: 8E 02 43     STX $4302
00/B7A1: A2 40 00     LDX #$0040
00/B7A4: 8E 05 43     STX $4305
00/B7A7: 20 36 8B     JSR $8B36       ; execute dma
00/B7AA: A0 20 00     LDY #$0020
00/B7AD: A2 00 2C     LDX #$2C00
00/B7B0: 8E 16 21     STX $2116
00/B7B3: 9C 0B 42     STZ $420B
00/B7B6: A2 56 F7     LDX #$F756
00/B7B9: 8E 02 43     STX $4302
00/B7BC: A2 40 00     LDX #$0040
00/B7BF: 8E 05 43     STX $4305
00/B7C2: 20 36 8B     JSR $8B36       ; execute dma
00/B7C5: 88           DEY 
00/B7C6: D0 EB        BNE $B7B3
00/B7C8: 60           RTS 

; [ hide dialogue window ]

00/B7C9: A5 EC        LDA $EC
00/B7CB: D0 01        BNE $B7CE
00/B7CD: 60           RTS 
00/B7CE: 64 EC        STZ $EC
00/B7D0: A9 80        LDA #$80
00/B7D2: 8D 15 21     STA $2115
00/B7D5: 20 2A 8B     JSR $8B2A       ; init dma
00/B7D8: A9 09        LDA #$09
00/B7DA: 8D 00 43     STA $4300
00/B7DD: A2 40 28     LDX #$2840
00/B7E0: 8E 16 21     STX $2116
00/B7E3: 64 10        STZ $10
00/B7E5: A2 10 06     LDX #$0610
00/B7E8: 8E 02 43     STX $4302
00/B7EB: A2 40 00     LDX #$0040
00/B7EE: 8E 05 43     STX $4305
00/B7F1: 20 36 8B     JSR $8B36       ; execute dma
00/B7F4: A2 60 28     LDX #$2860
00/B7F7: 8E 16 21     STX $2116
00/B7FA: 9C 0B 42     STZ $420B
00/B7FD: A2 10 06     LDX #$0610
00/B800: 8E 02 43     STX $4302
00/B803: A2 40 00     LDX #$0040
00/B806: 8E 05 43     STX $4305
00/B809: 20 36 8B     JSR $8B36       ; execute dma
00/B80C: 60           RTS 

; [ transfer dialogue text to vram ]

00/B80D: A5 ED        LDA $ED
00/B80F: D0 01        BNE $B812
00/B811: 60           RTS 
00/B812: 64 ED        STZ $ED
00/B814: A5 BA        LDA $BA
00/B816: 29 03        AND #$03
00/B818: 85 13        STA $13
00/B81A: A9 04        LDA #$04
00/B81C: 85 12        STA $12
00/B81E: A5 13        LDA $13
00/B820: 18           CLC 
00/B821: 69 2C        ADC #$2C
00/B823: 85 13        STA $13
00/B825: A2 74 07     LDX #$0774
00/B828: 86 14        STX $14
00/B82A: A2 34 08     LDX #$0834
00/B82D: 86 16        STX $16
00/B82F: 9C 15 21     STZ $2115
00/B832: 20 2A 8B     JSR $8B2A       ; init dma
00/B835: 9C 00 43     STZ $4300
00/B838: A9 04        LDA #$04
00/B83A: 85 11        STA $11
00/B83C: A6 16        LDX $16
00/B83E: 8E 02 43     STX $4302
00/B841: A6 12        LDX $12
00/B843: 8E 16 21     STX $2116
00/B846: A2 18 00     LDX #$0018
00/B849: 8E 05 43     STX $4305
00/B84C: 20 36 8B     JSR $8B36       ; execute dma
00/B84F: A5 12        LDA $12
00/B851: 18           CLC 
00/B852: 69 20        ADC #$20
00/B854: 85 12        STA $12
00/B856: A5 13        LDA $13
00/B858: 69 00        ADC #$00
00/B85A: 85 13        STA $13
00/B85C: 9C 0B 42     STZ $420B
00/B85F: A6 14        LDX $14
00/B861: 8E 02 43     STX $4302
00/B864: A6 12        LDX $12
00/B866: 8E 16 21     STX $2116
00/B869: A2 18 00     LDX #$0018
00/B86C: 8E 05 43     STX $4305
00/B86F: 20 36 8B     JSR $8B36       ; execute dma
00/B872: A5 12        LDA $12
00/B874: 18           CLC 
00/B875: 69 20        ADC #$20
00/B877: 85 12        STA $12
00/B879: A5 13        LDA $13
00/B87B: 69 00        ADC #$00
00/B87D: C9 30        CMP #$30
00/B87F: D0 02        BNE $B883
00/B881: A9 2C        LDA #$2C
00/B883: 85 13        STA $13
00/B885: A5 14        LDA $14
00/B887: 18           CLC 
00/B888: 69 18        ADC #$18
00/B88A: 85 14        STA $14
00/B88C: A5 15        LDA $15
00/B88E: 69 00        ADC #$00
00/B890: 85 15        STA $15
00/B892: A5 16        LDA $16
00/B894: 18           CLC 
00/B895: 69 18        ADC #$18
00/B897: 85 16        STA $16
00/B899: A5 17        LDA $17
00/B89B: 69 00        ADC #$00
00/B89D: 85 17        STA $17
00/B89F: C6 11        DEC $11
00/B8A1: F0 03        BEQ $B8A6
00/B8A3: 4C 3C B8     JMP $B83C
00/B8A6: E6 BA        INC $BA
00/B8A8: 60           RTS 

; [ hide map name window ]

00/B8A9: A5 EA        LDA $EA
00/B8AB: C9 01        CMP #$01
00/B8AD: F0 01        BEQ $B8B0
00/B8AF: 60           RTS 
00/B8B0: E6 EA        INC $EA
00/B8B2: A9 80        LDA #$80
00/B8B4: 8D 15 21     STA $2115
00/B8B7: 20 2A 8B     JSR $8B2A       ; init dma
00/B8BA: A9 09        LDA #$09
00/B8BC: 8D 00 43     STA $4300       ; fixed address
00/B8BF: A2 40 28     LDX #$2840
00/B8C2: 8E 16 21     STX $2116
00/B8C5: 64 10        STZ $10         ; fixed value
00/B8C7: A2 10 06     LDX #$0610
00/B8CA: 8E 02 43     STX $4302
00/B8CD: A2 00 01     LDX #$0100      ; clear $0100 bytes
00/B8D0: 8E 05 43     STX $4305
00/B8D3: 20 36 8B     JSR $8B36       ; execute dma
00/B8D6: 60           RTS 

; [ load map name ]

00/B8D7: A5 C5        LDA $C5
00/B8D9: F0 03        BEQ $B8DE
00/B8DB: 64 C5        STZ $C5
00/B8DD: 60           RTS 
00/B8DE: A5 D1        LDA $D1
00/B8E0: F0 01        BEQ $B8E3
00/B8E2: 60           RTS 
00/B8E3: A2 00 00     LDX #$0000
00/B8E6: AD E6 0F     LDA $0FE6
00/B8E9: 10 01        BPL $B8EC
00/B8EB: 60           RTS 
00/B8EC: A8           TAY 
00/B8ED: F0 0C        BEQ $B8FB
00/B8EF: BF 80 98 15  LDA $159880,X
00/B8F3: E8           INX 
00/B8F4: C9 00        CMP #$00
00/B8F6: D0 F7        BNE $B8EF
00/B8F8: 88           DEY 
00/B8F9: D0 F4        BNE $B8EF
00/B8FB: 86 3D        STX $3D
00/B8FD: 64 07        STZ $07
00/B8FF: BF 80 98 15  LDA $159880,X
00/B903: E8           INX 
00/B904: E6 07        INC $07
00/B906: C9 00        CMP #$00
00/B908: D0 F5        BNE $B8FF
00/B90A: C6 07        DEC $07
00/B90C: A9 0C        LDA #$0C
00/B90E: 38           SEC 
00/B90F: E5 07        SBC $07
00/B911: 4A           LSR 
00/B912: 85 06        STA $06
00/B914: A2 00 00     LDX #$0000
00/B917: A9 FF        LDA #$FF
00/B919: 9D 74 07     STA $0774,X
00/B91C: 9D 80 07     STA $0780,X
00/B91F: E8           INX 
00/B920: E0 0C 00     CPX #$000C
00/B923: D0 F4        BNE $B919
00/B925: A6 3D        LDX $3D
00/B927: A5 06        LDA $06
00/B929: A8           TAY 
00/B92A: BF 80 98 15  LDA $159880,X
00/B92E: E8           INX 
00/B92F: 20 6E B6     JSR $B66E       ; get dakuten
00/B932: 99 74 07     STA $0774,Y
00/B935: EB           XBA 
00/B936: 99 80 07     STA $0780,Y
00/B939: C8           INY 
00/B93A: A9 00        LDA #$00
00/B93C: EB           XBA 
00/B93D: C6 07        DEC $07
00/B93F: D0 E9        BNE $B92A
00/B941: A9 01        LDA #$01
00/B943: 85 E9        STA $E9
00/B945: 60           RTS 

; [ transfer map name window to vram ]

00/B946: A5 E9        LDA $E9
00/B948: D0 01        BNE $B94B
00/B94A: 60           RTS 
00/B94B: 64 E9        STZ $E9
00/B94D: 9C 12 21     STZ $2112
00/B950: 9C 12 21     STZ $2112
00/B953: A9 80        LDA #$80
00/B955: 8D 15 21     STA $2115
00/B958: A2 48 28     LDX #$2848
00/B95B: 8E 16 21     STX $2116
00/B95E: A2 00 00     LDX #$0000
00/B961: BF 96 F7 14  LDA $14F796,X
00/B965: 8D 18 21     STA $2118
00/B968: E8           INX 
00/B969: BF 96 F7 14  LDA $14F796,X
00/B96D: 8D 19 21     STA $2119
00/B970: E8           INX 
00/B971: E0 20 00     CPX #$0020
00/B974: D0 EB        BNE $B961
00/B976: A2 68 28     LDX #$2868
00/B979: 8E 16 21     STX $2116
00/B97C: A2 19 20     LDX #$2019
00/B97F: 8E 18 21     STX $2118
00/B982: A2 FF 20     LDX #$20FF
00/B985: 8E 18 21     STX $2118
00/B988: A2 00 00     LDX #$0000
00/B98B: BD 80 07     LDA $0780,X
00/B98E: 8D 18 21     STA $2118
00/B991: A9 20        LDA #$20
00/B993: 8D 19 21     STA $2119
00/B996: E8           INX 
00/B997: E0 0C 00     CPX #$000C
00/B99A: D0 EF        BNE $B98B
00/B99C: A2 76 28     LDX #$2876
00/B99F: 8E 16 21     STX $2116
00/B9A2: A2 FF 20     LDX #$20FF
00/B9A5: 8E 18 21     STX $2118
00/B9A8: A2 1A 20     LDX #$201A
00/B9AB: 8E 18 21     STX $2118
00/B9AE: A2 88 28     LDX #$2888
00/B9B1: 8E 16 21     STX $2116
00/B9B4: A2 19 20     LDX #$2019
00/B9B7: 8E 18 21     STX $2118
00/B9BA: A2 FF 20     LDX #$20FF
00/B9BD: 8E 18 21     STX $2118
00/B9C0: A2 00 00     LDX #$0000
00/B9C3: BD 74 07     LDA $0774,X
00/B9C6: 8D 18 21     STA $2118
00/B9C9: A9 20        LDA #$20
00/B9CB: 8D 19 21     STA $2119
00/B9CE: E8           INX 
00/B9CF: E0 0C 00     CPX #$000C
00/B9D2: D0 EF        BNE $B9C3
00/B9D4: A2 96 28     LDX #$2896
00/B9D7: 8E 16 21     STX $2116
00/B9DA: A2 FF 20     LDX #$20FF
00/B9DD: 8E 18 21     STX $2118
00/B9E0: A2 1A 20     LDX #$201A
00/B9E3: 8E 18 21     STX $2118
00/B9E6: A9 80        LDA #$80
00/B9E8: 8D 15 21     STA $2115
00/B9EB: A2 A8 28     LDX #$28A8
00/B9EE: 8E 16 21     STX $2116
00/B9F1: A2 00 00     LDX #$0000
00/B9F4: BF B6 F7 14  LDA $14F7B6,X
00/B9F8: 8D 18 21     STA $2118
00/B9FB: E8           INX 
00/B9FC: BF B6 F7 14  LDA $14F7B6,X
00/BA00: 8D 19 21     STA $2119
00/BA03: E8           INX 
00/BA04: E0 20 00     CPX #$0020
00/BA07: D0 EB        BNE $B9F4
00/BA09: 60           RTS 

; --------------------------------------------------------------------------

; [ check npcs ]

00/BA0A: AD 05 17     LDA $1705       ; facing direction
00/BA0D: 85 08        STA $08
00/BA0F: 0A           ASL 
00/BA10: A8           TAY 
00/BA11: D0 0E        BNE $BA21
00/BA13: B9 A4 06     LDA $06A4,Y
00/BA16: 29 20        AND #$20
00/BA18: F0 07        BEQ $BA21
00/BA1A: A9 04        LDA #$04
00/BA1C: 85 08        STA $08
00/BA1E: 4C 2D BA     JMP $BA2D
00/BA21: B9 A3 06     LDA $06A3,Y
00/BA24: 29 03        AND #$03
00/BA26: F0 05        BEQ $BA2D
00/BA28: 25 D2        AND $D2
00/BA2A: D0 01        BNE $BA2D
00/BA2C: 60           RTS 
00/BA2D: A5 08        LDA $08
00/BA2F: A8           TAY 
00/BA30: AD 06 17     LDA $1706
00/BA33: 18           CLC 
00/BA34: 79 31 BB     ADC $BB31,Y
00/BA37: 85 0C        STA $0C
00/BA39: AD 07 17     LDA $1707
00/BA3C: 18           CLC 
00/BA3D: 79 36 BB     ADC $BB36,Y
00/BA40: 85 0E        STA $0E
00/BA42: 20 28 C3     JSR $C328       ; check npc map
00/BA45: C9 00        CMP #$00
00/BA47: F0 0A        BEQ $BA53
00/BA49: C9 FF        CMP #$FF
00/BA4B: F0 06        BEQ $BA53
00/BA4D: 20 0D BB     JSR $BB0D       ; get npc pointer
00/BA50: 4C E3 BA     JMP $BAE3
00/BA53: A5 08        LDA $08
00/BA55: A8           TAY 
00/BA56: AD 06 17     LDA $1706
00/BA59: 18           CLC 
00/BA5A: 79 3B BB     ADC $BB3B,Y
00/BA5D: 85 0C        STA $0C
00/BA5F: AD 07 17     LDA $1707
00/BA62: 18           CLC 
00/BA63: 79 40 BB     ADC $BB40,Y
00/BA66: 85 0E        STA $0E
00/BA68: 20 28 C3     JSR $C328       ; check npc map
00/BA6B: C9 00        CMP #$00
00/BA6D: F0 13        BEQ $BA82
00/BA6F: C9 FF        CMP #$FF
00/BA71: F0 0F        BEQ $BA82
00/BA73: 20 0D BB     JSR $BB0D       ; get npc pointer
00/BA76: C9 FF        CMP #$FF
00/BA78: F0 08        BEQ $BA82
00/BA7A: D9 59 BB     CMP $BB59,Y
00/BA7D: D0 03        BNE $BA82
00/BA7F: 4C E3 BA     JMP $BAE3
00/BA82: A5 08        LDA $08
00/BA84: A8           TAY 
00/BA85: AD 06 17     LDA $1706
00/BA88: 18           CLC 
00/BA89: 79 45 BB     ADC $BB45,Y
00/BA8C: 85 0C        STA $0C
00/BA8E: AD 07 17     LDA $1707
00/BA91: 18           CLC 
00/BA92: 79 4A BB     ADC $BB4A,Y
00/BA95: 85 0E        STA $0E
00/BA97: 20 28 C3     JSR $C328       ; check npc map
00/BA9A: C9 00        CMP #$00
00/BA9C: F0 13        BEQ $BAB1
00/BA9E: C9 FF        CMP #$FF
00/BAA0: F0 0F        BEQ $BAB1
00/BAA2: 20 0D BB     JSR $BB0D       ; get npc pointer
00/BAA5: C9 FF        CMP #$FF
00/BAA7: F0 08        BEQ $BAB1
00/BAA9: D9 5E BB     CMP $BB5E,Y
00/BAAC: D0 03        BNE $BAB1
00/BAAE: 4C E3 BA     JMP $BAE3
00/BAB1: A5 08        LDA $08
00/BAB3: A8           TAY 
00/BAB4: AD 06 17     LDA $1706
00/BAB7: 18           CLC 
00/BAB8: 79 4F BB     ADC $BB4F,Y
00/BABB: 85 0C        STA $0C
00/BABD: AD 07 17     LDA $1707
00/BAC0: 18           CLC 
00/BAC1: 79 54 BB     ADC $BB54,Y
00/BAC4: 85 0E        STA $0E
00/BAC6: 20 28 C3     JSR $C328       ; check npc map
00/BAC9: C9 00        CMP #$00
00/BACB: F0 13        BEQ $BAE0
00/BACD: C9 FF        CMP #$FF
00/BACF: F0 0F        BEQ $BAE0
00/BAD1: 20 0D BB     JSR $BB0D       ; get npc pointer
00/BAD4: C9 FF        CMP #$FF
00/BAD6: F0 08        BEQ $BAE0
00/BAD8: D9 63 BB     CMP $BB63,Y
00/BADB: D0 03        BNE $BAE0
00/BADD: 4C E3 BA     JMP $BAE3
00/BAE0: 4C 0C BB     JMP $BB0C
00/BAE3: BD 09 09     LDA $0909,X     ; save facing direction
00/BAE6: 48           PHA 
00/BAE7: BD 01 09     LDA $0901,X
00/BAEA: 29 10        AND #$10
00/BAEC: F0 0B        BEQ $BAF9       ; branch if npc doesn't face player
00/BAEE: AD 05 17     LDA $1705
00/BAF1: 18           CLC 
00/BAF2: 69 02        ADC #$02        ; face toward player
00/BAF4: 29 03        AND #$03
00/BAF6: 9D 09 09     STA $0909,X
00/BAF9: DA           PHX 
00/BAFA: 20 68 BB     JSR $BB68       ; draw npcs
00/BAFD: FA           PLX 
00/BAFE: BD 07 09     LDA $0907,X
00/BB01: DA           PHX 
00/BB02: 20 C7 F2     JSR $F2C7       ; execute npc script
00/BB05: FA           PLX 
00/BB06: 68           PLA 
00/BB07: 9D 09 09     STA $0909,X     ; restore facing direction
00/BB0A: 64 EE        STZ $EE
00/BB0C: 60           RTS 

; [ get npc pointer ]

00/BB0D: 29 7F        AND #$7F
00/BB0F: AA           TAX 
00/BB10: A9 00        LDA #$00
00/BB12: E0 00 00     CPX #$0000
00/BB15: F0 07        BEQ $BB1E
00/BB17: CA           DEX 
00/BB18: 18           CLC 
00/BB19: 69 0F        ADC #$0F
00/BB1B: 4C 12 BB     JMP $BB12
00/BB1E: AA           TAX 
00/BB1F: BD 03 09     LDA $0903,X
00/BB22: 1D 05 09     ORA $0905,X
00/BB25: D0 05        BNE $BB2C
00/BB27: A9 FF        LDA #$FF
00/BB29: 4C 30 BB     JMP $BB30
00/BB2C: BD 02 09     LDA $0902,X
00/BB2F: 3A           DEC 
00/BB30: 60           RTS 

00/BB31: 00 01 00 FF 00
00/BB36: FF 00 01 00 FE
00/BB3B: FF 01 01 FF FF
00/BB40: FF FF 01 01 FE
00/BB45: 01 01 FF FF 01
00/BB4A: FF 01 01 FF FE
00/BB4F: 00 02 00 FE 00
00/BB54: FE 00 02 00 FE
00/BB59: 03 00 01 02 03
00/BB5E: 01 02 03 00 01
00/BB63: 00 01 02 03 00

; [ draw npcs ]

00/BB68: AD FE 08     LDA $08FE
00/BB6B: D0 01        BNE $BB6E
00/BB6D: 60           RTS 
00/BB6E: A2 00 00     LDX #$0000
00/BB71: 86 AF        STX $AF
00/BB73: 86 40        STX $40
00/BB75: 64 AE        STZ $AE
00/BB77: A2 20 00     LDX #$0020
00/BB7A: 86 43        STX $43
00/BB7C: A6 AF        LDX $AF
00/BB7E: BD 0B 09     LDA $090B,X
00/BB81: D0 03        BNE $BB86
00/BB83: 4C 16 BD     JMP $BD16
00/BB86: BD 01 09     LDA $0901,X
00/BB89: 29 03        AND #$03
00/BB8B: F0 4A        BEQ $BBD7
00/BB8D: A8           TAY 
00/BB8E: BD 01 09     LDA $0901,X
00/BB91: 29 20        AND #$20
00/BB93: D0 08        BNE $BB9D
00/BB95: A0 00 01     LDY #$0100
00/BB98: 84 3D        STY $3D
00/BB9A: 4C 4D BC     JMP $BC4D
00/BB9D: C0 01 00     CPY #$0001
00/BBA0: D0 0F        BNE $BBB1
00/BBA2: A5 7A        LDA $7A
00/BBA4: 29 10        AND #$10
00/BBA6: 0A           ASL 
00/BBA7: 0A           ASL 
00/BBA8: 85 3D        STA $3D
00/BBAA: A9 01        LDA #$01
00/BBAC: 85 3E        STA $3E
00/BBAE: 4C 4D BC     JMP $BC4D
00/BBB1: BD 01 09     LDA $0901,X
00/BBB4: 4A           LSR 
00/BBB5: 4A           LSR 
00/BBB6: 4A           LSR 
00/BBB7: 4A           LSR 
00/BBB8: 4A           LSR 
00/BBB9: 4A           LSR 
00/BBBA: AA           TAX 
00/BBBB: BD F6 BD     LDA $BDF6,X
00/BBBE: AA           TAX 
00/BBBF: A5 7A        LDA $7A
00/BBC1: 4A           LSR 
00/BBC2: CA           DEX 
00/BBC3: D0 FC        BNE $BBC1
00/BBC5: A6 AF        LDX $AF
00/BBC7: 29 0C        AND #$0C
00/BBC9: 0A           ASL 
00/BBCA: 0A           ASL 
00/BBCB: 39 FA BD     AND $BDFA,Y
00/BBCE: 85 3D        STA $3D
00/BBD0: A9 01        LDA #$01
00/BBD2: 85 3E        STA $3E
00/BBD4: 4C 4D BC     JMP $BC4D
00/BBD7: BD 0C 09     LDA $090C,X
00/BBDA: 29 02        AND #$02
00/BBDC: F0 1F        BEQ $BBFD
00/BBDE: BD FF 08     LDA $08FF,X
00/BBE1: 29 7F        AND #$7F
00/BBE3: 4A           LSR 
00/BBE4: 4A           LSR 
00/BBE5: 4A           LSR 
00/BBE6: 4A           LSR 
00/BBE7: A8           TAY 
00/BBE8: BD 0C 09     LDA $090C,X
00/BBEB: 29 01        AND #$01
00/BBED: D0 06        BNE $BBF5
00/BBEF: B9 FE BD     LDA $BDFE,Y
00/BBF2: 4C F8 BB     JMP $BBF8
00/BBF5: B9 06 BE     LDA $BE06,Y
00/BBF8: 64 3D        STZ $3D
00/BBFA: 4C 41 BC     JMP $BC41
00/BBFD: BD 02 09     LDA $0902,X
00/BC00: 29 7F        AND #$7F
00/BC02: D0 0C        BNE $BC10
00/BC04: BD 01 09     LDA $0901,X
00/BC07: 29 20        AND #$20
00/BC09: D0 27        BNE $BC32
00/BC0B: A9 00        LDA #$00
00/BC0D: 4C 3A BC     JMP $BC3A
00/BC10: BD FF 08     LDA $08FF,X
00/BC13: 29 40        AND #$40
00/BC15: F0 05        BEQ $BC1C
00/BC17: A9 00        LDA #$00
00/BC19: 4C 3A BC     JMP $BC3A
00/BC1C: BD 08 09     LDA $0908,X
00/BC1F: F0 07        BEQ $BC28
00/BC21: BD FF 08     LDA $08FF,X
00/BC24: 4A           LSR 
00/BC25: 4C 34 BC     JMP $BC34
00/BC28: A5 B1        LDA $B1
00/BC2A: D0 06        BNE $BC32
00/BC2C: BD FF 08     LDA $08FF,X
00/BC2F: 4C 34 BC     JMP $BC34
00/BC32: A5 7A        LDA $7A
00/BC34: 29 10        AND #$10
00/BC36: 4A           LSR 
00/BC37: 4A           LSR 
00/BC38: 4A           LSR 
00/BC39: 4A           LSR 
00/BC3A: 85 3D        STA $3D
00/BC3C: BD 09 09     LDA $0909,X
00/BC3F: 29 7F        AND #$7F
00/BC41: 0A           ASL 
00/BC42: 18           CLC 
00/BC43: 65 3D        ADC $3D
00/BC45: 0A           ASL 
00/BC46: 0A           ASL 
00/BC47: 0A           ASL 
00/BC48: 0A           ASL 
00/BC49: 85 3D        STA $3D
00/BC4B: 64 3E        STZ $3E
00/BC4D: BD 0D 09     LDA $090D,X
00/BC50: 0A           ASL 
00/BC51: 85 07        STA $07
00/BC53: 64 08        STZ $08
00/BC55: BD 0C 09     LDA $090C,X
00/BC58: 29 01        AND #$01
00/BC5A: F0 0E        BEQ $BC6A
00/BC5C: BD FF 08     LDA $08FF,X
00/BC5F: 4A           LSR 
00/BC60: 4A           LSR 
00/BC61: 29 1F        AND #$1F
00/BC63: AA           TAX 
00/BC64: BF C6 FC 14  LDA $14FCC6,X   ; y-offset for jumping npcs ???
00/BC68: 85 08        STA $08
00/BC6A: A6 3D        LDX $3D
00/BC6C: A9 04        LDA #$04
00/BC6E: 85 06        STA $06
00/BC70: A4 AF        LDY $AF
00/BC72: B9 03 09     LDA $0903,Y     ; x-offset
00/BC75: 18           CLC 
00/BC76: 7F 46 F8 14  ADC $14F846,X
00/BC7A: 85 0C        STA $0C
00/BC7C: 64 0D        STZ $0D
00/BC7E: B9 05 09     LDA $0905,Y
00/BC81: 18           CLC 
00/BC82: 7F 47 F8 14  ADC $14F847,X
00/BC86: 85 0E        STA $0E
00/BC88: 64 0F        STZ $0F
00/BC8A: 20 B0 BD     JSR $BDB0
00/BC8D: A5 D7        LDA $D7
00/BC8F: D0 6E        BNE $BCFF
00/BC91: A4 40        LDY $40
00/BC93: A5 06        LDA $06
00/BC95: 4A           LSR 
00/BC96: B0 2E        BCS $BCC6
00/BC98: A5 18        LDA $18
00/BC9A: 99 00 04     STA $0400,Y
00/BC9D: A5 1A        LDA $1A
00/BC9F: 38           SEC 
00/BCA0: E9 04        SBC #$04
00/BCA2: 38           SEC 
00/BCA3: E5 08        SBC $08
00/BCA5: 99 01 04     STA $0401,Y
00/BCA8: BF 48 F8 14  LDA $14F848,X
00/BCAC: 18           CLC 
00/BCAD: 65 43        ADC $43
00/BCAF: 99 02 04     STA $0402,Y
00/BCB2: A5 44        LDA $44
00/BCB4: 69 00        ADC #$00
00/BCB6: 18           CLC 
00/BCB7: 7F 49 F8 14  ADC $14F849,X
00/BCBB: 29 F1        AND #$F1
00/BCBD: 18           CLC 
00/BCBE: 65 07        ADC $07
00/BCC0: 99 03 04     STA $0403,Y
00/BCC3: 4C FF BC     JMP $BCFF
00/BCC6: A5 18        LDA $18
00/BCC8: 99 80 04     STA $0480,Y
00/BCCB: A5 1A        LDA $1A
00/BCCD: 38           SEC 
00/BCCE: E9 04        SBC #$04
00/BCD0: 38           SEC 
00/BCD1: E5 08        SBC $08
00/BCD3: 99 81 04     STA $0481,Y
00/BCD6: BF 48 F8 14  LDA $14F848,X
00/BCDA: 18           CLC 
00/BCDB: 65 43        ADC $43
00/BCDD: 99 82 04     STA $0482,Y
00/BCE0: A5 44        LDA $44
00/BCE2: 69 00        ADC #$00
00/BCE4: 18           CLC 
00/BCE5: 7F 49 F8 14  ADC $14F849,X
00/BCE9: 29 F1        AND #$F1
00/BCEB: 18           CLC 
00/BCEC: 65 07        ADC $07
00/BCEE: 99 83 04     STA $0483,Y
00/BCF1: A4 AF        LDY $AF
00/BCF3: B9 0A 09     LDA $090A,Y
00/BCF6: F0 07        BEQ $BCFF
00/BCF8: A4 40        LDY $40
00/BCFA: A9 F8        LDA #$F8
00/BCFC: 99 81 04     STA $0481,Y
00/BCFF: E8           INX 
00/BD00: E8           INX 
00/BD01: E8           INX 
00/BD02: E8           INX 
00/BD03: A5 06        LDA $06
00/BD05: 4A           LSR 
00/BD06: 90 07        BCC $BD0F
00/BD08: A5 40        LDA $40
00/BD0A: 18           CLC 
00/BD0B: 69 04        ADC #$04
00/BD0D: 85 40        STA $40
00/BD0F: C6 06        DEC $06
00/BD11: F0 03        BEQ $BD16
00/BD13: 4C 70 BC     JMP $BC70
00/BD16: A5 43        LDA $43
00/BD18: 18           CLC 
00/BD19: 69 20        ADC #$20
00/BD1B: 85 43        STA $43
00/BD1D: A5 44        LDA $44
00/BD1F: 69 00        ADC #$00
00/BD21: 85 44        STA $44
00/BD23: A5 AF        LDA $AF
00/BD25: 18           CLC 
00/BD26: 69 0F        ADC #$0F
00/BD28: 85 AF        STA $AF
00/BD2A: E6 AE        INC $AE
00/BD2C: A5 AE        LDA $AE
00/BD2E: CD FE 08     CMP $08FE
00/BD31: F0 03        BEQ $BD36
00/BD33: 4C 7C BB     JMP $BB7C
00/BD36: AD 8A 12     LDA $128A
00/BD39: 29 40        AND #$40
00/BD3B: F0 72        BEQ $BDAF
00/BD3D: 64 AE        STZ $AE
00/BD3F: A5 AE        LDA $AE
00/BD41: AA           TAX 
00/BD42: BF 96 FC 14  LDA $14FC96,X
00/BD46: 85 0C        STA $0C
00/BD48: BF A6 FC 14  LDA $14FCA6,X
00/BD4C: 85 0E        STA $0E
00/BD4E: BF 76 FC 14  LDA $14FC76,X
00/BD52: 85 07        STA $07
00/BD54: BF B6 FC 14  LDA $14FCB6,X
00/BD58: 85 08        STA $08
00/BD5A: A5 AE        LDA $AE
00/BD5C: 64 3E        STZ $3E
00/BD5E: 0A           ASL 
00/BD5F: 26 3E        ROL $3E
00/BD61: 0A           ASL 
00/BD62: 26 3E        ROL $3E
00/BD64: 0A           ASL 
00/BD65: 26 3E        ROL $3E
00/BD67: 0A           ASL 
00/BD68: 26 3E        ROL $3E
00/BD6A: 85 3D        STA $3D
00/BD6C: A4 3D        LDY $3D
00/BD6E: A5 AE        LDA $AE
00/BD70: AA           TAX 
00/BD71: BF 86 FC 14  LDA $14FC86,X
00/BD75: AA           TAX 
00/BD76: A5 0C        LDA $0C
00/BD78: 18           CLC 
00/BD79: 7F 46 F8 14  ADC $14F846,X
00/BD7D: 99 00 03     STA $0300,Y
00/BD80: A5 0E        LDA $0E
00/BD82: 18           CLC 
00/BD83: 7F 47 F8 14  ADC $14F847,X
00/BD87: 99 01 03     STA $0301,Y
00/BD8A: A5 07        LDA $07
00/BD8C: 18           CLC 
00/BD8D: 7F 48 F8 14  ADC $14F848,X
00/BD91: 99 02 03     STA $0302,Y
00/BD94: BF 49 F8 14  LDA $14F849,X
00/BD98: 29 F1        AND #$F1
00/BD9A: 05 08        ORA $08
00/BD9C: 99 03 03     STA $0303,Y
00/BD9F: 20 E2 88     JSR $88E2       ; next sprite
00/BDA2: 98           TYA 
00/BDA3: 29 0F        AND #$0F
00/BDA5: D0 CF        BNE $BD76
00/BDA7: E6 AE        INC $AE
00/BDA9: A5 AE        LDA $AE
00/BDAB: C9 10        CMP #$10
00/BDAD: D0 90        BNE $BD3F
00/BDAF: 60           RTS 

; [  ]

00/BDB0: DA           PHX 
00/BDB1: 5A           PHY 
00/BDB2: 64 D7        STZ $D7
00/BDB4: A6 AF        LDX $AF
00/BDB6: C2 20        REP #$20
00/BDB8: BD 04 09     LDA $0904,X
00/BDBB: 29 FF 00     AND #$00FF
00/BDBE: 0A           ASL 
00/BDBF: 0A           ASL 
00/BDC0: 0A           ASL 
00/BDC1: 0A           ASL 
00/BDC2: 18           CLC 
00/BDC3: 65 0C        ADC $0C
00/BDC5: 38           SEC 
00/BDC6: E5 5A        SBC $5A
00/BDC8: 29 FF 03     AND #$03FF
00/BDCB: 85 18        STA $18
00/BDCD: C9 00 01     CMP #$0100
00/BDD0: B0 1A        BCS $BDEC 
00/BDD2: BD 06 09     LDA $0906,X
00/BDD5: 29 FF 00     AND #$00FF
00/BDD8: 0A           ASL 
00/BDD9: 0A           ASL 
00/BDDA: 0A           ASL 
00/BDDB: 0A           ASL 
00/BDDC: 18           CLC 
00/BDDD: 65 0E        ADC $0E
00/BDDF: 38           SEC 
00/BDE0: E5 5C        SBC $5C
00/BDE2: 29 FF 03     AND #$03FF
00/BDE5: 85 1A        STA $1A
00/BDE7: C9 F0 00     CMP #$00F0
00/BDEA: 90 02        BCC $BDEE
00/BDEC: E6 D7        INC $D7
00/BDEE: A9 00 00     LDA #$0000
00/BDF1: E2 20        SEP #$20
00/BDF3: 7A           PLY 
00/BDF4: FA           PLX 
00/BDF5: 60           RTS 

00/BDF6: 04 03 02 01
00/BDFA: 00 00 10 30
00/BDFE: 03 00 01 02
00/BE02: 03 00 01 02
00/BE06: 02 02 03 00
00/BE0A: 01 02 02 02

; [ check npc movement ]

00/BE0E: AD FE 08     LDA $08FE
00/BE11: D0 01        BNE $BE14       ; return if there are no npcs
00/BE13: 60           RTS 
00/BE14: 64 AE        STZ $AE
00/BE16: A2 00 00     LDX #$0000
00/BE19: 86 AF        STX $AF
00/BE1B: A6 AF        LDX $AF
00/BE1D: A5 B1        LDA $B1
00/BE1F: F0 08        BEQ $BE29
00/BE21: BD 08 09     LDA $0908,X
00/BE24: D0 03        BNE $BE29
00/BE26: 4C 96 BF     JMP $BF96
00/BE29: BD 02 09     LDA $0902,X
00/BE2C: 29 7F        AND #$7F
00/BE2E: D0 03        BNE $BE33
00/BE30: 4C 66 BF     JMP $BF66
00/BE33: BD FF 08     LDA $08FF,X
00/BE36: 29 40        AND #$40
00/BE38: F0 03        BEQ $BE3D
00/BE3A: 4C 96 BF     JMP $BF96
00/BE3D: BD FF 08     LDA $08FF,X
00/BE40: 29 3F        AND #$3F
00/BE42: F0 03        BEQ $BE47
00/BE44: 4C 96 BF     JMP $BF96
00/BE47: 9E 00 09     STZ $0900,X
00/BE4A: A5 EE        LDA $EE
00/BE4C: F0 0D        BEQ $BE5B       ; branch if no npc blocking player
00/BE4E: 29 7F        AND #$7F
00/BE50: C5 AE        CMP $AE
00/BE52: D0 07        BNE $BE5B       ; branch if not this npc
00/BE54: 64 EE        STZ $EE
00/BE56: A9 01        LDA #$01
00/BE58: 9D 00 09     STA $0900,X
00/BE5B: BD 04 09     LDA $0904,X
00/BE5E: 85 0C        STA $0C
00/BE60: BD 06 09     LDA $0906,X
00/BE63: 85 0E        STA $0E
00/BE65: 20 E3 BF     JSR $BFE3
00/BE68: 85 06        STA $06
00/BE6A: BD 02 09     LDA $0902,X
00/BE6D: 29 7F        AND #$7F
00/BE6F: 9D 02 09     STA $0902,X
00/BE72: 20 28 C4     JSR $C428       ; random (0..255)
00/BE75: C9 80        CMP #$80
00/BE77: 90 03        BCC $BE7C
00/BE79: 4C F8 BE     JMP $BEF8
00/BE7C: BD 04 09     LDA $0904,X
00/BE7F: 85 0C        STA $0C
00/BE81: BD 06 09     LDA $0906,X
00/BE84: 85 0E        STA $0E
00/BE86: BD 02 09     LDA $0902,X
00/BE89: 4A           LSR 
00/BE8A: 90 36        BCC $BEC2
00/BE8C: 20 28 C4     JSR $C428       ; random (0..255)
00/BE8F: 4A           LSR 
00/BE90: B0 18        BCS $BEAA
00/BE92: E6 0C        INC $0C
00/BE94: 20 E3 BF     JSR $BFE3
00/BE97: C5 06        CMP $06
00/BE99: D0 5D        BNE $BEF8
00/BE9B: 20 0B C3     JSR $C30B       ; check npc map
00/BE9E: C9 00        CMP #$00
00/BEA0: D0 56        BNE $BEF8
00/BEA2: A9 02        LDA #$02
00/BEA4: 9D 02 09     STA $0902,X
00/BEA7: 4C F8 BE     JMP $BEF8
00/BEAA: C6 0C        DEC $0C
00/BEAC: 20 E3 BF     JSR $BFE3
00/BEAF: C5 06        CMP $06
00/BEB1: D0 45        BNE $BEF8
00/BEB3: 20 0B C3     JSR $C30B       ; check npc map
00/BEB6: C9 00        CMP #$00
00/BEB8: D0 3E        BNE $BEF8
00/BEBA: A9 04        LDA #$04
00/BEBC: 9D 02 09     STA $0902,X
00/BEBF: 4C F8 BE     JMP $BEF8
00/BEC2: 20 28 C4     JSR $C428       ; random (0..255)
00/BEC5: 4A           LSR 
00/BEC6: B0 18        BCS $BEE0
00/BEC8: C6 0E        DEC $0E
00/BECA: 20 E3 BF     JSR $BFE3
00/BECD: C5 06        CMP $06
00/BECF: D0 27        BNE $BEF8
00/BED1: 20 0B C3     JSR $C30B       ; check npc map
00/BED4: C9 00        CMP #$00
00/BED6: D0 20        BNE $BEF8
00/BED8: A9 01        LDA #$01
00/BEDA: 9D 02 09     STA $0902,X
00/BEDD: 4C F8 BE     JMP $BEF8
00/BEE0: E6 0E        INC $0E
00/BEE2: 20 E3 BF     JSR $BFE3
00/BEE5: C5 06        CMP $06
00/BEE7: D0 0F        BNE $BEF8
00/BEE9: 20 0B C3     JSR $C30B       ; check npc map
00/BEEC: C9 00        CMP #$00
00/BEEE: D0 08        BNE $BEF8
00/BEF0: A9 03        LDA #$03
00/BEF2: 9D 02 09     STA $0902,X
00/BEF5: 4C F8 BE     JMP $BEF8
00/BEF8: A6 AF        LDX $AF
00/BEFA: BD 02 09     LDA $0902,X
00/BEFD: 29 7F        AND #$7F
00/BEFF: A8           TAY 
00/BF00: BD 04 09     LDA $0904,X
00/BF03: 18           CLC 
00/BF04: 79 D9 BF     ADC $BFD9,Y
00/BF07: 85 0C        STA $0C
00/BF09: BD 06 09     LDA $0906,X
00/BF0C: 18           CLC 
00/BF0D: 79 DE BF     ADC $BFDE,Y
00/BF10: 85 0E        STA $0E
00/BF12: 20 E3 BF     JSR $BFE3
00/BF15: C5 06        CMP $06
00/BF17: D0 07        BNE $BF20
00/BF19: 20 0B C3     JSR $C30B       ; check npc map
00/BF1C: C9 00        CMP #$00
00/BF1E: F0 46        BEQ $BF66
00/BF20: BD 02 09     LDA $0902,X
00/BF23: 3A           DEC 
00/BF24: 18           CLC 
00/BF25: 69 02        ADC #$02
00/BF27: 29 03        AND #$03
00/BF29: 1A           INC 
00/BF2A: A8           TAY 
00/BF2B: BD 04 09     LDA $0904,X
00/BF2E: 18           CLC 
00/BF2F: 79 D9 BF     ADC $BFD9,Y
00/BF32: 85 0C        STA $0C
00/BF34: BD 06 09     LDA $0906,X
00/BF37: 18           CLC 
00/BF38: 79 DE BF     ADC $BFDE,Y
00/BF3B: 85 0E        STA $0E
00/BF3D: 20 E3 BF     JSR $BFE3
00/BF40: C5 06        CMP $06
00/BF42: D0 17        BNE $BF5B
00/BF44: 20 0B C3     JSR $C30B       ; check npc map
00/BF47: C9 00        CMP #$00
00/BF49: D0 10        BNE $BF5B
00/BF4B: BD 02 09     LDA $0902,X
00/BF4E: 3A           DEC 
00/BF4F: 18           CLC 
00/BF50: 69 02        ADC #$02
00/BF52: 29 03        AND #$03
00/BF54: 1A           INC 
00/BF55: 9D 02 09     STA $0902,X
00/BF58: 4C 66 BF     JMP $BF66
00/BF5B: BD 02 09     LDA $0902,X
00/BF5E: 09 80        ORA #$80
00/BF60: 9D 02 09     STA $0902,X
00/BF63: 4C 96 BF     JMP $BF96
00/BF66: BD 0B 09     LDA $090B,X
00/BF69: D0 03        BNE $BF6E
00/BF6B: 4C 96 BF     JMP $BF96
00/BF6E: BD 04 09     LDA $0904,X
00/BF71: 85 0C        STA $0C
00/BF73: BD 06 09     LDA $0906,X
00/BF76: 85 0E        STA $0E
00/BF78: 20 FD C2     JSR $C2FD       ; clear npc map position
00/BF7B: BD 02 09     LDA $0902,X
00/BF7E: 29 7F        AND #$7F
00/BF80: A8           TAY 
00/BF81: BD 04 09     LDA $0904,X
00/BF84: 18           CLC 
00/BF85: 79 D9 BF     ADC $BFD9,Y
00/BF88: 85 0C        STA $0C
00/BF8A: BD 06 09     LDA $0906,X
00/BF8D: 18           CLC 
00/BF8E: 79 DE BF     ADC $BFDE,Y
00/BF91: 85 0E        STA $0E
00/BF93: 20 45 C3     JSR $C345       ; set npc map position
00/BF96: A6 AF        LDX $AF
00/BF98: BD 02 09     LDA $0902,X
00/BF9B: F0 04        BEQ $BFA1
00/BF9D: 3A           DEC 
00/BF9E: 9D 09 09     STA $0909,X
00/BFA1: BD 04 09     LDA $0904,X
00/BFA4: 85 3D        STA $3D
00/BFA6: BD 06 09     LDA $0906,X
00/BFA9: 85 3E        STA $3E
00/BFAB: A6 3D        LDX $3D
00/BFAD: BF 71 5C 7F  LDA $7F5C71,X
00/BFB1: 85 3D        STA $3D
00/BFB3: 64 3E        STZ $3E
00/BFB5: 06 3D        ASL $3D
00/BFB7: 26 3E        ROL $3E
00/BFB9: A6 3D        LDX $3D
00/BFBB: BD DC 0E     LDA $0EDC,X
00/BFBE: A6 AF        LDX $AF
00/BFC0: 29 08        AND #$08
00/BFC2: 9D 0A 09     STA $090A,X
00/BFC5: A5 AF        LDA $AF
00/BFC7: 18           CLC 
00/BFC8: 69 0F        ADC #$0F
00/BFCA: 85 AF        STA $AF
00/BFCC: E6 AE        INC $AE
00/BFCE: A5 AE        LDA $AE
00/BFD0: CD FE 08     CMP $08FE
00/BFD3: F0 03        BEQ $BFD8
00/BFD5: 4C 1B BE     JMP $BE1B
00/BFD8: 60           RTS 

00/BFD9: 00 00 01 00 FF
00/BFDE: 00 FF 00 01 00

; [  ]

00/BFE3: DA           PHX 
00/BFE4: A5 0C        LDA $0C
00/BFE6: 30 20        BMI $C008
00/BFE8: 85 3D        STA $3D
00/BFEA: A5 0E        LDA $0E
00/BFEC: 30 1A        BMI $C008
00/BFEE: 85 3E        STA $3E
00/BFF0: A6 3D        LDX $3D
00/BFF2: BF 71 5C 7F  LDA $7F5C71,X
00/BFF6: 85 3D        STA $3D
00/BFF8: 64 3E        STZ $3E
00/BFFA: 06 3D        ASL $3D
00/BFFC: 26 3E        ROL $3E
00/BFFE: A6 3D        LDX $3D
00/C000: BD DB 0E     LDA $0EDB,X
00/C003: 29 83        AND #$83
00/C005: 4C 0A C0     JMP $C00A
00/C008: A9 00        LDA #$00
00/C00A: FA           PLX 
00/C00B: 60           RTS 

; [ move npcs ]

00/C00C: AD FE 08     LDA $08FE
00/C00F: D0 01        BNE $C012       ; return if there are no npcs
00/C011: 60           RTS 
00/C012: 64 AE        STZ $AE
00/C014: A2 00 00     LDX #$0000
00/C017: 86 AF        STX $AF
00/C019: A6 AF        LDX $AF
00/C01B: A5 B1        LDA $B1
00/C01D: F0 08        BEQ $C027
00/C01F: BD 08 09     LDA $0908,X
00/C022: D0 17        BNE $C03B
00/C024: 4C EC C0     JMP $C0EC
00/C027: BD 02 09     LDA $0902,X
00/C02A: 10 03        BPL $C02F
00/C02C: 4C CE C0     JMP $C0CE
00/C02F: A6 AF        LDX $AF
00/C031: BD FF 08     LDA $08FF,X
00/C034: 29 40        AND #$40
00/C036: F0 03        BEQ $C03B
00/C038: 4C CE C0     JMP $C0CE
00/C03B: BD 02 09     LDA $0902,X
00/C03E: 29 7F        AND #$7F
00/C040: D0 03        BNE $C045
00/C042: 4C CE C0     JMP $C0CE
00/C045: BD FF 08     LDA $08FF,X
00/C048: 29 03        AND #$03
00/C04A: F0 03        BEQ $C04F
00/C04C: 4C CE C0     JMP $C0CE
00/C04F: A6 AF        LDX $AF
00/C051: BD 00 09     LDA $0900,X
00/C054: D0 0E        BNE $C064       ; branch if npc is blocking player movement
00/C056: BD 01 09     LDA $0901,X     ; npc movement speed
00/C059: 29 C0        AND #$C0
00/C05B: 4A           LSR 
00/C05C: 4A           LSR 
00/C05D: 4A           LSR 
00/C05E: 4A           LSR 
00/C05F: 4A           LSR 
00/C060: 4A           LSR 
00/C061: 4C 66 C0     JMP $C066
00/C064: A9 02        LDA #$02        ; movement speed if blocking player
00/C066: A8           TAY 
00/C067: BD 02 09     LDA $0902,X     ; movement direction
00/C06A: 3A           DEC 
00/C06B: F0 09        BEQ $C076
00/C06D: 3A           DEC 
00/C06E: F0 1C        BEQ $C08C
00/C070: 3A           DEC 
00/C071: F0 2F        BEQ $C0A2
00/C073: 4C B8 C0     JMP $C0B8
; up
00/C076: BD 05 09     LDA $0905,X     ; decrease y offset
00/C079: 38           SEC 
00/C07A: F9 17 C1     SBC $C117,Y
00/C07D: 48           PHA 
00/C07E: 29 0F        AND #$0F
00/C080: 9D 05 09     STA $0905,X
00/C083: 68           PLA 
00/C084: 10 03        BPL $C089
00/C086: DE 06 09     DEC $0906,X
00/C089: 4C CE C0     JMP $C0CE
; right
00/C08C: BD 03 09     LDA $0903,X     ; increase x offset
00/C08F: 18           CLC 
00/C090: 79 17 C1     ADC $C117,Y
00/C093: 29 0F        AND #$0F
00/C095: 9D 03 09     STA $0903,X
00/C098: C9 00        CMP #$00
00/C09A: D0 03        BNE $C09F
00/C09C: FE 04 09     INC $0904,X
00/C09F: 4C CE C0     JMP $C0CE
; down
00/C0A2: BD 05 09     LDA $0905,X     ; increase y offset
00/C0A5: 18           CLC 
00/C0A6: 79 17 C1     ADC $C117,Y
00/C0A9: 29 0F        AND #$0F
00/C0AB: 9D 05 09     STA $0905,X
00/C0AE: C9 00        CMP #$00
00/C0B0: D0 03        BNE $C0B5
00/C0B2: FE 06 09     INC $0906,X
00/C0B5: 4C CE C0     JMP $C0CE
; left
00/C0B8: BD 03 09     LDA $0903,X     ; decrease x offset
00/C0BB: 38           SEC 
00/C0BC: F9 17 C1     SBC $C117,Y
00/C0BF: 48           PHA 
00/C0C0: 29 0F        AND #$0F
00/C0C2: 9D 03 09     STA $0903,X
00/C0C5: 68           PLA 
00/C0C6: 10 03        BPL $C0CB
00/C0C8: DE 04 09     DEC $0904,X
00/C0CB: 4C CE C0     JMP $C0CE
00/C0CE: BD 00 09     LDA $0900,X
00/C0D1: D0 0C        BNE $C0DF       ; branch if npc is blocking player movement
00/C0D3: BD 01 09     LDA $0901,X
00/C0D6: 4A           LSR 
00/C0D7: 4A           LSR 
00/C0D8: 4A           LSR 
00/C0D9: 4A           LSR 
00/C0DA: 4A           LSR 
00/C0DB: 4A           LSR 
00/C0DC: 4C E1 C0     JMP $C0E1
00/C0DF: A9 02        LDA #$02
00/C0E1: A8           TAY 
00/C0E2: BD FF 08     LDA $08FF,X
00/C0E5: 18           CLC 
00/C0E6: 79 1B C1     ADC $C11B,Y
00/C0E9: 9D FF 08     STA $08FF,X
00/C0EC: A5 B1        LDA $B1
00/C0EE: F0 10        BEQ $C100
00/C0F0: BD 08 09     LDA $0908,X
00/C0F3: F0 0B        BEQ $C100
00/C0F5: DD FF 08     CMP $08FF,X
00/C0F8: D0 06        BNE $C100
00/C0FA: 9E 08 09     STZ $0908,X
00/C0FD: 9E 02 09     STZ $0902,X     ; stop moving
00/C100: A5 AF        LDA $AF         ; next npc
00/C102: 18           CLC 
00/C103: 69 0F        ADC #$0F
00/C105: 85 AF        STA $AF
00/C107: E6 AE        INC $AE
00/C109: A5 AE        LDA $AE
00/C10B: CD FE 08     CMP $08FE
00/C10E: F0 03        BEQ $C113
00/C110: 4C 19 C0     JMP $C019
00/C113: EE FD 08     INC $08FD
00/C116: 60           RTS 

; constants for npc movement speeds
00/C117: 01 01 01 02
00/C11B: 01 02 04 08

; [ reload npcs ]

00/C11F: 64 AE        STZ $AE
00/C121: AE D1 09     LDX $09D1
00/C124: 8E CF 09     STX $09CF
00/C127: BF 00 83 13  LDA $138300,X
00/C12B: 20 6F C3     JSR $C36F       ; load npc graphics
00/C12E: AE CF 09     LDX $09CF
00/C131: E8           INX 
00/C132: E8           INX 
00/C133: E8           INX 
00/C134: E8           INX 
00/C135: 8E CF 09     STX $09CF
00/C138: E6 AE        INC $AE
00/C13A: A5 AE        LDA $AE
00/C13C: C9 0C        CMP #$0C
00/C13E: D0 E7        BNE $C127
00/C140: 60           RTS 

; [ init npcs ]

00/C141: 9C FD 08     STZ $08FD
00/C144: 20 ED C2     JSR $C2ED       ; clear npc map
00/C147: AD DE 0F     LDA $0FDE
00/C14A: 64 3E        STZ $3E
00/C14C: 0A           ASL 
00/C14D: 26 3E        ROL $3E
00/C14F: 85 3D        STA $3D
00/C151: AD E5 0F     LDA $0FE5
00/C154: 30 05        BMI $C15B
00/C156: AD 01 17     LDA $1701
00/C159: F0 04        BEQ $C15F
00/C15B: E6 3E        INC $3E
00/C15D: E6 3E        INC $3E
00/C15F: A6 3D        LDX $3D
00/C161: BF 00 80 13  LDA $138000,X
00/C165: 85 3D        STA $3D
00/C167: BF 01 80 13  LDA $138001,X
00/C16B: 85 3E        STA $3E
00/C16D: A6 3D        LDX $3D
00/C16F: 8E CF 09     STX $09CF
00/C172: 8E D1 09     STX $09D1
00/C175: 9C FE 08     STZ $08FE
00/C178: AE CF 09     LDX $09CF
00/C17B: BF 00 83 13  LDA $138300,X
00/C17F: F0 0A        BEQ $C18B
00/C181: EE FE 08     INC $08FE
00/C184: E8           INX 
00/C185: E8           INX 
00/C186: E8           INX 
00/C187: E8           INX 
00/C188: 4C 7B C1     JMP $C17B
00/C18B: AD FE 08     LDA $08FE
00/C18E: D0 01        BNE $C191
00/C190: 60           RTS 
00/C191: 64 AE        STZ $AE
00/C193: A2 00 00     LDX #$0000
00/C196: 86 AF        STX $AF
00/C198: AE CF 09     LDX $09CF
00/C19B: BF 00 83 13  LDA $138300,X
00/C19F: 20 6F C3     JSR $C36F       ; load npc graphics
00/C1A2: A5 06        LDA $06
00/C1A4: C9 2E        CMP #$2E
00/C1A6: B0 05        BCS $C1AD
00/C1A8: A9 00        LDA #$00
00/C1AA: 4C C1 C1     JMP $C1C1
00/C1AD: C9 30        CMP #$30
00/C1AF: B0 05        BCS $C1B6
00/C1B1: A9 03        LDA #$03
00/C1B3: 4C C1 C1     JMP $C1C1
00/C1B6: C9 46        CMP #$46
00/C1B8: B0 05        BCS $C1BF
00/C1BA: A9 02        LDA #$02
00/C1BC: 4C C1 C1     JMP $C1C1
00/C1BF: A9 01        LDA #$01
00/C1C1: 85 07        STA $07
00/C1C3: AE CF 09     LDX $09CF
00/C1C6: A4 AF        LDY $AF
00/C1C8: BF 03 83 13  LDA $138303,X
00/C1CC: 99 01 09     STA $0901,Y
00/C1CF: 29 03        AND #$03
00/C1D1: 99 09 09     STA $0909,Y
00/C1D4: 1A           INC 
00/C1D5: 99 02 09     STA $0902,Y
00/C1D8: B9 01 09     LDA $0901,Y
00/C1DB: 29 FC        AND #$FC
00/C1DD: 05 07        ORA $07
00/C1DF: 99 01 09     STA $0901,Y
00/C1E2: A5 06        LDA $06
00/C1E4: C9 0E        CMP #$0E
00/C1E6: B0 08        BCS $C1F0
00/C1E8: AA           TAX 
00/C1E9: BF FA B2 15  LDA $15B2FA,X   ; color palette for each character
00/C1ED: 4C FB C1     JMP $C1FB
00/C1F0: BF 03 83 13  LDA $138303,X
00/C1F4: 29 0C        AND #$0C
00/C1F6: 4A           LSR 
00/C1F7: 4A           LSR 
00/C1F8: 18           CLC 
00/C1F9: 69 04        ADC #$04
00/C1FB: 99 0D 09     STA $090D,Y
00/C1FE: AE CF 09     LDX $09CF
00/C201: BF 00 83 13  LDA $138300,X
00/C205: 99 07 09     STA $0907,Y
00/C208: BF 01 83 13  LDA $138301,X
00/C20C: 30 05        BMI $C213
00/C20E: A9 00        LDA #$00
00/C210: 99 02 09     STA $0902,Y
00/C213: BF 01 83 13  LDA $138301,X
00/C217: 29 3F        AND #$3F
00/C219: 99 04 09     STA $0904,Y
00/C21C: 85 0C        STA $0C
00/C21E: BF 02 83 13  LDA $138302,X
00/C222: 99 06 09     STA $0906,Y
00/C225: 85 0E        STA $0E
00/C227: B9 07 09     LDA $0907,Y
00/C22A: 20 EF C3     JSR $C3EF       ; check npc switch
00/C22D: 99 0B 09     STA $090B,Y
00/C230: C9 00        CMP #$00
00/C232: F0 03        BEQ $C237
00/C234: 20 45 C3     JSR $C345       ; set npc map position
00/C237: A9 00        LDA #$00
00/C239: 99 FF 08     STA $08FF,Y
00/C23C: 99 03 09     STA $0903,Y
00/C23F: 99 05 09     STA $0905,Y
00/C242: 99 00 09     STA $0900,Y
00/C245: 99 08 09     STA $0908,Y
00/C248: 99 0C 09     STA $090C,Y
00/C24B: B9 04 09     LDA $0904,Y
00/C24E: 85 3D        STA $3D
00/C250: B9 06 09     LDA $0906,Y
00/C253: 85 3E        STA $3E
00/C255: A6 3D        LDX $3D
00/C257: BF 71 5C 7F  LDA $7F5C71,X
00/C25B: 85 3D        STA $3D
00/C25D: 64 3E        STZ $3E
00/C25F: 06 3D        ASL $3D
00/C261: 26 3E        ROL $3E
00/C263: A6 3D        LDX $3D
00/C265: BD DC 0E     LDA $0EDC,X
00/C268: A6 AF        LDX $AF
00/C26A: 29 08        AND #$08
00/C26C: 9D 0A 09     STA $090A,X
00/C26F: AE CF 09     LDX $09CF
00/C272: E8           INX 
00/C273: E8           INX 
00/C274: E8           INX 
00/C275: E8           INX 
00/C276: 8E CF 09     STX $09CF
00/C279: A5 AF        LDA $AF
00/C27B: 18           CLC 
00/C27C: 69 0F        ADC #$0F
00/C27E: 85 AF        STA $AF
00/C280: E6 AE        INC $AE
00/C282: A5 AE        LDA $AE
00/C284: CD FE 08     CMP $08FE
00/C287: F0 03        BEQ $C28C
00/C289: 4C 98 C1     JMP $C198
00/C28C: A9 0C        LDA #$0C
00/C28E: 85 AE        STA $AE
00/C290: A9 18        LDA #$18
00/C292: 20 8B C3     JSR $C38B       ; load sprite graphics
00/C295: A9 1B        LDA #$1B
00/C297: E6 AE        INC $AE
00/C299: 20 8B C3     JSR $C38B       ; load sprite graphics
00/C29C: A9 1C        LDA #$1C
00/C29E: E6 AE        INC $AE
00/C2A0: 20 8B C3     JSR $C38B       ; load sprite graphics
00/C2A3: AD E1 0F     LDA $0FE1
00/C2A6: 29 0F        AND #$0F
00/C2A8: A0 00 00     LDY #$0000
00/C2AB: 20 BC C2     JSR $C2BC
00/C2AE: AD E1 0F     LDA $0FE1
00/C2B1: 4A           LSR 
00/C2B2: 4A           LSR 
00/C2B3: 4A           LSR 
00/C2B4: 4A           LSR 
00/C2B5: A0 40 00     LDY #$0040
00/C2B8: 20 BC C2     JSR $C2BC
00/C2BB: 60           RTS 

; [ load npc palette ]

00/C2BC: 85 3E        STA $3E
00/C2BE: 64 3D        STZ $3D
00/C2C0: 46 3E        LSR $3E
00/C2C2: 66 3D        ROR $3D
00/C2C4: 46 3E        LSR $3E
00/C2C6: 66 3D        ROR $3D
00/C2C8: 46 3E        LSR $3E
00/C2CA: 66 3D        ROR $3D
00/C2CC: A6 3D        LDX $3D
00/C2CE: BF D0 80 0D  LDA $0D80D0,X
00/C2D2: 99 5B 0E     STA $0E5B,Y
00/C2D5: E8           INX 
00/C2D6: C8           INY 
00/C2D7: 98           TYA 
00/C2D8: 29 0F        AND #$0F
00/C2DA: D0 F2        BNE $C2CE
00/C2DC: A9 00        LDA #$00
00/C2DE: 99 5B 0E     STA $0E5B,Y
00/C2E1: C8           INY 
00/C2E2: 98           TYA 
00/C2E3: 29 0F        AND #$0F
00/C2E5: D0 F5        BNE $C2DC
00/C2E7: 98           TYA 
00/C2E8: 29 3F        AND #$3F
00/C2EA: D0 E2        BNE $C2CE
00/C2EC: 60           RTS 

; [ clear npc map ]

00/C2ED: A2 00 00     LDX #$0000
00/C2F0: A9 00        LDA #$00
00/C2F2: 9F 00 4C 7F  STA $7F4C00,X
00/C2F6: E8           INX 
00/C2F7: E0 00 04     CPX #$0400
00/C2FA: D0 F6        BNE $C2F2
00/C2FC: 60           RTS 

; [ clear npc map position ]

00/C2FD: DA           PHX 
00/C2FE: 20 55 C3     JSR $C355       ; get pointer to npc map
00/C301: A6 3D        LDX $3D
00/C303: A9 00        LDA #$00
00/C305: 9F 00 4C 7F  STA $7F4C00,X
00/C309: FA           PLX 
00/C30A: 60           RTS 

; [ check npc map ]

; return 0 if no npc present or 1 if out of bounds

00/C30B: DA           PHX 
00/C30C: A5 0C        LDA $0C         ; x position
00/C30E: C9 20        CMP #$20
00/C310: B0 12        BCS $C324
00/C312: A5 0E        LDA $0E         ; y position
00/C314: C9 20        CMP #$20
00/C316: B0 0C        BCS $C324
00/C318: 20 55 C3     JSR $C355       ; get pointer to npc map
00/C31B: A6 3D        LDX $3D
00/C31D: BF 00 4C 7F  LDA $7F4C00,X
00/C321: 4C 26 C3     JMP $C326
00/C324: A9 01        LDA #$01        ; return 1 if out of bounds
00/C326: FA           PLX 
00/C327: 60           RTS 

; [ check npc map ]

; return 0 if out of bounds or no npc present

00/C328: DA           PHX 
00/C329: A5 0C        LDA $0C         ; x position
00/C32B: C9 20        CMP #$20
00/C32D: B0 12        BCS $C341
00/C32F: A5 0E        LDA $0E         ; y position
00/C331: C9 20        CMP #$20
00/C333: B0 0C        BCS $C341
00/C335: 20 55 C3     JSR $C355       ; get pointer to npc map
00/C338: A6 3D        LDX $3D
00/C33A: BF 00 4C 7F  LDA $7F4C00,X
00/C33E: 4C 43 C3     JMP $C343
00/C341: A9 00        LDA #$00        ; return 0 if out of bounds
00/C343: FA           PLX 
00/C344: 60           RTS 

; [ set npc map position ]

00/C345: DA           PHX 
00/C346: 20 55 C3     JSR $C355       ; get pointer to npc map
00/C349: A6 3D        LDX $3D
00/C34B: A5 AE        LDA $AE
00/C34D: 09 80        ORA #$80
00/C34F: 9F 00 4C 7F  STA $7F4C00,X
00/C353: FA           PLX 
00/C354: 60           RTS 

; [ get pointer to npc map ]

00/C355: A5 0E        LDA $0E
00/C357: 85 3E        STA $3E
00/C359: 64 3D        STZ $3D
00/C35B: 46 3E        LSR $3E
00/C35D: 66 3D        ROR $3D
00/C35F: 46 3E        LSR $3E
00/C361: 66 3D        ROR $3D
00/C363: 46 3E        LSR $3E
00/C365: 66 3D        ROR $3D
00/C367: A5 3D        LDA $3D
00/C369: 18           CLC 
00/C36A: 65 0C        ADC $0C
00/C36C: 85 3D        STA $3D
00/C36E: 60           RTS 

; [ load npc graphics ]

00/C36F: 85 3D        STA $3D
00/C371: 64 3E        STZ $3E
00/C373: AD E5 0F     LDA $0FE5
00/C376: 30 05        BMI $C37D
00/C378: AD 01 17     LDA $1701
00/C37B: F0 02        BEQ $C37F
00/C37D: E6 3E        INC $3E
00/C37F: A6 3D        LDX $3D
00/C381: BF 00 F0 12  LDA $12F000,X
00/C385: 85 06        STA $06
00/C387: 20 8B C3     JSR $C38B       ; load sprite graphics
00/C38A: 60           RTS 

; [ load sprite graphics ]

00/C38B: C9 11        CMP #$11
00/C38D: B0 09        BCS $C398
00/C38F: 0A           ASL 
00/C390: 0A           ASL 
00/C391: 0A           ASL 
00/C392: A2 00 00     LDX #$0000
00/C395: 4C BB C3     JMP $C3BB
00/C398: C9 30        CMP #$30
00/C39A: B0 0B        BCS $C3A7
00/C39C: 38           SEC 
00/C39D: E9 11        SBC #$11
00/C39F: 0A           ASL 
00/C3A0: 0A           ASL 
00/C3A1: A2 00 33     LDX #$3300
00/C3A4: 4C BB C3     JMP $C3BB
00/C3A7: C9 46        CMP #$46
00/C3A9: B0 0A        BCS $C3B5
00/C3AB: 38           SEC 
00/C3AC: E9 30        SBC #$30
00/C3AE: 0A           ASL 
00/C3AF: A2 80 61     LDX #$6180
00/C3B2: 4C BB C3     JMP $C3BB
00/C3B5: 38           SEC 
00/C3B6: E9 46        SBC #$46
00/C3B8: A2 00 72     LDX #$7200
00/C3BB: C2 20        REP #$20
00/C3BD: EB           XBA 
00/C3BE: 4A           LSR 
00/C3BF: 4A           LSR 
00/C3C0: 85 4A        STA $4A
00/C3C2: 4A           LSR 
00/C3C3: 18           CLC 
00/C3C4: 65 4A        ADC $4A
00/C3C6: 85 4A        STA $4A
00/C3C8: 8A           TXA 
00/C3C9: 18           CLC 
00/C3CA: 65 4A        ADC $4A
00/C3CC: 18           CLC 
00/C3CD: 69 00 80     ADC #$8000
00/C3D0: 85 4A        STA $4A
00/C3D2: A9 00 00     LDA #$0000
00/C3D5: E2 20        SEP #$20
00/C3D7: A5 AE        LDA $AE
00/C3D9: 0A           ASL 
00/C3DA: 18           CLC 
00/C3DB: 69 42        ADC #$42
00/C3DD: 85 4D        STA $4D
00/C3DF: 64 4C        STZ $4C
00/C3E1: A2 00 02     LDX #$0200
00/C3E4: 86 4E        STX $4E
00/C3E6: A9 1B        LDA #$1B
00/C3E8: 85 49        STA $49
00/C3EA: 22 00 B0 15  JSL $15B000     ; transfer 3bpp graphics to vram
00/C3EE: 60           RTS 

; [ check npc switch ]

00/C3EF: 5A           PHY 
00/C3F0: 48           PHA 
00/C3F1: 29 07        AND #$07
00/C3F3: 85 07        STA $07
00/C3F5: 68           PLA 
00/C3F6: 4A           LSR 
00/C3F7: 4A           LSR 
00/C3F8: 4A           LSR 
00/C3F9: 85 3D        STA $3D
00/C3FB: AD E5 0F     LDA $0FE5
00/C3FE: 30 05        BMI $C405
00/C400: AD 01 17     LDA $1701
00/C403: F0 07        BEQ $C40C
00/C405: A5 3D        LDA $3D
00/C407: 18           CLC 
00/C408: 69 20        ADC #$20
00/C40A: 85 3D        STA $3D
00/C40C: 64 3E        STZ $3E
00/C40E: A5 07        LDA $07
00/C410: A8           TAY 
00/C411: A6 3D        LDX $3D
00/C413: BF E0 12 00  LDA $0012E0,X   ; npc switches
00/C417: C0 00 00     CPY #$0000
00/C41A: F0 05        BEQ $C421
00/C41C: 4A           LSR 
00/C41D: 88           DEY 
00/C41E: 4C 17 C4     JMP $C417
00/C421: 4A           LSR 
00/C422: A9 00        LDA #$00
00/C424: 69 00        ADC #$00
00/C426: 7A           PLY 
00/C427: 60           RTS 

; [ random (0..255) ]

00/C428: DA           PHX 
00/C429: A5 78        LDA $78
00/C42B: AA           TAX 
00/C42C: BF 00 EE 14  LDA $14EE00,X   ; rng table
00/C430: E6 78        INC $78
00/C432: FA           PLX 
00/C433: 60           RTS 

; --------------------------------------------------------------------------

; [ event command $FD: special effect ]

00/C434: 20 53 E5     JSR $E553       ; get next event script byte
00/C437: 64 3E        STZ $3E
00/C439: 0A           ASL 
00/C43A: 26 3E        ROL $3E
00/C43C: 85 3D        STA $3D
00/C43E: A6 3D        LDX $3D
00/C440: BD 4D C4     LDA $C44D,X
00/C443: 85 3D        STA $3D
00/C445: BD 4E C4     LDA $C44E,X
00/C448: 85 3E        STA $3E
00/C44A: 6C 3D 06     JMP ($063D)

; special effect jump table
00/C44D: DAA3 DB01 D999 D5F6 D55B D3BF D9D6 D9DF  ; $00
00/C45D: D8AD D3F2 D350 D361 D851 D342 D4DC D1E4
00/C46D: D129 D042 DC0E DC39 DC62 DC04 DE68 DD88  ; $10
00/C47D: DDC2 CFF6 D00F D01F CFD0 CFC4 D831 CE76
00/C48D: C8DF C90D CAA5 CB1F CB9A CBF3 CCA5 CCF1  ; $20
00/C49D: CFE3 CE04 CF23 DCD2 DD05 C8BC C8B2 C8B8
00/C4AD: C88B D7AD C770 C710 C61D CE1B C5AD C570  ; $30
00/C4BD: C57E C58C D841 C530 C4FE C510 C520 C4CF
00/C4CD: CDB8                                     ; $40

; [ special effect $3F:  ]

00/C4CF: A2 00 00     LDX #$0000
00/C4D2: BD 00 10     LDA $1000,X
00/C4D5: 29 1F        AND #$1F
00/C4D7: C9 0B        CMP #$0B        ; find paladin cecil
00/C4D9: D0 08        BNE $C4E3
00/C4DB: 9E 03 10     STZ $1003,X     ; clear status 1
00/C4DE: A9 01        LDA #$01        ; set hp to 1
00/C4E0: 4C EA C4     JMP $C4EA
00/C4E3: A9 80        LDA #$80
00/C4E5: 9D 03 10     STA $1003,X     ; make all other characters dead
00/C4E8: A9 00        LDA #$00
00/C4EA: 9D 07 10     STA $1007,X
00/C4ED: 9E 08 10     STZ $1008,X
00/C4F0: 9E 04 10     STZ $1004,X     ; clear status 2
00/C4F3: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/C4F6: E0 40 01     CPX #$0140
00/C4F9: D0 D7        BNE $C4D2
00/C4FB: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $3C: soft reset ]

00/C4FE: A9 80        LDA #$80
00/C500: 8D 00 21     STA $2100       ; screen off
00/C503: A9 00        LDA #$00
00/C505: 8D 00 42     STA $4200       ; disable nmi
00/C508: A9 FF        LDA #$FF
00/C50A: 8D 40 21     STA $2140       ; reset spc program
00/C50D: 4C 00 80     JMP $8000

; [ special effect $3D: fade music to half volume ]

00/C510: 20 16 C5     JSR $C516       ; fade music to half volume
00/C513: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ fade music to half volume ]

00/C516: A9 87        LDA #$87        ; fade music to half volume
00/C518: 8D 00 1E     STA $1E00
00/C51B: 22 04 80 04  JSL $048004     ; execute sound command
00/C51F: 60           RTS 

; [ special effect $3E: fade in music ]

00/C520: 20 26 C5     JSR $C526       ; fade in music
00/C523: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ fade in music ]

00/C526: A9 89        LDA #$89        ; fade in music
00/C528: 8D 00 1E     STA $1E00
00/C52B: 22 04 80 04  JSL $048004     ; execute sound command
00/C52F: 60           RTS 

; [ special effect $3B:  ]

00/C530: 64 7B        STZ $7B         ; clear frame counters
00/C532: 64 7A        STZ $7A
00/C534: A2 64 00     LDX #$0064      ; 100 frames
00/C537: 86 89        STX $89
; start of frame loop
00/C539: 20 2D 91     JSR $912D       ; wait for vblank
00/C53C: A5 89        LDA $89
00/C53E: C9 40        CMP #$40
00/C540: B0 09        BCS $C54B
00/C542: 4A           LSR 
00/C543: 4A           LSR 
00/C544: 85 B7        STA $B7
00/C546: 18           CLC 
00/C547: 69 10        ADC #$10
00/C549: 85 AD        STA $AD
00/C54B: A9 01        LDA #$01        ; enable player control
00/C54D: 85 D5        STA $D5
00/C54F: 20 77 91     JSR $9177       ; reset all sprites
00/C552: A9 02        LDA #$02
00/C554: 85 05        STA $05
00/C556: 64 04        STZ $04
00/C558: A9 01        LDA #$01        ; enable player control
00/C55A: 85 D5        STA $D5
00/C55C: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/C55F: 20 71 A8     JSR $A871
00/C562: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/C566: A6 89        LDX $89
00/C568: CA           DEX 
00/C569: 86 89        STX $89
00/C56B: D0 CC        BNE $C539
00/C56D: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $37: solar system (prophecy) ]

00/C570: 20 EF 85     JSR $85EF       ; screen off
00/C573: 78           SEI 
00/C574: 22 F7 FF 13  JSL $13FFF7     ; solar system (prophecy)
00/C578: 20 9A C5     JSR $C59A
00/C57B: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $38: solar system (moon departs) ]

00/C57E: 20 EF 85     JSR $85EF       ; screen off
00/C581: 78           SEI 
00/C582: 22 FA FF 13  JSL $13FFFA     ; solar system (moon departs)
00/C586: 20 9A C5     JSR $C59A
00/C589: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $39: end credits ]

00/C58C: 20 EF 85     JSR $85EF       ; screen off
00/C58F: 78           SEI 
00/C590: 22 FD FF 13  JSL $13FFFD     ; end credits
00/C594: 20 9A C5     JSR $C59A
00/C597: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/C59A: 20 ED 89     JSR $89ED       ; init interrupt jump code
00/C59D: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/C5A1: 58           CLI 
00/C5A2: A9 00        LDA #$00
00/C5A4: 8D 00 21     STA $2100       ; screen on, zero brightness
00/C5A7: A9 81        LDA #$81
00/C5A9: 8D 00 42     STA $4200       ; enable nmi
00/C5AC: 60           RTS 

; [ special effect $36:  ]

00/C5AD: A9 10        LDA #$10
00/C5AF: 8D CF 0A     STA $0ACF
00/C5B2: A2 20 00     LDX #$0020
00/C5B5: 8E D2 0A     STX $0AD2
00/C5B8: A9 07        LDA #$07
00/C5BA: 8D CD 0A     STA $0ACD
00/C5BD: 9C CE 0A     STZ $0ACE
00/C5C0: A9 02        LDA #$02
00/C5C2: 8D D0 0A     STA $0AD0
00/C5C5: 8D D1 0A     STA $0AD1
00/C5C8: 20 75 E0     JSR $E075
00/C5CB: A9 01        LDA #$01
00/C5CD: 85 E3        STA $E3
00/C5CF: A9 23        LDA #$23
00/C5D1: 20 99 8D     JSR $8D99       ; play sound effect
00/C5D4: A2 C0 00     LDX #$00C0
00/C5D7: 86 89        STX $89
00/C5D9: 20 2D 91     JSR $912D       ; wait for vblank
00/C5DC: 20 77 91     JSR $9177       ; reset all sprites
00/C5DF: AD 07 17     LDA $1707
00/C5E2: 38           SEC 
00/C5E3: E9 10        SBC #$10
00/C5E5: AA           TAX 
00/C5E6: A5 7A        LDA $7A
00/C5E8: 4A           LSR 
00/C5E9: 4A           LSR 
00/C5EA: 4A           LSR 
00/C5EB: 4A           LSR 
00/C5EC: 29 01        AND #$01
00/C5EE: A8           TAY 
00/C5EF: BD 11 C6     LDA $C611,X
00/C5F2: 8D D4 0A     STA $0AD4
00/C5F5: B9 1B C6     LDA $C61B,Y
00/C5F8: 18           CLC 
00/C5F9: 7D 16 C6     ADC $C616,X
00/C5FC: 8D D5 0A     STA $0AD5
00/C5FF: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/C602: 20 C0 94     JSR $94C0       ; draw world map sprites
00/C605: A6 89        LDX $89
00/C607: CA           DEX 
00/C608: 86 89        STX $89
00/C60A: D0 CD        BNE $C5D9
00/C60C: 64 E3        STZ $E3
00/C60E: 4C 5B E3     JMP $E35B       ; wait for vblank

00/C611: 40 10 00 00 10

00/C616: A0 90 00 00 60

00/C61B: 00 A0

; [ special effect $34: telescope ]

00/C61D: 20 EF 85     JSR $85EF       ; screen off
00/C620: 20 53 A5     JSR $A553       ; load moon graphics (telescope)
00/C623: A9 22        LDA #$22
00/C625: 8D 23 21     STA $2123
00/C628: A9 00        LDA #$00
00/C62A: 8D 0C 42     STA $420C       ; disable hdma
00/C62D: A9 F7        LDA #$F7        ; 119 scanlines
00/C62F: 8F 00 5A 7F  STA $7F5A00
00/C633: A9 80        LDA #$80        ; 16/EB80 (telescope window hdma data)
00/C635: 8F 01 5A 7F  STA $7F5A01
00/C639: A9 EB        LDA #$EB
00/C63B: 8F 02 5A 7F  STA $7F5A02
00/C63F: A9 F7        LDA #$F7        ; 119 scanlines
00/C641: 8F 03 5A 7F  STA $7F5A03
00/C645: A9 78        LDA #$78        ; 16/EC78 (telescope window hdma data)
00/C647: 8F 04 5A 7F  STA $7F5A04
00/C64B: A9 EC        LDA #$EC
00/C64D: 8F 05 5A 7F  STA $7F5A05
00/C651: A9 00        LDA #$00        ; hdma table terminator
00/C653: 8F 06 5A 7F  STA $7F5A06
00/C657: A9 41        LDA #$41
00/C659: 8D 60 43     STA $4360
00/C65C: A9 26        LDA #$26
00/C65E: 8D 61 43     STA $4361
00/C661: A2 00 5A     LDX #$5A00      ; 7F/5A00 (hdma table)
00/C664: 8E 62 43     STX $4362
00/C667: A9 7F        LDA #$7F
00/C669: 8D 64 43     STA $4364
00/C66C: A9 16        LDA #$16
00/C66E: 8D 67 43     STA $4367
00/C671: A9 03        LDA #$03
00/C673: 8D 00 17     STA $1700
00/C676: A9 00        LDA #$00
00/C678: 8D 00 21     STA $2100       ; screen on, zero brightness
00/C67B: A9 81        LDA #$81
00/C67D: 8D 00 42     STA $4200       ; enable nmi
00/C680: 64 24        STZ $24
; start of fade in loop
00/C682: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C685: A9 40        LDA #$40
00/C687: 8D 0C 42     STA $420C       ; enable window hdma
00/C68A: A5 24        LDA $24
00/C68C: 8D 00 21     STA $2100       ; set screen brightness
00/C68F: 20 D7 C6     JSR $C6D7       ; draw telescope sprites
00/C692: E6 24        INC $24
00/C694: A5 24        LDA $24
00/C696: C9 10        CMP #$10
00/C698: D0 E8        BNE $C682
; start of frame loop
00/C69A: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C69D: A9 40        LDA #$40
00/C69F: 8D 0C 42     STA $420C       ; enable window hdma
00/C6A2: 20 D7 C6     JSR $C6D7       ; draw telescope sprites
00/C6A5: A5 02        LDA $02         ; wait for keypress
00/C6A7: D0 07        BNE $C6B0
00/C6A9: A5 03        LDA $03
00/C6AB: D0 03        BNE $C6B0
00/C6AD: 4C 9A C6     JMP $C69A
00/C6B0: A9 0F        LDA #$0F
00/C6B2: 85 24        STA $24
; start of fade out loop
00/C6B4: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C6B7: A9 40        LDA #$40
00/C6B9: 8D 0C 42     STA $420C       ; enable window hdma
00/C6BC: A5 24        LDA $24
00/C6BE: 8D 00 21     STA $2100       ; set screen brightness
00/C6C1: 20 D7 C6     JSR $C6D7       ; draw telescope sprites
00/C6C4: C6 24        DEC $24
00/C6C6: A5 24        LDA $24
00/C6C8: D0 EA        BNE $C6B4
00/C6CA: A9 33        LDA #$33
00/C6CC: 8D 23 21     STA $2123
00/C6CF: A9 00        LDA #$00
00/C6D1: 8D 0C 42     STA $420C       ; disable hdma
00/C6D4: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ draw telescope sprites ]

00/C6D7: 20 31 A5     JSR $A531
00/C6DA: A0 10 00     LDY #$0010
00/C6DD: A2 00 00     LDX #$0000
00/C6E0: 20 28 C4     JSR $C428       ; random (0..255)
00/C6E3: 4A           LSR 
00/C6E4: 18           CLC 
00/C6E5: 69 40        ADC #$40
00/C6E7: 99 00 03     STA $0300,Y
00/C6EA: 20 28 C4     JSR $C428       ; random (0..255)
00/C6ED: 4A           LSR 
00/C6EE: 18           CLC 
00/C6EF: 69 40        ADC #$40
00/C6F1: 99 01 03     STA $0301,Y
00/C6F4: A9 FF        LDA #$FF
00/C6F6: 99 02 03     STA $0302,Y
00/C6F9: 20 28 C4     JSR $C428       ; random (0..255)
00/C6FC: 29 07        AND #$07
00/C6FE: 0A           ASL 
00/C6FF: 09 01        ORA #$01
00/C701: 99 03 03     STA $0303,Y
00/C704: E8           INX 
00/C705: E8           INX 
00/C706: C8           INY 
00/C707: C8           INY 
00/C708: C8           INY 
00/C709: C8           INY 
00/C70A: C0 00 02     CPY #$0200
00/C70D: D0 D1        BNE $C6E0
00/C70F: 60           RTS 

; [ special effect $33: sight/dwarven bread ]

00/C710: 20 16 C5     JSR $C516       ; fade music to half volume
00/C713: A9 20        LDA #$20        ; 2x zoom
00/C715: 85 AD        STA $AD
00/C717: 20 77 91     JSR $9177       ; reset all sprites
00/C71A: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C71D: 9C 0C 42     STZ $420C
00/C720: E6 AD        INC $AD
00/C722: 20 BA 90     JSR $90BA       ; calculate mode 7 rotation parameters
00/C725: 20 04 91     JSR $9104       ; update mode 7 registers
00/C728: A5 AD        LDA $AD
00/C72A: 4A           LSR 
00/C72B: 4A           LSR 
00/C72C: 4A           LSR 
00/C72D: 1A           INC 
00/C72E: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/C732: A5 AD        LDA $AD
00/C734: C9 78        CMP #$78        ; 7.5x zoom
00/C736: D0 E2        BNE $C71A
00/C738: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C73B: 9C 0C 42     STZ $420C
00/C73E: 20 04 91     JSR $9104       ; update mode 7 registers
00/C741: A5 02        LDA $02
00/C743: D0 04        BNE $C749       ; wait for keypress
00/C745: A5 03        LDA $03
00/C747: F0 EF        BEQ $C738
00/C749: 20 26 C5     JSR $C526       ; fade in music
00/C74C: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C74F: 9C 0C 42     STZ $420C
00/C752: C6 AD        DEC $AD
00/C754: 20 BA 90     JSR $90BA       ; calculate mode 7 rotation parameters
00/C757: 20 04 91     JSR $9104       ; update mode 7 registers
00/C75A: A5 AD        LDA $AD
00/C75C: 4A           LSR 
00/C75D: 4A           LSR 
00/C75E: 4A           LSR 
00/C75F: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/C763: A5 AD        LDA $AD
00/C765: C9 20        CMP #$20        ; 2x zoom
00/C767: D0 E3        BNE $C74C
00/C769: A9 10        LDA #$10
00/C76B: 85 AD        STA $AD
00/C76D: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $32:  ]

00/C770: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/C774: A9 09        LDA #$09
00/C776: 8D 05 21     STA $2105
00/C779: A2 00 20     LDX #$2000
00/C77C: 86 47        STX $47
00/C77E: A2 00 10     LDX #$1000
00/C781: 86 45        STX $45
00/C783: A9 0A        LDA #$0A
00/C785: 85 3C        STA $3C
00/C787: A2 00 F0     LDX #$F000
00/C78A: 86 3D        STX $3D
00/C78C: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/C790: A9 80        LDA #$80
00/C792: 8D 15 21     STA $2115
00/C795: A2 00 2C     LDX #$2C00
00/C798: 8E 16 21     STX $2116
00/C79B: A2 00 04     LDX #$0400
00/C79E: A9 FF        LDA #$FF
00/C7A0: 8D 18 21     STA $2118
00/C7A3: A9 20        LDA #$20
00/C7A5: 8D 19 21     STA $2119
00/C7A8: CA           DEX 
00/C7A9: D0 F3        BNE $C79E
00/C7AB: A9 6A        LDA #$6A
00/C7AD: 85 B2        STA $B2
00/C7AF: 20 1B B4     JSR $B41B       ; get pointer to event dialogue (bank 1 high)
00/C7B2: 64 BA        STZ $BA
00/C7B4: 20 59 B4     JSR $B459       ; decode dialogue text
00/C7B7: E6 ED        INC $ED
00/C7B9: 20 0D B8     JSR $B80D       ; transfer dialogue text to vram
00/C7BC: 20 59 B4     JSR $B459       ; decode dialogue text
00/C7BF: E6 ED        INC $ED
00/C7C1: 20 0D B8     JSR $B80D       ; transfer dialogue text to vram
00/C7C4: 64 DD        STZ $DD
00/C7C6: 64 ED        STZ $ED
00/C7C8: A9 80        LDA #$80
00/C7CA: 8D 15 21     STA $2115
00/C7CD: A2 00 2C     LDX #$2C00
00/C7D0: 8E 16 21     STX $2116
00/C7D3: A2 00 00     LDX #$0000
00/C7D6: C2 20        REP #$20
00/C7D8: 8A           TXA 
00/C7D9: 29 C0 01     AND #$01C0
00/C7DC: 4A           LSR 
00/C7DD: 4A           LSR 
00/C7DE: 4A           LSR 
00/C7DF: 4A           LSR 
00/C7E0: 09 20 00     ORA #$0020
00/C7E3: E2 20        SEP #$20
00/C7E5: 8D 19 21     STA $2119
00/C7E8: E8           INX 
00/C7E9: E0 00 02     CPX #$0200
00/C7EC: D0 E8        BNE $C7D6
00/C7EE: A9 00        LDA #$00
00/C7F0: EB           XBA 
00/C7F1: A2 00 00     LDX #$0000
00/C7F4: A9 00        LDA #$00
00/C7F6: 9D DD 0C     STA $0CDD,X
00/C7F9: 9D E1 0C     STA $0CE1,X
00/C7FC: A9 40        LDA #$40
00/C7FE: 9D DE 0C     STA $0CDE,X
00/C801: 9D E2 0C     STA $0CE2,X
00/C804: 8A           TXA 
00/C805: 18           CLC 
00/C806: 69 08        ADC #$08
00/C808: AA           TAX 
00/C809: C9 40        CMP #$40
00/C80B: D0 E7        BNE $C7F4
00/C80D: A9 00        LDA #$00
00/C80F: 8D 11 21     STA $2111
00/C812: A9 01        LDA #$01
00/C814: 8D 11 21     STA $2111
00/C817: A9 C8        LDA #$C8
00/C819: 8D 12 21     STA $2112
00/C81C: A9 FF        LDA #$FF
00/C81E: 8D 12 21     STA $2112
00/C821: A9 81        LDA #$81
00/C823: 8D 00 42     STA $4200       ; enable nmi
00/C826: A9 03        LDA #$03
00/C828: 20 B0 8D     JSR $8DB0       ; fade in
00/C82B: 64 2E        STZ $2E
00/C82D: 64 2F        STZ $2F
00/C82F: 64 20        STZ $20
00/C831: 64 21        STZ $21
00/C833: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/C836: A5 2E        LDA $2E
00/C838: 0A           ASL 
00/C839: AA           TAX 
00/C83A: C2 20        REP #$20
00/C83C: A5 20        LDA $20
00/C83E: 4A           LSR 
00/C83F: 4A           LSR 
00/C840: 4A           LSR 
00/C841: 85 22        STA $22
00/C843: 0A           ASL 
00/C844: 0A           ASL 
00/C845: 0A           ASL 
00/C846: 0A           ASL 
00/C847: 0A           ASL 
00/C848: 05 22        ORA $22
00/C84A: 1F 96 F9 14  ORA $14F996,X
00/C84E: 85 22        STA $22
00/C850: 8A           TXA 
00/C851: 0A           ASL 
00/C852: 0A           ASL 
00/C853: AA           TAX 
00/C854: A5 22        LDA $22
00/C856: 9D E1 0C     STA $0CE1,X
00/C859: A9 00 00     LDA #$0000
00/C85C: E2 20        SEP #$20
00/C85E: E6 20        INC $20
00/C860: D0 D1        BNE $C833
00/C862: E6 2E        INC $2E
00/C864: A5 2E        LDA $2E
00/C866: C9 08        CMP #$08
00/C868: D0 C5        BNE $C82F
00/C86A: A9 03        LDA #$03
00/C86C: 20 D1 8D     JSR $8DD1       ; fade out
00/C86F: 9C 11 21     STZ $2111
00/C872: 9C 11 21     STZ $2111
00/C875: 9C 12 21     STZ $2112
00/C878: 9C 12 21     STZ $2112
00/C87B: 22 26 C2 15  JSL $15C226     ; load text window palette
00/C87F: 22 F9 C1 15  JSL $15C1F9     ; load map palette
00/C883: A9 81        LDA #$81
00/C885: 8D 00 42     STA $4200       ; enable nmi
00/C888: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $30:  ]

00/C88B: A2 13 27     LDX #$2713
00/C88E: 8E 0C 17     STX $170C
00/C891: A9 00        LDA #$00
00/C893: 8D 00 17     STA $1700
00/C896: A9 01        LDA #$01
00/C898: 85 C3        STA $C3
00/C89A: 20 FF A2     JSR $A2FF       ; board big whale
00/C89D: A9 FF        LDA #$FF
00/C89F: 85 A2        STA $A2
00/C8A1: 20 E2 A7     JSR $A7E2
00/C8A4: A9 02        LDA #$02        ; big whale is on the moon
00/C8A6: 8D 27 17     STA $1727
00/C8A9: A2 13 27     LDX #$2713      ; big whale position
00/C8AC: 8E 25 17     STX $1725
00/C8AF: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $2E: hide enterprise ]

00/C8B2: 9C 1C 17     STZ $171C
00/C8B5: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $2F:  ]

00/C8B8: A9 01        LDA #$01
00/C8BA: 85 C3        STA $C3
; fallthrough

; [ special effect $2D:  ]

00/C8BC: A2 00 00     LDX #$0000
00/C8BF: 8E 2C 17     STX $172C
00/C8C2: A9 06        LDA #$06
00/C8C4: 8D 04 17     STA $1704
00/C8C7: A9 03        LDA #$03
00/C8C9: 85 AC        STA $AC
00/C8CB: 64 E1        STZ $E1
00/C8CD: AE 25 17     LDX $1725
00/C8D0: 8E 06 17     STX $1706
00/C8D3: AD 27 17     LDA $1727
00/C8D6: 20 67 F1     JSR $F167
00/C8D9: 20 FF A2     JSR $A2FF       ; board big whale
00/C8DC: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $20:  ]

00/C8DF: A2 28 E8     LDX #$E828
00/C8E2: 8E 08 17     STX $1708
00/C8E5: AE 25 17     LDX $1725
00/C8E8: 8E 06 17     STX $1706
00/C8EB: AD 27 17     LDA $1727
00/C8EE: 20 67 F1     JSR $F167
00/C8F1: A9 01        LDA #$01
00/C8F3: 85 C3        STA $C3
00/C8F5: 20 FF A2     JSR $A2FF       ; board big whale
00/C8F8: A9 FF        LDA #$FF
00/C8FA: 85 A2        STA $A2
00/C8FC: 20 E2 A7     JSR $A7E2
00/C8FF: A9 01        LDA #$01
00/C901: 8D C8 06     STA $06C8
00/C904: A2 28 E8     LDX #$E828
00/C907: 8E 25 17     STX $1725
00/C90A: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $21:  ]

00/C90D: 9C 04 17     STZ $1704
00/C910: 64 20        STZ $20
00/C912: 64 24        STZ $24
00/C914: 20 5E C9     JSR $C95E
00/C917: 20 2D 91     JSR $912D       ; wait for vblank
00/C91A: 20 77 91     JSR $9177       ; reset all sprites
00/C91D: 20 94 DA     JSR $DA94
00/C920: E6 20        INC $20
00/C922: A5 24        LDA $24
00/C924: 18           CLC 
00/C925: 65 20        ADC $20
00/C927: 85 24        STA $24
00/C929: 90 0E        BCC $C939
00/C92B: A2 00 00     LDX #$0000
00/C92E: A9 60        LDA #$60
00/C930: 85 0C        STA $0C
00/C932: A9 50        LDA #$50
00/C934: 85 0E        STA $0E
00/C936: 20 8A CD     JSR $CD8A
00/C939: A5 20        LDA $20
00/C93B: C9 FF        CMP #$FF
00/C93D: D0 D8        BNE $C917
00/C93F: 20 72 CD     JSR $CD72
00/C942: AD 88 12     LDA $1288
00/C945: 29 FB        AND #$FB
00/C947: 8D 88 12     STA $1288
00/C94A: A2 03 00     LDX #$0003
00/C94D: DA           PHX 
00/C94E: 20 0F CA     JSR $CA0F
00/C951: 20 70 C9     JSR $C970
00/C954: 20 14 EA     JSR $EA14
00/C957: FA           PLX 
00/C958: CA           DEX 
00/C959: D0 F2        BNE $C94D
00/C95B: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/C95E: A2 00 00     LDX #$0000
00/C961: A9 FF        LDA #$FF        ; white ???
00/C963: 9D 1B 0E     STA $0E1B,X     ; sprite palette 2
00/C966: 9D 3B 0E     STA $0E3B,X     ; sprite palette 3
00/C969: E8           INX 
00/C96A: E0 10 00     CPX #$0010      ; 8 colors
00/C96D: D0 F2        BNE $C961
00/C96F: 60           RTS 

; [  ]

00/C970: A9 01        LDA #$01
00/C972: 85 C7        STA $C7
00/C974: A2 30 00     LDX #$0030
00/C977: A9 60        LDA #$60
00/C979: 85 0C        STA $0C
00/C97B: A9 50        LDA #$50
00/C97D: 85 0E        STA $0E
00/C97F: 20 8A CD     JSR $CD8A
00/C982: A9 CF        LDA #$CF
00/C984: 20 CF E9     JSR $E9CF
00/C987: 20 5E C9     JSR $C95E
00/C98A: A2 20 00     LDX #$0020
00/C98D: 20 DE E1     JSR $E1DE       ; wait
00/C990: 20 72 CD     JSR $CD72
00/C993: A9 10        LDA #$10
00/C995: 8D CF 0A     STA $0ACF
00/C998: A2 24 00     LDX #$0024
00/C99B: 8E D2 0A     STX $0AD2
00/C99E: 9C CD 0A     STZ $0ACD
00/C9A1: 9C CE 0A     STZ $0ACE
00/C9A4: A9 70        LDA #$70
00/C9A6: 8D D4 0A     STA $0AD4
00/C9A9: 8D D5 0A     STA $0AD5
00/C9AC: 20 75 E0     JSR $E075
00/C9AF: A9 23        LDA #$23
00/C9B1: 20 99 8D     JSR $8D99       ; play sound effect
00/C9B4: A9 01        LDA #$01
00/C9B6: 85 E3        STA $E3
00/C9B8: 20 2D 91     JSR $912D       ; wait for vblank
00/C9BB: 20 77 91     JSR $9177       ; reset all sprites
00/C9BE: 20 94 DA     JSR $DA94
00/C9C1: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/C9C4: A2 30 00     LDX #$0030
00/C9C7: A9 60        LDA #$60
00/C9C9: 85 0C        STA $0C
00/C9CB: A9 50        LDA #$50
00/C9CD: 85 0E        STA $0E
00/C9CF: 20 8A CD     JSR $CD8A
00/C9D2: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/C9D6: AE D2 0A     LDX $0AD2
00/C9D9: E0 04 00     CPX #$0004
00/C9DC: D0 04        BNE $C9E2
00/C9DE: A9 01        LDA #$01
00/C9E0: 85 E5        STA $E5
00/C9E2: E0 00 00     CPX #$0000
00/C9E5: D0 D1        BNE $C9B8
00/C9E7: 64 E3        STZ $E3
00/C9E9: 20 72 CD     JSR $CD72
00/C9EC: 64 C7        STZ $C7
00/C9EE: 60           RTS 

; xy points on a circle with radius 60 (signed)
;   (0,60) (55,23) (42,42) (23,55) ...

00/C9EF: 00 C4 17 C9 2A D6 37 E9 3C 00 37 17 2A 2A 17 37
00/C9FF: 00 3C E9 37 D6 2A C9 17 C4 00 C9 E9 D6 D6 E9 C9

; [  ]

00/CA0F: 64 20        STZ $20
00/CA11: 64 24        STZ $24
00/CA13: 64 7A        STZ $7A
00/CA15: 20 2D 91     JSR $912D       ; wait for vblank
00/CA18: A5 20        LDA $20
00/CA1A: F0 1C        BEQ $CA38
00/CA1C: C6 20        DEC $20
00/CA1E: A5 20        LDA $20
00/CA20: 29 01        AND #$01
00/CA22: F0 14        BEQ $CA38
00/CA24: A5 20        LDA $20
00/CA26: 4A           LSR 
00/CA27: 85 22        STA $22
00/CA29: A5 5C        LDA $5C
00/CA2B: 18           CLC 
00/CA2C: 65 22        ADC $22
00/CA2E: 8D 0E 21     STA $210E
00/CA31: A5 5D        LDA $5D
00/CA33: 69 00        ADC #$00
00/CA35: 8D 0E 21     STA $210E
00/CA38: A5 7A        LDA $7A
00/CA3A: 29 7F        AND #$7F
00/CA3C: D0 11        BNE $CA4F
00/CA3E: E6 24        INC $24
00/CA40: A5 24        LDA $24
00/CA42: C9 03        CMP #$03
00/CA44: F0 5E        BEQ $CAA4
00/CA46: A9 04        LDA #$04
00/CA48: 85 05        STA $05
00/CA4A: 64 04        STZ $04
00/CA4C: 4C 59 CA     JMP $CA59
00/CA4F: A5 7A        LDA $7A
00/CA51: 29 0F        AND #$0F
00/CA53: D0 04        BNE $CA59
00/CA55: 64 05        STZ $05
00/CA57: 64 04        STZ $04
00/CA59: 20 77 91     JSR $9177       ; reset all sprites
00/CA5C: 20 94 DA     JSR $DA94
00/CA5F: A9 01        LDA #$01        ; enable player control
00/CA61: 85 D5        STA $D5
00/CA63: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/CA66: 20 71 A8     JSR $A871
00/CA69: A5 5C        LDA $5C
00/CA6B: 18           CLC 
00/CA6C: 69 0F        ADC #$0F
00/CA6E: 29 10        AND #$10
00/CA70: D0 06        BNE $CA78
00/CA72: A2 00 00     LDX #$0000
00/CA75: 4C 7B CA     JMP $CA7B
00/CA78: A2 18 00     LDX #$0018
00/CA7B: A9 60        LDA #$60
00/CA7D: 85 0C        STA $0C
00/CA7F: A9 50        LDA #$50
00/CA81: 85 0E        STA $0E
00/CA83: 20 8A CD     JSR $CD8A
00/CA86: A5 5C        LDA $5C
00/CA88: 29 0F        AND #$0F
00/CA8A: C9 0F        CMP #$0F
00/CA8C: D0 05        BNE $CA93
00/CA8E: A9 48        LDA #$48
00/CA90: 20 99 8D     JSR $8D99       ; play sound effect
00/CA93: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/CA97: A5 7A        LDA $7A
00/CA99: 29 7F        AND #$7F
00/CA9B: D0 04        BNE $CAA1
00/CA9D: A9 20        LDA #$20
00/CA9F: 85 20        STA $20
00/CAA1: 4C 15 CA     JMP $CA15
00/CAA4: 60           RTS 

; [ special effect $22:  ]

00/CAA5: A2 30 00     LDX #$0030
00/CAA8: 86 EF        STX $EF
00/CAAA: A2 E0 00     LDX #$00E0
00/CAAD: 86 F1        STX $F1
00/CAAF: A2 00 01     LDX #$0100
00/CAB2: 86 F3        STX $F3
00/CAB4: A2 E0 FF     LDX #$FFE0
00/CAB7: 86 F5        STX $F5
00/CAB9: 20 72 CB     JSR $CB72
00/CABC: A2 40 01     LDX #$0140
00/CABF: 86 89        STX $89
00/CAC1: 20 2D 91     JSR $912D       ; wait for vblank
00/CAC4: A6 89        LDX $89
00/CAC6: E0 C0 00     CPX #$00C0
00/CAC9: D0 05        BNE $CAD0
00/CACB: A9 2C        LDA #$2C
00/CACD: 20 EA E7     JSR $E7EA
00/CAD0: 20 77 91     JSR $9177       ; reset all sprites
00/CAD3: A6 89        LDX $89
00/CAD5: E0 C0 00     CPX #$00C0
00/CAD8: B0 0B        BCS $CAE5
00/CADA: A5 7A        LDA $7A
00/CADC: 29 03        AND #$03
00/CADE: D0 18        BNE $CAF8
00/CAE0: C6 F1        DEC $F1
00/CAE2: 4C F8 CA     JMP $CAF8
00/CAE5: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/CAE8: A6 89        LDX $89
00/CAEA: E0 38 01     CPX #$0138
00/CAED: D0 09        BNE $CAF8
00/CAEF: A9 23        LDA #$23
00/CAF1: 20 99 8D     JSR $8D99       ; play sound effect
00/CAF4: A9 01        LDA #$01
00/CAF6: 85 E5        STA $E5
00/CAF8: 20 40 CD     JSR $CD40
00/CAFB: A6 89        LDX $89
00/CAFD: CA           DEX 
00/CAFE: 86 89        STX $89
00/CB00: D0 BF        BNE $CAC1
00/CB02: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/CB05: 64 79        STZ $79
00/CB07: A5 79        LDA $79
00/CB09: 18           CLC 
00/CB0A: 69 04        ADC #$04
00/CB0C: 0A           ASL 
00/CB0D: A8           TAY 
00/CB0E: 20 93 DF     JSR $DF93
00/CB11: 64 92        STZ $92
00/CB13: 20 C4 DF     JSR $DFC4
00/CB16: E6 79        INC $79
00/CB18: A5 79        LDA $79
00/CB1A: C9 04        CMP #$04
00/CB1C: D0 E9        BNE $CB07
00/CB1E: 60           RTS 

; [ special effect $23:  ]

00/CB1F: A2 30 00     LDX #$0030
00/CB22: 86 EF        STX $EF
00/CB24: A2 B0 00     LDX #$00B0
00/CB27: 86 F1        STX $F1
00/CB29: A2 00 01     LDX #$0100
00/CB2C: 86 F3        STX $F3
00/CB2E: A2 E0 FF     LDX #$FFE0
00/CB31: 86 F5        STX $F5
00/CB33: 20 72 CB     JSR $CB72
00/CB36: A2 C0 01     LDX #$01C0
00/CB39: 86 89        STX $89
00/CB3B: 20 2D 91     JSR $912D       ; wait for vblank
00/CB3E: 20 77 91     JSR $9177       ; reset all sprites
00/CB41: A6 89        LDX $89
00/CB43: E0 40 01     CPX #$0140
00/CB46: B0 0E        BCS $CB56
00/CB48: A5 7A        LDA $7A
00/CB4A: 29 03        AND #$03
00/CB4C: D0 17        BNE $CB65
00/CB4E: A6 F3        LDX $F3
00/CB50: CA           DEX 
00/CB51: 86 F3        STX $F3
00/CB53: 4C 65 CB     JMP $CB65
00/CB56: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/CB59: A6 89        LDX $89
00/CB5B: E0 B8 01     CPX #$01B8
00/CB5E: D0 05        BNE $CB65
00/CB60: A9 23        LDA #$23
00/CB62: 20 99 8D     JSR $8D99       ; play sound effect
00/CB65: 20 40 CD     JSR $CD40
00/CB68: A6 89        LDX $89
00/CB6A: CA           DEX 
00/CB6B: 86 89        STX $89
00/CB6D: D0 CC        BNE $CB3B
00/CB6F: 4C 5B E3     JMP $E35B       ; wait for vblank
00/CB72: 20 72 CD     JSR $CD72
00/CB75: A9 08        LDA #$08
00/CB77: 8D CF 0A     STA $0ACF
00/CB7A: A2 10 00     LDX #$0010
00/CB7D: 8E D2 0A     STX $0AD2
00/CB80: 9C CD 0A     STZ $0ACD
00/CB83: 9C CE 0A     STZ $0ACE
00/CB86: A9 02        LDA #$02
00/CB88: 8D D0 0A     STA $0AD0
00/CB8B: 8D D1 0A     STA $0AD1
00/CB8E: A9 60        LDA #$60
00/CB90: 8D D4 0A     STA $0AD4
00/CB93: 8D D5 0A     STA $0AD5
00/CB96: 20 75 E0     JSR $E075
00/CB99: 60           RTS 

; [ special effect $24:  ]

00/CB9A: 20 3D CC     JSR $CC3D
00/CB9D: A2 00 02     LDX #$0200
00/CBA0: 86 89        STX $89
00/CBA2: 20 2D 91     JSR $912D       ; wait for vblank
00/CBA5: 20 77 91     JSR $9177       ; reset all sprites
00/CBA8: A5 7A        LDA $7A
00/CBAA: 4A           LSR 
00/CBAB: 4A           LSR 
00/CBAC: 4A           LSR 
00/CBAD: 29 06        AND #$06
00/CBAF: A8           TAY 
00/CBB0: B9 E3 CB     LDA $CBE3,Y
00/CBB3: 8D D4 0A     STA $0AD4
00/CBB6: B9 E4 CB     LDA $CBE4,Y
00/CBB9: 8D D5 0A     STA $0AD5
00/CBBC: B9 EB CB     LDA $CBEB,Y
00/CBBF: 8D D0 0A     STA $0AD0
00/CBC2: B9 EC CB     LDA $CBEC,Y
00/CBC5: 8D D1 0A     STA $0AD1
00/CBC8: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/CBCB: 20 40 CD     JSR $CD40
00/CBCE: A5 89        LDA $89
00/CBD0: 29 3F        AND #$3F
00/CBD2: D0 05        BNE $CBD9
00/CBD4: A9 23        LDA #$23
00/CBD6: 20 99 8D     JSR $8D99       ; play sound effect
00/CBD9: A6 89        LDX $89
00/CBDB: CA           DEX 
00/CBDC: 86 89        STX $89
00/CBDE: D0 C2        BNE $CBA2
00/CBE0: 4C 5B E3     JMP $E35B       ; wait for vblank

00/CBE3: 70 58 C0 40 70 58 60

00/CBEA: B0 02 02 02 01 02 02 01 02

; [ special effect $25:  ]

00/CBF3: 20 3D CC     JSR $CC3D
00/CBF6: A2 00 00     LDX #$0000
00/CBF9: 86 89        STX $89
00/CBFB: 64 7A        STZ $7A
00/CBFD: 20 68 CD     JSR $CD68
00/CC00: 64 28        STZ $28
00/CC02: A5 89        LDA $89
00/CC04: 85 29        STA $29
00/CC06: 85 2B        STA $2B
00/CC08: 20 69 CC     JSR $CC69
00/CC0B: A6 89        LDX $89
00/CC0D: E8           INX 
00/CC0E: 86 89        STX $89
00/CC10: E0 20 00     CPX #$0020
00/CC13: D0 E8        BNE $CBFD
00/CC15: A2 00 00     LDX #$0000
00/CC18: 86 89        STX $89
00/CC1A: 64 7A        STZ $7A
00/CC1C: 20 68 CD     JSR $CD68
00/CC1F: 64 28        STZ $28
00/CC21: A5 89        LDA $89
00/CC23: 4A           LSR 
00/CC24: 18           CLC 
00/CC25: 69 20        ADC #$20
00/CC27: 85 29        STA $29
00/CC29: A9 20        LDA #$20
00/CC2B: 85 2B        STA $2B
00/CC2D: 20 69 CC     JSR $CC69
00/CC30: A6 89        LDX $89
00/CC32: E8           INX 
00/CC33: 86 89        STX $89
00/CC35: E0 20 00     CPX #$0020
00/CC38: D0 E2        BNE $CC1C
00/CC3A: 4C 5B E3     JMP $E35B       ; wait for vblank
00/CC3D: A9 10        LDA #$10
00/CC3F: 8D CF 0A     STA $0ACF
00/CC42: A2 10 00     LDX #$0010
00/CC45: 8E D2 0A     STX $0AD2
00/CC48: 9C CD 0A     STZ $0ACD
00/CC4B: 9C CE 0A     STZ $0ACE
00/CC4E: 20 75 E0     JSR $E075
00/CC51: 20 72 CD     JSR $CD72
00/CC54: A2 30 00     LDX #$0030
00/CC57: 86 EF        STX $EF
00/CC59: A2 B0 00     LDX #$00B0
00/CC5C: 86 F1        STX $F1
00/CC5E: A2 B0 00     LDX #$00B0
00/CC61: 86 F3        STX $F3
00/CC63: A2 E0 FF     LDX #$FFE0
00/CC66: 86 F5        STX $F5
00/CC68: 60           RTS 
00/CC69: A0 00 00     LDY #$0000
00/CC6C: B9 B0 03     LDA $03B0,Y
00/CC6F: 18           CLC 
00/CC70: 65 28        ADC $28
00/CC72: 99 B0 03     STA $03B0,Y
00/CC75: B9 B1 03     LDA $03B1,Y
00/CC78: 18           CLC 
00/CC79: 65 29        ADC $29
00/CC7B: 99 B1 03     STA $03B1,Y
00/CC7E: A5 7A        LDA $7A
00/CC80: 29 01        AND #$01
00/CC82: D0 17        BNE $CC9B
00/CC84: C0 08 00     CPY #$0008
00/CC87: B0 12        BCS $CC9B
00/CC89: B9 10 04     LDA $0410,Y
00/CC8C: 18           CLC 
00/CC8D: 65 28        ADC $28
00/CC8F: 99 10 04     STA $0410,Y
00/CC92: B9 11 04     LDA $0411,Y
00/CC95: 18           CLC 
00/CC96: 65 2B        ADC $2B
00/CC98: 99 11 04     STA $0411,Y
00/CC9B: C8           INY 
00/CC9C: C8           INY 
00/CC9D: C8           INY 
00/CC9E: C8           INY 
00/CC9F: C0 10 00     CPY #$0010
00/CCA2: D0 C8        BNE $CC6C
00/CCA4: 60           RTS 

; [ special effect $26:  ]

00/CCA5: 20 3D CC     JSR $CC3D
00/CCA8: A2 20 00     LDX #$0020
00/CCAB: 86 89        STX $89
00/CCAD: 64 7A        STZ $7A
00/CCAF: 20 68 CD     JSR $CD68
00/CCB2: 64 28        STZ $28
00/CCB4: A5 89        LDA $89
00/CCB6: 4A           LSR 
00/CCB7: 18           CLC 
00/CCB8: 69 20        ADC #$20
00/CCBA: 85 29        STA $29
00/CCBC: A9 20        LDA #$20
00/CCBE: 85 2B        STA $2B
00/CCC0: 20 69 CC     JSR $CC69
00/CCC3: A6 89        LDX $89
00/CCC5: CA           DEX 
00/CCC6: 86 89        STX $89
00/CCC8: D0 E5        BNE $CCAF
00/CCCA: A2 00 00     LDX #$0000
00/CCCD: 86 89        STX $89
00/CCCF: 64 7A        STZ $7A
00/CCD1: 20 68 CD     JSR $CD68
00/CCD4: A9 00        LDA #$00
00/CCD6: 38           SEC 
00/CCD7: E5 89        SBC $89
00/CCD9: 85 28        STA $28
00/CCDB: A9 20        LDA #$20
00/CCDD: 85 29        STA $29
00/CCDF: 85 2B        STA $2B
00/CCE1: 20 69 CC     JSR $CC69
00/CCE4: A6 89        LDX $89
00/CCE6: E8           INX 
00/CCE7: 86 89        STX $89
00/CCE9: E0 60 00     CPX #$0060
00/CCEC: D0 E3        BNE $CCD1
00/CCEE: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $27:  ]

00/CCF1: 20 3D CC     JSR $CC3D
00/CCF4: A2 30 00     LDX #$0030
00/CCF7: 86 89        STX $89
00/CCF9: 64 7A        STZ $7A
00/CCFB: 20 2D 91     JSR $912D       ; wait for vblank
00/CCFE: A5 89        LDA $89
00/CD00: C9 10        CMP #$10
00/CD02: B0 03        BCS $CD07
00/CD04: 8D 00 21     STA $2100       ; set screen brightness
00/CD07: 20 77 91     JSR $9177       ; reset all sprites
00/CD0A: 20 40 CD     JSR $CD40
00/CD0D: A9 68        LDA #$68
00/CD0F: 85 0C        STA $0C
00/CD11: A5 89        LDA $89
00/CD13: 18           CLC 
00/CD14: 69 80        ADC #$80
00/CD16: 85 0E        STA $0E
00/CD18: A9 18        LDA #$18
00/CD1A: 85 91        STA $91
00/CD1C: A9 78        LDA #$78
00/CD1E: 85 8F        STA $8F
00/CD20: A0 B0 00     LDY #$00B0
00/CD23: A9 00        LDA #$00
00/CD25: 85 92        STA $92
00/CD27: 20 C4 DF     JSR $DFC4
00/CD2A: A9 F0        LDA #$F0
00/CD2C: 8D 11 04     STA $0411
00/CD2F: 8D 15 04     STA $0415
00/CD32: A6 89        LDX $89
00/CD34: CA           DEX 
00/CD35: 86 89        STX $89
00/CD37: D0 C2        BNE $CCFB
00/CD39: 64 80        STZ $80
00/CD3B: 64 C8        STZ $C8
00/CD3D: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/CD40: 20 94 DA     JSR $DA94
00/CD43: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/CD47: A2 00 00     LDX #$0000
00/CD4A: A9 60        LDA #$60
00/CD4C: 85 0C        STA $0C
00/CD4E: A9 50        LDA #$50
00/CD50: 85 0E        STA $0E
00/CD52: 20 8A CD     JSR $CD8A
00/CD55: 20 05 CB     JSR $CB05
00/CD58: A9 18        LDA #$18
00/CD5A: 85 91        STA $91
00/CD5C: A9 78        LDA #$78
00/CD5E: 85 8F        STA $8F
00/CD60: A9 60        LDA #$60
00/CD62: 85 92        STA $92
00/CD64: 20 53 DF     JSR $DF53
00/CD67: 60           RTS 

; [  ]

00/CD68: 20 2D 91     JSR $912D       ; wait for vblank
00/CD6B: 20 77 91     JSR $9177       ; reset all sprites
00/CD6E: 20 40 CD     JSR $CD40
00/CD71: 60           RTS 

; [  ]

00/CD72: A2 00 00     LDX #$0000
00/CD75: BF 30 82 0D  LDA $0D8230,X
00/CD79: 9D 1B 0E     STA $0E1B,X
00/CD7C: BF 40 82 0D  LDA $0D8240,X   ; this palette is $FF padding
00/CD80: 9D 3B 0E     STA $0E3B,X
00/CD83: E8           INX 
00/CD84: E0 10 00     CPX #$0010
00/CD87: D0 EC        BNE $CD75
00/CD89: 60           RTS 

; [  ]

00/CD8A: A0 00 00     LDY #$0000
00/CD8D: BF 8E F5 14  LDA $14F58E,X
00/CD91: 18           CLC 
00/CD92: 65 0C        ADC $0C
00/CD94: 99 40 03     STA $0340,Y
00/CD97: BF 8F F5 14  LDA $14F58F,X
00/CD9B: 18           CLC 
00/CD9C: 65 0E        ADC $0E
00/CD9E: 99 41 03     STA $0341,Y
00/CDA1: BF 90 F5 14  LDA $14F590,X
00/CDA5: 99 42 03     STA $0342,Y
00/CDA8: BF 91 F5 14  LDA $14F591,X
00/CDAC: 99 43 03     STA $0343,Y
00/CDAF: 20 E2 88     JSR $88E2       ; next sprite
00/CDB2: C0 18 00     CPY #$0018
00/CDB5: D0 D6        BNE $CD8D
00/CDB7: 60           RTS 

; [ special effect $40:  ]

00/CDB8: 20 3D CC     JSR $CC3D
00/CDBB: A9 02        LDA #$02
00/CDBD: 85 CA        STA $CA
00/CDBF: A2 80 01     LDX #$0180
00/CDC2: 86 89        STX $89
00/CDC4: 20 2D 91     JSR $912D       ; wait for vblank
00/CDC7: A6 89        LDX $89
00/CDC9: E0 10 00     CPX #$0010
00/CDCC: B0 04        BCS $CDD2
00/CDCE: 8A           TXA 
00/CDCF: 8D 00 21     STA $2100       ; set screen brightness
00/CDD2: 20 77 91     JSR $9177       ; reset all sprites
00/CDD5: A9 70        LDA #$70
00/CDD7: 8D D4 0A     STA $0AD4
00/CDDA: A9 58        LDA #$58
00/CDDC: 8D D5 0A     STA $0AD5
00/CDDF: A9 03        LDA #$03
00/CDE1: 8D D0 0A     STA $0AD0
00/CDE4: 8D D1 0A     STA $0AD1
00/CDE7: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/CDEA: 20 40 CD     JSR $CD40
00/CDED: A5 89        LDA $89
00/CDEF: 29 3F        AND #$3F
00/CDF1: D0 05        BNE $CDF8
00/CDF3: A9 23        LDA #$23
00/CDF5: 20 99 8D     JSR $8D99       ; play sound effect
00/CDF8: A6 89        LDX $89
00/CDFA: CA           DEX 
00/CDFB: 86 89        STX $89
00/CDFD: D0 C5        BNE $CDC4
00/CDFF: 64 80        STZ $80
00/CE01: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $29:  ]

00/CE04: 20 98 CF     JSR $CF98
00/CE07: 20 B4 CF     JSR $CFB4
00/CE0A: A5 7A        LDA $7A
00/CE0C: 29 07        AND #$07
00/CE0E: D0 F7        BNE $CE07
00/CE10: E6 24        INC $24
00/CE12: A5 24        LDA $24
00/CE14: C9 30        CMP #$30
00/CE16: D0 EF        BNE $CE07
00/CE18: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $35:  ]

00/CE1B: 20 98 CF     JSR $CF98
00/CE1E: A9 01        LDA #$01
00/CE20: 8D C8 06     STA $06C8
00/CE23: 20 B4 CF     JSR $CFB4
00/CE26: A9 24        LDA #$24
00/CE28: 38           SEC 
00/CE29: E5 24        SBC $24
00/CE2B: 85 B9        STA $B9
00/CE2D: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/CE31: 20 EF CE     JSR $CEEF
00/CE34: A5 24        LDA $24
00/CE36: C9 24        CMP #$24
00/CE38: 90 29        BCC $CE63
00/CE3A: A9 68        LDA #$68
00/CE3C: 8D 00 03     STA $0300
00/CE3F: A9 78        LDA #$78
00/CE41: 8D 04 03     STA $0304
00/CE44: 8D 01 03     STA $0301
00/CE47: 8D 05 03     STA $0305
00/CE4A: A5 7A        LDA $7A
00/CE4C: 4A           LSR 
00/CE4D: 4A           LSR 
00/CE4E: 29 02        AND #$02
00/CE50: 18           CLC 
00/CE51: 69 E4        ADC #$E4
00/CE53: 8D 02 03     STA $0302
00/CE56: 49 02        EOR #$02
00/CE58: 8D 06 03     STA $0306
00/CE5B: A9 37        LDA #$37
00/CE5D: 8D 03 03     STA $0303
00/CE60: 8D 07 03     STA $0307
00/CE63: A5 7A        LDA $7A
00/CE65: 29 07        AND #$07
00/CE67: D0 BA        BNE $CE23
00/CE69: E6 24        INC $24
00/CE6B: A5 24        LDA $24
00/CE6D: C9 48        CMP #$48
00/CE6F: D0 B2        BNE $CE23
00/CE71: 64 C8        STZ $C8
00/CE73: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $1F:  ]

00/CE76: A9 01        LDA #$01
00/CE78: 8D C8 06     STA $06C8
00/CE7B: 20 98 CF     JSR $CF98
00/CE7E: 20 B4 CF     JSR $CFB4
00/CE81: 20 C5 CE     JSR $CEC5
00/CE84: A5 7A        LDA $7A
00/CE86: 29 07        AND #$07
00/CE88: D0 F4        BNE $CE7E
00/CE8A: E6 24        INC $24
00/CE8C: A5 24        LDA $24
00/CE8E: C9 32        CMP #$32
00/CE90: D0 EC        BNE $CE7E
00/CE92: 64 24        STZ $24
00/CE94: 20 B4 CF     JSR $CFB4
00/CE97: A5 24        LDA $24
00/CE99: C9 48        CMP #$48
00/CE9B: B0 05        BCS $CEA2
00/CE9D: 18           CLC 
00/CE9E: 69 DC        ADC #$DC
00/CEA0: 85 B9        STA $B9
00/CEA2: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/CEA6: 20 EF CE     JSR $CEEF
00/CEA9: A5 24        LDA $24
00/CEAB: C9 24        CMP #$24
00/CEAD: B0 03        BCS $CEB2
00/CEAF: 20 C5 CE     JSR $CEC5
00/CEB2: A5 7A        LDA $7A
00/CEB4: 29 07        AND #$07
00/CEB6: D0 DC        BNE $CE94
00/CEB8: E6 24        INC $24
00/CEBA: A5 24        LDA $24
00/CEBC: C9 64        CMP #$64
00/CEBE: D0 D4        BNE $CE94
00/CEC0: 64 C8        STZ $C8
00/CEC2: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/CEC5: A9 68        LDA #$68
00/CEC7: 8D 00 03     STA $0300
00/CECA: A9 78        LDA #$78
00/CECC: 8D 04 03     STA $0304
00/CECF: 8D 01 03     STA $0301
00/CED2: 8D 05 03     STA $0305
00/CED5: A5 7A        LDA $7A
00/CED7: 4A           LSR 
00/CED8: 4A           LSR 
00/CED9: 29 02        AND #$02
00/CEDB: 18           CLC 
00/CEDC: 69 E4        ADC #$E4
00/CEDE: 8D 02 03     STA $0302
00/CEE1: 49 02        EOR #$02
00/CEE3: 8D 06 03     STA $0306
00/CEE6: A9 37        LDA #$37
00/CEE8: 8D 03 03     STA $0303
00/CEEB: 8D 07 03     STA $0307
00/CEEE: 60           RTS 

; [  ]

00/CEEF: A5 7A        LDA $7A
00/CEF1: 29 1E        AND #$1E
00/CEF3: A8           TAY 
00/CEF4: C2 20        REP #$20
00/CEF6: A2 00 00     LDX #$0000
00/CEF9: B9 13 CF     LDA $CF13,Y
00/CEFC: 9D BB 0E     STA $0EBB,X
00/CEFF: 98           TYA 
00/CF00: 1A           INC 
00/CF01: 1A           INC 
00/CF02: 29 1F 00     AND #$001F
00/CF05: A8           TAY 
00/CF06: E8           INX 
00/CF07: E8           INX 
00/CF08: E0 10 00     CPX #$0010
00/CF0B: D0 EC        BNE $CEF9
00/CF0D: A9 00 00     LDA #$0000
00/CF10: E2 20        SEP #$20
00/CF12: 60           RTS 

00/CF13: 08 61 10 40
00/CF17: 18 21 1F 02
00/CF1B: 18 23 F0 43
00/CF1F: 08 63 00 7E

; [ special effect $2A:  ]

00/CF23: 20 98 CF     JSR $CF98
00/CF26: A9 01        LDA #$01
00/CF28: 8D C8 06     STA $06C8
00/CF2B: A2 00 00     LDX #$0000
00/CF2E: BD BB 0E     LDA $0EBB,X
00/CF31: 9D 6D 0A     STA $0A6D,X
00/CF34: E8           INX 
00/CF35: E0 10 00     CPX #$0010
00/CF38: D0 F4        BNE $CF2E
00/CF3A: 64 26        STZ $26
00/CF3C: 20 B4 CF     JSR $CFB4
00/CF3F: A9 20        LDA #$20
00/CF41: 85 B9        STA $B9
00/CF43: 22 2F BC 15  JSL $15BC2F     ; draw big whale sprite
00/CF47: A5 7A        LDA $7A
00/CF49: 4A           LSR 
00/CF4A: 90 02        BCC $CF4E
00/CF4C: E6 26        INC $26
00/CF4E: A5 26        LDA $26
00/CF50: 30 12        BMI $CF64
00/CF52: 0A           ASL 
00/CF53: 85 22        STA $22
00/CF55: A5 24        LDA $24
00/CF57: 18           CLC 
00/CF58: 65 22        ADC $22
00/CF5A: 85 24        STA $24
00/CF5C: B0 06        BCS $CF64
00/CF5E: 20 EF CE     JSR $CEEF
00/CF61: 4C 7D CF     JMP $CF7D
00/CF64: 29 F1        AND #$F1
00/CF66: C9 80        CMP #$80
00/CF68: D0 04        BNE $CF6E
00/CF6A: A9 01        LDA #$01
00/CF6C: 85 C4        STA $C4
00/CF6E: A2 00 00     LDX #$0000
00/CF71: BD 6D 0A     LDA $0A6D,X
00/CF74: 9D BB 0E     STA $0EBB,X
00/CF77: E8           INX 
00/CF78: E0 10 00     CPX #$0010
00/CF7B: D0 F4        BNE $CF71
00/CF7D: A5 26        LDA $26
00/CF7F: C9 FF        CMP #$FF
00/CF81: D0 B9        BNE $CF3C
00/CF83: 64 C8        STZ $C8
00/CF85: A9 01        LDA #$01
00/CF87: 8D 24 17     STA $1724
00/CF8A: 9C 27 17     STZ $1727
00/CF8D: 64 B9        STZ $B9
00/CF8F: A2 96 C7     LDX #$C796
00/CF92: 8E 25 17     STX $1725
00/CF95: 4C 5B E3     JMP $E35B       ; wait for vblank
00/CF98: A9 06        LDA #$06
00/CF9A: 8D 04 17     STA $1704
00/CF9D: A9 03        LDA #$03
00/CF9F: 8D 05 17     STA $1705
00/CFA2: A9 58        LDA #$58
00/CFA4: 85 2C        STA $2C
00/CFA6: A9 60        LDA #$60
00/CFA8: 85 2E        STA $2E
00/CFAA: 20 93 D2     JSR $D293
00/CFAD: 64 79        STZ $79
00/CFAF: 64 7A        STZ $7A
00/CFB1: 64 24        STZ $24
00/CFB3: 60           RTS 
00/CFB4: 20 4B 91     JSR $914B       ; wait one frame
00/CFB7: 20 77 91     JSR $9177       ; reset all sprites
00/CFBA: 20 94 DA     JSR $DA94
00/CFBD: 20 AE D2     JSR $D2AE
00/CFC0: 20 0A D3     JSR $D30A
00/CFC3: 60           RTS 

; [ special effect $1D:  ]

00/CFC4: AE 2C 17     LDX $172C
00/CFC7: CA           DEX 
00/CFC8: CA           DEX 
00/CFC9: CA           DEX 
00/CFCA: 8E 2C 17     STX $172C
00/CFCD: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $1C:  ]

00/CFD0: 9C 1F 17     STZ $171F
00/CFD3: 64 B7        STZ $B7
00/CFD5: A2 66 9E     LDX #$9E66
00/CFD8: 8E 1D 17     STX $171D
00/CFDB: A9 01        LDA #$01
00/CFDD: 8D 1C 17     STA $171C
00/CFE0: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $28:  ]

00/CFE3: A9 01        LDA #$01
00/CFE5: 8D 1F 17     STA $171F
00/CFE8: 8D 1C 17     STA $171C
00/CFEB: 64 B7        STZ $B7
00/CFED: A2 66 52     LDX #$5266
00/CFF0: 8E 1D 17     STX $171D
00/CFF3: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $19:  ]

00/CFF6: A9 16        LDA #$16
00/CFF8: 8D 2C 21     STA $212C
00/CFFB: A9 01        LDA #$01
00/CFFD: 85 C9        STA $C9
00/CFFF: A2 00 00     LDX #$0000
00/D002: 86 5E        STX $5E
00/D004: A2 E0 02     LDX #$02E0
00/D007: 86 60        STX $60
00/D009: 20 2F D0     JSR $D02F
00/D00C: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $1A:  ]

00/D00F: A2 00 01     LDX #$0100
00/D012: 86 5E        STX $5E
00/D014: A2 E0 02     LDX #$02E0
00/D017: 86 60        STX $60
00/D019: 20 2F D0     JSR $D02F
00/D01C: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $1B:  ]

00/D01F: A2 00 01     LDX #$0100
00/D022: 86 5E        STX $5E
00/D024: A2 E0 01     LDX #$01E0
00/D027: 86 60        STX $60
00/D029: 20 2F D0     JSR $D02F
00/D02C: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/D02F: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/D032: A5 60        LDA $60
00/D034: 38           SEC 
00/D035: E9 10        SBC #$10
00/D037: 8D 10 21     STA $2110
00/D03A: A5 61        LDA $61
00/D03C: E9 00        SBC #$00
00/D03E: 8D 10 21     STA $2110
00/D041: 60           RTS 

; [ special effect $11:  ]

00/D042: 20 63 D2     JSR $D263
00/D045: A9 81        LDA #$81
00/D047: 8D 00 42     STA $4200       ; enable nmi
00/D04A: A9 0F        LDA #$0F
00/D04C: 8D 00 21     STA $2100       ; screen on, full brightness
00/D04F: 64 AC        STZ $AC
00/D051: 64 79        STZ $79
00/D053: 64 20        STZ $20
00/D055: 64 7A        STZ $7A
00/D057: A5 7A        LDA $7A
00/D059: 4A           LSR 
00/D05A: 4A           LSR 
00/D05B: 4A           LSR 
00/D05C: 29 03        AND #$03
00/D05E: 8D 05 17     STA $1705
00/D061: 20 56 D2     JSR $D256
00/D064: A5 7A        LDA $7A
00/D066: 29 01        AND #$01
00/D068: D0 05        BNE $D06F
00/D06A: A9 04        LDA #$04
00/D06C: 4C 71 D0     JMP $D071
00/D06F: A9 00        LDA #$00
00/D071: 85 AB        STA $AB
00/D073: 20 71 A8     JSR $A871
00/D076: 20 AE D2     JSR $D2AE
00/D079: A5 2C        LDA $2C
00/D07B: 8D 40 03     STA $0340
00/D07E: 8D 00 03     STA $0300
00/D081: 18           CLC 
00/D082: 69 10        ADC #$10
00/D084: 8D 44 03     STA $0344
00/D087: 8D 04 03     STA $0304
00/D08A: 18           CLC 
00/D08B: 69 10        ADC #$10
00/D08D: 8D 48 03     STA $0348
00/D090: 8D 08 03     STA $0308
00/D093: 18           CLC 
00/D094: 69 10        ADC #$10
00/D096: 8D 4C 03     STA $034C
00/D099: 8D 0C 03     STA $030C
00/D09C: A9 68        LDA #$68
00/D09E: 18           CLC 
00/D09F: 65 20        ADC $20
00/D0A1: C9 78        CMP #$78
00/D0A3: 90 02        BCC $D0A7
00/D0A5: A9 78        LDA #$78
00/D0A7: 8D 41 03     STA $0341
00/D0AA: 8D 45 03     STA $0345
00/D0AD: 8D 49 03     STA $0349
00/D0B0: 8D 4D 03     STA $034D
00/D0B3: A9 30        LDA #$30
00/D0B5: 8D 42 03     STA $0342
00/D0B8: A9 32        LDA #$32
00/D0BA: 8D 46 03     STA $0346
00/D0BD: A9 34        LDA #$34
00/D0BF: 8D 4A 03     STA $034A
00/D0C2: A9 36        LDA #$36
00/D0C4: 8D 4E 03     STA $034E
00/D0C7: A9 37        LDA #$37
00/D0C9: 8D 43 03     STA $0343
00/D0CC: 8D 03 03     STA $0303
00/D0CF: 8D 47 03     STA $0347
00/D0D2: 8D 07 03     STA $0307
00/D0D5: 8D 4B 03     STA $034B
00/D0D8: 8D 0B 03     STA $030B
00/D0DB: 8D 4F 03     STA $034F
00/D0DE: 8D 0F 03     STA $030F
00/D0E1: A9 70        LDA #$70
00/D0E3: 8D 01 03     STA $0301
00/D0E6: 8D 05 03     STA $0305
00/D0E9: 8D 09 03     STA $0309
00/D0EC: 8D 0D 03     STA $030D
00/D0EF: A5 7A        LDA $7A
00/D0F1: 4A           LSR 
00/D0F2: 4A           LSR 
00/D0F3: 29 02        AND #$02
00/D0F5: 18           CLC 
00/D0F6: 69 E4        ADC #$E4
00/D0F8: 8D 02 03     STA $0302
00/D0FB: 49 02        EOR #$02
00/D0FD: 8D 06 03     STA $0306
00/D100: 49 02        EOR #$02
00/D102: 8D 0A 03     STA $030A
00/D105: 49 02        EOR #$02
00/D107: 8D 0E 03     STA $030E
00/D10A: A5 7A        LDA $7A
00/D10C: 29 07        AND #$07
00/D10E: D0 02        BNE $D112
00/D110: E6 20        INC $20
00/D112: A5 7A        LDA $7A
00/D114: 29 03        AND #$03
00/D116: D0 02        BNE $D11A
00/D118: E6 2C        INC $2C
00/D11A: A5 20        LDA $20
00/D11C: C9 20        CMP #$20
00/D11E: F0 03        BEQ $D123
00/D120: 4C 57 D0     JMP $D057
00/D123: 9C 28 17     STZ $1728
00/D126: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $10:  ]

00/D129: 20 63 D2     JSR $D263
00/D12C: A9 81        LDA #$81
00/D12E: 8D 00 42     STA $4200       ; enable nmi
00/D131: A9 0F        LDA #$0F
00/D133: 8D 00 21     STA $2100       ; screen on full brightness
00/D136: 64 79        STZ $79
00/D138: 64 20        STZ $20
00/D13A: A9 03        LDA #$03
00/D13C: 8D 05 17     STA $1705
00/D13F: 20 56 D2     JSR $D256
00/D142: A9 10        LDA #$10
00/D144: 8D 40 03     STA $0340
00/D147: 8D 00 03     STA $0300
00/D14A: A9 20        LDA #$20
00/D14C: 8D 44 03     STA $0344
00/D14F: 8D 04 03     STA $0304
00/D152: A9 30        LDA #$30
00/D154: 8D 48 03     STA $0348
00/D157: 8D 08 03     STA $0308
00/D15A: A9 40        LDA #$40
00/D15C: 8D 4C 03     STA $034C
00/D15F: 8D 0C 03     STA $030C
00/D162: A9 78        LDA #$78
00/D164: 38           SEC 
00/D165: E5 20        SBC $20
00/D167: C9 68        CMP #$68
00/D169: B0 02        BCS $D16D
00/D16B: A9 68        LDA #$68
00/D16D: 8D 41 03     STA $0341
00/D170: 8D 45 03     STA $0345
00/D173: 8D 49 03     STA $0349
00/D176: 8D 4D 03     STA $034D
00/D179: A9 30        LDA #$30
00/D17B: 8D 42 03     STA $0342
00/D17E: A9 32        LDA #$32
00/D180: 8D 46 03     STA $0346
00/D183: A9 34        LDA #$34
00/D185: 8D 4A 03     STA $034A
00/D188: A9 36        LDA #$36
00/D18A: 8D 4E 03     STA $034E
00/D18D: A9 37        LDA #$37
00/D18F: 8D 43 03     STA $0343
00/D192: 8D 03 03     STA $0303
00/D195: 8D 47 03     STA $0347
00/D198: 8D 07 03     STA $0307
00/D19B: 8D 4B 03     STA $034B
00/D19E: 8D 0B 03     STA $030B
00/D1A1: 8D 4F 03     STA $034F
00/D1A4: 8D 0F 03     STA $030F
00/D1A7: A9 70        LDA #$70
00/D1A9: 8D 01 03     STA $0301
00/D1AC: 8D 05 03     STA $0305
00/D1AF: 8D 09 03     STA $0309
00/D1B2: 8D 0D 03     STA $030D
00/D1B5: A5 7A        LDA $7A
00/D1B7: 4A           LSR 
00/D1B8: 4A           LSR 
00/D1B9: 29 02        AND #$02
00/D1BB: 18           CLC 
00/D1BC: 69 E4        ADC #$E4
00/D1BE: 8D 02 03     STA $0302
00/D1C1: 49 02        EOR #$02
00/D1C3: 8D 06 03     STA $0306
00/D1C6: 49 02        EOR #$02
00/D1C8: 8D 0A 03     STA $030A
00/D1CB: 49 02        EOR #$02
00/D1CD: 8D 0E 03     STA $030E
00/D1D0: A5 7A        LDA $7A
00/D1D2: 29 0F        AND #$0F
00/D1D4: D0 02        BNE $D1D8
00/D1D6: E6 20        INC $20
00/D1D8: A5 20        LDA $20
00/D1DA: C9 20        CMP #$20
00/D1DC: F0 03        BEQ $D1E1
00/D1DE: 4C 3A D1     JMP $D13A
00/D1E1: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $0F:  ]

00/D1E4: 20 63 D2     JSR $D263
00/D1E7: A9 81        LDA #$81
00/D1E9: 8D 00 42     STA $4200       ; enable nmi
00/D1EC: A9 0F        LDA #$0F
00/D1EE: 8D 00 21     STA $2100       ; screen on, full brightness
00/D1F1: A2 00 02     LDX #$0200
00/D1F4: 86 89        STX $89
00/D1F6: 64 79        STZ $79
00/D1F8: A9 03        LDA #$03
00/D1FA: 8D 05 17     STA $1705
00/D1FD: 20 56 D2     JSR $D256
00/D200: A9 28        LDA #$28
00/D202: 8D 40 03     STA $0340
00/D205: 8D 00 03     STA $0300
00/D208: A5 7A        LDA $7A
00/D20A: 4A           LSR 
00/D20B: 4A           LSR 
00/D20C: 4A           LSR 
00/D20D: 4A           LSR 
00/D20E: AA           TAX 
00/D20F: BD 46 D2     LDA $D246,X
00/D212: 8D 41 03     STA $0341
00/D215: A9 30        LDA #$30
00/D217: 8D 42 03     STA $0342
00/D21A: 8A           TXA 
00/D21B: 29 04        AND #$04
00/D21D: 0A           ASL 
00/D21E: 0A           ASL 
00/D21F: 0A           ASL 
00/D220: 0A           ASL 
00/D221: 09 37        ORA #$37
00/D223: 8D 43 03     STA $0343
00/D226: A9 70        LDA #$70
00/D228: 8D 01 03     STA $0301
00/D22B: A5 7A        LDA $7A
00/D22D: 4A           LSR 
00/D22E: 4A           LSR 
00/D22F: 29 02        AND #$02
00/D231: 18           CLC 
00/D232: 69 E4        ADC #$E4
00/D234: 8D 02 03     STA $0302
00/D237: A9 37        LDA #$37
00/D239: 8D 03 03     STA $0303
00/D23C: A6 89        LDX $89
00/D23E: CA           DEX 
00/D23F: 86 89        STX $89
00/D241: D0 B5        BNE $D1F8
00/D243: 4C 5B E3     JMP $E35B       ; wait for vblank

00/D246: 74 73 71 6F 6C 6A 69 68 68 69 6A 6C 6F 71 73 74

; [  ]

00/D256: 20 4B 91     JSR $914B       ; wait one frame
00/D259: 20 C0 94     JSR $94C0       ; draw world map sprites
00/D25C: 20 94 DA     JSR $DA94
00/D25F: 20 0A D3     JSR $D30A
00/D262: 60           RTS 

; [  ]

00/D263: A2 A8 90     LDX #$90A8
00/D266: 8E 06 17     STX $1706
00/D269: A9 10        LDA #$10
00/D26B: 85 2C        STA $2C
00/D26D: A9 58        LDA #$58
00/D26F: 85 2E        STA $2E
00/D271: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/D275: 9C 00 17     STZ $1700
00/D278: A9 07        LDA #$07
00/D27A: 8D 04 17     STA $1704
00/D27D: A9 01        LDA #$01
00/D27F: 8D 28 17     STA $1728
00/D282: 20 02 85     JSR $8502       ; load overworld
00/D285: A9 10        LDA #$10
00/D287: 85 AD        STA $AD
00/D289: 20 93 D2     JSR $D293
00/D28C: 20 77 91     JSR $9177       ; reset all sprites
00/D28F: 20 AE D2     JSR $D2AE
00/D292: 60           RTS 

; [  ]

00/D293: A2 00 00     LDX #$0000
00/D296: BF 10 82 0D  LDA $0D8210,X
00/D29A: 9D 1B 0E     STA $0E1B,X
00/D29D: 9D AD 0A     STA $0AAD,X
00/D2A0: BF 20 82 0D  LDA $0D8220,X
00/D2A4: 9D 3B 0E     STA $0E3B,X
00/D2A7: E8           INX 
00/D2A8: E0 10 00     CPX #$0010
00/D2AB: D0 E9        BNE $D296
00/D2AD: 60           RTS 

; [  ]

00/D2AE: A0 C0 01     LDY #$01C0
00/D2B1: A2 00 00     LDX #$0000
00/D2B4: 64 0C        STZ $0C
00/D2B6: 64 0E        STZ $0E
00/D2B8: A5 0C        LDA $0C
00/D2BA: 18           CLC 
00/D2BB: 65 2C        ADC $2C
00/D2BD: 99 00 03     STA $0300,Y
00/D2C0: A5 0E        LDA $0E
00/D2C2: 18           CLC 
00/D2C3: 65 2E        ADC $2E
00/D2C5: 99 01 03     STA $0301,Y
00/D2C8: BF D6 F5 14  LDA $14F5D6,X
00/D2CC: 99 02 03     STA $0302,Y
00/D2CF: BF D7 F5 14  LDA $14F5D7,X
00/D2D3: 99 03 03     STA $0303,Y
00/D2D6: A5 0C        LDA $0C
00/D2D8: 18           CLC 
00/D2D9: 69 10        ADC #$10
00/D2DB: 29 3F        AND #$3F
00/D2DD: 85 0C        STA $0C
00/D2DF: D0 07        BNE $D2E8
00/D2E1: A5 0E        LDA $0E
00/D2E3: 18           CLC 
00/D2E4: 69 10        ADC #$10
00/D2E6: 85 0E        STA $0E
00/D2E8: E8           INX 
00/D2E9: E8           INX 
00/D2EA: C8           INY 
00/D2EB: C8           INY 
00/D2EC: C8           INY 
00/D2ED: C8           INY 
00/D2EE: E0 20 00     CPX #$0020
00/D2F1: F0 0B        BEQ $D2FE
00/D2F3: E0 10 00     CPX #$0010
00/D2F6: D0 C0        BNE $D2B8
00/D2F8: A0 10 00     LDY #$0010
00/D2FB: 4C B8 D2     JMP $D2B8
00/D2FE: 20 94 DA     JSR $DA94
00/D301: A9 AA        LDA #$AA
00/D303: 8D 1C 05     STA $051C
00/D306: 8D 1D 05     STA $051D
00/D309: 60           RTS 

; [  ]

00/D30A: A5 7A        LDA $7A
00/D30C: 29 03        AND #$03
00/D30E: D0 31        BNE $D341
00/D310: E6 79        INC $79
00/D312: A5 79        LDA $79
00/D314: C9 06        CMP #$06
00/D316: D0 02        BNE $D31A
00/D318: 64 79        STZ $79
00/D31A: A2 00 00     LDX #$0000
00/D31D: A5 79        LDA $79
00/D31F: 0A           ASL 
00/D320: A8           TAY 
00/D321: B9 AF 0A     LDA $0AAF,Y
00/D324: 9D 1D 0E     STA $0E1D,X
00/D327: B9 B0 0A     LDA $0AB0,Y
00/D32A: 9D 1E 0E     STA $0E1E,X
00/D32D: E8           INX 
00/D32E: E8           INX 
00/D32F: E0 0E 00     CPX #$000E
00/D332: F0 0D        BEQ $D341
00/D334: C8           INY 
00/D335: C8           INY 
00/D336: C0 0E 00     CPY #$000E
00/D339: D0 E6        BNE $D321
00/D33B: A0 00 00     LDY #$0000
00/D33E: 4C 21 D3     JMP $D321
00/D341: 60           RTS 

; [ special effect $0D:  ]

00/D342: A9 01        LDA #$01
00/D344: 8D 28 17     STA $1728
00/D347: A2 DE 38     LDX #$38DE
00/D34A: 8E 29 17     STX $1729
00/D34D: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $0A:  ]

00/D350: AE 2C 17     LDX $172C
00/D353: F0 09        BEQ $D35E
00/D355: CA           DEX 
00/D356: CA           DEX 
00/D357: CA           DEX 
00/D358: 8E 2C 17     STX $172C
00/D35B: 20 6D D3     JSR $D36D
00/D35E: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $0B:  ]

00/D361: A2 00 00     LDX #$0000
00/D364: 8E 2C 17     STX $172C
00/D367: 20 6D D3     JSR $D36D
00/D36A: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/D36D: 64 CA        STZ $CA
00/D36F: AE 2C 17     LDX $172C
00/D372: BD 2E 17     LDA $172E,X
00/D375: C9 FB        CMP #$FB
00/D377: B0 25        BCS $D39E
00/D379: 8D 02 17     STA $1702
00/D37C: A9 03        LDA #$03
00/D37E: 48           PHA 
00/D37F: BD 2F 17     LDA $172F,X
00/D382: 29 3F        AND #$3F
00/D384: 8D 06 17     STA $1706
00/D387: BD 30 17     LDA $1730,X
00/D38A: 8D 07 17     STA $1707
00/D38D: BD 2F 17     LDA $172F,X
00/D390: 29 C0        AND #$C0
00/D392: 4A           LSR 
00/D393: 4A           LSR 
00/D394: 4A           LSR 
00/D395: 4A           LSR 
00/D396: 4A           LSR 
00/D397: 4A           LSR 
00/D398: 8D 05 17     STA $1705
00/D39B: 4C AE D3     JMP $D3AE
00/D39E: 38           SEC 
00/D39F: E9 FB        SBC #$FB
00/D3A1: 48           PHA 
00/D3A2: BD 2F 17     LDA $172F,X
00/D3A5: 8D 06 17     STA $1706
00/D3A8: BD 30 17     LDA $1730,X
00/D3AB: 8D 07 17     STA $1707
00/D3AE: 68           PLA 
00/D3AF: 20 67 F1     JSR $F167
00/D3B2: 9C 05 1E     STZ $1E05
00/D3B5: 22 04 80 04  JSL $048004     ; execute sound command
00/D3B9: 20 5D 8D     JSR $8D5D       ; play map song
00/D3BC: 64 D6        STZ $D6
00/D3BE: 60           RTS 

; [ special effect $05:  ]

00/D3BF: 20 4B 91     JSR $914B       ; wait one frame
00/D3C2: 20 77 91     JSR $9177       ; reset all sprites
00/D3C5: 20 94 DA     JSR $DA94
00/D3C8: AD 00 17     LDA $1700
00/D3CB: C9 03        CMP #$03
00/D3CD: F0 06        BEQ $D3D5
00/D3CF: 20 C0 94     JSR $94C0       ; draw world map sprites
00/D3D2: 4C D5 D3     JMP $D3D5
00/D3D5: A2 70 70     LDX #$7070
00/D3D8: 8E 00 03     STX $0300
00/D3DB: AD 03 1A     LDA $1A03
00/D3DE: 3A           DEC 
00/D3DF: 0A           ASL 
00/D3E0: 18           CLC 
00/D3E1: 69 E8        ADC #$E8
00/D3E3: 8D 02 03     STA $0302
00/D3E6: AD 03 1A     LDA $1A03
00/D3E9: 0A           ASL 
00/D3EA: 09 31        ORA #$31
00/D3EC: 8D 03 03     STA $0303
00/D3EF: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $09:  ]

00/D3F2: 20 EF 85     JSR $85EF       ; screen off
00/D3F5: A9 17        LDA #$17
00/D3F7: 8D 2C 21     STA $212C
00/D3FA: 9C 30 21     STZ $2130
00/D3FD: 9C 31 21     STZ $2131
00/D400: 22 14 B1 15  JSL $15B114     ; clear bg1/bg2 graphics in vram
00/D404: 9C 0B 42     STZ $420B
00/D407: A2 80 EC     LDX #$EC80      ; 08/EC80 (prologue graphics)
00/D40A: 8E 02 43     STX $4302
00/D40D: A9 08        LDA #$08
00/D40F: 8D 04 43     STA $4304
00/D412: 22 43 B1 15  JSL $15B143     ; transfer bg1/bg2 graphics to vram (3bpp)
00/D416: A2 00 00     LDX #$0000
00/D419: BF 00 FF 08  LDA $08FF00,X
00/D41D: 9D DB 0C     STA $0CDB,X
00/D420: E8           INX 
00/D421: E0 00 01     CPX #$0100
00/D424: D0 F3        BNE $D419
00/D426: A9 00        LDA #$00
00/D428: 20 90 88     JSR $8890
00/D42B: A9 80        LDA #$80
00/D42D: 8D 15 21     STA $2115
00/D430: A2 00 28     LDX #$2800
00/D433: 8E 16 21     STX $2116
00/D436: A0 00 20     LDY #$2000
00/D439: A2 00 08     LDX #$0800
00/D43C: 8C 18 21     STY $2118
00/D43F: CA           DEX 
00/D440: D0 FA        BNE $D43C
00/D442: A2 00 1A     LDX #$1A00
00/D445: 86 47        STX $47
00/D447: A2 00 03     LDX #$0300
00/D44A: 86 45        STX $45
00/D44C: A2 80 F8     LDX #$F880
00/D44F: 86 3D        STX $3D
00/D451: A9 08        LDA #$08
00/D453: 85 3C        STA $3C
00/D455: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/D459: A2 C0 31     LDX #$31C0
00/D45C: 86 47        STX $47
00/D45E: A2 80 03     LDX #$0380
00/D461: 86 45        STX $45
00/D463: A2 80 FB     LDX #$FB80
00/D466: 86 3D        STX $3D
00/D468: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/D46C: A2 00 40     LDX #$4000
00/D46F: 86 47        STX $47
00/D471: A2 80 00     LDX #$0080
00/D474: 86 45        STX $45
00/D476: A2 00 FD     LDX #$FD00
00/D479: 86 3D        STX $3D
00/D47B: A9 1A        LDA #$1A
00/D47D: 85 3C        STA $3C
00/D47F: 22 85 CA 15  JSL $15CA85     ; transfer data to vram
00/D483: A2 00 00     LDX #$0000
00/D486: BF F0 FC 1A  LDA $1AFCF0,X
00/D48A: 9D DB 0D     STA $0DDB,X
00/D48D: E8           INX 
00/D48E: E0 10 00     CPX #$0010
00/D491: D0 F3        BNE $D486
00/D493: 20 77 91     JSR $9177       ; reset all sprites
00/D496: A2 00 00     LDX #$0000
00/D499: BF 56 FA 14  LDA $14FA56,X
00/D49D: 9D 00 03     STA $0300,X
00/D4A0: E8           INX 
00/D4A1: E0 10 00     CPX #$0010
00/D4A4: D0 F3        BNE $D499
00/D4A6: A2 00 00     LDX #$0000
00/D4A9: 86 5A        STX $5A
00/D4AB: 86 5C        STX $5C
00/D4AD: 86 5E        STX $5E
00/D4AF: 86 60        STX $60
00/D4B1: 9C E4 0F     STZ $0FE4
00/D4B4: A9 81        LDA #$81
00/D4B6: 8D 00 42     STA $4200       ; enable nmi
00/D4B9: A9 07        LDA #$07
00/D4BB: 20 B0 8D     JSR $8DB0       ; fade in
00/D4BE: A9 01        LDA #$01
00/D4C0: 85 CB        STA $CB
00/D4C2: A9 D0        LDA #$D0
00/D4C4: 85 B2        STA $B2
00/D4C6: 20 1B B4     JSR $B41B       ; get pointer to event dialogue (bank 1 high)
00/D4C9: 20 0B B3     JSR $B30B       ; open dialogue window
00/D4CC: 20 9E B3     JSR $B39E       ; close dialogue window
00/D4CF: 64 CB        STZ $CB
00/D4D1: 20 53 8D     JSR $8D53       ; fade out music (slow)
00/D4D4: A9 07        LDA #$07
00/D4D6: 20 D1 8D     JSR $8DD1       ; fade out
00/D4D9: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $0E:  ]

00/D4DC: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/D4E0: AE 06 17     LDX $1706
00/D4E3: DA           PHX 
00/D4E4: A2 69 D3     LDX #$D369
00/D4E7: 8E 06 17     STX $1706
00/D4EA: 9C 00 17     STZ $1700
00/D4ED: 20 02 85     JSR $8502       ; load overworld
00/D4F0: A9 20        LDA #$20
00/D4F2: 85 AD        STA $AD
00/D4F4: A9 10        LDA #$10
00/D4F6: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/D4FA: A9 81        LDA #$81
00/D4FC: 8D 00 42     STA $4200       ; enable nmi
00/D4FF: A9 03        LDA #$03
00/D501: 20 B0 8D     JSR $8DB0       ; fade in
00/D504: A2 40 00     LDX #$0040
00/D507: 20 DE E1     JSR $E1DE       ; wait
00/D50A: A9 01        LDA #$01
00/D50C: 85 E3        STA $E3
00/D50E: A9 20        LDA #$20
00/D510: 8D CF 0A     STA $0ACF
00/D513: A9 02        LDA #$02
00/D515: 8D D0 0A     STA $0AD0
00/D518: A9 02        LDA #$02
00/D51A: 8D D1 0A     STA $0AD1
00/D51D: A2 70 70     LDX #$7070
00/D520: 8E D4 0A     STX $0AD4
00/D523: A2 40 00     LDX #$0040
00/D526: 8E D2 0A     STX $0AD2
00/D529: 9C CD 0A     STZ $0ACD
00/D52C: A9 02        LDA #$02
00/D52E: 8D CE 0A     STA $0ACE
00/D531: A9 5E        LDA #$5E
00/D533: 20 99 8D     JSR $8D99       ; play sound effect
00/D536: 20 75 E0     JSR $E075
00/D539: 20 4B 91     JSR $914B       ; wait one frame
00/D53C: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/D53F: AE D2 0A     LDX $0AD2
00/D542: E0 10 00     CPX #$0010
00/D545: B0 04        BCS $D54B
00/D547: 8A           TXA 
00/D548: 8D 00 21     STA $2100       ; set screen brightness
00/D54B: AE D2 0A     LDX $0AD2
00/D54E: D0 E9        BNE $D539
00/D550: FA           PLX 
00/D551: 8E 06 17     STX $1706
00/D554: 64 E3        STZ $E3
00/D556: 64 80        STZ $80
00/D558: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $04:  ]

00/D55B: A9 EC        LDA #$EC
00/D55D: 8D 00 18     STA $1800
00/D560: 9C 01 18     STZ $1801
00/D563: AD DB 0F     LDA $0FDB       ; default battle bg
00/D566: 29 8F        AND #$8F
00/D568: 8D 02 18     STA $1802
00/D56B: 20 18 89     JSR $8918       ; battle (sub-map)
00/D56E: 20 53 8D     JSR $8D53       ; fade out music (slow)
00/D571: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/D575: AE 06 17     LDX $1706
00/D578: DA           PHX 
00/D579: A2 63 77     LDX #$7763
00/D57C: 8E 06 17     STX $1706
00/D57F: 9C 00 17     STZ $1700
00/D582: 20 02 85     JSR $8502       ; load overworld
00/D585: A9 20        LDA #$20
00/D587: 85 AD        STA $AD
00/D589: A9 81        LDA #$81
00/D58B: 8D 00 42     STA $4200       ; enable nmi
00/D58E: A9 03        LDA #$03
00/D590: 20 B0 8D     JSR $8DB0       ; fade in
00/D593: A2 40 00     LDX #$0040
00/D596: 20 DE E1     JSR $E1DE       ; wait
00/D599: A9 01        LDA #$01
00/D59B: 85 E3        STA $E3
00/D59D: A9 20        LDA #$20
00/D59F: 8D CF 0A     STA $0ACF
00/D5A2: A9 02        LDA #$02
00/D5A4: 8D D0 0A     STA $0AD0
00/D5A7: A9 03        LDA #$03
00/D5A9: 8D D1 0A     STA $0AD1
00/D5AC: A2 70 70     LDX #$7070
00/D5AF: 8E D4 0A     STX $0AD4
00/D5B2: A2 40 00     LDX #$0040
00/D5B5: 8E D2 0A     STX $0AD2
00/D5B8: 9C CD 0A     STZ $0ACD
00/D5BB: A9 02        LDA #$02
00/D5BD: 8D CE 0A     STA $0ACE
00/D5C0: A9 42        LDA #$42
00/D5C2: 8D 01 1E     STA $1E01
00/D5C5: A9 01        LDA #$01
00/D5C7: 8D 00 1E     STA $1E00
00/D5CA: 22 04 80 04  JSL $048004     ; execute sound command
00/D5CE: 20 75 E0     JSR $E075
00/D5D1: 20 4B 91     JSR $914B       ; wait one frame
00/D5D4: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/D5D7: AE D2 0A     LDX $0AD2
00/D5DA: E0 10 00     CPX #$0010
00/D5DD: B0 07        BCS $D5E6
00/D5DF: 8A           TXA 
00/D5E0: 8D 00 21     STA $2100       ; set screen brightness
00/D5E3: 20 53 8D     JSR $8D53       ; fade out music (slow)
00/D5E6: AE D2 0A     LDX $0AD2
00/D5E9: D0 E6        BNE $D5D1
00/D5EB: FA           PLX 
00/D5EC: 8E 06 17     STX $1706
00/D5EF: 64 E3        STZ $E3
00/D5F1: 64 80        STZ $80
00/D5F3: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $03:  ]

00/D5F6: A9 04        LDA #$04
00/D5F8: 8D CD 0A     STA $0ACD
00/D5FB: 9C CE 0A     STZ $0ACE
00/D5FE: 20 75 E0     JSR $E075
00/D601: A2 00 00     LDX #$0000
00/D604: A9 FF        LDA #$FF
00/D606: 9D 6D 0A     STA $0A6D,X
00/D609: E8           INX 
00/D60A: E8           INX 
00/D60B: E8           INX 
00/D60C: E8           INX 
00/D60D: E0 60 00     CPX #$0060
00/D610: D0 F4        BNE $D606
00/D612: A9 3E        LDA #$3E
00/D614: 20 EA E7     JSR $E7EA
00/D617: A2 00 01     LDX #$0100
00/D61A: 86 2C        STX $2C
00/D61C: A2 10 00     LDX #$0010
00/D61F: 86 2E        STX $2E
00/D621: 20 4B 91     JSR $914B       ; wait one frame
00/D624: 20 77 91     JSR $9177       ; reset all sprites
00/D627: 20 C0 94     JSR $94C0       ; draw world map sprites
00/D62A: A5 AD        LDA $AD
00/D62C: 38           SEC 
00/D62D: E9 10        SBC #$10
00/D62F: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/D633: AD 7A 06     LDA $067A
00/D636: 29 03        AND #$03
00/D638: D0 E7        BNE $D621
00/D63A: A5 AD        LDA $AD
00/D63C: 1A           INC 
00/D63D: 85 AD        STA $AD
00/D63F: C9 20        CMP #$20
00/D641: D0 DE        BNE $D621
00/D643: 20 4B 91     JSR $914B       ; wait one frame
00/D646: 20 58 D7     JSR $D758
00/D649: 20 95 91     JSR $9195       ; reset sprites 0-63
00/D64C: 20 CF E1     JSR $E1CF       ; set large sprite flag (64 sprites)
00/D64F: 64 79        STZ $79
00/D651: A5 79        LDA $79
00/D653: 0A           ASL 
00/D654: A8           TAY 
00/D655: C2 20        REP #$20
00/D657: A5 2C        LDA $2C
00/D659: 18           CLC 
00/D65A: 79 99 D7     ADC $D799,Y
00/D65D: 85 0C        STA $0C
00/D65F: A5 2E        LDA $2E
00/D661: 18           CLC 
00/D662: 79 9F D7     ADC $D79F,Y
00/D665: 85 0E        STA $0E
00/D667: A5 79        LDA $79
00/D669: 29 FF 00     AND #$00FF
00/D66C: 0A           ASL 
00/D66D: 0A           ASL 
00/D66E: 0A           ASL 
00/D66F: 0A           ASL 
00/D670: 09 00 01     ORA #$0100
00/D673: A8           TAY 
00/D674: A9 00 00     LDA #$0000
00/D677: E2 20        SEP #$20
00/D679: A9 1C        LDA #$1C
00/D67B: 85 91        STA $91
00/D67D: A9 78        LDA #$78
00/D67F: 85 8F        STA $8F
00/D681: A9 60        LDA #$60
00/D683: 85 92        STA $92
00/D685: 20 C4 DF     JSR $DFC4
00/D688: E6 79        INC $79
00/D68A: A5 79        LDA $79
00/D68C: C9 03        CMP #$03
00/D68E: D0 C1        BNE $D651
00/D690: 64 E3        STZ $E3
00/D692: A5 2C        LDA $2C
00/D694: C9 40        CMP #$40
00/D696: 90 53        BCC $D6EB
00/D698: C9 90        CMP #$90
00/D69A: B0 4F        BCS $D6EB
00/D69C: A9 01        LDA #$01
00/D69E: 85 E3        STA $E3
00/D6A0: A5 2C        LDA $2C
00/D6A2: 29 07        AND #$07
00/D6A4: D0 45        BNE $D6EB
00/D6A6: E6 C4        INC $C4
00/D6A8: A9 23        LDA #$23
00/D6AA: 20 99 8D     JSR $8D99       ; play sound effect
00/D6AD: A2 00 00     LDX #$0000
00/D6B0: BD 6D 0A     LDA $0A6D,X
00/D6B3: C9 FF        CMP #$FF
00/D6B5: F0 0B        BEQ $D6C2
00/D6B7: C9 06        CMP #$06
00/D6B9: B0 07        BCS $D6C2
00/D6BB: E8           INX 
00/D6BC: E8           INX 
00/D6BD: E8           INX 
00/D6BE: E8           INX 
00/D6BF: 4C B0 D6     JMP $D6B0
00/D6C2: 9E 6D 0A     STZ $0A6D,X
00/D6C5: 9E 71 0A     STZ $0A71,X
00/D6C8: 9E 75 0A     STZ $0A75,X
00/D6CB: A5 2C        LDA $2C
00/D6CD: 18           CLC 
00/D6CE: 69 20        ADC #$20
00/D6D0: 9D 6E 0A     STA $0A6E,X
00/D6D3: 9D 76 0A     STA $0A76,X
00/D6D6: 38           SEC 
00/D6D7: E9 10        SBC #$10
00/D6D9: 9D 72 0A     STA $0A72,X
00/D6DC: A9 48        LDA #$48
00/D6DE: 9D 6F 0A     STA $0A6F,X
00/D6E1: A9 58        LDA #$58
00/D6E3: 9D 73 0A     STA $0A73,X
00/D6E6: A9 68        LDA #$68
00/D6E8: 9D 77 0A     STA $0A77,X
00/D6EB: 64 24        STZ $24
00/D6ED: 64 25        STZ $25
00/D6EF: A6 24        LDX $24
00/D6F1: BD 6D 0A     LDA $0A6D,X
00/D6F4: 30 12        BMI $D708
00/D6F6: C9 06        CMP #$06
00/D6F8: B0 0E        BCS $D708
00/D6FA: 20 5A E1     JSR $E15A
00/D6FD: A5 7A        LDA $7A
00/D6FF: 29 07        AND #$07
00/D701: D0 05        BNE $D708
00/D703: A6 24        LDX $24
00/D705: FE 6D 0A     INC $0A6D,X
00/D708: A6 24        LDX $24
00/D70A: E8           INX 
00/D70B: E8           INX 
00/D70C: E8           INX 
00/D70D: E8           INX 
00/D70E: 86 24        STX $24
00/D710: E0 60 00     CPX #$0060
00/D713: D0 DA        BNE $D6EF
00/D715: A5 7A        LDA $7A
00/D717: 29 01        AND #$01
00/D719: D0 0A        BNE $D725
00/D71B: A6 2C        LDX $2C
00/D71D: CA           DEX 
00/D71E: 86 2C        STX $2C
00/D720: E0 DE FF     CPX #$FFDE
00/D723: F0 09        BEQ $D72E
00/D725: A5 2C        LDA $2C
00/D727: C9 B0        CMP #$B0
00/D729: 90 00        BCC $D72B
00/D72B: 4C 43 D6     JMP $D643
00/D72E: A9 23        LDA #$23
00/D730: 20 EA E7     JSR $E7EA
00/D733: 20 4B 91     JSR $914B       ; wait one frame
00/D736: 20 77 91     JSR $9177       ; reset all sprites
00/D739: 20 C0 94     JSR $94C0       ; draw world map sprites
00/D73C: A5 AD        LDA $AD
00/D73E: 38           SEC 
00/D73F: E9 10        SBC #$10
00/D741: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/D745: AD 7A 06     LDA $067A
00/D748: 29 03        AND #$03
00/D74A: D0 E7        BNE $D733
00/D74C: A5 AD        LDA $AD
00/D74E: 3A           DEC 
00/D74F: 85 AD        STA $AD
00/D751: C9 10        CMP #$10
00/D753: D0 DE        BNE $D733
00/D755: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/D758: A5 2C        LDA $2C
00/D75A: C9 60        CMP #$60
00/D75C: D0 3A        BNE $D798
00/D75E: 9C 15 21     STZ $2115
00/D761: A9 00        LDA #$00
00/D763: AA           TAX 
00/D764: A8           TAY 
00/D765: B9 A5 D7     LDA $D7A5,Y
00/D768: 8D 16 21     STA $2116
00/D76B: B9 A6 D7     LDA $D7A6,Y
00/D76E: 8D 17 21     STA $2117
00/D771: BF 46 FC 14  LDA $14FC46,X
00/D775: 8D 18 21     STA $2118
00/D778: BF 47 FC 14  LDA $14FC47,X
00/D77C: 8D 18 21     STA $2118
00/D77F: BF 48 FC 14  LDA $14FC48,X
00/D783: 8D 18 21     STA $2118
00/D786: BF 49 FC 14  LDA $14FC49,X
00/D78A: 8D 18 21     STA $2118
00/D78D: C8           INY 
00/D78E: C8           INY 
00/D78F: E8           INX 
00/D790: E8           INX 
00/D791: E8           INX 
00/D792: E8           INX 
00/D793: E0 10 00     CPX #$0010
00/D796: D0 CD        BNE $D765
00/D798: 60           RTS 

00/D799: 10 00 00 00 10 00 10 00 20 00 30 00

00/D7A5: 6C 39 EC 39 6C 3A EC 3A

; [ special effect $31:  ]

00/D7AD: A9 60        LDA #$60
00/D7AF: 8D D4 0A     STA $0AD4
00/D7B2: A9 48        LDA #$48
00/D7B4: 8D D5 0A     STA $0AD5
00/D7B7: 20 F6 D7     JSR $D7F6
00/D7BA: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/D7BD: A9 80        LDA #$80
00/D7BF: 8D 15 21     STA $2115
00/D7C2: A2 00 00     LDX #$0000
00/D7C5: 8A           TXA 
00/D7C6: 29 03        AND #$03
00/D7C8: D0 11        BNE $D7DB
00/D7CA: 8A           TXA 
00/D7CB: 4A           LSR 
00/D7CC: 4A           LSR 
00/D7CD: 0A           ASL 
00/D7CE: A8           TAY 
00/D7CF: B9 EE D7     LDA $D7EE,Y
00/D7D2: 8D 16 21     STA $2116
00/D7D5: B9 EF D7     LDA $D7EF,Y
00/D7D8: 8D 17 21     STA $2117
00/D7DB: A9 01        LDA #$01
00/D7DD: 8D 18 21     STA $2118
00/D7E0: A9 15        LDA #$15
00/D7E2: 8D 19 21     STA $2119
00/D7E5: E8           INX 
00/D7E6: 8A           TXA 
00/D7E7: C9 10        CMP #$10
00/D7E9: D0 DA        BNE $D7C5
00/D7EB: 4C 5B E3     JMP $E35B       ; wait for vblank

00/D7EE: 50 1A 70 1A 90 1A B0 1A

; [  ]

00/D7F6: A9 20        LDA #$20
00/D7F8: 8D CF 0A     STA $0ACF
00/D7FB: A9 02        LDA #$02
00/D7FD: 8D D0 0A     STA $0AD0
00/D800: 8D D1 0A     STA $0AD1
00/D803: A2 30 00     LDX #$0030
00/D806: 8E D2 0A     STX $0AD2
00/D809: A9 06        LDA #$06
00/D80B: 8D CD 0A     STA $0ACD
00/D80E: 9C CE 0A     STZ $0ACE
00/D811: 20 75 E0     JSR $E075
00/D814: 20 4B 91     JSR $914B       ; wait one frame
00/D817: 20 F6 ED     JSR $EDF6
00/D81A: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/D81D: A5 7A        LDA $7A
00/D81F: 29 3F        AND #$3F
00/D821: D0 05        BNE $D828
00/D823: A9 23        LDA #$23
00/D825: 20 99 8D     JSR $8D99       ; play sound effect
00/D828: AE D2 0A     LDX $0AD2
00/D82B: D0 E7        BNE $D814
00/D82D: 20 95 91     JSR $9195       ; reset sprites 0-63
00/D830: 60           RTS 

; [ special effect $1E:  ]

00/D831: A9 70        LDA #$70
00/D833: 8D D4 0A     STA $0AD4
00/D836: A9 10        LDA #$10
00/D838: 8D D5 0A     STA $0AD5
00/D83B: 20 F6 D7     JSR $D7F6
00/D83E: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $3A:  ]

00/D841: A9 70        LDA #$70
00/D843: 8D D4 0A     STA $0AD4
00/D846: A9 70        LDA #$70
00/D848: 8D D5 0A     STA $0AD5
00/D84B: 20 F6 D7     JSR $D7F6
00/D84E: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $0C:  ]

00/D851: 64 79        STZ $79
00/D853: A9 23        LDA #$23
00/D855: 20 99 8D     JSR $8D99       ; play sound effect
00/D858: A9 20        LDA #$20
00/D85A: 8D CF 0A     STA $0ACF
00/D85D: A9 02        LDA #$02
00/D85F: 8D D0 0A     STA $0AD0
00/D862: 8D D1 0A     STA $0AD1
00/D865: A2 08 00     LDX #$0008
00/D868: 8E D2 0A     STX $0AD2
00/D86B: A9 06        LDA #$06
00/D86D: 8D CD 0A     STA $0ACD
00/D870: 9C CE 0A     STZ $0ACE
00/D873: A5 79        LDA $79
00/D875: 0A           ASL 
00/D876: AA           TAX 
00/D877: BF 56 FC 14  LDA $14FC56,X
00/D87B: 8D D4 0A     STA $0AD4
00/D87E: BF 57 FC 14  LDA $14FC57,X
00/D882: 8D D5 0A     STA $0AD5
00/D885: 20 75 E0     JSR $E075
00/D888: 20 4B 91     JSR $914B       ; wait one frame
00/D88B: 20 F6 ED     JSR $EDF6
00/D88E: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/D891: AE D2 0A     LDX $0AD2
00/D894: E0 04 00     CPX #$0004
00/D897: D0 04        BNE $D89D
00/D899: A9 01        LDA #$01
00/D89B: 85 E5        STA $E5
00/D89D: E0 00 00     CPX #$0000
00/D8A0: D0 E6        BNE $D888
00/D8A2: E6 79        INC $79
00/D8A4: A5 79        LDA $79
00/D8A6: C9 08        CMP #$08
00/D8A8: D0 A9        BNE $D853
00/D8AA: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $08:  ]

00/D8AD: A9 51        LDA #$51
00/D8AF: 20 99 8D     JSR $8D99       ; play sound effect
00/D8B2: A9 60        LDA #$60
00/D8B4: 85 AD        STA $AD
00/D8B6: 64 79        STZ $79
00/D8B8: 64 7A        STZ $7A
00/D8BA: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/D8BD: A5 7A        LDA $7A
00/D8BF: 29 1C        AND #$1C
00/D8C1: 4A           LSR 
00/D8C2: 4A           LSR 
00/D8C3: A8           TAY 
00/D8C4: A5 83        LDA $83
00/D8C6: 29 E0        AND #$E0
00/D8C8: 19 53 D9     ORA $D953,Y
00/D8CB: 8D 32 21     STA $2132
00/D8CE: A5 7A        LDA $7A
00/D8D0: 29 0F        AND #$0F
00/D8D2: D0 02        BNE $D8D6
00/D8D4: E6 79        INC $79
00/D8D6: 20 94 DA     JSR $DA94
00/D8D9: 64 20        STZ $20
00/D8DB: A5 20        LDA $20
00/D8DD: A8           TAY 
00/D8DE: B9 5B D9     LDA $D95B,Y
00/D8E1: 18           CLC 
00/D8E2: 6D FB 06     ADC $06FB
00/D8E5: 85 22        STA $22
00/D8E7: 0A           ASL 
00/D8E8: 18           CLC 
00/D8E9: 65 22        ADC $22
00/D8EB: 20 79 DA     JSR $DA79
00/D8EE: 20 6F D9     JSR $D96F
00/D8F1: A5 20        LDA $20
00/D8F3: A8           TAY 
00/D8F4: B9 5B D9     LDA $D95B,Y
00/D8F7: 18           CLC 
00/D8F8: 69 40        ADC #$40
00/D8FA: 18           CLC 
00/D8FB: 6D FB 06     ADC $06FB
00/D8FE: 0A           ASL 
00/D8FF: 20 79 DA     JSR $DA79
00/D902: 20 7F D9     JSR $D97F
00/D905: A5 20        LDA $20
00/D907: 29 03        AND #$03
00/D909: AA           TAX 
00/D90A: BD 6B D9     LDA $D96B,X
00/D90D: 99 02 03     STA $0302,Y
00/D910: C9 EC        CMP #$EC
00/D912: D0 08        BNE $D91C
00/D914: A5 7A        LDA $7A
00/D916: 29 04        AND #$04
00/D918: F0 02        BEQ $D91C
00/D91A: A9 79        LDA #$79
00/D91C: A9 39        LDA #$39
00/D91E: 99 03 03     STA $0303,Y
00/D921: E6 20        INC $20
00/D923: A5 20        LDA $20
00/D925: C9 10        CMP #$10
00/D927: F0 03        BEQ $D92C
00/D929: 4C DB D8     JMP $D8DB
00/D92C: EE FB 06     INC $06FB
00/D92F: A5 7A        LDA $7A
00/D931: 29 03        AND #$03
00/D933: D0 0D        BNE $D942
00/D935: A5 79        LDA $79
00/D937: C9 12        CMP #$12
00/D939: B0 05        BCS $D940
00/D93B: C6 AD        DEC $AD
00/D93D: 4C 42 D9     JMP $D942
00/D940: E6 AD        INC $AD
00/D942: A5 AD        LDA $AD
00/D944: C9 62        CMP #$62
00/D946: F0 03        BEQ $D94B
00/D948: 4C BA D8     JMP $D8BA
00/D94B: A9 00        LDA #$00
00/D94D: 20 99 8D     JSR $8D99       ; play sound effect
00/D950: 4C 5B E3     JMP $E35B       ; wait for vblank

00/D953: 14 18 1C 1F 1C 18 14 10

00/D95B: 06 04 02 00
00/D95F: 46 44 42 40
00/D963: 86 84 82 80
00/D967: C6 C4 C2 C0

00/D96B: C4 EC EC EC

; [  ]

00/D96F: 99 00 03     STA $0300,Y
00/D972: A5 23        LDA $23
00/D974: 29 01        AND #$01
00/D976: F0 06        BEQ $D97E
00/D978: A9 00        LDA #$00
00/D97A: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
00/D97E: 60           RTS 

; [  ]

00/D97F: A6 22        LDX $22
00/D981: E0 F0 3F     CPX #$3FF0
00/D984: B0 0D        BCS $D993
00/D986: E0 F0 00     CPX #$00F0
00/D989: 90 08        BCC $D993
00/D98B: A9 F0        LDA #$F0
00/D98D: 99 01 03     STA $0301,Y
00/D990: 4C 98 D9     JMP $D998
00/D993: A5 22        LDA $22
00/D995: 99 01 03     STA $0301,Y
00/D998: 60           RTS 

; [ special effect $02:  ]

00/D999: 64 AD        STZ $AD
00/D99B: A2 00 00     LDX #$0000
00/D99E: 8E FB 06     STX $06FB
00/D9A1: 86 24        STX $24
00/D9A3: A9 C4        LDA #$C4
00/D9A5: 85 8F        STA $8F
00/D9A7: A9 08        LDA #$08
00/D9A9: 85 90        STA $90
00/D9AB: A9 39        LDA #$39
00/D9AD: 85 91        STA $91
00/D9AF: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/D9B2: 20 21 DA     JSR $DA21
00/D9B5: C2 20        REP #$20
00/D9B7: AD FB 06     LDA $06FB
00/D9BA: 1A           INC 
00/D9BB: 8D FB 06     STA $06FB
00/D9BE: A5 24        LDA $24
00/D9C0: 1A           INC 
00/D9C1: 85 24        STA $24
00/D9C3: 4A           LSR 
00/D9C4: 4A           LSR 
00/D9C5: 29 FF 00     AND #$00FF
00/D9C8: E2 20        SEP #$20
00/D9CA: 85 AD        STA $AD
00/D9CC: C9 5F        CMP #$5F
00/D9CE: F0 03        BEQ $D9D3
00/D9D0: 4C AF D9     JMP $D9AF
00/D9D3: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $07:  ]

00/D9D6: A9 39        LDA #$39
00/D9D8: 85 91        STA $91
00/D9DA: A9 C0        LDA #$C0
00/D9DC: 4C E5 D9     JMP $D9E5

; [ special effect $08:  ]

00/D9DF: A9 35        LDA #$35
00/D9E1: 85 91        STA $91
00/D9E3: A9 C6        LDA #$C6
00/D9E5: 85 8F        STA $8F
00/D9E7: A9 5F        LDA #$5F
00/D9E9: 85 AD        STA $AD
00/D9EB: A2 7C 01     LDX #$017C
00/D9EE: 8E FB 06     STX $06FB
00/D9F1: 86 24        STX $24
00/D9F3: A9 10        LDA #$10
00/D9F5: 85 90        STA $90
00/D9F7: 20 4B 91     JSR $914B       ; wait one frame
00/D9FA: 20 21 DA     JSR $DA21
00/D9FD: C2 20        REP #$20
00/D9FF: AD FB 06     LDA $06FB
00/DA02: 3A           DEC 
00/DA03: 3A           DEC 
00/DA04: 8D FB 06     STA $06FB
00/DA07: A5 24        LDA $24
00/DA09: 3A           DEC 
00/DA0A: 3A           DEC 
00/DA0B: 85 24        STA $24
00/DA0D: 4A           LSR 
00/DA0E: 4A           LSR 
00/DA0F: 29 FF 00     AND #$00FF
00/DA12: E2 20        SEP #$20
00/DA14: 85 AD        STA $AD
00/DA16: F0 03        BEQ $DA1B
00/DA18: 4C F7 D9     JMP $D9F7
00/DA1B: 20 95 91     JSR $9195       ; reset sprites 0-63
00/DA1E: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/DA21: 20 94 DA     JSR $DA94
00/DA24: 64 20        STZ $20
00/DA26: 64 21        STZ $21
00/DA28: C2 20        REP #$20
00/DA2A: A5 20        LDA $20
00/DA2C: 0A           ASL 
00/DA2D: 0A           ASL 
00/DA2E: 0A           ASL 
00/DA2F: 0A           ASL 
00/DA30: 0A           ASL 
00/DA31: 18           CLC 
00/DA32: 69 00 01     ADC #$0100
00/DA35: 85 18        STA $18
00/DA37: AD FB 06     LDA $06FB
00/DA3A: 85 1A        STA $1A
00/DA3C: A9 00 00     LDA #$0000
00/DA3F: E2 20        SEP #$20
00/DA41: 22 8F C3 15  JSL $15C38F
00/DA45: A5 31        LDA $31
00/DA47: 20 79 DA     JSR $DA79
00/DA4A: 20 6F D9     JSR $D96F
00/DA4D: A5 31        LDA $31
00/DA4F: 18           CLC 
00/DA50: 69 40        ADC #$40
00/DA52: 20 79 DA     JSR $DA79
00/DA55: 20 7F D9     JSR $D97F
00/DA58: A5 8F        LDA $8F
00/DA5A: C9 C0        CMP #$C0
00/DA5C: D0 07        BNE $DA65
00/DA5E: A5 7A        LDA $7A
00/DA60: 29 02        AND #$02
00/DA62: 18           CLC 
00/DA63: 65 8F        ADC $8F
00/DA65: 99 02 03     STA $0302,Y
00/DA68: A5 91        LDA $91
00/DA6A: 99 03 03     STA $0303,Y
00/DA6D: E6 20        INC $20
00/DA6F: A5 20        LDA $20
00/DA71: C5 90        CMP $90
00/DA73: F0 03        BEQ $DA78
00/DA75: 4C 28 DA     JMP $DA28
00/DA78: 60           RTS 

; [  ]

00/DA79: 20 D0 90     JSR $90D0       ; calculate mode 7 trig function
00/DA7C: C2 20        REP #$20
00/DA7E: 98           TYA 
00/DA7F: 4A           LSR 
00/DA80: 4A           LSR 
00/DA81: 18           CLC 
00/DA82: 69 70 00     ADC #$0070
00/DA85: 85 22        STA $22
00/DA87: A9 00 00     LDA #$0000
00/DA8A: E2 20        SEP #$20
00/DA8C: A5 20        LDA $20
00/DA8E: 0A           ASL 
00/DA8F: 0A           ASL 
00/DA90: A8           TAY 
00/DA91: A5 22        LDA $22
00/DA93: 60           RTS 

; [  ]

00/DA94: A9 AA        LDA #$AA
00/DA96: A2 00 00     LDX #$0000
00/DA99: 9D 00 05     STA $0500,X
00/DA9C: E8           INX 
00/DA9D: E0 08 00     CPX #$0008
00/DAA0: D0 F7        BNE $DA99
00/DAA2: 60           RTS 

; [ special effect $00: red wings intro 1 ]

00/DAA3: A9 E1        LDA #$E1
00/DAA5: 8D 06 17     STA $1706       ; x position
00/DAA8: A9 FE        LDA #$FE
00/DAAA: 8D 07 17     STA $1707       ; y position
00/DAAD: 20 D2 DB     JSR $DBD2       ; load world map for red wings intro
00/DAB0: A2 80 00     LDX #$0080
00/DAB3: 20 DE E1     JSR $E1DE       ; wait
00/DAB6: 20 2D 91     JSR $912D       ; wait for vblank
00/DAB9: 20 BE DB     JSR $DBBE       ; increment screen brightness
00/DABC: A9 08        LDA #$08
00/DABE: 85 05        STA $05
00/DAC0: A9 01        LDA #$01        ; enable player control
00/DAC2: 85 D5        STA $D5
00/DAC4: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DAC7: A5 80        LDA $80
00/DAC9: C9 0F        CMP #$0F
00/DACB: D0 E9        BNE $DAB6       ; wait for fade in
00/DACD: A2 E0 01     LDX #$01E0      ; 480 frames (8 seconds)
00/DAD0: 86 89        STX $89
00/DAD2: 20 2D 91     JSR $912D       ; wait for vblank
00/DAD5: A9 08        LDA #$08
00/DAD7: 85 05        STA $05
00/DAD9: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DADC: A6 89        LDX $89
00/DADE: CA           DEX 
00/DADF: 86 89        STX $89
00/DAE1: D0 EF        BNE $DAD2
00/DAE3: 20 2D 91     JSR $912D       ; wait for vblank
00/DAE6: 20 AC DB     JSR $DBAC       ; decrement screen brightness
00/DAE9: A9 08        LDA #$08
00/DAEB: 85 05        STA $05
00/DAED: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DAF0: A5 80        LDA $80
00/DAF2: D0 EF        BNE $DAE3
00/DAF4: A9 03        LDA #$03        ; sub-map
00/DAF6: 8D 00 17     STA $1700
00/DAF9: 64 AC        STZ $AC         ; clear movement speed
00/DAFB: 9C 04 17     STZ $1704       ; no vehicle
00/DAFE: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $01: red wings intro 2 ]

00/DB01: A9 65        LDA #$65
00/DB03: 8D 06 17     STA $1706       ; x position
00/DB06: A9 00        LDA #$00
00/DB08: 8D 07 17     STA $1707       ; y position
00/DB0B: 20 D2 DB     JSR $DBD2       ; load world map for red wings intro
00/DB0E: 20 2D 91     JSR $912D       ; wait for vblank
00/DB11: 20 BE DB     JSR $DBBE       ; increment screen brightness
00/DB14: A9 08        LDA #$08
00/DB16: 85 05        STA $05         ; set scroll speed
00/DB18: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DB1B: A5 80        LDA $80
00/DB1D: C9 0F        CMP #$0F
00/DB1F: D0 ED        BNE $DB0E       ; wait for fade in
00/DB21: A2 10 01     LDX #$0110      ; 272 frames (~4.5 seconds)
00/DB24: 86 89        STX $89
00/DB26: 20 2D 91     JSR $912D       ; wait for vblank
00/DB29: A9 08        LDA #$08
00/DB2B: 85 05        STA $05         ; set scroll speed
00/DB2D: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DB30: A6 89        LDX $89
00/DB32: CA           DEX 
00/DB33: 86 89        STX $89
00/DB35: D0 EF        BNE $DB26
00/DB37: A2 40 00     LDX #$0040      ; 64 frames
00/DB3A: 86 89        STX $89
00/DB3C: 20 2D 91     JSR $912D       ; wait for vblank
00/DB3F: 64 05        STZ $05         ; stop scrolling
00/DB41: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DB44: A6 89        LDX $89
00/DB46: CA           DEX 
00/DB47: 86 89        STX $89
00/DB49: D0 F1        BNE $DB3C
00/DB4B: 20 53 8D     JSR $8D53       ; fade out music (slow)
00/DB4E: 20 2D 91     JSR $912D       ; wait for vblank
00/DB51: 64 05        STZ $05
00/DB53: 20 AC DB     JSR $DBAC       ; decrement screen brightness
00/DB56: A5 80        LDA $80
00/DB58: 18           CLC 
00/DB59: 69 10        ADC #$10        ; mode 7 zoom = screen brightness + $10
00/DB5B: 85 AD        STA $AD
00/DB5D: 20 71 DB     JSR $DB71       ; draw red wings sprites
00/DB60: A5 80        LDA $80
00/DB62: D0 EA        BNE $DB4E
00/DB64: A9 03        LDA #$03
00/DB66: 8D 00 17     STA $1700
00/DB69: 64 AC        STZ $AC
00/DB6B: 9C 04 17     STZ $1704
00/DB6E: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ draw red wings sprites ]

00/DB71: 20 77 91     JSR $9177       ; reset all sprites
00/DB74: 64 04        STZ $04
00/DB76: A9 01        LDA #$01        ; enable player control
00/DB78: 85 D5        STA $D5
00/DB7A: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/DB7D: 20 71 A8     JSR $A871
00/DB80: A0 00 00     LDY #$0000
00/DB83: 98           TYA 
00/DB84: 4A           LSR 
00/DB85: 4A           LSR 
00/DB86: 4A           LSR 
00/DB87: AA           TAX 
00/DB88: BD FA DB     LDA $DBFA,X     ; x position
00/DB8B: 85 0C        STA $0C
00/DB8D: BD FB DB     LDA $DBFB,X     ; y position
00/DB90: 85 0E        STA $0E
00/DB92: 20 13 E0     JSR $E013
00/DB95: A9 1C        LDA #$1C
00/DB97: 85 91        STA $91
00/DB99: A9 78        LDA #$78
00/DB9B: 85 8F        STA $8F
00/DB9D: 64 0D        STZ $0D
00/DB9F: 64 0F        STZ $0F
00/DBA1: 64 92        STZ $92
00/DBA3: 20 C4 DF     JSR $DFC4
00/DBA6: C0 50 00     CPY #$0050
00/DBA9: D0 D8        BNE $DB83
00/DBAB: 60           RTS 

; [ decrement screen brightness ]

00/DBAC: A5 7A        LDA $7A
00/DBAE: 29 07        AND #$07
00/DBB0: D0 06        BNE $DBB8
00/DBB2: A5 80        LDA $80
00/DBB4: F0 02        BEQ $DBB8
00/DBB6: C6 80        DEC $80
00/DBB8: A5 80        LDA $80
00/DBBA: 8D 00 21     STA $2100       ; set screen brightness
00/DBBD: 60           RTS 

; [ increment screen brightness ]

00/DBBE: A5 7A        LDA $7A
00/DBC0: 29 07        AND #$07
00/DBC2: D0 08        BNE $DBCC
00/DBC4: A5 80        LDA $80
00/DBC6: C9 0F        CMP #$0F
00/DBC8: F0 02        BEQ $DBCC
00/DBCA: E6 80        INC $80
00/DBCC: A5 80        LDA $80
00/DBCE: 8D 00 21     STA $2100       ; set screen brightness
00/DBD1: 60           RTS 

; [ load world map for red wings intro ]

00/DBD2: 9C 00 17     STZ $1700       ; overworld
00/DBD5: A9 04        LDA #$04        ; enterprise
00/DBD7: 8D 04 17     STA $1704
00/DBDA: 20 02 85     JSR $8502       ; load overworld
00/DBDD: A9 20        LDA #$20
00/DBDF: 85 AD        STA $AD         ; mode 7 zoom
00/DBE1: A9 10        LDA #$10
00/DBE3: 22 05 C5 15  JSL $15C505     ; update world map zoomed bg palettes
00/DBE7: A9 02        LDA #$02
00/DBE9: 85 AC        STA $AC         ; movement speed
00/DBEB: A9 81        LDA #$81
00/DBED: 8D 00 42     STA $4200       ; enable nmi
00/DBF0: 9C 00 21     STZ $2100       ; screen on, zero brightness
00/DBF3: 64 80        STZ $80
00/DBF5: 64 7B        STZ $7B
00/DBF7: 64 7A        STZ $7A
00/DBF9: 60           RTS 

; red wings sprite xy positions (5 * 2 bytes)
00/DBFA: 70 70 64 7C 7C 7C 54 8C 8C 8C

; [ special effect $15:  ]

00/DC04: A9 10        LDA #$10
00/DC06: 85 A2        STA $A2
00/DC08: 20 0B A6     JSR $A60B
00/DC0B: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $12:  ]

00/DC0E: A2 00 01     LDX #$0100
00/DC11: 86 2C        STX $2C
00/DC13: A2 70 00     LDX #$0070
00/DC16: 86 2E        STX $2E
00/DC18: A2 D0 00     LDX #$00D0
00/DC1B: 86 89        STX $89
00/DC1D: 20 58 DD     JSR $DD58
00/DC20: A6 2C        LDX $2C
00/DC22: CA           DEX 
00/DC23: 86 2C        STX $2C
00/DC25: E0 70 00     CPX #$0070
00/DC28: B0 05        BCS $DC2F
00/DC2A: A2 70 00     LDX #$0070
00/DC2D: 86 2C        STX $2C
00/DC2F: A6 89        LDX $89
00/DC31: CA           DEX 
00/DC32: 86 89        STX $89
00/DC34: D0 E7        BNE $DC1D
00/DC36: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $13:  ]

00/DC39: A2 70 00     LDX #$0070
00/DC3C: 86 2C        STX $2C
00/DC3E: A2 70 00     LDX #$0070
00/DC41: 86 2E        STX $2E
00/DC43: A2 D0 00     LDX #$00D0
00/DC46: 86 89        STX $89
00/DC48: 20 58 DD     JSR $DD58
00/DC4B: A6 89        LDX $89
00/DC4D: CA           DEX 
00/DC4E: 86 89        STX $89
00/DC50: E0 80 00     CPX #$0080
00/DC53: B0 F3        BCS $DC48
00/DC55: A6 2C        LDX $2C
00/DC57: CA           DEX 
00/DC58: 86 2C        STX $2C
00/DC5A: E0 F0 FF     CPX #$FFF0
00/DC5D: D0 E9        BNE $DC48
00/DC5F: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $14:  ]

00/DC62: A2 70 00     LDX #$0070
00/DC65: 86 2C        STX $2C
00/DC67: A2 78 00     LDX #$0078
00/DC6A: 86 2E        STX $2E
00/DC6C: A2 D0 00     LDX #$00D0
00/DC6F: 86 89        STX $89
00/DC71: 20 2D 91     JSR $912D       ; wait for vblank
00/DC74: A5 2E        LDA $2E
00/DC76: C9 10        CMP #$10
00/DC78: B0 03        BCS $DC7D
00/DC7A: 8D 00 21     STA $2100       ; set screen brightness
00/DC7D: 20 3A DD     JSR $DD3A
00/DC80: A6 2C        LDX $2C
00/DC82: 86 0C        STX $0C
00/DC84: A5 2E        LDA $2E
00/DC86: 38           SEC 
00/DC87: E9 08        SBC #$08
00/DC89: 85 0E        STA $0E
00/DC8B: A5 2F        LDA $2F
00/DC8D: E9 00        SBC #$00
00/DC8F: 85 0F        STA $0F
00/DC91: A9 1C        LDA #$1C
00/DC93: 85 91        STA $91
00/DC95: A9 D8        LDA #$D8
00/DC97: 85 8F        STA $8F
00/DC99: A0 90 01     LDY #$0190
00/DC9C: A9 60        LDA #$60
00/DC9E: 85 92        STA $92
00/DCA0: 20 C4 DF     JSR $DFC4
00/DCA3: A0 70 00     LDY #$0070
00/DCA6: 84 0E        STY $0E
00/DCA8: A0 50 01     LDY #$0150
00/DCAB: 20 13 E0     JSR $E013
00/DCAE: A0 68 00     LDY #$0068
00/DCB1: 84 0E        STY $0E
00/DCB3: A0 60 01     LDY #$0160
00/DCB6: 20 13 E0     JSR $E013
00/DCB9: A6 89        LDX $89
00/DCBB: CA           DEX 
00/DCBC: 86 89        STX $89
00/DCBE: E0 80 00     CPX #$0080
00/DCC1: B0 AE        BCS $DC71
00/DCC3: A6 2E        LDX $2E
00/DCC5: CA           DEX 
00/DCC6: 86 2E        STX $2E
00/DCC8: E0 00 00     CPX #$0000
00/DCCB: D0 A4        BNE $DC71
00/DCCD: 64 80        STZ $80
00/DCCF: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $2B:  ]

00/DCD2: A2 70 00     LDX #$0070
00/DCD5: 86 2C        STX $2C
00/DCD7: A2 78 00     LDX #$0078
00/DCDA: 86 2E        STX $2E
00/DCDC: 20 2D 91     JSR $912D       ; wait for vblank
00/DCDF: A5 2E        LDA $2E
00/DCE1: C9 10        CMP #$10
00/DCE3: B0 03        BCS $DCE8
00/DCE5: 8D 00 21     STA $2100       ; set screen brightness
00/DCE8: 20 3A DD     JSR $DD3A
00/DCEB: A0 78 00     LDY #$0078
00/DCEE: 84 0E        STY $0E
00/DCF0: A0 50 01     LDY #$0150
00/DCF3: 20 13 E0     JSR $E013
00/DCF6: A6 2E        LDX $2E
00/DCF8: CA           DEX 
00/DCF9: 86 2E        STX $2E
00/DCFB: E0 00 00     CPX #$0000
00/DCFE: D0 DC        BNE $DCDC
00/DD00: 64 80        STZ $80
00/DD02: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $2C:  ]

00/DD05: A9 0F        LDA #$0F
00/DD07: 85 80        STA $80
00/DD09: A2 70 00     LDX #$0070
00/DD0C: 86 2C        STX $2C
00/DD0E: A2 00 00     LDX #$0000
00/DD11: 86 2E        STX $2E
00/DD13: 20 2D 91     JSR $912D       ; wait for vblank
00/DD16: A5 2E        LDA $2E
00/DD18: C9 10        CMP #$10
00/DD1A: B0 03        BCS $DD1F
00/DD1C: 8D 00 21     STA $2100       ; set screen brightness
00/DD1F: 20 3A DD     JSR $DD3A
00/DD22: A0 78 00     LDY #$0078
00/DD25: 84 0E        STY $0E
00/DD27: A0 50 01     LDY #$0150
00/DD2A: 20 13 E0     JSR $E013
00/DD2D: A6 2E        LDX $2E
00/DD2F: E8           INX 
00/DD30: 86 2E        STX $2E
00/DD32: E0 78 00     CPX #$0078
00/DD35: D0 DC        BNE $DD13
00/DD37: 4C 5B E3     JMP $E35B       ; wait for vblank
00/DD3A: 20 77 91     JSR $9177       ; reset all sprites
00/DD3D: A6 2C        LDX $2C
00/DD3F: 86 0C        STX $0C
00/DD41: A6 2E        LDX $2E
00/DD43: 86 0E        STX $0E
00/DD45: A9 18        LDA #$18
00/DD47: 85 91        STA $91
00/DD49: A9 78        LDA #$78
00/DD4B: 85 8F        STA $8F
00/DD4D: A0 80 01     LDY #$0180
00/DD50: A9 60        LDA #$60
00/DD52: 85 92        STA $92
00/DD54: 20 C4 DF     JSR $DFC4
00/DD57: 60           RTS 
00/DD58: 20 2D 91     JSR $912D       ; wait for vblank
00/DD5B: 20 77 91     JSR $9177       ; reset all sprites
00/DD5E: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/DD62: A6 2C        LDX $2C
00/DD64: 86 0C        STX $0C
00/DD66: A6 2E        LDX $2E
00/DD68: 86 0E        STX $0E
00/DD6A: A9 1C        LDA #$1C
00/DD6C: 85 91        STA $91
00/DD6E: A9 78        LDA #$78
00/DD70: 85 8F        STA $8F
00/DD72: A0 80 01     LDY #$0180
00/DD75: A9 60        LDA #$60
00/DD77: 85 92        STA $92
00/DD79: 20 C4 DF     JSR $DFC4
00/DD7C: A0 70 00     LDY #$0070
00/DD7F: 84 0E        STY $0E
00/DD81: A0 40 01     LDY #$0140
00/DD84: 20 13 E0     JSR $E013
00/DD87: 60           RTS 

; [ special effect $17:  ]

00/DD88: 20 04 DE     JSR $DE04
00/DD8B: A2 C0 00     LDX #$00C0
00/DD8E: 86 89        STX $89
00/DD90: 20 2D 91     JSR $912D       ; wait for vblank
00/DD93: A6 89        LDX $89
00/DD95: E0 0F 00     CPX #$000F
00/DD98: B0 04        BCS $DD9E
00/DD9A: 8A           TXA 
00/DD9B: 8D 00 21     STA $2100       ; set screen brightness
00/DD9E: 20 77 91     JSR $9177       ; reset all sprites
00/DDA1: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/DDA5: 20 2A DE     JSR $DE2A
00/DDA8: A9 40        LDA #$40
00/DDAA: 20 43 DE     JSR $DE43
00/DDAD: A9 04        LDA #$04
00/DDAF: 85 05        STA $05
00/DDB1: 64 04        STZ $04
00/DDB3: 20 1B DE     JSR $DE1B
00/DDB6: A6 89        LDX $89
00/DDB8: CA           DEX 
00/DDB9: 86 89        STX $89
00/DDBB: D0 D3        BNE $DD90
00/DDBD: 64 80        STZ $80
00/DDBF: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ special effect $18:  ]

00/DDC2: 20 04 DE     JSR $DE04
00/DDC5: A2 B6 00     LDX #$00B6
00/DDC8: 86 89        STX $89
00/DDCA: 20 2D 91     JSR $912D       ; wait for vblank
00/DDCD: A6 89        LDX $89
00/DDCF: E0 0F 00     CPX #$000F
00/DDD2: B0 04        BCS $DDD8
00/DDD4: 8A           TXA 
00/DDD5: 8D 00 21     STA $2100       ; set screen brightness
00/DDD8: 20 77 91     JSR $9177       ; reset all sprites
00/DDDB: 22 DD B8 15  JSL $15B8DD     ; draw enterprise sprite
00/DDDF: 20 2A DE     JSR $DE2A
00/DDE2: A6 2C        LDX $2C
00/DDE4: A4 2E        LDY $2E
00/DDE6: 86 2E        STX $2E
00/DDE8: 84 2C        STY $2C
00/DDEA: A9 20        LDA #$20
00/DDEC: 20 43 DE     JSR $DE43
00/DDEF: A9 01        LDA #$01
00/DDF1: 85 05        STA $05
00/DDF3: 64 04        STZ $04
00/DDF5: 20 1B DE     JSR $DE1B
00/DDF8: A6 89        LDX $89
00/DDFA: CA           DEX 
00/DDFB: 86 89        STX $89
00/DDFD: D0 CB        BNE $DDCA
00/DDFF: 64 80        STZ $80
00/DE01: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/DE04: A9 04        LDA #$04
00/DE06: 8D 04 17     STA $1704
00/DE09: A9 10        LDA #$10
00/DE0B: 85 B7        STA $B7
00/DE0D: A9 0F        LDA #$0F
00/DE0F: 8D FD 06     STA $06FD       ; set airship animation speed
00/DE12: A9 03        LDA #$03
00/DE14: 85 AC        STA $AC
00/DE16: A9 20        LDA #$20
00/DE18: 85 AD        STA $AD
00/DE1A: 60           RTS 

; [  ]

00/DE1B: A9 01        LDA #$01        ; enable player control
00/DE1D: 85 D5        STA $D5
00/DE1F: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/DE22: 20 71 A8     JSR $A871
00/DE25: A9 20        LDA #$20
00/DE27: 85 AD        STA $AD
00/DE29: 60           RTS 

; [  ]

00/DE2A: A5 7A        LDA $7A
00/DE2C: 4A           LSR 
00/DE2D: 4A           LSR 
00/DE2E: 29 1F        AND #$1F
00/DE30: AA           TAX 
00/DE31: BF 86 FB 14  LDA $14FB86,X
00/DE35: 18           CLC 
00/DE36: 69 70        ADC #$70
00/DE38: 85 2C        STA $2C
00/DE3A: 64 2D        STZ $2D
00/DE3C: A9 50        LDA #$50
00/DE3E: 85 2E        STA $2E
00/DE40: 64 2F        STZ $2F
00/DE42: 60           RTS 

; [  ]

00/DE43: 48           PHA 
00/DE44: A0 D0 01     LDY #$01D0
00/DE47: A9 1C        LDA #$1C
00/DE49: 85 91        STA $91
00/DE4B: A9 78        LDA #$78
00/DE4D: 85 8F        STA $8F
00/DE4F: A6 2C        LDX $2C
00/DE51: 86 0C        STX $0C
00/DE53: A6 2E        LDX $2E
00/DE55: 86 0E        STX $0E
00/DE57: A9 20        LDA #$20
00/DE59: 85 AD        STA $AD
00/DE5B: 68           PLA 
00/DE5C: 85 92        STA $92
00/DE5E: 20 C4 DF     JSR $DFC4
00/DE61: A0 90 01     LDY #$0190
00/DE64: 20 13 E0     JSR $E013
00/DE67: 60           RTS 

; [ special effect $16: tanks vs. red wings ]

; this occurs when the player first enters the underground

00/DE68: A9 20        LDA #$20
00/DE6A: 8D CF 0A     STA $0ACF
00/DE6D: A9 00        LDA #$00
00/DE6F: 8D D0 0A     STA $0AD0
00/DE72: 8D D1 0A     STA $0AD1
00/DE75: A2 40 00     LDX #$0040
00/DE78: 8E D2 0A     STX $0AD2
00/DE7B: A9 01        LDA #$01
00/DE7D: 8D CD 0A     STA $0ACD
00/DE80: 9C CE 0A     STZ $0ACE
00/DE83: A9 40        LDA #$40        ; animation loop count: 64
00/DE85: 8D D4 0A     STA $0AD4
00/DE88: 8D D5 0A     STA $0AD5
00/DE8B: 20 75 E0     JSR $E075
00/DE8E: A2 FF 00     LDX #$00FF
00/DE91: 86 F3        STX $F3
00/DE93: A2 00 00     LDX #$0000
00/DE96: 86 F5        STX $F5
; start of animation loop
00/DE98: 20 4B 91     JSR $914B       ; wait one frame
00/DE9B: 20 77 91     JSR $9177       ; reset all sprites
00/DE9E: A6 F3        LDX $F3
00/DEA0: CA           DEX 
00/DEA1: 86 F3        STX $F3
00/DEA3: E0 C0 00     CPX #$00C0
00/DEA6: B0 17        BCS $DEBF
00/DEA8: A2 C0 00     LDX #$00C0
00/DEAB: 86 F3        STX $F3
00/DEAD: A9 01        LDA #$01
00/DEAF: 85 E3        STA $E3
00/DEB1: 20 B7 E0     JSR $E0B7       ; update explosion sprites
00/DEB4: A5 7A        LDA $7A
00/DEB6: 29 3F        AND #$3F
00/DEB8: D0 05        BNE $DEBF
00/DEBA: A9 23        LDA #$23
00/DEBC: 20 99 8D     JSR $8D99       ; play sound effect
00/DEBF: A2 70 00     LDX #$0070
00/DEC2: 86 0C        STX $0C
00/DEC4: 86 0E        STX $0E
00/DEC6: A0 C0 01     LDY #$01C0
00/DEC9: A9 1C        LDA #$1C
00/DECB: 85 91        STA $91
00/DECD: A9 78        LDA #$78
00/DECF: 85 8F        STA $8F
00/DED1: A9 40        LDA #$40
00/DED3: 85 92        STA $92
00/DED5: 20 C4 DF     JSR $DFC4
00/DED8: A9 80        LDA #$80
00/DEDA: 85 0E        STA $0E
00/DEDC: A0 80 01     LDY #$0180
00/DEDF: 20 13 E0     JSR $E013
00/DEE2: A9 1C        LDA #$1C
00/DEE4: 85 91        STA $91
00/DEE6: A9 78        LDA #$78
00/DEE8: 85 8F        STA $8F
00/DEEA: A9 60        LDA #$60
00/DEEC: 85 92        STA $92
00/DEEE: 20 53 DF     JSR $DF53
00/DEF1: A9 00        LDA #$00
00/DEF3: 38           SEC 
00/DEF4: E5 F3        SBC $F3
00/DEF6: 85 EF        STA $EF
00/DEF8: 64 F0        STZ $F0
00/DEFA: 64 F1        STZ $F1
00/DEFC: 64 F2        STZ $F2
00/DEFE: 64 79        STZ $79
00/DF00: A5 79        LDA $79
00/DF02: 0A           ASL 
00/DF03: A8           TAY 
00/DF04: 20 93 DF     JSR $DF93
00/DF07: A9 20        LDA #$20
00/DF09: 85 92        STA $92
00/DF0B: 20 C4 DF     JSR $DFC4
00/DF0E: E6 79        INC $79
00/DF10: A5 79        LDA $79
00/DF12: C9 04        CMP #$04        ;  wait 4 frames
00/DF14: D0 EA        BNE $DF00
00/DF16: AE D2 0A     LDX $0AD2
00/DF19: F0 03        BEQ $DF1E
00/DF1B: 4C 98 DE     JMP $DE98
00/DF1E: 64 E3        STZ $E3
00/DF20: 4C 5B E3     JMP $E35B       ; wait for vblank

; airship/tank position data
00/DF23: 00 00 18 00 00 00 18 00  ; airship x positions
00/DF2B: 40 00 60 00 80 00 A0 00  ; airship y positions
00/DF33: F8 FF D0 FF F8 FF D0 FF  ; tank x positions
00/DF3B: 20 00 3200 44 00 56 00
00/DF43: 50 00 70 00 90 00 C0 00  ; tank y positions
00/DF4B: 08 00 18 00 08 00 18 00

; [  ]

00/DF53: 64 79        STZ $79
00/DF55: A5 79        LDA $79
00/DF57: 0A           ASL 
00/DF58: A8           TAY 
00/DF59: C2 20        REP #$20
00/DF5B: B9 23 DF     LDA $DF23,Y
00/DF5E: 18           CLC 
00/DF5F: 65 F3        ADC $F3
00/DF61: 85 0C        STA $0C
00/DF63: B9 2B DF     LDA $DF2B,Y
00/DF66: 18           CLC 
00/DF67: 65 F5        ADC $F5
00/DF69: 85 0E        STA $0E
00/DF6B: A5 79        LDA $79
00/DF6D: 29 FF 00     AND #$00FF
00/DF70: 0A           ASL 
00/DF71: 0A           ASL 
00/DF72: 0A           ASL 
00/DF73: 0A           ASL 
00/DF74: 09 80 00     ORA #$0080
00/DF77: A8           TAY 
00/DF78: A9 00 00     LDA #$0000
00/DF7B: E2 20        SEP #$20
00/DF7D: 20 C4 DF     JSR $DFC4
00/DF80: A5 0E        LDA $0E
00/DF82: 18           CLC 
00/DF83: 69 10        ADC #$10
00/DF85: 85 0E        STA $0E
00/DF87: 20 13 E0     JSR $E013
00/DF8A: E6 79        INC $79
00/DF8C: A5 79        LDA $79
00/DF8E: C9 04        CMP #$04
00/DF90: D0 C3        BNE $DF55
00/DF92: 60           RTS 

; [  ]

00/DF93: C2 20        REP #$20
00/DF95: B9 33 DF     LDA $DF33,Y
00/DF98: 18           CLC 
00/DF99: 65 EF        ADC $EF
00/DF9B: 85 0C        STA $0C
00/DF9D: B9 43 DF     LDA $DF43,Y
00/DFA0: 18           CLC 
00/DFA1: 65 F1        ADC $F1
00/DFA3: 85 0E        STA $0E
00/DFA5: 98           TYA 
00/DFA6: 29 07 00     AND #$0007
00/DFA9: 4A           LSR 
00/DFAA: 29 FF 00     AND #$00FF
00/DFAD: 0A           ASL 
00/DFAE: 0A           ASL 
00/DFAF: 0A           ASL 
00/DFB0: 0A           ASL 
00/DFB1: 18           CLC 
00/DFB2: 69 44 01     ADC #$0144
00/DFB5: A8           TAY 
00/DFB6: A9 00 00     LDA #$0000
00/DFB9: E2 20        SEP #$20
00/DFBB: A9 18        LDA #$18
00/DFBD: 85 91        STA $91
00/DFBF: A9 A8        LDA #$A8
00/DFC1: 85 8F        STA $8F
00/DFC3: 60           RTS 

; [ draw tank sprite ??? ]

00/DFC4: A5 7A        LDA $7A
00/DFC6: 29 02        AND #$02
00/DFC8: 0A           ASL 
00/DFC9: 0A           ASL 
00/DFCA: 0A           ASL 
00/DFCB: 18           CLC 
00/DFCC: 65 92        ADC $92
00/DFCE: AA           TAX 
00/DFCF: BF B4 BF 15  LDA $15BFB4,X
00/DFD3: 18           CLC 
00/DFD4: 65 0C        ADC $0C
00/DFD6: 99 00 03     STA $0300,Y
00/DFD9: A5 0D        LDA $0D
00/DFDB: 69 00        ADC #$00
00/DFDD: 29 01        AND #$01
00/DFDF: F0 06        BEQ $DFE7
00/DFE1: A9 00        LDA #$00
00/DFE3: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
00/DFE7: BF B5 BF 15  LDA $15BFB5,X
00/DFEB: 18           CLC 
00/DFEC: 65 0E        ADC $0E
00/DFEE: 38           SEC 
00/DFEF: E5 AD        SBC $AD
00/DFF1: 18           CLC 
00/DFF2: 69 08        ADC #$08
00/DFF4: 99 01 03     STA $0301,Y
00/DFF7: BF B6 BF 15  LDA $15BFB6,X
00/DFFB: 18           CLC 
00/DFFC: 65 8F        ADC $8F
00/DFFE: 99 02 03     STA $0302,Y
00/E001: BF B7 BF 15  LDA $15BFB7,X
00/E005: 05 91        ORA $91
00/E007: 99 03 03     STA $0303,Y
00/E00A: 20 E2 88     JSR $88E2       ; next sprite
00/E00D: 8A           TXA 
00/E00E: 29 0F        AND #$0F
00/E010: D0 BD        BNE $DFCF
00/E012: 60           RTS 

; [ draw airship sprite ??? ]

00/E013: A5 AD        LDA $AD
00/E015: C9 20        CMP #$20
00/E017: F0 06        BEQ $E01F
00/E019: A5 7A        LDA $7A
00/E01B: 4A           LSR 
00/E01C: 90 01        BCC $E01F
00/E01E: 60           RTS 
00/E01F: A5 AD        LDA $AD
00/E021: 38           SEC 
00/E022: E9 10        SBC #$10
00/E024: 29 FC        AND #$FC
00/E026: AA           TAX 
00/E027: A5 0C        LDA $0C
00/E029: 99 50 03     STA $0350,Y
00/E02C: A5 0D        LDA $0D
00/E02E: 29 01        AND #$01
00/E030: F0 06        BEQ $E038
00/E032: A9 14        LDA #$14
00/E034: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
00/E038: A5 0E        LDA $0E
00/E03A: 99 51 03     STA $0351,Y
00/E03D: BF C9 B8 15  LDA $15B8C9,X
00/E041: 99 52 03     STA $0352,Y
00/E044: BF CA B8 15  LDA $15B8CA,X
00/E048: 99 53 03     STA $0353,Y
00/E04B: A5 0C        LDA $0C
00/E04D: 18           CLC 
00/E04E: 69 08        ADC #$08
00/E050: 99 54 03     STA $0354,Y
00/E053: A5 0D        LDA $0D
00/E055: 69 00        ADC #$00
00/E057: 29 01        AND #$01
00/E059: F0 06        BEQ $E061
00/E05B: A9 15        LDA #$15
00/E05D: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
00/E061: A5 0E        LDA $0E
00/E063: 99 55 03     STA $0355,Y
00/E066: BF CB B8 15  LDA $15B8CB,X
00/E06A: 99 56 03     STA $0356,Y
00/E06D: BF CC B8 15  LDA $15B8CC,X
00/E071: 99 57 03     STA $0357,Y
00/E074: 60           RTS 

; [  ]

00/E075: 64 E5        STZ $E5
00/E077: AD CD 0A     LDA $0ACD
00/E07A: 0A           ASL 
00/E07B: 0A           ASL 
00/E07C: 0A           ASL 
00/E07D: 0A           ASL 
00/E07E: 0A           ASL 
00/E07F: A8           TAY 
00/E080: A2 00 00     LDX #$0000
00/E083: AD CE 0A     LDA $0ACE
00/E086: D0 0A        BNE $E092
00/E088: BF F0 81 0D  LDA $0D81F0,X   ; vehicle palette ???
00/E08C: 99 DB 0D     STA $0DDB,Y
00/E08F: 4C 99 E0     JMP $E099
00/E092: BF 00 82 0D  LDA $0D8200,X
00/E096: 99 FB 0D     STA $0DFB,Y
00/E099: C8           INY 
00/E09A: E8           INX 
00/E09B: E0 10 00     CPX #$0010
00/E09E: D0 E3        BNE $E083
00/E0A0: A2 00 00     LDX #$0000
00/E0A3: 8A           TXA 
00/E0A4: 4A           LSR 
00/E0A5: 4A           LSR 
00/E0A6: 29 03        AND #$03
00/E0A8: 49 FF        EOR #$FF
00/E0AA: 9D 6D 0A     STA $0A6D,X     ; $FF, $FE, $FD, $FC, repeat
00/E0AD: E8           INX 
00/E0AE: E8           INX 
00/E0AF: E8           INX 
00/E0B0: E8           INX 
00/E0B1: E0 40 00     CPX #$0040
00/E0B4: D0 ED        BNE $E0A3
00/E0B6: 60           RTS 

; [ update explosion sprites ]

00/E0B7: 20 95 91     JSR $9195       ; reset sprites 0-63
00/E0BA: 20 C0 E1     JSR $E1C0       ; set large sprite flag (32 sprites)
00/E0BD: A2 00 00     LDX #$0000
00/E0C0: 86 24        STX $24
00/E0C2: A6 24        LDX $24
00/E0C4: A5 7A        LDA $7A
00/E0C6: 29 07        AND #$07
00/E0C8: D0 03        BNE $E0CD
00/E0CA: FE 6D 0A     INC $0A6D,X
00/E0CD: BD 6D 0A     LDA $0A6D,X
00/E0D0: 10 03        BPL $E0D5
00/E0D2: 4C 3D E1     JMP $E13D
00/E0D5: F0 04        BEQ $E0DB
00/E0D7: C9 04        CMP #$04
00/E0D9: D0 57        BNE $E132
00/E0DB: A5 7A        LDA $7A
00/E0DD: 29 07        AND #$07
00/E0DF: D0 51        BNE $E132
00/E0E1: A5 E5        LDA $E5
00/E0E3: D0 53        BNE $E138
00/E0E5: 9E 6D 0A     STZ $0A6D,X
00/E0E8: A5 C7        LDA $C7
00/E0EA: D0 29        BNE $E115
00/E0EC: AD D0 0A     LDA $0AD0
00/E0EF: AA           TAX 
00/E0F0: 20 28 C4     JSR $C428       ; random (0..255)
00/E0F3: 3D BC E1     AND $E1BC,X
00/E0F6: 18           CLC 
00/E0F7: 6D D4 0A     ADC $0AD4
00/E0FA: A6 24        LDX $24
00/E0FC: 9D 6E 0A     STA $0A6E,X
00/E0FF: AD D1 0A     LDA $0AD1
00/E102: AA           TAX 
00/E103: 20 28 C4     JSR $C428       ; random (0..255)
00/E106: 3D BC E1     AND $E1BC,X
00/E109: 18           CLC 
00/E10A: 6D D5 0A     ADC $0AD5
00/E10D: A6 24        LDX $24
00/E10F: 9D 6F 0A     STA $0A6F,X
00/E112: 4C 32 E1     JMP $E132
00/E115: A5 C7        LDA $C7
00/E117: 3A           DEC 
00/E118: 29 0F        AND #$0F
00/E11A: 0A           ASL 
00/E11B: A8           TAY 
00/E11C: B9 EF C9     LDA $C9EF,Y     ; x position on a circle
00/E11F: 18           CLC 
00/E120: 6D D4 0A     ADC $0AD4
00/E123: 9D 6E 0A     STA $0A6E,X
00/E126: B9 F0 C9     LDA $C9F0,Y     ; y position on a circle
00/E129: 18           CLC 
00/E12A: 6D D5 0A     ADC $0AD5
00/E12D: 9D 6F 0A     STA $0A6F,X
00/E130: E6 C7        INC $C7
00/E132: 20 5A E1     JSR $E15A
00/E135: 4C 3D E1     JMP $E13D
00/E138: A9 FF        LDA #$FF
00/E13A: 9D 6D 0A     STA $0A6D,X
00/E13D: A5 24        LDA $24
00/E13F: 18           CLC 
00/E140: 69 04        ADC #$04
00/E142: 85 24        STA $24
00/E144: CD CF 0A     CMP $0ACF
00/E147: F0 03        BEQ $E14C
00/E149: 4C C2 E0     JMP $E0C2
00/E14C: A5 7A        LDA $7A
00/E14E: 29 07        AND #$07
00/E150: D0 07        BNE $E159
00/E152: AE D2 0A     LDX $0AD2
00/E155: CA           DEX 
00/E156: 8E D2 0A     STX $0AD2
00/E159: 60           RTS 

; [ draw explosion sprite ??? ]

00/E15A: BD 6D 0A     LDA $0A6D,X
00/E15D: A8           TAY 
00/E15E: B9 B4 E1     LDA $E1B4,Y
00/E161: A8           TAY 
00/E162: BD 6E 0A     LDA $0A6E,X
00/E165: 85 20        STA $20
00/E167: BD 6F 0A     LDA $0A6F,X
00/E16A: 85 21        STA $21
00/E16C: A5 24        LDA $24
00/E16E: 0A           ASL 
00/E16F: 0A           ASL 
00/E170: AA           TAX 
00/E171: DA           PHX 
00/E172: 5A           PHY 
00/E173: FA           PLX 
00/E174: 7A           PLY 
00/E175: A5 20        LDA $20
00/E177: 18           CLC 
00/E178: 7F D6 F9 14  ADC $14F9D6,X
00/E17C: 99 00 03     STA $0300,Y
00/E17F: BF D7 F9 14  LDA $14F9D7,X
00/E183: C9 FF        CMP #$FF
00/E185: F0 0A        BEQ $E191
00/E187: A5 21        LDA $21
00/E189: 18           CLC 
00/E18A: 7F D7 F9 14  ADC $14F9D7,X
00/E18E: 4C 93 E1     JMP $E193
00/E191: A9 F0        LDA #$F0
00/E193: 99 01 03     STA $0301,Y
00/E196: BF D8 F9 14  LDA $14F9D8,X
00/E19A: 99 02 03     STA $0302,Y
00/E19D: AD CD 0A     LDA $0ACD
00/E1A0: 0A           ASL 
00/E1A1: 0D CE 0A     ORA $0ACE
00/E1A4: 1F D9 F9 14  ORA $14F9D9,X
00/E1A8: 99 03 03     STA $0303,Y
00/E1AB: 20 E2 88     JSR $88E2       ; next sprite
00/E1AE: 8A           TXA 
00/E1AF: 29 0F        AND #$0F
00/E1B1: D0 C2        BNE $E175
00/E1B3: 60           RTS 

00/E1B4: 00 10 20 30 20 30 20 30

00/E1BC: 7C 3C 1C 0C

; [ set large sprite flag (32 sprites) ]

00/E1C0: A2 00 00     LDX #$0000
00/E1C3: A9 AA        LDA #$AA
00/E1C5: 9D 00 05     STA $0500,X
00/E1C8: E8           INX 
00/E1C9: E0 08 00     CPX #$0008
00/E1CC: D0 F7        BNE $E1C5
00/E1CE: 60           RTS 

; [ set large sprite flag (64 sprites) ]

00/E1CF: A2 00 00     LDX #$0000
00/E1D2: A9 AA        LDA #$AA
00/E1D4: 9D 00 05     STA $0500,X
00/E1D7: E8           INX 
00/E1D8: E0 10 00     CPX #$0010
00/E1DB: D0 F7        BNE $E1D4
00/E1DD: 60           RTS 

; [ wait ]

; X: number of frames

00/E1DE: 86 89        STX $89
00/E1E0: 20 2D 91     JSR $912D       ; wait for vblank
00/E1E3: A6 89        LDX $89
00/E1E5: CA           DEX 
00/E1E6: 86 89        STX $89
00/E1E8: D0 F6        BNE $E1E0
00/E1EA: 60           RTS 

; --------------------------------------------------------------------------

; [ execute event ]

; A: event id

00/E1EB: 64 3E        STZ $3E
00/E1ED: 0A           ASL 
00/E1EE: 26 3E        ROL $3E
00/E1F0: 85 3D        STA $3D
00/E1F2: A6 3D        LDX $3D
00/E1F4: BF 00 80 12  LDA $128000,X
00/E1F8: 8D D3 09     STA $09D3
00/E1FB: BF 01 80 12  LDA $128001,X
00/E1FF: 8D D4 09     STA $09D4
00/E202: A9 0F        LDA #$0F
00/E204: 85 80        STA $80
00/E206: A0 00 00     LDY #$0000
00/E209: A9 01        LDA #$01
00/E20B: 8D 15 0A     STA $0A15
00/E20E: AE D3 09     LDX $09D3
00/E211: BF 00 82 12  LDA $128200,X
00/E215: C9 FF        CMP #$FF
00/E217: D0 1D        BNE $E236
00/E219: AD 03 17     LDA $1703
00/E21C: 64 3D        STZ $3D
00/E21E: 4A           LSR 
00/E21F: 66 3D        ROR $3D
00/E221: 4A           LSR 
00/E222: 66 3D        ROR $3D
00/E224: 85 3E        STA $3E
00/E226: A6 3D        LDX $3D
00/E228: BD 00 10     LDA $1000,X
00/E22B: D0 04        BNE $E231
00/E22D: 22 5E C8 15  JSL $15C85E     ; validate showing character
00/E231: A9 01        LDA #$01
00/E233: 85 E0        STA $E0
00/E235: 60           RTS 
00/E236: C9 EB        CMP #$EB
00/E238: D0 20        BNE $E25A
00/E23A: E8           INX 
00/E23B: BF 00 82 12  LDA $128200,X
00/E23F: 8D 15 0A     STA $0A15
00/E242: E8           INX 
00/E243: BF 00 82 12  LDA $128200,X
00/E247: 85 07        STA $07
00/E249: E8           INX 
00/E24A: BF 00 82 12  LDA $128200,X
00/E24E: 99 D5 09     STA $09D5,Y
00/E251: E8           INX 
00/E252: C8           INY 
00/E253: C6 07        DEC $07
00/E255: D0 F3        BNE $E24A
00/E257: 4C 8F E2     JMP $E28F
00/E25A: C9 DB        CMP #$DB
00/E25C: 90 2C        BCC $E28A
00/E25E: C9 E2        CMP #$E2
00/E260: F0 16        BEQ $E278
00/E262: C9 FE        CMP #$FE
00/E264: D0 1B        BNE $E281
00/E266: 99 D5 09     STA $09D5,Y
00/E269: E8           INX 
00/E26A: C8           INY 
00/E26B: BF 00 82 12  LDA $128200,X
00/E26F: 99 D5 09     STA $09D5,Y
00/E272: E8           INX 
00/E273: C8           INY 
00/E274: BF 00 82 12  LDA $128200,X
00/E278: 99 D5 09     STA $09D5,Y
00/E27B: E8           INX 
00/E27C: C8           INY 
00/E27D: BF 00 82 12  LDA $128200,X
00/E281: 99 D5 09     STA $09D5,Y
00/E284: E8           INX 
00/E285: C8           INY 
00/E286: BF 00 82 12  LDA $128200,X
00/E28A: 99 D5 09     STA $09D5,Y
00/E28D: E8           INX 
00/E28E: C8           INY 
00/E28F: 8E D3 09     STX $09D3
00/E292: A9 FF        LDA #$FF
00/E294: 99 D5 09     STA $09D5,Y
00/E297: 20 A2 E2     JSR $E2A2
00/E29A: CE 15 0A     DEC $0A15
00/E29D: D0 F8        BNE $E297
00/E29F: 4C 06 E2     JMP $E206
00/E2A2: A2 00 00     LDX #$0000
00/E2A5: 86 B3        STX $B3
00/E2A7: BD D5 09     LDA $09D5,X
00/E2AA: 8D 16 0A     STA $0A16
00/E2AD: C9 D0        CMP #$D0
00/E2AF: 90 03        BCC $E2B4
00/E2B1: 4C 40 E3     JMP $E340
00/E2B4: A6 B3        LDX $B3
00/E2B6: BD D5 09     LDA $09D5,X
00/E2B9: 8D 16 0A     STA $0A16
00/E2BC: C9 FF        CMP #$FF
00/E2BE: D0 03        BNE $E2C3
00/E2C0: 4C D8 E2     JMP $E2D8
00/E2C3: C9 C0        CMP #$C0
00/E2C5: B0 06        BCS $E2CD
00/E2C7: 20 5F E3     JSR $E35F
00/E2CA: 4C D0 E2     JMP $E2D0
00/E2CD: 20 A9 E4     JSR $E4A9
00/E2D0: A6 B3        LDX $B3
00/E2D2: E8           INX 
00/E2D3: 86 B3        STX $B3
00/E2D5: 4C B4 E2     JMP $E2B4
00/E2D8: 20 2D 91     JSR $912D       ; wait for vblank
00/E2DB: 64 D5        STZ $D5         ; disable player control
00/E2DD: 20 77 91     JSR $9177       ; reset all sprites
00/E2E0: 20 6C 9F     JSR $9F6C       ; update local tile properties
00/E2E3: AD 00 17     LDA $1700
00/E2E6: C9 03        CMP #$03
00/E2E8: F0 15        BEQ $E2FF
00/E2EA: 20 71 A8     JSR $A871
00/E2ED: 20 C0 94     JSR $94C0       ; draw world map sprites
00/E2F0: A5 AC        LDA $AC
00/E2F2: AA           TAX 
00/E2F3: A5 7B        LDA $7B
00/E2F5: 3D 4F E5     AND $E54F,X
00/E2F8: D0 DE        BNE $E2D8
00/E2FA: 64 AB        STZ $AB
00/E2FC: 4C 3B E3     JMP $E33B
00/E2FF: 20 71 A8     JSR $A871
00/E302: 20 0C C0     JSR $C00C       ; move npcs
00/E305: 22 E0 B1 15  JSL $15B1E0     ; draw player sprite
00/E309: 20 68 BB     JSR $BB68       ; draw npcs
00/E30C: A5 AB        LDA $AB
00/E30E: F0 0C        BEQ $E31C
00/E310: A5 AC        LDA $AC
00/E312: AA           TAX 
00/E313: A5 7B        LDA $7B
00/E315: 3D 4F E5     AND $E54F,X
00/E318: D0 BE        BNE $E2D8
00/E31A: 64 AB        STZ $AB
00/E31C: A2 00 00     LDX #$0000
00/E31F: 86 3D        STX $3D
00/E321: AD FE 08     LDA $08FE
00/E324: F0 15        BEQ $E33B
00/E326: A8           TAY 
00/E327: A6 3D        LDX $3D
00/E329: BD 08 09     LDA $0908,X
00/E32C: D0 AA        BNE $E2D8
00/E32E: 9E 0C 09     STZ $090C,X
00/E331: A5 3D        LDA $3D
00/E333: 18           CLC 
00/E334: 69 0F        ADC #$0F
00/E336: 85 3D        STA $3D
00/E338: 88           DEY 
00/E339: D0 EC        BNE $E327
00/E33B: A9 01        LDA #$01        ; enable player control
00/E33D: 85 D5        STA $D5
00/E33F: 60           RTS 
00/E340: 38           SEC 
00/E341: E9 D0        SBC #$D0
00/E343: 64 3E        STZ $3E
00/E345: 0A           ASL 
00/E346: 26 3E        ROL $3E
00/E348: 85 3D        STA $3D
00/E34A: A6 3D        LDX $3D
00/E34C: BD 6E E5     LDA $E56E,X
00/E34F: 85 3D        STA $3D
00/E351: BD 6F E5     LDA $E56F,X
00/E354: 85 3E        STA $3E
00/E356: A6 B3        LDX $B3
00/E358: 6C 3D 06     JMP ($063D)

; [ wait for vblank ]

00/E35B: 20 2D 91     JSR $912D       ; wait for vblank
00/E35E: 60           RTS 

; [  ]

00/E35F: 85 AE        STA $AE
00/E361: 4A           LSR 
00/E362: 4A           LSR 
00/E363: 4A           LSR 
00/E364: 4A           LSR 
00/E365: A8           TAY 
00/E366: A9 00        LDA #$00
00/E368: C0 00 00     CPY #$0000
00/E36B: F0 07        BEQ $E374
00/E36D: 88           DEY 
00/E36E: 18           CLC 
00/E36F: 69 0F        ADC #$0F
00/E371: 4C 68 E3     JMP $E368
00/E374: AA           TAX 
00/E375: 8E 47 0A     STX $0A47
00/E378: A9 40        LDA #$40
00/E37A: 9D 08 09     STA $0908,X
00/E37D: A5 AE        LDA $AE
00/E37F: 29 0F        AND #$0F
00/E381: C9 04        CMP #$04
00/E383: B0 18        BCS $E39D
00/E385: 1A           INC 
00/E386: 9D 02 09     STA $0902,X
00/E389: A5 CF        LDA $CF
00/E38B: D0 07        BNE $E394
00/E38D: BD 02 09     LDA $0902,X
00/E390: 3A           DEC 
00/E391: 9D 09 09     STA $0909,X
00/E394: A5 EA        LDA $EA
00/E396: D0 02        BNE $E39A
00/E398: E6 EA        INC $EA
00/E39A: 4C 98 E4     JMP $E498
00/E39D: C9 08        CMP #$08
00/E39F: B0 09        BCS $E3AA
00/E3A1: 38           SEC 
00/E3A2: E9 04        SBC #$04
00/E3A4: 9D 09 09     STA $0909,X
00/E3A7: 4C A5 E4     JMP $E4A5
00/E3AA: C9 08        CMP #$08
00/E3AC: D0 58        BNE $E406
00/E3AE: 9E 02 09     STZ $0902,X
00/E3B1: BD 06 09     LDA $0906,X
00/E3B4: 85 3E        STA $3E
00/E3B6: 64 3D        STZ $3D
00/E3B8: 46 3E        LSR $3E
00/E3BA: 66 3D        ROR $3D
00/E3BC: 46 3E        LSR $3E
00/E3BE: 66 3D        ROR $3D
00/E3C0: 46 3E        LSR $3E
00/E3C2: 66 3D        ROR $3D
00/E3C4: A5 3D        LDA $3D
00/E3C6: 18           CLC 
00/E3C7: 7D 04 09     ADC $0904,X
00/E3CA: 85 3D        STA $3D
00/E3CC: A5 AE        LDA $AE
00/E3CE: 4A           LSR 
00/E3CF: 4A           LSR 
00/E3D0: 4A           LSR 
00/E3D1: 4A           LSR 
00/E3D2: 18           CLC 
00/E3D3: 69 80        ADC #$80
00/E3D5: 85 06        STA $06
00/E3D7: BD 0B 09     LDA $090B,X
00/E3DA: F0 18        BEQ $E3F4
00/E3DC: 9E 0B 09     STZ $090B,X
00/E3DF: DA           PHX 
00/E3E0: A6 3D        LDX $3D
00/E3E2: BF 00 4C 7F  LDA $7F4C00,X
00/E3E6: C5 06        CMP $06
00/E3E8: D0 06        BNE $E3F0
00/E3EA: A9 00        LDA #$00
00/E3EC: 9F 00 4C 7F  STA $7F4C00,X
00/E3F0: FA           PLX 
00/E3F1: 4C A5 E4     JMP $E4A5
00/E3F4: A9 01        LDA #$01
00/E3F6: 9D 0B 09     STA $090B,X
00/E3F9: DA           PHX 
00/E3FA: A6 3D        LDX $3D
00/E3FC: A5 06        LDA $06
00/E3FE: 9F 00 4C 7F  STA $7F4C00,X
00/E402: FA           PLX 
00/E403: 4C A5 E4     JMP $E4A5
00/E406: C9 09        CMP #$09
00/E408: D0 3A        BNE $E444
00/E40A: BD 09 09     LDA $0909,X
00/E40D: 29 01        AND #$01
00/E40F: F0 10        BEQ $E421
00/E411: BD 09 09     LDA $0909,X
00/E414: 29 02        AND #$02
00/E416: D0 16        BNE $E42E
00/E418: A9 02        LDA #$02
00/E41A: 9D 02 09     STA $0902,X
00/E41D: 3A           DEC 
00/E41E: 9D 09 09     STA $0909,X
00/E421: A9 01        LDA #$01
00/E423: 9D 0C 09     STA $090C,X
00/E426: A9 80        LDA #$80
00/E428: 9D 08 09     STA $0908,X
00/E42B: 4C 98 E4     JMP $E498
00/E42E: A9 04        LDA #$04
00/E430: 9D 02 09     STA $0902,X
00/E433: 3A           DEC 
00/E434: 9D 09 09     STA $0909,X
00/E437: A9 01        LDA #$01
00/E439: 9D 0C 09     STA $090C,X
00/E43C: A9 80        LDA #$80
00/E43E: 9D 08 09     STA $0908,X
00/E441: 4C 98 E4     JMP $E498
00/E444: C9 0A        CMP #$0A
00/E446: D0 10        BNE $E458
00/E448: 9E FF 08     STZ $08FF,X
00/E44B: A9 02        LDA #$02
00/E44D: 9D 0C 09     STA $090C,X
00/E450: A9 40        LDA #$40
00/E452: 9D 08 09     STA $0908,X
00/E455: 4C A5 E4     JMP $E4A5
00/E458: C9 0B        CMP #$0B
00/E45A: D0 10        BNE $E46C
00/E45C: 9E FF 08     STZ $08FF,X
00/E45F: A9 03        LDA #$03
00/E461: 9D 0C 09     STA $090C,X
00/E464: A9 80        LDA #$80
00/E466: 9D 08 09     STA $0908,X
00/E469: 4C A5 E4     JMP $E4A5
00/E46C: C9 0C        CMP #$0C
00/E46E: D0 08        BNE $E478
00/E470: A9 05        LDA #$05
00/E472: 9D 09 09     STA $0909,X
00/E475: 4C A5 E4     JMP $E4A5
00/E478: C9 0D        CMP #$0D
00/E47A: D0 08        BNE $E484
00/E47C: A9 04        LDA #$04
00/E47E: 9D 09 09     STA $0909,X
00/E481: 4C A5 E4     JMP $E4A5
00/E484: C9 0E        CMP #$0E
00/E486: D0 08        BNE $E490
00/E488: A9 06        LDA #$06
00/E48A: 9D 09 09     STA $0909,X
00/E48D: 4C A5 E4     JMP $E4A5
00/E490: A9 07        LDA #$07
00/E492: 9D 09 09     STA $0909,X
00/E495: 4C A5 E4     JMP $E4A5
00/E498: BD 04 09     LDA $0904,X
00/E49B: 85 0C        STA $0C
00/E49D: BD 06 09     LDA $0906,X
00/E4A0: 85 0E        STA $0E
00/E4A2: 20 FD C2     JSR $C2FD       ; clear npc map position
00/E4A5: 9E FF 08     STZ $08FF,X
00/E4A8: 60           RTS 

; [  ]

00/E4A9: C9 C4        CMP #$C4
00/E4AB: B0 12        BCS $E4BF
00/E4AD: 38           SEC 
00/E4AE: E9 C0        SBC #$C0
00/E4B0: 0A           ASL 
00/E4B1: A8           TAY 
00/E4B2: B9 47 E5     LDA $E547,Y
00/E4B5: 85 04        STA $04
00/E4B7: B9 48 E5     LDA $E548,Y
00/E4BA: 85 05        STA $05
00/E4BC: 4C 34 E5     JMP $E534
00/E4BF: 64 04        STZ $04
00/E4C1: 64 05        STZ $05
00/E4C3: C9 C8        CMP #$C8
00/E4C5: B0 09        BCS $E4D0
00/E4C7: 38           SEC 
00/E4C8: E9 C4        SBC #$C4
00/E4CA: 8D 05 17     STA $1705
00/E4CD: 4C 34 E5     JMP $E534
00/E4D0: C9 C8        CMP #$C8
00/E4D2: D0 07        BNE $E4DB
00/E4D4: A9 01        LDA #$01
00/E4D6: 85 D3        STA $D3
00/E4D8: 4C 34 E5     JMP $E534
00/E4DB: C9 C9        CMP #$C9
00/E4DD: D0 05        BNE $E4E4
00/E4DF: 64 D3        STZ $D3
00/E4E1: 4C 34 E5     JMP $E534
00/E4E4: C9 CA        CMP #$CA
00/E4E6: D0 08        BNE $E4F0
00/E4E8: A9 05        LDA #$05
00/E4EA: 8D 05 17     STA $1705
00/E4ED: 4C 2E E5     JMP $E52E
00/E4F0: C9 CB        CMP #$CB
00/E4F2: D0 08        BNE $E4FC
00/E4F4: A9 04        LDA #$04
00/E4F6: 8D 05 17     STA $1705
00/E4F9: 4C 2E E5     JMP $E52E
00/E4FC: C9 CC        CMP #$CC
00/E4FE: D0 08        BNE $E508
00/E500: A9 06        LDA #$06
00/E502: 8D 05 17     STA $1705
00/E505: 4C 2E E5     JMP $E52E
00/E508: C9 CD        CMP #$CD
00/E50A: D0 08        BNE $E514
00/E50C: A9 07        LDA #$07
00/E50E: 8D 05 17     STA $1705
00/E511: 4C 2E E5     JMP $E52E
00/E514: C9 CE        CMP #$CE
00/E516: D0 09        BNE $E521
00/E518: A5 CF        LDA $CF
00/E51A: 49 01        EOR #$01
00/E51C: 85 CF        STA $CF
00/E51E: 4C 2E E5     JMP $E52E
00/E521: A5 D8        LDA $D8
00/E523: D0 05        BNE $E52A
00/E525: A9 01        LDA #$01
00/E527: 4C 2C E5     JMP $E52C
00/E52A: A9 00        LDA #$00
00/E52C: 85 D8        STA $D8
00/E52E: 64 AB        STZ $AB
00/E530: 64 02        STZ $02
00/E532: 64 03        STZ $03
00/E534: 64 7B        STZ $7B
00/E536: AD 00 17     LDA $1700
00/E539: C9 03        CMP #$03
00/E53B: F0 06        BEQ $E543
00/E53D: 20 84 AB     JSR $AB84       ; check player movement (world map)
00/E540: 4C 46 E5     JMP $E546
00/E543: 20 41 A9     JSR $A941       ; check player movement (sub-map)
00/E546: 60           RTS 

00/E547: 00 08 00 01 00 04 00 02 0F 07 03 01

; [ get next event script byte ]

00/E553: E8           INX 
00/E554: 86 B3        STX $B3
00/E556: BD D5 09     LDA $09D5,X
00/E559: 60           RTS 

; [ find event script terminator ]

00/E55A: AE D3 09     LDX $09D3       ; event script pointer
00/E55D: E8           INX 
00/E55E: BF 00 82 12  LDA $128200,X   ; event scripts
00/E562: C9 FF        CMP #$FF
00/E564: F0 04        BEQ $E56A
00/E566: E8           INX 
00/E567: 4C 5E E5     JMP $E55E
00/E56A: 8E D3 09     STX $09D3
00/E56D: 60           RTS 

00/E56E: EE1C EE25 EE5C EE77 E5D9 EE9F EDED E7D3  ; $D0
00/E57E: E613 E5CC EA4C EB92 EC6E EC3E EA87 EAE7
00/E58E: EB47 EB53 EA60 EBB1 EBD0 EBEF EC06 E800  ; $E0
00/E59E: E937 ED3D E601 0000 E619 E5E6 F1C1 F1B0
00/E5AE: F1D6 F1E7 F209 F212 F21B F224 F1F8 ED96  ; $F0
00/E5BE: ED71 E9B9 E7E1 E7F7 0000 C434 F039

; $D9: namingway menu
00/E5CC: 20 08 8A     JSR $8A08       ; fade out for menu
00/E5CF: 22 18 80 01  JSL $018018     ; namingway menu
00/E5D3: 20 11 8A     JSR $8A11       ; reload graphics after menu
00/E5D6: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D4: fat chocobo menu
00/E5D9: 20 08 8A     JSR $8A08       ; fade out for menu
00/E5DC: 22 24 80 01  JSL $018024     ; fat chocobo menu
00/E5E0: 20 11 8A     JSR $8A11       ; reload graphics after menu
00/E5E3: 4C 5B E3     JMP $E35B       ; wait for vblank
; $ED: shop
00/E5E6: 20 53 E5     JSR $E553       ; get next event script byte
00/E5E9: 8D 00 1A     STA $1A00
00/E5EC: AA           TAX 
00/E5ED: BF A6 FB 14  LDA $14FBA6,X
00/E5F1: 8D 01 1A     STA $1A01
00/E5F4: 20 08 8A     JSR $8A08       ; fade out for menu
00/E5F7: 22 08 80 01  JSL $018008     ; shop menu
00/E5FB: 20 11 8A     JSR $8A11       ; reload graphics after menu
00/E5FE: 4C 5B E3     JMP $E35B       ; wait for vblank
; $EA: play song (fade in)
00/E601: 20 53 E5     JSR $E553       ; get next event script byte
00/E604: 8D 01 1E     STA $1E01
00/E607: A9 04        LDA #$04
00/E609: 8D 00 1E     STA $1E00
00/E60C: 22 04 80 04  JSL $048004     ; execute sound command
00/E610: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D8: fade out music (slow)
00/E613: 20 53 8D     JSR $8D53       ; fade out music (slow)
00/E616: 4C 5B E3     JMP $E35B       ; wait for vblank
; $EC: battle
00/E619: 20 53 E5     JSR $E553       ; get next event script byte
00/E61C: 8D 00 18     STA $1800
00/E61F: AD 01 17     LDA $1701
00/E622: F0 02        BEQ $E626
00/E624: A9 01        LDA #$01
00/E626: 8D 01 18     STA $1801
00/E629: 64 E4        STZ $E4         ; disable solo character battle
00/E62B: A0 00 00     LDY #$0000
00/E62E: AD 00 18     LDA $1800
00/E631: D9 9E E7     CMP $E79E,Y
00/E634: D0 08        BNE $E63E
00/E636: AD 01 18     LDA $1801
00/E639: D9 9F E7     CMP $E79F,Y
00/E63C: F0 2A        BEQ $E668       ; branch if solo character battle
00/E63E: C8           INY 
00/E63F: C8           INY 
00/E640: C0 1A 00     CPY #$001A
00/E643: D0 E9        BNE $E62E
00/E645: 20 18 89     JSR $8918       ; battle (sub-map)
00/E648: A5 E4        LDA $E4
00/E64A: F0 03        BEQ $E64F       ; branch if not a solo character battle
00/E64C: 20 4B E7     JSR $E74B       ; restore party after solo character battle
00/E64F: 22 DF C8 15  JSL $15C8DF     ; init hardware registers
00/E653: 20 52 84     JSR $8452       ; reload sub-map
00/E656: 20 69 92     JSR $9269       ; screen wipe (in)
00/E659: 22 E0 B1 15  JSL $15B1E0     ; draw player sprite
00/E65D: 20 68 BB     JSR $BB68       ; draw npcs
00/E660: A9 81        LDA #$81
00/E662: 8D 00 42     STA $4200       ; enable nmi
00/E665: 4C 5B E3     JMP $E35B       ; wait for vblank
; solo character battle
00/E668: 98           TYA 
00/E669: C9 18        CMP #$18
00/E66B: D0 02        BNE $E66F
00/E66D: 3A           DEC 
00/E66E: 3A           DEC 
00/E66F: 4A           LSR 
00/E670: 85 06        STA $06
00/E672: 09 80        ORA #$80
00/E674: 85 E4        STA $E4
00/E676: A2 00 00     LDX #$0000
00/E679: A0 00 00     LDY #$0000
00/E67C: BD 00 10     LDA $1000,X     ; save character ids
00/E67F: 99 D6 0A     STA $0AD6,Y
00/E682: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/E685: C8           INY 
00/E686: C0 05 00     CPY #$0005
00/E689: D0 F1        BNE $E67C
00/E68B: A5 06        LDA $06
00/E68D: C9 0B        CMP #$0B
00/E68F: F0 5C        BEQ $E6ED       ; branch if golbez and fusoya
00/E691: A8           TAY 
00/E692: A2 00 00     LDX #$0000
; start of character loop
00/E695: B9 91 E7     LDA $E791,Y
00/E698: C9 03        CMP #$03
00/E69A: F0 3A        BEQ $E6D6       ; branch if rydia
00/E69C: BD 00 10     LDA $1000,X
00/E69F: 29 1F        AND #$1F
00/E6A1: D9 91 E7     CMP $E791,Y     ; find solo character
00/E6A4: F0 12        BEQ $E6B8
00/E6A6: C0 0B 00     CPY #$000B
00/E6A9: D0 05        BNE $E6B0
00/E6AB: D9 92 E7     CMP $E792,Y
00/E6AE: F0 08        BEQ $E6B8
00/E6B0: A9 00        LDA #$00
00/E6B2: 9D 00 10     STA $1000,X     ; hide other characters
00/E6B5: 4C D3 E6     JMP $E6D3
00/E6B8: 20 C6 E7     JSR $E7C6       ; clear status
00/E6BB: BD 09 10     LDA $1009,X     ; set solo character hp and mp to max
00/E6BE: 9D 07 10     STA $1007,X
00/E6C1: BD 0A 10     LDA $100A,X
00/E6C4: 9D 08 10     STA $1008,X
00/E6C7: BD 0D 10     LDA $100D,X
00/E6CA: 9D 0B 10     STA $100B,X
00/E6CD: BD 0E 10     LDA $100E,X
00/E6D0: 9D 0C 10     STA $100C,X
00/E6D3: 4C E2 E6     JMP $E6E2
00/E6D6: BD 00 10     LDA $1000,X     ; hide rydia
00/E6D9: 29 1F        AND #$1F
00/E6DB: C9 03        CMP #$03
00/E6DD: D0 03        BNE $E6E2
00/E6DF: 9E 00 10     STZ $1000,X
00/E6E2: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/E6E5: E0 40 01     CPX #$0140
00/E6E8: D0 AB        BNE $E695
00/E6EA: 4C 45 E6     JMP $E645
; golbez and fusoya
00/E6ED: A2 00 00     LDX #$0000
00/E6F0: BD C0 10     LDA $10C0,X     ; copy characters 4 and 5 to buffer
00/E6F3: 9D 00 12     STA $1200,X
00/E6F6: E8           INX 
00/E6F7: E0 80 00     CPX #$0080
00/E6FA: D0 F4        BNE $E6F0
00/E6FC: A2 00 00     LDX #$0000
00/E6FF: 9E 00 10     STZ $1000,X     ; hide all characters
00/E702: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/E705: E0 40 01     CPX #$0140
00/E708: D0 F5        BNE $E6FF
00/E70A: A2 C0 00     LDX #$00C0
00/E70D: 86 3D        STX $3D
00/E70F: A9 0D        LDA #$0D        ; 
00/E711: 20 95 E8     JSR $E895       ; load character properties
00/E714: A2 00 01     LDX #$0100
00/E717: 86 3D        STX $3D
00/E719: A9 01        LDA #$01
00/E71B: 20 6C E8     JSR $E86C       ; restore character properties
00/E71E: A2 00 01     LDX #$0100
00/E721: 20 C6 E7     JSR $E7C6       ; clear status
00/E724: BD 09 10     LDA $1009,X     ; set hp and mp to max
00/E727: 9D 07 10     STA $1007,X
00/E72A: BD 0A 10     LDA $100A,X
00/E72D: 9D 08 10     STA $1008,X
00/E730: BD 0D 10     LDA $100D,X
00/E733: 9D 0B 10     STA $100B,X
00/E736: BD 0E 10     LDA $100E,X
00/E739: 9D 0C 10     STA $100C,X
00/E73C: A2 30 00     LDX #$0030
00/E73F: 9E C0 10     STZ $10C0,X     ; clear equipped items
00/E742: E8           INX 
00/E743: E0 37 00     CPX #$0037
00/E746: D0 F7        BNE $E73F
00/E748: 4C 45 E6     JMP $E645

; [ restore party after solo character battle ]

00/E74B: A5 E4        LDA $E4         ; solo character battle id
00/E74D: 29 7F        AND #$7F
00/E74F: 85 E4        STA $E4
00/E751: C9 0B        CMP #$0B
00/E753: D0 1E        BNE $E773       ; branch if not golbez and fusoya
00/E755: A2 00 00     LDX #$0000
00/E758: BD 00 11     LDA $1100,X     ; save fusoya to buffer
00/E75B: 9D 80 11     STA $1180,X
00/E75E: E8           INX 
00/E75F: E0 40 00     CPX #$0040
00/E762: D0 F4        BNE $E758
00/E764: A2 00 00     LDX #$0000
00/E767: BD 00 12     LDA $1200,X     ; restore characters 4 and 5
00/E76A: 9D C0 10     STA $10C0,X
00/E76D: E8           INX 
00/E76E: E0 80 00     CPX #$0080
00/E771: D0 F4        BNE $E767
00/E773: A2 00 00     LDX #$0000
00/E776: A0 00 00     LDY #$0000
00/E779: B9 D6 0A     LDA $0AD6,Y     ; restore character ids
00/E77C: 9D 00 10     STA $1000,X
00/E77F: 98           TYA 
00/E780: C5 E4        CMP $E4
00/E782: D0 03        BNE $E787
00/E784: 20 C6 E7     JSR $E7C6       ; clear status
00/E787: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/E78A: C8           INY 
00/E78B: C0 05 00     CPY #$0005
00/E78E: D0 E9        BNE $E779
00/E790: 60           RTS 

; solo character battles
;   $00: cecil vs. soldiers (kaipo inn)
;   $01: 
;   $02: 
;   $03: cecil vs. kain (fabul)
;   $04: tellah vs. edward (damcyan)
;   $05: cecil vs. cecil (mt. ordeals)
;   $06: edward vs. water hag (kaipo)
;   $07: 
;   $08: tellah vs. golbez (tower of zot)
;   $09: edge vs. rubicant (cave eblana)
;   $0A: rydia vs. golbez (dwarf castle)
;   $0B: fusoya and golbez vs. zemus
;   $0C: fusoya and golbez vs. zeromus

; solo character id
00/E791: 03 03 03 01 04 0B 05 07 0C 12 11 13 15

; solo character battles
00/E79E: 00F7 00F8 00F9 00F1 00EE 00F6 00EF 00F0
00/E7AE: 00F3 00FD 01A8 01B3 01B4

; [ increment character properties pointer ]

00/E7B8: C2 20        REP #$20
00/E7BA: 8A           TXA 
00/E7BB: 18           CLC 
00/E7BC: 69 40 00     ADC #$0040
00/E7BF: AA           TAX 
00/E7C0: A9 00 00     LDA #$0000
00/E7C3: E2 20        SEP #$20
00/E7C5: 60           RTS 

; [ clear status ]

00/E7C6: 9E 03 10     STZ $1003,X
00/E7C9: 9E 04 10     STZ $1004,X
00/E7CC: 9E 05 10     STZ $1005,X
00/E7CF: 9E 06 10     STZ $1006,X
00/E7D2: 60           RTS 

; $D7: toggle fast player movement
00/E7D3: A5 AC        LDA $AC
00/E7D5: D0 05        BNE $E7DC
00/E7D7: E6 AC        INC $AC
00/E7D9: 4C 5B E3     JMP $E35B       ; wait for vblank
00/E7DC: 64 AC        STZ $AC
00/E7DE: 4C 5B E3     JMP $E35B       ; wait for vblank
; $FA: play song
00/E7E1: 20 53 E5     JSR $E553       ; get next event script byte
00/E7E4: 20 EA E7     JSR $E7EA
00/E7E7: 4C 5B E3     JMP $E35B       ; wait for vblank
00/E7EA: 8D 01 1E     STA $1E01
00/E7ED: A9 01        LDA #$01        ; play song
00/E7EF: 8D 00 1E     STA $1E00
00/E7F2: 22 04 80 04  JSL $048004     ; execute sound command
00/E7F6: 60           RTS 
; $FB: play sound effect
00/E7F7: 20 53 E5     JSR $E553       ; get next event script byte
00/E7FA: 20 99 8D     JSR $8D99       ; play sound effect
00/E7FD: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E7: add character to party
00/E800: E8           INX 
00/E801: 86 B3        STX $B3
00/E803: A2 00 00     LDX #$0000
00/E806: 86 3D        STX $3D
00/E808: A6 3D        LDX $3D
00/E80A: BD 00 10     LDA $1000,X
00/E80D: F0 10        BEQ $E81F       ; find an empty character slot
00/E80F: A5 3D        LDA $3D
00/E811: 18           CLC 
00/E812: 69 40        ADC #$40
00/E814: 85 3D        STA $3D
00/E816: A5 3E        LDA $3E
00/E818: 69 00        ADC #$00
00/E81A: 85 3E        STA $3E
00/E81C: 4C 08 E8     JMP $E808
00/E81F: A6 B3        LDX $B3
00/E821: BD D5 09     LDA $09D5,X
00/E824: 3A           DEC 
00/E825: A8           TAY 
00/E826: B9 22 E9     LDA $E922,Y     ; character id
00/E829: 10 3B        BPL $E866
; restore character
00/E82B: 20 6C E8     JSR $E86C       ; restore character properties
00/E82E: A4 3D        LDY $3D
00/E830: B9 00 10     LDA $1000,Y
00/E833: 29 E0        AND #$E0
00/E835: A6 B3        LDX $B3
00/E837: 1D D5 09     ORA $09D5,X
00/E83A: 99 00 10     STA $1000,Y
00/E83D: 29 1F        AND #$1F
00/E83F: C9 11        CMP #$11
00/E841: D0 05        BNE $E848       ; branch if not adult rydia
00/E843: A9 0B        LDA #$0B        ; change graphics to adult rydia
00/E845: 99 01 10     STA $1001,Y
00/E848: B9 09 10     LDA $1009,Y     ; set hp and mp to max
00/E84B: 99 07 10     STA $1007,Y
00/E84E: B9 0A 10     LDA $100A,Y
00/E851: 99 08 10     STA $1008,Y
00/E854: B9 0D 10     LDA $100D,Y
00/E857: 99 0B 10     STA $100B,Y
00/E85A: B9 0E 10     LDA $100E,Y
00/E85D: 99 0C 10     STA $100C,Y
00/E860: 20 EB E8     JSR $E8EB       ; init character equipment
00/E863: 4C 69 E8     JMP $E869
; load character
00/E866: 20 95 E8     JSR $E895       ; load character properties
00/E869: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ restore character properties ]

00/E86C: 29 7F        AND #$7F
00/E86E: C2 20        REP #$20
00/E870: 0A           ASL 
00/E871: 0A           ASL 
00/E872: 0A           ASL 
00/E873: 0A           ASL 
00/E874: 0A           ASL 
00/E875: 0A           ASL 
00/E876: 85 40        STA $40
00/E878: A9 00 00     LDA #$0000
00/E87B: E2 20        SEP #$20
00/E87D: A9 40        LDA #$40
00/E87F: 85 07        STA $07
00/E881: A4 3D        LDY $3D
00/E883: A6 40        LDX $40
00/E885: BD 40 11     LDA $1140,X
00/E888: 99 00 10     STA $1000,Y
00/E88B: 9E 40 11     STZ $1140,X
00/E88E: E8           INX 
00/E88F: C8           INY 
00/E890: C6 07        DEC $07
00/E892: D0 F1        BNE $E885
00/E894: 60           RTS 

; [ load character properties ]

00/E895: C2 20        REP #$20
00/E897: 0A           ASL 
00/E898: 0A           ASL 
00/E899: 0A           ASL 
00/E89A: 0A           ASL 
00/E89B: 0A           ASL 
00/E89C: 85 40        STA $40
00/E89E: A9 00 00     LDA #$0000
00/E8A1: E2 20        SEP #$20
00/E8A3: A9 14        LDA #$14
00/E8A5: 85 07        STA $07
00/E8A7: A6 40        LDX $40
00/E8A9: A4 3D        LDY $3D
00/E8AB: BF 00 A9 0F  LDA $0FA900,X   ; character properties
00/E8AF: 99 00 10     STA $1000,Y
00/E8B2: E8           INX 
00/E8B3: C8           INY 
00/E8B4: C6 07        DEC $07
00/E8B6: D0 F3        BNE $E8AB
00/E8B8: A9 03        LDA #$03
00/E8BA: 85 07        STA $07
00/E8BC: A6 40        LDX $40
00/E8BE: A4 3D        LDY $3D
00/E8C0: BF 14 A9 0F  LDA $0FA914,X
00/E8C4: 99 2D 10     STA $102D,Y
00/E8C7: E8           INX 
00/E8C8: C8           INY 
00/E8C9: C6 07        DEC $07
00/E8CB: D0 F3        BNE $E8C0
00/E8CD: A9 09        LDA #$09
00/E8CF: 85 07        STA $07
00/E8D1: A6 40        LDX $40
00/E8D3: A4 3D        LDY $3D
00/E8D5: BF 17 A9 0F  LDA $0FA917,X
00/E8D9: 99 37 10     STA $1037,Y
00/E8DC: E8           INX 
00/E8DD: C8           INY 
00/E8DE: C6 07        DEC $07
00/E8E0: D0 F3        BNE $E8D5
00/E8E2: 20 EB E8     JSR $E8EB       ; init character equipment
00/E8E5: 60           RTS 

; [ init cecil's equipment ]

00/E8E6: A9 00        LDA #$00
00/E8E8: 4C F6 E8     JMP $E8F6

; [ init character equipment ]

00/E8EB: A6 B3        LDX $B3
00/E8ED: BD D5 09     LDA $09D5,X
00/E8F0: 3A           DEC 
00/E8F1: C9 0B        CMP #$0B
00/E8F3: D0 01        BNE $E8F6       ; return if adult rydia
00/E8F5: 60           RTS 
00/E8F6: 85 07        STA $07         ; multiply by 7
00/E8F8: 0A           ASL 
00/E8F9: 0A           ASL 
00/E8FA: 0A           ASL 
00/E8FB: 38           SEC 
00/E8FC: E5 07        SBC $07
00/E8FE: AA           TAX 
00/E8FF: A9 07        LDA #$07
00/E901: 85 07        STA $07
00/E903: A4 3D        LDY $3D
00/E905: BF 00 AB 0F  LDA $0FAB00,X   ; initial character equipment
00/E909: 99 30 10     STA $1030,Y
00/E90C: E8           INX 
00/E90D: C8           INY 
00/E90E: C6 07        DEC $07
00/E910: D0 F3        BNE $E905
00/E912: 46 3E        LSR $3E
00/E914: 66 3D        ROR $3D
00/E916: A5 3D        LDA $3D
00/E918: 4A           LSR 
00/E919: 4A           LSR 
00/E91A: 4A           LSR 
00/E91B: 4A           LSR 
00/E91C: 4A           LSR 
00/E91D: 22 06 80 03  JSL $038006     ; update character equipment
00/E921: 60           RTS 

; characters to add (restore saved character if msb set)
00/E922: 00 01 02 03 04 05 06 07 08 81 09 81 83 0A 80 82
00/E932: 84 0B 0C 80 0D

; $E8: remove character from party
00/E937: E8           INX 
00/E938: 86 B3        STX $B3
00/E93A: A0 00 00     LDY #$0000
00/E93D: 84 3D        STY $3D
00/E93F: A4 3D        LDY $3D
00/E941: B9 00 10     LDA $1000,Y
00/E944: 29 1F        AND #$1F
00/E946: DD D5 09     CMP $09D5,X
00/E949: F0 17        BEQ $E962
00/E94B: A5 3D        LDA $3D
00/E94D: 18           CLC 
00/E94E: 69 40        ADC #$40
00/E950: 85 3D        STA $3D
00/E952: A5 3E        LDA $3E
00/E954: 69 00        ADC #$00
00/E956: 85 3E        STA $3E
00/E958: A4 3D        LDY $3D
00/E95A: C0 40 01     CPY #$0140
00/E95D: D0 E0        BNE $E93F
00/E95F: 4C 5B E3     JMP $E35B       ; wait for vblank
00/E962: BD D5 09     LDA $09D5,X
00/E965: 3A           DEC 
00/E966: AA           TAX 
00/E967: BD A5 E9     LDA $E9A5,X
00/E96A: 30 31        BMI $E99D
00/E96C: C2 20        REP #$20
00/E96E: 0A           ASL 
00/E96F: 0A           ASL 
00/E970: 0A           ASL 
00/E971: 0A           ASL 
00/E972: 0A           ASL 
00/E973: 0A           ASL 
00/E974: 85 40        STA $40
00/E976: A9 00 00     LDA #$0000
00/E979: E2 20        SEP #$20
00/E97B: A9 40        LDA #$40
00/E97D: 85 07        STA $07
00/E97F: A6 3D        LDX $3D
00/E981: A4 40        LDY $40
00/E983: BD 00 10     LDA $1000,X
00/E986: 99 40 11     STA $1140,Y
00/E989: E8           INX 
00/E98A: C8           INY 
00/E98B: C6 07        DEC $07
00/E98D: D0 F4        BNE $E983
00/E98F: A6 40        LDX $40
00/E991: 9E 43 11     STZ $1143,X
00/E994: 9E 44 11     STZ $1144,X
00/E997: 9E 45 11     STZ $1145,X
00/E99A: 9E 46 11     STZ $1146,X
00/E99D: A6 3D        LDX $3D
00/E99F: 9E 00 10     STZ $1000,X
00/E9A2: 4C 5B E3     JMP $E35B       ; wait for vblank

; characters to remove (don't save if msb set)
00/E9A5: 80 00 04 01 80 02 03 80 80 01 80 80 80 01 00 80
00/E9B5: 80 80 01 80

; $F9: 
00/E9B9: E8           INX 
00/E9BA: 86 B3        STX $B3
00/E9BC: A5 81        LDA $81
00/E9BE: D0 09        BNE $E9C9
00/E9C0: BD D5 09     LDA $09D5,X
00/E9C3: 20 CF E9     JSR $E9CF
00/E9C6: 4C 5B E3     JMP $E35B       ; wait for vblank
00/E9C9: 20 14 EA     JSR $EA14
00/E9CC: 4C 5B E3     JMP $E35B       ; wait for vblank
00/E9CF: 48           PHA 
00/E9D0: 48           PHA 
00/E9D1: 29 E0        AND #$E0
00/E9D3: 85 06        STA $06
00/E9D5: 68           PLA 
00/E9D6: 29 0F        AND #$0F
00/E9D8: 0A           ASL 
00/E9D9: 38           SEC 
00/E9DA: 65 06        ADC $06
00/E9DC: 85 83        STA $83
00/E9DE: 68           PLA 
00/E9DF: 29 10        AND #$10
00/E9E1: F0 02        BEQ $E9E5
00/E9E3: A9 07        LDA #$07
00/E9E5: 85 82        STA $82
00/E9E7: 64 79        STZ $79
00/E9E9: 64 81        STZ $81
00/E9EB: 20 4B 91     JSR $914B       ; wait one frame
00/E9EE: 9C 2D 21     STZ $212D
00/E9F1: A9 83        LDA #$83
00/E9F3: 8D 31 21     STA $2131
00/E9F6: A5 83        LDA $83
00/E9F8: 29 E0        AND #$E0
00/E9FA: 05 81        ORA $81
00/E9FC: 8D 32 21     STA $2132
00/E9FF: E6 79        INC $79
00/EA01: A5 79        LDA $79
00/EA03: 25 82        AND $82
00/EA05: D0 E4        BNE $E9EB
00/EA07: E6 81        INC $81
00/EA09: A5 83        LDA $83
00/EA0B: 29 1F        AND #$1F
00/EA0D: C5 81        CMP $81
00/EA0F: D0 DA        BNE $E9EB
00/EA11: C6 81        DEC $81
00/EA13: 60           RTS 

; [  ]

00/EA14: 64 79        STZ $79
00/EA16: 20 4B 91     JSR $914B       ; wait one frame
00/EA19: A5 83        LDA $83
00/EA1B: 29 E0        AND #$E0
00/EA1D: 05 81        ORA $81
00/EA1F: 8D 32 21     STA $2132
00/EA22: E6 79        INC $79
00/EA24: A5 79        LDA $79
00/EA26: 25 82        AND $82
00/EA28: D0 EC        BNE $EA16
00/EA2A: C6 81        DEC $81
00/EA2C: 10 E8        BPL $EA16
00/EA2E: 64 81        STZ $81
00/EA30: A9 11        LDA #$11
00/EA32: 8D 2D 21     STA $212D
00/EA35: AD E4 0F     LDA $0FE4
00/EA38: 4A           LSR 
00/EA39: 90 0D        BCC $EA48
00/EA3B: A9 02        LDA #$02
00/EA3D: 8D 30 21     STA $2130
00/EA40: A9 43        LDA #$43
00/EA42: 8D 31 21     STA $2131
00/EA45: 4C 4B EA     JMP $EA4B
00/EA48: 9C 31 21     STZ $2131
00/EA4B: 60           RTS 

; $DA: fade in/out
00/EA4C: A5 80        LDA $80
00/EA4E: D0 08        BNE $EA58
00/EA50: A9 07        LDA #$07
00/EA52: 20 B0 8D     JSR $8DB0       ; fade in
00/EA55: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EA58: A9 07        LDA #$07
00/EA5A: 20 D1 8D     JSR $8DD1       ; fade out
00/EA5D: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E2: give spell
00/EA60: E8           INX 
00/EA61: BD D5 09     LDA $09D5,X
00/EA64: C2 20        REP #$20
00/EA66: 0A           ASL 
00/EA67: 0A           ASL 
00/EA68: 0A           ASL 
00/EA69: 85 18        STA $18
00/EA6B: 0A           ASL 
00/EA6C: 18           CLC 
00/EA6D: 65 18        ADC $18
00/EA6F: A8           TAY 
00/EA70: A9 00 00     LDA #$0000
00/EA73: E2 20        SEP #$20
00/EA75: B9 60 15     LDA $1560,Y
00/EA78: F0 04        BEQ $EA7E
00/EA7A: C8           INY 
00/EA7B: 4C 75 EA     JMP $EA75
00/EA7E: 20 53 E5     JSR $E553       ; get next event script byte
00/EA81: 99 60 15     STA $1560,Y
00/EA84: 4C 5B E3     JMP $E35B       ; wait for vblank
; $DE: restore hp
00/EA87: 20 53 E5     JSR $E553       ; get next event script byte
00/EA8A: C9 FE        CMP #$FE
00/EA8C: F0 39        BEQ $EAC7
00/EA8E: 85 18        STA $18
00/EA90: 64 19        STZ $19
00/EA92: A9 0A        LDA #$0A
00/EA94: 85 1A        STA $1A
00/EA96: 64 1B        STZ $1B
00/EA98: 22 8F C3 15  JSL $15C38F
00/EA9C: A2 00 00     LDX #$0000
00/EA9F: BD 03 10     LDA $1003,X
00/EAA2: 30 18        BMI $EABC
00/EAA4: C2 20        REP #$20
00/EAA6: BD 07 10     LDA $1007,X
00/EAA9: 18           CLC 
00/EAAA: 65 30        ADC $30
00/EAAC: DD 09 10     CMP $1009,X
00/EAAF: 90 03        BCC $EAB4
00/EAB1: BD 09 10     LDA $1009,X
00/EAB4: 9D 07 10     STA $1007,X
00/EAB7: A9 00 00     LDA #$0000
00/EABA: E2 20        SEP #$20
00/EABC: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EABF: E0 40 01     CPX #$0140
00/EAC2: D0 DB        BNE $EA9F
00/EAC4: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EAC7: A2 00 00     LDX #$0000
00/EACA: BD 03 10     LDA $1003,X
00/EACD: 30 0D        BMI $EADC
00/EACF: C2 20        REP #$20
00/EAD1: BD 09 10     LDA $1009,X
00/EAD4: 9D 07 10     STA $1007,X
00/EAD7: A9 00 00     LDA #$0000
00/EADA: E2 20        SEP #$20
00/EADC: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EADF: E0 40 01     CPX #$0140
00/EAE2: D0 E6        BNE $EACA
00/EAE4: 4C 5B E3     JMP $E35B       ; wait for vblank
; $DF: restore mp
00/EAE7: 20 53 E5     JSR $E553       ; get next event script byte
00/EAEA: C9 FE        CMP #$FE
00/EAEC: F0 39        BEQ $EB27
00/EAEE: 85 18        STA $18
00/EAF0: 64 19        STZ $19
00/EAF2: A9 0A        LDA #$0A
00/EAF4: 85 1A        STA $1A
00/EAF6: 64 1B        STZ $1B
00/EAF8: 22 8F C3 15  JSL $15C38F
00/EAFC: A2 00 00     LDX #$0000
00/EAFF: BD 03 10     LDA $1003,X
00/EB02: 30 18        BMI $EB1C
00/EB04: C2 20        REP #$20
00/EB06: BD 0B 10     LDA $100B,X
00/EB09: 18           CLC 
00/EB0A: 65 30        ADC $30
00/EB0C: DD 0D 10     CMP $100D,X
00/EB0F: 90 03        BCC $EB14
00/EB11: BD 0D 10     LDA $100D,X
00/EB14: 9D 0B 10     STA $100B,X
00/EB17: A9 00 00     LDA #$0000
00/EB1A: E2 20        SEP #$20
00/EB1C: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EB1F: E0 40 01     CPX #$0140
00/EB22: D0 DB        BNE $EAFF
00/EB24: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EB27: A2 00 00     LDX #$0000
00/EB2A: BD 03 10     LDA $1003,X
00/EB2D: 30 0D        BMI $EB3C
00/EB2F: C2 20        REP #$20
00/EB31: BD 0D 10     LDA $100D,X
00/EB34: 9D 0B 10     STA $100B,X
00/EB37: A9 00 00     LDA #$0000
00/EB3A: E2 20        SEP #$20
00/EB3C: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EB3F: E0 40 01     CPX #$0140
00/EB42: D0 E6        BNE $EB2A
00/EB44: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E0: give item
00/EB47: 20 53 E5     JSR $E553       ; get next event script byte
00/EB4A: 8D FB 08     STA $08FB
00/EB4D: 20 36 9A     JSR $9A36       ; give item
00/EB50: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E1: take item
00/EB53: 20 53 E5     JSR $E553       ; get next event script byte
00/EB56: 85 06        STA $06
00/EB58: A0 00 00     LDY #$0000
00/EB5B: B9 40 14     LDA $1440,Y
00/EB5E: C5 06        CMP $06
00/EB60: F0 25        BEQ $EB87
00/EB62: C8           INY 
00/EB63: C8           INY 
00/EB64: C0 60 00     CPY #$0060
00/EB67: D0 F2        BNE $EB5B
00/EB69: A2 00 00     LDX #$0000
00/EB6C: BD 33 10     LDA $1033,X
00/EB6F: C5 06        CMP $06
00/EB71: F0 0B        BEQ $EB7E
00/EB73: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EB76: E0 40 01     CPX #$0140
00/EB79: D0 F1        BNE $EB6C
00/EB7B: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EB7E: 9E 33 10     STZ $1033,X
00/EB81: 9E 34 10     STZ $1034,X
00/EB84: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EB87: A9 00        LDA #$00
00/EB89: 99 40 14     STA $1440,Y
00/EB8C: 99 41 14     STA $1441,Y
00/EB8F: 4C 5B E3     JMP $E35B       ; wait for vblank
; $DB: toggle status
00/EB92: 20 53 E5     JSR $E553       ; get next event script byte
00/EB95: 85 06        STA $06
00/EB97: A2 00 00     LDX #$0000
00/EB9A: BD 03 10     LDA $1003,X
00/EB9D: 45 06        EOR $06
00/EB9F: 9D 03 10     STA $1003,X
00/EBA2: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EBA5: E0 40 01     CPX #$0140
00/EBA8: D0 F0        BNE $EB9A
00/EBAA: A9 01        LDA #$01
00/EBAC: 85 CC        STA $CC
00/EBAE: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E3: clear status
00/EBB1: 20 53 E5     JSR $E553       ; get next event script byte
00/EBB4: 85 06        STA $06
00/EBB6: A2 00 00     LDX #$0000
00/EBB9: BD 03 10     LDA $1003,X
00/EBBC: 25 06        AND $06
00/EBBE: 9D 03 10     STA $1003,X
00/EBC1: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EBC4: E0 40 01     CPX #$0140
00/EBC7: D0 F0        BNE $EBB9
00/EBC9: A9 01        LDA #$01
00/EBCB: 85 CC        STA $CC
00/EBCD: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E4: set status
00/EBD0: 20 53 E5     JSR $E553       ; get next event script byte
00/EBD3: 85 06        STA $06
00/EBD5: A2 00 00     LDX #$0000
00/EBD8: BD 03 10     LDA $1003,X
00/EBDB: 05 06        ORA $06
00/EBDD: 9D 03 10     STA $1003,X
00/EBE0: 20 B8 E7     JSR $E7B8       ; increment character properties pointer
00/EBE3: E0 40 01     CPX #$0140
00/EBE6: D0 F0        BNE $EBD8
00/EBE8: A9 01        LDA #$01
00/EBEA: 85 CC        STA $CC
00/EBEC: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E5: give gp
00/EBEF: 20 53 E5     JSR $E553       ; get next event script byte
00/EBF2: 85 18        STA $18
00/EBF4: 64 19        STZ $19
00/EBF6: A9 64        LDA #$64
00/EBF8: 85 1A        STA $1A
00/EBFA: 64 1B        STZ $1B
00/EBFC: 22 8F C3 15  JSL $15C38F
00/EC00: 20 FB 99     JSR $99FB       ; give gp
00/EC03: 4C 5B E3     JMP $E35B       ; wait for vblank
; $E6: take gp
00/EC06: 20 53 E5     JSR $E553       ; get next event script byte
00/EC09: 85 18        STA $18
00/EC0B: 64 19        STZ $19
00/EC0D: A9 64        LDA #$64
00/EC0F: 85 1A        STA $1A
00/EC11: 64 1B        STZ $1B
00/EC13: 22 8F C3 15  JSL $15C38F
00/EC17: AD A0 16     LDA $16A0
00/EC1A: 38           SEC 
00/EC1B: E5 30        SBC $30
00/EC1D: 8D A0 16     STA $16A0
00/EC20: AD A1 16     LDA $16A1
00/EC23: E5 31        SBC $31
00/EC25: 8D A1 16     STA $16A1
00/EC28: AD A2 16     LDA $16A2
00/EC2B: E5 32        SBC $32
00/EC2D: 8D A2 16     STA $16A2
00/EC30: B0 09        BCS $EC3B
00/EC32: 9C A0 16     STZ $16A0
00/EC35: 9C A1 16     STZ $16A1
00/EC38: 9C A2 16     STZ $16A2
00/EC3B: 4C 5B E3     JMP $E35B       ; wait for vblank
; $DD: set player graphic
00/EC3E: 20 53 E5     JSR $E553       ; get next event script byte
00/EC41: 85 06        STA $06
00/EC43: A2 00 00     LDX #$0000
00/EC46: A0 00 00     LDY #$0000
00/EC49: B9 00 10     LDA $1000,Y
00/EC4C: 29 1F        AND #$1F
00/EC4E: C5 06        CMP $06
00/EC50: F0 11        BEQ $EC63
00/EC52: C2 20        REP #$20
00/EC54: 98           TYA 
00/EC55: 18           CLC 
00/EC56: 69 40 00     ADC #$0040
00/EC59: A8           TAY 
00/EC5A: A9 00 00     LDA #$0000
00/EC5D: E2 20        SEP #$20
00/EC5F: E8           INX 
00/EC60: 4C 49 EC     JMP $EC49
00/EC63: 8A           TXA 
00/EC64: 8D 03 17     STA $1703
00/EC67: A9 01        LDA #$01
00/EC69: 85 CC        STA $CC
00/EC6B: 4C 5B E3     JMP $E35B       ; wait for vblank
; $DC: inn
00/EC6E: 20 53 E5     JSR $E553       ; get next event script byte
00/EC71: 0A           ASL 
00/EC72: AA           TAX 
00/EC73: BD 0B ED     LDA $ED0B,X     ; gp amount
00/EC76: 8D F8 08     STA $08F8
00/EC79: BD 0C ED     LDA $ED0C,X
00/EC7C: 8D F9 08     STA $08F9
00/EC7F: 9C FA 08     STZ $08FA
00/EC82: A9 1A        LDA #$1A        ; inn welcome message
00/EC84: 85 B2        STA $B2
00/EC86: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/EC89: 20 0B B3     JSR $B30B       ; open dialogue window
00/EC8C: 20 2D ED     JSR $ED2D       ; get current gp
00/EC8F: 22 24 C3 15  JSL $15C324     ; convert hex to decimal
00/EC93: 20 1D ED     JSR $ED1D
00/EC96: 20 16 AD     JSR $AD16       ; open gp window
00/EC99: 20 E5 AD     JSR $ADE5       ; show yes/no selection window
00/EC9C: 20 BC AD     JSR $ADBC       ; close gp window
00/EC9F: 20 9E B3     JSR $B39E       ; close dialogue window
00/ECA2: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/ECA5: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/ECA8: A5 DB        LDA $DB
00/ECAA: F0 13        BEQ $ECBF
00/ECAC: A9 1B        LDA #$1B        ;  (please come again)
00/ECAE: 85 B2        STA $B2
00/ECB0: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/ECB3: 20 0B B3     JSR $B30B       ; open dialogue window
00/ECB6: 20 9E B3     JSR $B39E       ; close dialogue window
00/ECB9: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/ECBC: 4C F3 EC     JMP $ECF3
00/ECBF: 20 2D ED     JSR $ED2D       ; get current gp
00/ECC2: A6 B3        LDX $B3
00/ECC4: BD D5 09     LDA $09D5,X
00/ECC7: 0A           ASL 
00/ECC8: AA           TAX 
00/ECC9: AD A0 16     LDA $16A0
00/ECCC: 38           SEC 
00/ECCD: FD 0B ED     SBC $ED0B,X
00/ECD0: 85 30        STA $30
00/ECD2: AD A1 16     LDA $16A1
00/ECD5: FD 0C ED     SBC $ED0C,X
00/ECD8: 85 31        STA $31
00/ECDA: AD A2 16     LDA $16A2
00/ECDD: E9 00        SBC #$00
00/ECDF: 85 32        STA $32
00/ECE1: B0 16        BCS $ECF9
00/ECE3: A9 19        LDA #$19        ;  (not enough money)
00/ECE5: 85 B2        STA $B2
00/ECE7: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/ECEA: 20 0B B3     JSR $B30B       ; open dialogue window
00/ECED: 20 9E B3     JSR $B39E       ; close dialogue window
00/ECF0: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/ECF3: 20 5A E5     JSR $E55A       ; find event script terminator
00/ECF6: 4C 5B E3     JMP $E35B       ; wait for vblank
00/ECF9: A5 30        LDA $30
00/ECFB: 8D A0 16     STA $16A0
00/ECFE: A5 31        LDA $31
00/ED00: 8D A1 16     STA $16A1
00/ED03: A5 32        LDA $32
00/ED05: 8D A2 16     STA $16A2
00/ED08: 4C 5B E3     JMP $E35B       ; wait for vblank

; inn prices
00/ED0B: 0032 0064 00C8 0190 01F4 0258 02BC 012C
00/ED1B: 04B0

; [ set current gp ]

00/ED1D: A5 30        LDA $30
00/ED1F: 8D F8 08     STA $08F8
00/ED22: A5 31        LDA $31
00/ED24: 8D F9 08     STA $08F9
00/ED27: A5 32        LDA $32
00/ED29: 8D FA 08     STA $08FA
00/ED2C: 60           RTS 

; [ get current gp ]

00/ED2D: AD A0 16     LDA $16A0       ; current gp
00/ED30: 85 30        STA $30
00/ED32: AD A1 16     LDA $16A1
00/ED35: 85 31        STA $31
00/ED37: AD A2 16     LDA $16A2
00/ED3A: 85 32        STA $32
00/ED3C: 60           RTS 

; $E9: pause
00/ED3D: 20 53 E5     JSR $E553       ; get next event script byte
00/ED40: 85 89        STA $89
00/ED42: 64 8A        STZ $8A
00/ED44: 06 89        ASL $89         ; multiply by 8
00/ED46: 26 8A        ROL $8A
00/ED48: 06 89        ASL $89
00/ED4A: 26 8A        ROL $8A
00/ED4C: 06 89        ASL $89
00/ED4E: 26 8A        ROL $8A
00/ED50: 20 2D 91     JSR $912D       ; wait for vblank
00/ED53: AD 00 17     LDA $1700
00/ED56: C9 03        CMP #$03
00/ED58: F0 06        BEQ $ED60
00/ED5A: 20 C0 94     JSR $94C0       ; draw world map sprites
00/ED5D: 4C 67 ED     JMP $ED67
00/ED60: 22 E0 B1 15  JSL $15B1E0     ; draw player sprite
00/ED64: 20 68 BB     JSR $BB68       ; draw npcs
00/ED67: A6 89        LDX $89
00/ED69: CA           DEX 
00/ED6A: 86 89        STX $89
00/ED6C: D0 E2        BNE $ED50
00/ED6E: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F8: show dialogue (yes/no)
00/ED71: 20 53 E5     JSR $E553       ; get next event script byte
00/ED74: 85 B2        STA $B2
00/ED76: 20 1B B4     JSR $B41B       ; get pointer to event dialogue (bank 1 high)
00/ED79: 20 0B B3     JSR $B30B       ; open dialogue window
00/ED7C: 20 E5 AD     JSR $ADE5       ; show yes/no selection window
00/ED7F: 20 9E B3     JSR $B39E       ; close dialogue window
00/ED82: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/ED85: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/ED88: A5 DB        LDA $DB
00/ED8A: F0 07        BEQ $ED93
00/ED8C: 20 5A E5     JSR $E55A       ; find event script terminator
00/ED8F: E8           INX 
00/ED90: 8E D3 09     STX $09D3
00/ED93: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F7: select item
00/ED96: E8           INX 
00/ED97: 86 B3        STX $B3
00/ED99: 20 4B AF     JSR $AF4B       ; show item selection window
00/ED9C: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/ED9F: 20 C9 B7     JSR $B7C9       ; hide dialogue window
00/EDA2: AD FB 08     LDA $08FB
00/EDA5: C9 FF        CMP #$FF
00/EDA7: F0 17        BEQ $EDC0
00/EDA9: A6 B3        LDX $B3
00/EDAB: BD D5 09     LDA $09D5,X
00/EDAE: CD FB 08     CMP $08FB
00/EDB1: F0 13        BEQ $EDC6
00/EDB3: A9 14        LDA #$14
00/EDB5: 85 B2        STA $B2
00/EDB7: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/EDBA: 20 0B B3     JSR $B30B       ; open dialogue window
00/EDBD: 20 9E B3     JSR $B39E       ; close dialogue window
00/EDC0: 20 5A E5     JSR $E55A       ; find event script terminator
00/EDC3: 4C 5B E3     JMP $E35B       ; wait for vblank
00/EDC6: C9 EC        CMP #$EC
00/EDC8: F0 20        BEQ $EDEA
00/EDCA: C9 FE        CMP #$FE
00/EDCC: B0 04        BCS $EDD2
00/EDCE: C9 ED        CMP #$ED
00/EDD0: B0 18        BCS $EDEA
00/EDD2: A2 00 00     LDX #$0000
00/EDD5: BD 40 14     LDA $1440,X
00/EDD8: CD FB 08     CMP $08FB
00/EDDB: F0 05        BEQ $EDE2
00/EDDD: E8           INX 
00/EDDE: E8           INX 
00/EDDF: 4C D5 ED     JMP $EDD5
00/EDE2: DE 41 14     DEC $1441,X
00/EDE5: D0 03        BNE $EDEA
00/EDE7: 9E 40 14     STZ $1440,X
00/EDEA: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D6: 
00/EDED: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/EDF0: 20 F6 ED     JSR $EDF6
00/EDF3: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/EDF6: 20 28 C4     JSR $C428       ; random (0..255)
00/EDF9: C9 80        CMP #$80
00/EDFB: B0 1E        BCS $EE1B
00/EDFD: A5 5C        LDA $5C
00/EDFF: 18           CLC 
00/EE00: 69 08        ADC #$08
00/EE02: 8D 0E 21     STA $210E
00/EE05: A5 5D        LDA $5D
00/EE07: 69 00        ADC #$00
00/EE09: 8D 0E 21     STA $210E
00/EE0C: A5 60        LDA $60
00/EE0E: 18           CLC 
00/EE0F: 69 08        ADC #$08
00/EE11: 8D 10 21     STA $2110
00/EE14: A5 61        LDA $61
00/EE16: 69 00        ADC #$00
00/EE18: 8D 10 21     STA $2110
00/EE1B: 60           RTS 

; $D0: shake screen
00/EE1C: A5 E3        LDA $E3
00/EE1E: 49 01        EOR #$01
00/EE20: 85 E3        STA $E3
00/EE22: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D1: flash screen
00/EE25: A9 02        LDA #$02
00/EE27: 85 79        STA $79
00/EE29: E6 C4        INC $C4
00/EE2B: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/EE2E: C6 79        DEC $79
00/EE30: D0 F7        BNE $EE29
00/EE32: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ transfer inverted palette to ppu ]

00/EE35: 9C 0B 42     STZ $420B
00/EE38: 9C 21 21     STZ $2121
00/EE3B: A9 02        LDA #$02
00/EE3D: 8D 00 43     STA $4300
00/EE40: A9 22        LDA #$22
00/EE42: 8D 01 43     STA $4301
00/EE45: A9 00        LDA #$00
00/EE47: 8D 04 43     STA $4304
00/EE4A: A2 DB 0B     LDX #$0BDB
00/EE4D: 8E 02 43     STX $4302
00/EE50: A2 00 01     LDX #$0100
00/EE53: 8E 05 43     STX $4305
00/EE56: A9 01        LDA #$01
00/EE58: 8D 0B 42     STA $420B
00/EE5B: 60           RTS 

; $D2: mosaic screen
00/EE5C: 64 79        STZ $79
00/EE5E: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/EE61: A5 79        LDA $79
00/EE63: 4A           LSR 
00/EE64: AA           TAX 
00/EE65: BF 66 FA 14  LDA $14FA66,X
00/EE69: 8D 06 21     STA $2106
00/EE6C: E6 79        INC $79
00/EE6E: A5 79        LDA $79
00/EE70: C9 40        CMP #$40
00/EE72: D0 EA        BNE $EE5E
00/EE74: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D3: 
00/EE77: AD 00 17     LDA $1700
00/EE7A: F0 03        BEQ $EE7F
00/EE7C: 4C 85 EE     JMP $EE85
00/EE7F: 20 65 A3     JSR $A365
00/EE82: 4C 88 EE     JMP $EE88
00/EE85: 20 B3 A3     JSR $A3B3
00/EE88: 64 79        STZ $79
00/EE8A: 64 7A        STZ $7A
00/EE8C: 64 7B        STZ $7B
00/EE8E: A9 81        LDA #$81
00/EE90: 8D 00 42     STA $4200       ; enable nmi
00/EE93: 20 3C 91     JSR $913C       ; wait for vblank (short)
00/EE96: A9 0F        LDA #$0F
00/EE98: 8D 00 21     STA $2100       ; screen on, full brightness
00/EE9B: 58           CLI 
00/EE9C: 4C 5B E3     JMP $E35B       ; wait for vblank
; $D5: open secret door
00/EE9F: AD 06 17     LDA $1706
00/EEA2: 38           SEC 
00/EEA3: E9 07        SBC #$07
00/EEA5: 85 3D        STA $3D
00/EEA7: AD 07 17     LDA $1707
00/EEAA: 38           SEC 
00/EEAB: E9 07        SBC #$07
00/EEAD: 10 0A        BPL $EEB9
00/EEAF: 18           CLC 
00/EEB0: 69 0F        ADC #$0F
00/EEB2: 85 07        STA $07
00/EEB4: 64 3E        STZ $3E
00/EEB6: 4C C1 EE     JMP $EEC1
00/EEB9: 29 1F        AND #$1F
00/EEBB: 85 3E        STA $3E
00/EEBD: A9 0F        LDA #$0F
00/EEBF: 85 07        STA $07
00/EEC1: A6 3D        LDX $3D
00/EEC3: A0 10 00     LDY #$0010
00/EEC6: BF 71 5C 7F  LDA $7F5C71,X
00/EECA: C9 60        CMP #$60
00/EECC: F0 13        BEQ $EEE1
00/EECE: E8           INX 
00/EECF: 88           DEY 
00/EED0: D0 F4        BNE $EEC6
00/EED2: E6 3E        INC $3E
00/EED4: A5 3E        LDA $3E
00/EED6: C9 20        CMP #$20
00/EED8: B0 04        BCS $EEDE
00/EEDA: C6 07        DEC $07
00/EEDC: D0 E3        BNE $EEC1
00/EEDE: 4C 42 EF     JMP $EF42
00/EEE1: 86 3D        STX $3D
00/EEE3: A9 64        LDA #$64
00/EEE5: 9F 71 5C 7F  STA $7F5C71,X
00/EEE9: 1A           INC 
00/EEEA: 9F 72 5C 7F  STA $7F5C72,X
00/EEEE: 1A           INC 
00/EEEF: 9F 71 5D 7F  STA $7F5D71,X
00/EEF3: 1A           INC 
00/EEF4: 9F 72 5D 7F  STA $7F5D72,X
00/EEF8: 20 45 EF     JSR $EF45       ; draw secret door
00/EEFB: A2 00 00     LDX #$0000
00/EEFE: A0 00 00     LDY #$0000
00/EF01: C2 20        REP #$20
00/EF03: BF C8 48 7F  LDA $7F48C8,X
00/EF07: 99 27 0A     STA $0A27,Y
00/EF0A: BF C8 49 7F  LDA $7F49C8,X
00/EF0E: 99 29 0A     STA $0A29,Y
00/EF11: BF C8 4A 7F  LDA $7F4AC8,X
00/EF15: 99 2F 0A     STA $0A2F,Y
00/EF18: BF C8 4B 7F  LDA $7F4BC8,X
00/EF1C: 99 31 0A     STA $0A31,Y
00/EF1F: A9 00 00     LDA #$0000
00/EF22: E2 20        SEP #$20
00/EF24: E8           INX 
00/EF25: E8           INX 
00/EF26: 98           TYA 
00/EF27: 29 07        AND #$07
00/EF29: F0 05        BEQ $EF30
00/EF2B: 98           TYA 
00/EF2C: 18           CLC 
00/EF2D: 69 08        ADC #$08
00/EF2F: A8           TAY 
00/EF30: C8           INY 
00/EF31: C8           INY 
00/EF32: C8           INY 
00/EF33: C8           INY 
00/EF34: E0 08 00     CPX #$0008
00/EF37: D0 C8        BNE $EF01
00/EF39: A9 01        LDA #$01        ; enable vram transfer
00/EF3B: 85 E2        STA $E2
00/EF3D: A9 31        LDA #$31
00/EF3F: 20 99 8D     JSR $8D99       ; play sound effect
00/EF42: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ draw secret door ]

00/EF45: A5 3D        LDA $3D
00/EF47: 85 0C        STA $0C
00/EF49: A5 3E        LDA $3E
00/EF4B: 85 0E        STA $0E
00/EF4D: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/EF50: 8E 17 0A     STX $0A17
00/EF53: 8E 1B 0A     STX $0A1B
00/EF56: AD 17 0A     LDA $0A17
00/EF59: 18           CLC 
00/EF5A: 69 20        ADC #$20
00/EF5C: 8D 1B 0A     STA $0A1B
00/EF5F: E6 0C        INC $0C
00/EF61: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/EF64: 8E 19 0A     STX $0A19
00/EF67: 8E 1D 0A     STX $0A1D
00/EF6A: AD 19 0A     LDA $0A19
00/EF6D: 18           CLC 
00/EF6E: 69 20        ADC #$20
00/EF70: 8D 1D 0A     STA $0A1D
00/EF73: E6 0E        INC $0E
00/EF75: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/EF78: 8E 21 0A     STX $0A21
00/EF7B: 8E 25 0A     STX $0A25
00/EF7E: AD 21 0A     LDA $0A21
00/EF81: 18           CLC 
00/EF82: 69 20        ADC #$20
00/EF84: 8D 25 0A     STA $0A25
00/EF87: C6 0C        DEC $0C
00/EF89: 20 2F AB     JSR $AB2F       ; get bg1 tilemap vram address
00/EF8C: 8E 1F 0A     STX $0A1F
00/EF8F: 8E 23 0A     STX $0A23
00/EF92: AD 1F 0A     LDA $0A1F
00/EF95: 18           CLC 
00/EF96: 69 20        ADC #$20
00/EF98: 8D 23 0A     STA $0A23
00/EF9B: 60           RTS 

; [ transfer secret door tilemap to vram ]

00/EF9C: A5 E2        LDA $E2
00/EF9E: D0 01        BNE $EFA1       ; return if no secret door update needed
00/EFA0: 60           RTS 
00/EFA1: 64 E2        STZ $E2
00/EFA3: A9 80        LDA #$80
00/EFA5: 8D 15 21     STA $2115
00/EFA8: AE 17 0A     LDX $0A17
00/EFAB: 8E 16 21     STX $2116
00/EFAE: AE 27 0A     LDX $0A27
00/EFB1: 8E 18 21     STX $2118
00/EFB4: AE 29 0A     LDX $0A29
00/EFB7: 8E 18 21     STX $2118
00/EFBA: AE 19 0A     LDX $0A19
00/EFBD: 8E 16 21     STX $2116
00/EFC0: AE 2B 0A     LDX $0A2B
00/EFC3: 8E 18 21     STX $2118
00/EFC6: AE 2D 0A     LDX $0A2D
00/EFC9: 8E 18 21     STX $2118
00/EFCC: AE 1B 0A     LDX $0A1B
00/EFCF: 8E 16 21     STX $2116
00/EFD2: AE 2F 0A     LDX $0A2F
00/EFD5: 8E 18 21     STX $2118
00/EFD8: AE 31 0A     LDX $0A31
00/EFDB: 8E 18 21     STX $2118
00/EFDE: AE 1D 0A     LDX $0A1D
00/EFE1: 8E 16 21     STX $2116
00/EFE4: AE 33 0A     LDX $0A33
00/EFE7: 8E 18 21     STX $2118
00/EFEA: AE 35 0A     LDX $0A35
00/EFED: 8E 18 21     STX $2118
00/EFF0: AE 1F 0A     LDX $0A1F
00/EFF3: 8E 16 21     STX $2116
00/EFF6: AE 37 0A     LDX $0A37
00/EFF9: 8E 18 21     STX $2118
00/EFFC: AE 39 0A     LDX $0A39
00/EFFF: 8E 18 21     STX $2118
00/F002: AE 21 0A     LDX $0A21
00/F005: 8E 16 21     STX $2116
00/F008: AE 3B 0A     LDX $0A3B
00/F00B: 8E 18 21     STX $2118
00/F00E: AE 3D 0A     LDX $0A3D
00/F011: 8E 18 21     STX $2118
00/F014: AE 23 0A     LDX $0A23
00/F017: 8E 16 21     STX $2116
00/F01A: AE 3F 0A     LDX $0A3F
00/F01D: 8E 18 21     STX $2118
00/F020: AE 41 0A     LDX $0A41
00/F023: 8E 18 21     STX $2118
00/F026: AE 25 0A     LDX $0A25
00/F029: 8E 16 21     STX $2116
00/F02C: AE 43 0A     LDX $0A43
00/F02F: 8E 18 21     STX $2118
00/F032: AE 45 0A     LDX $0A45
00/F035: 8E 18 21     STX $2118
00/F038: 60           RTS 

; $FE: load map
00/F039: BD D6 09     LDA $09D6,X
00/F03C: C9 FB        CMP #$FB
00/F03E: B0 47        BCS $F087
00/F040: 20 EB 9C     JSR $9CEB
00/F043: 9C 04 17     STZ $1704
00/F046: BD D6 09     LDA $09D6,X
00/F049: 8D 02 17     STA $1702
00/F04C: BD D7 09     LDA $09D7,X
00/F04F: 29 3F        AND #$3F
00/F051: 8D 06 17     STA $1706
00/F054: BD D7 09     LDA $09D7,X
00/F057: 29 C0        AND #$C0
00/F059: 4A           LSR 
00/F05A: 4A           LSR 
00/F05B: 4A           LSR 
00/F05C: 4A           LSR 
00/F05D: 4A           LSR 
00/F05E: 4A           LSR 
00/F05F: 8D 05 17     STA $1705
00/F062: BD D8 09     LDA $09D8,X
00/F065: 8D 07 17     STA $1707
00/F068: BD D9 09     LDA $09D9,X
00/F06B: 29 20        AND #$20
00/F06D: F0 04        BEQ $F073
00/F06F: A9 01        LDA #$01
00/F071: 85 CA        STA $CA
00/F073: BD D9 09     LDA $09D9,X
00/F076: 30 05        BMI $F07D
00/F078: A9 00        LDA #$00
00/F07A: 4C 7F F0     JMP $F07F
00/F07D: A9 01        LDA #$01
00/F07F: 8D 01 17     STA $1701
00/F082: A9 03        LDA #$03
00/F084: 4C C4 F0     JMP $F0C4
00/F087: 38           SEC 
00/F088: E9 FB        SBC #$FB
00/F08A: 48           PHA 
00/F08B: BD D7 09     LDA $09D7,X
00/F08E: 8D 06 17     STA $1706
00/F091: BD D8 09     LDA $09D8,X
00/F094: 8D 07 17     STA $1707
00/F097: BD D9 09     LDA $09D9,X
00/F09A: 29 40        AND #$40
00/F09C: 85 E1        STA $E1
00/F09E: BD D9 09     LDA $09D9,X
00/F0A1: 29 20        AND #$20
00/F0A3: F0 04        BEQ $F0A9
00/F0A5: A9 01        LDA #$01
00/F0A7: 85 CA        STA $CA
00/F0A9: BD D9 09     LDA $09D9,X
00/F0AC: 29 1F        AND #$1F
00/F0AE: 3A           DEC 
00/F0AF: D0 0C        BNE $F0BD
00/F0B1: AD 2F 17     LDA $172F
00/F0B4: 8D 06 17     STA $1706
00/F0B7: AD 30 17     LDA $1730
00/F0BA: 8D 07 17     STA $1707
00/F0BD: A2 00 00     LDX #$0000
00/F0C0: 8E 2C 17     STX $172C
00/F0C3: 68           PLA 
00/F0C4: 20 67 F1     JSR $F167
00/F0C7: AD 00 17     LDA $1700
00/F0CA: C9 03        CMP #$03
00/F0CC: F0 7F        BEQ $F14D
00/F0CE: A6 B3        LDX $B3
00/F0D0: BD D9 09     LDA $09D9,X     ; vehicle id
; no vehicle
00/F0D3: 29 1F        AND #$1F
00/F0D5: D0 0A        BNE $F0E1
00/F0D7: 9C 04 17     STZ $1704       ; no vehicle
00/F0DA: 64 AC        STZ $AC
00/F0DC: 64 7B        STZ $7B
00/F0DE: 4C 4D F1     JMP $F14D
; chocobo
00/F0E1: 3A           DEC 
00/F0E2: D0 0B        BNE $F0EF
00/F0E4: A9 01        LDA #$01
00/F0E6: 8D 0F 17     STA $170F
00/F0E9: 20 3E A0     JSR $A03E       ; board chocobo
00/F0EC: 4C 4D F1     JMP $F14D
; black chocobo
00/F0EF: 3A           DEC 
00/F0F0: D0 0E        BNE $F100
00/F0F2: A9 01        LDA #$01
00/F0F4: 8D 12 17     STA $1712
00/F0F7: 9C 15 17     STZ $1715
00/F0FA: 20 49 A0     JSR $A049       ; board black chocobo
00/F0FD: 4C 4D F1     JMP $F14D
; hovercraft
00/F100: 3A           DEC 
00/F101: D0 0B        BNE $F10E
00/F103: A9 01        LDA #$01
00/F105: 8D 18 17     STA $1718
00/F108: 20 68 A1     JSR $A168       ; board hovercraft
00/F10B: 4C 4D F1     JMP $F14D
; enterprise
00/F10E: 3A           DEC 
00/F10F: D0 0B        BNE $F11C
00/F111: A9 01        LDA #$01
00/F113: 8D 1C 17     STA $171C
00/F116: 20 13 A2     JSR $A213       ; board enterprise
00/F119: 4C 4D F1     JMP $F14D
; falcon
00/F11C: 3A           DEC 
00/F11D: D0 0B        BNE $F12A
00/F11F: A9 01        LDA #$01
00/F121: 8D 20 17     STA $1720
00/F124: 20 83 A2     JSR $A283       ; board falcon
00/F127: 4C 4D F1     JMP $F14D
; big whale
00/F12A: 3A           DEC 
00/F12B: D0 0B        BNE $F138
00/F12D: A9 01        LDA #$01
00/F12F: 8D 24 17     STA $1724       ; make big whale visible
00/F132: 20 FF A2     JSR $A2FF       ; board big whale
00/F135: 4C 4D F1     JMP $F14D
; ship
00/F138: A9 01        LDA #$01
00/F13A: 8D 28 17     STA $1728
00/F13D: A6 B3        LDX $B3
00/F13F: BD D9 09     LDA $09D9,X     ; facing direction
00/F142: 29 18        AND #$18
00/F144: 4A           LSR 
00/F145: 4A           LSR 
00/F146: 4A           LSR 
00/F147: 8D 05 17     STA $1705
00/F14A: 20 5E A1     JSR $A15E       ; board ship
00/F14D: 64 79        STZ $79
00/F14F: 64 7A        STZ $7A
00/F151: 64 7B        STZ $7B
00/F153: A9 81        LDA #$81
00/F155: 8D 00 42     STA $4200       ; enable nmi
00/F158: 20 4B 91     JSR $914B       ; wait one frame
00/F15B: 58           CLI 
00/F15C: A6 B3        LDX $B3
00/F15E: E8           INX 
00/F15F: E8           INX 
00/F160: E8           INX 
00/F161: E8           INX 
00/F162: 86 B3        STX $B3
00/F164: 4C 5B E3     JMP $E35B       ; wait for vblank

; [  ]

00/F167: 48           PHA 
00/F168: A5 CA        LDA $CA
00/F16A: D0 06        BNE $F172
00/F16C: 20 3F 92     JSR $923F
00/F16F: 4C 7B F1     JMP $F17B
00/F172: A5 80        LDA $80
00/F174: F0 05        BEQ $F17B
00/F176: A9 00        LDA #$00
00/F178: 20 D1 8D     JSR $8DD1       ; fade out
00/F17B: 68           PLA 
00/F17C: 8D 00 17     STA $1700
00/F17F: D0 06        BNE $F187
00/F181: 20 02 85     JSR $8502       ; load overworld
00/F184: 4C 9E F1     JMP $F19E
00/F187: C9 01        CMP #$01
00/F189: D0 06        BNE $F191
00/F18B: 20 3C 85     JSR $853C
00/F18E: 4C 9E F1     JMP $F19E
00/F191: C9 02        CMP #$02
00/F193: D0 06        BNE $F19B
00/F195: 20 74 85     JSR $8574
00/F198: 4C 9E F1     JMP $F19E
00/F19B: 20 A4 83     JSR $83A4       ; load sub-map
00/F19E: A5 CA        LDA $CA
00/F1A0: D0 06        BNE $F1A8
00/F1A2: 20 69 92     JSR $9269       ; screen wipe (in)
00/F1A5: 4C AA F1     JMP $F1AA
00/F1A8: E6 CA        INC $CA
00/F1AA: A9 81        LDA #$81
00/F1AC: 8D 00 42     STA $4200       ; enable nmi
00/F1AF: 60           RTS 

; $EF: display map dialogue (bank 0)
00/F1B0: 20 53 E5     JSR $E553       ; get next event script byte
00/F1B3: 85 B2        STA $B2
00/F1B5: 20 B9 B3     JSR $B3B9       ; get pointer to map dialogue (bank 0)
00/F1B8: 20 0B B3     JSR $B30B       ; open dialogue window
00/F1BB: 20 9E B3     JSR $B39E       ; close dialogue window
00/F1BE: 4C 5B E3     JMP $E35B       ; wait for vblank
; $EE: display npc dialogue (bank 0)
00/F1C1: 20 53 E5     JSR $E553       ; get next event script byte
00/F1C4: AA           TAX 
00/F1C5: BD 49 0A     LDA $0A49,X     ; npc dialogue id
00/F1C8: 85 B2        STA $B2
00/F1CA: 20 B9 B3     JSR $B3B9       ; get pointer to map dialogue (bank 0)
00/F1CD: 20 0B B3     JSR $B30B       ; open dialogue window
00/F1D0: 20 9E B3     JSR $B39E       ; close dialogue window
00/F1D3: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F0: display event dialogue (bank 1 low)
00/F1D6: 20 53 E5     JSR $E553       ; get next event script byte
00/F1D9: 85 B2        STA $B2
00/F1DB: 20 02 B4     JSR $B402       ; get pointer to event dialogue (bank 1 low)
00/F1DE: 20 0B B3     JSR $B30B       ; open dialogue window
00/F1E1: 20 9E B3     JSR $B39E       ; close dialogue window
00/F1E4: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F1: display event dialogue (bank 1 high)
00/F1E7: 20 53 E5     JSR $E553       ; get next event script byte
00/F1EA: 85 B2        STA $B2
00/F1EC: 20 1B B4     JSR $B41B       ; get pointer to event dialogue (bank 1 high)
00/F1EF: 20 0B B3     JSR $B30B       ; open dialogue window
00/F1F2: 20 9E B3     JSR $B39E       ; close dialogue window
00/F1F5: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F6: display event dialogue (bank 2)
00/F1F8: 20 53 E5     JSR $E553       ; get next event script byte
00/F1FB: 85 B2        STA $B2
00/F1FD: 20 34 B4     JSR $B434       ; get pointer to event dialogue (bank 2)
00/F200: 20 0B B3     JSR $B30B       ; open dialogue window
00/F203: 20 9E B3     JSR $B39E       ; close dialogue window
00/F206: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F2: set event switch
00/F209: 20 53 E5     JSR $E553       ; get next event script byte
00/F20C: 20 BB F3     JSR $F3BB       ; set event switch
00/F20F: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F3: clear event switch
00/F212: 20 53 E5     JSR $E553       ; get next event script byte
00/F215: 20 87 F3     JSR $F387       ; clear event switch
00/F218: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F4: set npc switch
00/F21B: 20 53 E5     JSR $E553       ; get next event script byte
00/F21E: 20 D3 F3     JSR $F3D3       ; set npc switch
00/F221: 4C 5B E3     JMP $E35B       ; wait for vblank
; $F5: clear npc switch
00/F224: 20 53 E5     JSR $E553       ; get next event script byte
00/F227: 20 A0 F3     JSR $F3A0       ; clear npc switch
00/F22A: 4C 5B E3     JMP $E35B       ; wait for vblank

; [ execute trigger script ]

00/F22D: 64 3E        STZ $3E
00/F22F: 0A           ASL 
00/F230: 26 3E        ROL $3E
00/F232: 85 3D        STA $3D
00/F234: A6 3D        LDX $3D
00/F236: BF 62 F2 12  LDA $12F262,X
00/F23A: 85 40        STA $40
00/F23C: BF 63 F2 12  LDA $12F263,X
00/F240: 85 41        STA $41
00/F242: A6 40        LDX $40
00/F244: CA           DEX 
00/F245: BF 60 F4 12  LDA $12F460,X
00/F249: C9 FF        CMP #$FF
00/F24B: F0 04        BEQ $F251
00/F24D: CA           DEX 
00/F24E: 4C 45 F2     JMP $F245
00/F251: E8           INX 
00/F252: 8E 6B 0A     STX $0A6B
00/F255: A6 3D        LDX $3D
00/F257: BF 60 F2 12  LDA $12F260,X
00/F25B: 85 BE        STA $BE
00/F25D: BF 61 F2 12  LDA $12F261,X
00/F261: 85 BF        STA $BF
00/F263: A6 BE        LDX $BE
00/F265: BF 60 F4 12  LDA $12F460,X
00/F269: C9 FF        CMP #$FF
00/F26B: D0 03        BNE $F270
00/F26D: 4C B3 F2     JMP $F2B3
00/F270: C9 FE        CMP #$FE
00/F272: D0 13        BNE $F287
00/F274: A6 BE        LDX $BE
00/F276: E8           INX 
00/F277: 86 BE        STX $BE
00/F279: BF 60 F4 12  LDA $12F460,X
00/F27D: 20 ED F3     JSR $F3ED       ; check event switch
00/F280: C9 00        CMP #$00
00/F282: F0 12        BEQ $F296
00/F284: 4C 8E F2     JMP $F28E
00/F287: 20 ED F3     JSR $F3ED       ; check event switch
00/F28A: C9 00        CMP #$00
00/F28C: D0 08        BNE $F296
00/F28E: A6 BE        LDX $BE
00/F290: E8           INX 
00/F291: 86 BE        STX $BE
00/F293: 4C 63 F2     JMP $F263
00/F296: A6 BE        LDX $BE
00/F298: E8           INX 
00/F299: BF 60 F4 12  LDA $12F460,X
00/F29D: C9 FF        CMP #$FF
00/F29F: D0 F7        BNE $F298
00/F2A1: E8           INX 
00/F2A2: 86 BE        STX $BE
00/F2A4: A6 BE        LDX $BE
00/F2A6: EC 6B 0A     CPX $0A6B
00/F2A9: F0 08        BEQ $F2B3
00/F2AB: A6 BE        LDX $BE
00/F2AD: E8           INX 
00/F2AE: 86 BE        STX $BE
00/F2B0: 4C 63 F2     JMP $F263
00/F2B3: A9 01        LDA #$01
00/F2B5: 85 B1        STA $B1
00/F2B7: 64 AB        STZ $AB
00/F2B9: A6 BE        LDX $BE
00/F2BB: BF 61 F4 12  LDA $12F461,X
00/F2BF: F0 03        BEQ $F2C4
00/F2C1: 20 EB E1     JSR $E1EB       ; execute event
00/F2C4: 64 B1        STZ $B1
00/F2C6: 60           RTS 

; [ execute npc script ]

00/F2C7: 64 3E        STZ $3E
00/F2C9: 0A           ASL 
00/F2CA: 26 3E        ROL $3E
00/F2CC: 85 3D        STA $3D
00/F2CE: AD E5 0F     LDA $0FE5
00/F2D1: 30 05        BMI $F2D8
00/F2D3: AD 01 17     LDA $1701
00/F2D6: F0 04        BEQ $F2DC
00/F2D8: E6 3E        INC $3E
00/F2DA: E6 3E        INC $3E
00/F2DC: A6 3D        LDX $3D
00/F2DE: BF 02 98 13  LDA $139802,X
00/F2E2: 85 40        STA $40
00/F2E4: BF 03 98 13  LDA $139803,X
00/F2E8: 85 41        STA $41
00/F2EA: A6 40        LDX $40
00/F2EC: CA           DEX 
00/F2ED: BF 00 9C 13  LDA $139C00,X
00/F2F1: C9 FF        CMP #$FF
00/F2F3: F0 04        BEQ $F2F9
00/F2F5: CA           DEX 
00/F2F6: 4C ED F2     JMP $F2ED
00/F2F9: E8           INX 
00/F2FA: 8E 69 0A     STX $0A69
00/F2FD: E8           INX 
00/F2FE: A0 00 00     LDY #$0000
00/F301: E4 40        CPX $40
00/F303: F0 0C        BEQ $F311
00/F305: BF 00 9C 13  LDA $139C00,X
00/F309: 99 49 0A     STA $0A49,Y
00/F30C: C8           INY 
00/F30D: E8           INX 
00/F30E: 4C 01 F3     JMP $F301
00/F311: A6 3D        LDX $3D
00/F313: BF 00 98 13  LDA $139800,X
00/F317: 85 BC        STA $BC
00/F319: BF 01 98 13  LDA $139801,X
00/F31D: 85 BD        STA $BD
00/F31F: A6 BC        LDX $BC
00/F321: BF 00 9C 13  LDA $139C00,X
00/F325: C9 FF        CMP #$FF
00/F327: D0 03        BNE $F32C
00/F329: 4C 64 F3     JMP $F364
00/F32C: C9 FE        CMP #$FE
00/F32E: D0 13        BNE $F343
00/F330: A6 BC        LDX $BC
00/F332: E8           INX 
00/F333: 86 BC        STX $BC
00/F335: BF 00 9C 13  LDA $139C00,X
00/F339: 20 ED F3     JSR $F3ED       ; check event switch
00/F33C: C9 00        CMP #$00
00/F33E: F0 12        BEQ $F352
00/F340: 4C 4A F3     JMP $F34A
00/F343: 20 ED F3     JSR $F3ED       ; check event switch
00/F346: C9 00        CMP #$00
00/F348: D0 08        BNE $F352
00/F34A: A6 BC        LDX $BC
00/F34C: E8           INX 
00/F34D: 86 BC        STX $BC
00/F34F: 4C 1F F3     JMP $F31F
00/F352: 20 78 F3     JSR $F378
00/F355: A6 BC        LDX $BC
00/F357: EC 69 0A     CPX $0A69
00/F35A: F0 08        BEQ $F364
00/F35C: A6 BC        LDX $BC
00/F35E: E8           INX 
00/F35F: 86 BC        STX $BC
00/F361: 4C 1F F3     JMP $F31F
00/F364: A9 01        LDA #$01
00/F366: 85 B1        STA $B1
00/F368: 64 AB        STZ $AB
00/F36A: A6 BC        LDX $BC
00/F36C: BF 01 9C 13  LDA $139C01,X
00/F370: F0 03        BEQ $F375
00/F372: 20 EB E1     JSR $E1EB       ; execute event
00/F375: 64 B1        STZ $B1
00/F377: 60           RTS 

; [  ]

00/F378: A6 BC        LDX $BC
00/F37A: E8           INX 
00/F37B: BF 00 9C 13  LDA $139C00,X
00/F37F: C9 FF        CMP #$FF
00/F381: D0 F7        BNE $F37A
00/F383: E8           INX 
00/F384: 86 BC        STX $BC
00/F386: 60           RTS 

; [ clear event switch ]

00/F387: 20 07 F4     JSR $F407       ; get event switch offset
00/F38A: A9 FE        LDA #$FE
00/F38C: C0 00 00     CPY #$0000
00/F38F: F0 06        BEQ $F397
00/F391: 38           SEC 
00/F392: 2A           ROL 
00/F393: 88           DEY 
00/F394: 4C 8C F3     JMP $F38C
00/F397: A6 3D        LDX $3D
00/F399: 3D 80 12     AND $1280,X
00/F39C: 9D 80 12     STA $1280,X
00/F39F: 60           RTS 

; [ clear npc switch ]

00/F3A0: 20 14 F4     JSR $F414       ; get npc switch offset
00/F3A3: A9 FE        LDA #$FE
00/F3A5: C0 00 00     CPY #$0000
00/F3A8: F0 06        BEQ $F3B0
00/F3AA: 38           SEC 
00/F3AB: 2A           ROL 
00/F3AC: 88           DEY 
00/F3AD: 4C A5 F3     JMP $F3A5
00/F3B0: A6 3D        LDX $3D
00/F3B2: 3F E0 12 00  AND $0012E0,X
00/F3B6: 9F E0 12 00  STA $0012E0,X
00/F3BA: 60           RTS 

; [ set event switch ]

00/F3BB: 20 07 F4     JSR $F407       ; get event switch offset
00/F3BE: A9 01        LDA #$01
00/F3C0: C0 00 00     CPY #$0000
00/F3C3: F0 05        BEQ $F3CA
00/F3C5: 0A           ASL 
00/F3C6: 88           DEY 
00/F3C7: 4C C0 F3     JMP $F3C0
00/F3CA: A6 3D        LDX $3D
00/F3CC: 1D 80 12     ORA $1280,X
00/F3CF: 9D 80 12     STA $1280,X
00/F3D2: 60           RTS 

; [ set npc switch ]

00/F3D3: 20 14 F4     JSR $F414       ; get npc switch offset
00/F3D6: A9 01        LDA #$01
00/F3D8: C0 00 00     CPY #$0000
00/F3DB: F0 05        BEQ $F3E2
00/F3DD: 0A           ASL 
00/F3DE: 88           DEY 
00/F3DF: 4C D8 F3     JMP $F3D8
00/F3E2: A6 3D        LDX $3D
00/F3E4: 1F E0 12 00  ORA $0012E0,X
00/F3E8: 9F E0 12 00  STA $0012E0,X
00/F3EC: 60           RTS 

; [ check event switch ]

; A: event bit index

00/F3ED: DA           PHX 
00/F3EE: 20 07 F4     JSR $F407       ; get event switch offset
00/F3F1: A6 3D        LDX $3D
00/F3F3: BD 80 12     LDA $1280,X
00/F3F6: C0 00 00     CPY #$0000
00/F3F9: F0 05        BEQ $F400
00/F3FB: 4A           LSR 
00/F3FC: 88           DEY 
00/F3FD: 4C F6 F3     JMP $F3F6
00/F400: 4A           LSR 
00/F401: A9 00        LDA #$00
00/F403: 69 00        ADC #$00
00/F405: FA           PLX 
00/F406: 60           RTS 

; [ get event switch offset ]

;    A: switch id
;    Y: bit index (out)
; +$3D: byte offset (out)

00/F407: 48           PHA 
00/F408: 4A           LSR 
00/F409: 4A           LSR 
00/F40A: 4A           LSR 
00/F40B: 85 3D        STA $3D
00/F40D: 64 3E        STZ $3E
00/F40F: 68           PLA 
00/F410: 29 07        AND #$07
00/F412: A8           TAY 
00/F413: 60           RTS 

; [ get npc switch offset ]

;    A: switch id
;    Y: bit index (out)
; +$3D: byte offset (out)

00/F414: 48           PHA 
00/F415: 4A           LSR 
00/F416: 4A           LSR 
00/F417: 4A           LSR 
00/F418: 85 3D        STA $3D
00/F41A: 64 3E        STZ $3E
00/F41C: AD E5 0F     LDA $0FE5
00/F41F: 30 05        BMI $F426
00/F421: AD 01 17     LDA $1701
00/F424: F0 07        BEQ $F42D
00/F426: A5 3D        LDA $3D
00/F428: 18           CLC 
00/F429: 69 20        ADC #$20
00/F42B: 85 3D        STA $3D
00/F42D: 68           PLA 
00/F42E: 29 07        AND #$07
00/F430: A8           TAY 
00/F431: 60           RTS 

; --------------------------------------------------------------------------

; [ init mode 7 hdma zoom data ]

; airship
00/F432: A9 00        LDA #$00
00/F434: 8D 05 21     STA $2105
00/F437: A2 00 00     LDX #$0000
00/F43A: 86 3D        STX $3D
00/F43C: 86 40        STX $40
00/F43E: 86 43        STX $43
00/F440: DA           PHX 
00/F441: A6 3D        LDX $3D         ; current scanline
00/F443: BF CE F3 14  LDA $14F3CE,X
00/F447: E8           INX 
00/F448: 86 3D        STX $3D
00/F44A: FA           PLX 
00/F44B: 8D 1B 21     STA $211B
00/F44E: 9C 1B 21     STZ $211B
00/F451: A5 40        LDA $40         ; zoom multiplier
00/F453: 8D 1C 21     STA $211C
00/F456: 8D 1C 21     STA $211C
00/F459: C2 20        REP #$20
00/F45B: AD 35 21     LDA $2135
00/F45E: 0A           ASL 
00/F45F: 0A           ASL 
00/F460: 0A           ASL 
00/F461: 18           CLC 
00/F462: 69 00 01     ADC #$0100
00/F465: 9F 00 00 7F  STA $7F0000,X
00/F469: A9 00 00     LDA #$0000
00/F46C: E2 20        SEP #$20
00/F46E: E8           INX             ; next scanline
00/F46F: E8           INX 
00/F470: A4 3D        LDY $3D
00/F472: C0 F0 00     CPY #$00F0
00/F475: D0 C9        BNE $F440
00/F477: 20 18 F5     JSR $F518
00/F47A: A5 40        LDA $40         ; next zoom level
00/F47C: C9 80        CMP #$80
00/F47E: D0 C0        BNE $F440
00/F480: DA           PHX 
00/F481: A6 3D        LDX $3D
00/F483: BF CE F3 14  LDA $14F3CE,X
00/F487: E8           INX 
00/F488: 86 3D        STX $3D
00/F48A: FA           PLX 
00/F48B: 64 06        STZ $06
00/F48D: 0A           ASL 
00/F48E: 26 06        ROL $06
00/F490: 0A           ASL 
00/F491: 26 06        ROL $06
00/F493: 9F 00 00 7F  STA $7F0000,X
00/F497: A5 06        LDA $06
00/F499: 1A           INC 
00/F49A: 9F 01 00 7F  STA $7F0001,X
00/F49E: E8           INX             ; next scanline
00/F49F: E8           INX 
00/F4A0: A4 3D        LDY $3D
00/F4A2: C0 F0 00     CPY #$00F0
00/F4A5: D0 D9        BNE $F480
; big whale
00/F4A7: A2 00 00     LDX #$0000
00/F4AA: 86 3D        STX $3D
00/F4AC: 86 40        STX $40
00/F4AE: 86 43        STX $43
00/F4B0: DA           PHX 
00/F4B1: A6 3D        LDX $3D
00/F4B3: BF AE F4 14  LDA $14F4AE,X
00/F4B7: E8           INX 
00/F4B8: 86 3D        STX $3D
00/F4BA: FA           PLX 
00/F4BB: 8D 1B 21     STA $211B
00/F4BE: 9C 1B 21     STZ $211B
00/F4C1: A5 40        LDA $40
00/F4C3: 8D 1C 21     STA $211C
00/F4C6: 8D 1C 21     STA $211C
00/F4C9: C2 20        REP #$20
00/F4CB: AD 35 21     LDA $2135
00/F4CE: 0A           ASL 
00/F4CF: 0A           ASL 
00/F4D0: 0A           ASL 
00/F4D1: 18           CLC 
00/F4D2: 69 00 01     ADC #$0100
00/F4D5: 9F 00 22 7F  STA $7F2200,X
00/F4D9: A9 00 00     LDA #$0000
00/F4DC: E2 20        SEP #$20
00/F4DE: E8           INX 
00/F4DF: E8           INX 
00/F4E0: A4 3D        LDY $3D
00/F4E2: C0 F0 00     CPY #$00F0
00/F4E5: D0 C9        BNE $F4B0
00/F4E7: 20 18 F5     JSR $F518
00/F4EA: A5 40        LDA $40
00/F4EC: C9 80        CMP #$80
00/F4EE: D0 C0        BNE $F4B0
00/F4F0: DA           PHX 
00/F4F1: A6 3D        LDX $3D
00/F4F3: BF AE F4 14  LDA $14F4AE,X
00/F4F7: E8           INX 
00/F4F8: 86 3D        STX $3D
00/F4FA: FA           PLX 
00/F4FB: 64 06        STZ $06
00/F4FD: 0A           ASL 
00/F4FE: 26 06        ROL $06
00/F500: 0A           ASL 
00/F501: 26 06        ROL $06
00/F503: 9F 00 22 7F  STA $7F2200,X
00/F507: A5 06        LDA $06
00/F509: 1A           INC 
00/F50A: 9F 01 22 7F  STA $7F2201,X
00/F50E: E8           INX 
00/F50F: E8           INX 
00/F510: A4 3D        LDY $3D
00/F512: C0 F0 00     CPY #$00F0
00/F515: D0 D9        BNE $F4F0
00/F517: 60           RTS 

; [ increment zoom multiplier ]

00/F518: A0 00 00     LDY #$0000
00/F51B: 84 3D        STY $3D
00/F51D: A5 40        LDA $40
00/F51F: 18           CLC 
00/F520: 69 08        ADC #$08
00/F522: 85 40        STA $40
00/F524: 85 44        STA $44
00/F526: 64 43        STZ $43
00/F528: 46 44        LSR $44
00/F52A: 66 43        ROR $43
00/F52C: 46 44        LSR $44
00/F52E: 66 43        ROR $43
00/F530: A6 43        LDX $43
00/F532: 60           RTS 

; [ update bg2 scroll ]

00/F533: A5 C9        LDA $C9
00/F535: D0 0E        BNE $F545
00/F537: AD 00 17     LDA $1700
00/F53A: C9 03        CMP #$03
00/F53C: D0 07        BNE $F545
00/F53E: AD E4 0F     LDA $0FE4
00/F541: 29 C0        AND #$C0
00/F543: D0 01        BNE $F546
00/F545: 60           RTS 
00/F546: AD E4 0F     LDA $0FE4
00/F549: 29 06        AND #$06
00/F54B: D0 46        BNE $F593
; continuous scroll
00/F54D: AD E4 0F     LDA $0FE4
00/F550: 29 C0        AND #$C0
00/F552: 4A           LSR 
00/F553: 4A           LSR 
00/F554: 4A           LSR 
00/F555: 4A           LSR 
00/F556: 4A           LSR 
00/F557: 4A           LSR 
00/F558: A8           TAY 
00/F559: A5 7A        LDA $7A
00/F55B: 39 F9 F5     AND $F5F9,Y     ; bg2 scroll speed
00/F55E: D0 1B        BNE $F57B
00/F560: AD E4 0F     LDA $0FE4
00/F563: 29 30        AND #$30
00/F565: 4A           LSR 
00/F566: 4A           LSR 
00/F567: 4A           LSR 
00/F568: A8           TAY 
00/F569: C2 20        REP #$20
00/F56B: A5 66        LDA $66
00/F56D: 18           CLC 
00/F56E: 79 FD F5     ADC $F5FD,Y
00/F571: 85 66        STA $66
00/F573: A5 68        LDA $68
00/F575: 18           CLC 
00/F576: 79 05 F6     ADC $F605,Y
00/F579: 85 68        STA $68
00/F57B: C2 20        REP #$20
00/F57D: A5 5A        LDA $5A
00/F57F: 18           CLC 
00/F580: 65 66        ADC $66
00/F582: 85 5E        STA $5E
00/F584: A5 5C        LDA $5C
00/F586: 18           CLC 
00/F587: 65 68        ADC $68
00/F589: 85 60        STA $60
00/F58B: A9 00 00     LDA #$0000
00/F58E: E2 20        SEP #$20
00/F590: 4C F8 F5     JMP $F5F8
; parallax scroll
00/F593: AD E4 0F     LDA $0FE4
00/F596: 29 04        AND #$04
00/F598: F0 2D        BEQ $F5C7
00/F59A: A6 5A        LDX $5A
00/F59C: 86 5E        STX $5E
00/F59E: AD E4 0F     LDA $0FE4
00/F5A1: 29 C0        AND #$C0
00/F5A3: C9 80        CMP #$80
00/F5A5: F0 0F        BEQ $F5B6
00/F5A7: C9 40        CMP #$40
00/F5A9: F0 07        BEQ $F5B2
00/F5AB: 06 5E        ASL $5E
00/F5AD: 26 5F        ROL $5F
00/F5AF: 4C B6 F5     JMP $F5B6
00/F5B2: 46 5F        LSR $5F
00/F5B4: 66 5E        ROR $5E
00/F5B6: AD E4 0F     LDA $0FE4
00/F5B9: 29 06        AND #$06
00/F5BB: C9 04        CMP #$04
00/F5BD: D0 08        BNE $F5C7
00/F5BF: A2 00 00     LDX #$0000
00/F5C2: 86 60        STX $60
00/F5C4: 4C F8 F5     JMP $F5F8
00/F5C7: AD E4 0F     LDA $0FE4
00/F5CA: 29 02        AND #$02
00/F5CC: F0 2A        BEQ $F5F8
00/F5CE: A6 5C        LDX $5C
00/F5D0: 86 60        STX $60
00/F5D2: AD E4 0F     LDA $0FE4
00/F5D5: 29 C0        AND #$C0
00/F5D7: C9 80        CMP #$80
00/F5D9: F0 0F        BEQ $F5EA
00/F5DB: C9 40        CMP #$40
00/F5DD: F0 07        BEQ $F5E6
00/F5DF: 06 60        ASL $60
00/F5E1: 26 61        ROL $61
00/F5E3: 4C EA F5     JMP $F5EA
00/F5E6: 46 61        LSR $61
00/F5E8: 66 60        ROR $60
00/F5EA: AD E4 0F     LDA $0FE4
00/F5ED: 29 06        AND #$06
00/F5EF: C9 02        CMP #$02
00/F5F1: D0 05        BNE $F5F8
00/F5F3: A2 00 00     LDX #$0000
00/F5F6: 86 5E        STX $5E
00/F5F8: 60           RTS 

; bg2 scroll speeds
00/F5F9: 00 07 01 00

; movement h-scroll speeds
00/F5FD: 0000 FFFF 0000 0001

; movement v-scroll speeds
00/F605: 0001 0000 FFFF 0000

; [ load world tileset ]

;  A: source bank
; +Y: source address

00/F60D: 48           PHA 
00/F60E: AB           PLB 
00/F60F: A2 00 00     LDX #$0000
00/F612: B9 00 00     LDA $0000,Y
00/F615: 9F 00 48 7F  STA $7F4800,X
00/F619: C8           INY 
00/F61A: E8           INX 
00/F61B: E0 00 02     CPX #$0200
00/F61E: D0 F2        BNE $F612
00/F620: A9 00        LDA #$00
00/F622: 48           PHA 
00/F623: AB           PLB 
00/F624: 60           RTS 

; [ clear bg tilemap ]

; A: fill tile

00/F625: A2 00 00     LDX #$0000
00/F628: 9F 71 5C 7F  STA $7F5C71,X
00/F62C: E8           INX 
00/F62D: E0 00 40     CPX #$4000
00/F630: D0 F6        BNE $F628
00/F632: 60           RTS 

; [ update tilemap scrolling (world map) ]

00/F633: A5 AB        LDA $AB
00/F635: D0 01        BNE $F638       ; return if not moving
00/F637: 60           RTS 
00/F638: 29 01        AND #$01
00/F63A: F0 03        BEQ $F63F
00/F63C: 4C C9 F6     JMP $F6C9
; moving right
00/F63F: A5 AB        LDA $AB
00/F641: 29 02        AND #$02
00/F643: F0 0B        BEQ $F650
00/F645: AD 06 17     LDA $1706
00/F648: 18           CLC 
00/F649: 69 21        ADC #$21
00/F64B: 85 3D        STA $3D
00/F64D: 4C 58 F6     JMP $F658
; moving left
00/F650: AD 06 17     LDA $1706
00/F653: 38           SEC 
00/F654: E9 1F        SBC #$1F
00/F656: 85 3D        STA $3D
00/F658: AD 07 17     LDA $1707
00/F65B: 38           SEC 
00/F65C: E9 1F        SBC #$1F
00/F65E: 29 3F        AND #$3F
00/F660: 85 3E        STA $3E
00/F662: A6 3D        LDX $3D
00/F664: 86 40        STX $40
00/F666: A0 00 00     LDY #$0000
00/F669: A6 3D        LDX $3D
00/F66B: BF 71 5C 7F  LDA $7F5C71,X
00/F66F: AA           TAX 
00/F670: BF 00 48 7F  LDA $7F4800,X
00/F674: 99 DB 0A     STA $0ADB,Y
00/F677: BF 00 49 7F  LDA $7F4900,X
00/F67B: 99 DC 0A     STA $0ADC,Y
00/F67E: BF 80 48 7F  LDA $7F4880,X
00/F682: 99 5B 0B     STA $0B5B,Y
00/F685: BF 80 49 7F  LDA $7F4980,X
00/F689: 99 5C 0B     STA $0B5C,Y
00/F68C: A5 3E        LDA $3E
00/F68E: 1A           INC 
00/F68F: 29 3F        AND #$3F
00/F691: 85 3E        STA $3E
00/F693: C8           INY 
00/F694: C8           INY 
00/F695: C0 80 00     CPY #$0080
00/F698: D0 CF        BNE $F669
00/F69A: 64 98        STZ $98
00/F69C: 64 96        STZ $96
00/F69E: 64 9C        STZ $9C
00/F6A0: 64 A0        STZ $A0
00/F6A2: A5 40        LDA $40
00/F6A4: 0A           ASL 
00/F6A5: 29 7F        AND #$7F
00/F6A7: 85 99        STA $99
00/F6A9: 85 9B        STA $9B
00/F6AB: 1A           INC 
00/F6AC: 85 9D        STA $9D
00/F6AE: 85 9F        STA $9F
00/F6B0: AD 07 17     LDA $1707
00/F6B3: 38           SEC 
00/F6B4: E9 1F        SBC #$1F
00/F6B6: 29 3F        AND #$3F
00/F6B8: 85 9A        STA $9A
00/F6BA: 85 9E        STA $9E
00/F6BC: 0A           ASL 
00/F6BD: 85 97        STA $97
00/F6BF: A9 80        LDA #$80
00/F6C1: 38           SEC 
00/F6C2: E5 97        SBC $97
00/F6C4: 85 95        STA $95
00/F6C6: E6 94        INC $94
00/F6C8: 60           RTS 
; moving up
00/F6C9: A5 AB        LDA $AB
00/F6CB: 29 02        AND #$02
00/F6CD: D0 0F        BNE $F6DE
00/F6CF: AD 07 17     LDA $1707
00/F6D2: 38           SEC 
00/F6D3: E9 1F        SBC #$1F
00/F6D5: 85 06        STA $06
00/F6D7: 29 3F        AND #$3F
00/F6D9: 85 3E        STA $3E
00/F6DB: 4C EA F6     JMP $F6EA
; moving down
00/F6DE: AD 07 17     LDA $1707
00/F6E1: 18           CLC 
00/F6E2: 69 20        ADC #$20
00/F6E4: 85 06        STA $06
00/F6E6: 29 3F        AND #$3F
00/F6E8: 85 3E        STA $3E
00/F6EA: AD 06 17     LDA $1706
00/F6ED: 38           SEC 
00/F6EE: E9 1F        SBC #$1F
00/F6F0: 85 3D        STA $3D
00/F6F2: A6 3D        LDX $3D
00/F6F4: 86 40        STX $40
00/F6F6: A0 00 00     LDY #$0000
00/F6F9: A6 3D        LDX $3D
00/F6FB: BF 71 5C 7F  LDA $7F5C71,X
00/F6FF: AA           TAX 
00/F700: BF 00 48 7F  LDA $7F4800,X
00/F704: 99 DB 0A     STA $0ADB,Y
00/F707: BF 80 48 7F  LDA $7F4880,X
00/F70B: 99 DC 0A     STA $0ADC,Y
00/F70E: BF 00 49 7F  LDA $7F4900,X
00/F712: 99 5B 0B     STA $0B5B,Y
00/F715: BF 80 49 7F  LDA $7F4980,X
00/F719: 99 5C 0B     STA $0B5C,Y
00/F71C: C8           INY 
00/F71D: C8           INY 
00/F71E: E6 3D        INC $3D
00/F720: C0 80 00     CPY #$0080
00/F723: D0 D4        BNE $F6F9
00/F725: 64 97        STZ $97
00/F727: 64 98        STZ $98
00/F729: A9 80        LDA #$80
00/F72B: 85 95        STA $95
00/F72D: 64 96        STZ $96
00/F72F: 64 9B        STZ $9B
00/F731: A9 80        LDA #$80
00/F733: 85 9F        STA $9F
00/F735: A5 06        LDA $06
00/F737: 29 3F        AND #$3F
00/F739: 85 9A        STA $9A
00/F73B: 85 9C        STA $9C
00/F73D: 85 9E        STA $9E
00/F73F: 85 A0        STA $A0
00/F741: AD 06 17     LDA $1706
00/F744: 38           SEC 
00/F745: E9 1F        SBC #$1F
00/F747: 29 3F        AND #$3F
00/F749: 0A           ASL 
00/F74A: 85 99        STA $99
00/F74C: 18           CLC 
00/F74D: 69 80        ADC #$80
00/F74F: 85 9D        STA $9D
00/F751: A5 99        LDA $99
00/F753: 85 97        STA $97
00/F755: A9 80        LDA #$80
00/F757: 38           SEC 
00/F758: E5 97        SBC $97
00/F75A: 85 95        STA $95
00/F75C: E6 94        INC $94
00/F75E: 60           RTS 

; [ update tilemap scrolling (sub-map) ]

00/F75F: A5 AB        LDA $AB
00/F761: D0 01        BNE $F764       ; return if not moving
00/F763: 60           RTS 
00/F764: 29 01        AND #$01
00/F766: F0 03        BEQ $F76B
00/F768: 4C 3F F8     JMP $F83F
00/F76B: A5 AB        LDA $AB
00/F76D: 29 02        AND #$02
00/F76F: F0 0B        BEQ $F77C
; moving right
00/F771: AD 06 17     LDA $1706
00/F774: 18           CLC 
00/F775: 69 09        ADC #$09
00/F777: 85 3D        STA $3D
00/F779: 4C 84 F7     JMP $F784
; moving left
00/F77C: AD 06 17     LDA $1706
00/F77F: 38           SEC 
00/F780: E9 08        SBC #$08
00/F782: 85 3D        STA $3D
00/F784: AD 07 17     LDA $1707
00/F787: 38           SEC 
00/F788: E9 07        SBC #$07
00/F78A: 29 3F        AND #$3F
00/F78C: 85 3E        STA $3E
00/F78E: A6 3D        LDX $3D
00/F790: 86 43        STX $43
00/F792: A0 00 00     LDY #$0000
00/F795: A6 3D        LDX $3D
00/F797: BF 71 5C 7F  LDA $7F5C71,X   ; tile id
00/F79B: 85 18        STA $18
00/F79D: 64 19        STZ $19
00/F79F: C2 20        REP #$20
00/F7A1: 06 18        ASL $18
00/F7A3: A6 18        LDX $18
00/F7A5: BF 00 48 7F  LDA $7F4800,X   ; copy from tileset to tilemap buffer
00/F7A9: 99 DB 0A     STA $0ADB,Y
00/F7AC: BF 00 4A 7F  LDA $7F4A00,X
00/F7B0: 99 DD 0A     STA $0ADD,Y
00/F7B3: BF 00 49 7F  LDA $7F4900,X
00/F7B7: 99 1B 0B     STA $0B1B,Y
00/F7BA: BF 00 4B 7F  LDA $7F4B00,X
00/F7BE: 99 1D 0B     STA $0B1D,Y
00/F7C1: A9 00 00     LDA #$0000
00/F7C4: E2 20        SEP #$20
00/F7C6: A5 3E        LDA $3E
00/F7C8: 1A           INC 
00/F7C9: 29 3F        AND #$3F
00/F7CB: 85 3E        STA $3E
00/F7CD: C8           INY 
00/F7CE: C8           INY 
00/F7CF: C8           INY 
00/F7D0: C8           INY 
00/F7D1: C0 40 00     CPY #$0040
00/F7D4: F0 03        BEQ $F7D9
00/F7D6: 4C 95 F7     JMP $F795
00/F7D9: 64 99        STZ $99
00/F7DB: A5 44        LDA $44
00/F7DD: 29 0F        AND #$0F
00/F7DF: 85 9A        STA $9A
00/F7E1: 46 9A        LSR $9A
00/F7E3: 66 99        ROR $99
00/F7E5: 46 9A        LSR $9A
00/F7E7: 66 99        ROR $99
00/F7E9: A5 43        LDA $43
00/F7EB: 29 1F        AND #$1F
00/F7ED: 0A           ASL 
00/F7EE: 85 43        STA $43
00/F7F0: 29 20        AND #$20
00/F7F2: F0 07        BEQ $F7FB
00/F7F4: A5 9A        LDA $9A
00/F7F6: 18           CLC 
00/F7F7: 69 04        ADC #$04
00/F7F9: 85 9A        STA $9A
00/F7FB: A5 43        LDA $43
00/F7FD: 29 1F        AND #$1F
00/F7FF: 18           CLC 
00/F800: 65 99        ADC $99
00/F802: 85 99        STA $99
00/F804: A5 9A        LDA $9A
00/F806: 18           CLC 
00/F807: 69 18        ADC #$18
00/F809: 85 9A        STA $9A
00/F80B: A5 44        LDA $44
00/F80D: 29 0F        AND #$0F
00/F80F: 0A           ASL 
00/F810: 0A           ASL 
00/F811: 85 97        STA $97
00/F813: 64 98        STZ $98
00/F815: A9 40        LDA #$40
00/F817: 38           SEC 
00/F818: E5 97        SBC $97
00/F81A: 85 95        STA $95
00/F81C: 64 96        STZ $96
00/F81E: A5 9A        LDA $9A
00/F820: 29 FC        AND #$FC
00/F822: 85 9C        STA $9C
00/F824: A5 99        LDA $99
00/F826: 29 1F        AND #$1F
00/F828: 85 9B        STA $9B
00/F82A: A5 99        LDA $99
00/F82C: 1A           INC 
00/F82D: 85 9D        STA $9D
00/F82F: A5 9A        LDA $9A
00/F831: 85 9E        STA $9E
00/F833: A5 9B        LDA $9B
00/F835: 1A           INC 
00/F836: 85 9F        STA $9F
00/F838: A5 9C        LDA $9C
00/F83A: 85 A0        STA $A0
00/F83C: E6 94        INC $94
00/F83E: 60           RTS 
; moving up
00/F83F: A5 AB        LDA $AB
00/F841: 29 02        AND #$02
00/F843: D0 0D        BNE $F852
00/F845: AD 07 17     LDA $1707
00/F848: 38           SEC 
00/F849: E9 08        SBC #$08
00/F84B: 29 3F        AND #$3F
00/F84D: 85 3E        STA $3E
00/F84F: 4C 5C F8     JMP $F85C
; moving down
00/F852: AD 07 17     LDA $1707
00/F855: 18           CLC 
00/F856: 69 08        ADC #$08
00/F858: 29 3F        AND #$3F
00/F85A: 85 3E        STA $3E
00/F85C: AD 06 17     LDA $1706
00/F85F: 38           SEC 
00/F860: E9 07        SBC #$07
00/F862: 85 3D        STA $3D
00/F864: A6 3D        LDX $3D
00/F866: 86 43        STX $43
00/F868: 20 6F F8     JSR $F86F       ; copy tilemap row to vram buffer
00/F86B: 20 AF F8     JSR $F8AF
00/F86E: 60           RTS 

; [ copy tilemap row to vram buffer ]

00/F86F: A0 00 00     LDY #$0000
00/F872: A6 3D        LDX $3D
00/F874: BF 71 5C 7F  LDA $7F5C71,X
00/F878: 85 18        STA $18
00/F87A: 64 19        STZ $19
00/F87C: C2 20        REP #$20
00/F87E: 06 18        ASL $18
00/F880: A6 18        LDX $18
00/F882: BF 00 48 7F  LDA $7F4800,X   ; copy to tilemap vram buffer
00/F886: 99 DB 0A     STA $0ADB,Y
00/F889: BF 00 49 7F  LDA $7F4900,X
00/F88D: 99 DD 0A     STA $0ADD,Y
00/F890: BF 00 4A 7F  LDA $7F4A00,X
00/F894: 99 1B 0B     STA $0B1B,Y
00/F897: BF 00 4B 7F  LDA $7F4B00,X
00/F89B: 99 1D 0B     STA $0B1D,Y
00/F89E: A9 00 00     LDA #$0000
00/F8A1: E2 20        SEP #$20
00/F8A3: C8           INY 
00/F8A4: C8           INY 
00/F8A5: C8           INY 
00/F8A6: C8           INY 
00/F8A7: E6 3D        INC $3D
00/F8A9: C0 40 00     CPY #$0040
00/F8AC: D0 C4        BNE $F872
00/F8AE: 60           RTS 

; [  ]

00/F8AF: 64 99        STZ $99
00/F8B1: A5 44        LDA $44
00/F8B3: 29 0F        AND #$0F
00/F8B5: 85 9A        STA $9A
00/F8B7: 46 9A        LSR $9A
00/F8B9: 66 99        ROR $99
00/F8BB: 46 9A        LSR $9A
00/F8BD: 66 99        ROR $99
00/F8BF: A5 43        LDA $43
00/F8C1: 29 1F        AND #$1F
00/F8C3: 0A           ASL 
00/F8C4: 85 43        STA $43
00/F8C6: 29 20        AND #$20
00/F8C8: F0 07        BEQ $F8D1
00/F8CA: A5 9A        LDA $9A
00/F8CC: 18           CLC 
00/F8CD: 69 04        ADC #$04
00/F8CF: 85 9A        STA $9A
00/F8D1: A5 43        LDA $43
00/F8D3: 29 1F        AND #$1F
00/F8D5: 18           CLC 
00/F8D6: 65 99        ADC $99
00/F8D8: 85 99        STA $99
00/F8DA: A5 9A        LDA $9A
00/F8DC: 18           CLC 
00/F8DD: 69 18        ADC #$18
00/F8DF: 85 9A        STA $9A
00/F8E1: A5 99        LDA $99
00/F8E3: 29 1F        AND #$1F
00/F8E5: 0A           ASL 
00/F8E6: 85 97        STA $97
00/F8E8: 64 98        STZ $98
00/F8EA: A9 40        LDA #$40
00/F8EC: 38           SEC 
00/F8ED: E5 97        SBC $97
00/F8EF: 85 95        STA $95
00/F8F1: 64 96        STZ $96
00/F8F3: A5 99        LDA $99
00/F8F5: 29 E0        AND #$E0
00/F8F7: 85 9B        STA $9B
00/F8F9: A5 9A        LDA $9A
00/F8FB: 18           CLC 
00/F8FC: 69 04        ADC #$04
00/F8FE: 29 07        AND #$07
00/F900: 18           CLC 
00/F901: 69 18        ADC #$18
00/F903: 85 9C        STA $9C
00/F905: A5 99        LDA $99
00/F907: 18           CLC 
00/F908: 69 20        ADC #$20
00/F90A: 85 9D        STA $9D
00/F90C: A5 9A        LDA $9A
00/F90E: 69 00        ADC #$00
00/F910: 85 9E        STA $9E
00/F912: A5 9B        LDA $9B
00/F914: 18           CLC 
00/F915: 69 20        ADC #$20
00/F917: 85 9F        STA $9F
00/F919: A5 9C        LDA $9C
00/F91B: 69 00        ADC #$00
00/F91D: 85 A0        STA $A0
00/F91F: E6 94        INC $94
00/F921: 60           RTS 

; [  ]

00/F922: 64 99        STZ $99
00/F924: A5 44        LDA $44
00/F926: 29 0F        AND #$0F
00/F928: 85 9A        STA $9A
00/F92A: A5 44        LDA $44
00/F92C: 29 10        AND #$10
00/F92E: F0 07        BEQ $F937
00/F930: A5 9A        LDA $9A
00/F932: 18           CLC 
00/F933: 69 20        ADC #$20
00/F935: 85 9A        STA $9A
00/F937: 46 9A        LSR $9A
00/F939: 66 99        ROR $99
00/F93B: 46 9A        LSR $9A
00/F93D: 66 99        ROR $99
00/F93F: A5 43        LDA $43
00/F941: 29 1F        AND #$1F
00/F943: 0A           ASL 
00/F944: 85 43        STA $43
00/F946: 29 20        AND #$20
00/F948: F0 07        BEQ $F951
00/F94A: A5 9A        LDA $9A
00/F94C: 18           CLC 
00/F94D: 69 04        ADC #$04
00/F94F: 85 9A        STA $9A
00/F951: A5 43        LDA $43
00/F953: 29 1F        AND #$1F
00/F955: 18           CLC 
00/F956: 65 99        ADC $99
00/F958: 85 99        STA $99
00/F95A: A5 9A        LDA $9A
00/F95C: 18           CLC 
00/F95D: 69 30        ADC #$30
00/F95F: 85 9A        STA $9A
00/F961: A5 99        LDA $99
00/F963: 18           CLC 
00/F964: 69 20        ADC #$20
00/F966: 85 9D        STA $9D
00/F968: A5 9A        LDA $9A
00/F96A: 69 00        ADC #$00
00/F96C: 85 9E        STA $9E
00/F96E: E6 94        INC $94
00/F970: 60           RTS 

; [  ]

00/F971: C2 20        REP #$20
00/F973: AD 07 17     LDA $1707
00/F976: 29 FF 00     AND #$00FF
00/F979: 38           SEC 
00/F97A: E9 07 00     SBC #$0007
00/F97D: 0A           ASL 
00/F97E: 0A           ASL 
00/F97F: 0A           ASL 
00/F980: 0A           ASL 
00/F981: 29 FF 07     AND #$07FF
00/F984: 85 5C        STA $5C
00/F986: AD 06 17     LDA $1706
00/F989: 29 FF 00     AND #$00FF
00/F98C: 38           SEC 
00/F98D: E9 07 00     SBC #$0007
00/F990: 0A           ASL 
00/F991: 0A           ASL 
00/F992: 0A           ASL 
00/F993: 0A           ASL 
00/F994: 29 FF 07     AND #$07FF
00/F997: 85 5A        STA $5A
00/F999: A9 00 00     LDA #$0000
00/F99C: E2 20        SEP #$20
00/F99E: A9 40        LDA #$40
00/F9A0: 85 07        STA $07
00/F9A2: AD 07 17     LDA $1707
00/F9A5: 8D 0A 07     STA $070A
00/F9A8: 20 20 FD     JSR $FD20       ; decompress world tilemap
00/F9AB: EE 0A 07     INC $070A
00/F9AE: C6 07        DEC $07
00/F9B0: D0 F6        BNE $F9A8
00/F9B2: A9 40        LDA #$40
00/F9B4: 85 07        STA $07
00/F9B6: AD 07 17     LDA $1707
00/F9B9: 38           SEC 
00/F9BA: E9 1F        SBC #$1F
00/F9BC: 85 08        STA $08
00/F9BE: A5 08        LDA $08
00/F9C0: 29 3F        AND #$3F
00/F9C2: 85 3E        STA $3E
00/F9C4: AD 06 17     LDA $1706
00/F9C7: 38           SEC 
00/F9C8: E9 1F        SBC #$1F
00/F9CA: 85 3D        STA $3D
00/F9CC: A6 3D        LDX $3D
00/F9CE: A0 00 00     LDY #$0000
00/F9D1: A6 3D        LDX $3D
00/F9D3: BF 71 5C 7F  LDA $7F5C71,X
00/F9D7: AA           TAX 
00/F9D8: BF 00 48 7F  LDA $7F4800,X
00/F9DC: 99 DB 0A     STA $0ADB,Y
00/F9DF: BF 80 48 7F  LDA $7F4880,X
00/F9E3: 99 DC 0A     STA $0ADC,Y
00/F9E6: BF 00 49 7F  LDA $7F4900,X
00/F9EA: 99 5B 0B     STA $0B5B,Y
00/F9ED: BF 80 49 7F  LDA $7F4980,X
00/F9F1: 99 5C 0B     STA $0B5C,Y
00/F9F4: C8           INY 
00/F9F5: C8           INY 
00/F9F6: E6 3D        INC $3D
00/F9F8: C0 80 00     CPY #$0080
00/F9FB: D0 D4        BNE $F9D1
00/F9FD: 64 97        STZ $97
00/F9FF: 64 98        STZ $98
00/FA01: A9 80        LDA #$80
00/FA03: 85 95        STA $95
00/FA05: 64 96        STZ $96
00/FA07: 64 9B        STZ $9B
00/FA09: A9 80        LDA #$80
00/FA0B: 85 9F        STA $9F
00/FA0D: A5 08        LDA $08
00/FA0F: 29 3F        AND #$3F
00/FA11: 85 9A        STA $9A
00/FA13: 85 9C        STA $9C
00/FA15: 85 9E        STA $9E
00/FA17: 85 A0        STA $A0
00/FA19: AD 06 17     LDA $1706
00/FA1C: 38           SEC 
00/FA1D: E9 1F        SBC #$1F
00/FA1F: 29 3F        AND #$3F
00/FA21: 0A           ASL 
00/FA22: 85 99        STA $99
00/FA24: 18           CLC 
00/FA25: 69 80        ADC #$80
00/FA27: 85 9D        STA $9D
00/FA29: A5 99        LDA $99
00/FA2B: 85 97        STA $97
00/FA2D: A9 80        LDA #$80
00/FA2F: 38           SEC 
00/FA30: E5 97        SBC $97
00/FA32: 85 95        STA $95
00/FA34: 9C 15 21     STZ $2115
00/FA37: 20 2A 8B     JSR $8B2A       ; init dma
00/FA3A: 9C 00 43     STZ $4300
00/FA3D: A6 99        LDX $99
00/FA3F: 8E 16 21     STX $2116
00/FA42: A2 DB 0A     LDX #$0ADB
00/FA45: 8E 02 43     STX $4302
00/FA48: A6 95        LDX $95
00/FA4A: 8E 05 43     STX $4305
00/FA4D: 20 36 8B     JSR $8B36       ; execute dma
00/FA50: A6 9B        LDX $9B
00/FA52: 8E 16 21     STX $2116
00/FA55: 9C 0B 42     STZ $420B
00/FA58: A6 97        LDX $97
00/FA5A: F0 06        BEQ $FA62
00/FA5C: 8E 05 43     STX $4305
00/FA5F: 20 36 8B     JSR $8B36       ; execute dma
00/FA62: A6 9D        LDX $9D
00/FA64: 8E 16 21     STX $2116
00/FA67: 9C 0B 42     STZ $420B
00/FA6A: A2 5B 0B     LDX #$0B5B
00/FA6D: 8E 02 43     STX $4302
00/FA70: A6 95        LDX $95
00/FA72: 8E 05 43     STX $4305
00/FA75: 20 36 8B     JSR $8B36       ; execute dma
00/FA78: A6 9F        LDX $9F
00/FA7A: 8E 16 21     STX $2116
00/FA7D: 9C 0B 42     STZ $420B
00/FA80: A6 97        LDX $97
00/FA82: F0 06        BEQ $FA8A
00/FA84: 8E 05 43     STX $4305
00/FA87: 20 36 8B     JSR $8B36       ; execute dma
00/FA8A: E6 08        INC $08
00/FA8C: C6 07        DEC $07
00/FA8E: F0 03        BEQ $FA93
00/FA90: 4C BE F9     JMP $F9BE
00/FA93: 60           RTS 

; [ init bg1 tilemap ]

00/FA94: C2 20        REP #$20
00/FA96: AD 07 17     LDA $1707
00/FA99: 29 FF 00     AND #$00FF
00/FA9C: 38           SEC 
00/FA9D: E9 07 00     SBC #$0007
00/FAA0: 0A           ASL 
00/FAA1: 0A           ASL 
00/FAA2: 0A           ASL 
00/FAA3: 0A           ASL 
00/FAA4: 85 5C        STA $5C
00/FAA6: AD 06 17     LDA $1706
00/FAA9: 29 FF 00     AND #$00FF
00/FAAC: 38           SEC 
00/FAAD: E9 07 00     SBC #$0007
00/FAB0: 0A           ASL 
00/FAB1: 0A           ASL 
00/FAB2: 0A           ASL 
00/FAB3: 0A           ASL 
00/FAB4: 85 5A        STA $5A
00/FAB6: A9 00 00     LDA #$0000
00/FAB9: E2 20        SEP #$20
00/FABB: 20 AB FF     JSR $FFAB       ; decode bg1 tilemap
00/FABE: 20 7E 9B     JSR $9B7E       ; init map treasures
00/FAC1: A9 10        LDA #$10
00/FAC3: 85 07        STA $07
00/FAC5: AD 07 17     LDA $1707
00/FAC8: 38           SEC 
00/FAC9: E9 07        SBC #$07
00/FACB: 85 08        STA $08
00/FACD: A5 08        LDA $08
00/FACF: 29 3F        AND #$3F
00/FAD1: 85 3E        STA $3E
00/FAD3: AD 06 17     LDA $1706
00/FAD6: 38           SEC 
00/FAD7: E9 07        SBC #$07
00/FAD9: 85 3D        STA $3D
00/FADB: A6 3D        LDX $3D
00/FADD: 86 43        STX $43
00/FADF: 20 6F F8     JSR $F86F       ; copy tilemap row to vram buffer
00/FAE2: 20 AF F8     JSR $F8AF
00/FAE5: A9 80        LDA #$80
00/FAE7: 8D 15 21     STA $2115
00/FAEA: 20 2A 8B     JSR $8B2A       ; init dma
00/FAED: A9 01        LDA #$01
00/FAEF: 8D 00 43     STA $4300
00/FAF2: A6 99        LDX $99
00/FAF4: 8E 16 21     STX $2116
00/FAF7: A2 DB 0A     LDX #$0ADB
00/FAFA: 8E 02 43     STX $4302
00/FAFD: A6 95        LDX $95
00/FAFF: 8E 05 43     STX $4305
00/FB02: 20 36 8B     JSR $8B36       ; execute dma
00/FB05: A6 9B        LDX $9B
00/FB07: 8E 16 21     STX $2116
00/FB0A: 9C 0B 42     STZ $420B
00/FB0D: A6 97        LDX $97
00/FB0F: F0 06        BEQ $FB17
00/FB11: 8E 05 43     STX $4305
00/FB14: 20 36 8B     JSR $8B36       ; execute dma
00/FB17: A6 9D        LDX $9D
00/FB19: 8E 16 21     STX $2116
00/FB1C: 9C 0B 42     STZ $420B
00/FB1F: A2 1B 0B     LDX #$0B1B
00/FB22: 8E 02 43     STX $4302
00/FB25: A6 95        LDX $95
00/FB27: 8E 05 43     STX $4305
00/FB2A: 20 36 8B     JSR $8B36       ; execute dma
00/FB2D: A6 9F        LDX $9F
00/FB2F: 8E 16 21     STX $2116
00/FB32: 9C 0B 42     STZ $420B
00/FB35: A6 97        LDX $97
00/FB37: F0 06        BEQ $FB3F
00/FB39: 8E 05 43     STX $4305
00/FB3C: 20 36 8B     JSR $8B36       ; execute dma
00/FB3F: E6 08        INC $08
00/FB41: C6 07        DEC $07
00/FB43: F0 03        BEQ $FB48
00/FB45: 4C CD FA     JMP $FACD
00/FB48: 60           RTS 

; [ init bg2 tilemap ]

00/FB49: A9 80        LDA #$80
00/FB4B: 8D 15 21     STA $2115
00/FB4E: 20 2A 8B     JSR $8B2A       ; init dma
00/FB51: A9 01        LDA #$01
00/FB53: 8D 00 43     STA $4300
00/FB56: 20 B2 FF     JSR $FFB2       ; decode bg2 tilemap
00/FB59: A9 20        LDA #$20
00/FB5B: 85 07        STA $07
00/FB5D: A9 00        LDA #$00
00/FB5F: 85 08        STA $08
00/FB61: A5 08        LDA $08
00/FB63: 29 1F        AND #$1F
00/FB65: 85 3E        STA $3E
00/FB67: A9 00        LDA #$00
00/FB69: 85 3D        STA $3D
00/FB6B: A6 3D        LDX $3D
00/FB6D: 86 43        STX $43
00/FB6F: 20 6F F8     JSR $F86F       ; copy tilemap row to vram buffer
00/FB72: 20 22 F9     JSR $F922
00/FB75: 20 93 FB     JSR $FB93       ; transfer bg2 tilemap to vram
00/FB78: A9 10        LDA #$10
00/FB7A: 85 3D        STA $3D
00/FB7C: A6 3D        LDX $3D
00/FB7E: 86 43        STX $43
00/FB80: 20 6F F8     JSR $F86F       ; copy tilemap row to vram buffer
00/FB83: 20 22 F9     JSR $F922
00/FB86: 20 93 FB     JSR $FB93       ; transfer bg2 tilemap to vram
00/FB89: E6 08        INC $08
00/FB8B: C6 07        DEC $07
00/FB8D: F0 03        BEQ $FB92
00/FB8F: 4C 61 FB     JMP $FB61
00/FB92: 60           RTS 

; [ transfer bg2 tilemap to vram ]

00/FB93: A6 99        LDX $99
00/FB95: 8E 16 21     STX $2116
00/FB98: 9C 0B 42     STZ $420B
00/FB9B: A2 DB 0A     LDX #$0ADB
00/FB9E: 8E 02 43     STX $4302
00/FBA1: A2 40 00     LDX #$0040
00/FBA4: 8E 05 43     STX $4305
00/FBA7: 20 36 8B     JSR $8B36       ; execute dma
00/FBAA: A6 9D        LDX $9D
00/FBAC: 8E 16 21     STX $2116
00/FBAF: 9C 0B 42     STZ $420B
00/FBB2: A2 1B 0B     LDX #$0B1B
00/FBB5: 8E 02 43     STX $4302
00/FBB8: A2 40 00     LDX #$0040
00/FBBB: 8E 05 43     STX $4305
00/FBBE: 20 36 8B     JSR $8B36       ; execute dma
00/FBC1: 60           RTS 

; [ transfer bg1 tilemap to vram (scrolling) ]

00/FBC2: A5 AB        LDA $AB
00/FBC4: 29 01        AND #$01
00/FBC6: D0 03        BNE $FBCB
00/FBC8: 4C 1D FC     JMP $FC1D
; moving vertically
00/FBCB: A9 80        LDA #$80
00/FBCD: 8D 15 21     STA $2115
00/FBD0: 20 2A 8B     JSR $8B2A       ; init dma
00/FBD3: A9 01        LDA #$01
00/FBD5: 8D 00 43     STA $4300
00/FBD8: A6 99        LDX $99
00/FBDA: 8E 16 21     STX $2116
00/FBDD: A2 DB 0A     LDX #$0ADB
00/FBE0: 8E 02 43     STX $4302
00/FBE3: A6 95        LDX $95
00/FBE5: 8E 05 43     STX $4305
00/FBE8: 20 36 8B     JSR $8B36       ; execute dma
00/FBEB: A6 9B        LDX $9B
00/FBED: 8E 16 21     STX $2116
00/FBF0: A6 97        LDX $97
00/FBF2: F0 06        BEQ $FBFA
00/FBF4: 8E 05 43     STX $4305
00/FBF7: 20 36 8B     JSR $8B36       ; execute dma
00/FBFA: A6 9D        LDX $9D
00/FBFC: 8E 16 21     STX $2116
00/FBFF: A2 1B 0B     LDX #$0B1B
00/FC02: 8E 02 43     STX $4302
00/FC05: A6 95        LDX $95
00/FC07: 8E 05 43     STX $4305
00/FC0A: 20 36 8B     JSR $8B36       ; execute dma
00/FC0D: A6 9F        LDX $9F
00/FC0F: 8E 16 21     STX $2116
00/FC12: A6 97        LDX $97
00/FC14: F0 06        BEQ $FC1C
00/FC16: 8E 05 43     STX $4305
00/FC19: 20 36 8B     JSR $8B36       ; execute dma
00/FC1C: 60           RTS 
00/FC1D: A5 AB        LDA $AB
00/FC1F: D0 01        BNE $FC22       ; return if not moving
00/FC21: 60           RTS 
; moving horizontally
00/FC22: A9 81        LDA #$81
00/FC24: 8D 15 21     STA $2115
00/FC27: 20 2A 8B     JSR $8B2A       ; init dma
00/FC2A: A9 01        LDA #$01
00/FC2C: 8D 00 43     STA $4300
00/FC2F: A6 99        LDX $99
00/FC31: 8E 16 21     STX $2116
00/FC34: A2 DB 0A     LDX #$0ADB
00/FC37: 8E 02 43     STX $4302
00/FC3A: A6 95        LDX $95
00/FC3C: 8E 05 43     STX $4305
00/FC3F: 20 36 8B     JSR $8B36       ; execute dma
00/FC42: A6 9B        LDX $9B
00/FC44: 8E 16 21     STX $2116
00/FC47: A6 97        LDX $97
00/FC49: F0 06        BEQ $FC51
00/FC4B: 8E 05 43     STX $4305
00/FC4E: 20 36 8B     JSR $8B36       ; execute dma
00/FC51: A6 9D        LDX $9D
00/FC53: 8E 16 21     STX $2116
00/FC56: A2 1B 0B     LDX #$0B1B
00/FC59: 8E 02 43     STX $4302
00/FC5C: A6 95        LDX $95
00/FC5E: 8E 05 43     STX $4305
00/FC61: 20 36 8B     JSR $8B36       ; execute dma
00/FC64: A6 9F        LDX $9F
00/FC66: 8E 16 21     STX $2116
00/FC69: A6 97        LDX $97
00/FC6B: F0 06        BEQ $FC73
00/FC6D: 8E 05 43     STX $4305
00/FC70: 20 36 8B     JSR $8B36       ; execute dma
00/FC73: 60           RTS 

; [ transfer world tilemap to vram ]

00/FC74: A5 AB        LDA $AB
00/FC76: 29 01        AND #$01
00/FC78: D0 03        BNE $FC7D
00/FC7A: 4C CB FC     JMP $FCCB
00/FC7D: 9C 15 21     STZ $2115
00/FC80: 20 2A 8B     JSR $8B2A       ; init dma
00/FC83: 9C 00 43     STZ $4300
00/FC86: A6 99        LDX $99
00/FC88: 8E 16 21     STX $2116
00/FC8B: A2 DB 0A     LDX #$0ADB
00/FC8E: 8E 02 43     STX $4302
00/FC91: A6 95        LDX $95
00/FC93: 8E 05 43     STX $4305
00/FC96: 20 36 8B     JSR $8B36       ; execute dma
00/FC99: A6 9B        LDX $9B
00/FC9B: 8E 16 21     STX $2116
00/FC9E: A6 97        LDX $97
00/FCA0: F0 06        BEQ $FCA8
00/FCA2: 8E 05 43     STX $4305
00/FCA5: 20 36 8B     JSR $8B36       ; execute dma
00/FCA8: A6 9D        LDX $9D
00/FCAA: 8E 16 21     STX $2116
00/FCAD: A2 5B 0B     LDX #$0B5B
00/FCB0: 8E 02 43     STX $4302
00/FCB3: A6 95        LDX $95
00/FCB5: 8E 05 43     STX $4305
00/FCB8: 20 36 8B     JSR $8B36       ; execute dma
00/FCBB: A6 9F        LDX $9F
00/FCBD: 8E 16 21     STX $2116
00/FCC0: A6 97        LDX $97
00/FCC2: F0 06        BEQ $FCCA
00/FCC4: 8E 05 43     STX $4305
00/FCC7: 20 36 8B     JSR $8B36       ; execute dma
00/FCCA: 60           RTS 
00/FCCB: A5 AB        LDA $AB
00/FCCD: D0 01        BNE $FCD0
00/FCCF: 60           RTS 
00/FCD0: A9 03        LDA #$03
00/FCD2: 8D 15 21     STA $2115
00/FCD5: 20 2A 8B     JSR $8B2A       ; init dma
00/FCD8: 9C 00 43     STZ $4300
00/FCDB: A6 99        LDX $99
00/FCDD: 8E 16 21     STX $2116
00/FCE0: A2 DB 0A     LDX #$0ADB
00/FCE3: 8E 02 43     STX $4302
00/FCE6: A6 95        LDX $95
00/FCE8: 8E 05 43     STX $4305
00/FCEB: 20 36 8B     JSR $8B36       ; execute dma
00/FCEE: A6 9B        LDX $9B
00/FCF0: 8E 16 21     STX $2116
00/FCF3: A6 97        LDX $97
00/FCF5: F0 06        BEQ $FCFD
00/FCF7: 8E 05 43     STX $4305
00/FCFA: 20 36 8B     JSR $8B36       ; execute dma
00/FCFD: A6 9D        LDX $9D
00/FCFF: 8E 16 21     STX $2116
00/FD02: A2 5B 0B     LDX #$0B5B
00/FD05: 8E 02 43     STX $4302
00/FD08: A6 95        LDX $95
00/FD0A: 8E 05 43     STX $4305
00/FD0D: 20 36 8B     JSR $8B36       ; execute dma
00/FD10: A6 9F        LDX $9F
00/FD12: 8E 16 21     STX $2116
00/FD15: A6 97        LDX $97
00/FD17: F0 06        BEQ $FD1F
00/FD19: 8E 05 43     STX $4305
00/FD1C: 20 36 8B     JSR $8B36       ; execute dma
00/FD1F: 60           RTS 

; [ decompress world tilemap ]

00/FD20: A5 AB        LDA $AB
00/FD22: 29 01        AND #$01
00/FD24: D0 00        BNE $FD26
00/FD26: AD FA 06     LDA $06FA
00/FD29: AA           TAX 
00/FD2A: A5 AB        LDA $AB
00/FD2C: 29 02        AND #$02
00/FD2E: D0 0C        BNE $FD3C
00/FD30: AD 0A 07     LDA $070A
00/FD33: 38           SEC 
00/FD34: E9 1F        SBC #$1F
00/FD36: 3D B7 FE     AND $FEB7,X
00/FD39: 4C 45 FD     JMP $FD45
00/FD3C: AD 0A 07     LDA $070A
00/FD3F: 18           CLC 
00/FD40: 69 20        ADC #$20
00/FD42: 3D B7 FE     AND $FEB7,X     ; world map size masks
00/FD45: 85 3D        STA $3D
00/FD47: 85 93        STA $93
00/FD49: 64 3E        STZ $3E
00/FD4B: 64 44        STZ $44
00/FD4D: A5 3D        LDA $3D
00/FD4F: 29 3F        AND #$3F
00/FD51: 85 41        STA $41
00/FD53: 64 40        STZ $40
00/FD55: 06 3D        ASL $3D
00/FD57: 26 3E        ROL $3E
00/FD59: AD 00 17     LDA $1700
00/FD5C: D0 08        BNE $FD66
00/FD5E: 20 72 FD     JSR $FD72       ; decompress overworld tilemap
00/FD61: 22 F4 C6 15  JSL $15C6F4     ; modify overworld tilemap
00/FD65: 60           RTS 
00/FD66: C9 01        CMP #$01
00/FD68: D0 04        BNE $FD6E
00/FD6A: 20 00 FE     JSR $FE00       ; decompress underground tilemap
00/FD6D: 60           RTS 
00/FD6E: 20 4D FE     JSR $FE4D       ; decompress moon tilemap
00/FD71: 60           RTS 

; [ decompress overworld tilemap ]

00/FD72: A6 3D        LDX $3D
00/FD74: BF 00 80 16  LDA $168000,X
00/FD78: 85 3D        STA $3D
00/FD7A: BF 01 80 16  LDA $168001,X
00/FD7E: 85 3E        STA $3E
00/FD80: A6 3D        LDX $3D
00/FD82: BF 80 84 16  LDA $168480,X
00/FD86: 10 22        BPL $FDAA
00/FD88: 29 7F        AND #$7F
00/FD8A: 48           PHA 
00/FD8B: BF 81 84 16  LDA $168481,X
00/FD8F: A8           TAY 
00/FD90: C8           INY 
00/FD91: 68           PLA 
00/FD92: A6 40        LDX $40
00/FD94: 9F 71 5C 7F  STA $7F5C71,X
00/FD98: E8           INX 
00/FD99: 88           DEY 
00/FD9A: D0 F8        BNE $FD94
00/FD9C: 86 40        STX $40
00/FD9E: 8A           TXA 
00/FD9F: F0 5E        BEQ $FDFF
00/FDA1: A6 3D        LDX $3D
00/FDA3: E8           INX 
00/FDA4: E8           INX 
00/FDA5: 86 3D        STX $3D
00/FDA7: 4C 82 FD     JMP $FD82
00/FDAA: C9 00        CMP #$00
00/FDAC: F0 20        BEQ $FDCE
00/FDAE: C9 10        CMP #$10
00/FDB0: F0 1C        BEQ $FDCE
00/FDB2: C9 20        CMP #$20
00/FDB4: F0 18        BEQ $FDCE
00/FDB6: C9 30        CMP #$30
00/FDB8: F0 14        BEQ $FDCE
00/FDBA: A6 40        LDX $40
00/FDBC: 9F 71 5C 7F  STA $7F5C71,X
00/FDC0: E8           INX 
00/FDC1: 86 40        STX $40
00/FDC3: 8A           TXA 
00/FDC4: F0 39        BEQ $FDFF
00/FDC6: A6 3D        LDX $3D
00/FDC8: E8           INX 
00/FDC9: 86 3D        STX $3D
00/FDCB: 4C 82 FD     JMP $FD82
00/FDCE: A6 40        LDX $40
00/FDD0: 9F 71 5C 7F  STA $7F5C71,X
00/FDD4: E8           INX 
00/FDD5: 4A           LSR 
00/FDD6: 4A           LSR 
00/FDD7: 4A           LSR 
00/FDD8: 85 06        STA $06
00/FDDA: 4A           LSR 
00/FDDB: 18           CLC 
00/FDDC: 65 06        ADC $06
00/FDDE: 18           CLC 
00/FDDF: 69 70        ADC #$70
00/FDE1: 9F 71 5C 7F  STA $7F5C71,X
00/FDE5: E8           INX 
00/FDE6: 1A           INC 
00/FDE7: 9F 71 5C 7F  STA $7F5C71,X
00/FDEB: E8           INX 
00/FDEC: 1A           INC 
00/FDED: 9F 71 5C 7F  STA $7F5C71,X
00/FDF1: E8           INX 
00/FDF2: 86 40        STX $40
00/FDF4: 8A           TXA 
00/FDF5: F0 08        BEQ $FDFF
00/FDF7: A6 3D        LDX $3D
00/FDF9: E8           INX 
00/FDFA: 86 3D        STX $3D
00/FDFC: 4C 82 FD     JMP $FD82
00/FDFF: 60           RTS 

; [ decompress underground tilemap ]

00/FE00: A6 3D        LDX $3D
00/FE02: BF 00 82 16  LDA $168200,X
00/FE06: 85 3D        STA $3D
00/FE08: BF 01 82 16  LDA $168201,X
00/FE0C: 85 3E        STA $3E
00/FE0E: A6 3D        LDX $3D
00/FE10: BF 80 C4 16  LDA $16C480,X
00/FE14: 10 22        BPL $FE38
00/FE16: 29 7F        AND #$7F
00/FE18: 48           PHA 
00/FE19: BF 81 C4 16  LDA $16C481,X
00/FE1D: A8           TAY 
00/FE1E: C8           INY 
00/FE1F: 68           PLA 
00/FE20: A6 40        LDX $40
00/FE22: 9F 71 5C 7F  STA $7F5C71,X
00/FE26: E8           INX 
00/FE27: 88           DEY 
00/FE28: D0 F8        BNE $FE22
00/FE2A: 86 40        STX $40
00/FE2C: 8A           TXA 
00/FE2D: F0 1D        BEQ $FE4C
00/FE2F: A6 3D        LDX $3D
00/FE31: E8           INX 
00/FE32: E8           INX 
00/FE33: 86 3D        STX $3D
00/FE35: 4C 10 FE     JMP $FE10
00/FE38: A6 40        LDX $40
00/FE3A: 9F 71 5C 7F  STA $7F5C71,X
00/FE3E: E8           INX 
00/FE3F: 86 40        STX $40
00/FE41: 8A           TXA 
00/FE42: F0 08        BEQ $FE4C
00/FE44: A6 3D        LDX $3D
00/FE46: E8           INX 
00/FE47: 86 3D        STX $3D
00/FE49: 4C 10 FE     JMP $FE10
00/FE4C: 60           RTS 

; [ decompress moon tilemap ]

00/FE4D: A6 3D        LDX $3D
00/FE4F: BF 00 84 16  LDA $168400,X
00/FE53: 85 3D        STA $3D
00/FE55: BF 01 84 16  LDA $168401,X
00/FE59: 85 3E        STA $3E
00/FE5B: A6 3D        LDX $3D
00/FE5D: BF 80 E1 16  LDA $16E180,X
00/FE61: 10 24        BPL $FE87
00/FE63: 29 7F        AND #$7F
00/FE65: 48           PHA 
00/FE66: BF 81 E1 16  LDA $16E181,X
00/FE6A: A8           TAY 
00/FE6B: C8           INY 
00/FE6C: 68           PLA 
00/FE6D: A6 40        LDX $40
00/FE6F: 9F 71 5C 7F  STA $7F5C71,X
00/FE73: E8           INX 
00/FE74: 88           DEY 
00/FE75: D0 F8        BNE $FE6F
00/FE77: 86 40        STX $40
00/FE79: 8A           TXA 
00/FE7A: C9 40        CMP #$40
00/FE7C: F0 1F        BEQ $FE9D
00/FE7E: A6 3D        LDX $3D
00/FE80: E8           INX 
00/FE81: E8           INX 
00/FE82: 86 3D        STX $3D
00/FE84: 4C 5D FE     JMP $FE5D
00/FE87: A6 40        LDX $40
00/FE89: 9F 71 5C 7F  STA $7F5C71,X
00/FE8D: E8           INX 
00/FE8E: 86 40        STX $40
00/FE90: 8A           TXA 
00/FE91: C9 40        CMP #$40
00/FE93: F0 08        BEQ $FE9D
00/FE95: A6 3D        LDX $3D
00/FE97: E8           INX 
00/FE98: 86 3D        STX $3D
00/FE9A: 4C 5D FE     JMP $FE5D
00/FE9D: A0 40 00     LDY #$0040
00/FEA0: A6 40        LDX $40
00/FEA2: BF 31 5C 7F  LDA $7F5C31,X
00/FEA6: 9F 71 5C 7F  STA $7F5C71,X
00/FEAA: 9F B1 5C 7F  STA $7F5CB1,X
00/FEAE: 9F F1 5C 7F  STA $7F5CF1,X
00/FEB2: E8           INX 
00/FEB3: 88           DEY 
00/FEB4: D0 EC        BNE $FEA2
00/FEB6: 60           RTS 

; world map size masks
00/FEB7: FF FF 3F

; [ decompress bg tilemap ]

00/FEBA: 85 3D        STA $3D
00/FEBC: 64 3E        STZ $3E
00/FEBE: A9 17        LDA #$17        ; bank $17
00/FEC0: 85 06        STA $06
00/FEC2: AD E5 0F     LDA $0FE5       ; tilemap msb
00/FEC5: 29 01        AND #$01
00/FEC7: D0 05        BNE $FECE
00/FEC9: AD 01 17     LDA $1701
00/FECC: F0 02        BEQ $FED0       ; branch if on overworld
00/FECE: E6 3E        INC $3E
00/FED0: 06 3D        ASL $3D
00/FED2: 26 3E        ROL $3E
00/FED4: A6 3D        LDX $3D
00/FED6: BF 00 80 17  LDA $178000,X   ; pointers to sub-map tilemaps
00/FEDA: 85 3D        STA $3D
00/FEDC: BF 01 80 17  LDA $178001,X
00/FEE0: 85 3E        STA $3E
00/FEE2: 10 06        BPL $FEEA
00/FEE4: E6 06        INC $06         ; increment bank
00/FEE6: 29 7F        AND #$7F
00/FEE8: 85 3E        STA $3E
00/FEEA: BF 02 80 17  LDA $178002,X   ; next pointer
00/FEEE: 85 40        STA $40
00/FEF0: BF 03 80 17  LDA $178003,X
00/FEF4: 29 7F        AND #$7F
00/FEF6: 85 41        STA $41
00/FEF8: A6 3D        LDX $3D
00/FEFA: E4 40        CPX $40
00/FEFC: 90 07        BCC $FF05
00/FEFE: A5 41        LDA $41
00/FF00: 18           CLC 
00/FF01: 69 80        ADC #$80
00/FF03: 85 41        STA $41
00/FF05: AD E5 0F     LDA $0FE5       ; sub-map tilemap msb
00/FF08: 29 01        AND #$01
00/FF0A: D0 05        BNE $FF11
00/FF0C: AD 01 17     LDA $1701
00/FF0F: F0 02        BEQ $FF13
00/FF11: E6 06        INC $06
00/FF13: A5 40        LDA $40
00/FF15: 38           SEC 
00/FF16: E5 3D        SBC $3D
00/FF18: 85 40        STA $40
00/FF1A: A5 41        LDA $41
00/FF1C: E5 3E        SBC $3E
00/FF1E: 85 41        STA $41
00/FF20: A4 3D        LDY $3D
00/FF22: A2 00 00     LDX #$0000
00/FF25: A5 06        LDA $06
00/FF27: 48           PHA 
00/FF28: AB           PLB 
00/FF29: B9 00 80     LDA $8000,Y
00/FF2C: 9F 00 44 7F  STA $7F4400,X   ; copy to buffer
00/FF30: E8           INX 
00/FF31: E4 40        CPX $40
00/FF33: F0 12        BEQ $FF47
00/FF35: C8           INY 
00/FF36: C0 00 80     CPY #$8000
00/FF39: D0 EE        BNE $FF29
00/FF3B: A0 00 00     LDY #$0000
00/FF3E: E6 06        INC $06         ; next bank
00/FF40: A5 06        LDA $06
00/FF42: 48           PHA 
00/FF43: AB           PLB 
00/FF44: 4C 29 FF     JMP $FF29
00/FF47: A9 00        LDA #$00
00/FF49: 48           PHA 
00/FF4A: AB           PLB 
00/FF4B: A2 00 00     LDX #$0000
00/FF4E: 86 40        STX $40
00/FF50: 86 3D        STX $3D
00/FF52: BF 00 44 7F  LDA $7F4400,X   ; decode sub-map tilemap
00/FF56: 10 31        BPL $FF89
; rle
00/FF58: 29 7F        AND #$7F
00/FF5A: 48           PHA 
00/FF5B: BF 01 44 7F  LDA $7F4401,X
00/FF5F: A8           TAY 
00/FF60: C8           INY 
00/FF61: 68           PLA 
00/FF62: A6 40        LDX $40
00/FF64: 9F 71 5C 7F  STA $7F5C71,X
00/FF68: E8           INX 
00/FF69: 86 40        STX $40
00/FF6B: 48           PHA 
00/FF6C: 8A           TXA 
00/FF6D: C9 20        CMP #$20
00/FF6F: D0 06        BNE $FF77
00/FF71: E6 41        INC $41
00/FF73: 64 40        STZ $40
00/FF75: A6 40        LDX $40
00/FF77: 68           PLA 
00/FF78: E0 00 20     CPX #$2000
00/FF7B: F0 2D        BEQ $FFAA
00/FF7D: 88           DEY 
00/FF7E: D0 E4        BNE $FF64
00/FF80: A6 3D        LDX $3D
00/FF82: E8           INX 
00/FF83: E8           INX 
00/FF84: 86 3D        STX $3D
00/FF86: 4C 52 FF     JMP $FF52
; raw
00/FF89: A6 40        LDX $40
00/FF8B: 9F 71 5C 7F  STA $7F5C71,X
00/FF8F: E8           INX 
00/FF90: 86 40        STX $40
00/FF92: 8A           TXA 
00/FF93: C9 20        CMP #$20
00/FF95: D0 04        BNE $FF9B
00/FF97: 64 40        STZ $40
00/FF99: E6 41        INC $41
00/FF9B: A6 40        LDX $40
00/FF9D: E0 00 20     CPX #$2000
00/FFA0: F0 08        BEQ $FFAA
00/FFA2: A6 3D        LDX $3D
00/FFA4: E8           INX 
00/FFA5: 86 3D        STX $3D
00/FFA7: 4C 52 FF     JMP $FF52
00/FFAA: 60           RTS 

; [ decode bg1 tilemap ]

00/FFAB: AD F9 06     LDA $06F9       ; bg1 tilemap
00/FFAE: 20 BA FE     JSR $FEBA       ; decode bg tilemap
00/FFB1: 60           RTS 

; [ decode bg2 tilemap ]

00/FFB2: AD E3 0F     LDA $0FE3       ; bg2 tilemap
00/FFB5: 20 BA FE     JSR $FEBA       ; decode bg tilemap
00/FFB8: 60           RTS 

00/FFB9: FF FF FF

00/FFBC: 20 EE 94     JSR $94EE       ; init character properties
00/FFBF: 6B           RTL 

; --------------------------------------------------------------------------

00/FFC0: 46 49 4E 41 4C 20 46 41      ; "FINAL FANTASY 4      "
00/FFC8: 4E 54 41 53 59 20 34 20
00/FFD0: 20 20 20 20 20
00/FFD5: 20                           ; ROM layout: LoROM
00/FFD6: 02                           ; cartridge type: ROM + RAM + SRAM
00/FFD7: 0A                           ; ROM size: 8 MBit
00/FFD8: 03                           ; RAM size: 64 KBit
00/FFD9: 00                           ; country code: North America
00/FFDA: C3                           ; licensee: C3
; *** v1.0 ***
00/FFDB: 00                           ; version 1.0
; *** v1.1 ***
00/FFDB: 01                           ; version 1.1
; ************
00/FFDC: 53E6                         ; checksum
00/FFDE: AC19                         ; checksum inverse

00/FFE0: FFFF
00/FFE2: FFFF
00/FFE4  FFFF
00/FFE6: FFFF
00/FFE8: FFFF
00/FFEA: 0200                         ; nmi vector
00/FFEC: FFFF
00/FFEE: 0204                         ; irq vector
00/FFF0: FFFF
00/FFF2: FFFF
00/FFF4: FFFF
00/FFF6: FFFF
00/FFF8: FFFF
00/FFFA: FFFF
00/FFFC: 8000                         ; reset vector
00/FFFE: FFFF

; --------------------------------------------------------------------------

01/8000: 20 2C 80     JSR $802C       ; main menu
01/8003: 6B           RTL 

01/8004: 20 1A BA     JSR $BA1A       ; namingway menu
01/8007: 6B           RTL 

01/8008: 20 BF C2     JSR $C2BF       ; shop menu
01/800B: 6B           RTL 

01/800C: 20 92 95     JSR $9592       ; game load menu
01/800F: 6B           RTL 

01/8010: 20 5E 80     JSR $805E       ; update controller (field)
01/8013: 6B           RTL 

01/8014: 20 95 CC     JSR $CC95       ; fat chocobo menu
01/8017: 6B           RTL 

01/8018: 20 1A BA     JSR $BA1A       ; namingway menu
01/801B: 6B           RTL 

01/801C: 20 BB 82     JSR $82BB       ; init controller
01/801F: 6B           RTL 

01/8020: 20 92 D7     JSR $D792       ; treasure menu
01/8023: 6B           RTL 

01/8024: 20 95 CC     JSR $CC95       ; fat chocobo menu
01/8027: 6B           RTL 

01/8028: 20 6E 80     JSR $806E       ; update controller (battle)
01/802B: 6B           RTL 

; --------------------------------------------------------------------------

; [ main menu ]

01/802C: 8B           PHB 
01/802D: 0B           PHD 
01/802E: 7B           TDC 
01/802F: 8F 00 41 00  STA $004100     ; *** bug, should be $4200 ***
01/8033: A9 7E        LDA #$7E
01/8035: 48           PHA 
01/8036: AB           PLB 
01/8037: 20 45 80     JSR $8045       ; init main menu
01/803A: A9 80        LDA #$80
01/803C: 8F 00 21 00  STA $002100     ; screen off
01/8040: 7B           TDC 
01/8041: EB           XBA 
01/8042: 2B           PLD 
01/8043: AB           PLB 
01/8044: 60           RTS 

; [ init main menu ]

01/8045: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/8048: 20 7D 8C     JSR $8C7D       ; init menu
01/804B: BA           TSX 
01/804C: CA           DEX 
01/804D: CA           DEX 
01/804E: 8E 65 1A     STX $1A65       ; save stack pointer
01/8051: 20 FB 87     JSR $87FB       ; main menu
01/8054: 20 7E 94     JSR $947E       ; fade out
01/8057: 4C 3F 87     JMP $873F       ; restore dialogue window graphics

; unused
01/805A: 5C 00 80 03  JML $038000     ; battle

; [ update controller (field) ]

01/805E: 48           PHA 
01/805F: A9 00        LDA #$00
01/8061: 8F 40 01 00  STA $000140     ; disable multi-controller update
01/8065: 22 03 FD 14  JSL $14FD03     ; update controller
01/8069: A9 00        LDA #$00
01/806B: EB           XBA 
01/806C: 68           PLA 
01/806D: 60           RTS 

; [ update controller (battle) ]

01/806E: 48           PHA 
01/806F: 22 03 FD 14  JSL $14FD03     ; update controller
01/8073: A9 00        LDA #$00
01/8075: EB           XBA 
01/8076: 68           PLA 
01/8077: 60           RTS 

; [ transfer data to vram ]

;  +$011D: destination address (vram)
; ++$011F: source address
;  +$0122: size

01/8078: 8B           PHB 
01/8079: 7B           TDC 
01/807A: 48           PHA 
01/807B: AB           PLB 
01/807C: A9 80        LDA #$80
01/807E: 8D 15 21     STA $2115
01/8081: 7B           TDC 
01/8082: 8D 0C 42     STA $420C       ; disable hdma
01/8085: AC 1D 01     LDY $011D
01/8088: 8C 16 21     STY $2116       ; destination address (vram)
01/808B: A9 01        LDA #$01
01/808D: 8D 00 43     STA $4300
01/8090: A9 18        LDA #$18
01/8092: 8D 01 43     STA $4301
01/8095: C2 20        REP #$20
01/8097: AD 1F 01     LDA $011F       ; source address
01/809A: 8D 02 43     STA $4302
01/809D: AD 21 01     LDA $0121
01/80A0: 8D 04 43     STA $4304
01/80A3: E2 20        SEP #$20
01/80A5: AD 23 01     LDA $0123
01/80A8: 8D 06 43     STA $4306
01/80AB: A9 01        LDA #$01
01/80AD: 8D 0B 42     STA $420B
01/80B0: AB           PLB 
01/80B1: 60           RTS 

; [ transfer palettes to ppu ]

01/80B2: 0B           PHD 
01/80B3: A2 00 43     LDX #$4300
01/80B6: DA           PHX 
01/80B7: 2B           PLD 
01/80B8: 7B           TDC 
01/80B9: 8F 21 21 00  STA $002121
01/80BD: 85 00        STA $00
01/80BF: A9 22        LDA #$22
01/80C1: 85 01        STA $01
01/80C3: A2 00 A0     LDX #$A000
01/80C6: 86 02        STX $02
01/80C8: A9 7E        LDA #$7E
01/80CA: 85 04        STA $04
01/80CC: A2 00 02     LDX #$0200
01/80CF: 86 05        STX $05
01/80D1: A9 01        LDA #$01
01/80D3: 8F 0B 42 00  STA $00420B
01/80D7: 2B           PLD 
01/80D8: 60           RTS 

; [ draw window ]

; +Y: window data pointer (bank 01)

01/80D9: 5A           PHY 
01/80DA: 8B           PHB 
01/80DB: 4B           PHK 
01/80DC: AB           PLB 
01/80DD: C2 20        REP #$20
01/80DF: B9 00 00     LDA $0000,Y     ; tilemap buffer
01/80E2: 85 2B        STA $2B
01/80E4: B9 02 00     LDA $0002,Y     ; window size
01/80E7: 85 2D        STA $2D
01/80E9: E2 20        SEP #$20
01/80EB: A5 34        LDA $34         ; tile flags
01/80ED: 85 2F        STA $2F
01/80EF: AB           PLB 
01/80F0: 20 F5 80     JSR $80F5       ; draw window tilemap to buffer
01/80F3: 7A           PLY 
01/80F4: 60           RTS 

; [ draw window tilemap to buffer ]

01/80F5: C2 20        REP #$20
01/80F7: A5 29        LDA $29
01/80F9: 18           CLC 
01/80FA: 65 2B        ADC $2B
01/80FC: A8           TAY 
01/80FD: A5 2D        LDA $2D
01/80FF: 85 31        STA $31
01/8101: E2 20        SEP #$20
01/8103: A9 F7        LDA #$F7
01/8105: 20 1C 81     JSR $811C
01/8108: 48           PHA 
01/8109: A5 33        LDA $33
01/810B: F0 02        BEQ $810F
01/810D: 68           PLA 
01/810E: 60           RTS 
01/810F: 68           PLA 
01/8110: 20 52 81     JSR $8152
01/8113: C6 32        DEC $32
01/8115: D0 F9        BNE $8110
01/8117: A9 FC        LDA #$FC
01/8119: 4C 1C 81     JMP $811C
01/811C: 5A           PHY 
01/811D: 85 30        STA $30
01/811F: A5 30        LDA $30
01/8121: 99 00 00     STA $0000,Y
01/8124: C8           INY 
01/8125: A5 2F        LDA $2F
01/8127: 99 00 00     STA $0000,Y
01/812A: C8           INY 
01/812B: A5 2D        LDA $2D
01/812D: 85 31        STA $31
01/812F: E6 30        INC $30
01/8131: A5 30        LDA $30
01/8133: 99 00 00     STA $0000,Y
01/8136: C8           INY 
01/8137: A5 2F        LDA $2F
01/8139: 99 00 00     STA $0000,Y
01/813C: C8           INY 
01/813D: C6 31        DEC $31
01/813F: D0 F0        BNE $8131
01/8141: E6 30        INC $30
01/8143: A5 30        LDA $30
01/8145: 99 00 00     STA $0000,Y
01/8148: C8           INY 
01/8149: A5 2F        LDA $2F
01/814B: 99 00 00     STA $0000,Y
01/814E: 7A           PLY 
01/814F: 4C 8B 87     JMP $878B       ; next row (Y)
01/8152: 5A           PHY 
01/8153: 85 30        STA $30
01/8155: A9 FA        LDA #$FA
01/8157: 99 00 00     STA $0000,Y
01/815A: C8           INY 
01/815B: A5 2F        LDA $2F
01/815D: 99 00 00     STA $0000,Y
01/8160: C8           INY 
01/8161: A5 2D        LDA $2D
01/8163: 85 31        STA $31
01/8165: E6 30        INC $30
01/8167: A9 FF        LDA #$FF
01/8169: 99 00 00     STA $0000,Y
01/816C: C8           INY 
01/816D: A5 2F        LDA $2F
01/816F: 99 00 00     STA $0000,Y
01/8172: C8           INY 
01/8173: C6 31        DEC $31
01/8175: D0 F0        BNE $8167
01/8177: A9 FB        LDA #$FB
01/8179: 99 00 00     STA $0000,Y
01/817C: C8           INY 
01/817D: A5 2F        LDA $2F
01/817F: 99 00 00     STA $0000,Y
01/8182: 7A           PLY 
01/8183: 4C 8B 87     JMP $878B       ; next row (Y)

; [ wait for vblank (far) ]

01/8186: 20 8A 81     JSR $818A       ; wait for vblank
01/8189: 6B           RTL 

; [ wait for vblank ]

01/818A: 48           PHA 
01/818B: EE A3 16     INC $16A3       ; increment game time
01/818E: AD A3 16     LDA $16A3
01/8191: C9 3C        CMP #$3C
01/8193: 90 10        BCC $81A5
01/8195: 9C A3 16     STZ $16A3
01/8198: EE A4 16     INC $16A4
01/819B: D0 08        BNE $81A5
01/819D: EE A5 16     INC $16A5
01/81A0: D0 03        BNE $81A5
01/81A2: EE A6 16     INC $16A6
01/81A5: AF 10 42 00  LDA $004210     ; wait for vblank
01/81A9: 29 80        AND #$80
01/81AB: D0 F8        BNE $81A5
01/81AD: AF 10 42 00  LDA $004210
01/81B1: 29 80        AND #$80
01/81B3: F0 F8        BEQ $81AD
01/81B5: A5 88        LDA $88
01/81B7: 8F 00 21 00  STA $002100     ; set screen brightness
01/81BB: 68           PLA 
01/81BC: 60           RTS 

; [ convert hex to decimal (2 digits) ]

01/81BD: 64 45        STZ $45
01/81BF: 38           SEC 
01/81C0: E9 0A        SBC #$0A
01/81C2: 90 04        BCC $81C8
01/81C4: E6 45        INC $45
01/81C6: 80 F7        BRA $81BF
01/81C8: 69 8A        ADC #$8A
01/81CA: EB           XBA 
01/81CB: A5 45        LDA $45
01/81CD: D0 03        BNE $81D2
01/81CF: A9 FF        LDA #$FF
01/81D1: 60           RTS 
01/81D2: 18           CLC 
01/81D3: 69 80        ADC #$80
01/81D5: 60           RTS 

; [ convert hex to decimal (4 digits) ]

; +A: value to convert
; $5A-$5E: decimal text

01/81D6: DA           PHX 
01/81D7: 5A           PHY 
01/81D8: C2 20        REP #$20
01/81DA: A2 7F 00     LDX #$007F
01/81DD: 86 5A        STX $5A
01/81DF: E6 5A        INC $5A
01/81E1: 38           SEC 
01/81E2: E9 E8 03     SBC #$03E8
01/81E5: 10 F8        BPL $81DF
01/81E7: 18           CLC 
01/81E8: 69 E8 03     ADC #$03E8
01/81EB: 0B           PHD 
01/81EC: A2 00 42     LDX #$4200
01/81EF: DA           PHX 
01/81F0: 2B           PLD 
01/81F1: 85 04        STA $04
01/81F3: E2 20        SEP #$20
01/81F5: A9 64        LDA #$64
01/81F7: 85 06        STA $06
01/81F9: 20 45 82     JSR $8245       ; wait for hardware multiply
01/81FC: A5 14        LDA $14
01/81FE: 18           CLC 
01/81FF: 69 80        ADC #$80
01/8201: 8F 5B 01 00  STA $00015B
01/8205: A5 16        LDA $16
01/8207: 85 04        STA $04
01/8209: 7B           TDC 
01/820A: 85 05        STA $05
01/820C: A9 0A        LDA #$0A
01/820E: 85 06        STA $06
01/8210: 20 45 82     JSR $8245       ; wait for hardware multiply
01/8213: A5 14        LDA $14
01/8215: 18           CLC 
01/8216: 69 80        ADC #$80
01/8218: 8F 5D 01 00  STA $00015D
01/821C: A5 16        LDA $16
01/821E: 2B           PLD 
01/821F: 18           CLC 
01/8220: 69 80        ADC #$80
01/8222: 85 5E        STA $5E
01/8224: A5 5A        LDA $5A
01/8226: C9 80        CMP #$80
01/8228: D0 18        BNE $8242
01/822A: A9 FF        LDA #$FF
01/822C: 85 5A        STA $5A
01/822E: A5 5B        LDA $5B
01/8230: C9 80        CMP #$80
01/8232: D0 0E        BNE $8242
01/8234: A9 FF        LDA #$FF
01/8236: 85 5B        STA $5B
01/8238: A5 5D        LDA $5D
01/823A: C9 80        CMP #$80
01/823C: D0 04        BNE $8242
01/823E: A9 FF        LDA #$FF
01/8240: 85 5D        STA $5D
01/8242: 7A           PLY 
01/8243: FA           PLX 
01/8244: 60           RTS 

; [ wait for hardware multiply ]

01/8245: EA           NOP 
01/8246: EA           NOP 
01/8247: EA           NOP 
01/8248: EA           NOP 
01/8249: EA           NOP 
01/824A: EA           NOP 
01/824B: 60           RTS 

; [ transfer sprite data to ppu ]

01/824C: 20 8A 81     JSR $818A       ; wait for vblank
01/824F: DA           PHX 
01/8250: 0B           PHD 
01/8251: A2 00 43     LDX #$4300
01/8254: DA           PHX 
01/8255: 2B           PLD 
01/8256: 7B           TDC 
01/8257: 8F 02 21 00  STA $002102
01/825B: 8F 03 21 00  STA $002103
01/825F: 85 00        STA $00
01/8261: A9 04        LDA #$04
01/8263: 85 01        STA $01
01/8265: A2 00 03     LDX #$0300
01/8268: 86 02        STX $02
01/826A: A9 00        LDA #$00
01/826C: 85 04        STA $04
01/826E: A2 20 02     LDX #$0220
01/8271: 86 05        STX $05
01/8273: A9 01        LDA #$01
01/8275: 8F 0B 42 00  STA $00420B
01/8279: 2B           PLD 
01/827A: FA           PLX 
01/827B: 60           RTS 

; [ draw cursor sprite ]

; $3F: --oo---- sprite priority
; $45: x position
; $46: y position

; cursor 2
01/827C: A0 10 03     LDY #$0310
01/827F: 80 03        BRA $8284
; cursor 1
01/8281: A0 00 03     LDY #$0300
; +Y: pointer to sprite data
01/8284: A6 45        LDX $45
01/8286: A9 0A        LDA #$0A
01/8288: 8B           PHB 
01/8289: 48           PHA 
01/828A: A9 7E        LDA #$7E
01/828C: 48           PHA 
01/828D: AB           PLB 
01/828E: 68           PLA 
01/828F: 99 02 00     STA $0002,Y
01/8292: C2 20        REP #$20
01/8294: 8A           TXA 
01/8295: E2 20        SEP #$20
01/8297: 99 00 00     STA $0000,Y
01/829A: EB           XBA 
01/829B: 99 01 00     STA $0001,Y
01/829E: A5 3F        LDA $3F
01/82A0: 99 03 00     STA $0003,Y
01/82A3: AB           PLB 
01/82A4: 60           RTS 

; [  ]

01/82A5: A5 01        LDA $01
01/82A7: 29 03        AND #$03
01/82A9: D0 09        BNE $82B4
01/82AB: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/82AE: A5 03        LDA $03
01/82B0: 85 01        STA $01
01/82B2: 18           CLC 
01/82B3: 60           RTS 
01/82B4: 38           SEC 
01/82B5: 60           RTS 

; [ update controller ]

01/82B6: 22 03 FD 14  JSL $14FD03     ; update controller
01/82BA: 60           RTS 

; [ init controller ]

01/82BB: 22 00 FD 14  JSL $14FD00     ; init controller
01/82BF: 60           RTS 

; [ update controller (w/ sound effect) ]

01/82C0: 20 B6 82     JSR $82B6       ; update controller
01/82C3: A5 00        LDA $00
01/82C5: 05 01        ORA $01
01/82C7: F0 03        BEQ $82CC
01/82C9: 20 4E 87     JSR $874E       ; cursor sound effect
01/82CC: 60           RTS 

; [ draw text ]

; +X: destination offset
; +Y: source address (bank 01)

01/82CD: 8B           PHB 
01/82CE: 0B           PHD 
01/82CF: DA           PHX 
01/82D0: DA           PHX 
01/82D1: A2 00 01     LDX #$0100
01/82D4: DA           PHX 
01/82D5: 2B           PLD 
01/82D6: FA           PLX 
01/82D7: 4B           PHK 
01/82D8: AB           PLB 
01/82D9: C2 20        REP #$20
01/82DB: 8A           TXA 
01/82DC: 18           CLC 
01/82DD: 65 29        ADC $29
01/82DF: AA           TAX 
01/82E0: E2 20        SEP #$20
01/82E2: 80 34        BRA $8318

; [ draw text (any bank) ]

; +X: destination offset
; +Y: source address
;  A: source bank

01/82E4: 8B           PHB 
01/82E5: 0B           PHD 
01/82E6: DA           PHX 
01/82E7: DA           PHX 
01/82E8: A2 00 01     LDX #$0100
01/82EB: DA           PHX 
01/82EC: 2B           PLD 
01/82ED: FA           PLX 
01/82EE: 48           PHA 
01/82EF: AB           PLB 
01/82F0: C2 20        REP #$20
01/82F2: 8A           TXA 
01/82F3: 18           CLC 
01/82F4: 65 29        ADC $29
01/82F6: AA           TAX 
01/82F7: E2 20        SEP #$20
01/82F9: 80 1D        BRA $8318

; [ draw window and text ]

01/82FB: 20 D9 80     JSR $80D9       ; draw window
01/82FE: 20 BD 87     JSR $87BD       ; iny4
; fallthrough

; [ draw positioned text ]

; +Y: source address

01/8301: 8B           PHB 
01/8302: 0B           PHD 
01/8303: DA           PHX 
01/8304: A2 00 01     LDX #$0100
01/8307: DA           PHX 
01/8308: 2B           PLD 
01/8309: 4B           PHK 
01/830A: AB           PLB 
01/830B: C2 20        REP #$20
01/830D: B9 00 00     LDA $0000,Y
01/8310: 18           CLC 
01/8311: 65 29        ADC $29
01/8313: AA           TAX 
01/8314: E2 20        SEP #$20
01/8316: C8           INY 
01/8317: C8           INY 
01/8318: B9 00 00     LDA $0000,Y
01/831B: F0 15        BEQ $8332       ; branch if terminator
01/831D: C8           INY 
01/831E: C9 01        CMP #$01
01/8320: F0 E9        BEQ $830B       ; branch if newline
01/8322: 20 32 8E     JSR $8E32       ; get dakuten
01/8325: 9F 00 00 7E  STA $7E0000,X   ; dakuten
01/8329: EB           XBA 
01/832A: 9F 40 00 7E  STA $7E0040,X   ; kana
01/832E: E8           INX 
01/832F: E8           INX 
01/8330: 80 E6        BRA $8318
01/8332: FA           PLX 
01/8333: 2B           PLD 
01/8334: AB           PLB 
01/8335: 60           RTS 

; [ wait for keypress ]

01/8336: 48           PHA 
01/8337: DA           PHX 
01/8338: 5A           PHY 
01/8339: 8B           PHB 
01/833A: 20 8A 81     JSR $818A       ; wait for vblank
01/833D: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/8340: A5 00        LDA $00
01/8342: 05 01        ORA $01
01/8344: F0 F4        BEQ $833A
01/8346: AB           PLB 
01/8347: 7A           PLY 
01/8348: FA           PLX 
01/8349: 68           PLA 
01/834A: 60           RTS 

; [ do jump table ]

;  A: index
; +X: jump table address

01/834B: 85 1D        STA $1D
01/834D: 64 1E        STZ $1E
01/834F: 4B           PHK 
01/8350: 68           PLA 
01/8351: 8D 1F 01     STA $011F
01/8354: C2 20        REP #$20
01/8356: A5 1D        LDA $1D
01/8358: 86 1D        STX $1D
01/835A: 0A           ASL 
01/835B: 65 1D        ADC $1D
01/835D: 85 1D        STA $1D
01/835F: A7 1D        LDA [$1D]
01/8361: 8D 20 01     STA $0120
01/8364: E2 20        SEP #$20
01/8366: 6C 20 01     JMP ($0120)

; [ draw 2-digit number ]

01/8369: 20 BD 81     JSR $81BD       ; convert hex to decimal (2 digits)
01/836C: C2 20        REP #$20
01/836E: 48           PHA 
01/836F: 98           TYA 
01/8370: 18           CLC 
01/8371: 65 29        ADC $29
01/8373: A8           TAY 
01/8374: 68           PLA 
01/8375: E2 20        SEP #$20
01/8377: 99 00 00     STA $0000,Y
01/837A: EB           XBA 
01/837B: 99 02 00     STA $0002,Y
01/837E: 60           RTS 

; [ draw 4-digit number ]

01/837F: EB           XBA 
01/8380: A9 00        LDA #$00
01/8382: EB           XBA 
01/8383: 08           PHP 
01/8384: DA           PHX 
01/8385: E2 20        SEP #$20
01/8387: 5A           PHY 
01/8388: 20 D6 81     JSR $81D6       ; convert hex to decimal (4 digits)
01/838B: C2 20        REP #$20
01/838D: 68           PLA 
01/838E: 18           CLC 
01/838F: 65 29        ADC $29
01/8391: A8           TAY 
01/8392: E2 20        SEP #$20
01/8394: A5 5A        LDA $5A
01/8396: 99 00 00     STA $0000,Y
01/8399: A5 5B        LDA $5B
01/839B: 99 02 00     STA $0002,Y
01/839E: A5 5D        LDA $5D
01/83A0: 99 04 00     STA $0004,Y
01/83A3: A5 5E        LDA $5E
01/83A5: 99 06 00     STA $0006,Y
01/83A8: FA           PLX 
01/83A9: 28           PLP 
01/83AA: 60           RTS 

; [ draw character name ]

01/83AB: 29 3F        AND #$3F
01/83AD: D0 01        BNE $83B0
01/83AF: 60           RTS 
01/83B0: 3A           DEC 
01/83B1: 20 B4 87     JSR $87B4       ; tax
01/83B4: BF 57 84 01  LDA $018457,X   ; name for each character
01/83B8: 0A           ASL 
01/83B9: 85 45        STA $45
01/83BB: 0A           ASL 
01/83BC: 65 45        ADC $45
01/83BE: 20 B4 87     JSR $87B4       ; tax
01/83C1: C2 20        REP #$20
01/83C3: 98           TYA 
01/83C4: 18           CLC 
01/83C5: 65 29        ADC $29
01/83C7: A8           TAY 
01/83C8: E2 20        SEP #$20
01/83CA: A9 06        LDA #$06
01/83CC: 85 45        STA $45
01/83CE: BD 00 15     LDA $1500,X     ; character names
01/83D1: E8           INX 
01/83D2: 20 32 8E     JSR $8E32       ; get dakuten
01/83D5: 99 00 00     STA $0000,Y     ; dakuten
01/83D8: EB           XBA 
01/83D9: 99 40 00     STA $0040,Y     ; kana
01/83DC: C8           INY 
01/83DD: C8           INY 
01/83DE: C6 45        DEC $45
01/83E0: D0 EC        BNE $83CE
01/83E2: 60           RTS 

; [ open window ]

01/83E3: A9 19        LDA #$19
01/83E5: 85 45        STA $45
01/83E7: A6 35        LDX $35
01/83E9: 86 1D        STX $1D         ; destination address (vram)
01/83EB: A6 29        LDX $29
01/83ED: 86 1F        STX $1F         ; source address
01/83EF: A9 7E        LDA #$7E
01/83F1: 85 21        STA $21
01/83F3: A2 80 00     LDX #$0080      ; size
01/83F6: 86 22        STX $22
01/83F8: 20 8A 81     JSR $818A       ; wait for vblank
01/83FB: 20 78 80     JSR $8078       ; transfer data to vram
01/83FE: C2 20        REP #$20
01/8400: A5 1D        LDA $1D
01/8402: 18           CLC 
01/8403: 69 40 00     ADC #$0040
01/8406: 85 1D        STA $1D
01/8408: A5 1F        LDA $1F
01/840A: 18           CLC 
01/840B: 69 80 00     ADC #$0080
01/840E: 85 1F        STA $1F
01/8410: E2 20        SEP #$20
01/8412: C6 45        DEC $45
01/8414: D0 E2        BNE $83F8
01/8416: 60           RTS 

; [ close window ]

01/8417: A9 19        LDA #$19
01/8419: 85 45        STA $45
01/841B: C2 20        REP #$20
01/841D: A5 35        LDA $35
01/841F: 18           CLC 
01/8420: 69 00 06     ADC #$0600
01/8423: 85 1D        STA $1D         ; destination address (vram)
01/8425: A5 29        LDA $29
01/8427: 18           CLC 
01/8428: 69 00 0C     ADC #$0C00
01/842B: 85 1F        STA $1F         ; source address
01/842D: E2 20        SEP #$20
01/842F: A9 7E        LDA #$7E
01/8431: 85 21        STA $21
01/8433: A2 80 00     LDX #$0080
01/8436: 86 22        STX $22         ; size
; start of frame loop
01/8438: 20 8A 81     JSR $818A       ; wait for vblank
01/843B: 20 78 80     JSR $8078       ; transfer data to vram
01/843E: C2 20        REP #$20
01/8440: A5 1D        LDA $1D
01/8442: 38           SEC 
01/8443: E9 40 00     SBC #$0040      ; next row (move up)
01/8446: 85 1D        STA $1D
01/8448: A5 1F        LDA $1F
01/844A: 38           SEC 
01/844B: E9 80 00     SBC #$0080
01/844E: 85 1F        STA $1F
01/8450: E2 20        SEP #$20
01/8452: C6 45        DEC $45
01/8454: D0 E2        BNE $8438
01/8456: 60           RTS 

; name for each character (see 16/FB3F for battle)
01/8457: 00 01 02 03 04 05 06 07 08 03 00 03 06 09 01 05
01/8467: 02 0A 0B 01 0C 0D

; [ select bg3 ]

; select and clear
01/846D: 20 45 8D     JSR $8D45       ; clear bg3 screen buffer
; select only
01/8470: 48           PHA 
01/8471: DA           PHX 
01/8472: A2 00 D6     LDX #$D600      ; bg3 screen buffer
01/8475: 86 29        STX $29
01/8477: A2 00 70     LDX #$7000      ; bg3 tilemap (vram)
01/847A: 86 35        STX $35
01/847C: A9 03        LDA #$03
01/847E: 85 C3        STA $C3
01/8480: 64 34        STZ $34         ; low priority
01/8482: FA           PLX 
01/8483: 68           PLA 
01/8484: 60           RTS 

; [ select bg4 ]

; select and clear
01/8485: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
; select only
01/8488: 48           PHA 
01/8489: DA           PHX 
01/848A: A2 00 C6     LDX #$C600      ; bg4 screen buffer
01/848D: 86 29        STX $29
01/848F: A2 00 78     LDX #$7800      ; bg4 tilemap (vram)
01/8492: 86 35        STX $35
01/8494: A9 02        LDA #$02
01/8496: 85 C3        STA $C3
01/8498: A9 20        LDA #$20
01/849A: 85 34        STA $34         ; high priority
01/849C: FA           PLX 
01/849D: 68           PLA 
01/849E: 60           RTS 

; [ select bg1 ]

; select and clear
01/849F: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
; select only
01/84A2: 48           PHA 
01/84A3: DA           PHX 
01/84A4: A2 00 B6     LDX #$B600      ; bg1 screen buffer
01/84A7: 86 29        STX $29
01/84A9: A2 00 60     LDX #$6000      ; bg1 tilemap (vram)
01/84AC: 86 35        STX $35
01/84AE: A9 01        LDA #$01
01/84B0: 85 C3        STA $C3
01/84B2: 64 34        STZ $34         ; low priority
01/84B4: FA           PLX 
01/84B5: 68           PLA 
01/84B6: 60           RTS 

; [ select bg2 ]

; select and clear
01/84B7: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
; select only
01/84BA: 48           PHA 
01/84BB: DA           PHX 
01/84BC: A2 00 A6     LDX #$A600      ; bg2 screen buffer
01/84BF: 86 29        STX $29
01/84C1: A2 00 68     LDX #$6800      ; bg2 tilemap (vram)
01/84C4: 86 35        STX $35
01/84C6: 7B           TDC 
01/84C7: 85 C3        STA $C3
01/84C9: A9 20        LDA #$20
01/84CB: 85 34        STA $34         ; high priority
01/84CD: FA           PLX 
01/84CE: 68           PLA 
01/84CF: 60           RTS 

; [ transform window ]

; +Y: pointer to current window data (bank 01)
; +X: pointer to new window data (bank 01)

; $63 window left position (current)
; $64 window top position (current)
; $65 window right position (current)
; $66 window bottom position (current)
; $67 window left position (target)
; $68 window top position (target)
; $69 window right position (target)
; $6A window bottom position (target)

01/84D0: 8B           PHB 
01/84D1: 4B           PHK 
01/84D2: AB           PLB 
01/84D3: B9 00 00     LDA $0000,Y
01/84D6: 29 3F        AND #$3F
01/84D8: 4A           LSR 
01/84D9: 85 63        STA $63
01/84DB: B9 02 00     LDA $0002,Y
01/84DE: 18           CLC 
01/84DF: 65 63        ADC $63
01/84E1: 1A           INC 
01/84E2: 85 65        STA $65
01/84E4: C2 20        REP #$20
01/84E6: B9 00 00     LDA $0000,Y
01/84E9: 4A           LSR 
01/84EA: 4A           LSR 
01/84EB: 4A           LSR 
01/84EC: 4A           LSR 
01/84ED: 4A           LSR 
01/84EE: 4A           LSR 
01/84EF: E2 20        SEP #$20
01/84F1: 85 64        STA $64
01/84F3: B9 03 00     LDA $0003,Y
01/84F6: 18           CLC 
01/84F7: 65 64        ADC $64
01/84F9: 1A           INC 
01/84FA: 85 66        STA $66
01/84FC: BD 00 00     LDA $0000,X
01/84FF: 29 3F        AND #$3F
01/8501: 4A           LSR 
01/8502: 85 67        STA $67
01/8504: BD 02 00     LDA $0002,X
01/8507: 18           CLC 
01/8508: 65 67        ADC $67
01/850A: 1A           INC 
01/850B: 85 69        STA $69
01/850D: C2 20        REP #$20
01/850F: BD 00 00     LDA $0000,X
01/8512: 4A           LSR 
01/8513: 4A           LSR 
01/8514: 4A           LSR 
01/8515: 4A           LSR 
01/8516: 4A           LSR 
01/8517: 4A           LSR 
01/8518: E2 20        SEP #$20
01/851A: 85 68        STA $68
01/851C: BD 03 00     LDA $0003,X
01/851F: 18           CLC 
01/8520: 65 68        ADC $68
01/8522: 1A           INC 
01/8523: 85 6A        STA $6A
01/8525: AB           PLB 
; start of frame loop
01/8526: A5 64        LDA $64
01/8528: C5 68        CMP $68
01/852A: F0 03        BEQ $852F
01/852C: 20 C0 85     JSR $85C0       ; change top of window
01/852F: A5 66        LDA $66
01/8531: C5 6A        CMP $6A
01/8533: F0 03        BEQ $8538
01/8535: 20 D2 85     JSR $85D2       ; change bottom of window
01/8538: A5 63        LDA $63
01/853A: C5 67        CMP $67
01/853C: F0 03        BEQ $8541
01/853E: 20 E4 85     JSR $85E4       ; change left side of window
01/8541: A5 65        LDA $65
01/8543: C5 69        CMP $69
01/8545: F0 03        BEQ $854A
01/8547: 20 F6 85     JSR $85F6       ; change right side of window
01/854A: A5 C2        LDA $C2
01/854C: F0 10        BEQ $855E       ; branch if done scrolling
01/854E: C6 C2        DEC $C2
01/8550: A0 08 00     LDY #$0008      ; loop over 4 bgs, h-scroll and v-scroll
01/8553: A6 41        LDX $41         ; zero
01/8555: 20 8D 85     JSR $858D       ; update bg scroll position
01/8558: E8           INX 
01/8559: E8           INX 
01/855A: E8           INX 
01/855B: 88           DEY 
01/855C: D0 F7        BNE $8555
01/855E: 20 CF 01     JSR $01CF       ; draw sprites
01/8561: 20 8A 81     JSR $818A       ; wait for vblank
01/8564: A5 C3        LDA $C3         ; menu window bg index
01/8566: A2 B8 85     LDX #$85B8      ; jump table to transfer screen buffer to vram
01/8569: 20 4B 83     JSR $834B       ; do jump table
01/856C: 20 CC 01     JSR $01CC       ; clear sprite data
01/856F: 20 A4 94     JSR $94A4
01/8572: A6 63        LDX $63
01/8574: E4 67        CPX $67
01/8576: D0 AE        BNE $8526       ; branch if left/top position doesn't match
01/8578: A6 65        LDX $65
01/857A: E4 69        CPX $69
01/857C: D0 A8        BNE $8526       ; branch if right/bottom position doesn't match
01/857E: AD C2 01     LDA $01C2
01/8581: D0 A3        BNE $8526       ; branch if not done scrolling
01/8583: A2 8C 85     LDX #$858C
01/8586: 8E CD 01     STX $01CD
01/8589: 8E D0 01     STX $01D0
01/858C: 60           RTS 

; [ update bg scroll position ]

01/858D: B5 A2        LDA $A2,X
01/858F: 10 17        BPL $85A8       ; branch if positive scroll rate
01/8591: C2 20        REP #$20
01/8593: B5 A1        LDA $A1,X
01/8595: 29 FF 7F     AND #$7FFF
01/8598: 85 1D        STA $1D
01/859A: B5 89        LDA $89,X
01/859C: 38           SEC 
01/859D: E5 1D        SBC $1D
01/859F: 95 89        STA $89,X
01/85A1: E2 20        SEP #$20
01/85A3: B0 02        BCS $85A7
01/85A5: D6 8B        DEC $8B,X
01/85A7: 60           RTS 
01/85A8: C2 20        REP #$20
01/85AA: B5 89        LDA $89,X
01/85AC: 18           CLC 
01/85AD: 75 A1        ADC $A1,X
01/85AF: 95 89        STA $89,X
01/85B1: E2 20        SEP #$20
01/85B3: 90 02        BCC $85B7
01/85B5: F6 8B        INC $8B,X
01/85B7: 60           RTS 

; jump table to transfer screen buffer to vram
01/85B8: 9423 9430 943D 944A

; [ change top of window ]

01/85C0: 90 08        BCC $85CA
01/85C2: 20 37 86     JSR $8637       ; draw window row (middle)
01/85C5: C6 64        DEC $64
01/85C7: 4C 75 86     JMP $8675       ; draw window row (top)
01/85CA: 20 5F 86     JSR $865F       ; hide window row
01/85CD: E6 64        INC $64
01/85CF: 4C 75 86     JMP $8675       ; draw window row (top)

; [ change bottom of window ]

01/85D2: 90 08        BCC $85DC
01/85D4: 20 5A 86     JSR $865A       ; hide window row
01/85D7: C6 66        DEC $66
01/85D9: 4C 98 86     JMP $8698       ; draw window row (bottom)
01/85DC: 20 32 86     JSR $8632       ; draw window row (middle)
01/85DF: E6 66        INC $66
01/85E1: 4C 98 86     JMP $8698       ; draw window row (bottom)

; [ change left side of window ]

01/85E4: 90 08        BCC $85EE
01/85E6: 20 BB 86     JSR $86BB       ; draw window column (middle)
01/85E9: C6 63        DEC $63
01/85EB: 4C C9 86     JMP $86C9       ; draw window column (left)
01/85EE: 20 22 87     JSR $8722       ; hide window column
01/85F1: E6 63        INC $63
01/85F3: 4C C9 86     JMP $86C9       ; draw window column (left)

; [ change right side of window ]

01/85F6: 90 08        BCC $8600
01/85F8: 20 1D 87     JSR $871D       ; hide window column
01/85FB: C6 65        DEC $65
01/85FD: 4C D7 86     JMP $86D7       ; draw window column (rght)
01/8600: 20 E5 86     JSR $86E5       ; draw window column (middle)
01/8603: E6 65        INC $65
01/8605: 4C D7 86     JMP $86D7       ; draw window column (right)

; [ get pointer to window tilemap buffer ]

; top left corner
01/8608: A5 63        LDA $63
01/860A: 0A           ASL 
01/860B: 85 43        STA $43
01/860D: A5 64        LDA $64
01/860F: 80 10        BRA $8621
; bottom left corner
01/8611: A5 63        LDA $63
01/8613: 0A           ASL 
01/8614: 85 43        STA $43
01/8616: A5 66        LDA $66
01/8618: 80 07        BRA $8621
; top right corner
01/861A: A5 65        LDA $65
01/861C: 0A           ASL 
01/861D: 85 43        STA $43
01/861F: A5 64        LDA $64
01/8621: EB           XBA 
01/8622: A9 00        LDA #$00
01/8624: C2 20        REP #$20
01/8626: 4A           LSR 
01/8627: 4A           LSR 
01/8628: 18           CLC 
01/8629: 65 43        ADC $43
01/862B: 18           CLC 
01/862C: 65 29        ADC $29         ; add tilemap offset
01/862E: AA           TAX 
01/862F: E2 20        SEP #$20
01/8631: 60           RTS 

; [ draw window row (middle) ]

01/8632: 20 11 86     JSR $8611
01/8635: 80 03        BRA $863A
01/8637: 20 08 86     JSR $8608
01/863A: A5 65        LDA $65
01/863C: 38           SEC 
01/863D: E5 63        SBC $63
01/863F: 3A           DEC 
01/8640: 85 1D        STA $1D
01/8642: A9 FA        LDA #$FA        ; left side border
01/8644: 9D 00 00     STA $0000,X
01/8647: E8           INX 
01/8648: E8           INX 
01/8649: A9 FF        LDA #$FF        ; blank window
01/864B: 9D 00 00     STA $0000,X
01/864E: E8           INX 
01/864F: E8           INX 
01/8650: C6 1D        DEC $1D
01/8652: D0 F7        BNE $864B
01/8654: A9 FB        LDA #$FB        ; right side border
01/8656: 9D 00 00     STA $0000,X
01/8659: 60           RTS 

; [ hide window row ]

01/865A: 20 11 86     JSR $8611
01/865D: 80 03        BRA $8662
01/865F: 20 08 86     JSR $8608
01/8662: A5 65        LDA $65
01/8664: 38           SEC 
01/8665: E5 63        SBC $63
01/8667: 1A           INC 
01/8668: 85 1D        STA $1D
01/866A: 7B           TDC             ; hide tile (black)
01/866B: 9D 00 00     STA $0000,X
01/866E: E8           INX 
01/866F: E8           INX 
01/8670: C6 1D        DEC $1D
01/8672: D0 F7        BNE $866B
01/8674: 60           RTS 

; [ draw window row (top) ]

01/8675: 20 08 86     JSR $8608
01/8678: A5 65        LDA $65
01/867A: 38           SEC 
01/867B: E5 63        SBC $63
01/867D: 3A           DEC 
01/867E: 85 1D        STA $1D
01/8680: A9 F7        LDA #$F7        ; top left
01/8682: 9D 00 00     STA $0000,X
01/8685: E8           INX 
01/8686: E8           INX 
01/8687: A9 F8        LDA #$F8        ; top middle
01/8689: 9D 00 00     STA $0000,X
01/868C: E8           INX 
01/868D: E8           INX 
01/868E: C6 1D        DEC $1D
01/8690: D0 F7        BNE $8689
01/8692: A9 F9        LDA #$F9        ; top right
01/8694: 9D 00 00     STA $0000,X
01/8697: 60           RTS 

; [ draw window row (bottom) ]

01/8698: 20 11 86     JSR $8611
01/869B: A5 65        LDA $65
01/869D: 38           SEC 
01/869E: E5 63        SBC $63
01/86A0: 3A           DEC 
01/86A1: 85 1D        STA $1D
01/86A3: A9 FC        LDA #$FC        ; bottom left border
01/86A5: 9D 00 00     STA $0000,X
01/86A8: E8           INX 
01/86A9: E8           INX 
01/86AA: A9 FD        LDA #$FD        ; bottom border
01/86AC: 9D 00 00     STA $0000,X
01/86AF: E8           INX 
01/86B0: E8           INX 
01/86B1: C6 1D        DEC $1D
01/86B3: D0 F7        BNE $86AC
01/86B5: A9 FE        LDA #$FE        ; bottom right border
01/86B7: 9D 00 00     STA $0000,X
01/86BA: 60           RTS 

; [ draw window column ]

; middle column (left side)
01/86BB: A9 F8        LDA #$F8        ; top
01/86BD: 85 1E        STA $1E
01/86BF: A9 FF        LDA #$FF        ; empty window
01/86C1: 85 1F        STA $1F
01/86C3: A9 FD        LDA #$FD        ; bottom
01/86C5: 85 20        STA $20
01/86C7: 80 2F        BRA $86F8
; left column
01/86C9: A9 F7        LDA #$F7        ; top left
01/86CB: 85 1E        STA $1E
01/86CD: A9 FA        LDA #$FA        ; left
01/86CF: 85 1F        STA $1F
01/86D1: A9 FC        LDA #$FC        ; bottom left
01/86D3: 85 20        STA $20
01/86D5: 80 21        BRA $86F8
; right column
01/86D7: A9 F9        LDA #$F9
01/86D9: 85 1E        STA $1E
01/86DB: A9 FB        LDA #$FB
01/86DD: 85 1F        STA $1F
01/86DF: A9 FE        LDA #$FE
01/86E1: 85 20        STA $20
01/86E3: 80 0E        BRA $86F3
; middle column (right side)
01/86E5: A9 F8        LDA #$F8
01/86E7: 85 1E        STA $1E
01/86E9: A9 FF        LDA #$FF
01/86EB: 85 1F        STA $1F
01/86ED: A9 FD        LDA #$FD
01/86EF: 85 20        STA $20
01/86F1: 80 00        BRA $86F3
01/86F3: 20 1A 86     JSR $861A
01/86F6: 80 03        BRA $86FB
01/86F8: 20 08 86     JSR $8608
01/86FB: A5 66        LDA $66
01/86FD: 38           SEC 
01/86FE: E5 64        SBC $64
01/8700: 3A           DEC 
01/8701: 85 1D        STA $1D
01/8703: A5 1E        LDA $1E
01/8705: 9D 00 00     STA $0000,X     ; top tile
01/8708: 20 7E 87     JSR $877E       ; next row (X)
01/870B: A5 1F        LDA $1F
01/870D: 9D 00 00     STA $0000,X     ; middle tiles
01/8710: 20 7E 87     JSR $877E       ; next row (X)
01/8713: C6 1D        DEC $1D
01/8715: D0 F4        BNE $870B
01/8717: A5 20        LDA $20
01/8719: 9D 00 00     STA $0000,X     ; bottom tile
01/871C: 60           RTS 

; [ hide window column ]

01/871D: 20 1A 86     JSR $861A
01/8720: 80 03        BRA $8725
01/8722: 20 08 86     JSR $8608
01/8725: A5 66        LDA $66
01/8727: 38           SEC 
01/8728: E5 64        SBC $64
01/872A: 1A           INC 
01/872B: 85 1D        STA $1D
01/872D: A9 00        LDA #$00
01/872F: 9D 00 00     STA $0000,X
01/8732: 20 7E 87     JSR $877E       ; next row (X)
01/8735: C6 1D        DEC $1D
01/8737: D0 F4        BNE $872D
01/8739: 60           RTS 

; [ save dialogue window graphics ]

01/873A: 22 0F FD 14  JSL $14FD0F     ; save dialogue window graphics
01/873E: 60           RTS 

; [ restore dialogue window graphics ]

01/873F: 8B           PHB 
01/8740: 22 D6 FF 14  JSL $14FFD6     ; restore dialogue window graphics
01/8744: 20 78 80     JSR $8078       ; transfer data to vram
01/8747: AB           PLB 
01/8748: 60           RTS 

; [ update window color ]

01/8749: 22 09 FD 14  JSL $14FD09     ; update window color
01/874D: 60           RTS 

; [ cursor sound effect ]

01/874E: A9 11        LDA #$11        ; system sound effect $11
01/8750: 8D 00 1E     STA $1E00
01/8753: 22 04 80 04  JSL $048004     ; execute sound command
01/8757: 60           RTS 

; [ error sound effect ]

01/8758: A9 12        LDA #$12        ; system sound effect $12
01/875A: 80 F4        BRA $8750

; [ play sound effect (far) ]

01/875C: 20 62 87     JSR $8762       ; play sound effect
01/875F: 6B           RTL 

; [ cure sound effect ]

01/8760: A9 58        LDA #$58
; fallthrough

; [ play sound effect ]

01/8762: 8D 01 1E     STA $1E01
01/8765: A9 02        LDA #$02
01/8767: 8D 00 1E     STA $1E00
01/876A: A9 80        LDA #$80
01/876C: 8D 02 1E     STA $1E02
01/876F: A9 FF        LDA #$FF
01/8771: 8D 03 1E     STA $1E03
01/8774: 22 04 80 04  JSL $048004     ; execute sound command
01/8778: 60           RTS 

; [ clear text ]

01/8779: 22 06 FD 14  JSL $14FD06     ; clear text
01/877D: 60           RTS 

; [ next row (X) ]

01/877E: C2 20        REP #$20
01/8780: 48           PHA 
01/8781: 8A           TXA 
01/8782: 18           CLC 
01/8783: 69 40 00     ADC #$0040      ; skip 32 tiles (1 row of tilemap)
01/8786: AA           TAX 
01/8787: 68           PLA 
01/8788: E2 20        SEP #$20
01/878A: 60           RTS 

; [ next row (Y) ]

01/878B: C2 20        REP #$20
01/878D: 48           PHA 
01/878E: 98           TYA 
01/878F: 18           CLC 
01/8790: 69 40 00     ADC #$0040
01/8793: A8           TAY 
01/8794: 68           PLA 
01/8795: E2 20        SEP #$20
01/8797: 60           RTS 

; [ copy text to screen buffer ]

;  +Y: source address (bank 01)
;  +X: destination address (bank 7E)
; $29: destination offset

01/8798: 8B           PHB 
01/8799: 4B           PHK 
01/879A: AB           PLB 
01/879B: C2 20        REP #$20
01/879D: 8A           TXA 
01/879E: 18           CLC 
01/879F: 65 29        ADC $29
01/87A1: AA           TAX 
01/87A2: E2 20        SEP #$20
01/87A4: B9 00 00     LDA $0000,Y
01/87A7: F0 09        BEQ $87B2
01/87A9: 9F 00 00 7E  STA $7E0000,X
01/87AD: E8           INX 
01/87AE: E8           INX 
01/87AF: C8           INY 
01/87B0: 80 F2        BRA $87A4
01/87B2: AB           PLB 
01/87B3: 60           RTS 

; [ tax ]

01/87B4: 85 43        STA $43
01/87B6: A6 43        LDX $43
01/87B8: 60           RTS 

; [ iny ]

01/87B9: C8           INY 
01/87BA: C8           INY 
01/87BB: C8           INY 
01/87BC: C8           INY 
01/87BD: C8           INY 
01/87BE: C8           INY 
01/87BF: C8           INY 
01/87C0: C8           INY 
01/87C1: 60           RTS 

; --------------------------------------------------------------------------

; [ draw game time and gp ]

01/87C2: 20 70 84     JSR $8470       ; select bg3
01/87C5: A0 07 E0     LDY #$E007      ; 
01/87C8: A2 2E 05     LDX #$052E      ; (30,20)
01/87CB: 20 98 87     JSR $8798       ; copy text to screen buffer
01/87CE: A0 0C DF     LDY #$DF0C      ;  (gil)
01/87D1: A2 76 06     LDX #$0676      ; (27,25)
01/87D4: 20 CD 82     JSR $82CD       ; draw text
01/87D7: 20 93 8B     JSR $8B93       ; draw game time
01/87DA: A0 2A 06     LDY #$062A      ; (42,24)
01/87DD: AD A2 16     LDA $16A2       ; gil
01/87E0: AE A0 16     LDX $16A0
01/87E3: 4C A6 8F     JMP $8FA6       ; draw number text (7 digits)

; [ init main menu ]

01/87E6: 20 9C 94     JSR $949C
01/87E9: 20 A4 94     JSR $94A4
01/87EC: 20 5E 92     JSR $925E       ; load portraits
01/87EF: 20 09 8C     JSR $8C09
01/87F2: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/87F5: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/87F8: 4C 64 94     JMP $9464       ; fade in

; [ main menu ]

01/87FB: A9 7E        LDA #$7E
01/87FD: 48           PHA 
01/87FE: AB           PLB 
01/87FF: 20 65 8C     JSR $8C65       ; clear cursor position data
01/8802: 20 E6 87     JSR $87E6       ; init main menu
01/8805: 9C 03 1A     STZ $1A03
01/8808: AD B7 16     LDA $16B7
01/880B: D0 06        BNE $8813
01/880D: 9C 76 1A     STZ $1A76
01/8810: 9C 77 1A     STZ $1A77
; start of frame loop
01/8813: AD 76 1A     LDA $1A76
01/8816: 0A           ASL 
01/8817: 0A           ASL 
01/8818: 0A           ASL 
01/8819: 0A           ASL 
01/881A: 69 10        ADC #$10
01/881C: 85 46        STA $46
01/881E: A9 B0        LDA #$B0
01/8820: 85 45        STA $45
01/8822: 20 81 82     JSR $8281       ; draw cursor sprite
01/8825: 20 C2 87     JSR $87C2       ; draw game time and gp
01/8828: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/882B: 20 4A 94     JSR $944A       ; transfer bg3 screen buffer to vram
01/882E: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/8831: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/8834: A5 01        LDA $01
01/8836: 29 08        AND #$08
01/8838: F0 0B        BEQ $8845
01/883A: AD 76 1A     LDA $1A76
01/883D: 3A           DEC 
01/883E: 10 02        BPL $8842
01/8840: A9 07        LDA #$07
01/8842: 8D 76 1A     STA $1A76
01/8845: A5 01        LDA $01
01/8847: 29 04        AND #$04
01/8849: F0 0C        BEQ $8857
01/884B: AD 76 1A     LDA $1A76
01/884E: 1A           INC 
01/884F: C9 08        CMP #$08
01/8851: 90 01        BCC $8854
01/8853: 7B           TDC 
01/8854: 8D 76 1A     STA $1A76
01/8857: A5 00        LDA $00
01/8859: 29 80        AND #$80
01/885B: F0 20        BEQ $887D
01/885D: 20 F2 A2     JSR $A2F2
01/8860: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/8863: AD 76 1A     LDA $1A76
01/8866: CD 77 1A     CMP $1A77
01/8869: F0 03        BEQ $886E
01/886B: 20 65 8C     JSR $8C65       ; clear cursor position data
01/886E: 8D 77 1A     STA $1A77
01/8871: A2 87 88     LDX #$8887
01/8874: 20 4B 83     JSR $834B       ; do jump table
01/8877: 20 65 8C     JSR $8C65       ; clear cursor position data
01/887A: 4C 13 88     JMP $8813
01/887D: A5 01        LDA $01
01/887F: 29 80        AND #$80
01/8881: F0 01        BEQ $8884
01/8883: 60           RTS 
01/8884: 4C 13 88     JMP $8813

; main menu jump table
01/8887: 9F27 AEE5 BBF5 A92F ABF9 ACDE D142 CB86

; [ draw character blocks and portraits ]

01/8897: 20 9D 88     JSR $889D       ; draw all character blocks
01/889A: 4C FD 88     JMP $88FD       ; draw portraits

; [ draw all character blocks ]

01/889D: 20 70 84     JSR $8470       ; select bg3
01/88A0: A0 61 DB     LDY #$DB61
01/88A3: 20 D9 80     JSR $80D9       ; draw window
01/88A6: 20 D0 88     JSR $88D0
01/88A9: 20 D9 88     JSR $88D9
01/88AC: 20 E2 88     JSR $88E2
01/88AF: 20 EB 88     JSR $88EB
01/88B2: 4C F4 88     JMP $88F4

; jump table for drawing character blocks
01/88B5: 88D0 88D9 88E2 88EB 88F4

; [ draw selected character block ]

01/88BF: 20 70 84     JSR $8470       ; select bg3
01/88C2: A0 61 DB     LDY #$DB61
01/88C5: 20 D9 80     JSR $80D9       ; draw window
01/88C8: A5 E8        LDA $E8
01/88CA: A2 B5 88     LDX #$88B5
01/88CD: 4C 4B 83     JMP $834B       ; do jump table

; character slot 1
01/88D0: A2 CE 02     LDX #$02CE
01/88D3: A0 00 10     LDY #$1000
01/88D6: 4C 9B 89     JMP $899B       ; draw character block
; character slot 2
01/88D9: A2 4E 00     LDX #$004E
01/88DC: A0 40 10     LDY #$1040
01/88DF: 4C 9B 89     JMP $899B       ; draw character block
; character slot 3
01/88E2: A2 4E 05     LDX #$054E
01/88E5: A0 80 10     LDY #$1080
01/88E8: 4C 9B 89     JMP $899B       ; draw character block
; character slot 4
01/88EB: A2 8E 01     LDX #$018E
01/88EE: A0 C0 10     LDY #$10C0
01/88F1: 4C 9B 89     JMP $899B       ; draw character block
; character slot 5
01/88F4: A2 0E 04     LDX #$040E
01/88F7: A0 00 11     LDY #$1100
01/88FA: 4C 9B 89     JMP $899B       ; draw character block

; [ draw portraits ]

01/88FD: A9 00        LDA #$00        ; sprite layer priority: 0
01/88FF: 85 C1        STA $C1
01/8901: 7B           TDC 
01/8902: 20 92 89     JSR $8992       ; draw portrait
01/8905: A9 01        LDA #$01
01/8907: 20 92 89     JSR $8992       ; draw portrait
01/890A: A9 02        LDA #$02
01/890C: 20 92 89     JSR $8992       ; draw portrait
01/890F: A9 03        LDA #$03
01/8911: 20 92 89     JSR $8992       ; draw portrait
01/8914: A9 04        LDA #$04
01/8916: 4C 92 89     JMP $8992       ; draw portrait

; [ draw main menu ]

01/8919: 20 97 88     JSR $8897       ; draw character blocks and portraits
01/891C: 20 70 84     JSR $8470       ; select bg3
01/891F: A0 69 DB     LDY #$DB69
01/8922: 20 D9 80     JSR $80D9       ; draw window
01/8925: A0 65 DB     LDY #$DB65
01/8928: 20 D9 80     JSR $80D9       ; draw window
01/892B: 20 88 84     JSR $8488       ; select bg4
01/892E: A0 6D DB     LDY #$DB6D      ; main menu options
01/8931: 20 FB 82     JSR $82FB       ; draw window and text
01/8934: AD 02 1A     LDA $1A02
01/8937: D0 0E        BNE $8947       ; branch if tent/save is enabled
01/8939: A9 24        LDA #$24        ; gray palette
01/893B: 8D 31 CA     STA $CA31       ; bg4 (16,24)
01/893E: 8D 33 CA     STA $CA33
01/8941: 8D 35 CA     STA $CA35
01/8944: 8D F5 C9     STA $C9F5       ; this is for the dakuten
01/8947: 60           RTS 

; [ calculate portrait position ]

01/8948: 85 60        STA $60
01/894A: 64 61        STZ $61
01/894C: C2 20        REP #$20
01/894E: A5 60        LDA $60
01/8950: 0A           ASL 
01/8951: 0A           ASL 
01/8952: 0A           ASL 
01/8953: 0A           ASL 
01/8954: 0A           ASL 
01/8955: 0A           ASL 
01/8956: 69 00 10     ADC #$1000
01/8959: A8           TAY 
01/895A: E2 20        SEP #$20
01/895C: A5 60        LDA $60
01/895E: 0A           ASL 
01/895F: 0A           ASL 
01/8960: 0A           ASL 
01/8961: 0A           ASL 
01/8962: 85 48        STA $48
01/8964: B9 00 00     LDA $0000,Y
01/8967: 29 3F        AND #$3F
01/8969: D0 01        BNE $896C
01/896B: 60           RTS 
01/896C: 05 48        ORA $48
01/896E: 85 48        STA $48
01/8970: AD A8 16     LDA $16A8       ; row setting
01/8973: F0 05        BEQ $897A
; 2 front, 3 back
01/8975: A2 0A 00     LDX #$000A
01/8978: 80 02        BRA $897C
; 3 front, 2 back
01/897A: A6 41        LDX $41         ; zero
01/897C: 86 45        STX $45
01/897E: A5 60        LDA $60
01/8980: 0A           ASL 
01/8981: 85 43        STA $43
01/8983: C2 20        REP #$20
01/8985: A5 43        LDA $43
01/8987: 65 45        ADC $45
01/8989: AA           TAX 
01/898A: BF 0A FE 1E  LDA $1EFE0A,X   ; portrait positions
01/898E: A8           TAY 
01/898F: E2 20        SEP #$20
01/8991: 60           RTS 

; [ draw portrait ]

; A: character slot

01/8992: 20 48 89     JSR $8948       ; calculate portrait position
01/8995: A5 60        LDA $60
01/8997: 4C 6E 8E     JMP $8E6E       ; draw portrait

; [ draw character block ]

; +Y: pointer to character properties
; +X: tilemap offset

; subroutine starts at 01/899B

01/899A: 60           RTS 
; subroutine starts here
01/899B: B9 00 00     LDA $0000,Y
01/899E: 29 3F        AND #$3F
01/89A0: F0 F8        BEQ $899A
01/89A2: 84 48        STY $48
01/89A4: 86 4B        STX $4B
01/89A6: 20 21 8C     JSR $8C21
01/89A9: 9B           TXY 
01/89AA: 20 AB 83     JSR $83AB       ; draw character name
01/89AD: A4 4B        LDY $4B
01/89AF: A6 48        LDX $48
01/89B1: 20 00 8B     JSR $8B00
01/89B4: C2 20        REP #$20
01/89B6: A5 4B        LDA $4B
01/89B8: 18           CLC 
01/89B9: 69 84 00     ADC #$0084
01/89BC: 85 4B        STA $4B
01/89BE: 65 29        ADC $29
01/89C0: AA           TAX 
01/89C1: E2 20        SEP #$20
01/89C3: A9 4D        LDA #$4D        ; "L"
01/89C5: 9D 00 00     STA $0000,X
01/89C8: 9D 08 00     STA $0008,X
01/89CB: A9 46        LDA #$46        ; "E"
01/89CD: 9D 02 00     STA $0002,X
01/89D0: 9D 06 00     STA $0006,X
01/89D3: A9 57        LDA #$57        ; "V"
01/89D5: 9D 04 00     STA $0004,X
01/89D8: A9 49        LDA #$49        ; "H"
01/89DA: 9D 40 00     STA $0040,X
01/89DD: A9 51        LDA #$51        ; "P"
01/89DF: 9D 42 00     STA $0042,X
01/89E2: 9D 82 00     STA $0082,X
01/89E5: A9 4E        LDA #$4E        ; "M"
01/89E7: 9D 80 00     STA $0080,X
01/89EA: A9 C7        LDA #$C7        ; "/"
01/89EC: 9D 4E 00     STA $004E,X
01/89EF: 9D 8E 00     STA $008E,X
01/89F2: A0 02 00     LDY #$0002
01/89F5: B1 48        LDA ($48),Y
01/89F7: 20 BD 81     JSR $81BD       ; convert hex to decimal (2 digits)
01/89FA: 9D 14 00     STA $0014,X
01/89FD: EB           XBA 
01/89FE: 9D 16 00     STA $0016,X
01/8A01: C2 20        REP #$20
01/8A03: A9 46 00     LDA #$0046
01/8A06: A0 07 00     LDY #$0007      ; current hp
01/8A09: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/8A0C: A9 50 00     LDA #$0050
01/8A0F: A0 09 00     LDY #$0009      ; max hp
01/8A12: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/8A15: A9 86 00     LDA #$0086
01/8A18: A0 0B 00     LDY #$000B      ; current mp
01/8A1B: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/8A1E: A9 90 00     LDA #$0090
01/8A21: A0 0D 00     LDY #$000D      ; max mp
01/8A24: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/8A27: E2 20        SEP #$20
01/8A29: 60           RTS 

; [ draw hp/mp text ]

01/8A2A: C2 20        REP #$20
01/8A2C: DA           PHX 
01/8A2D: 86 45        STX $45
01/8A2F: 18           CLC 
01/8A30: 65 45        ADC $45
01/8A32: AA           TAX 
01/8A33: B1 48        LDA ($48),Y
01/8A35: 20 D6 81     JSR $81D6       ; convert hex to decimal (4 digits)
01/8A38: E2 20        SEP #$20
01/8A3A: A5 5A        LDA $5A
01/8A3C: 9D 00 00     STA $0000,X
01/8A3F: A5 5B        LDA $5B
01/8A41: 9D 02 00     STA $0002,X
01/8A44: A5 5D        LDA $5D
01/8A46: 9D 04 00     STA $0004,X
01/8A49: A5 5E        LDA $5E
01/8A4B: 9D 06 00     STA $0006,X
01/8A4E: C2 20        REP #$20
01/8A50: FA           PLX 
01/8A51: 60           RTS 

; [ select character (main menu) ]

01/8A52: A5 E7        LDA $E7
01/8A54: 20 B4 87     JSR $87B4       ; tax
01/8A57: 20 12 A9     JSR $A912       ; get character id (battle order)
01/8A5A: D0 0D        BNE $8A69
01/8A5C: A5 E7        LDA $E7         ; find the first valid character
01/8A5E: 1A           INC 
01/8A5F: C9 05        CMP #$05
01/8A61: D0 02        BNE $8A65
01/8A63: A9 00        LDA #$00
01/8A65: 85 E7        STA $E7
01/8A67: 80 E9        BRA $8A52
; start of frame loop
01/8A69: A5 E7        LDA $E7
01/8A6B: 0A           ASL 
01/8A6C: 0A           ASL 
01/8A6D: 0A           ASL 
01/8A6E: 85 45        STA $45         ; y position = slot * 40 + 16
01/8A70: 0A           ASL 
01/8A71: 0A           ASL 
01/8A72: 65 45        ADC $45
01/8A74: 69 10        ADC #$10
01/8A76: 85 46        STA $46
01/8A78: A9 02        LDA #$02        ; x position = 2
01/8A7A: 85 45        STA $45
01/8A7C: 20 81 82     JSR $8281       ; draw cursor sprite
01/8A7F: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/8A82: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/8A85: A5 01        LDA $01
01/8A87: 29 08        AND #$08
01/8A89: F0 1F        BEQ $8AAA
; up
01/8A8B: A5 E7        LDA $E7
01/8A8D: 3A           DEC 
01/8A8E: 10 02        BPL $8A92
01/8A90: A9 04        LDA #$04
01/8A92: 85 E7        STA $E7
01/8A94: 20 B4 87     JSR $87B4       ; tax
01/8A97: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/8A9B: 20 01 90     JSR $9001       ; get pointer to character properties
01/8A9E: AD B8 1B     LDA $1BB8
01/8AA1: D0 07        BNE $8AAA
01/8AA3: BD 00 00     LDA $0000,X
01/8AA6: 29 1F        AND #$1F
01/8AA8: F0 E1        BEQ $8A8B
01/8AAA: A5 01        LDA $01
01/8AAC: 29 04        AND #$04
01/8AAE: F0 20        BEQ $8AD0
; down
01/8AB0: A5 E7        LDA $E7
01/8AB2: 1A           INC 
01/8AB3: C9 05        CMP #$05
01/8AB5: D0 01        BNE $8AB8
01/8AB7: 7B           TDC 
01/8AB8: 85 E7        STA $E7
01/8ABA: 20 B4 87     JSR $87B4       ; tax
01/8ABD: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/8AC1: 20 01 90     JSR $9001       ; get pointer to character properties
01/8AC4: AD B8 1B     LDA $1BB8
01/8AC7: D0 07        BNE $8AD0
01/8AC9: BD 00 00     LDA $0000,X
01/8ACC: 29 1F        AND #$1F
01/8ACE: F0 E0        BEQ $8AB0
01/8AD0: AD 27 1B     LDA $1B27
01/8AD3: F0 0B        BEQ $8AE0
01/8AD5: A5 01        LDA $01
01/8AD7: 29 03        AND #$03
01/8AD9: F0 05        BEQ $8AE0
; left or right
01/8ADB: A9 7F        LDA #$7F
01/8ADD: 85 E8        STA $E8
01/8ADF: 60           RTS 
01/8AE0: A5 00        LDA $00
01/8AE2: 29 80        AND #$80
01/8AE4: F0 0C        BEQ $8AF2
; A button
01/8AE6: A5 E7        LDA $E7
01/8AE8: 20 B4 87     JSR $87B4       ; tax
01/8AEB: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/8AEF: 85 E8        STA $E8
01/8AF1: 60           RTS 
01/8AF2: A5 01        LDA $01
01/8AF4: 29 80        AND #$80
01/8AF6: F0 05        BEQ $8AFD
; B button
01/8AF8: A9 FF        LDA #$FF
01/8AFA: 85 E8        STA $E8
01/8AFC: 60           RTS 
01/8AFD: 4C 69 8A     JMP $8A69

; [  ]

01/8B00: 84 4B        STY $4B
01/8B02: 86 48        STX $48
01/8B04: BD 03 00     LDA $0003,X
01/8B07: 89 80        BIT #$80
01/8B09: D0 1B        BNE $8B26       ; branch if dead
01/8B0B: 0A           ASL 
01/8B0C: 85 45        STA $45
01/8B0E: BD 04 00     LDA $0004,X
01/8B11: 2A           ROL 
01/8B12: 2A           ROL 
01/8B13: 2A           ROL 
01/8B14: 29 01        AND #$01
01/8B16: 05 45        ORA $45
01/8B18: F0 16        BEQ $8B30
01/8B1A: 48           PHA 
01/8B1B: 20 15 8C     JSR $8C15
01/8B1E: 20 8B 87     JSR $878B       ; next row (Y)
01/8B21: 68           PLA 
01/8B22: 88           DEY 
01/8B23: 88           DEY 
01/8B24: 80 1D        BRA $8B43
01/8B26: 20 15 8C     JSR $8C15
01/8B29: BB           TYX 
01/8B2A: A0 B2 DB     LDY #$DBB2
01/8B2D: 4C CD 82     JMP $82CD       ; draw text
01/8B30: AD C2 1B     LDA $1BC2
01/8B33: F0 01        BEQ $8B36
01/8B35: 60           RTS 
01/8B36: A4 48        LDY $48
01/8B38: B9 01 00     LDA $0001,Y
01/8B3B: 48           PHA 
01/8B3C: 20 15 8C     JSR $8C15
01/8B3F: 68           PLA 
01/8B40: 4C C6 8F     JMP $8FC6
01/8B43: 85 45        STA $45
01/8B45: A9 21        LDA #$21
01/8B47: 85 46        STA $46
01/8B49: C2 20        REP #$20
01/8B4B: 98           TYA 
01/8B4C: 18           CLC 
01/8B4D: 65 29        ADC $29
01/8B4F: A8           TAY 
01/8B50: E2 20        SEP #$20
01/8B52: A2 08 00     LDX #$0008
01/8B55: A5 45        LDA $45
01/8B57: 89 80        BIT #$80
01/8B59: F0 10        BEQ $8B6B
01/8B5B: A5 46        LDA $46
01/8B5D: 99 00 00     STA $0000,Y
01/8B60: BF 8A 8B 01  LDA $018B8A,X
01/8B64: 05 34        ORA $34
01/8B66: 99 01 00     STA $0001,Y
01/8B69: 80 05        BRA $8B70
01/8B6B: A9 FF        LDA #$FF
01/8B6D: 99 00 00     STA $0000,Y
01/8B70: 5A           PHY 
01/8B71: C2 20        REP #$20
01/8B73: 98           TYA 
01/8B74: 38           SEC 
01/8B75: E9 40 00     SBC #$0040
01/8B78: A8           TAY 
01/8B79: E2 20        SEP #$20
01/8B7B: A9 FF        LDA #$FF
01/8B7D: 99 00 00     STA $0000,Y
01/8B80: 7A           PLY 
01/8B81: C8           INY 
01/8B82: C8           INY 
01/8B83: E6 46        INC $46
01/8B85: 06 45        ASL $45
01/8B87: CA           DEX 
01/8B88: D0 CB        BNE $8B55
01/8B8A: 60           RTS 

01/8B8B: 00 08 0C 0C 0C 0C 08 00

; [ draw game time ]

01/8B93: AD A4 16     LDA $16A4       ; game time
01/8B96: 85 73        STA $73
01/8B98: AE A5 16     LDX $16A5
01/8B9B: 86 74        STX $74
01/8B9D: 20 E8 8B     JSR $8BE8       ; divide by 60
01/8BA0: 20 E8 8B     JSR $8BE8       ; divide by 60
01/8BA3: A6 73        LDX $73
01/8BA5: E0 E7 03     CPX #$03E7
01/8BA8: 90 0C        BCC $8BB6       ; branch if less than 1000 hours
01/8BAA: A0 02 D6     LDY #$D602      ; bg3 screen buffer
01/8BAD: 20 B8 8B     JSR $8BB8
01/8BB0: A5 5B        LDA $5B
01/8BB2: 99 6C 05     STA $056C,Y
01/8BB5: 60           RTS 
01/8BB6: A4 29        LDY $29
01/8BB8: A5 1D        LDA $1D
01/8BBA: 20 BD 81     JSR $81BD       ; convert hex to decimal (2 digits)
01/8BBD: C9 FF        CMP #$FF
01/8BBF: D0 02        BNE $8BC3
01/8BC1: A9 80        LDA #$80
01/8BC3: 99 76 05     STA $0576,Y     ; minutes
01/8BC6: EB           XBA 
01/8BC7: 99 78 05     STA $0578,Y
01/8BCA: C2 20        REP #$20
01/8BCC: A5 73        LDA $73
01/8BCE: E2 20        SEP #$20
01/8BD0: 20 D6 81     JSR $81D6       ; convert hex to decimal (4 digits)
01/8BD3: A5 5B        LDA $5B
01/8BD5: 99 6E 05     STA $056E,Y     ; hours
01/8BD8: A5 5D        LDA $5D
01/8BDA: 99 70 05     STA $0570,Y
01/8BDD: A5 5E        LDA $5E
01/8BDF: 99 72 05     STA $0572,Y
01/8BE2: A9 C8        LDA #$C8        ; colon
01/8BE4: 99 74 05     STA $0574,Y
01/8BE7: 60           RTS 

; [ divide by 60 ]

01/8BE8: 64 1D        STZ $1D
01/8BEA: A2 18 00     LDX #$0018
01/8BED: 26 73        ROL $73
01/8BEF: 26 74        ROL $74
01/8BF1: 26 75        ROL $75
01/8BF3: 26 1D        ROL $1D
01/8BF5: A5 1D        LDA $1D
01/8BF7: C9 3C        CMP #$3C
01/8BF9: 90 04        BCC $8BFF
01/8BFB: E9 3C        SBC #$3C
01/8BFD: 85 1D        STA $1D
01/8BFF: 26 73        ROL $73
01/8C01: 26 74        ROL $74
01/8C03: 26 75        ROL $75
01/8C05: CA           DEX 
01/8C06: D0 EB        BNE $8BF3
01/8C08: 60           RTS 

; [  ]

01/8C09: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/8C0C: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/8C0F: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/8C12: 4C 19 89     JMP $8919       ; draw main menu

; [  ]

01/8C15: C2 20        REP #$20
01/8C17: A5 4B        LDA $4B
01/8C19: 18           CLC 
01/8C1A: 69 0E 00     ADC #$000E
01/8C1D: A8           TAY 
01/8C1E: E2 20        SEP #$20
01/8C20: 60           RTS 

; [  ]

01/8C21: 48           PHA 
01/8C22: DA           PHX 
01/8C23: 5A           PHY 
01/8C24: B9 03 00     LDA $0003,Y
01/8C27: 29 80        AND #$80
01/8C29: 18           CLC 
01/8C2A: 2A           ROL 
01/8C2B: 2A           ROL 
01/8C2C: 2A           ROL 
01/8C2D: 2A           ROL 
01/8C2E: 85 45        STA $45
01/8C30: A9 07        LDA #$07
01/8C32: 20 47 8C     JSR $8C47
01/8C35: 20 47 8C     JSR $8C47
01/8C38: A9 0E        LDA #$0E
01/8C3A: 20 47 8C     JSR $8C47
01/8C3D: 20 47 8C     JSR $8C47
01/8C40: 20 47 8C     JSR $8C47
01/8C43: 7A           PLY 
01/8C44: FA           PLX 
01/8C45: 68           PLA 
01/8C46: 60           RTS 

; [  ]

01/8C47: 48           PHA 
01/8C48: 85 37        STA $37
01/8C4A: DA           PHX 
01/8C4B: C2 20        REP #$20
01/8C4D: 8A           TXA 
01/8C4E: 18           CLC 
01/8C4F: 65 29        ADC $29
01/8C51: AA           TAX 
01/8C52: E2 20        SEP #$20
01/8C54: A5 45        LDA $45
01/8C56: 9D 01 00     STA $0001,X
01/8C59: E8           INX 
01/8C5A: E8           INX 
01/8C5B: C6 37        DEC $37
01/8C5D: D0 F7        BNE $8C56
01/8C5F: FA           PLX 
01/8C60: 20 7E 87     JSR $877E       ; next row (X)
01/8C63: 68           PLA 
01/8C64: 60           RTS 

; [ clear cursor position data ]

01/8C65: 48           PHA 
01/8C66: AD B7 16     LDA $16B7
01/8C69: D0 10        BNE $8C7B       ; branch if memory cursor
01/8C6B: A2 EB 00     LDX #$00EB
01/8C6E: A4 41        LDY $41         ; zero
01/8C70: 7B           TDC 
01/8C71: 99 00 1B     STA $1B00,Y     ; clear $1B00-$1BEB
01/8C74: C8           INY 
01/8C75: CA           DEX 
01/8C76: D0 F9        BNE $8C71
01/8C78: 20 CC 95     JSR $95CC
01/8C7B: 68           PLA 
01/8C7C: 60           RTS 

; --------------------------------------------------------------------------

; [ init menu ]

01/8C7D: 78           SEI 
01/8C7E: A9 00        LDA #$00
01/8C80: 8F 44 01 00  STA $000144     ; clear high byte of 8-bit scratchpad
01/8C84: 48           PHA 
01/8C85: AB           PLB 
01/8C86: A9 80        LDA #$80
01/8C88: 8D 00 21     STA $2100       ; screen off
01/8C8B: A9 01        LDA #$01
01/8C8D: 8D 00 42     STA $4200       ; disable nmi and irq
01/8C90: A2 00 21     LDX #$2100
01/8C93: DA           PHX 
01/8C94: 2B           PLD 
01/8C95: 22 CD FC 1E  JSL $1EFCCD
01/8C99: 20 A9 94     JSR $94A9
01/8C9C: A2 00 40     LDX #$4000
01/8C9F: 86 16        STX $16
01/8CA1: 8B           PHB 
01/8CA2: A9 0C        LDA #$0C
01/8CA4: 48           PHA 
01/8CA5: AB           PLB 
01/8CA6: A9 20        LDA #$20
01/8CA8: A0 C0 F9     LDY #$F9C0      ; 0C/F9C0 (misc. graphics)
01/8CAB: 20 FB 92     JSR $92FB       ; transfer 3bpp graphics to vram
01/8CAE: AB           PLB 
01/8CAF: A2 00 01     LDX #$0100
01/8CB2: DA           PHX 
01/8CB3: 2B           PLD 
01/8CB4: A9 7E        LDA #$7E
01/8CB6: 48           PHA 
01/8CB7: AB           PLB 
01/8CB8: 64 41        STZ $41         ; zero (constant)
01/8CBA: 64 42        STZ $42
01/8CBC: A2 00 10     LDX #$1000
01/8CBF: 86 DE        STX $DE
01/8CC1: 20 A4 94     JSR $94A4
01/8CC4: A2 00 20     LDX #$2000      ; destination address (vram)
01/8CC7: 86 1D        STX $1D
01/8CC9: A2 00 F0     LDX #$F000      ; source address: 0A/F000 (menu graphics)
01/8CCC: 86 1F        STX $1F
01/8CCE: A9 0A        LDA #$0A
01/8CD0: 85 21        STA $21
01/8CD2: A2 00 10     LDX #$1000      ; size: $1000
01/8CD5: 86 22        STX $22
01/8CD7: 20 78 80     JSR $8078       ; transfer data to vram
01/8CDA: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/8CDD: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/8CE0: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/8CE3: 22 1A FD 1E  JSL $1EFD1A
01/8CE7: C2 20        REP #$20
01/8CE9: 20 49 87     JSR $8749       ; update window color
01/8CEC: A2 C0 80     LDX #$80C0
01/8CEF: A0 00 A1     LDY #$A100
01/8CF2: A9 0F 00     LDA #$000F
01/8CF5: 54 7E 0D     MVN $7E,$0D
01/8CF8: E2 20        SEP #$20
01/8CFA: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/8CFD: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/8D00: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/8D03: 64 84        STZ $84
01/8D05: 64 85        STZ $85
01/8D07: 64 88        STZ $88
01/8D09: A9 30        LDA #$30
01/8D0B: 85 3F        STA $3F
01/8D0D: A9 4C        LDA #$4C
01/8D0F: 8D CC 01     STA $01CC
01/8D12: 8D CF 01     STA $01CF
01/8D15: A2 2C 8D     LDX #$8D2C
01/8D18: 8E CD 01     STX $01CD
01/8D1B: 8E D0 01     STX $01D0
01/8D1E: 20 BB 82     JSR $82BB       ; init controller
01/8D21: A9 63        LDA #$63
01/8D23: 85 E3        STA $E3
01/8D25: A9 80        LDA #$80
01/8D27: 85 88        STA $88
01/8D29: 9C C9 1B     STZ $1BC9
01/8D2C: 60           RTS 

; [ clear screen buffer ]

01/8D2D: 20 45 8D     JSR $8D45       ; clear bg3 screen buffer
01/8D30: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/8D33: 20 40 8D     JSR $8D45       ; clear bg4 screen buffer
01/8D36: A2 00 A6     LDX #$A600      ; bg2 screen buffer
01/8D39: 80 0F        BRA $8D4A
01/8D3B: A2 00 B6     LDX #$B600      ; bg1 screen buffer
01/8D3E: 80 22        BRA $8D62
01/8D40: A2 00 C6     LDX #$C600      ; bg4 screen buffer
01/8D43: 80 05        BRA $8D4A
01/8D45: A2 00 D6     LDX #$D600      ; bg3 screen buffer
01/8D48: 80 18        BRA $8D62
; high priority (bg2 and bg4)
01/8D4A: 86 73        STX $73
01/8D4C: C2 20        REP #$20
01/8D4E: A9 00 20     LDA #$2000
01/8D51: A4 41        LDY $41         ; zero
01/8D53: A2 00 08     LDX #$0800
01/8D56: 91 73        STA ($73),Y
01/8D58: C8           INY 
01/8D59: C8           INY 
01/8D5A: CA           DEX 
01/8D5B: D0 F9        BNE $8D56
01/8D5D: E2 20        SEP #$20
01/8D5F: 64 44        STZ $44
01/8D61: 60           RTS 
; low priority (bg1 and bg3)
01/8D62: 86 73        STX $73
01/8D64: C2 20        REP #$20
01/8D66: A5 41        LDA $41         ; zero
01/8D68: 80 E7        BRA $8D51

; [ clear sprite data ]

01/8D6A: C2 20        REP #$20
01/8D6C: A0 80 00     LDY #$0080      ; 128 sprites
01/8D6F: A2 00 00     LDX #$0000
01/8D72: A9 FF F0     LDA #$F0FF
01/8D75: 9F 00 03 00  STA $000300,X
01/8D79: A9 00 30     LDA #$3000
01/8D7C: 9F 02 03 00  STA $000302,X
01/8D80: E8           INX 
01/8D81: E8           INX 
01/8D82: E8           INX 
01/8D83: E8           INX 
01/8D84: 88           DEY 
01/8D85: D0 EB        BNE $8D72
01/8D87: A0 10 00     LDY #$0010      ; clear 32 bytes of upper sprite data
01/8D8A: A9 00 00     LDA #$0000
01/8D8D: 9F 00 03 00  STA $000300,X
01/8D91: E8           INX 
01/8D92: E8           INX 
01/8D93: 88           DEY 
01/8D94: D0 F7        BNE $8D8D
01/8D96: A9 AA AA     LDA #$AAAA      ; sprites 0-15 are 32x32 (cursors)
01/8D99: 8F 00 05 00  STA $000500
01/8D9D: E2 20        SEP #$20
01/8D9F: 60           RTS 

; [ load character graphics ]

01/8DA0: 64 E4        STZ $E4         ; character slot
01/8DA2: A5 E4        LDA $E4
01/8DA4: 20 01 90     JSR $9001       ; get pointer to character properties
01/8DA7: 0A           ASL 
01/8DA8: 85 43        STA $43
01/8DAA: A4 43        LDY $43
01/8DAC: BD 00 00     LDA $0000,X     ; character id
01/8DAF: 29 3F        AND #$3F
01/8DB1: 85 5A        STA $5A
01/8DB3: 99 67 1A     STA $1A67,Y
01/8DB6: A5 E4        LDA $E4
01/8DB8: 85 5B        STA $5B
01/8DBA: 99 68 1A     STA $1A68,Y
01/8DBD: BD 01 00     LDA $0001,X     ; character graphics
01/8DC0: 85 5C        STA $5C
01/8DC2: 20 CE 8D     JSR $8DCE       ; load character slot graphics
01/8DC5: E6 E4        INC $E4         ; next character slot
01/8DC7: A5 E4        LDA $E4
01/8DC9: C9 05        CMP #$05
01/8DCB: D0 D5        BNE $8DA2
01/8DCD: 60           RTS 

; [ load character slot graphics ]

01/8DCE: A5 5A        LDA $5A
01/8DD0: D0 01        BNE $8DD3       ; branch if no character
01/8DD2: 60           RTS 
01/8DD3: A9 00        LDA #$00
01/8DD5: EB           XBA 
01/8DD6: A5 5C        LDA $5C
01/8DD8: 0A           ASL 
01/8DD9: 0A           ASL 
01/8DDA: 0A           ASL 
01/8DDB: EB           XBA 
01/8DDC: C2 20        REP #$20
01/8DDE: 18           CLC 
01/8DDF: 69 00 80     ADC #$8000      ; 1A/8000 (battle character graphics)
01/8DE2: 85 1F        STA $1F
01/8DE4: A9 00 06     LDA #$0600      ; size: $0600 bytes
01/8DE7: 85 22        STA $22
01/8DE9: E2 20        SEP #$20
01/8DEB: A9 1A        LDA #$1A
01/8DED: 85 21        STA $21
01/8DEF: A5 5B        LDA $5B
01/8DF1: 0A           ASL 
01/8DF2: 20 B4 87     JSR $87B4       ; tax
01/8DF5: C2 20        REP #$20
01/8DF7: BF 73 FD 1E  LDA $1EFD73,X   ; ppu address for character graphics
01/8DFB: 85 1D        STA $1D
01/8DFD: E2 20        SEP #$20
01/8DFF: 20 8A 81     JSR $818A       ; wait for vblank
01/8E02: 20 78 80     JSR $8078       ; transfer data to vram
01/8E05: 7B           TDC 
01/8E06: EB           XBA 
01/8E07: A5 5C        LDA $5C
01/8E09: 29 0F        AND #$0F
01/8E0B: C2 20        REP #$20
01/8E0D: 0A           ASL 
01/8E0E: 0A           ASL 
01/8E0F: 0A           ASL 
01/8E10: 0A           ASL 
01/8E11: 0A           ASL 
01/8E12: AA           TAX 
01/8E13: E2 20        SEP #$20
01/8E15: A5 5B        LDA $5B
01/8E17: 0A           ASL 
01/8E18: 0A           ASL 
01/8E19: 0A           ASL 
01/8E1A: 0A           ASL 
01/8E1B: 0A           ASL 
01/8E1C: 85 43        STA $43
01/8E1E: A4 43        LDY $43
01/8E20: A9 20        LDA #$20
01/8E22: 85 45        STA $45
01/8E24: BF 00 FD 1C  LDA $1CFD00,X   ; load character palette to buffer
01/8E28: 99 28 FE     STA $FE28,Y
01/8E2B: E8           INX 
01/8E2C: C8           INY 
01/8E2D: C6 45        DEC $45
01/8E2F: D0 F3        BNE $8E24
01/8E31: 60           RTS 

; [ get dakuten ]

01/8E32: DA           PHX 
01/8E33: C9 42        CMP #$42
01/8E35: B0 15        BCS $8E4C       ; branch if no dakuten
01/8E37: 38           SEC 
01/8E38: E9 0F        SBC #$0F
01/8E3A: 0A           ASL 
01/8E3B: EB           XBA 
01/8E3C: A9 00        LDA #$00
01/8E3E: EB           XBA 
01/8E3F: AA           TAX 
01/8E40: BF 1F FE 1E  LDA $1EFE1F,X   ; dakuten
01/8E44: EB           XBA 
01/8E45: BF 1E FE 1E  LDA $1EFE1E,X   ; kana
01/8E49: EB           XBA 
01/8E4A: FA           PLX 
01/8E4B: 60           RTS 
01/8E4C: EB           XBA 
01/8E4D: A9 FF        LDA #$FF
01/8E4F: FA           PLX 
01/8E50: 60           RTS 

; [  ]

01/8E51: A2 04 00     LDX #$0004
01/8E54: C2 20        REP #$20
01/8E56: A9 00 01     LDA #$0100
01/8E59: 99 00 00     STA $0000,Y
01/8E5C: 99 02 00     STA $0002,Y
01/8E5F: 99 04 00     STA $0004,Y
01/8E62: 99 06 00     STA $0006,Y
01/8E65: 20 8B 87     JSR $878B       ; next row (Y)
01/8E68: CA           DEX 
01/8E69: D0 EB        BNE $8E56
01/8E6B: E2 20        SEP #$20
01/8E6D: 60           RTS 

; [ draw portrait ]

01/8E6E: 48           PHA 
01/8E6F: 5A           PHY 
01/8E70: 85 1D        STA $1D
01/8E72: 84 1E        STY $1E
01/8E74: 20 19 A9     JSR $A919       ; get character id
01/8E77: D0 28        BNE $8EA1
; no portrait
01/8E79: 7B           TDC 
01/8E7A: EB           XBA 
01/8E7B: A5 1D        LDA $1D
01/8E7D: C2 20        REP #$20
01/8E7F: 0A           ASL 
01/8E80: 0A           ASL 
01/8E81: 0A           ASL 
01/8E82: 0A           ASL 
01/8E83: 0A           ASL 
01/8E84: 0A           ASL 
01/8E85: A8           TAY 
01/8E86: A2 20 00     LDX #$0020
01/8E89: A9 FF F0     LDA #$F0FF
01/8E8C: 99 40 03     STA $0340,Y
01/8E8F: A9 00 30     LDA #$3000
01/8E92: 99 42 03     STA $0342,Y
01/8E95: C8           INY 
01/8E96: C8           INY 
01/8E97: C8           INY 
01/8E98: C8           INY 
01/8E99: CA           DEX 
01/8E9A: D0 ED        BNE $8E89
01/8E9C: E2 20        SEP #$20
01/8E9E: 7A           PLY 
01/8E9F: 68           PLA 
01/8EA0: 60           RTS 
; draw portrait
01/8EA1: A9 00        LDA #$00
01/8EA3: EB           XBA 
01/8EA4: A5 1D        LDA $1D
01/8EA6: C2 20        REP #$20
01/8EA8: 0A           ASL 
01/8EA9: 0A           ASL 
01/8EAA: 0A           ASL 
01/8EAB: 0A           ASL 
01/8EAC: 0A           ASL 
01/8EAD: 0A           ASL 
01/8EAE: A8           TAY 
01/8EAF: E2 20        SEP #$20
01/8EB1: A5 1D        LDA $1D
01/8EB3: 0A           ASL 
01/8EB4: 0A           ASL 
01/8EB5: 0A           ASL 
01/8EB6: 0A           ASL 
01/8EB7: 69 20        ADC #$20
01/8EB9: 85 20        STA $20
01/8EBB: A5 1D        LDA $1D
01/8EBD: 18           CLC 
01/8EBE: 69 03        ADC #$03
01/8EC0: 0A           ASL 
01/8EC1: 0D C1 01     ORA $01C1       ; layer priority
01/8EC4: 85 21        STA $21
01/8EC6: C2 20        REP #$20
; 1st row
01/8EC8: A2 04 00     LDX #$0004
01/8ECB: A5 1E        LDA $1E
01/8ECD: 99 40 03     STA $0340,Y
01/8ED0: 18           CLC 
01/8ED1: 69 08 00     ADC #$0008
01/8ED4: 85 1E        STA $1E
01/8ED6: A5 20        LDA $20
01/8ED8: 99 42 03     STA $0342,Y
01/8EDB: 1A           INC 
01/8EDC: 85 20        STA $20
01/8EDE: C8           INY 
01/8EDF: C8           INY 
01/8EE0: C8           INY 
01/8EE1: C8           INY 
01/8EE2: CA           DEX 
01/8EE3: D0 E6        BNE $8ECB
01/8EE5: A5 1E        LDA $1E
01/8EE7: 18           CLC 
01/8EE8: 69 E0 07     ADC #$07E0      ; next row
01/8EEB: 85 1E        STA $1E
; 2nd row
01/8EED: A2 04 00     LDX #$0004
01/8EF0: A5 1E        LDA $1E
01/8EF2: 99 40 03     STA $0340,Y
01/8EF5: 18           CLC 
01/8EF6: 69 08 00     ADC #$0008
01/8EF9: 85 1E        STA $1E
01/8EFB: A5 20        LDA $20
01/8EFD: 99 42 03     STA $0342,Y
01/8F00: 1A           INC 
01/8F01: 85 20        STA $20
01/8F03: C8           INY 
01/8F04: C8           INY 
01/8F05: C8           INY 
01/8F06: C8           INY 
01/8F07: CA           DEX 
01/8F08: D0 E6        BNE $8EF0
01/8F0A: A5 1E        LDA $1E
01/8F0C: 18           CLC 
01/8F0D: 69 E0 07     ADC #$07E0      ; next row
01/8F10: 85 1E        STA $1E
; 3rd row
01/8F12: A2 04 00     LDX #$0004
01/8F15: A5 1E        LDA $1E
01/8F17: 99 40 03     STA $0340,Y
01/8F1A: 18           CLC 
01/8F1B: 69 08 00     ADC #$0008
01/8F1E: 85 1E        STA $1E
01/8F20: A5 20        LDA $20
01/8F22: 99 42 03     STA $0342,Y
01/8F25: 1A           INC 
01/8F26: 85 20        STA $20
01/8F28: C8           INY 
01/8F29: C8           INY 
01/8F2A: C8           INY 
01/8F2B: C8           INY 
01/8F2C: CA           DEX 
01/8F2D: D0 E6        BNE $8F15
01/8F2F: A5 1E        LDA $1E
01/8F31: 18           CLC 
01/8F32: 69 E0 07     ADC #$07E0      ; next row
01/8F35: 85 1E        STA $1E
; 4th row
01/8F37: A2 04 00     LDX #$0004
01/8F3A: A5 1E        LDA $1E
01/8F3C: 99 40 03     STA $0340,Y
01/8F3F: 18           CLC 
01/8F40: 69 08 00     ADC #$0008
01/8F43: 85 1E        STA $1E
01/8F45: A5 20        LDA $20
01/8F47: 99 42 03     STA $0342,Y
01/8F4A: 1A           INC 
01/8F4B: 85 20        STA $20
01/8F4D: C8           INY 
01/8F4E: C8           INY 
01/8F4F: C8           INY 
01/8F50: C8           INY 
01/8F51: CA           DEX 
01/8F52: D0 E6        BNE $8F3A
01/8F54: E2 20        SEP #$20
01/8F56: 7A           PLY 
01/8F57: 68           PLA 
01/8F58: 60           RTS 

; [ convert hex to decimal (7 digits) ]

01/8F59: 86 73        STX $73
01/8F5B: 85 75        STA $75
01/8F5D: A9 FF        LDA #$FF
01/8F5F: A6 41        LDX $41         ; zero
01/8F61: 9D 63 01     STA $0163,X
01/8F64: E8           INX 
01/8F65: E0 07 00     CPX #$0007
01/8F68: D0 F7        BNE $8F61
01/8F6A: A4 41        LDY $41         ; zero
01/8F6C: 20 85 8F     JSR $8F85       ; divide by 10
01/8F6F: A5 1D        LDA $1D
01/8F71: 09 80        ORA #$80
01/8F73: 99 63 01     STA $0163,Y     ; store digit
01/8F76: C8           INY 
01/8F77: A5 73        LDA $73
01/8F79: 05 74        ORA $74
01/8F7B: 05 75        ORA $75
01/8F7D: F0 05        BEQ $8F84
01/8F7F: C0 07 00     CPY #$0007
01/8F82: D0 E8        BNE $8F6C
01/8F84: 60           RTS 

; [ divide by 10 ]

01/8F85: 64 1D        STZ $1D
01/8F87: A2 18 00     LDX #$0018
01/8F8A: 26 73        ROL $73
01/8F8C: 26 74        ROL $74
01/8F8E: 26 75        ROL $75
01/8F90: 26 1D        ROL $1D
01/8F92: A5 1D        LDA $1D
01/8F94: C9 0A        CMP #$0A
01/8F96: 90 04        BCC $8F9C
01/8F98: E9 0A        SBC #$0A
01/8F9A: 85 1D        STA $1D
01/8F9C: 26 73        ROL $73
01/8F9E: 26 74        ROL $74
01/8FA0: 26 75        ROL $75
01/8FA2: CA           DEX 
01/8FA3: D0 EB        BNE $8F90
01/8FA5: 60           RTS 

; [ draw number text (7 digits) ]

01/8FA6: 5A           PHY 
01/8FA7: 5A           PHY 
01/8FA8: 20 59 8F     JSR $8F59       ; convert hex to decimal (7 digits)
01/8FAB: C2 20        REP #$20
01/8FAD: 68           PLA 
01/8FAE: 18           CLC 
01/8FAF: 69 0E 00     ADC #$000E
01/8FB2: A8           TAY 
01/8FB3: E2 20        SEP #$20
01/8FB5: A6 41        LDX $41         ; zero
01/8FB7: BD 63 01     LDA $0163,X
01/8FBA: 91 29        STA ($29),Y     ; copy to tilemap
01/8FBC: 88           DEY 
01/8FBD: 88           DEY 
01/8FBE: E8           INX 
01/8FBF: E0 07 00     CPX #$0007
01/8FC2: D0 F3        BNE $8FB7
01/8FC4: 7A           PLY 
01/8FC5: 60           RTS 

; [ draw character title ]

01/8FC6: 29 0F        AND #$0F
01/8FC8: 48           PHA 
01/8FC9: C2 20        REP #$20
01/8FCB: 98           TYA 
01/8FCC: 18           CLC 
01/8FCD: 65 29        ADC $29
01/8FCF: A8           TAY 
01/8FD0: E2 20        SEP #$20
01/8FD2: 68           PLA 
01/8FD3: 0A           ASL 
01/8FD4: 85 45        STA $45
01/8FD6: 0A           ASL 
01/8FD7: 65 45        ADC $45
01/8FD9: 85 45        STA $45
01/8FDB: 64 46        STZ $46
01/8FDD: A6 45        LDX $45
01/8FDF: A9 06        LDA #$06
01/8FE1: 85 45        STA $45
01/8FE3: BF 64 A7 0F  LDA $0FA764,X
01/8FE7: 20 32 8E     JSR $8E32       ; get dakuten
01/8FEA: 99 00 00     STA $0000,Y     ; dakuten
01/8FED: EB           XBA 
01/8FEE: 99 40 00     STA $0040,Y     ; kana
01/8FF1: C8           INY 
01/8FF2: A5 34        LDA $34
01/8FF4: 99 00 00     STA $0000,Y
01/8FF7: 99 40 00     STA $0040,Y
01/8FFA: C8           INY 
01/8FFB: E8           INX 
01/8FFC: C6 45        DEC $45
01/8FFE: D0 E3        BNE $8FE3
01/9000: 60           RTS 

; [ get pointer to character properties ]

01/9001: 48           PHA 
01/9002: 29 0F        AND #$0F
01/9004: 0A           ASL 
01/9005: 20 B4 87     JSR $87B4       ; tax
01/9008: C2 20        REP #$20
01/900A: BF 25 C6 0F  LDA $0FC625,X
01/900E: AA           TAX 
01/900F: E2 20        SEP #$20
01/9011: 68           PLA 
01/9012: 60           RTS 

; [  ]

01/9013: 5A           PHY 
01/9014: DA           PHX 
01/9015: B1 60        LDA ($60),Y
01/9017: 85 43        STA $43
01/9019: C2 20        REP #$20
01/901B: A5 29        LDA $29
01/901D: 18           CLC 
01/901E: 69 40 00     ADC #$0040
01/9021: 85 1D        STA $1D
01/9023: A5 43        LDA $43
01/9025: 0A           ASL 
01/9026: 0A           ASL 
01/9027: 0A           ASL 
01/9028: 65 43        ADC $43
01/902A: AA           TAX 
01/902B: E2 20        SEP #$20
01/902D: 7A           PLY 
01/902E: BF 00 80 0F  LDA $0F8000,X
01/9032: 91 1D        STA ($1D),Y
01/9034: C8           INY 
01/9035: A5 DB        LDA $DB
01/9037: 05 34        ORA $34
01/9039: 91 29        STA ($29),Y
01/903B: 91 1D        STA ($1D),Y
01/903D: C8           INY 
01/903E: E8           INX 
01/903F: A9 08        LDA #$08
01/9041: 85 45        STA $45
01/9043: BF 00 80 0F  LDA $0F8000,X
01/9047: 20 32 8E     JSR $8E32       ; get dakuten
01/904A: 91 29        STA ($29),Y     ; dakuten
01/904C: EB           XBA 
01/904D: 91 1D        STA ($1D),Y     ; kana
01/904F: E8           INX 
01/9050: C8           INY 
01/9051: A5 DB        LDA $DB
01/9053: 05 34        ORA $34
01/9055: 91 29        STA ($29),Y
01/9057: 91 1D        STA ($1D),Y
01/9059: C8           INY 
01/905A: C6 45        DEC $45
01/905C: D0 E5        BNE $9043
01/905E: 7A           PLY 
01/905F: 60           RTS 
01/9060: 5A           PHY 
01/9061: 5A           PHY 
01/9062: 80 B3        BRA $9017

; [ draw character ]

01/9064: DA           PHX 
01/9065: A5 1D        LDA $1D
01/9067: 20 01 90     JSR $9001       ; get pointer to character properties
01/906A: 86 22        STX $22
01/906C: B2 22        LDA ($22)
01/906E: 29 3F        AND #$3F
01/9070: D0 1A        BNE $908C
01/9072: 80 01        BRA $9075
01/9074: DA           PHX 
01/9075: 7B           TDC 
01/9076: EB           XBA 
01/9077: A5 1D        LDA $1D
01/9079: C2 20        REP #$20
01/907B: 0A           ASL 
01/907C: 0A           ASL 
01/907D: 0A           ASL 
01/907E: 0A           ASL 
01/907F: 0A           ASL 
01/9080: 0A           ASL 
01/9081: 69 40 03     ADC #$0340
01/9084: A8           TAY 
01/9085: E2 20        SEP #$20
01/9087: 20 20 91     JSR $9120
01/908A: FA           PLX 
01/908B: 60           RTS 
01/908C: A4 41        LDY $41         ; zero
01/908E: D9 67 1A     CMP $1A67,Y
01/9091: F0 04        BEQ $9097
01/9093: C8           INY 
01/9094: C8           INY 
01/9095: 80 F7        BRA $908E
01/9097: B9 68 1A     LDA $1A68,Y
01/909A: 48           PHA 
01/909B: 85 45        STA $45
01/909D: 0A           ASL 
01/909E: 65 45        ADC $45
01/90A0: 0A           ASL 
01/90A1: 0A           ASL 
01/90A2: 0A           ASL 
01/90A3: 0A           ASL 
01/90A4: 69 80        ADC #$80
01/90A6: 85 48        STA $48
01/90A8: A9 00        LDA #$00
01/90AA: 69 00        ADC #$00
01/90AC: 85 49        STA $49
01/90AE: 68           PLA 
01/90AF: 1A           INC 
01/90B0: 1A           INC 
01/90B1: 1A           INC 
01/90B2: 0A           ASL 
01/90B3: 05 C1        ORA $C1         ; sprite layer priority
01/90B5: 65 49        ADC $49
01/90B7: 85 49        STA $49
01/90B9: A5 1E        LDA $1E
01/90BB: C9 09        CMP #$09
01/90BD: D0 05        BNE $90C4
01/90BF: A2 06 00     LDX #$0006
01/90C2: 80 02        BRA $90C6
01/90C4: A6 41        LDX $41         ; zero
01/90C6: 7B           TDC 
01/90C7: EB           XBA 
01/90C8: A5 1D        LDA $1D
01/90CA: C2 20        REP #$20
01/90CC: 0A           ASL 
01/90CD: 0A           ASL 
01/90CE: 0A           ASL 
01/90CF: 0A           ASL 
01/90D0: 0A           ASL 
01/90D1: 0A           ASL 
01/90D2: 69 40 03     ADC #$0340
01/90D5: A8           TAY 
01/90D6: E2 20        SEP #$20
01/90D8: A9 06        LDA #$06
01/90DA: 85 45        STA $45
01/90DC: A5 1F        LDA $1F
01/90DE: 18           CLC 
01/90DF: 7F 7D 91 01  ADC $01917D,X
01/90E3: 99 00 00     STA $0000,Y
01/90E6: A5 20        LDA $20
01/90E8: 18           CLC 
01/90E9: 7F 89 91 01  ADC $019189,X
01/90ED: 99 01 00     STA $0001,Y
01/90F0: 86 E9        STX $E9
01/90F2: A5 1E        LDA $1E
01/90F4: 0A           ASL 
01/90F5: 85 43        STA $43
01/90F7: 0A           ASL 
01/90F8: 65 43        ADC $43
01/90FA: 65 E9        ADC $E9
01/90FC: 20 B4 87     JSR $87B4       ; tax
01/90FF: A9 00        LDA #$00
01/9101: EB           XBA 
01/9102: BF 3B 91 01  LDA $01913B,X
01/9106: A6 E9        LDX $E9
01/9108: C2 20        REP #$20
01/910A: 18           CLC 
01/910B: 65 48        ADC $48
01/910D: 99 02 00     STA $0002,Y
01/9110: E2 20        SEP #$20
01/9112: C8           INY 
01/9113: C8           INY 
01/9114: C8           INY 
01/9115: C8           INY 
01/9116: E8           INX 
01/9117: C6 45        DEC $45
01/9119: D0 C1        BNE $90DC
01/911B: 20 20 91     JSR $9120
01/911E: FA           PLX 
01/911F: 60           RTS 
01/9120: A2 0A 00     LDX #$000A
01/9123: C2 20        REP #$20
01/9125: A9 FF F0     LDA #$F0FF
01/9128: 99 00 00     STA $0000,Y
01/912B: A9 00 30     LDA #$3000
01/912E: 99 02 00     STA $0002,Y
01/9131: C8           INY 
01/9132: C8           INY 
01/9133: C8           INY 
01/9134: C8           INY 
01/9135: CA           DEX 
01/9136: D0 ED        BNE $9125
01/9138: E2 20        SEP #$20
01/913A: 60           RTS 

; character spritesheet (11 * 6 bytes)
01/913B: 00 01 02 03 04 05
01/9141: 06 07 08 09 0A 0B
01/9147: 00 01 02 030C 0D
01/914D: 0E 0F 10 11 12 13
01/9153: 00 01 14 03 15 0D
01/9159: 00 01 16 17 18 19
01/915F: 00 1A 02 1B 1C 1D
01/9165: 1E 1F 20 21 22 23
01/916B: 24 25 26 27 28 29
01/9171: 2A 2B 2C 2D 2E 2F
01/9177: 2A 2B 2C 2D 2E 2F

; sprite x positions
01/917D: 00 08 00 08 00 08
01/9183: 00 08 10 00 08 10

; sprite y positions
01/9189: 00 00 08 08 10 10
01/918F: 00 00 00 08 08 08

; [  ]

01/9195: A6 41        LDX $41         ; zero
01/9197: C2 20        REP #$20
01/9199: A9 05 00     LDA #$0005
01/919C: 85 45        STA $45
01/919E: A4 41        LDY $41         ; zero
01/91A0: BF C4 91 01  LDA $0191C4,X
01/91A4: 18           CLC 
01/91A5: 6D 71 1A     ADC $1A71
01/91A8: 99 02 FE     STA $FE02,Y
01/91AB: 99 16 FE     STA $FE16,Y
01/91AE: 98           TYA 
01/91AF: 4A           LSR 
01/91B0: 4A           LSR 
01/91B1: 99 00 FE     STA $FE00,Y
01/91B4: 99 14 FE     STA $FE14,Y
01/91B7: C8           INY 
01/91B8: C8           INY 
01/91B9: C8           INY 
01/91BA: C8           INY 
01/91BB: E8           INX 
01/91BC: E8           INX 
01/91BD: C6 45        DEC $45
01/91BF: D0 DF        BNE $91A0
01/91C1: E2 20        SEP #$20
01/91C3: 60           RTS 

01/91C4: 00 00
01/91C6: 00 18
01/91C8: 00 30
01/91CA: 00 48
01/91CC: 00 60

; [  ]

01/91CE: AD A8 16     LDA $16A8       ; row setting
01/91D1: F0 02        BEQ $91D5
01/91D3: A9 0A        LDA #$0A
01/91D5: 20 B4 87     JSR $87B4       ; tax
01/91D8: C2 20        REP #$20
01/91DA: A9 05 00     LDA #$0005
01/91DD: 85 45        STA $45
01/91DF: A4 41        LDY $41         ; zero
01/91E1: BF 0A 92 01  LDA $01920A,X
01/91E5: 18           CLC 
01/91E6: 6D 71 1A     ADC $1A71
01/91E9: 99 02 FE     STA $FE02,Y
01/91EC: 99 16 FE     STA $FE16,Y
01/91EF: 98           TYA 
01/91F0: 4A           LSR 
01/91F1: 4A           LSR 
01/91F2: 99 00 FE     STA $FE00,Y
01/91F5: 99 14 FE     STA $FE14,Y
01/91F8: C8           INY 
01/91F9: C8           INY 
01/91FA: C8           INY 
01/91FB: C8           INY 
01/91FC: E8           INX 
01/91FD: E8           INX 
01/91FE: C6 45        DEC $45
01/9200: D0 DF        BNE $91E1
01/9202: E2 20        SEP #$20
01/9204: A9 0A        LDA #$0A
01/9206: 8D 73 1A     STA $1A73
01/9209: 60           RTS 

; character portrait offsets ???
01/920A: 00 1C
01/920C: 00 00
01/920E: 00 38
01/9210: 18 0C
01/9212: 18 2C

01/9214: 18 1C
01/9216: 18 00
01/9218: 18 38
01/921A: 00 0C
01/921C: 00 2C

; [  ]

01/921E: AD 73 1A     LDA $1A73
01/9221: F0 04        BEQ $9227
01/9223: CE 73 1A     DEC $1A73
01/9226: 60           RTS 
01/9227: A9 0A        LDA #$0A
01/9229: 8D 73 1A     STA $1A73
01/922C: A9 FF        LDA #$FF
01/922E: 4D 75 1A     EOR $1A75
01/9231: 8D 75 1A     STA $1A75
01/9234: F0 05        BEQ $923B
01/9236: A0 00 FE     LDY #$FE00
01/9239: 80 03        BRA $923E
01/923B: A0 14 FE     LDY #$FE14
01/923E: A2 05 00     LDX #$0005
01/9241: C2 20        REP #$20
01/9243: B9 00 00     LDA $0000,Y
01/9246: 85 1D        STA $1D
01/9248: B9 02 00     LDA $0002,Y
01/924B: 85 1F        STA $1F
01/924D: E2 20        SEP #$20
01/924F: DA           PHX 
01/9250: 5A           PHY 
01/9251: 20 64 90     JSR $9064       ; draw character
01/9254: 7A           PLY 
01/9255: FA           PLX 
01/9256: C8           INY 
01/9257: C8           INY 
01/9258: C8           INY 
01/9259: C8           INY 
01/925A: CA           DEX 
01/925B: D0 E4        BNE $9241
01/925D: 60           RTS 

; [ load portraits ]

01/925E: 7B           TDC 
01/925F: 20 8A 81     JSR $818A       ; wait for vblank
01/9262: 20 73 92     JSR $9273       ; transfer portrait graphics to vram
01/9265: 20 2E 93     JSR $932E       ; load portrait palette
01/9268: 1A           INC 
01/9269: C9 05        CMP #$05
01/926B: D0 F2        BNE $925F
01/926D: 20 8A 81     JSR $818A       ; wait for vblank
01/9270: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [ transfer portrait graphics to vram ]

01/9273: 48           PHA 
01/9274: 85 45        STA $45
01/9276: 64 46        STZ $46
01/9278: 20 19 A9     JSR $A919       ; get character id
01/927B: D0 02        BNE $927F
01/927D: 68           PLA 
01/927E: 60           RTS 
01/927F: 48           PHA 
01/9280: BD 01 00     LDA $0001,X
01/9283: 29 0F        AND #$0F
01/9285: 8D C0 1B     STA $1BC0
01/9288: 9C BF 1B     STZ $1BBF
01/928B: BD 03 00     LDA $0003,X
01/928E: 29 38        AND #$38
01/9290: F0 30        BEQ $92C2
01/9292: 4A           LSR 
01/9293: 4A           LSR 
01/9294: 20 B4 87     JSR $87B4       ; tax
01/9297: C2 20        REP #$20
01/9299: BF BD FC 1E  LDA $1EFCBD,X
01/929D: A8           TAY 
01/929E: E2 20        SEP #$20
01/92A0: A5 45        LDA $45
01/92A2: 0A           ASL 
01/92A3: 85 43        STA $43
01/92A5: A6 43        LDX $43
01/92A7: A9 80        LDA #$80
01/92A9: 8F 15 21 00  STA $002115
01/92AD: C2 20        REP #$20
01/92AF: BF 24 93 01  LDA $019324,X   ; portrait graphics locations (vram)
01/92B3: 8F 16 21 00  STA $002116
01/92B7: E2 20        SEP #$20
01/92B9: 68           PLA 
01/92BA: 0B           PHD 
01/92BB: A2 00 21     LDX #$2100
01/92BE: DA           PHX 
01/92BF: 2B           PLD 
01/92C0: 80 2B        BRA $92ED
01/92C2: 68           PLA 
01/92C3: 0B           PHD 
01/92C4: A2 00 21     LDX #$2100
01/92C7: DA           PHX 
01/92C8: 2B           PLD 
01/92C9: 3A           DEC 
01/92CA: 0A           ASL 
01/92CB: 8D 43 01     STA $0143
01/92CE: A9 80        LDA #$80
01/92D0: 85 15        STA $15
01/92D2: C2 20        REP #$20
01/92D4: AD BF 1B     LDA $1BBF
01/92D7: 4A           LSR 
01/92D8: 18           CLC 
01/92D9: 6D BF 1B     ADC $1BBF
01/92DC: 69 C0 D3     ADC #$D3C0
01/92DF: A8           TAY 
01/92E0: AD 45 01     LDA $0145
01/92E3: 0A           ASL 
01/92E4: AA           TAX 
01/92E5: BF 24 93 01  LDA $019324,X   ; portrait graphics locations (vram)
01/92E9: 85 16        STA $16
01/92EB: E2 20        SEP #$20
01/92ED: 8B           PHB 
01/92EE: A9 1D        LDA #$1D
01/92F0: 48           PHA 
01/92F1: AB           PLB 
01/92F2: A9 10        LDA #$10
01/92F4: 20 FB 92     JSR $92FB       ; transfer 3bpp graphics to vram
01/92F7: AB           PLB 
01/92F8: 2B           PLD 
01/92F9: 68           PLA 
01/92FA: 60           RTS 

; [ transfer 3bpp graphics to vram ]

01/92FB: 8D 45 01     STA $0145
01/92FE: A2 08 00     LDX #$0008
01/9301: B9 00 00     LDA $0000,Y
01/9304: 85 18        STA $18
01/9306: B9 01 00     LDA $0001,Y
01/9309: 85 19        STA $19
01/930B: C8           INY 
01/930C: C8           INY 
01/930D: CA           DEX 
01/930E: D0 F1        BNE $9301
01/9310: A2 08 00     LDX #$0008
01/9313: B9 00 00     LDA $0000,Y
01/9316: 85 18        STA $18
01/9318: 64 19        STZ $19
01/931A: C8           INY 
01/931B: CA           DEX 
01/931C: D0 F5        BNE $9313
01/931E: CE 45 01     DEC $0145
01/9321: D0 DB        BNE $92FE
01/9323: 60           RTS 

; portrait graphics locations (vram)
01/9324: 4200 4300 4400 4500 4600

; [ load portrait palette ]

01/932E: 48           PHA 
01/932F: 85 45        STA $45
01/9331: 64 46        STZ $46
01/9333: 20 19 A9     JSR $A919       ; get character id
01/9336: D0 02        BNE $933A
01/9338: 68           PLA 
01/9339: 60           RTS 
01/933A: BD 01 00     LDA $0001,X
01/933D: 29 0F        AND #$0F
01/933F: 85 43        STA $43
01/9341: C2 20        REP #$20
01/9343: A5 43        LDA $43
01/9345: 0A           ASL 
01/9346: 0A           ASL 
01/9347: 0A           ASL 
01/9348: 0A           ASL 
01/9349: 69 D0 86     ADC #$86D0
01/934C: AA           TAX 
01/934D: A5 45        LDA $45
01/934F: 0A           ASL 
01/9350: 0A           ASL 
01/9351: 0A           ASL 
01/9352: 0A           ASL 
01/9353: 0A           ASL 
01/9354: 69 60 A1     ADC #$A160
01/9357: A8           TAY 
01/9358: A9 0F 00     LDA #$000F
01/935B: 54 7E 0D     MVN $7E,$0D
01/935E: E2 20        SEP #$20
01/9360: 68           PLA 
01/9361: 60           RTS 

; [  ]

01/9362: CE 73 1A     DEC $1A73
01/9365: D0 0D        BNE $9374
01/9367: A9 0A        LDA #$0A
01/9369: 8D 73 1A     STA $1A73
01/936C: AD 75 1A     LDA $1A75
01/936F: 49 FF        EOR #$FF
01/9371: 8D 75 1A     STA $1A75
01/9374: C2 20        REP #$20
01/9376: 8A           TXA 
01/9377: 85 63        STA $63
01/9379: 18           CLC 
01/937A: 69 18 00     ADC #$0018
01/937D: 85 65        STA $65
01/937F: 69 18 00     ADC #$0018
01/9382: 85 67        STA $67
01/9384: 69 18 00     ADC #$0018
01/9387: 85 69        STA $69
01/9389: 69 18 00     ADC #$0018
01/938C: 85 6B        STA $6B
01/938E: E2 20        SEP #$20
01/9390: 7B           TDC 
01/9391: 85 1D        STA $1D
01/9393: AD 4B 1B     LDA $1B4B
01/9396: 85 1E        STA $1E
01/9398: AD 75 1A     LDA $1A75
01/939B: D0 05        BNE $93A2
01/939D: AD 4C 1B     LDA $1B4C
01/93A0: 85 1E        STA $1E
01/93A2: A6 63        LDX $63
01/93A4: 86 1F        STX $1F
01/93A6: 20 64 90     JSR $9064       ; draw character
01/93A9: A9 01        LDA #$01
01/93AB: 85 1D        STA $1D
01/93AD: AD 4D 1B     LDA $1B4D
01/93B0: 85 1E        STA $1E
01/93B2: AD 75 1A     LDA $1A75
01/93B5: D0 05        BNE $93BC
01/93B7: AD 4E 1B     LDA $1B4E
01/93BA: 85 1E        STA $1E
01/93BC: A6 65        LDX $65
01/93BE: 86 1F        STX $1F
01/93C0: 20 64 90     JSR $9064       ; draw character
01/93C3: A9 02        LDA #$02
01/93C5: 85 1D        STA $1D
01/93C7: AD 4F 1B     LDA $1B4F
01/93CA: 85 1E        STA $1E
01/93CC: AD 75 1A     LDA $1A75
01/93CF: D0 05        BNE $93D6
01/93D1: AD 50 1B     LDA $1B50
01/93D4: 85 1E        STA $1E
01/93D6: A6 67        LDX $67
01/93D8: 86 1F        STX $1F
01/93DA: 20 64 90     JSR $9064       ; draw character
01/93DD: A9 03        LDA #$03
01/93DF: 85 1D        STA $1D
01/93E1: AD 51 1B     LDA $1B51
01/93E4: 85 1E        STA $1E
01/93E6: AD 75 1A     LDA $1A75
01/93E9: D0 05        BNE $93F0
01/93EB: AD 52 1B     LDA $1B52
01/93EE: 85 1E        STA $1E
01/93F0: A6 69        LDX $69
01/93F2: 86 1F        STX $1F
01/93F4: 20 64 90     JSR $9064       ; draw character
01/93F7: A9 04        LDA #$04
01/93F9: 85 1D        STA $1D
01/93FB: AD 53 1B     LDA $1B53
01/93FE: 85 1E        STA $1E
01/9400: AD 75 1A     LDA $1A75
01/9403: D0 05        BNE $940A
01/9405: AD 54 1B     LDA $1B54
01/9408: 85 1E        STA $1E
01/940A: A6 6B        LDX $6B
01/940C: 86 1F        STX $1F
01/940E: 4C 64 90     JMP $9064       ; draw character

; [ transfer screen buffer to vram (all) ]

01/9411: 20 23 94     JSR $9423
01/9414: 20 30 94     JSR $9430
01/9417: 20 3D 94     JSR $943D
01/941A: 4C 4A 94     JMP $944A

; [ transfer screen buffer to vram ]

; clear bg2 screen buffer in vram
01/941D: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
; transfer bg2 screen buffer to vram
01/9420: 20 8A 81     JSR $818A       ; wait for vblank
01/9423: DA           PHX 
01/9424: 5A           PHY 
01/9425: A2 00 68     LDX #$6800
01/9428: A0 00 A6     LDY #$A600
01/942B: 80 25        BRA $9452
; transfer bg1 screen buffer to vram
01/942D: 20 8A 81     JSR $818A       ; wait for vblank
01/9430: DA           PHX 
01/9431: 5A           PHY 
01/9432: A2 00 60     LDX #$6000
01/9435: A0 00 B6     LDY #$B600
01/9438: 80 18        BRA $9452
; transfer bg4 screen buffer to vram
01/943A: 20 8A 81     JSR $818A       ; wait for vblank
01/943D: DA           PHX 
01/943E: 5A           PHY 
01/943F: A2 00 78     LDX #$7800
01/9442: A0 00 C6     LDY #$C600
01/9445: 80 0B        BRA $9452
; transfer bg3 screen buffer to vram
01/9447: 20 8A 81     JSR $818A       ; wait for vblank
01/944A: DA           PHX 
01/944B: 5A           PHY 
01/944C: A2 00 70     LDX #$7000
01/944F: A0 00 D6     LDY #$D600
01/9452: 86 1D        STX $1D
01/9454: 84 1F        STY $1F
01/9456: A9 7E        LDA #$7E
01/9458: 85 21        STA $21
01/945A: A6 DE        LDX $DE
01/945C: 86 22        STX $22
01/945E: 20 78 80     JSR $8078       ; transfer data to vram
01/9461: 7A           PLY 
01/9462: FA           PLX 
01/9463: 60           RTS 

; [ fade in ]

01/9464: 20 8A 81     JSR $818A       ; wait for vblank
01/9467: A5 88        LDA $88
01/9469: 29 7F        AND #$7F
01/946B: 8F 00 21 00  STA $002100     ; set screen brightness
01/946F: 48           PHA 
01/9470: 20 B6 82     JSR $82B6       ; update controller
01/9473: 68           PLA 
01/9474: 1A           INC 
01/9475: 85 88        STA $88
01/9477: C9 10        CMP #$10
01/9479: 90 E9        BCC $9464
01/947B: C6 88        DEC $88
01/947D: 60           RTS 

; [ fade out ]

01/947E: 20 8A 81     JSR $818A       ; wait for vblank
01/9481: A5 88        LDA $88
01/9483: 30 16        BMI $949B       ; branch if screen is off
01/9485: 8F 00 21 00  STA $002100     ; set screen brightness
01/9489: 48           PHA 
01/948A: 20 B6 82     JSR $82B6       ; update controller
01/948D: 68           PLA 
01/948E: 3A           DEC             ; decrement screen brightness
01/948F: 85 88        STA $88
01/9491: 10 EB        BPL $947E
01/9493: A9 80        LDA #$80
01/9495: 8F 00 21 00  STA $002100     ; screen off
01/9499: 85 88        STA $88
01/949B: 60           RTS 

; [  ]

01/949C: 20 A9 94     JSR $94A9
01/949F: 80 03        BRA $94A4
01/94A1: 20 8A 81     JSR $818A       ; wait for vblank
01/94A4: 22 0C FD 14  JSL $14FD0C
01/94A8: 60           RTS 

; [  ]

01/94A9: DA           PHX 
01/94AA: 0B           PHD 
01/94AB: A2 00 01     LDX #$0100
01/94AE: DA           PHX 
01/94AF: 2B           PLD 
01/94B0: C2 20        REP #$20
01/94B2: A9 00 00     LDA #$0000
01/94B5: A0 1C 00     LDY #$001C
01/94B8: A6 41        LDX $41         ; zero
01/94BA: 95 89        STA $89,X
01/94BC: E8           INX 
01/94BD: E8           INX 
01/94BE: 88           DEY 
01/94BF: D0 F9        BNE $94BA
01/94C1: E2 20        SEP #$20
01/94C3: 2B           PLD 
01/94C4: FA           PLX 
01/94C5: 60           RTS 

; [  ]

01/94C6: C2 20        REP #$20
01/94C8: A9 FF 00     LDA #$00FF
01/94CB: A2 00 A0     LDX #$A000
01/94CE: A0 00 A2     LDY #$A200
01/94D1: 54 7E 7E     MVN $7E,$7E
01/94D4: E2 20        SEP #$20
01/94D6: 60           RTS 

; [  ]

01/94D7: C2 20        REP #$20
01/94D9: A9 FF 00     LDA #$00FF
01/94DC: A2 00 A0     LDX #$A000
01/94DF: A0 00 A4     LDY #$A400
01/94E2: 54 7E 7E     MVN $7E,$7E
01/94E5: E2 20        SEP #$20
01/94E7: 60           RTS 

; [  ]

01/94E8: C2 20        REP #$20
01/94EA: A9 FF 00     LDA #$00FF
01/94ED: A2 00 A2     LDX #$A200
01/94F0: A0 00 A0     LDY #$A000
01/94F3: 54 7E 7E     MVN $7E,$7E
01/94F6: E2 20        SEP #$20
01/94F8: 60           RTS 

; [  ]

01/94F9: C2 20        REP #$20
01/94FB: A9 FF 00     LDA #$00FF
01/94FE: A2 00 A4     LDX #$A400
01/9501: A0 00 A0     LDY #$A000
01/9504: 54 7E 7E     MVN $7E,$7E
01/9507: E2 20        SEP #$20
01/9509: 60           RTS 

01/950A: 40 00 C0 80

; [  ]

01/950E: 3A           DEC 
01/950F: 20 B4 87     JSR $87B4       ; tax
01/9512: BF 0A 95 01  LDA $01950A,X
01/9516: 85 43        STA $43
01/9518: A6 43        LDX $43
01/951A: 60           RTS 

; [  ]

01/951B: 48           PHA 
01/951C: 20 0E 95     JSR $950E
01/951F: A9 20        LDA #$20
01/9521: 85 1D        STA $1D
01/9523: 7B           TDC 
01/9524: 9D 00 A0     STA $A000,X
01/9527: E8           INX 
01/9528: C6 1D        DEC $1D
01/952A: D0 F8        BNE $9524
01/952C: 68           PLA 
01/952D: 60           RTS 

; [  ]

01/952E: A5 D2        LDA $D2
01/9530: D0 01        BNE $9533
01/9532: 60           RTS 
01/9533: A5 BE        LDA $BE
01/9535: 10 13        BPL $954A
01/9537: 29 7F        AND #$7F
01/9539: 85 59        STA $59
01/953B: 18           CLC 
01/953C: A5 BD        LDA $BD
01/953E: 65 B9        ADC $B9
01/9540: 85 B9        STA $B9
01/9542: A5 BA        LDA $BA
01/9544: 65 59        ADC $59
01/9546: 85 BA        STA $BA
01/9548: 80 0D        BRA $9557
01/954A: A5 B9        LDA $B9
01/954C: 38           SEC 
01/954D: E5 BD        SBC $BD
01/954F: 85 B9        STA $B9
01/9551: A5 BA        LDA $BA
01/9553: E5 BE        SBC $BE
01/9555: 85 BA        STA $BA
01/9557: A5 C0        LDA $C0
01/9559: 10 13        BPL $956E
01/955B: 29 7F        AND #$7F
01/955D: 85 59        STA $59
01/955F: 18           CLC 
01/9560: A5 BF        LDA $BF
01/9562: 65 BB        ADC $BB
01/9564: 85 BB        STA $BB
01/9566: A5 BC        LDA $BC
01/9568: 65 59        ADC $59
01/956A: 85 BC        STA $BC
01/956C: 80 0D        BRA $957B
01/956E: A5 BB        LDA $BB
01/9570: 38           SEC 
01/9571: E5 BF        SBC $BF
01/9573: 85 BB        STA $BB
01/9575: A5 BC        LDA $BC
01/9577: E5 C0        SBC $C0
01/9579: 85 BC        STA $BC
01/957B: A5 BC        LDA $BC
01/957D: EB           XBA 
01/957E: A5 BA        LDA $BA
01/9580: A8           TAY 
01/9581: A5 D3        LDA $D3
01/9583: 20 6E 8E     JSR $8E6E       ; draw portrait
01/9586: C6 D2        DEC $D2
01/9588: 60           RTS 

; [  ]

01/9589: A5 E8        LDA $E8
01/958B: 20 01 90     JSR $9001       ; get pointer to character properties
01/958E: BD 03 00     LDA $0003,X
01/9591: 60           RTS 

; --------------------------------------------------------------------------

; [ game load menu ]

01/9592: 8B           PHB 
01/9593: 0B           PHD 
01/9594: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/9597: A9 7E        LDA #$7E
01/9599: 48           PHA 
01/959A: AB           PLB 
01/959B: 9C 9A 1B     STZ $1B9A
01/959E: A2 E4 1B     LDX #$1BE4
01/95A1: EC 5F 1A     CPX $1A5F
01/95A4: F0 0C        BEQ $95B2
01/95A6: 8E 5F 1A     STX $1A5F
01/95A9: 9C 3C 1A     STZ $1A3C
01/95AC: 20 24 99     JSR $9924
01/95AF: 20 BB 82     JSR $82BB       ; init controller
01/95B2: 20 82 99     JSR $9982
01/95B5: 20 E9 9A     JSR $9AE9
01/95B8: B0 06        BCS $95C0
01/95BA: 20 F8 95     JSR $95F8
01/95BD: 20 CC 95     JSR $95CC
01/95C0: 20 3F 87     JSR $873F       ; restore dialogue window graphics
01/95C3: 7B           TDC 
01/95C4: EB           XBA 
01/95C5: AF FB 17 00  LDA $0017FB
01/95C9: 2B           PLD 
01/95CA: AB           PLB 
01/95CB: 60           RTS 

; [  ]

01/95CC: 64 48        STZ $48
01/95CE: A5 48        LDA $48
01/95D0: 20 A0 B9     JSR $B9A0
01/95D3: BD 00 00     LDA $0000,X
01/95D6: 29 3F        AND #$3F
01/95D8: D0 08        BNE $95E2
01/95DA: E6 48        INC $48
01/95DC: A5 48        LDA $48
01/95DE: C9 05        CMP #$05
01/95E0: D0 EC        BNE $95CE
01/95E2: A5 48        LDA $48
01/95E4: 85 E7        STA $E7
01/95E6: 8D 3E 1B     STA $1B3E
01/95E9: 8D 8A 1B     STA $1B8A
01/95EC: A2 D8 FF     LDX #$FFD8
01/95EF: 8E A5 1B     STX $1BA5
01/95F2: AD A9 16     LDA $16A9
01/95F5: 85 1C        STA $1C
01/95F7: 60           RTS 

; [  ]

01/95F8: A9 15        LDA #$15        ; song $15 (the prelude)
01/95FA: 8D 01 1E     STA $1E01
01/95FD: A9 01        LDA #$01        ; play song
01/95FF: 8D 00 1E     STA $1E00
01/9602: 22 04 80 04  JSL $048004     ; execute sound command
01/9606: 20 7D 8C     JSR $8C7D       ; init menu
01/9609: A9 30        LDA #$30        ; sprite layer priority: 3
01/960B: 85 C1        STA $C1
01/960D: 20 82 99     JSR $9982
01/9610: 9C 47 1B     STZ $1B47
01/9613: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/9616: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/9619: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/961C: AD 3C 1A     LDA $1A3C
01/961F: 20 7F 97     JSR $977F
01/9622: 20 A0 8D     JSR $8DA0       ; load character graphics
01/9625: 20 C9 98     JSR $98C9
01/9628: 20 DE 96     JSR $96DE
01/962B: 20 BA 84     JSR $84BA       ; select bg2
01/962E: A0 C9 DF     LDY #$DFC9
01/9631: 20 01 83     JSR $8301       ; draw positioned text
01/9634: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/9637: 20 B8 99     JSR $99B8
01/963A: 20 59 96     JSR $9659       ; get player input (select save slot)
01/963D: AD 3C 1A     LDA $1A3C       ; selected save slot
01/9640: D0 03        BNE $9645
; new game
01/9642: 4C 0E 99     JMP $990E       ; init save slot
01/9645: 20 D3 97     JSR $97D3       ; confirm selected save slot
01/9648: 90 09        BCC $9653
; yes
01/964A: 20 F2 D5     JSR $D5F2
01/964D: 20 6C D4     JSR $D46C       ; set stereo/mono
01/9650: 4C 7E 94     JMP $947E       ; fade out
; no
01/9653: 20 7E 94     JSR $947E       ; fade out
01/9656: 4C 13 96     JMP $9613

; [ get player input (select save slot) ]

01/9659: AD 3C 1A     LDA $1A3C       ; validate selected save slot
01/965C: C9 05        CMP #$05
01/965E: 90 03        BCC $9663
01/9660: 9C 3C 1A     STZ $1A3C
01/9663: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9666: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/9669: A9 1F        LDA #$1F
01/966B: 8F 2C 21 00  STA $00212C     ; show sprites
01/966F: EE A7 16     INC $16A7
01/9672: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/9675: A5 00        LDA $00
01/9677: 29 80        AND #$80
01/9679: F0 02        BEQ $967D       ; branch if A button is not pressed
01/967B: 38           SEC 
01/967C: 60           RTS 
; up button
01/967D: A5 01        LDA $01
01/967F: 29 08        AND #$08
01/9681: F0 25        BEQ $96A8
01/9683: A9 0F        LDA #$0F
01/9685: 8F 2C 21 00  STA $00212C     ; hide sprites
01/9689: AD 47 1B     LDA $1B47
01/968C: F0 08        BEQ $9696
01/968E: AD 3C 1A     LDA $1A3C
01/9691: 3A           DEC 
01/9692: F0 08        BEQ $969C
01/9694: 80 08        BRA $969E
01/9696: AD 3C 1A     LDA $1A3C
01/9699: 3A           DEC 
01/969A: 10 02        BPL $969E
01/969C: A9 04        LDA #$04
01/969E: 8D 3C 1A     STA $1A3C
01/96A1: 20 43 99     JSR $9943
01/96A4: 90 E3        BCC $9689
01/96A6: 80 1F        BRA $96C7
; down button
01/96A8: A5 01        LDA $01
01/96AA: 29 04        AND #$04
01/96AC: F0 25        BEQ $96D3
01/96AE: A9 0F        LDA #$0F
01/96B0: 8F 2C 21 00  STA $00212C     ; hide sprites
01/96B4: AD 3C 1A     LDA $1A3C
01/96B7: 1A           INC 
01/96B8: C9 05        CMP #$05
01/96BA: D0 03        BNE $96BF
01/96BC: AD 47 1B     LDA $1B47
01/96BF: 8D 3C 1A     STA $1A3C
01/96C2: 20 43 99     JSR $9943
01/96C5: 90 ED        BCC $96B4
01/96C7: AD 3C 1A     LDA $1A3C
01/96CA: 20 7F 97     JSR $977F
01/96CD: 20 A0 8D     JSR $8DA0       ; load character graphics
01/96D0: 20 C9 98     JSR $98C9
; B button
01/96D3: A5 01        LDA $01
01/96D5: 29 80        AND #$80
01/96D7: F0 02        BEQ $96DB
01/96D9: 18           CLC 
01/96DA: 60           RTS 
01/96DB: 4C 59 96     JMP $9659

; [  ]

01/96DE: 20 49 87     JSR $8749       ; update window color
01/96E1: C2 20        REP #$20
01/96E3: AF AA 06 70  LDA $7006AA
01/96E7: 8D 42 A0     STA $A042
01/96EA: 8D 4A A0     STA $A04A
01/96ED: AF AA 0E 70  LDA $700EAA
01/96F1: 8D 02 A0     STA $A002
01/96F4: 8D 0A A0     STA $A00A
01/96F7: AF AA 16 70  LDA $7016AA
01/96FB: 8D C2 A0     STA $A0C2
01/96FE: 8D CA A0     STA $A0CA
01/9701: AF AA 1E 70  LDA $701EAA
01/9705: 8D 82 A0     STA $A082
01/9708: 8D 8A A0     STA $A08A
01/970B: E2 20        SEP #$20
01/970D: 7B           TDC 
01/970E: 20 33 9A     JSR $9A33
01/9711: 20 33 9A     JSR $9A33
01/9714: 20 33 9A     JSR $9A33
01/9717: 20 33 9A     JSR $9A33
01/971A: A2 00 40     LDX #$4000
01/971D: 8E 22 A0     STX $A022
01/9720: A5 34        LDA $34
01/9722: 48           PHA 
01/9723: 20 BA 84     JSR $84BA       ; select bg2
01/9726: A9 30        LDA #$30
01/9728: 85 34        STA $34
01/972A: A0 C5 DF     LDY #$DFC5
01/972D: 20 D9 80     JSR $80D9       ; draw window
01/9730: 68           PLA 
01/9731: 85 34        STA $34
01/9733: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [  ]

01/9736: 5A           PHY 
01/9737: 85 73        STA $73
01/9739: 86 74        STX $74
01/973B: 8B           PHB 
01/973C: A9 7E        LDA #$7E
01/973E: 48           PHA 
01/973F: AB           PLB 
01/9740: 20 E8 8B     JSR $8BE8       ; divide by 60
01/9743: 20 E8 8B     JSR $8BE8       ; divide by 60
01/9746: A6 73        LDX $73
01/9748: A5 1D        LDA $1D
01/974A: 20 BD 81     JSR $81BD       ; convert hex to decimal (2 digits)
01/974D: C9 FF        CMP #$FF
01/974F: D0 02        BNE $9753
01/9751: A9 80        LDA #$80
01/9753: 99 0A 00     STA $000A,Y
01/9756: EB           XBA 
01/9757: 99 0C 00     STA $000C,Y
01/975A: C2 20        REP #$20
01/975C: A5 73        LDA $73
01/975E: E2 20        SEP #$20
01/9760: 20 D6 81     JSR $81D6       ; convert hex to decimal (4 digits)
01/9763: A5 5A        LDA $5A
01/9765: 99 00 00     STA $0000,Y
01/9768: A5 5B        LDA $5B
01/976A: 99 02 00     STA $0002,Y
01/976D: A5 5D        LDA $5D
01/976F: 99 04 00     STA $0004,Y
01/9772: A5 5E        LDA $5E
01/9774: 99 06 00     STA $0006,Y
01/9777: A9 C8        LDA #$C8
01/9779: 99 08 00     STA $0008,Y
01/977C: AB           PLB 
01/977D: 7A           PLY 
01/977E: 60           RTS 

; [  ]

01/977F: 3A           DEC 
01/9780: 30 19        BMI $979B
01/9782: 0A           ASL 
01/9783: 0A           ASL 
01/9784: 0A           ASL 
01/9785: 85 46        STA $46
01/9787: 64 45        STZ $45
01/9789: 8B           PHB 
01/978A: C2 20        REP #$20
01/978C: A6 45        LDX $45
01/978E: A0 00 10     LDY #$1000
01/9791: A9 FF 07     LDA #$07FF
01/9794: 54 00 70     MVN $00,$70
01/9797: E2 20        SEP #$20
01/9799: AB           PLB 
01/979A: 60           RTS 
01/979B: 8B           PHB 
01/979C: C2 20        REP #$20
01/979E: A2 10 A7     LDX #$A710
01/97A1: A0 00 15     LDY #$1500
01/97A4: A9 53 00     LDA #$0053
01/97A7: 54 00 0F     MVN $00,$0F
01/97AA: E2 20        SEP #$20
01/97AC: AB           PLB 
01/97AD: 8B           PHB 
01/97AE: 0B           PHD 
01/97AF: 7B           TDC 
01/97B0: 48           PHA 
01/97B1: AB           PLB 
01/97B2: EB           XBA 
01/97B3: A2 00 06     LDX #$0600
01/97B6: DA           PHX 
01/97B7: 2B           PLD 
01/97B8: 22 BC FF 00  JSL $00FFBC     ; init character properties
01/97BC: 2B           PLD 
01/97BD: AB           PLB 
01/97BE: A6 41        LDX $41         ; zero
01/97C0: 8E 07 10     STX $1007
01/97C3: 8E 09 10     STX $1009
01/97C6: 9C 40 10     STZ $1040
01/97C9: 9C 80 10     STZ $1080
01/97CC: 9C C0 10     STZ $10C0
01/97CF: 9C 00 11     STZ $1100
01/97D2: 60           RTS 

; [ confirm selected save slot ]

01/97D3: 20 7E 94     JSR $947E       ; fade out
01/97D6: 20 9C 94     JSR $949C
01/97D9: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/97DC: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/97DF: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/97E2: 20 70 84     JSR $8470       ; select bg3
01/97E5: 20 5E 92     JSR $925E       ; load portraits
01/97E8: A2 E4 1B     LDX #$1BE4
01/97EB: EC FE 17     CPX $17FE       ; check sram fixed value
01/97EE: D0 05        BNE $97F5
01/97F0: 20 97 88     JSR $8897       ; draw character blocks and portraits
01/97F3: 80 12        BRA $9807
01/97F5: 20 70 84     JSR $8470       ; select bg3
01/97F8: A0 61 DB     LDY #$DB61
01/97FB: 20 D9 80     JSR $80D9       ; draw window
01/97FE: A2 94 03     LDX #$0394
01/9801: A0 0E E0     LDY #$E00E
01/9804: 20 CD 82     JSR $82CD       ; draw text
01/9807: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/980A: 20 88 84     JSR $8488       ; select bg4
01/980D: A0 E0 DF     LDY #$DFE0
01/9810: 20 D9 80     JSR $80D9       ; draw window
01/9813: A0 DC DF     LDY #$DFDC
01/9816: 20 D9 80     JSR $80D9       ; draw window
01/9819: AD 47 1B     LDA $1B47
01/981C: F0 08        BEQ $9826
01/981E: A0 35 E0     LDY #$E035
01/9821: 20 01 83     JSR $8301       ; draw positioned text
01/9824: 80 06        BRA $982C
01/9826: A0 E8 DF     LDY #$DFE8
01/9829: 20 01 83     JSR $8301       ; draw positioned text
01/982C: A0 FA DF     LDY #$DFFA
01/982F: 20 01 83     JSR $8301       ; draw positioned text
01/9832: AD A4 16     LDA $16A4
01/9835: AE A5 16     LDX $16A5
01/9838: A0 2E CB     LDY #$CB2E
01/983B: 20 36 97     JSR $9736
01/983E: A0 05 E0     LDY #$E005
01/9841: 20 01 83     JSR $8301       ; draw positioned text
01/9844: 20 A2 84     JSR $84A2       ; select bg1
01/9847: A0 E4 DF     LDY #$DFE4
01/984A: 20 D9 80     JSR $80D9       ; draw window
01/984D: A0 0C DF     LDY #$DF0C
01/9850: A2 78 06     LDX #$0678
01/9853: 20 CD 82     JSR $82CD       ; draw text
01/9856: A0 2C 06     LDY #$062C
01/9859: AD A2 16     LDA $16A2
01/985C: AE A0 16     LDX $16A0
01/985F: 20 A6 8F     JSR $8FA6       ; draw number text (7 digits)
01/9862: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/9865: 20 49 87     JSR $8749       ; update window color
01/9868: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/986B: 20 64 94     JSR $9464       ; fade in
01/986E: 9C 46 1B     STZ $1B46
01/9871: AD 46 1B     LDA $1B46
01/9874: F0 04        BEQ $987A
01/9876: A9 40        LDA #$40
01/9878: 80 02        BRA $987C
01/987A: A9 30        LDA #$30
01/987C: 85 46        STA $46
01/987E: A9 B8        LDA #$B8
01/9880: 85 45        STA $45
01/9882: 20 81 82     JSR $8281       ; draw cursor sprite
01/9885: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9888: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/988B: A5 01        LDA $01
01/988D: 29 0C        AND #$0C
01/988F: F0 09        BEQ $989A
01/9891: AD 46 1B     LDA $1B46
01/9894: 1A           INC 
01/9895: 29 01        AND #$01
01/9897: 8D 46 1B     STA $1B46
01/989A: A5 00        LDA $00
01/989C: 29 80        AND #$80
01/989E: F0 08        BEQ $98A8
01/98A0: 38           SEC 
01/98A1: AD 46 1B     LDA $1B46
01/98A4: F0 01        BEQ $98A7
01/98A6: 18           CLC 
01/98A7: 60           RTS 
01/98A8: A5 01        LDA $01
01/98AA: 29 80        AND #$80
01/98AC: F0 02        BEQ $98B0
01/98AE: 18           CLC 
01/98AF: 60           RTS 
01/98B0: 4C 71 98     JMP $9871
01/98B3: C2 20        REP #$20
01/98B5: A2 28 FE     LDX #$FE28      ; character palette buffer
01/98B8: A0 60 A1     LDY #$A160
01/98BB: A9 9F 00     LDA #$009F
01/98BE: 54 7E 7E     MVN $7E,$7E
01/98C1: E2 20        SEP #$20
01/98C3: 20 8A 81     JSR $818A       ; wait for vblank
01/98C6: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [  ]

01/98C9: A9 30        LDA #$30        ; sprite layer priority: 3
01/98CB: 85 C1        STA $C1
01/98CD: 20 B3 98     JSR $98B3
01/98D0: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/98D3: 7B           TDC 
01/98D4: 85 1D        STA $1D
01/98D6: 7B           TDC 
01/98D7: 85 1E        STA $1E
01/98D9: AD 3C 1A     LDA $1A3C
01/98DC: 0A           ASL 
01/98DD: 20 B4 87     JSR $87B4       ; tax
01/98E0: C2 20        REP #$20
01/98E2: BF 04 99 01  LDA $019904,X
01/98E6: 85 1F        STA $1F
01/98E8: E2 20        SEP #$20
01/98EA: A9 05        LDA #$05
01/98EC: 85 5A        STA $5A
01/98EE: 20 64 90     JSR $9064       ; draw character
01/98F1: C2 20        REP #$20
01/98F3: A9 18 00     LDA #$0018
01/98F6: 18           CLC 
01/98F7: 65 1F        ADC $1F
01/98F9: 85 1F        STA $1F
01/98FB: E2 20        SEP #$20
01/98FD: E6 1D        INC $1D
01/98FF: C6 5A        DEC $5A
01/9901: D0 EB        BNE $98EE
01/9903: 60           RTS 

; character sprite offsets (load/save/namingway menu)
01/9904: 4E 04 78 28 78 58 78 88 78 B8

; [ init save slot ]

01/990E: 20 7E 94     JSR $947E       ; fade out
01/9911: 20 17 9B     JSR $9B17
01/9914: 20 6C D4     JSR $D46C       ; set stereo/mono
01/9917: C2 20        REP #$20
01/9919: A9 E4 1B     LDA #$1BE4      ; init sram fixed value
01/991C: 8D FE 17     STA $17FE
01/991F: E2 20        SEP #$20
01/9921: 9C FB 17     STZ $17FB
01/9924: C2 20        REP #$20
01/9926: A9 00 01     LDA #$0100
01/9929: 8D 37 1A     STA $1A37
01/992C: 8D AE 16     STA $16AE
01/992F: A9 02 00     LDA #$0002
01/9932: 8D B0 16     STA $16B0
01/9935: 8D 39 1A     STA $1A39
01/9938: E2 20        SEP #$20
01/993A: A9 00        LDA #$00
01/993C: 8D 3B 1A     STA $1A3B
01/993F: 8D B2 16     STA $16B2
01/9942: 60           RTS 

; [  ]

01/9943: AD 47 1B     LDA $1B47
01/9946: D0 05        BNE $994D
01/9948: AD 3C 1A     LDA $1A3C
01/994B: D0 02        BNE $994F
01/994D: 38           SEC 
01/994E: 60           RTS 
01/994F: 3A           DEC 
01/9950: 85 51        STA $51
01/9952: 0A           ASL 
01/9953: 0A           ASL 
01/9954: 0A           ASL 
01/9955: 85 46        STA $46
01/9957: 64 45        STZ $45
01/9959: A6 45        LDX $45
01/995B: C2 20        REP #$20
01/995D: BF FE 07 70  LDA $7007FE,X   ; check sram fixed value
01/9961: A8           TAY 
01/9962: E2 20        SEP #$20
01/9964: C0 E4 1B     CPY #$1BE4
01/9967: F0 04        BEQ $996D
01/9969: E2 20        SEP #$20
01/996B: 18           CLC 
01/996C: 60           RTS 
01/996D: A5 51        LDA $51
01/996F: 1A           INC 
01/9970: 20 5F CC     JSR $CC5F       ; calculate save slot checksum
01/9973: C2 20        REP #$20
01/9975: 8A           TXA 
01/9976: A6 45        LDX $45
01/9978: DF FC 07 70  CMP $7007FC,X   ; compare with saved checksum
01/997C: D0 EB        BNE $9969
01/997E: E2 20        SEP #$20
01/9980: 38           SEC 
01/9981: 60           RTS 

; [  ]

01/9982: 20 9B 97     JSR $979B
01/9985: 64 48        STZ $48
01/9987: 64 49        STZ $49
01/9989: A5 48        LDA $48
01/998B: 20 50 99     JSR $9950
01/998E: B0 1E        BCS $99AE
01/9990: C2 20        REP #$20
01/9992: 8B           PHB 
01/9993: A5 48        LDA $48
01/9995: EB           XBA 
01/9996: 0A           ASL 
01/9997: 0A           ASL 
01/9998: 0A           ASL 
01/9999: A8           TAY 
01/999A: 5A           PHY 
01/999B: A2 00 10     LDX #$1000
01/999E: A9 FF 07     LDA #$07FF
01/99A1: 54 70 7E     MVN $70,$7E
01/99A4: FA           PLX 
01/99A5: A9 00 20     LDA #$2000
01/99A8: 9D AA 06     STA $06AA,X
01/99AB: AB           PLB 
01/99AC: E2 20        SEP #$20
01/99AE: A5 48        LDA $48
01/99B0: 1A           INC 
01/99B1: 85 48        STA $48
01/99B3: C9 04        CMP #$04
01/99B5: D0 D2        BNE $9989
01/99B7: 60           RTS 

; [  ]

01/99B8: AD 9A 1B     LDA $1B9A
01/99BB: F0 09        BEQ $99C6
01/99BD: 20 1E 9A     JSR $9A1E
01/99C0: 20 A4 94     JSR $94A4
01/99C3: 4C 64 94     JMP $9464       ; fade in
01/99C6: EE 9A 1B     INC $1B9A
01/99C9: 7B           TDC 
01/99CA: 85 88        STA $88
01/99CC: A2 E8 FF     LDX #$FFE8
01/99CF: 86 93        STX $93
01/99D1: 86 99        STX $99
01/99D3: 86 9F        STX $9F
01/99D5: A9 03        LDA #$03
01/99D7: 85 4E        STA $4E
01/99D9: A0 30 00     LDY #$0030
01/99DC: 20 A1 94     JSR $94A1
01/99DF: C2 20        REP #$20
01/99E1: C6 93        DEC $93
01/99E3: C6 99        DEC $99
01/99E5: C6 99        DEC $99
01/99E7: C6 9F        DEC $9F
01/99E9: C6 9F        DEC $9F
01/99EB: C6 9F        DEC $9F
01/99ED: E2 20        SEP #$20
01/99EF: C6 4E        DEC $4E
01/99F1: D0 06        BNE $99F9
01/99F3: A9 03        LDA #$03
01/99F5: 85 4E        STA $4E
01/99F7: E6 88        INC $88
01/99F9: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/99FC: A5 00        LDA $00
01/99FE: 29 80        AND #$80
01/9A00: D0 06        BNE $9A08
01/9A02: A5 01        LDA $01
01/9A04: 29 0C        AND #$0C
01/9A06: F0 0E        BEQ $9A16
01/9A08: 20 1E 9A     JSR $9A1E
01/9A0B: A9 03        LDA #$03
01/9A0D: 85 4E        STA $4E
01/9A0F: A9 0F        LDA #$0F
01/9A11: 85 88        STA $88
01/9A13: A0 02 00     LDY #$0002
01/9A16: 88           DEY 
01/9A17: D0 C3        BNE $99DC
01/9A19: A9 0F        LDA #$0F
01/9A1B: 85 88        STA $88
01/9A1D: 60           RTS 

; [  ]

01/9A1E: A9 B8        LDA #$B8
01/9A20: 85 93        STA $93
01/9A22: A9 88        LDA #$88
01/9A24: 85 99        STA $99
01/9A26: A9 58        LDA #$58
01/9A28: 85 9F        STA $9F
01/9A2A: A9 FF        LDA #$FF
01/9A2C: 85 94        STA $94
01/9A2E: 85 9A        STA $9A
01/9A30: 85 A0        STA $A0
01/9A32: 60           RTS 

; [  ]

01/9A33: 48           PHA 
01/9A34: 85 4B        STA $4B
01/9A36: 0A           ASL 
01/9A37: 85 48        STA $48
01/9A39: 64 49        STZ $49
01/9A3B: A2 E1 9A     LDX #$9AE1      ; select bg jump table
01/9A3E: A5 4B        LDA $4B
01/9A40: 20 4B 83     JSR $834B       ; do jump table
01/9A43: A5 4B        LDA $4B
01/9A45: D0 05        BNE $9A4C
01/9A47: A0 C0 A6     LDY #$A6C0
01/9A4A: 84 29        STY $29
01/9A4C: A0 C1 DF     LDY #$DFC1
01/9A4F: 20 D9 80     JSR $80D9       ; draw window
01/9A52: A0 A7 DB     LDY #$DBA7
01/9A55: A2 82 00     LDX #$0082
01/9A58: 20 CD 82     JSR $82CD       ; draw text
01/9A5B: A5 4B        LDA $4B
01/9A5D: 18           CLC 
01/9A5E: 69 81        ADC #$81
01/9A60: A4 29        LDY $29
01/9A62: 99 C8 00     STA $00C8,Y
01/9A65: 8B           PHB 
01/9A66: A9 70        LDA #$70
01/9A68: 48           PHA 
01/9A69: AB           PLB 
01/9A6A: A5 4B        LDA $4B
01/9A6C: 20 50 99     JSR $9950
01/9A6F: 90 54        BCC $9AC5
01/9A71: C2 20        REP #$20
01/9A73: A5 48        LDA $48
01/9A75: 0A           ASL 
01/9A76: 0A           ASL 
01/9A77: EB           XBA 
01/9A78: AA           TAX 
01/9A79: DA           PHX 
01/9A7A: DA           PHX 
01/9A7B: BD 00 00     LDA $0000,X
01/9A7E: 29 3F 00     AND #$003F
01/9A81: C9 01 00     CMP #$0001
01/9A84: F0 0D        BEQ $9A93
01/9A86: C9 0B 00     CMP #$000B
01/9A89: F0 08        BEQ $9A93
01/9A8B: 8A           TXA 
01/9A8C: 18           CLC 
01/9A8D: 69 40 00     ADC #$0040
01/9A90: AA           TAX 
01/9A91: 80 E8        BRA $9A7B
01/9A93: BD 07 00     LDA $0007,X
01/9A96: A0 4A 01     LDY #$014A
01/9A99: 20 CF 9A     JSR $9ACF
01/9A9C: BD 09 00     LDA $0009,X
01/9A9F: A0 54 01     LDY #$0154
01/9AA2: 20 CF 9A     JSR $9ACF
01/9AA5: FA           PLX 
01/9AA6: A5 29        LDA $29
01/9AA8: 18           CLC 
01/9AA9: 69 CC 00     ADC #$00CC
01/9AAC: A8           TAY 
01/9AAD: FA           PLX 
01/9AAE: BD A5 06     LDA $06A5,X
01/9AB1: 48           PHA 
01/9AB2: E2 20        SEP #$20
01/9AB4: BD A4 06     LDA $06A4,X
01/9AB7: FA           PLX 
01/9AB8: 20 36 97     JSR $9736
01/9ABB: AB           PLB 
01/9ABC: A4 29        LDY $29
01/9ABE: A9 C7        LDA #$C7
01/9AC0: 99 52 01     STA $0152,Y
01/9AC3: 80 07        BRA $9ACC
01/9AC5: A0 0C E0     LDY #$E00C
01/9AC8: 20 01 83     JSR $8301       ; draw positioned text
01/9ACB: AB           PLB 
01/9ACC: 68           PLA 
01/9ACD: 1A           INC 
01/9ACE: 60           RTS 

; [  ]

01/9ACF: 8B           PHB 
01/9AD0: 85 45        STA $45
01/9AD2: E2 20        SEP #$20
01/9AD4: A9 7E        LDA #$7E
01/9AD6: 48           PHA 
01/9AD7: AB           PLB 
01/9AD8: C2 20        REP #$20
01/9ADA: A5 45        LDA $45
01/9ADC: 20 83 83     JSR $8383
01/9ADF: AB           PLB 
01/9AE0: 60           RTS 

; select bg jump table
01/9AE1: 84BA 84A2 8488 8470

; [  ]

01/9AE9: C2 20        REP #$20
01/9AEB: A9 E4 1B     LDA #$1BE4      ; check sram fixed value for all slots
01/9AEE: CF FE 07 70  CMP $7007FE
01/9AF2: F0 1F        BEQ $9B13
01/9AF4: CF FE 0F 70  CMP $700FFE
01/9AF8: F0 19        BEQ $9B13
01/9AFA: CF FE 17 70  CMP $7017FE
01/9AFE: F0 13        BEQ $9B13
01/9B00: CF FE 1F 70  CMP $701FFE
01/9B04: F0 0D        BEQ $9B13
01/9B06: E2 20        SEP #$20
01/9B08: 20 17 9B     JSR $9B17
01/9B0B: 20 17 99     JSR $9917
01/9B0E: 20 CC 95     JSR $95CC
01/9B11: 38           SEC 
01/9B12: 60           RTS 
01/9B13: E2 20        SEP #$20
01/9B15: 18           CLC 
01/9B16: 60           RTS 

; [  ]

01/9B17: A2 40 10     LDX #$1040
01/9B1A: A9 00        LDA #$00
01/9B1C: 9D 00 00     STA $0000,X
01/9B1F: E8           INX 
01/9B20: E0 00 18     CPX #$1800
01/9B23: D0 F5        BNE $9B1A
01/9B25: A2 00 30     LDX #$3000
01/9B28: 8E AA 16     STX $16AA
01/9B2B: 20 49 87     JSR $8749       ; update window color
01/9B2E: C2 20        REP #$20
01/9B30: A9 53 00     LDA #$0053
01/9B33: A2 10 A7     LDX #$A710
01/9B36: A0 00 15     LDY #$1500
01/9B39: 54 7E 0F     MVN $7E,$0F
01/9B3C: A9 05 00     LDA #$0005
01/9B3F: A2 00 15     LDX #$1500
01/9B42: A0 0A 1B     LDY #$1B0A
01/9B45: 54 7E 7E     MVN $7E,$7E
01/9B48: E2 20        SEP #$20
01/9B4A: A9 00        LDA #$00
01/9B4C: 8D AE 16     STA $16AE
01/9B4F: 1A           INC 
01/9B50: 8D AF 16     STA $16AF
01/9B53: 8D B1 16     STA $16B1
01/9B56: 1A           INC 
01/9B57: 8D AD 16     STA $16AD
01/9B5A: 8D AC 16     STA $16AC
01/9B5D: 8D B0 16     STA $16B0
01/9B60: 60           RTS 

; --------------------------------------------------------------------------

; [ name change menu ]

01/9B61: AF 49 1B 00  LDA $001B49
01/9B65: D0 25        BNE $9B8C
01/9B67: 20 7D 8C     JSR $8C7D       ; init menu
01/9B6A: 20 5E 92     JSR $925E       ; load portraits
01/9B6D: 20 88 84     JSR $8488       ; select bg4
01/9B70: A0 51 DB     LDY #$DB51
01/9B73: 20 D9 80     JSR $80D9       ; draw window
01/9B76: A0 55 DB     LDY #$DB55
01/9B79: 20 D9 80     JSR $80D9       ; draw window
01/9B7C: A0 40 10     LDY #$1040
01/9B7F: A9 30        LDA #$30        ; sprite layer priority: 3
01/9B81: 8D C1 01     STA $01C1
01/9B84: AD 18 1B     LDA $1B18
01/9B87: 20 6E 8E     JSR $8E6E       ; draw portrait
01/9B8A: 80 06        BRA $9B92
01/9B8C: A0 D0 E0     LDY #$E0D0
01/9B8F: 20 D9 80     JSR $80D9       ; draw window
01/9B92: A0 5D DB     LDY #$DB5D
01/9B95: 20 D9 80     JSR $80D9       ; draw window
01/9B98: 20 70 84     JSR $8470       ; select bg3
01/9B9B: A0 59 DB     LDY #$DB59
01/9B9E: 20 D9 80     JSR $80D9       ; draw window
01/9BA1: 20 68 9E     JSR $9E68
01/9BA4: C2 20        REP #$20
01/9BA6: A9 00 08     LDA #$0800
01/9BA9: A2 00 D6     LDX #$D600
01/9BAC: A0 00 B6     LDY #$B600
01/9BAF: 54 7E 7E     MVN $7E,$7E
01/9BB2: E2 20        SEP #$20
01/9BB4: 20 88 84     JSR $8488       ; select bg4
01/9BB7: AD 49 1B     LDA $1B49
01/9BBA: F0 06        BEQ $9BC2
01/9BBC: A0 D0 E0     LDY #$E0D0
01/9BBF: 20 D9 80     JSR $80D9       ; draw window
01/9BC2: A9 7E        LDA #$7E
01/9BC4: 48           PHA 
01/9BC5: AB           PLB 
01/9BC6: A2 00 1B     LDX #$1B00
01/9BC9: A9 0A        LDA #$0A
01/9BCB: 9E 00 00     STZ $0000,X
01/9BCE: 3A           DEC 
01/9BCF: D0 FA        BNE $9BCB
01/9BD1: 9C 08 1B     STZ $1B08
01/9BD4: A2 0A 1B     LDX #$1B0A
01/9BD7: A0 06 00     LDY #$0006
01/9BDA: BD 00 00     LDA $0000,X
01/9BDD: 9D 07 00     STA $0007,X
01/9BE0: E8           INX 
01/9BE1: C9 FF        CMP #$FF
01/9BE3: F0 03        BEQ $9BE8
01/9BE5: EE 08 1B     INC $1B08
01/9BE8: 88           DEY 
01/9BE9: D0 EF        BNE $9BDA
01/9BEB: CE 08 1B     DEC $1B08
01/9BEE: AD 08 1B     LDA $1B08
01/9BF1: 8D 09 1B     STA $1B09
01/9BF4: 20 12 9E     JSR $9E12
01/9BF7: 20 89 9E     JSR $9E89
01/9BFA: A9 03        LDA #$03
01/9BFC: 8D 06 1B     STA $1B06
01/9BFF: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/9C02: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/9C05: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/9C08: A9 19        LDA #$19
01/9C0A: 8F 2C 21 00  STA $00212C
01/9C0E: A2 FC FF     LDX #$FFFC
01/9C11: 86 90        STX $90
01/9C13: 86 9C        STX $9C
01/9C15: 20 A4 94     JSR $94A4
01/9C18: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/9C1B: 20 64 94     JSR $9464       ; fade in
01/9C1E: 9C BA 1B     STZ $1BBA
01/9C21: 4C 53 9D     JMP $9D53
01/9C24: 20 E0 9E     JSR $9EE0
01/9C27: 20 E6 9D     JSR $9DE6
01/9C2A: AD 06 1B     LDA $1B06
01/9C2D: 0A           ASL 
01/9C2E: 85 45        STA $45
01/9C30: 64 46        STZ $46
01/9C32: A6 45        LDX $45
01/9C34: C2 20        REP #$20
01/9C36: BF C8 DC 01  LDA $01DCC8,X
01/9C3A: 18           CLC 
01/9C3B: 69 BA DB     ADC #$DBBA
01/9C3E: 85 5A        STA $5A
01/9C40: A9 01 00     LDA #$0001
01/9C43: 85 5C        STA $5C
01/9C45: E2 20        SEP #$20
01/9C47: AD 06 1B     LDA $1B06
01/9C4A: 85 45        STA $45
01/9C4C: 0A           ASL 
01/9C4D: 85 45        STA $45
01/9C4F: 64 46        STZ $46
01/9C51: C2 20        REP #$20
01/9C53: A5 45        LDA $45
01/9C55: 18           CLC 
01/9C56: 69 00 1B     ADC #$1B00
01/9C59: 85 5D        STA $5D
01/9C5B: 1A           INC 
01/9C5C: 85 60        STA $60
01/9C5E: E2 20        SEP #$20
01/9C60: 20 89 9E     JSR $9E89
01/9C63: B2 5D        LDA ($5D)
01/9C65: 85 45        STA $45
01/9C67: 64 46        STZ $46
01/9C69: A6 45        LDX $45
01/9C6B: BF CC FF 14  LDA $14FFCC,X
01/9C6F: 85 48        STA $48
01/9C71: B2 60        LDA ($60)
01/9C73: 0A           ASL 
01/9C74: 0A           ASL 
01/9C75: 0A           ASL 
01/9C76: 0A           ASL 
01/9C77: 18           CLC 
01/9C78: 69 50        ADC #$50
01/9C7A: 85 49        STA $49
01/9C7C: A6 48        LDX $48
01/9C7E: A0 00 03     LDY #$0300
01/9C81: 20 86 82     JSR $8286
01/9C84: 20 B6 9E     JSR $9EB6
01/9C87: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9C8A: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/9C8D: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/9C90: A5 00        LDA $00
01/9C92: 29 40        AND #$40
01/9C94: F0 12        BEQ $9CA8
01/9C96: AD 06 1B     LDA $1B06
01/9C99: C9 02        CMP #$02
01/9C9B: D0 05        BNE $9CA2
01/9C9D: A9 FF        LDA #$FF
01/9C9F: 8D 06 1B     STA $1B06
01/9CA2: 20 01 9F     JSR $9F01
01/9CA5: 4C 27 9C     JMP $9C27
; up button
01/9CA8: A5 01        LDA $01
01/9CAA: 89 08        BIT #$08
01/9CAC: F0 0E        BEQ $9CBC
01/9CAE: B2 60        LDA ($60)
01/9CB0: 3A           DEC 
01/9CB1: 10 02        BPL $9CB5
01/9CB3: A9 07        LDA #$07
01/9CB5: 92 60        STA ($60)
01/9CB7: 20 6E 9E     JSR $9E6E
01/9CBA: F0 F2        BEQ $9CAE
; down button
01/9CBC: A5 01        LDA $01
01/9CBE: 89 04        BIT #$04
01/9CC0: F0 0F        BEQ $9CD1
01/9CC2: B2 60        LDA ($60)
01/9CC4: 1A           INC 
01/9CC5: C9 08        CMP #$08
01/9CC7: 90 01        BCC $9CCA
01/9CC9: 7B           TDC 
01/9CCA: 92 60        STA ($60)
01/9CCC: 20 6E 9E     JSR $9E6E
01/9CCF: F0 F1        BEQ $9CC2
; left button
01/9CD1: A5 01        LDA $01
01/9CD3: 89 02        BIT #$02
01/9CD5: F0 12        BEQ $9CE9
01/9CD7: B2 5D        LDA ($5D)
01/9CD9: 3A           DEC 
01/9CDA: 10 06        BPL $9CE2
01/9CDC: 9C 07 1B     STZ $1B07
01/9CDF: 4C 50 9D     JMP $9D50
01/9CE2: 92 5D        STA ($5D)
01/9CE4: 20 6E 9E     JSR $9E6E
01/9CE7: F0 F3        BEQ $9CDC
; right button
01/9CE9: A5 01        LDA $01
01/9CEB: 89 01        BIT #$01
01/9CED: F0 1B        BEQ $9D0A
01/9CEF: B2 5D        LDA ($5D)
01/9CF1: 1A           INC 
01/9CF2: C9 0A        CMP #$0A
01/9CF4: 90 06        BCC $9CFC
01/9CF6: 9C 07 1B     STZ $1B07
01/9CF9: 4C 50 9D     JMP $9D50
01/9CFC: 92 5D        STA ($5D)
01/9CFE: 20 6E 9E     JSR $9E6E
01/9D01: D0 07        BNE $9D0A
01/9D03: B2 5D        LDA ($5D)
01/9D05: 3A           DEC 
01/9D06: 92 5D        STA ($5D)
01/9D08: 80 EC        BRA $9CF6
; A button
01/9D0A: A5 00        LDA $00
01/9D0C: 89 80        BIT #$80
01/9D0E: F0 1C        BEQ $9D2C
01/9D10: AD 08 1B     LDA $1B08
01/9D13: 1A           INC 
01/9D14: C9 06        CMP #$06
01/9D16: B0 14        BCS $9D2C
01/9D18: 8D 08 1B     STA $1B08
01/9D1B: 20 6E 9E     JSR $9E6E
01/9D1E: 48           PHA 
01/9D1F: AD 08 1B     LDA $1B08
01/9D22: 85 45        STA $45
01/9D24: 64 46        STZ $46
01/9D26: A4 45        LDY $45
01/9D28: 68           PLA 
01/9D29: 99 0A 1B     STA $1B0A,Y
; B button
01/9D2C: A5 01        LDA $01
01/9D2E: 89 80        BIT #$80
01/9D30: F0 15        BEQ $9D47
01/9D32: AD 08 1B     LDA $1B08
01/9D35: 30 13        BMI $9D4A
01/9D37: 3A           DEC 
01/9D38: 8D 08 1B     STA $1B08
01/9D3B: 1A           INC 
01/9D3C: 85 45        STA $45
01/9D3E: 64 46        STZ $46
01/9D40: A4 45        LDY $45
01/9D42: A9 FF        LDA #$FF
01/9D44: 99 0A 1B     STA $1B0A,Y
01/9D47: 4C 60 9C     JMP $9C60
01/9D4A: 20 EF 9D     JSR $9DEF
01/9D4D: 4C 60 9C     JMP $9C60
01/9D50: 20 BF 9E     JSR $9EBF
01/9D53: 20 E6 9D     JSR $9DE6
01/9D56: AD 06 1B     LDA $1B06
01/9D59: 20 B4 87     JSR $87B4       ; tax
01/9D5C: BF AA DC 01  LDA $01DCAA,X
01/9D60: 85 46        STA $46
01/9D62: A9 0C        LDA #$0C
01/9D64: 85 45        STA $45
01/9D66: 20 81 82     JSR $8281       ; draw cursor sprite
01/9D69: 20 B6 9E     JSR $9EB6
01/9D6C: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9D6F: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/9D72: A5 00        LDA $00
01/9D74: 29 80        AND #$80
01/9D76: F0 2E        BEQ $9DA6
01/9D78: AD 06 1B     LDA $1B06
01/9D7B: C9 03        CMP #$03
01/9D7D: D0 17        BNE $9D96
01/9D7F: AD 08 1B     LDA $1B08
01/9D82: 30 03        BMI $9D87
01/9D84: 4C 7E 94     JMP $947E       ; fade out
01/9D87: 20 EF 9D     JSR $9DEF
01/9D8A: 20 89 9E     JSR $9E89
01/9D8D: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/9D90: 20 36 83     JSR $8336
01/9D93: 4C 7E 94     JMP $947E       ; fade out
01/9D96: AD BA 1B     LDA $1BBA
01/9D99: D0 03        BNE $9D9E
01/9D9B: 20 13 9F     JSR $9F13
01/9D9E: A9 01        LDA #$01
01/9DA0: 8D 07 1B     STA $1B07
01/9DA3: 4C 24 9C     JMP $9C24
01/9DA6: A5 01        LDA $01
01/9DA8: 89 08        BIT #$08
01/9DAA: F0 11        BEQ $9DBD
01/9DAC: AD 06 1B     LDA $1B06
01/9DAF: 3A           DEC 
01/9DB0: 8D 06 1B     STA $1B06
01/9DB3: 10 02        BPL $9DB7
01/9DB5: A9 03        LDA #$03
01/9DB7: 8D 06 1B     STA $1B06
01/9DBA: 20 E6 9D     JSR $9DE6
01/9DBD: A5 01        LDA $01
01/9DBF: 89 04        BIT #$04
01/9DC1: F0 03        BEQ $9DC6
01/9DC3: 20 01 9F     JSR $9F01
01/9DC6: A5 01        LDA $01
01/9DC8: 89 03        BIT #$03
01/9DCA: F0 8A        BEQ $9D56
01/9DCC: AD BA 1B     LDA $1BBA
01/9DCF: D0 03        BNE $9DD4
01/9DD1: 20 13 9F     JSR $9F13
01/9DD4: AD 06 1B     LDA $1B06
01/9DD7: C9 03        CMP #$03
01/9DD9: 90 03        BCC $9DDE
01/9DDB: 4C 56 9D     JMP $9D56
01/9DDE: A9 01        LDA #$01
01/9DE0: 8D 07 1B     STA $1B07
01/9DE3: 4C 24 9C     JMP $9C24

; [  ]

01/9DE6: 20 06 9E     JSR $9E06
01/9DE9: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/9DEC: 4C C0 82     JMP $82C0       ; update controller (w/ sound effect)

; [  ]

01/9DEF: AD 09 1B     LDA $1B09
01/9DF2: 8D 08 1B     STA $1B08
01/9DF5: A2 0A 1B     LDX #$1B0A
01/9DF8: A0 06 00     LDY #$0006
01/9DFB: BD 07 00     LDA $0007,X
01/9DFE: 9D 00 00     STA $0000,X
01/9E01: E8           INX 
01/9E02: 88           DEY 
01/9E03: D0 F6        BNE $9DFB
01/9E05: 60           RTS 

; [  ]

01/9E06: AD 06 1B     LDA $1B06
01/9E09: F0 07        BEQ $9E12
01/9E0B: 3A           DEC 
01/9E0C: F0 08        BEQ $9E16
01/9E0E: 3A           DEC 
01/9E0F: F0 0A        BEQ $9E1B
01/9E11: 60           RTS 
01/9E12: A6 41        LDX $41         ; zero
01/9E14: 80 08        BRA $9E1E
01/9E16: A2 50 00     LDX #$0050
01/9E19: 80 03        BRA $9E1E
01/9E1B: A2 A0 00     LDX #$00A0
01/9E1E: A0 52 C8     LDY #$C852
01/9E21: A9 08        LDA #$08
01/9E23: 85 45        STA $45
01/9E25: A9 02        LDA #$02
01/9E27: 85 4B        STA $4B
01/9E29: A9 05        LDA #$05
01/9E2B: 85 48        STA $48
01/9E2D: BF BA DB 01  LDA $01DBBA,X
01/9E31: E8           INX 
01/9E32: C9 00        CMP #$00
01/9E34: F0 05        BEQ $9E3B
01/9E36: 20 32 8E     JSR $8E32       ; get dakuten
01/9E39: 80 09        BRA $9E44
01/9E3B: 3A           DEC 
01/9E3C: 99 00 00     STA $0000,Y
01/9E3F: 99 40 00     STA $0040,Y
01/9E42: 80 07        BRA $9E4B
01/9E44: 99 00 00     STA $0000,Y     ; dakuten
01/9E47: EB           XBA 
01/9E48: 99 40 00     STA $0040,Y     ; kana
01/9E4B: C8           INY 
01/9E4C: C8           INY 
01/9E4D: C8           INY 
01/9E4E: C8           INY 
01/9E4F: C6 48        DEC $48
01/9E51: D0 DA        BNE $9E2D
01/9E53: C8           INY 
01/9E54: C8           INY 
01/9E55: C6 4B        DEC $4B
01/9E57: D0 D0        BNE $9E29
01/9E59: C2 20        REP #$20
01/9E5B: 98           TYA 
01/9E5C: 18           CLC 
01/9E5D: 69 54 00     ADC #$0054
01/9E60: A8           TAY 
01/9E61: E2 20        SEP #$20
01/9E63: C6 45        DEC $45
01/9E65: D0 BE        BNE $9E25
01/9E67: 60           RTS 

; [  ]

01/9E68: A0 AE DC     LDY #$DCAE
01/9E6B: 4C 01 83     JMP $8301       ; draw positioned text

; [  ]

01/9E6E: 5A           PHY 
01/9E6F: A4 41        LDY $41         ; zero
01/9E71: B2 60        LDA ($60)
01/9E73: 0A           ASL 
01/9E74: 85 45        STA $45
01/9E76: 0A           ASL 
01/9E77: 0A           ASL 
01/9E78: 18           CLC 
01/9E79: 65 45        ADC $45
01/9E7B: 72 5D        ADC ($5D)
01/9E7D: 85 45        STA $45
01/9E7F: 64 46        STZ $46
01/9E81: A4 45        LDY $45
01/9E83: B7 5A        LDA [$5A],Y
01/9E85: 7A           PLY 
01/9E86: C9 00        CMP #$00
01/9E88: 60           RTS 

; [  ]

01/9E89: DA           PHX 
01/9E8A: 5A           PHY 
01/9E8B: AD 49 1B     LDA $1B49
01/9E8E: F0 05        BEQ $9E95
01/9E90: A0 52 01     LDY #$0152
01/9E93: 80 03        BRA $9E98
01/9E95: A0 E0 00     LDY #$00E0
01/9E98: A2 0A 1B     LDX #$1B0A
01/9E9B: A9 06        LDA #$06
01/9E9D: 85 45        STA $45
01/9E9F: BD 00 00     LDA $0000,X
01/9EA2: E8           INX 
01/9EA3: 20 32 8E     JSR $8E32       ; get dakuten
01/9EA6: 99 00 C6     STA $C600,Y     ; dakuten
01/9EA9: EB           XBA 
01/9EAA: 99 40 C6     STA $C640,Y     ; kana
01/9EAD: C8           INY 
01/9EAE: C8           INY 
01/9EAF: C6 45        DEC $45
01/9EB1: D0 EC        BNE $9E9F
01/9EB3: 7A           PLY 
01/9EB4: FA           PLX 
01/9EB5: 60           RTS 
01/9EB6: AD 49 1B     LDA $1B49
01/9EB9: D0 01        BNE $9EBC
01/9EBB: 60           RTS 
01/9EBC: 4C DC BA     JMP $BADC
01/9EBF: A2 04 00     LDX #$0004
01/9EC2: E6 9C        INC $9C
01/9EC4: 20 A1 94     JSR $94A1
01/9EC7: CA           DEX 
01/9EC8: D0 F8        BNE $9EC2
01/9ECA: A6 9C        LDX $9C
01/9ECC: 86 90        STX $90
01/9ECE: A9 19        LDA #$19
01/9ED0: 8F 2C 21 00  STA $00212C
01/9ED4: A2 04 00     LDX #$0004
01/9ED7: C6 90        DEC $90
01/9ED9: 20 A1 94     JSR $94A1
01/9EDC: CA           DEX 
01/9EDD: D0 F8        BNE $9ED7
01/9EDF: 60           RTS 
01/9EE0: A2 04 00     LDX #$0004
01/9EE3: E6 90        INC $90
01/9EE5: 20 A1 94     JSR $94A1
01/9EE8: CA           DEX 
01/9EE9: D0 F8        BNE $9EE3
01/9EEB: A6 90        LDX $90
01/9EED: 86 9C        STX $9C
01/9EEF: A9 1C        LDA #$1C
01/9EF1: 8F 2C 21 00  STA $00212C
01/9EF5: A2 04 00     LDX #$0004
01/9EF8: C6 9C        DEC $9C
01/9EFA: 20 A1 94     JSR $94A1
01/9EFD: CA           DEX 
01/9EFE: D0 F8        BNE $9EF8
01/9F00: 60           RTS 
01/9F01: AD 06 1B     LDA $1B06
01/9F04: 1A           INC 
01/9F05: 8D 06 1B     STA $1B06
01/9F08: C9 04        CMP #$04
01/9F0A: 90 01        BCC $9F0D
01/9F0C: 7B           TDC 
01/9F0D: 8D 06 1B     STA $1B06
01/9F10: 4C E6 9D     JMP $9DE6

; [  ]

01/9F13: A9 FF        LDA #$FF
01/9F15: 8D 08 1B     STA $1B08
01/9F18: 8D BA 1B     STA $1BBA
01/9F1B: A6 41        LDX $41         ; zero
01/9F1D: 9D 0A 1B     STA $1B0A,X
01/9F20: E8           INX 
01/9F21: E0 06 00     CPX #$0006
01/9F24: D0 F7        BNE $9F1D
01/9F26: 60           RTS 

; --------------------------------------------------------------------------

; [ item menu ]

01/9F27: 9C 1F 1B     STZ $1B1F
01/9F2A: 20 C6 94     JSR $94C6
01/9F2D: 20 A9 94     JSR $94A9
01/9F30: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/9F33: 20 88 84     JSR $8488       ; select bg4
01/9F36: A9 1C        LDA #$1C
01/9F38: 85 C2        STA $C2
01/9F3A: A9 06        LDA #$06
01/9F3C: 85 AE        STA $AE
01/9F3E: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/9F41: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9F44: A9 1B        LDA #$1B
01/9F46: 8F 2C 21 00  STA $00212C
01/9F4A: A0 6D DB     LDY #$DB6D      ; main menu options
01/9F4D: A2 D2 DC     LDX #$DCD2      ; item submenu label
01/9F50: 20 D0 84     JSR $84D0       ; transform window
01/9F53: 20 BA 84     JSR $84BA       ; select bg2
01/9F56: A0 FC DC     LDY #$DCFC
01/9F59: 20 FB 82     JSR $82FB       ; draw window and text
01/9F5C: A9 03        LDA #$03
01/9F5E: 20 1B 95     JSR $951B
01/9F61: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/9F64: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/9F67: AE A5 1B     LDX $1BA5
01/9F6A: 86 93        STX $93
01/9F6C: 20 A4 94     JSR $94A4
01/9F6F: EE C9 1B     INC $1BC9
01/9F72: A2 CE EA     LDX #$EACE      ; items $CE-$EA valid (consumables)
01/9F75: 8E 1D 1B     STX $1B1D
01/9F78: 20 9F 84     JSR $849F       ; select and clear bg1
01/9F7B: 20 72 A1     JSR $A172
01/9F7E: 20 A4 94     JSR $94A4
01/9F81: 20 E3 83     JSR $83E3       ; open window
01/9F84: 20 CD 9F     JSR $9FCD
01/9F87: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/9F8A: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9F8D: A6 93        LDX $93
01/9F8F: 8E A5 1B     STX $1BA5
01/9F92: 20 9F 84     JSR $849F       ; select and clear bg1
01/9F95: 20 17 84     JSR $8417       ; close window
01/9F98: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/9F9B: 20 E8 94     JSR $94E8
01/9F9E: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/9FA1: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/9FA4: 20 88 84     JSR $8488       ; select bg4
01/9FA7: A9 1C        LDA #$1C
01/9FA9: 85 C2        STA $C2
01/9FAB: A9 86        LDA #$86
01/9FAD: 85 AE        STA $AE
01/9FAF: A2 6D DB     LDX #$DB6D      ; main menu options
01/9FB2: A0 D2 DC     LDY #$DCD2      ; item submenu label
01/9FB5: 20 D0 84     JSR $84D0       ; transform window
01/9FB8: 20 19 89     JSR $8919       ; draw main menu
01/9FBB: 20 FD 88     JSR $88FD
01/9FBE: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/9FC1: A9 1F        LDA #$1F
01/9FC3: 8F 2C 21 00  STA $00212C
01/9FC7: 9C C9 1B     STZ $1BC9
01/9FCA: 4C E3 83     JMP $83E3       ; open window

; [  ]

01/9FCD: 20 C5 A7     JSR $A7C5
01/9FD0: A2 00 68     LDX #$6800
01/9FD3: 86 1D        STX $1D
01/9FD5: A2 00 A6     LDX #$A600
01/9FD8: 86 1F        STX $1F
01/9FDA: A9 7E        LDA #$7E
01/9FDC: 85 21        STA $21
01/9FDE: A2 40 01     LDX #$0140
01/9FE1: 86 22        STX $22
01/9FE3: 20 8A 81     JSR $818A       ; wait for vblank
01/9FE6: 20 78 80     JSR $8078       ; transfer data to vram
01/9FE9: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/9FEC: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/9FEF: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/9FF2: A5 01        LDA $01
01/9FF4: 29 02        AND #$02
01/9FF6: F0 0B        BEQ $A003
01/9FF8: AD 22 1B     LDA $1B22
01/9FFB: 1A           INC 
01/9FFC: 29 01        AND #$01
01/9FFE: 8D 22 1B     STA $1B22
01/A001: D0 17        BNE $A01A
01/A003: A5 01        LDA $01
01/A005: 29 01        AND #$01
01/A007: F0 0B        BEQ $A014
01/A009: AD 22 1B     LDA $1B22
01/A00C: 1A           INC 
01/A00D: 29 01        AND #$01
01/A00F: 8D 22 1B     STA $1B22
01/A012: F0 58        BEQ $A06C
01/A014: A5 01        LDA $01
01/A016: 29 08        AND #$08
01/A018: F0 4C        BEQ $A066
01/A01A: AD 23 1B     LDA $1B23
01/A01D: D0 43        BNE $A062
01/A01F: AD 1A 1B     LDA $1B1A
01/A022: F0 42        BEQ $A066
01/A024: 3A           DEC 
01/A025: 8D 1A 1B     STA $1B1A
01/A028: C2 20        REP #$20
01/A02A: A0 08 00     LDY #$0008
01/A02D: A5 93        LDA $93
01/A02F: 38           SEC 
01/A030: E9 02 00     SBC #$0002
01/A033: 85 93        STA $93
01/A035: E2 20        SEP #$20
01/A037: AD 19 1B     LDA $1B19
01/A03A: F0 06        BEQ $A042
01/A03C: EE 11 03     INC $0311
01/A03F: EE 11 03     INC $0311
01/A042: 5A           PHY 
01/A043: 20 C5 A7     JSR $A7C5
01/A046: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/A049: 20 23 94     JSR $9423       ; transfer bg2 screen buffer to vram
01/A04C: 20 A4 94     JSR $94A4
01/A04F: 7A           PLY 
01/A050: C2 20        REP #$20
01/A052: 88           DEY 
01/A053: D0 D8        BNE $A02D
01/A055: E2 20        SEP #$20
01/A057: 20 05 A1     JSR $A105
01/A05A: 20 A5 82     JSR $82A5
01/A05D: B0 07        BCS $A066
01/A05F: 4C F2 9F     JMP $9FF2
01/A062: 3A           DEC 
01/A063: 8D 23 1B     STA $1B23
01/A066: A5 01        LDA $01
01/A068: 29 04        AND #$04
01/A06A: F0 50        BEQ $A0BC
01/A06C: AD 23 1B     LDA $1B23
01/A06F: C9 09        CMP #$09
01/A071: 90 45        BCC $A0B8
01/A073: AD 1A 1B     LDA $1B1A
01/A076: C9 0E        CMP #$0E
01/A078: F0 42        BEQ $A0BC
01/A07A: 1A           INC 
01/A07B: 8D 1A 1B     STA $1B1A
01/A07E: C2 20        REP #$20
01/A080: A0 08 00     LDY #$0008
01/A083: A5 93        LDA $93
01/A085: 18           CLC 
01/A086: 69 02 00     ADC #$0002
01/A089: 85 93        STA $93
01/A08B: E2 20        SEP #$20
01/A08D: AD 19 1B     LDA $1B19
01/A090: F0 06        BEQ $A098
01/A092: CE 11 03     DEC $0311
01/A095: CE 11 03     DEC $0311
01/A098: 5A           PHY 
01/A099: 20 C5 A7     JSR $A7C5
01/A09C: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/A09F: 20 23 94     JSR $9423       ; transfer bg2 screen buffer to vram
01/A0A2: 20 A4 94     JSR $94A4
01/A0A5: 7A           PLY 
01/A0A6: C2 20        REP #$20
01/A0A8: 88           DEY 
01/A0A9: D0 D8        BNE $A083
01/A0AB: E2 20        SEP #$20
01/A0AD: 20 05 A1     JSR $A105
01/A0B0: 20 A5 82     JSR $82A5
01/A0B3: B0 07        BCS $A0BC
01/A0B5: 4C F2 9F     JMP $9FF2
01/A0B8: 1A           INC 
01/A0B9: 8D 23 1B     STA $1B23
01/A0BC: A5 00        LDA $00
01/A0BE: 29 80        AND #$80
01/A0C0: F0 21        BEQ $A0E3
01/A0C2: AD 19 1B     LDA $1B19
01/A0C5: D0 05        BNE $A0CC
01/A0C7: 20 C3 A2     JSR $A2C3
01/A0CA: 80 33        BRA $A0FF
01/A0CC: 20 09 A3     JSR $A309
01/A0CF: 20 A2 84     JSR $84A2       ; select bg1
01/A0D2: 20 72 A1     JSR $A172
01/A0D5: 9C 19 1B     STZ $1B19
01/A0D8: 20 D9 A2     JSR $A2D9
01/A0DB: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/A0DE: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/A0E1: 80 1C        BRA $A0FF
01/A0E3: A5 01        LDA $01
01/A0E5: 29 80        AND #$80
01/A0E7: F0 16        BEQ $A0FF
01/A0E9: AD 19 1B     LDA $1B19
01/A0EC: F0 08        BEQ $A0F6
01/A0EE: 9C 19 1B     STZ $1B19
01/A0F1: 20 D9 A2     JSR $A2D9
01/A0F4: 80 09        BRA $A0FF
01/A0F6: 20 D9 A2     JSR $A2D9
01/A0F9: 20 5E 92     JSR $925E       ; load portraits
01/A0FC: 64 86        STZ $86
01/A0FE: 60           RTS 
01/A0FF: 20 05 A1     JSR $A105
01/A102: 4C CD 9F     JMP $9FCD
01/A105: 5A           PHY 
01/A106: A9 20        LDA #$20
01/A108: 85 3F        STA $3F
01/A10A: AD 23 1B     LDA $1B23
01/A10D: 0A           ASL 
01/A10E: 0A           ASL 
01/A10F: 0A           ASL 
01/A110: 0A           ASL 
01/A111: 69 36        ADC #$36
01/A113: EB           XBA 
01/A114: AD 22 1B     LDA $1B22
01/A117: F0 02        BEQ $A11B
01/A119: A9 6C        LDA #$6C
01/A11B: 18           CLC 
01/A11C: 69 04        ADC #$04
01/A11E: AA           TAX 
01/A11F: A0 00 03     LDY #$0300
01/A122: 20 86 82     JSR $8286
01/A125: AD 19 1B     LDA $1B19
01/A128: F0 30        BEQ $A15A
01/A12A: AD 25 1B     LDA $1B25
01/A12D: 38           SEC 
01/A12E: ED 1A 1B     SBC $1B1A
01/A131: C9 FC        CMP #$FC
01/A133: B0 08        BCS $A13D
01/A135: C9 00        CMP #$00
01/A137: 30 1E        BMI $A157
01/A139: C9 0B        CMP #$0B
01/A13B: B0 1A        BCS $A157
01/A13D: 0A           ASL 
01/A13E: 0A           ASL 
01/A13F: 0A           ASL 
01/A140: 0A           ASL 
01/A141: 69 36        ADC #$36
01/A143: EB           XBA 
01/A144: AD 24 1B     LDA $1B24
01/A147: F0 02        BEQ $A14B
01/A149: A9 70        LDA #$70
01/A14B: 18           CLC 
01/A14C: 69 08        ADC #$08
01/A14E: AA           TAX 
01/A14F: A0 10 03     LDY #$0310
01/A152: 20 86 82     JSR $8286
01/A155: 80 03        BRA $A15A
01/A157: 20 DC A2     JSR $A2DC
01/A15A: 7A           PLY 
01/A15B: 60           RTS 
01/A15C: A2 28 FF     LDX #$FF28
01/A15F: 86 5A        STX $5A
01/A161: A9 08        LDA #$08
01/A163: 85 E1        STA $E1
01/A165: 80 1A        BRA $A181
01/A167: A2 40 13     LDX #$1340
01/A16A: 86 5A        STX $5A
01/A16C: A9 7E        LDA #$7E
01/A16E: 85 E1        STA $E1
01/A170: 80 0F        BRA $A181
01/A172: A0 CE DC     LDY #$DCCE
01/A175: 20 D9 80     JSR $80D9       ; draw window
01/A178: A2 40 14     LDX #$1440
01/A17B: 86 5A        STX $5A
01/A17D: A9 30        LDA #$30
01/A17F: 85 E1        STA $E1
01/A181: 64 5D        STZ $5D
01/A183: 64 5E        STZ $5E
01/A185: B2 5A        LDA ($5A)
01/A187: F0 44        BEQ $A1CD
01/A189: C9 FF        CMP #$FF
01/A18B: D0 05        BNE $A192
01/A18D: 20 1A A8     JSR $A81A
01/A190: 80 3B        BRA $A1CD
01/A192: A0 01 00     LDY #$0001
01/A195: B1 5A        LDA ($5A),Y
01/A197: F0 34        BEQ $A1CD
01/A199: 85 5C        STA $5C
01/A19B: A9 00        LDA #$00
01/A19D: EB           XBA 
01/A19E: B2 5A        LDA ($5A)
01/A1A0: C9 ED        CMP #$ED
01/A1A2: F0 04        BEQ $A1A8
01/A1A4: C9 FE        CMP #$FE
01/A1A6: D0 0B        BNE $A1B3
01/A1A8: AD C9 1B     LDA $1BC9
01/A1AB: F0 06        BEQ $A1B3
01/A1AD: A5 34        LDA $34
01/A1AF: 85 DB        STA $DB
01/A1B1: 80 05        BRA $A1B8
01/A1B3: B2 5A        LDA ($5A)
01/A1B5: 20 5D A2     JSR $A25D
01/A1B8: C2 20        REP #$20
01/A1BA: A5 5D        LDA $5D
01/A1BC: 4A           LSR 
01/A1BD: 0A           ASL 
01/A1BE: 0A           ASL 
01/A1BF: 0A           ASL 
01/A1C0: 0A           ASL 
01/A1C1: 0A           ASL 
01/A1C2: 0A           ASL 
01/A1C3: 0A           ASL 
01/A1C4: 69 04 00     ADC #$0004
01/A1C7: A8           TAY 
01/A1C8: E2 20        SEP #$20
01/A1CA: 20 DE A1     JSR $A1DE
01/A1CD: C2 20        REP #$20
01/A1CF: E6 5A        INC $5A
01/A1D1: E6 5A        INC $5A
01/A1D3: E2 20        SEP #$20
01/A1D5: E6 5D        INC $5D
01/A1D7: A5 5D        LDA $5D
01/A1D9: C5 E1        CMP $E1
01/A1DB: D0 A8        BNE $A185
01/A1DD: 60           RTS 
01/A1DE: AD CC 1B     LDA $1BCC
01/A1E1: D0 0A        BNE $A1ED
01/A1E3: C2 20        REP #$20
01/A1E5: 98           TYA 
01/A1E6: 18           CLC 
01/A1E7: 69 40 00     ADC #$0040
01/A1EA: A8           TAY 
01/A1EB: E2 20        SEP #$20
01/A1ED: A5 5D        LDA $5D
01/A1EF: 29 01        AND #$01
01/A1F1: D0 30        BNE $A223
01/A1F3: B2 5A        LDA ($5A)
01/A1F5: 20 60 90     JSR $9060
01/A1F8: C2 20        REP #$20
01/A1FA: 98           TYA 
01/A1FB: 18           CLC 
01/A1FC: 69 52 00     ADC #$0052
01/A1FF: A8           TAY 
01/A200: E2 20        SEP #$20
01/A202: B2 5A        LDA ($5A)
01/A204: C9 FE        CMP #$FE
01/A206: F0 1A        BEQ $A222
01/A208: A9 C8        LDA #$C8
01/A20A: 91 29        STA ($29),Y
01/A20C: C8           INY 
01/A20D: A5 DB        LDA $DB
01/A20F: 91 29        STA ($29),Y
01/A211: C8           INY 
01/A212: 5A           PHY 
01/A213: A5 5C        LDA $5C
01/A215: 20 69 83     JSR $8369       ; draw 2-digit number
01/A218: 7A           PLY 
01/A219: C8           INY 
01/A21A: A5 DB        LDA $DB
01/A21C: 91 29        STA ($29),Y
01/A21E: C8           INY 
01/A21F: C8           INY 
01/A220: 91 29        STA ($29),Y
01/A222: 60           RTS 
01/A223: C2 20        REP #$20
01/A225: 98           TYA 
01/A226: 18           CLC 
01/A227: 69 1C 00     ADC #$001C
01/A22A: A8           TAY 
01/A22B: E2 20        SEP #$20
01/A22D: B2 5A        LDA ($5A)
01/A22F: 20 60 90     JSR $9060
01/A232: C2 20        REP #$20
01/A234: 98           TYA 
01/A235: 18           CLC 
01/A236: 69 52 00     ADC #$0052
01/A239: A8           TAY 
01/A23A: E2 20        SEP #$20
01/A23C: B2 5A        LDA ($5A)
01/A23E: C9 FE        CMP #$FE
01/A240: F0 1A        BEQ $A25C
01/A242: A9 C8        LDA #$C8
01/A244: 91 29        STA ($29),Y
01/A246: C8           INY 
01/A247: A5 DB        LDA $DB
01/A249: 91 29        STA ($29),Y
01/A24B: C8           INY 
01/A24C: A5 5C        LDA $5C
01/A24E: 5A           PHY 
01/A24F: 20 69 83     JSR $8369       ; draw 2-digit number
01/A252: 7A           PLY 
01/A253: C8           INY 
01/A254: A5 DB        LDA $DB
01/A256: 91 29        STA ($29),Y
01/A258: C8           INY 
01/A259: C8           INY 
01/A25A: 91 29        STA ($29),Y
01/A25C: 60           RTS 

; [  ]

01/A25D: 48           PHA 
01/A25E: 48           PHA 
01/A25F: AD 1F 1B     LDA $1B1F
01/A262: F0 08        BEQ $A26C
01/A264: 68           PLA 
01/A265: 20 A6 BF     JSR $BFA6       ; check if item can be equipped
01/A268: 90 34        BCC $A29E
01/A26A: 80 2C        BRA $A298
01/A26C: 68           PLA 
01/A26D: C9 E2        CMP #$E2
01/A26F: F0 04        BEQ $A275
01/A271: C9 E3        CMP #$E3
01/A273: D0 0F        BNE $A284
; tent/cottage
01/A275: 48           PHA 
01/A276: AD C9 1B     LDA $1BC9
01/A279: F0 08        BEQ $A283
01/A27B: 68           PLA 
01/A27C: AD 02 1A     LDA $1A02
01/A27F: F0 29        BEQ $A2AA
01/A281: 80 15        BRA $A298
01/A283: 68           PLA 
01/A284: C9 19        CMP #$19        ; legend sword
01/A286: F0 16        BEQ $A29E
01/A288: C9 C8        CMP #$C8        ; crystal
01/A28A: F0 12        BEQ $A29E
01/A28C: CD 1D 1B     CMP $1B1D
01/A28F: 90 0D        BCC $A29E       ; branch if not valid
01/A291: CD 1E 1B     CMP $1B1E
01/A294: F0 02        BEQ $A298
01/A296: B0 06        BCS $A29E
01/A298: A5 34        LDA $34
01/A29A: 85 DB        STA $DB
01/A29C: 68           PLA 
01/A29D: 60           RTS 
01/A29E: C9 19        CMP #$19        ; legend sword
01/A2A0: F0 10        BEQ $A2B2
01/A2A2: C9 C8        CMP #$C8        ; crystal
01/A2A4: F0 0C        BEQ $A2B2
01/A2A6: C9 EC        CMP #$EC
01/A2A8: B0 08        BCS $A2B2       ; branch if an event item
01/A2AA: A9 04        LDA #$04
01/A2AC: 05 34        ORA $34
01/A2AE: 85 DB        STA $DB
01/A2B0: 68           PLA 
01/A2B1: 60           RTS 
01/A2B2: C9 FE        CMP #$FE
01/A2B4: F0 F4        BEQ $A2AA
01/A2B6: AD C6 1B     LDA $1BC6
01/A2B9: F0 EF        BEQ $A2AA
01/A2BB: A9 08        LDA #$08
01/A2BD: 05 34        ORA $34
01/A2BF: 85 DB        STA $DB
01/A2C1: 68           PLA 
01/A2C2: 60           RTS 

; [  ]

01/A2C3: AD 1A 1B     LDA $1B1A
01/A2C6: 18           CLC 
01/A2C7: 6D 23 1B     ADC $1B23
01/A2CA: 8D 25 1B     STA $1B25
01/A2CD: AD 22 1B     LDA $1B22
01/A2D0: 8D 24 1B     STA $1B24
01/A2D3: A9 01        LDA #$01
01/A2D5: 8D 19 1B     STA $1B19
01/A2D8: 60           RTS 

; [  ]

01/A2D9: 9C 19 1B     STZ $1B19
01/A2DC: A0 10 03     LDY #$0310
01/A2DF: A2 04 00     LDX #$0004
01/A2E2: A9 FF        LDA #$FF
01/A2E4: 99 00 00     STA $0000,Y
01/A2E7: C8           INY 
01/A2E8: A9 F0        LDA #$F0
01/A2EA: 99 00 00     STA $0000,Y
01/A2ED: C8           INY 
01/A2EE: CA           DEX 
01/A2EF: D0 F1        BNE $A2E2
01/A2F1: 60           RTS 
01/A2F2: A0 00 03     LDY #$0300
01/A2F5: 80 E8        BRA $A2DF

; [  ]

01/A2F7: 20 BA 84     JSR $84BA       ; select bg2
01/A2FA: A0 D6 DC     LDY #$DCD6
01/A2FD: 20 D9 80     JSR $80D9       ; draw window
01/A300: A0 2D DD     LDY #$DD2D
01/A303: 20 01 83     JSR $8301       ; draw positioned text
01/A306: 4C 75 A3     JMP $A375

; [  ]

01/A309: AD 23 1B     LDA $1B23
01/A30C: 18           CLC 
01/A30D: 6D 1A 1B     ADC $1B1A
01/A310: CD 25 1B     CMP $1B25
01/A313: D0 79        BNE $A38E
01/A315: AD 22 1B     LDA $1B22
01/A318: CD 24 1B     CMP $1B24
01/A31B: D0 71        BNE $A38E
01/A31D: AD 25 1B     LDA $1B25
01/A320: 0A           ASL 
01/A321: 6D 24 1B     ADC $1B24
01/A324: 0A           ASL 
01/A325: 85 45        STA $45
01/A327: 64 46        STZ $46
01/A329: A6 45        LDX $45
01/A32B: BD 41 14     LDA $1441,X
01/A32E: F0 C7        BEQ $A2F7
01/A330: BD 40 14     LDA $1440,X
01/A333: C9 FE        CMP #$FE
01/A335: D0 03        BNE $A33A
01/A337: 4C 22 A9     JMP $A922       ; sort
01/A33A: 20 5D A2     JSR $A25D
01/A33D: A5 60        LDA $60
01/A33F: 29 08        AND #$08
01/A341: D0 23        BNE $A366
01/A343: BD 40 14     LDA $1440,X
01/A346: 8D 3B 1B     STA $1B3B
01/A349: 8E 3C 1B     STX $1B3C
; whistle
01/A34C: C9 ED        CMP #$ED
01/A34E: D0 0B        BNE $A35B
01/A350: DE 41 14     DEC $1441,X
01/A353: D0 03        BNE $A358
01/A355: 9E 40 14     STZ $1440,X
01/A358: 4C B3 CC     JMP $CCB3
01/A35B: C9 CE        CMP #$CE
01/A35D: 90 07        BCC $A366
01/A35F: C9 EB        CMP #$EB
01/A361: B0 03        BCS $A366
01/A363: 4C 06 A7     JMP $A706
; not consumable
01/A366: 20 BA 84     JSR $84BA       ; select bg2
01/A369: A0 D6 DC     LDY #$DCD6
01/A36C: 20 D9 80     JSR $80D9       ; draw window
01/A36F: A0 20 DD     LDY #$DD20
01/A372: 20 01 83     JSR $8301       ; draw positioned text
01/A375: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A378: 20 36 83     JSR $8336
01/A37B: 20 D9 A2     JSR $A2D9
01/A37E: 20 BA 84     JSR $84BA       ; select bg2
01/A381: A0 D2 DC     LDY #$DCD2      ; item submenu label
01/A384: 20 D9 80     JSR $80D9       ; draw window
01/A387: A0 00 DD     LDY #$DD00
01/A38A: 20 01 83     JSR $8301       ; draw positioned text
01/A38D: 60           RTS 
01/A38E: 20 D9 A2     JSR $A2D9
01/A391: AD 23 1B     LDA $1B23
01/A394: 18           CLC 
01/A395: 6D 1A 1B     ADC $1B1A
01/A398: 0A           ASL 
01/A399: 6D 22 1B     ADC $1B22
01/A39C: 0A           ASL 
01/A39D: 85 45        STA $45
01/A39F: 64 46        STZ $46
01/A3A1: A4 45        LDY $45
01/A3A3: AD 25 1B     LDA $1B25
01/A3A6: 0A           ASL 
01/A3A7: 6D 24 1B     ADC $1B24
01/A3AA: 0A           ASL 
01/A3AB: 85 45        STA $45
01/A3AD: A6 45        LDX $45
01/A3AF: B9 40 14     LDA $1440,Y
01/A3B2: C9 FF        CMP #$FF
01/A3B4: D0 24        BNE $A3DA
01/A3B6: BD 40 14     LDA $1440,X
01/A3B9: F0 1F        BEQ $A3DA
01/A3BB: C9 ED        CMP #$ED
01/A3BD: F0 11        BEQ $A3D0
01/A3BF: C9 19        CMP #$19
01/A3C1: F0 08        BEQ $A3CB
01/A3C3: C9 C8        CMP #$C8
01/A3C5: F0 04        BEQ $A3CB
01/A3C7: C9 EC        CMP #$EC
01/A3C9: 90 05        BCC $A3D0
01/A3CB: 20 58 87     JSR $8758       ; error sound effect
01/A3CE: 80 2E        BRA $A3FE
01/A3D0: A9 00        LDA #$00
01/A3D2: 9D 40 14     STA $1440,X
01/A3D5: 9D 41 14     STA $1441,X
01/A3D8: 80 24        BRA $A3FE
01/A3DA: BD 40 14     LDA $1440,X
01/A3DD: D9 40 14     CMP $1440,Y
01/A3E0: F0 29        BEQ $A40B
01/A3E2: BD 40 14     LDA $1440,X
01/A3E5: 48           PHA 
01/A3E6: BD 41 14     LDA $1441,X
01/A3E9: 48           PHA 
01/A3EA: B9 40 14     LDA $1440,Y
01/A3ED: 9D 40 14     STA $1440,X
01/A3F0: B9 41 14     LDA $1441,Y
01/A3F3: 9D 41 14     STA $1441,X
01/A3F6: 68           PLA 
01/A3F7: 99 41 14     STA $1441,Y
01/A3FA: 68           PLA 
01/A3FB: 99 40 14     STA $1440,Y
01/A3FE: 20 A2 84     JSR $84A2       ; select bg1
01/A401: 20 72 A1     JSR $A172
01/A404: 20 D9 A2     JSR $A2D9
01/A407: 20 BA 84     JSR $84BA       ; select bg2
01/A40A: 60           RTS 
01/A40B: B9 41 14     LDA $1441,Y
01/A40E: 18           CLC 
01/A40F: 7D 41 14     ADC $1441,X
01/A412: C9 64        CMP #$64
01/A414: B0 CC        BCS $A3E2
01/A416: 99 41 14     STA $1441,Y
01/A419: A9 00        LDA #$00
01/A41B: 9D 40 14     STA $1440,X
01/A41E: 9D 41 14     STA $1441,X
01/A421: 80 DB        BRA $A3FE

; [  ]

01/A423: A9 30        LDA #$30
01/A425: 85 3F        STA $3F
01/A427: 20 D7 94     JSR $94D7
01/A42A: 20 8A 81     JSR $818A       ; wait for vblank
01/A42D: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/A430: 20 BA 84     JSR $84BA       ; select bg2
01/A433: A0 D6 DC     LDY #$DCD6
01/A436: 20 D9 80     JSR $80D9       ; draw window
01/A439: A0 14 DD     LDY #$DD14
01/A43C: 20 01 83     JSR $8301       ; draw positioned text
01/A43F: AD 22 1B     LDA $1B22
01/A442: F0 07        BEQ $A44B
01/A444: A9 05        LDA #$05
01/A446: A0 38 DD     LDY #$DD38
01/A449: 80 05        BRA $A450
01/A44B: A9 00        LDA #$00
01/A44D: A0 3C DD     LDY #$DD3C
01/A450: 8D C1 1B     STA $1BC1
01/A453: 20 D9 80     JSR $80D9       ; draw window
01/A456: 9C C3 1B     STZ $1BC3
01/A459: AD C3 1B     LDA $1BC3
01/A45C: 20 01 90     JSR $9001       ; get pointer to character properties
01/A45F: 9B           TXY 
01/A460: AD C1 1B     LDA $1BC1
01/A463: 0A           ASL 
01/A464: 20 B4 87     JSR $87B4       ; tax
01/A467: C2 20        REP #$20
01/A469: BF 7D FD 1E  LDA $1EFD7D,X
01/A46D: AA           TAX 
01/A46E: E2 20        SEP #$20
01/A470: 20 9F A4     JSR $A49F
01/A473: EE C1 1B     INC $1BC1
01/A476: EE C3 1B     INC $1BC3
01/A479: AD C3 1B     LDA $1BC3
01/A47C: C9 05        CMP #$05
01/A47E: D0 D9        BNE $A459
01/A480: 60           RTS 

; [  ]

01/A481: 20 23 A4     JSR $A423
01/A484: 20 E3 83     JSR $83E3       ; open window
01/A487: A9 30        LDA #$30
01/A489: 85 3F        STA $3F
01/A48B: 20 41 A5     JSR $A541
01/A48E: A9 20        LDA #$20
01/A490: 85 3F        STA $3F
01/A492: 20 D9 A2     JSR $A2D9
01/A495: 20 F9 94     JSR $94F9
01/A498: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A49B: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [  ]

; starts at 01/A49F

01/A49E: 60           RTS 
; subroutine starts here
01/A49F: B9 00 00     LDA $0000,Y
01/A4A2: 29 3F        AND #$3F
01/A4A4: F0 F8        BEQ $A49E
01/A4A6: 84 48        STY $48
01/A4A8: 86 4B        STX $4B
01/A4AA: 5A           PHY 
01/A4AB: 9B           TXY 
01/A4AC: DA           PHX 
01/A4AD: 20 AB 83     JSR $83AB       ; draw character name
01/A4B0: FA           PLX 
01/A4B1: 7A           PLY 
01/A4B2: 48           PHA 
01/A4B3: B9 03 00     LDA $0003,Y
01/A4B6: 2A           ROL 
01/A4B7: 2A           ROL 
01/A4B8: 2A           ROL 
01/A4B9: 2A           ROL 
01/A4BA: 29 04        AND #$04
01/A4BC: 05 34        ORA $34
01/A4BE: 85 45        STA $45
01/A4C0: A9 0E        LDA #$0E
01/A4C2: 20 47 8C     JSR $8C47
01/A4C5: 20 47 8C     JSR $8C47
01/A4C8: 20 47 8C     JSR $8C47
01/A4CB: 20 47 8C     JSR $8C47
01/A4CE: 68           PLA 
01/A4CF: C2 20        REP #$20
01/A4D1: A5 4B        LDA $4B
01/A4D3: 18           CLC 
01/A4D4: 65 29        ADC $29
01/A4D6: 85 4E        STA $4E
01/A4D8: 18           CLC 
01/A4D9: 69 40 00     ADC #$0040
01/A4DC: 85 51        STA $51
01/A4DE: E2 20        SEP #$20
01/A4E0: A6 48        LDX $48
01/A4E2: A4 4B        LDY $4B
01/A4E4: DA           PHX 
01/A4E5: 5A           PHY 
01/A4E6: 20 00 8B     JSR $8B00
01/A4E9: 7A           PLY 
01/A4EA: FA           PLX 
01/A4EB: 86 48        STX $48
01/A4ED: 84 4B        STY $4B
01/A4EF: C2 20        REP #$20
01/A4F1: A5 51        LDA $51
01/A4F3: 18           CLC 
01/A4F4: 69 42 00     ADC #$0042
01/A4F7: A8           TAY 
01/A4F8: E2 20        SEP #$20
01/A4FA: A9 49        LDA #$49
01/A4FC: 99 00 00     STA $0000,Y
01/A4FF: A9 51        LDA #$51
01/A501: 99 02 00     STA $0002,Y
01/A504: 99 42 00     STA $0042,Y
01/A507: A9 4E        LDA #$4E
01/A509: 99 40 00     STA $0040,Y
01/A50C: A9 C7        LDA #$C7
01/A50E: 99 0E 00     STA $000E,Y
01/A511: 99 4E 00     STA $004E,Y
01/A514: C2 20        REP #$20
01/A516: A6 51        LDX $51
01/A518: E8           INX 
01/A519: E8           INX 
01/A51A: A9 46 00     LDA #$0046
01/A51D: A0 07 00     LDY #$0007
01/A520: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/A523: A9 50 00     LDA #$0050
01/A526: A0 09 00     LDY #$0009
01/A529: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/A52C: A9 86 00     LDA #$0086
01/A52F: A0 0B 00     LDY #$000B
01/A532: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/A535: A9 90 00     LDA #$0090
01/A538: A0 0D 00     LDY #$000D
01/A53B: 20 2A 8A     JSR $8A2A       ; draw hp/mp text
01/A53E: E2 20        SEP #$20
01/A540: 60           RTS 

; [  ]

01/A541: 20 0F A9     JSR $A90F
01/A544: D0 0F        BNE $A555
01/A546: AD 3E 1B     LDA $1B3E
01/A549: 1A           INC 
01/A54A: C9 05        CMP #$05
01/A54C: D0 02        BNE $A550
01/A54E: A9 00        LDA #$00
01/A550: 8D 3E 1B     STA $1B3E
01/A553: 80 EC        BRA $A541
01/A555: AD 22 1B     LDA $1B22
01/A558: D0 04        BNE $A55E
01/A55A: A9 70        LDA #$70
01/A55C: 80 02        BRA $A560
01/A55E: A9 08        LDA #$08
01/A560: 85 5D        STA $5D
01/A562: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/A565: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/A568: A5 01        LDA $01
01/A56A: 29 08        AND #$08
01/A56C: F0 10        BEQ $A57E
01/A56E: AD 3E 1B     LDA $1B3E
01/A571: 3A           DEC 
01/A572: 10 02        BPL $A576
01/A574: A9 04        LDA #$04
01/A576: 8D 3E 1B     STA $1B3E
01/A579: 20 0F A9     JSR $A90F
01/A57C: F0 F0        BEQ $A56E
01/A57E: A5 01        LDA $01
01/A580: 29 04        AND #$04
01/A582: F0 12        BEQ $A596
01/A584: AD 3E 1B     LDA $1B3E
01/A587: 1A           INC 
01/A588: C9 05        CMP #$05
01/A58A: 90 02        BCC $A58E
01/A58C: A9 00        LDA #$00
01/A58E: 8D 3E 1B     STA $1B3E
01/A591: 20 0F A9     JSR $A90F
01/A594: F0 EE        BEQ $A584
01/A596: A5 00        LDA $00
01/A598: 29 80        AND #$80
01/A59A: F0 0D        BEQ $A5A9
01/A59C: AD 3E 1B     LDA $1B3E
01/A59F: 20 B4 87     JSR $87B4       ; tax
01/A5A2: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/A5A6: 85 E8        STA $E8
01/A5A8: 60           RTS 
01/A5A9: A5 01        LDA $01
01/A5AB: 29 80        AND #$80
01/A5AD: F0 05        BEQ $A5B4
01/A5AF: A9 FF        LDA #$FF
01/A5B1: 85 E8        STA $E8
01/A5B3: 60           RTS 
01/A5B4: AD 3E 1B     LDA $1B3E
01/A5B7: 0A           ASL 
01/A5B8: 0A           ASL 
01/A5B9: 0A           ASL 
01/A5BA: 0A           ASL 
01/A5BB: 0A           ASL 
01/A5BC: 69 40        ADC #$40
01/A5BE: 85 5E        STA $5E
01/A5C0: A9 00        LDA #$00
01/A5C2: A6 5D        LDX $5D
01/A5C4: A0 00 03     LDY #$0300
01/A5C7: 20 86 82     JSR $8286
01/A5CA: 4C 62 A5     JMP $A562

; [ calculate potion/ether effect ]

01/A5CD: A0 03 00     LDY #$0003
01/A5D0: B1 60        LDA ($60),Y
01/A5D2: 29 C0        AND #$C0
01/A5D4: F0 3B        BEQ $A611       ; branch if not dead or stone
01/A5D6: A0 EE DC     LDY #$DCEE      ;  (doesn't work)
01/A5D9: EE 82 1A     INC $1A82
01/A5DC: 5A           PHY 
01/A5DD: 20 BA 84     JSR $84BA       ; select bg2
01/A5E0: A0 DA DC     LDY #$DCDA
01/A5E3: 20 D9 80     JSR $80D9       ; draw window
01/A5E6: 7A           PLY 
01/A5E7: 20 01 83     JSR $8301       ; draw positioned text
01/A5EA: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A5ED: AE 3C 1B     LDX $1B3C
01/A5F0: AD 3B 1B     LDA $1B3B
01/A5F3: 9D 40 14     STA $1440,X
01/A5F6: FE 41 14     INC $1441,X
01/A5F9: FA           PLX 
01/A5FA: A5 E8        LDA $E8
01/A5FC: C9 03        CMP #$03
01/A5FE: D0 0B        BNE $A60B
01/A600: AD 22 1B     LDA $1B22
01/A603: D0 06        BNE $A60B
01/A605: 20 F2 A2     JSR $A2F2
01/A608: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/A60B: 20 58 87     JSR $8758       ; error sound effect
01/A60E: 4C 36 83     JMP $8336
01/A611: 7B           TDC 
01/A612: EB           XBA 
01/A613: AD 3B 1B     LDA $1B3B
01/A616: 38           SEC 
01/A617: E9 B0        SBC #$B0
01/A619: C2 20        REP #$20
01/A61B: 0A           ASL 
01/A61C: 85 45        STA $45         ; multiply by 6
01/A61E: 0A           ASL 
01/A61F: 65 45        ADC $45
01/A621: AA           TAX 
01/A622: E2 20        SEP #$20
01/A624: 7B           TDC 
01/A625: EB           XBA 
01/A626: BF 81 96 0F  LDA $0F9681,X   ; item properties, byte 1 (power)
01/A62A: C2 20        REP #$20
01/A62C: 0A           ASL 
01/A62D: 0A           ASL 
01/A62E: 0A           ASL 
01/A62F: 0A           ASL 
01/A630: 8D 84 1A     STA $1A84
01/A633: 0A           ASL 
01/A634: 6D 84 1A     ADC $1A84       ; power * 48
01/A637: 85 45        STA $45
01/A639: E2 20        SEP #$20
01/A63B: 4C 60 87     JMP $8760       ; cure sound effect

; potion/cure
01/A63E: 20 CD A5     JSR $A5CD       ; calculate potion/ether effect
01/A641: A0 07 00     LDY #$0007
01/A644: C2 20        REP #$20
01/A646: B1 60        LDA ($60),Y     ; add to current hp
01/A648: 18           CLC 
01/A649: 65 45        ADC $45
01/A64B: C8           INY 
01/A64C: C8           INY 
01/A64D: D1 60        CMP ($60),Y
01/A64F: 90 02        BCC $A653
01/A651: B1 60        LDA ($60),Y     ; set hp to max
01/A653: 88           DEY 
01/A654: 88           DEY 
01/A655: 91 60        STA ($60),Y
01/A657: E2 20        SEP #$20
01/A659: 60           RTS 
; ether
01/A65A: 20 CD A5     JSR $A5CD       ; calculate potion/ether effect
01/A65D: A0 0B 00     LDY #$000B      ; current mp
01/A660: 80 E2        BRA $A644
; elixir
01/A662: 20 CD A5     JSR $A5CD       ; calculate potion/ether effect
01/A665: C2 20        REP #$20
01/A667: A0 09 00     LDY #$0009
01/A66A: B1 60        LDA ($60),Y     ; set hp to max
01/A66C: 88           DEY 
01/A66D: 88           DEY 
01/A66E: 91 60        STA ($60),Y
01/A670: A0 0D 00     LDY #$000D
01/A673: B1 60        LDA ($60),Y     ; set mp to max
01/A675: 88           DEY 
01/A676: 88           DEY 
01/A677: 91 60        STA ($60),Y
01/A679: E2 20        SEP #$20
01/A67B: 60           RTS 

; item effect jump table ($CE-$EA)
01/A67C:                               A63E A63E
01/A680: A63E A65A A65A A662 A6B6 A79A A79A A79A  ; $D0
01/A690: A79A A79A A79A A79A A79A A6EB A88E A759
01/A6A0: A773 A780 A855 A855 A85D A868 A871 A897  ; $E0
01/A6B0: A897 A897 A897

; phoenix tail
01/A6B6: A0 03 00     LDY #$0003
01/A6B9: B1 60        LDA ($60),Y
01/A6BB: 29 80        AND #$80
01/A6BD: D0 06        BNE $A6C5       ; branch if dead
01/A6BF: A0 DE DC     LDY #$DCDE      ;  (not necessary)
01/A6C2: 20 D9 A5     JSR $A5D9
01/A6C5: A0 16 00     LDY #$0016
01/A6C8: B1 60        LDA ($60),Y     ; mod. vitality * 5
01/A6CA: 85 43        STA $43
01/A6CC: C2 20        REP #$20
01/A6CE: A5 43        LDA $43
01/A6D0: 0A           ASL 
01/A6D1: 0A           ASL 
01/A6D2: 65 43        ADC $43
01/A6D4: A0 07 00     LDY #$0007
01/A6D7: D1 60        CMP ($60),Y
01/A6D9: 90 02        BCC $A6DD
01/A6DB: 91 60        STA ($60),Y     ; set hp
01/A6DD: E2 20        SEP #$20
01/A6DF: A0 03 00     LDY #$0003
01/A6E2: B1 60        LDA ($60),Y     ; clear dead status
01/A6E4: 29 7F        AND #$7F
01/A6E6: 91 60        STA ($60),Y
01/A6E8: 4C 60 87     JMP $8760       ; cure sound effect
; panacea
01/A6EB: A0 03 00     LDY #$0003
01/A6EE: B1 60        LDA ($60),Y
01/A6F0: 10 06        BPL $A6F8       ; branch if not dead
01/A6F2: A0 EE DC     LDY #$DCEE      ;  (doesn't work)
01/A6F5: 20 D9 A5     JSR $A5D9
01/A6F8: A9 00        LDA #$00
01/A6FA: 91 60        STA ($60),Y
01/A6FC: C8           INY 
01/A6FD: B1 60        LDA ($60),Y
01/A6FF: 29 7F        AND #$7F
01/A701: 91 60        STA ($60),Y
01/A703: 4C 60 87     JMP $8760       ; cure sound effect

; [ use consumable item ($CE-$EA) ]

01/A706: C9 DE        CMP #$DE        ; alarm
01/A708: F0 10        BEQ $A71A
01/A70A: C9 E2        CMP #$E2
01/A70C: B0 0C        BCS $A71A
01/A70E: 20 81 A4     JSR $A481
01/A711: A5 E8        LDA $E8
01/A713: 30 35        BMI $A74A
01/A715: 20 01 90     JSR $9001       ; get pointer to character properties
01/A718: 86 60        STX $60
01/A71A: AE 3C 1B     LDX $1B3C
01/A71D: DE 41 14     DEC $1441,X     ; decrement quantity
01/A720: D0 03        BNE $A725
01/A722: 9E 40 14     STZ $1440,X
01/A725: AD 3B 1B     LDA $1B3B
01/A728: 38           SEC 
01/A729: E9 CE        SBC #$CE
01/A72B: A2 7C A6     LDX #$A67C      ; item effect jump table
01/A72E: 20 4B 83     JSR $834B       ; do jump table
01/A731: AD 3B 1B     LDA $1B3B
01/A734: C9 DE        CMP #$DE
01/A736: F0 12        BEQ $A74A
01/A738: C9 E2        CMP #$E2
01/A73A: B0 0E        BCS $A74A
01/A73C: AD 82 1A     LDA $1A82
01/A73F: D0 09        BNE $A74A
01/A741: 20 23 A4     JSR $A423
01/A744: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A747: 20 36 83     JSR $8336
01/A74A: 9C 82 1A     STZ $1A82
01/A74D: 20 B7 84     JSR $84B7       ; select and clear bg2
01/A750: A0 FC DC     LDY #$DCFC
01/A753: 20 FB 82     JSR $82FB       ; draw window and text
01/A756: 4C 20 94     JMP $9420       ; transfer bg2 screen buffer to vram

; golden apple
01/A759: C2 20        REP #$20
01/A75B: A0 09 00     LDY #$0009
01/A75E: B1 60        LDA ($60),Y
01/A760: 18           CLC 
01/A761: 69 64 00     ADC #$0064      ; add 100 to max hp
01/A764: C9 0F 27     CMP #$270F
01/A767: 90 03        BCC $A76C
01/A769: A9 0F 27     LDA #$270F      ; max 9999
01/A76C: 91 60        STA ($60),Y
01/A76E: E2 20        SEP #$20
01/A770: 4C 60 87     JMP $8760       ; cure sound effect
; silver apple
01/A773: C2 20        REP #$20
01/A775: A0 09 00     LDY #$0009
01/A778: B1 60        LDA ($60),Y
01/A77A: 18           CLC 
01/A77B: 69 32 00     ADC #$0032      ; add 50 to max hp
01/A77E: 80 E4        BRA $A764
; $E1: soma drop
01/A780: C2 20        REP #$20
01/A782: A0 0D 00     LDY #$000D
01/A785: B1 60        LDA ($60),Y
01/A787: 18           CLC 
01/A788: 69 0A 00     ADC #$000A      ; add 10 to max mp
01/A78B: C9 E7 03     CMP #$03E7
01/A78E: 90 03        BCC $A793
01/A790: A9 E7 03     LDA #$03E7      ; max 999
01/A793: 91 60        STA ($60),Y
01/A795: E2 20        SEP #$20
01/A797: 4C 60 87     JMP $8760       ; cure sound effect
; $D5-$DD: status restoring items
01/A79A: AD 3B 1B     LDA $1B3B
01/A79D: 38           SEC 
01/A79E: E9 D5        SBC #$D5
01/A7A0: 0A           ASL 
01/A7A1: 85 43        STA $43
01/A7A3: A6 43        LDX $43
01/A7A5: A0 03 00     LDY #$0003
01/A7A8: C2 20        REP #$20
01/A7AA: B1 60        LDA ($60),Y
01/A7AC: 85 45        STA $45
01/A7AE: 3F C3 FE 1E  AND $1EFEC3,X   ; status mask for items $D5-$DD
01/A7B2: 91 60        STA ($60),Y
01/A7B4: C5 45        CMP $45
01/A7B6: F0 05        BEQ $A7BD
01/A7B8: E2 20        SEP #$20
01/A7BA: 4C 60 87     JMP $8760       ; cure sound effect
01/A7BD: E2 20        SEP #$20
01/A7BF: A0 DE DC     LDY #$DCDE      ;  (not necessary)
01/A7C2: 20 D9 A5     JSR $A5D9
01/A7C5: 20 BA 84     JSR $84BA       ; select bg2
01/A7C8: AD 23 1B     LDA $1B23
01/A7CB: 18           CLC 
01/A7CC: 6D 1A 1B     ADC $1B1A
01/A7CF: 0A           ASL 
01/A7D0: 6D 22 1B     ADC $1B22
01/A7D3: 0A           ASL 
01/A7D4: 20 B4 87     JSR $87B4       ; tax
01/A7D7: BD 40 14     LDA $1440,X
01/A7DA: 48           PHA 
01/A7DB: A0 D6 DC     LDY #$DCD6
01/A7DE: 20 D9 80     JSR $80D9       ; draw window
01/A7E1: 68           PLA 
01/A7E2: C9 CE        CMP #$CE
01/A7E4: 90 2B        BCC $A811
01/A7E6: C9 E7        CMP #$E7
01/A7E8: B0 27        BCS $A811
01/A7EA: 38           SEC 
01/A7EB: E9 CE        SBC #$CE
01/A7ED: 20 B4 87     JSR $87B4       ; tax
01/A7F0: BF 00 AE 0F  LDA $0FAE00,X   ; description id for each item
01/A7F4: 85 45        STA $45
01/A7F6: A2 2A AE     LDX #$AE2A      ; item descriptions
01/A7F9: F0 0C        BEQ $A807
01/A7FB: E8           INX 
01/A7FC: BF 00 00 0F  LDA $0F0000,X
01/A800: D0 F7        BNE $A7F9
01/A802: C6 45        DEC $45
01/A804: D0 F3        BNE $A7F9
01/A806: E8           INX 
01/A807: 9B           TXY 
01/A808: A9 0F        LDA #$0F
01/A80A: A2 54 00     LDX #$0054
01/A80D: 20 E4 82     JSR $82E4       ; draw text (bank 0F)
01/A810: 60           RTS 
01/A811: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/A814: A0 FC DC     LDY #$DCFC
01/A817: 4C FB 82     JMP $82FB       ; draw window and text

; [  ]

01/A81A: C2 20        REP #$20
01/A81C: A5 5D        LDA $5D
01/A81E: 4A           LSR 
01/A81F: 0A           ASL 
01/A820: 0A           ASL 
01/A821: 0A           ASL 
01/A822: 0A           ASL 
01/A823: 0A           ASL 
01/A824: 0A           ASL 
01/A825: 0A           ASL 
01/A826: 85 45        STA $45
01/A828: A5 5D        LDA $5D
01/A82A: 29 01 00     AND #$0001
01/A82D: F0 03        BEQ $A832
01/A82F: A9 20 00     LDA #$0020
01/A832: 65 45        ADC $45
01/A834: 18           CLC 
01/A835: 65 29        ADC $29
01/A837: 69 4A 00     ADC #$004A
01/A83A: A8           TAY 
01/A83B: E2 20        SEP #$20
01/A83D: A9 04        LDA #$04
01/A83F: 99 00 00     STA $0000,Y
01/A842: 1A           INC 
01/A843: 99 02 00     STA $0002,Y
01/A846: 1A           INC 
01/A847: 99 40 00     STA $0040,Y
01/A84A: 1A           INC 
01/A84B: 99 42 00     STA $0042,Y
01/A84E: 60           RTS 

; can't use item
01/A84F: 9C 03 1A     STZ $1A03
01/A852: 4C ED A5     JMP $A5ED
; tent/cottage
01/A855: AD 02 1A     LDA $1A02
01/A858: D0 1E        BNE $A878
01/A85A: 4C ED A5     JMP $A5ED
; $E4: naughty book
01/A85D: AD 04 1A     LDA $1A04
01/A860: 29 80        AND #$80
01/A862: F0 EB        BEQ $A84F
01/A864: A9 07        LDA #$07
01/A866: 80 16        BRA $A87E
; $E5: emergency exit
01/A868: AD 04 1A     LDA $1A04
01/A86B: 29 20        AND #$20
01/A86D: F0 E0        BEQ $A84F
01/A86F: 80 07        BRA $A878
; $E6: dwarven bread
01/A871: AD 04 1A     LDA $1A04
01/A874: 29 40        AND #$40
01/A876: F0 D7        BEQ $A84F
01/A878: AD 3B 1B     LDA $1B3B
01/A87B: 38           SEC 
01/A87C: E9 E1        SBC #$E1
01/A87E: 8D 03 1A     STA $1A03
01/A881: 9C 19 1B     STZ $1B19
01/A884: A6 93        LDX $93
01/A886: 8E A5 1B     STX $1BA5
01/A889: AE 65 1A     LDX $1A65
01/A88C: 9A           TXS 
01/A88D: 60           RTS 
; $DE: alarm
01/A88E: A9 3C        LDA #$3C
01/A890: 20 62 87     JSR $8762       ; play sound effect
01/A893: A9 06        LDA #$06
01/A895: 80 E7        BRA $A87E
; $E7-$EA: summon items
01/A897: 64 45        STZ $45
01/A899: A5 45        LDA $45
01/A89B: 20 19 A9     JSR $A919       ; get character id
01/A89E: C9 03        CMP #$03
01/A8A0: F0 11        BEQ $A8B3       ; branch if rydia (girl)
01/A8A2: C9 11        CMP #$11
01/A8A4: F0 0D        BEQ $A8B3       ; branch if rydia (adult)
01/A8A6: E6 45        INC $45         ; check next character slot
01/A8A8: A5 45        LDA $45
01/A8AA: C9 05        CMP #$05
01/A8AC: D0 EB        BNE $A899
01/A8AE: C2 10        REP #$10
01/A8B0: 4C ED A5     JMP $A5ED
01/A8B3: 85 ED        STA $ED
01/A8B5: AD 3B 1B     LDA $1B3B
01/A8B8: 38           SEC 
01/A8B9: E9 B6        SBC #$B6        ; get spell id from summon item id
01/A8BB: 85 45        STA $45
01/A8BD: E2 10        SEP #$10
01/A8BF: A4 41        LDY $41         ; zero
01/A8C1: B9 C0 15     LDA $15C0,Y
01/A8C4: C5 45        CMP $45
01/A8C6: F0 E6        BEQ $A8AE       ; branch if spell is already known
01/A8C8: C8           INY 
01/A8C9: C0 18        CPY #$18
01/A8CB: D0 F4        BNE $A8C1
01/A8CD: A4 41        LDY $41         ; zero
01/A8CF: B9 C0 15     LDA $15C0,Y
01/A8D2: F0 05        BEQ $A8D9       ; find an empty slot in the spell list
01/A8D4: C8           INY 
01/A8D5: C0 18        CPY #$18
01/A8D7: D0 F6        BNE $A8CF
01/A8D9: A5 45        LDA $45
01/A8DB: 99 C0 15     STA $15C0,Y
01/A8DE: 48           PHA 
01/A8DF: C2 10        REP #$10
01/A8E1: 20 BA 84     JSR $84BA       ; select bg2
01/A8E4: A0 BD E2     LDY #$E2BD      ; summon item message
01/A8E7: 20 FB 82     JSR $82FB       ; draw window and text
01/A8EA: A0 9A 02     LDY #$029A      ; (13,10)
01/A8ED: A5 ED        LDA $ED
01/A8EF: 20 AB 83     JSR $83AB       ; draw character name
01/A8F2: EE C8 1B     INC $1BC8
01/A8F5: 68           PLA 
01/A8F6: A2 1A 03     LDX #$031A      ; (15,10)
01/A8F9: 20 A6 B2     JSR $B2A6       ; draw spell name
01/A8FC: 9C C8 1B     STZ $1BC8
01/A8FF: 20 E3 83     JSR $83E3       ; open window
01/A902: 22 00 C6 0F  JSL $0FC600     ; play fanfare
01/A906: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/A909: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A90C: C2 10        REP #$10
01/A90E: 60           RTS 

; [  ]

01/A90F: AD 3E 1B     LDA $1B3E
; get character id (battle order)
01/A912: 20 B4 87     JSR $87B4       ; tax
01/A915: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
; fallthrough

; [ get character id ]

01/A919: 20 01 90     JSR $9001       ; get pointer to character properties
01/A91C: BD 00 00     LDA $0000,X
01/A91F: 29 3F        AND #$3F
01/A921: 60           RTS 

; [ sort inventory ]

01/A922: A9 63        LDA #$63
01/A924: 85 E3        STA $E3
01/A926: A2 40 14     LDX #$1440
01/A929: 20 2A AE     JSR $AE2A       ; sort items
01/A92C: 4C 60 87     JMP $8760       ; cure sound effect

; --------------------------------------------------------------------------

; [ status menu ]

01/A92F: EE C2 1B     INC $1BC2
01/A932: 20 39 A9     JSR $A939
01/A935: 9C C2 1B     STZ $1BC2
01/A938: 60           RTS 

; [  ]

01/A939: 9C 27 1B     STZ $1B27
01/A93C: 20 52 8A     JSR $8A52       ; select character (main menu)
01/A93F: A5 E8        LDA $E8
01/A941: 10 01        BPL $A944
01/A943: 60           RTS 
01/A944: A5 E8        LDA $E8
01/A946: 20 01 90     JSR $9001       ; get pointer to character properties
01/A949: 86 60        STX $60
01/A94B: B2 60        LDA ($60)
01/A94D: 29 3F        AND #$3F
01/A94F: D0 01        BNE $A952
01/A951: 60           RTS 
01/A952: 20 A9 94     JSR $94A9
01/A955: 20 C6 94     JSR $94C6
01/A958: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/A95B: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/A95E: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/A961: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/A964: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/A967: A9 0C        LDA #$0C
01/A969: 85 C2        STA $C2
01/A96B: A9 04        LDA #$04
01/A96D: 85 B1        STA $B1
01/A96F: 85 A5        STA $A5
01/A971: 20 88 84     JSR $8488       ; select bg4
01/A974: A0 70 02     LDY #$0270      ; (19,16)
01/A977: A9 05        LDA #$05        ; 5 tiles wide
01/A979: 18           CLC             ; set tiles to zero
01/A97A: 20 79 87     JSR $8779       ; clear text
01/A97D: A0 6D DB     LDY #$DB6D      ; main menu options
01/A980: A2 05 DE     LDX #$DE05
01/A983: 20 D0 84     JSR $84D0       ; transform window
01/A986: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/A989: A9 30        LDA #$30        ; sprite layer priority: 3
01/A98B: 85 C1        STA $C1
01/A98D: A5 E8        LDA $E8
01/A98F: A0 98 08     LDY #$0898
01/A992: 20 6E 8E     JSR $8E6E       ; draw portrait
01/A995: 20 BA 84     JSR $84BA       ; select bg2
01/A998: A0 05 DE     LDY #$DE05
01/A99B: 20 D9 80     JSR $80D9       ; draw window
01/A99E: A0 09 DE     LDY #$DE09
01/A9A1: 20 01 83     JSR $8301       ; draw positioned text
01/A9A4: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/A9A7: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/A9AA: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/A9AD: 20 A2 84     JSR $84A2       ; select bg1
01/A9B0: 20 B6 AB     JSR $ABB6
01/A9B3: B2 60        LDA ($60)
01/A9B5: 29 3F        AND #$3F
01/A9B7: A0 84 00     LDY #$0084
01/A9BA: 20 AB 83     JSR $83AB       ; draw character name
01/A9BD: A0 88 00     LDY #$0088
01/A9C0: A6 60        LDX $60
01/A9C2: 20 00 8B     JSR $8B00
01/A9C5: A0 02 00     LDY #$0002
01/A9C8: B1 60        LDA ($60),Y
01/A9CA: A0 5C 01     LDY #$015C
01/A9CD: 20 69 83     JSR $8369       ; draw 2-digit number
01/A9D0: A0 14 00     LDY #$0014
01/A9D3: B1 60        LDA ($60),Y
01/A9D5: A0 12 04     LDY #$0412
01/A9D8: 20 69 83     JSR $8369       ; draw 2-digit number
01/A9DB: A0 15 00     LDY #$0015
01/A9DE: B1 60        LDA ($60),Y
01/A9E0: A0 92 04     LDY #$0492
01/A9E3: 20 69 83     JSR $8369       ; draw 2-digit number
01/A9E6: A0 16 00     LDY #$0016
01/A9E9: B1 60        LDA ($60),Y
01/A9EB: A0 12 05     LDY #$0512
01/A9EE: 20 69 83     JSR $8369       ; draw 2-digit number
01/A9F1: A0 17 00     LDY #$0017
01/A9F4: B1 60        LDA ($60),Y
01/A9F6: A0 92 05     LDY #$0592
01/A9F9: 20 69 83     JSR $8369       ; draw 2-digit number
01/A9FC: A0 18 00     LDY #$0018
01/A9FF: B1 60        LDA ($60),Y
01/AA01: A0 12 06     LDY #$0612
01/AA04: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA07: A0 1B 00     LDY #$001B
01/AA0A: B1 60        LDA ($60),Y
01/AA0C: A0 AA 03     LDY #$03AA
01/AA0F: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA12: A0 28 00     LDY #$0028
01/AA15: B1 60        LDA ($60),Y
01/AA17: A0 AA 04     LDY #$04AA
01/AA1A: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA1D: A0 22 00     LDY #$0022
01/AA20: B1 60        LDA ($60),Y
01/AA22: A0 AA 05     LDY #$05AA
01/AA25: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA28: A0 1C 00     LDY #$001C
01/AA2B: B1 60        LDA ($60),Y
01/AA2D: A0 34 04     LDY #$0434
01/AA30: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA33: A0 29 00     LDY #$0029
01/AA36: B1 60        LDA ($60),Y
01/AA38: A0 34 05     LDY #$0534
01/AA3B: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA3E: A0 23 00     LDY #$0023
01/AA41: B1 60        LDA ($60),Y
01/AA43: A0 34 06     LDY #$0634
01/AA46: 20 69 83     JSR $8369       ; draw 2-digit number
01/AA49: A0 37 00     LDY #$0037
01/AA4C: B1 60        LDA ($60),Y
01/AA4E: 85 45        STA $45
01/AA50: C8           INY 
01/AA51: B1 60        LDA ($60),Y
01/AA53: 85 46        STA $46
01/AA55: C8           INY 
01/AA56: B1 60        LDA ($60),Y
01/AA58: A6 45        LDX $45
01/AA5A: A0 26 02     LDY #$0226
01/AA5D: 20 A6 8F     JSR $8FA6       ; draw number text (7 digits)
01/AA60: C2 20        REP #$20
01/AA62: A0 07 00     LDY #$0007
01/AA65: B1 60        LDA ($60),Y
01/AA67: A0 88 02     LDY #$0288
01/AA6A: 20 83 83     JSR $8383
01/AA6D: A0 09 00     LDY #$0009
01/AA70: B1 60        LDA ($60),Y
01/AA72: A0 92 02     LDY #$0292
01/AA75: 20 83 83     JSR $8383
01/AA78: A0 0B 00     LDY #$000B
01/AA7B: B1 60        LDA ($60),Y
01/AA7D: A0 08 03     LDY #$0308
01/AA80: 20 83 83     JSR $8383
01/AA83: A0 0D 00     LDY #$000D
01/AA86: B1 60        LDA ($60),Y
01/AA88: A0 12 03     LDY #$0312
01/AA8B: 20 83 83     JSR $8383
01/AA8E: E2 20        SEP #$20
01/AA90: 7B           TDC 
01/AA91: EB           XBA 
01/AA92: A0 1D 00     LDY #$001D
01/AA95: B1 60        LDA ($60),Y
01/AA97: A0 B2 03     LDY #$03B2
01/AA9A: 20 7F 83     JSR $837F       ; draw 4-digit number
01/AA9D: A0 2A 00     LDY #$002A
01/AAA0: B1 60        LDA ($60),Y
01/AAA2: A0 B2 04     LDY #$04B2
01/AAA5: 20 7F 83     JSR $837F       ; draw 4-digit number
01/AAA8: A0 24 00     LDY #$0024
01/AAAB: B1 60        LDA ($60),Y
01/AAAD: A0 B2 05     LDY #$05B2
01/AAB0: 20 7F 83     JSR $837F       ; draw 4-digit number
01/AAB3: B2 60        LDA ($60)
01/AAB5: 29 C0        AND #$C0
01/AAB7: 4A           LSR 
01/AAB8: 4A           LSR 
01/AAB9: 4A           LSR 
01/AABA: 85 45        STA $45
01/AABC: 64 46        STZ $46
01/AABE: C2 20        REP #$20
01/AAC0: A9 D9 E2     LDA #$E2D9
01/AAC3: 18           CLC 
01/AAC4: 65 45        ADC $45
01/AAC6: A8           TAY 
01/AAC7: E2 20        SEP #$20
01/AAC9: A2 86 01     LDX #$0186
01/AACC: 20 CD 82     JSR $82CD       ; draw text
01/AACF: A0 01 00     LDY #$0001
01/AAD2: B1 60        LDA ($60),Y
01/AAD4: A0 06 01     LDY #$0106
01/AAD7: 20 C6 8F     JSR $8FC6
01/AADA: 20 C2 AB     JSR $ABC2
01/AADD: A0 02 00     LDY #$0002
01/AAE0: B1 60        LDA ($60),Y
01/AAE2: C9 63        CMP #$63
01/AAE4: D0 03        BNE $AAE9
01/AAE6: 4C 70 AB     JMP $AB70
01/AAE9: A0 98 DE     LDY #$DE98
01/AAEC: 20 01 83     JSR $8301       ; draw positioned text
01/AAEF: A0 3D 00     LDY #$003D
01/AAF2: B1 60        LDA ($60),Y
01/AAF4: 85 45        STA $45
01/AAF6: C8           INY 
01/AAF7: B1 60        LDA ($60),Y
01/AAF9: 85 46        STA $46
01/AAFB: C8           INY 
01/AAFC: B1 60        LDA ($60),Y
01/AAFE: 85 47        STA $47
01/AB00: B2 60        LDA ($60)
01/AB02: 29 3F        AND #$3F
01/AB04: 3A           DEC 
01/AB05: 0A           ASL 
01/AB06: 20 B4 87     JSR $87B4       ; tax
01/AB09: C2 20        REP #$20
01/AB0B: BF 00 B5 0F  LDA $0FB500,X
01/AB0F: 85 48        STA $48
01/AB11: E2 20        SEP #$20
01/AB13: A0 02 00     LDY #$0002
01/AB16: B1 60        LDA ($60),Y
01/AB18: C9 45        CMP #$45
01/AB1A: 90 02        BCC $AB1E
01/AB1C: A9 45        LDA #$45
01/AB1E: 3A           DEC 
01/AB1F: 85 43        STA $43
01/AB21: C2 20        REP #$20
01/AB23: A5 43        LDA $43
01/AB25: 0A           ASL 
01/AB26: 0A           ASL 
01/AB27: 65 43        ADC $43
01/AB29: 65 48        ADC $48
01/AB2B: 69 02 00     ADC #$0002
01/AB2E: AA           TAX 
01/AB2F: E2 20        SEP #$20
01/AB31: BF 00 00 0F  LDA $0F0000,X
01/AB35: 4A           LSR 
01/AB36: 4A           LSR 
01/AB37: 4A           LSR 
01/AB38: 4A           LSR 
01/AB39: 4A           LSR 
01/AB3A: 85 4B        STA $4B
01/AB3C: E8           INX 
01/AB3D: C2 20        REP #$20
01/AB3F: BF 00 00 0F  LDA $0F0000,X
01/AB43: 18           CLC 
01/AB44: 65 45        ADC $45
01/AB46: 85 45        STA $45
01/AB48: E2 20        SEP #$20
01/AB4A: A5 47        LDA $47
01/AB4C: 65 4B        ADC $4B
01/AB4E: 85 47        STA $47
01/AB50: A0 37 00     LDY #$0037
01/AB53: C2 20        REP #$20
01/AB55: A5 45        LDA $45
01/AB57: 38           SEC 
01/AB58: F1 60        SBC ($60),Y
01/AB5A: 85 45        STA $45
01/AB5C: E2 20        SEP #$20
01/AB5E: C8           INY 
01/AB5F: C8           INY 
01/AB60: A5 47        LDA $47
01/AB62: F1 60        SBC ($60),Y
01/AB64: 85 47        STA $47
01/AB66: A0 E6 02     LDY #$02E6
01/AB69: A5 47        LDA $47
01/AB6B: A6 45        LDX $45
01/AB6D: 20 A6 8F     JSR $8FA6       ; draw number text (7 digits)
01/AB70: 20 E3 83     JSR $83E3       ; open window
01/AB73: 20 E8 94     JSR $94E8
01/AB76: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/AB79: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/AB7C: 20 36 83     JSR $8336
01/AB7F: 20 17 84     JSR $8417       ; close window
01/AB82: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/AB85: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/AB88: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/AB8B: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/AB8E: A9 0C        LDA #$0C
01/AB90: 85 C2        STA $C2
01/AB92: A9 84        LDA #$84
01/AB94: 85 B1        STA $B1
01/AB96: 85 A5        STA $A5
01/AB98: 20 88 84     JSR $8488       ; select bg4
01/AB9B: A2 6D DB     LDX #$DB6D      ; main menu options
01/AB9E: A0 05 DE     LDY #$DE05
01/ABA1: 20 D0 84     JSR $84D0       ; transform window
01/ABA4: 9C C2 1B     STZ $1BC2
01/ABA7: 20 19 89     JSR $8919       ; draw main menu
01/ABAA: 20 FD 88     JSR $88FD
01/ABAD: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/ABB0: 20 17 84     JSR $8417       ; close window
01/ABB3: 4C A9 94     JMP $94A9

; [ draw status window ??? ]

01/ABB6: A0 01 DE     LDY #$DE01
01/ABB9: 20 D9 80     JSR $80D9       ; draw window
01/ABBC: A0 11 DE     LDY #$DE11
01/ABBF: 20 01 83     JSR $8301       ; draw positioned text
01/ABC2: A9 C3        LDA #$C3
01/ABC4: 8D 10 BA     STA $BA10
01/ABC7: 8D 90 BA     STA $BA90
01/ABCA: 8D 10 BB     STA $BB10
01/ABCD: 8D 90 BB     STA $BB90
01/ABD0: 8D 10 BC     STA $BC10
01/ABD3: 8D B2 B9     STA $B9B2
01/ABD6: 8D 32 BA     STA $BA32
01/ABD9: 8D B2 BA     STA $BAB2
01/ABDC: 8D 32 BB     STA $BB32
01/ABDF: 8D B2 BB     STA $BBB2
01/ABE2: 8D 32 BC     STA $BC32
01/ABE5: A9 C6        LDA #$C6
01/ABE7: 8D 38 BA     STA $BA38
01/ABEA: 8D 38 BB     STA $BB38
01/ABED: 8D 38 BC     STA $BC38
01/ABF0: A9 C7        LDA #$C7
01/ABF2: 8D 90 B8     STA $B890
01/ABF5: 8D 10 B9     STA $B910
01/ABF8: 60           RTS 

; --------------------------------------------------------------------------

; [ order (main menu) ]

01/ABF9: 20 00 AC     JSR $AC00
01/ABFC: 9C B8 1B     STZ $1BB8
01/ABFF: 60           RTS 
01/AC00: EE 27 1B     INC $1B27
01/AC03: EE B8 1B     INC $1BB8
01/AC06: E6 84        INC $84
01/AC08: 20 52 8A     JSR $8A52       ; select character (main menu)
01/AC0B: A5 E8        LDA $E8
01/AC0D: C9 7F        CMP #$7F
01/AC0F: D0 16        BNE $AC27       ; branch if pressed left or right
01/AC11: A9 01        LDA #$01
01/AC13: 4D A8 16     EOR $16A8
01/AC16: 8D A8 16     STA $16A8
01/AC19: 20 19 89     JSR $8919       ; draw main menu
01/AC1C: 20 C2 87     JSR $87C2       ; draw game time and gp
01/AC1F: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/AC22: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/AC25: 80 E1        BRA $AC08
01/AC27: A5 E8        LDA $E8
01/AC29: 10 03        BPL $AC2E       ; branch if didn't cancel
01/AC2B: 64 E8        STZ $E8
01/AC2D: 60           RTS 
01/AC2E: A5 E7        LDA $E7         ; selected character
01/AC30: 0A           ASL 
01/AC31: 0A           ASL 
01/AC32: 0A           ASL 
01/AC33: 85 45        STA $45
01/AC35: 0A           ASL 
01/AC36: 0A           ASL 
01/AC37: 65 45        ADC $45
01/AC39: 69 14        ADC #$14
01/AC3B: 85 46        STA $46
01/AC3D: A9 04        LDA #$04
01/AC3F: 85 45        STA $45
01/AC41: 20 7C 82     JSR $827C       ; draw cursor sprite
01/AC44: A5 E8        LDA $E8
01/AC46: 85 D9        STA $D9         ; 1st selected character
01/AC48: 9C 27 1B     STZ $1B27
01/AC4B: 20 52 8A     JSR $8A52       ; select character (main menu)
01/AC4E: A5 E8        LDA $E8
01/AC50: 10 08        BPL $AC5A
01/AC52: 64 E8        STZ $E8
01/AC54: 20 DC A2     JSR $A2DC
01/AC57: 4C F2 A2     JMP $A2F2
01/AC5A: 85 DA        STA $DA         ; 2nd selected character
01/AC5C: C5 D9        CMP $D9
01/AC5E: D0 02        BNE $AC62
01/AC60: 80 CC        BRA $AC2E       ; loop if same character
01/AC62: A5 D9        LDA $D9
01/AC64: 20 19 A9     JSR $A919       ; get character id
01/AC67: 85 45        STA $45
01/AC69: A5 DA        LDA $DA
01/AC6B: 20 19 A9     JSR $A919       ; get character id
01/AC6E: 05 45        ORA $45
01/AC70: D0 03        BNE $AC75       ; branch if at least one slot is not empty
01/AC72: 4C DC A2     JMP $A2DC
01/AC75: 20 A0 8D     JSR $8DA0       ; load character graphics
01/AC78: 20 94 AD     JSR $AD94       ; character order change animation
01/AC7B: C2 20        REP #$20
01/AC7D: A5 DA        LDA $DA
01/AC7F: 29 FF 00     AND #$00FF
01/AC82: 0A           ASL 
01/AC83: 0A           ASL 
01/AC84: 0A           ASL 
01/AC85: 0A           ASL 
01/AC86: 0A           ASL 
01/AC87: 0A           ASL 
01/AC88: 69 00 10     ADC #$1000
01/AC8B: AA           TAX 
01/AC8C: DA           PHX 
01/AC8D: A0 00 F6     LDY #$F600      ; swap character properties
01/AC90: A9 3F 00     LDA #$003F
01/AC93: 54 7E 00     MVN $7E,$00
01/AC96: 7A           PLY 
01/AC97: A5 D9        LDA $D9
01/AC99: 29 FF 00     AND #$00FF
01/AC9C: 0A           ASL 
01/AC9D: 0A           ASL 
01/AC9E: 0A           ASL 
01/AC9F: 0A           ASL 
01/ACA0: 0A           ASL 
01/ACA1: 0A           ASL 
01/ACA2: 69 00 10     ADC #$1000
01/ACA5: AA           TAX 
01/ACA6: DA           PHX 
01/ACA7: A9 3F 00     LDA #$003F
01/ACAA: 54 7E 7E     MVN $7E,$7E
01/ACAD: 7A           PLY 
01/ACAE: A2 00 F6     LDX #$F600
01/ACB1: A9 3F 00     LDA #$003F
01/ACB4: 54 7E 7E     MVN $7E,$7E
01/ACB7: E2 20        SEP #$20
01/ACB9: A5 D9        LDA $D9
01/ACBB: 20 B4 87     JSR $87B4       ; tax
01/ACBE: BD B9 16     LDA $16B9,X     ; swap controller for each character
01/ACC1: 48           PHA 
01/ACC2: 9B           TXY 
01/ACC3: A5 DA        LDA $DA
01/ACC5: 20 B4 87     JSR $87B4       ; tax
01/ACC8: BD B9 16     LDA $16B9,X
01/ACCB: 99 B9 16     STA $16B9,Y
01/ACCE: 68           PLA 
01/ACCF: 9D B9 16     STA $16B9,X
01/ACD2: 22 D0 FD 1E  JSL $1EFDD0
01/ACD6: 20 5E 92     JSR $925E       ; load portraits
01/ACD9: 20 DC A2     JSR $A2DC
01/ACDC: 80 0A        BRA $ACE8

; [ row (main menu) ]

01/ACDE: A9 01        LDA #$01        ; toggle row setting
01/ACE0: 4D A8 16     EOR $16A8
01/ACE3: 8D A8 16     STA $16A8
01/ACE6: E6 84        INC $84
01/ACE8: 20 19 89     JSR $8919       ; draw main menu
01/ACEB: 20 C2 87     JSR $87C2       ; draw game time and gp
01/ACEE: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/ACF1: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [  ]

01/ACF4: 0A           ASL 
01/ACF5: 20 B4 87     JSR $87B4       ; tax
01/ACF8: C2 20        REP #$20
01/ACFA: BF 02 AD 01  LDA $01AD02,X
01/ACFE: A8           TAY 
01/ACFF: E2 20        SEP #$20
01/AD01: 60           RTS 

01/AD02: 1C 60 1C 10 1C B0 1C 38 1C 88

; [  ]

01/AD0C: 20 DC A2     JSR $A2DC
01/AD0F: 20 C6 94     JSR $94C6
01/AD12: A9 30        LDA #$30        ; sprite layer priority: 3
01/AD14: 85 C1        STA $C1
01/AD16: A5 D9        LDA $D9
01/AD18: 85 1D        STA $1D
01/AD1A: 20 F4 AC     JSR $ACF4
01/AD1D: 84 1F        STY $1F
01/AD1F: 84 D5        STY $D5
01/AD21: 64 1E        STZ $1E
01/AD23: 20 64 90     JSR $9064       ; draw character
01/AD26: A5 DA        LDA $DA
01/AD28: 85 1D        STA $1D
01/AD2A: 20 F4 AC     JSR $ACF4
01/AD2D: 84 1F        STY $1F
01/AD2F: 84 D7        STY $D7
01/AD31: 64 1E        STZ $1E
01/AD33: 20 64 90     JSR $9064       ; draw character
01/AD36: A5 D9        LDA $D9
01/AD38: 20 F9 AD     JSR $ADF9
01/AD3B: A5 DA        LDA $DA
01/AD3D: 20 F9 AD     JSR $ADF9
01/AD40: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/AD43: 4C B2 80     JMP $80B2       ; transfer palettes to ppu

; [  ]

01/AD46: A5 D9        LDA $D9
01/AD48: 0A           ASL 
01/AD49: 85 43        STA $43
01/AD4B: A6 43        LDX $43
01/AD4D: A5 DA        LDA $DA
01/AD4F: 0A           ASL 
01/AD50: 85 43        STA $43
01/AD52: A4 43        LDY $43
01/AD54: 8B           PHB 
01/AD55: 4B           PHK 
01/AD56: AB           PLB 
01/AD57: C2 20        REP #$20
01/AD59: BD 02 AD     LDA $AD02,X
01/AD5C: 38           SEC 
01/AD5D: F9 02 AD     SBC $AD02,Y
01/AD60: B0 1C        BCS $AD7E
01/AD62: B9 02 AD     LDA $AD02,Y
01/AD65: 38           SEC 
01/AD66: FD 02 AD     SBC $AD02,X
01/AD69: AB           PLB 
01/AD6A: EB           XBA 
01/AD6B: 4A           LSR 
01/AD6C: 4A           LSR 
01/AD6D: 8D 9C 1B     STA $1B9C
01/AD70: A9 00 FC     LDA #$FC00
01/AD73: 8D 9F 1B     STA $1B9F
01/AD76: A9 00 04     LDA #$0400
01/AD79: 8D 9D 1B     STA $1B9D
01/AD7C: 80 13        BRA $AD91
01/AD7E: AB           PLB 
01/AD7F: EB           XBA 
01/AD80: 4A           LSR 
01/AD81: 4A           LSR 
01/AD82: 8D 9C 1B     STA $1B9C
01/AD85: A9 00 FC     LDA #$FC00
01/AD88: 8D 9D 1B     STA $1B9D
01/AD8B: A9 00 04     LDA #$0400
01/AD8E: 8D 9F 1B     STA $1B9F
01/AD91: E2 20        SEP #$20
01/AD93: 60           RTS 

; [ character order change animation ]

01/AD94: 20 0C AD     JSR $AD0C
01/AD97: A2 08 00     LDX #$0008
01/AD9A: C6 D5        DEC $D5         ; move sprites out horizontally
01/AD9C: C6 D5        DEC $D5
01/AD9E: C6 D5        DEC $D5
01/ADA0: E6 D7        INC $D7
01/ADA2: E6 D7        INC $D7
01/ADA4: E6 D7        INC $D7
01/ADA6: 20 10 AE     JSR $AE10       ; draw character sprites (order change)
01/ADA9: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/ADAC: CA           DEX 
01/ADAD: D0 EB        BNE $AD9A
01/ADAF: 20 46 AD     JSR $AD46
01/ADB2: C2 20        REP #$20
01/ADB4: A5 D5        LDA $D5         ; swap sprites vertically
01/ADB6: 18           CLC 
01/ADB7: 6D 9D 1B     ADC $1B9D
01/ADBA: 85 D5        STA $D5
01/ADBC: A5 D7        LDA $D7
01/ADBE: 18           CLC 
01/ADBF: 6D 9F 1B     ADC $1B9F
01/ADC2: 85 D7        STA $D7
01/ADC4: E2 20        SEP #$20
01/ADC6: 20 10 AE     JSR $AE10       ; draw character sprites (order change)
01/ADC9: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/ADCC: CE 9C 1B     DEC $1B9C
01/ADCF: D0 E1        BNE $ADB2
01/ADD1: 20 E8 AD     JSR $ADE8
01/ADD4: A5 D9        LDA $D9
01/ADD6: 85 1D        STA $1D
01/ADD8: 20 74 90     JSR $9074
01/ADDB: A5 DA        LDA $DA
01/ADDD: 85 1D        STA $1D
01/ADDF: 20 74 90     JSR $9074
01/ADE2: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/ADE5: 4C E8 94     JMP $94E8

; [  ]

01/ADE8: A2 18 00     LDX #$0018
01/ADEB: C6 D7        DEC $D7         ; move sprites back in
01/ADED: E6 D5        INC $D5
01/ADEF: 20 10 AE     JSR $AE10       ; draw character sprites (order change)
01/ADF2: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/ADF5: CA           DEX 
01/ADF6: D0 F3        BNE $ADEB
01/ADF8: 60           RTS 
01/ADF9: 0A           ASL 
01/ADFA: 0A           ASL 
01/ADFB: 0A           ASL 
01/ADFC: 0A           ASL 
01/ADFD: 0A           ASL 
01/ADFE: 85 43        STA $43
01/AE00: A4 43        LDY $43
01/AE02: A2 20 00     LDX #$0020
01/AE05: B9 28 FE     LDA $FE28,Y     ; character palette buffer
01/AE08: 99 60 A1     STA $A160,Y
01/AE0B: C8           INY 
01/AE0C: CA           DEX 
01/AE0D: D0 F6        BNE $AE05
01/AE0F: 60           RTS 

; [ draw character sprites (order change) ]

01/AE10: A5 D9        LDA $D9
01/AE12: 85 1D        STA $1D
01/AE14: A4 D5        LDY $D5
01/AE16: 84 1F        STY $1F
01/AE18: 64 1E        STZ $1E
01/AE1A: 20 64 90     JSR $9064       ; draw character
01/AE1D: A5 DA        LDA $DA
01/AE1F: 85 1D        STA $1D
01/AE21: A4 D7        LDY $D7
01/AE23: 84 1F        STY $1F
01/AE25: 64 1E        STZ $1E
01/AE27: 4C 64 90     JMP $9064       ; draw character

; --------------------------------------------------------------------------

; [ sort items ]

; +X: $1340 or $1440 (fat chocobo items or inventory)

01/AE2A: 86 1D        STX $1D
01/AE2C: 86 1F        STX $1F
01/AE2E: C2 20        REP #$20
01/AE30: 8A           TXA 
01/AE31: C9 40 13     CMP #$1340
01/AE34: D0 06        BNE $AE3C
01/AE36: 18           CLC 
01/AE37: 69 FA 00     ADC #$00FA      ; fat chocobo holds 126 items
01/AE3A: 80 04        BRA $AE40
01/AE3C: 18           CLC 
01/AE3D: 69 5E 00     ADC #$005E      ; inventory holds 48 items
01/AE40: 85 21        STA $21
01/AE42: 1A           INC 
01/AE43: 1A           INC 
01/AE44: 85 25        STA $25
01/AE46: E2 20        SEP #$20
01/AE48: E8           INX 
01/AE49: A0 02 00     LDY #$0002
01/AE4C: A6 1F        LDX $1F
01/AE4E: E8           INX 
01/AE4F: 86 23        STX $23
01/AE51: B2 1F        LDA ($1F)
01/AE53: F0 17        BEQ $AE6C
01/AE55: D1 1F        CMP ($1F),Y
01/AE57: D0 13        BNE $AE6C
01/AE59: C8           INY 
01/AE5A: B1 1F        LDA ($1F),Y
01/AE5C: 18           CLC 
01/AE5D: 72 23        ADC ($23)
01/AE5F: C9 64        CMP #$64
01/AE61: B0 0A        BCS $AE6D
01/AE63: 92 23        STA ($23)
01/AE65: A9 00        LDA #$00
01/AE67: 91 1F        STA ($1F),Y
01/AE69: 88           DEY 
01/AE6A: 91 1F        STA ($1F),Y
01/AE6C: C8           INY 
01/AE6D: C8           INY 
01/AE6E: C2 20        REP #$20
01/AE70: 98           TYA 
01/AE71: 18           CLC 
01/AE72: 65 1F        ADC $1F
01/AE74: C5 25        CMP $25
01/AE76: E2 20        SEP #$20
01/AE78: D0 D7        BNE $AE51
01/AE7A: C2 20        REP #$20
01/AE7C: E6 1F        INC $1F
01/AE7E: E6 1F        INC $1F
01/AE80: E2 20        SEP #$20
01/AE82: A6 1F        LDX $1F
01/AE84: E4 21        CPX $21
01/AE86: D0 C1        BNE $AE49
01/AE88: A6 1D        LDX $1D
01/AE8A: DA           PHX 
01/AE8B: 20 91 AE     JSR $AE91
01/AE8E: FA           PLX 
01/AE8F: 86 1D        STX $1D
01/AE91: A6 1D        LDX $1D
01/AE93: E8           INX 
01/AE94: 86 23        STX $23
01/AE96: B2 1D        LDA ($1D)
01/AE98: D0 24        BNE $AEBE
01/AE9A: A4 1D        LDY $1D
01/AE9C: C8           INY 
01/AE9D: C8           INY 
01/AE9E: B9 00 00     LDA $0000,Y
01/AEA1: F0 15        BEQ $AEB8
01/AEA3: C9 FE        CMP #$FE
01/AEA5: B0 11        BCS $AEB8       ; branch if -sort- or trash can
01/AEA7: 92 1D        STA ($1D)
01/AEA9: B9 01 00     LDA $0001,Y
01/AEAC: 92 23        STA ($23)
01/AEAE: A9 00        LDA #$00
01/AEB0: 99 00 00     STA $0000,Y
01/AEB3: 99 01 00     STA $0001,Y
01/AEB6: 80 06        BRA $AEBE
01/AEB8: C8           INY 
01/AEB9: C8           INY 
01/AEBA: C4 25        CPY $25
01/AEBC: D0 E0        BNE $AE9E
01/AEBE: A6 1D        LDX $1D
01/AEC0: E8           INX 
01/AEC1: E8           INX 
01/AEC2: 86 1D        STX $1D
01/AEC4: E4 21        CPX $21
01/AEC6: D0 C9        BNE $AE91
01/AEC8: 60           RTS 

; pointers to window data for each character
01/AEC9: DD55 DD59 DD5D DD61 DD65

; [ magic menu ]

; subroutine starts at 01/AEE5

01/AED3: 20 BA 84     JSR $84BA       ; select bg2
01/AED6: A0 40 DD     LDY #$DD40      ;  (can't use magic)
01/AED9: 20 FB 82     JSR $82FB       ; draw window and text
01/AEDC: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/AEDF: 20 36 83     JSR $8336
01/AEE2: 4C 1D 94     JMP $941D       ; clear bg2 screen buffer in vram
; subroutine starts here
01/AEE5: 9C 27 1B     STZ $1B27
01/AEE8: 20 52 8A     JSR $8A52       ; select character (main menu)
01/AEEB: A5 E8        LDA $E8
01/AEED: 10 01        BPL $AEF0
01/AEEF: 60           RTS 
01/AEF0: A5 E8        LDA $E8
01/AEF2: 20 19 A9     JSR $A919       ; get character id
01/AEF5: D0 01        BNE $AEF8
01/AEF7: 60           RTS 
01/AEF8: DA           PHX 
01/AEF9: 22 9C FD 1E  JSL $1EFD9C
01/AEFD: FA           PLX 
01/AEFE: BD 03 00     LDA $0003,X
01/AF01: 8D 86 1A     STA $1A86
01/AF04: 29 C4        AND #$C4
01/AF06: D0 CB        BNE $AED3
01/AF08: BD 01 00     LDA $0001,X
01/AF0B: 29 0F        AND #$0F
01/AF0D: 85 45        STA $45
01/AF0F: 0A           ASL 
01/AF10: 65 45        ADC $45
01/AF12: 20 B4 87     JSR $87B4       ; tax
01/AF15: BF A2 FF 14  LDA $14FFA2,X
01/AF19: 3F A3 FF 14  AND $14FFA3,X
01/AF1D: 3F A4 FF 14  AND $14FFA4,X
01/AF21: C9 FF        CMP #$FF
01/AF23: F0 AE        BEQ $AED3       ; branch if character can't use magic
01/AF25: DA           PHX 
01/AF26: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/AF29: A5 E8        LDA $E8
01/AF2B: 20 92 89     JSR $8992       ; draw portrait (main menu)
01/AF2E: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/AF31: 20 45 8D     JSR $8D45       ; clear bg3 screen buffer
01/AF34: 20 9D 88     JSR $889D       ; draw all character blocks
01/AF37: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/AF3A: A9 20        LDA #$20
01/AF3C: 85 3F        STA $3F
01/AF3E: 20 88 84     JSR $8488       ; select bg4
01/AF41: A0 6D DB     LDY #$DB6D      ; main menu options
01/AF44: 20 D9 80     JSR $80D9       ; draw window
01/AF47: A0 AB DB     LDY #$DBAB      ; *** this does nothing ***
01/AF4A: A0 6D DB     LDY #$DB6D      ; main menu options
01/AF4D: A2 69 DD     LDX #$DD69
01/AF50: 20 D0 84     JSR $84D0       ; transform window
01/AF53: A2 2E 95     LDX #$952E
01/AF56: 86 D0        STX $D0
01/AF58: A2 4F 82     LDX #$824F      ; transfer sprite data to ppu
01/AF5B: 86 CD        STX $CD
01/AF5D: A5 E8        LDA $E8
01/AF5F: 20 48 89     JSR $8948
01/AF62: C2 20        REP #$20
01/AF64: 98           TYA 
01/AF65: E2 20        SEP #$20
01/AF67: 85 BA        STA $BA
01/AF69: EB           XBA 
01/AF6A: 85 BC        STA $BC
01/AF6C: 64 B9        STZ $B9
01/AF6E: 64 BB        STZ $BB
01/AF70: A9 28        LDA #$28
01/AF72: 85 C2        STA $C2
01/AF74: 85 D2        STA $D2
01/AF76: A9 C8        LDA #$C8
01/AF78: 85 B3        STA $B3
01/AF7A: 85 BD        STA $BD
01/AF7C: A9 81        LDA #$81
01/AF7E: 85 B4        STA $B4
01/AF80: 85 BE        STA $BE
01/AF82: A5 E7        LDA $E7
01/AF84: 85 B7        STA $B7
01/AF86: 85 C0        STA $C0
01/AF88: A9 68        LDA #$68
01/AF8A: 85 B0        STA $B0
01/AF8C: A9 04        LDA #$04
01/AF8E: 85 AE        STA $AE
01/AF90: A9 34        LDA #$34
01/AF92: 85 AD        STA $AD
01/AF94: A5 E8        LDA $E8
01/AF96: 85 D3        STA $D3
01/AF98: FA           PLX 
01/AF99: BF A2 FF 14  LDA $14FFA2,X
01/AF9D: 8D 7E 1B     STA $1B7E
01/AFA0: 30 05        BMI $AFA7
01/AFA2: A0 14 B2     LDY #$B214
01/AFA5: 80 03        BRA $AFAA
01/AFA7: A0 34 B2     LDY #$B234
01/AFAA: 20 01 83     JSR $8301       ; draw positioned text
01/AFAD: BF A3 FF 14  LDA $14FFA3,X
01/AFB1: 8D 7F 1B     STA $1B7F
01/AFB4: 30 05        BMI $AFBB
01/AFB6: A0 1C B2     LDY #$B21C
01/AFB9: 80 03        BRA $AFBE
01/AFBB: A0 3C B2     LDY #$B23C
01/AFBE: 20 01 83     JSR $8301       ; draw positioned text
01/AFC1: BF A4 FF 14  LDA $14FFA4,X
01/AFC5: 8D 80 1B     STA $1B80
01/AFC8: 30 05        BMI $AFCF
01/AFCA: A0 24 B2     LDY #$B224
01/AFCD: 80 03        BRA $AFD2
01/AFCF: A0 44 B2     LDY #$B244
01/AFD2: 20 01 83     JSR $8301       ; draw positioned text
01/AFD5: A5 E8        LDA $E8
01/AFD7: 20 19 A9     JSR $A919       ; get character id
01/AFDA: C9 12        CMP #$12
01/AFDC: D0 06        BNE $AFE4
01/AFDE: A0 2C B2     LDY #$B22C
01/AFE1: 20 01 83     JSR $8301       ; draw positioned text
01/AFE4: 20 A2 84     JSR $84A2       ; select bg1
01/AFE7: A0 51 DD     LDY #$DD51
01/AFEA: 20 D9 80     JSR $80D9       ; draw window
01/AFED: AD 81 1B     LDA $1B81
01/AFF0: 20 B4 87     JSR $87B4       ; tax
01/AFF3: BD 7E 1B     LDA $1B7E,X
01/AFF6: 10 0F        BPL $B007
01/AFF8: AD 81 1B     LDA $1B81
01/AFFB: 1A           INC 
01/AFFC: C9 03        CMP #$03
01/AFFE: D0 02        BNE $B002
01/B000: A9 00        LDA #$00
01/B002: 8D 81 1B     STA $1B81
01/B005: 80 E6        BRA $AFED
01/B007: EE 87 1B     INC $1B87
01/B00A: 20 55 B2     JSR $B255
01/B00D: 9C 87 1B     STZ $1B87
01/B010: A2 18 FF     LDX #$FF18
01/B013: 86 93        STX $93
01/B015: 20 A4 94     JSR $94A4
01/B018: A9 05        LDA #$05
01/B01A: 85 AB        STA $AB
01/B01C: A9 9A        LDA #$9A
01/B01E: 85 AA        STA $AA
01/B020: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/B023: 20 70 84     JSR $8470       ; select bg3
01/B026: 20 BF 88     JSR $88BF       ; draw selected character block
01/B029: A5 E7        LDA $E7
01/B02B: 0A           ASL 
01/B02C: 20 B4 87     JSR $87B4       ; tax
01/B02F: C2 20        REP #$20
01/B031: BF C9 AE 01  LDA $01AEC9,X
01/B035: AA           TAX 
01/B036: E2 20        SEP #$20
01/B038: A0 61 DB     LDY #$DB61
01/B03B: 20 D0 84     JSR $84D0       ; transform window
01/B03E: 20 BB B0     JSR $B0BB
01/B041: A9 30        LDA #$30
01/B043: 85 3F        STA $3F
01/B045: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/B048: 20 88 84     JSR $8488       ; select bg4
01/B04B: A0 0A 02     LDY #$020A      ; (16,10)
01/B04E: A9 0D        LDA #$0D        ; 13 tiles wide
01/B050: 38           SEC             ; set tiles to $FF
01/B051: 20 79 87     JSR $8779       ; clear text
01/B054: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/B057: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/B05A: A9 28        LDA #$28
01/B05C: 85 C2        STA $C2
01/B05E: A9 01        LDA #$01
01/B060: 85 B4        STA $B4
01/B062: A5 E7        LDA $E7
01/B064: 09 80        ORA #$80
01/B066: 85 B7        STA $B7
01/B068: 85 C0        STA $C0
01/B06A: A9 68        LDA #$68
01/B06C: 85 B0        STA $B0
01/B06E: A9 84        LDA #$84
01/B070: 85 AE        STA $AE
01/B072: A9 34        LDA #$34
01/B074: 85 AD        STA $AD
01/B076: A9 06        LDA #$06
01/B078: 85 AB        STA $AB
01/B07A: 20 70 84     JSR $8470       ; select bg3
01/B07D: A5 E7        LDA $E7
01/B07F: 0A           ASL 
01/B080: 20 B4 87     JSR $87B4       ; tax
01/B083: C2 20        REP #$20
01/B085: BF C9 AE 01  LDA $01AEC9,X
01/B089: A8           TAY 
01/B08A: E2 20        SEP #$20
01/B08C: A2 61 DB     LDX #$DB61
01/B08F: 20 D0 84     JSR $84D0       ; transform window
01/B092: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/B095: 20 A9 94     JSR $94A9
01/B098: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/B09B: 20 A4 94     JSR $94A4
01/B09E: 20 88 84     JSR $8488       ; select bg4
01/B0A1: A0 69 DD     LDY #$DD69
01/B0A4: A2 6D DB     LDX #$DB6D      ; main menu options
01/B0A7: 20 D0 84     JSR $84D0       ; transform window
01/B0AA: 20 19 89     JSR $8919       ; draw main menu
01/B0AD: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/B0B0: 20 88 84     JSR $8488       ; select bg4
01/B0B3: 20 E3 83     JSR $83E3       ; open window
01/B0B6: 22 B6 FD 1E  JSL $1EFDB6
01/B0BA: 60           RTS 

; [  ]

01/B0BB: AD 87 1B     LDA $1B87
01/B0BE: D0 14        BNE $B0D4
01/B0C0: 9C 93 1B     STZ $1B93
01/B0C3: AD 81 1B     LDA $1B81
01/B0C6: 0A           ASL 
01/B0C7: 0A           ASL 
01/B0C8: 0A           ASL 
01/B0C9: 0A           ASL 
01/B0CA: 69 10        ADC #$10
01/B0CC: 85 46        STA $46
01/B0CE: A9 08        LDA #$08
01/B0D0: 85 45        STA $45
01/B0D2: 80 03        BRA $B0D7
01/B0D4: 20 6D B3     JSR $B36D
01/B0D7: 20 81 82     JSR $8281       ; draw cursor sprite
01/B0DA: 20 88 84     JSR $8488       ; select bg4
01/B0DD: 20 EC B3     JSR $B3EC
01/B0E0: 20 26 B4     JSR $B426
01/B0E3: 8D 93 1B     STA $1B93
01/B0E6: A0 1A 02     LDY #$021A
01/B0E9: 20 69 83     JSR $8369       ; draw 2-digit number
01/B0EC: A2 0A 02     LDX #$020A
01/B0EF: A0 7B DD     LDY #$DD7B
01/B0F2: 20 98 87     JSR $8798       ; copy text to screen buffer
01/B0F5: A9 C3        LDA #$C3
01/B0F7: 8D 16 C8     STA $C816
01/B0FA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/B0FD: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/B100: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/B103: AD 87 1B     LDA $1B87
01/B106: D0 5C        BNE $B164
01/B108: A5 01        LDA $01
01/B10A: 29 08        AND #$08
01/B10C: F0 1E        BEQ $B12C
01/B10E: AD 81 1B     LDA $1B81
01/B111: 85 43        STA $43
01/B113: A5 43        LDA $43
01/B115: 3A           DEC 
01/B116: 10 02        BPL $B11A
01/B118: A9 02        LDA #$02
01/B11A: 20 B4 87     JSR $87B4       ; tax
01/B11D: BD 7E 1B     LDA $1B7E,X
01/B120: 30 F1        BMI $B113
01/B122: 48           PHA 
01/B123: A5 43        LDA $43
01/B125: 8D 81 1B     STA $1B81
01/B128: 68           PLA 
01/B129: 20 4C B2     JSR $B24C
01/B12C: A5 01        LDA $01
01/B12E: 29 04        AND #$04
01/B130: F0 1F        BEQ $B151
01/B132: AD 81 1B     LDA $1B81
01/B135: 85 43        STA $43
01/B137: A5 43        LDA $43
01/B139: 1A           INC 
01/B13A: C9 03        CMP #$03
01/B13C: D0 01        BNE $B13F
01/B13E: 7B           TDC 
01/B13F: 20 B4 87     JSR $87B4       ; tax
01/B142: BD 7E 1B     LDA $1B7E,X
01/B145: 30 F0        BMI $B137
01/B147: 48           PHA 
01/B148: A5 43        LDA $43
01/B14A: 8D 81 1B     STA $1B81
01/B14D: 68           PLA 
01/B14E: 20 4C B2     JSR $B24C
01/B151: A5 00        LDA $00
01/B153: 29 80        AND #$80
01/B155: F0 03        BEQ $B15A
01/B157: EE 87 1B     INC $1B87
01/B15A: A5 01        LDA $01
01/B15C: 29 80        AND #$80
01/B15E: F0 01        BEQ $B161
01/B160: 60           RTS 
01/B161: 4C BB B0     JMP $B0BB
01/B164: A5 01        LDA $01
01/B166: 29 08        AND #$08
01/B168: F0 0B        BEQ $B175
01/B16A: AD 83 1B     LDA $1B83
01/B16D: 3A           DEC 
01/B16E: 10 02        BPL $B172
01/B170: A9 07        LDA #$07
01/B172: 8D 83 1B     STA $1B83
01/B175: A5 01        LDA $01
01/B177: 29 04        AND #$04
01/B179: F0 0C        BEQ $B187
01/B17B: AD 83 1B     LDA $1B83
01/B17E: 1A           INC 
01/B17F: C9 08        CMP #$08
01/B181: D0 01        BNE $B184
01/B183: 7B           TDC 
01/B184: 8D 83 1B     STA $1B83
01/B187: A5 01        LDA $01
01/B189: 29 02        AND #$02
01/B18B: F0 0B        BEQ $B198
01/B18D: AD 84 1B     LDA $1B84
01/B190: 3A           DEC 
01/B191: 10 02        BPL $B195
01/B193: A9 02        LDA #$02
01/B195: 8D 84 1B     STA $1B84
01/B198: A5 01        LDA $01
01/B19A: 29 01        AND #$01
01/B19C: F0 0C        BEQ $B1AA
01/B19E: AD 84 1B     LDA $1B84
01/B1A1: 1A           INC 
01/B1A2: C9 03        CMP #$03
01/B1A4: D0 01        BNE $B1A7
01/B1A6: 7B           TDC 
01/B1A7: 8D 84 1B     STA $1B84
01/B1AA: A5 00        LDA $00
01/B1AC: 29 80        AND #$80
01/B1AE: F0 2A        BEQ $B1DA
01/B1B0: AD 88 1B     LDA $1B88
01/B1B3: D0 1D        BNE $B1D2
01/B1B5: EE 88 1B     INC $1B88
01/B1B8: AE 83 1B     LDX $1B83
01/B1BB: 8E 85 1B     STX $1B85
01/B1BE: 20 6D B3     JSR $B36D
01/B1C1: C2 20        REP #$20
01/B1C3: A5 45        LDA $45
01/B1C5: 18           CLC 
01/B1C6: 69 04 04     ADC #$0404
01/B1C9: 85 45        STA $45
01/B1CB: E2 20        SEP #$20
01/B1CD: 20 7C 82     JSR $827C       ; draw cursor sprite
01/B1D0: 80 17        BRA $B1E9
01/B1D2: 9C 88 1B     STZ $1B88
01/B1D5: 20 87 B3     JSR $B387
01/B1D8: 80 0F        BRA $B1E9
01/B1DA: A5 01        LDA $01
01/B1DC: 29 80        AND #$80
01/B1DE: F0 09        BEQ $B1E9
01/B1E0: 9C 87 1B     STZ $1B87
01/B1E3: 9C 88 1B     STZ $1B88
01/B1E6: 20 1F B5     JSR $B51F
01/B1E9: A5 00        LDA $00
01/B1EB: 29 40        AND #$40
01/B1ED: F0 1F        BEQ $B20E
01/B1EF: AD 81 1B     LDA $1B81
01/B1F2: 85 43        STA $43
01/B1F4: A5 43        LDA $43
01/B1F6: 1A           INC 
01/B1F7: C9 03        CMP #$03
01/B1F9: D0 01        BNE $B1FC
01/B1FB: 7B           TDC 
01/B1FC: 20 B4 87     JSR $87B4       ; tax
01/B1FF: BD 7E 1B     LDA $1B7E,X
01/B202: 30 F0        BMI $B1F4
01/B204: 48           PHA 
01/B205: A5 43        LDA $43
01/B207: 8D 81 1B     STA $1B81
01/B20A: 68           PLA 
01/B20B: 20 4C B2     JSR $B24C
01/B20E: 4C BB B0     JMP $B0BB

01/B211: 10 58 A0

01/B214: F0 00 95 B4 A8 A7 8C 00
01/B21C: 70 01 91 B4 A8 A7 8C 00
01/B224: F0 01 95 7F 8C 8F B6 00
01/B22C: 70 01 9F B6 16 7E 9B 00
01/B234: F0 00 FF FF FF FF FF 00
01/B23C: 70 01 FF FF FF FF FF 00
01/B244: F0 01 FF FF FF FF FF 00

01/B24C: 20 A2 84     JSR $84A2       ; select bg1
01/B24F: 20 55 B2     JSR $B255
01/B252: 4C 2D 94     JMP $942D       ; transfer bg1 screen buffer to vram
01/B255: 85 43        STA $43
01/B257: 20 A2 84     JSR $84A2       ; select bg1
01/B25A: C2 20        REP #$20
01/B25C: A5 43        LDA $43
01/B25E: 0A           ASL 
01/B25F: 0A           ASL 
01/B260: 0A           ASL 
01/B261: 85 48        STA $48
01/B263: 0A           ASL 
01/B264: 65 48        ADC $48
01/B266: 69 60 15     ADC #$1560
01/B269: 85 60        STA $60
01/B26B: E2 20        SEP #$20
01/B26D: 64 5E        STZ $5E
01/B26F: 64 5B        STZ $5B
01/B271: A9 08        LDA #$08
01/B273: 85 5A        STA $5A
01/B275: A4 41        LDY $41         ; zero
01/B277: A9 03        LDA #$03
01/B279: 85 5D        STA $5D
01/B27B: C2 20        REP #$20
01/B27D: A5 5D        LDA $5D
01/B27F: 3A           DEC 
01/B280: 0A           ASL 
01/B281: AA           TAX 
01/B282: A9 08 00     LDA #$0008
01/B285: 38           SEC 
01/B286: E5 5A        SBC $5A
01/B288: EB           XBA 
01/B289: 29 00 FF     AND #$FF00
01/B28C: 4A           LSR 
01/B28D: 18           CLC 
01/B28E: 7F BD FE 1E  ADC $1EFEBD,X
01/B292: AA           TAX 
01/B293: E2 20        SEP #$20
01/B295: B1 60        LDA ($60),Y
01/B297: 20 A6 B2     JSR $B2A6       ; draw spell name
01/B29A: C8           INY 
01/B29B: C6 5D        DEC $5D
01/B29D: D0 DC        BNE $B27B
01/B29F: C6 5A        DEC $5A
01/B2A1: D0 D4        BNE $B277
01/B2A3: E2 20        SEP #$20
01/B2A5: 60           RTS 

; [ draw spell name ]

01/B2A6: 48           PHA 
01/B2A7: DA           PHX 
01/B2A8: C9 0E        CMP #$0E
01/B2AA: 90 23        BCC $B2CF
01/B2AC: C9 1C        CMP #$1C
01/B2AE: B0 1F        BCS $B2CF
01/B2B0: 8D 87 1A     STA $1A87
01/B2B3: 5A           PHY 
01/B2B4: 20 3C B4     JSR $B43C
01/B2B7: 7A           PLY 
01/B2B8: 8D C4 1B     STA $1BC4
01/B2BB: 9C C5 1B     STZ $1BC5
01/B2BE: A5 E8        LDA $E8
01/B2C0: 20 01 90     JSR $9001       ; get pointer to character properties
01/B2C3: C2 20        REP #$20
01/B2C5: BD 0B 00     LDA $000B,X
01/B2C8: CD C4 1B     CMP $1BC4
01/B2CB: E2 20        SEP #$20
01/B2CD: B0 0B        BCS $B2DA
01/B2CF: AD C8 1B     LDA $1BC8
01/B2D2: D0 06        BNE $B2DA
01/B2D4: A5 34        LDA $34
01/B2D6: 09 04        ORA #$04
01/B2D8: 80 29        BRA $B303
01/B2DA: AD 87 1A     LDA $1A87
01/B2DD: C9 12        CMP #$12
01/B2DF: F0 20        BEQ $B301
01/B2E1: AD 86 1A     LDA $1A86
01/B2E4: 29 28        AND #$28
01/B2E6: F0 19        BEQ $B301
01/B2E8: 29 20        AND #$20
01/B2EA: F0 07        BEQ $B2F3
01/B2EC: AD 87 1A     LDA $1A87
01/B2EF: C9 19        CMP #$19
01/B2F1: F0 0E        BEQ $B301
01/B2F3: AD 86 1A     LDA $1A86
01/B2F6: 29 08        AND #$08
01/B2F8: F0 DA        BEQ $B2D4
01/B2FA: AD 87 1A     LDA $1A87
01/B2FD: C9 1A        CMP #$1A
01/B2FF: D0 D3        BNE $B2D4
01/B301: A5 34        LDA $34
01/B303: 85 DB        STA $DB
01/B305: FA           PLX 
01/B306: 68           PLA 
01/B307: 48           PHA 
01/B308: C2 20        REP #$20
01/B30A: 8A           TXA 
01/B30B: 18           CLC 
01/B30C: 65 29        ADC $29
01/B30E: AA           TAX 
01/B30F: E2 20        SEP #$20
01/B311: 68           PLA 
01/B312: 8B           PHB 
01/B313: DA           PHX 
01/B314: 5A           PHY 
01/B315: EB           XBA 
01/B316: A9 00        LDA #$00
01/B318: EB           XBA 
01/B319: C2 20        REP #$20
01/B31B: 0A           ASL 
01/B31C: 85 45        STA $45
01/B31E: 0A           ASL 
01/B31F: 65 45        ADC $45
01/B321: 69 00 89     ADC #$8900
01/B324: A8           TAY 
01/B325: E2 20        SEP #$20
01/B327: A9 0F        LDA #$0F
01/B329: 48           PHA 
01/B32A: AB           PLB 
01/B32B: B9 00 00     LDA $0000,Y
01/B32E: C8           INY 
01/B32F: 9F 40 00 7E  STA $7E0040,X
01/B333: A9 FF        LDA #$FF
01/B335: 9F 00 00 7E  STA $7E0000,X
01/B339: E8           INX 
01/B33A: A5 DB        LDA $DB
01/B33C: 9F 00 00 7E  STA $7E0000,X
01/B340: 9F 40 00 7E  STA $7E0040,X
01/B344: E8           INX 
01/B345: A9 05        LDA #$05
01/B347: 85 45        STA $45
01/B349: B9 00 00     LDA $0000,Y
01/B34C: 20 32 8E     JSR $8E32       ; get dakuten
01/B34F: 9F 00 00 7E  STA $7E0000,X   ; dakuten
01/B353: EB           XBA 
01/B354: 9F 40 00 7E  STA $7E0040,X   ; kana
01/B358: E8           INX 
01/B359: A5 DB        LDA $DB
01/B35B: 9F 00 00 7E  STA $7E0000,X
01/B35F: 9F 40 00 7E  STA $7E0040,X
01/B363: E8           INX 
01/B364: C8           INY 
01/B365: C6 45        DEC $45
01/B367: D0 E0        BNE $B349
01/B369: 7A           PLY 
01/B36A: FA           PLX 
01/B36B: AB           PLB 
01/B36C: 60           RTS 

; [  ]

01/B36D: AD 83 1B     LDA $1B83
01/B370: 0A           ASL 
01/B371: 0A           ASL 
01/B372: 0A           ASL 
01/B373: 0A           ASL 
01/B374: 69 56        ADC #$56
01/B376: 85 46        STA $46
01/B378: AD 84 1B     LDA $1B84
01/B37B: E2 10        SEP #$10
01/B37D: AA           TAX 
01/B37E: BF 11 B2 01  LDA $01B211,X
01/B382: C2 10        REP #$10
01/B384: 85 45        STA $45
01/B386: 60           RTS 

; [  ]

01/B387: AE 83 1B     LDX $1B83
01/B38A: EC 85 1B     CPX $1B85
01/B38D: D0 03        BNE $B392
01/B38F: 4C 3D B5     JMP $B53D
01/B392: 9C 88 1B     STZ $1B88
01/B395: 20 DC A2     JSR $A2DC
01/B398: AD 83 1B     LDA $1B83
01/B39B: 0A           ASL 
01/B39C: 6D 83 1B     ADC $1B83
01/B39F: 6D 84 1B     ADC $1B84
01/B3A2: 20 D2 B3     JSR $B3D2
01/B3A5: A8           TAY 
01/B3A6: AD 85 1B     LDA $1B85
01/B3A9: 0A           ASL 
01/B3AA: 6D 85 1B     ADC $1B85
01/B3AD: 6D 86 1B     ADC $1B86
01/B3B0: 20 D2 B3     JSR $B3D2
01/B3B3: AA           TAX 
01/B3B4: BD 60 15     LDA $1560,X
01/B3B7: 48           PHA 
01/B3B8: B9 60 15     LDA $1560,Y
01/B3BB: 9D 60 15     STA $1560,X
01/B3BE: 68           PLA 
01/B3BF: 99 60 15     STA $1560,Y
01/B3C2: 20 C8 B3     JSR $B3C8
01/B3C5: 4C 4C B2     JMP $B24C

; [  ]

01/B3C8: AD 81 1B     LDA $1B81
01/B3CB: 20 B4 87     JSR $87B4       ; tax
01/B3CE: BD 7E 1B     LDA $1B7E,X
01/B3D1: 60           RTS 

; [  ]

01/B3D2: 85 1D        STA $1D
01/B3D4: 64 1E        STZ $1E
01/B3D6: 20 C8 B3     JSR $B3C8
01/B3D9: EB           XBA 
01/B3DA: A9 00        LDA #$00
01/B3DC: EB           XBA 
01/B3DD: C2 20        REP #$20
01/B3DF: 0A           ASL 
01/B3E0: 0A           ASL 
01/B3E1: 0A           ASL 
01/B3E2: 85 45        STA $45
01/B3E4: 0A           ASL 
01/B3E5: 65 45        ADC $45
01/B3E7: 65 1D        ADC $1D
01/B3E9: E2 20        SEP #$20
01/B3EB: 60           RTS 

; [  ]

01/B3EC: A9 24        LDA #$24
01/B3EE: A2 30 01     LDX #$0130
01/B3F1: 20 18 B4     JSR $B418
01/B3F4: A2 B0 01     LDX #$01B0
01/B3F7: 20 18 B4     JSR $B418
01/B3FA: A2 30 02     LDX #$0230
01/B3FD: 20 18 B4     JSR $B418
01/B400: AD 81 1B     LDA $1B81
01/B403: D0 05        BNE $B40A
01/B405: A2 30 01     LDX #$0130
01/B408: 80 0C        BRA $B416
01/B40A: C9 01        CMP #$01
01/B40C: D0 05        BNE $B413
01/B40E: A2 B0 01     LDX #$01B0
01/B411: 80 03        BRA $B416
01/B413: A2 30 02     LDX #$0230
01/B416: A9 20        LDA #$20
01/B418: 48           PHA 
01/B419: A0 05 00     LDY #$0005
01/B41C: 9D 01 C6     STA $C601,X
01/B41F: E8           INX 
01/B420: E8           INX 
01/B421: 88           DEY 
01/B422: D0 F8        BNE $B41C
01/B424: 68           PLA 
01/B425: 60           RTS 

; [  ]

01/B426: AD 87 1B     LDA $1B87
01/B429: F0 29        BEQ $B454
01/B42B: AD 83 1B     LDA $1B83
01/B42E: 0A           ASL 
01/B42F: 6D 83 1B     ADC $1B83
01/B432: 6D 84 1B     ADC $1B84
01/B435: 20 D2 B3     JSR $B3D2
01/B438: A8           TAY 
01/B439: B9 60 15     LDA $1560,Y
01/B43C: EB           XBA 
01/B43D: A9 00        LDA #$00
01/B43F: EB           XBA 
01/B440: C2 20        REP #$20
01/B442: 0A           ASL 
01/B443: 85 45        STA $45
01/B445: 0A           ASL 
01/B446: 65 45        ADC $45
01/B448: AA           TAX 
01/B449: E2 20        SEP #$20
01/B44B: BF A5 97 0F  LDA $0F97A5,X
01/B44F: 29 7F        AND #$7F
01/B451: 8D 93 1B     STA $1B93
01/B454: AD 93 1B     LDA $1B93
01/B457: 60           RTS 

; [ draw spell target select windows ]

01/B458: A9 0F        LDA #$0F
01/B45A: 8F 2C 21 00  STA $00212C
01/B45E: 20 5E 92     JSR $925E       ; load portraits
01/B461: A9 20        LDA #$20        ; sprite layer priority: 2
01/B463: 85 C1        STA $C1
01/B465: 20 A2 84     JSR $84A2       ; select bg1
01/B468: 20 1F B5     JSR $B51F
01/B46B: 9C 88 1B     STZ $1B88
01/B46E: AD 83 1B     LDA $1B83
01/B471: 0A           ASL 
01/B472: 6D 83 1B     ADC $1B83
01/B475: 6D 84 1B     ADC $1B84
01/B478: 20 D2 B3     JSR $B3D2
01/B47B: A8           TAY 
01/B47C: B9 60 15     LDA $1560,Y     ; spell list
01/B47F: 8D 89 1B     STA $1B89
01/B482: 38           SEC 
01/B483: E9 0E        SBC #$0E
01/B485: 20 B4 87     JSR $87B4       ; tax
01/B488: BF F2 FF 14  LDA $14FFF2,X   ; multi-target flag
01/B48C: 8D 90 1B     STA $1B90
01/B48F: A0 6D DD     LDY #$DD6D
01/B492: 20 D9 80     JSR $80D9       ; draw window
01/B495: A0 71 DD     LDY #$DD71
01/B498: 20 D9 80     JSR $80D9       ; draw window
01/B49B: A0 75 DD     LDY #$DD75
01/B49E: 20 D9 80     JSR $80D9       ; draw window
01/B4A1: 20 A2 84     JSR $84A2       ; select bg1
01/B4A4: AD 89 1B     LDA $1B89
01/B4A7: A2 44 00     LDX #$0044
01/B4AA: 20 A6 B2     JSR $B2A6       ; draw spell name
01/B4AD: A0 79 DD     LDY #$DD79      ;  (mp needed)
01/B4B0: 20 01 83     JSR $8301       ; draw positioned text
01/B4B3: A0 82 DD     LDY #$DD82      ;  (use on whom!?)
01/B4B6: 20 01 83     JSR $8301       ; draw positioned text
01/B4B9: 20 26 B4     JSR $B426
01/B4BC: 8D 93 1B     STA $1B93
01/B4BF: A0 C8 01     LDY #$01C8
01/B4C2: 20 69 83     JSR $8369       ; draw 2-digit number
01/B4C5: A2 E0 02     LDX #$02E0
01/B4C8: A0 00 10     LDY #$1000
01/B4CB: 20 9B 89     JSR $899B       ; draw character block
01/B4CE: A2 60 00     LDX #$0060
01/B4D1: A0 40 10     LDY #$1040
01/B4D4: 20 9B 89     JSR $899B       ; draw character block
01/B4D7: A2 60 05     LDX #$0560
01/B4DA: A0 80 10     LDY #$1080
01/B4DD: 20 9B 89     JSR $899B       ; draw character block
01/B4E0: A2 A0 01     LDX #$01A0
01/B4E3: A0 C0 10     LDY #$10C0
01/B4E6: 20 9B 89     JSR $899B       ; draw character block
01/B4E9: A2 20 04     LDX #$0420
01/B4EC: A0 00 11     LDY #$1100
01/B4EF: 20 9B 89     JSR $899B       ; draw character block
01/B4F2: AD A8 16     LDA $16A8
01/B4F5: 29 01        AND #$01
01/B4F7: 0A           ASL 
01/B4F8: 85 45        STA $45
01/B4FA: 0A           ASL 
01/B4FB: 0A           ASL 
01/B4FC: 65 45        ADC $45
01/B4FE: 20 B4 87     JSR $87B4       ; tax
01/B501: A9 00        LDA #$00
01/B503: 20 B1 B6     JSR $B6B1       ; draw portrait (spell target select)
01/B506: 20 B1 B6     JSR $B6B1       ; draw portrait (spell target select)
01/B509: 20 B1 B6     JSR $B6B1       ; draw portrait (spell target select)
01/B50C: 20 B1 B6     JSR $B6B1       ; draw portrait (spell target select)
01/B50F: 20 B1 B6     JSR $B6B1       ; draw portrait (spell target select)
01/B512: A9 1F        LDA #$1F
01/B514: 8F 2C 21 00  STA $00212C
01/B518: 60           RTS 

; [ cast spell ]

; subroutine starts at 01/B53D

01/B519: 20 1F B5     JSR $B51F
01/B51C: 4C 58 87     JMP $8758       ; error sound effect
01/B51F: 20 DC A2     JSR $A2DC
01/B522: 4C F2 A2     JMP $A2F2
; warp
01/B525: 9C 87 1B     STZ $1B87
01/B528: 9C 88 1B     STZ $1B88
01/B52B: 4C B1 B9     JMP $B9B1
; exit, sight
01/B52E: 9C 87 1B     STZ $1B87
01/B531: 9C 88 1B     STZ $1B88
01/B534: 38           SEC 
01/B535: E9 16        SBC #$16
01/B537: A2 70 B7     LDX #$B770
01/B53A: 4C 4B 83     JMP $834B       ; do jump table
; subroutine starts here
01/B53D: 9C 87 1B     STZ $1B87
01/B540: 20 A2 84     JSR $84A2       ; select bg1
01/B543: 9C 88 1B     STZ $1B88
01/B546: AD 83 1B     LDA $1B83
01/B549: 0A           ASL 
01/B54A: 6D 83 1B     ADC $1B83
01/B54D: 6D 84 1B     ADC $1B84
01/B550: 20 D2 B3     JSR $B3D2
01/B553: A8           TAY 
01/B554: B9 60 15     LDA $1560,Y
01/B557: C9 0E        CMP #$0E
01/B559: 90 BE        BCC $B519
01/B55B: C9 1C        CMP #$1C
01/B55D: B0 BA        BCS $B519
01/B55F: 8D 89 1B     STA $1B89
01/B562: C9 12        CMP #$12
01/B564: F0 22        BEQ $B588
01/B566: 20 89 95     JSR $9589
01/B569: 29 28        AND #$28
01/B56B: F0 1B        BEQ $B588
01/B56D: 89 20        BIT #$20
01/B56F: F0 07        BEQ $B578
01/B571: AD 89 1B     LDA $1B89
01/B574: C9 19        CMP #$19
01/B576: F0 10        BEQ $B588
01/B578: 20 89 95     JSR $9589
01/B57B: 89 08        BIT #$08
01/B57D: F0 07        BEQ $B586
01/B57F: AD 89 1B     LDA $1B89
01/B582: C9 1A        CMP #$1A
01/B584: F0 02        BEQ $B588
01/B586: 80 91        BRA $B519
01/B588: 20 05 BA     JSR $BA05
01/B58B: 10 09        BPL $B596
01/B58D: 20 7E B9     JSR $B97E
01/B590: 20 58 87     JSR $8758       ; error sound effect
01/B593: 4C 18 B6     JMP $B618
01/B596: B9 60 15     LDA $1560,Y
01/B599: C9 16        CMP #$16
01/B59B: F0 91        BEQ $B52E
01/B59D: C9 17        CMP #$17
01/B59F: F0 8D        BEQ $B52E
01/B5A1: C9 1B        CMP #$1B
01/B5A3: F0 80        BEQ $B525
01/B5A5: 20 DC A2     JSR $A2DC
01/B5A8: 20 F2 A2     JSR $A2F2
01/B5AB: 20 7E B9     JSR $B97E
01/B5AE: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/B5B1: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/B5B4: 20 61 B4     JSR $B461
01/B5B7: 20 E3 83     JSR $83E3       ; open window
01/B5BA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/B5BD: 9C 8B 1B     STZ $1B8B
01/B5C0: 9C 8C 1B     STZ $1B8C
01/B5C3: 9C 8D 1B     STZ $1B8D
01/B5C6: 9C 8E 1B     STZ $1B8E
01/B5C9: 9C 8F 1B     STZ $1B8F
01/B5CC: 9C BB 1B     STZ $1BBB
01/B5CF: AD 8A 1B     LDA $1B8A
01/B5D2: 20 12 A9     JSR $A912       ; get character id (battle order)
01/B5D5: D0 0F        BNE $B5E6
01/B5D7: AD 8A 1B     LDA $1B8A
01/B5DA: 1A           INC 
01/B5DB: C9 05        CMP #$05
01/B5DD: D0 02        BNE $B5E1
01/B5DF: A9 00        LDA #$00
01/B5E1: 8D 8A 1B     STA $1B8A
01/B5E4: 80 E9        BRA $B5CF
01/B5E6: AD BB 1B     LDA $1BBB
01/B5E9: F0 05        BEQ $B5F0
01/B5EB: 20 F2 A2     JSR $A2F2
01/B5EE: 80 16        BRA $B606
01/B5F0: AD 8A 1B     LDA $1B8A
01/B5F3: 0A           ASL 
01/B5F4: 0A           ASL 
01/B5F5: 6D 8A 1B     ADC $1B8A
01/B5F8: 0A           ASL 
01/B5F9: 0A           ASL 
01/B5FA: 0A           ASL 
01/B5FB: 69 20        ADC #$20
01/B5FD: 85 46        STA $46
01/B5FF: A9 40        LDA #$40
01/B601: 85 45        STA $45
01/B603: 20 81 82     JSR $8281       ; draw cursor sprite
01/B606: A0 10 03     LDY #$0310
01/B609: 20 C7 B6     JSR $B6C7
01/B60C: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/B60F: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/B612: A5 01        LDA $01
01/B614: 29 80        AND #$80
01/B616: F0 25        BEQ $B63D
01/B618: 20 9F 84     JSR $849F       ; select and clear bg1
01/B61B: A0 51 DD     LDY #$DD51
01/B61E: 20 D9 80     JSR $80D9       ; draw window
01/B621: 20 C8 B3     JSR $B3C8
01/B624: 20 4C B2     JSR $B24C
01/B627: 20 8F B9     JSR $B98F
01/B62A: A9 00        LDA #$00        ; sprite layer priority: 0
01/B62C: 85 C1        STA $C1
01/B62E: 20 DC A2     JSR $A2DC
01/B631: 20 F2 A2     JSR $A2F2
01/B634: 20 A2 84     JSR $84A2       ; select bg1
01/B637: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/B63A: 4C 30 94     JMP $9430       ; transfer bg1 screen buffer to vram
01/B63D: A5 00        LDA $00
01/B63F: 29 80        AND #$80
01/B641: F0 10        BEQ $B653
01/B643: AD 8A 1B     LDA $1B8A
01/B646: 20 B4 87     JSR $87B4       ; tax
01/B649: A9 FF        LDA #$FF
01/B64B: 9D 8B 1B     STA $1B8B,X
01/B64E: 20 17 B7     JSR $B717
01/B651: 80 C5        BRA $B618
01/B653: A5 01        LDA $01
01/B655: 29 08        AND #$08
01/B657: F0 10        BEQ $B669
01/B659: AD 8A 1B     LDA $1B8A
01/B65C: 3A           DEC 
01/B65D: 10 02        BPL $B661
01/B65F: A9 04        LDA #$04
01/B661: 8D 8A 1B     STA $1B8A
01/B664: 20 12 A9     JSR $A912       ; get character id (battle order)
01/B667: F0 F0        BEQ $B659
01/B669: A5 01        LDA $01
01/B66B: 29 04        AND #$04
01/B66D: F0 12        BEQ $B681
01/B66F: AD 8A 1B     LDA $1B8A
01/B672: 1A           INC 
01/B673: C9 05        CMP #$05
01/B675: D0 02        BNE $B679
01/B677: A9 00        LDA #$00
01/B679: 8D 8A 1B     STA $1B8A
01/B67C: 20 12 A9     JSR $A912       ; get character id (battle order)
01/B67F: F0 EE        BEQ $B66F
01/B681: A5 01        LDA $01
01/B683: 29 03        AND #$03
01/B685: F0 27        BEQ $B6AE
01/B687: AD 90 1B     LDA $1B90
01/B68A: F0 22        BEQ $B6AE
01/B68C: A0 04 00     LDY #$0004
01/B68F: 98           TYA 
01/B690: 20 A0 B9     JSR $B9A0
01/B693: BD 00 00     LDA $0000,X
01/B696: 29 3F        AND #$3F
01/B698: F0 09        BEQ $B6A3
01/B69A: BB           TYX 
01/B69B: BD 8B 1B     LDA $1B8B,X
01/B69E: 49 FF        EOR #$FF
01/B6A0: 9D 8B 1B     STA $1B8B,X
01/B6A3: 88           DEY 
01/B6A4: 10 E9        BPL $B68F
01/B6A6: A9 FF        LDA #$FF
01/B6A8: 4D BB 1B     EOR $1BBB
01/B6AB: 8D BB 1B     STA $1BBB
01/B6AE: 4C E6 B5     JMP $B5E6

; [ draw portrait (spell target select) ]

01/B6B1: 48           PHA 
01/B6B2: DA           PHX 
01/B6B3: 48           PHA 
01/B6B4: C2 20        REP #$20
01/B6B6: BF A9 FE 1E  LDA $1EFEA9,X   ; portrait positions for spell target select
01/B6BA: A8           TAY 
01/B6BB: E2 20        SEP #$20
01/B6BD: 68           PLA 
01/B6BE: 20 6E 8E     JSR $8E6E       ; draw portrait
01/B6C1: FA           PLX 
01/B6C2: 68           PLA 
01/B6C3: 1A           INC 
01/B6C4: E8           INX 
01/B6C5: E8           INX 
01/B6C6: 60           RTS 

; [  ]

01/B6C7: AD 9B 1B     LDA $1B9B
01/B6CA: 48           PHA 
01/B6CB: 5A           PHY 
01/B6CC: 20 B4 87     JSR $87B4       ; tax
01/B6CF: BD 8B 1B     LDA $1B8B,X
01/B6D2: D0 16        BNE $B6EA
01/B6D4: A9 08        LDA #$08
01/B6D6: 85 45        STA $45
01/B6D8: A9 FF        LDA #$FF
01/B6DA: 99 00 00     STA $0000,Y
01/B6DD: C8           INY 
01/B6DE: A9 F0        LDA #$F0
01/B6E0: 99 00 00     STA $0000,Y
01/B6E3: C8           INY 
01/B6E4: C6 45        DEC $45
01/B6E6: D0 F0        BNE $B6D8
01/B6E8: 80 17        BRA $B701
01/B6EA: A5 43        LDA $43
01/B6EC: 0A           ASL 
01/B6ED: 0A           ASL 
01/B6EE: 65 43        ADC $43
01/B6F0: 0A           ASL 
01/B6F1: 0A           ASL 
01/B6F2: 0A           ASL 
01/B6F3: 69 24        ADC #$24
01/B6F5: 85 46        STA $46
01/B6F7: A9 44        LDA #$44
01/B6F9: 85 45        STA $45
01/B6FB: A6 45        LDX $45
01/B6FD: 7B           TDC 
01/B6FE: 20 86 82     JSR $8286
01/B701: 7A           PLY 
01/B702: C2 20        REP #$20
01/B704: 98           TYA 
01/B705: 18           CLC 
01/B706: 69 10 00     ADC #$0010
01/B709: A8           TAY 
01/B70A: E2 20        SEP #$20
01/B70C: 68           PLA 
01/B70D: 1A           INC 
01/B70E: C9 05        CMP #$05
01/B710: 90 01        BCC $B713
01/B712: 7B           TDC 
01/B713: 8D 9B 1B     STA $1B9B
01/B716: 60           RTS 
01/B717: 20 05 BA     JSR $BA05
01/B71A: C2 20        REP #$20
01/B71C: 9D 0B 00     STA $000B,X
01/B71F: E2 20        SEP #$20
01/B721: AD 89 1B     LDA $1B89
01/B724: 38           SEC 
01/B725: E9 0E        SBC #$0E
01/B727: 48           PHA 
01/B728: 22 5B FD 1E  JSL $1EFD5B
01/B72C: 68           PLA 
01/B72D: A2 60 B7     LDX #$B760
01/B730: 20 4B 83     JSR $834B       ; do jump table
01/B733: 20 89 95     JSR $9589
01/B736: 8D 86 1A     STA $1A86
01/B739: 20 9F 84     JSR $849F       ; select and clear bg1
01/B73C: A0 51 DD     LDY #$DD51
01/B73F: 20 D9 80     JSR $80D9       ; draw window
01/B742: 20 C8 B3     JSR $B3C8
01/B745: 20 55 B2     JSR $B255
01/B748: 20 58 B4     JSR $B458       ; draw spell target select windows
01/B74B: 20 F2 A2     JSR $A2F2
01/B74E: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/B751: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/B754: 20 36 83     JSR $8336
01/B757: 20 70 84     JSR $8470       ; select bg3
01/B75A: 20 C8 88     JSR $88C8
01/B75D: 4C 47 94     JMP $9447       ; transfer bg3 screen buffer to vram

01/B760: B77C B785 B78E B797 B873 B899 B8DD B934

01/B770: B9BC B9C7 B9E6 B93B B942 B9B1

01/B77C: AF F5 97 0F  LDA $0F97F5
01/B780: 8D 91 1B     STA $1B91
01/B783: 80 4A        BRA $B7CF
01/B785: AF FB 97 0F  LDA $0F97FB
01/B789: 8D 91 1B     STA $1B91
01/B78C: 80 41        BRA $B7CF
01/B78E: AF 01 98 0F  LDA $0F9801
01/B792: 8D 91 1B     STA $1B91
01/B795: 80 38        BRA $B7CF
01/B797: AD BB 1B     LDA $1BBB
01/B79A: F0 09        BEQ $B7A5
01/B79C: AF 07 98 0F  LDA $0F9807
01/B7A0: 8D 91 1B     STA $1B91
01/B7A3: 80 2A        BRA $B7CF
01/B7A5: A9 00        LDA #$00
01/B7A7: 20 B0 B7     JSR $B7B0
01/B7AA: 1A           INC 
01/B7AB: C9 05        CMP #$05
01/B7AD: D0 F8        BNE $B7A7
01/B7AF: 60           RTS 
01/B7B0: 48           PHA 
01/B7B1: 20 B4 87     JSR $87B4       ; tax
01/B7B4: BD 8B 1B     LDA $1B8B,X
01/B7B7: F0 14        BEQ $B7CD
01/B7B9: A5 43        LDA $43
01/B7BB: 20 A0 B9     JSR $B9A0
01/B7BE: BD 03 00     LDA $0003,X
01/B7C1: 30 0A        BMI $B7CD
01/B7C3: C2 20        REP #$20
01/B7C5: BD 09 00     LDA $0009,X
01/B7C8: 9D 07 00     STA $0007,X
01/B7CB: E2 20        SEP #$20
01/B7CD: 68           PLA 
01/B7CE: 60           RTS 
01/B7CF: A9 00        LDA #$00
01/B7D1: EB           XBA 
01/B7D2: AD 91 1B     LDA $1B91
01/B7D5: C2 20        REP #$20
01/B7D7: 0A           ASL 
01/B7D8: 0A           ASL 
01/B7D9: 8D 91 1B     STA $1B91
01/B7DC: E2 20        SEP #$20
01/B7DE: A5 E8        LDA $E8
01/B7E0: 20 01 90     JSR $9001       ; get pointer to character properties
01/B7E3: BD 18 00     LDA $0018,X
01/B7E6: 4A           LSR 
01/B7E7: 4A           LSR 
01/B7E8: 4A           LSR 
01/B7E9: 1A           INC 
01/B7EA: 85 54        STA $54
01/B7EC: 64 55        STZ $55
01/B7EE: A9 00        LDA #$00
01/B7F0: EB           XBA 
01/B7F1: BD 18 00     LDA $0018,X
01/B7F4: 4A           LSR 
01/B7F5: C2 20        REP #$20
01/B7F7: 18           CLC 
01/B7F8: 6D 91 1B     ADC $1B91
01/B7FB: 85 57        STA $57
01/B7FD: 18           CLC 
01/B7FE: 65 57        ADC $57
01/B800: C6 54        DEC $54
01/B802: D0 F9        BNE $B7FD
01/B804: 85 57        STA $57
01/B806: E2 20        SEP #$20
01/B808: E2 10        SEP #$10
01/B80A: A6 41        LDX $41         ; zero
01/B80C: 9B           TXY 
01/B80D: BD 8B 1B     LDA $1B8B,X
01/B810: F0 01        BEQ $B813
01/B812: C8           INY 
01/B813: E8           INX 
01/B814: E0 05        CPX #$05
01/B816: D0 F5        BNE $B80D
01/B818: C2 10        REP #$10
01/B81A: AD BB 1B     LDA $1BBB
01/B81D: F0 08        BEQ $B827
01/B81F: C2 20        REP #$20
01/B821: A5 57        LDA $57
01/B823: 4A           LSR 
01/B824: 4A           LSR 
01/B825: 80 04        BRA $B82B
01/B827: C2 20        REP #$20
01/B829: A5 57        LDA $57
01/B82B: 85 45        STA $45
01/B82D: E2 20        SEP #$20
01/B82F: A9 00        LDA #$00
01/B831: 20 3A B8     JSR $B83A
01/B834: 1A           INC 
01/B835: C9 05        CMP #$05
01/B837: D0 F8        BNE $B831
01/B839: 60           RTS 
01/B83A: 48           PHA 
01/B83B: 8D BC 1B     STA $1BBC
01/B83E: 20 B4 87     JSR $87B4       ; tax
01/B841: BD 8B 1B     LDA $1B8B,X
01/B844: F0 2B        BEQ $B871
01/B846: A6 43        LDX $43
01/B848: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/B84C: 20 01 90     JSR $9001       ; get pointer to character properties
01/B84F: BD 03 00     LDA $0003,X
01/B852: 29 C0        AND #$C0
01/B854: D0 1B        BNE $B871
01/B856: AD BC 1B     LDA $1BBC
01/B859: 20 A0 B9     JSR $B9A0
01/B85C: C2 20        REP #$20
01/B85E: BD 07 00     LDA $0007,X
01/B861: 18           CLC 
01/B862: 65 45        ADC $45
01/B864: DD 09 00     CMP $0009,X
01/B867: 90 03        BCC $B86C
01/B869: BD 09 00     LDA $0009,X
01/B86C: 9D 07 00     STA $0007,X
01/B86F: E2 20        SEP #$20
01/B871: 68           PLA 
01/B872: 60           RTS 
01/B873: A9 00        LDA #$00
01/B875: 20 7E B8     JSR $B87E
01/B878: 1A           INC 
01/B879: C9 05        CMP #$05
01/B87B: D0 F8        BNE $B875
01/B87D: 60           RTS 
01/B87E: 48           PHA 
01/B87F: 20 B4 87     JSR $87B4       ; tax
01/B882: BD 8B 1B     LDA $1B8B,X
01/B885: F0 10        BEQ $B897
01/B887: 20 A2 B9     JSR $B9A2
01/B88A: C2 20        REP #$20
01/B88C: BD 03 00     LDA $0003,X
01/B88F: 29 80 7C     AND #$7C80
01/B892: 9D 03 00     STA $0003,X
01/B895: E2 20        SEP #$20
01/B897: 68           PLA 
01/B898: 60           RTS 
01/B899: A9 00        LDA #$00
01/B89B: 8D BD 1B     STA $1BBD
01/B89E: 20 A8 B8     JSR $B8A8
01/B8A1: 1A           INC 
01/B8A2: C9 05        CMP #$05
01/B8A4: D0 F8        BNE $B89E
01/B8A6: 80 42        BRA $B8EA
01/B8A8: 48           PHA 
01/B8A9: 20 B4 87     JSR $87B4       ; tax
01/B8AC: BD 8B 1B     LDA $1B8B,X
01/B8AF: F0 2A        BEQ $B8DB
01/B8B1: 20 A2 B9     JSR $B9A2
01/B8B4: BD 03 00     LDA $0003,X
01/B8B7: 10 22        BPL $B8DB
01/B8B9: 29 7F        AND #$7F
01/B8BB: 9D 03 00     STA $0003,X
01/B8BE: BD 16 00     LDA $0016,X
01/B8C1: 85 43        STA $43
01/B8C3: C2 20        REP #$20
01/B8C5: A5 43        LDA $43
01/B8C7: 0A           ASL 
01/B8C8: 0A           ASL 
01/B8C9: 65 43        ADC $43
01/B8CB: DD 09 00     CMP $0009,X
01/B8CE: 90 03        BCC $B8D3
01/B8D0: BD 09 00     LDA $0009,X
01/B8D3: 9D 07 00     STA $0007,X
01/B8D6: E2 20        SEP #$20
01/B8D8: EE BD 1B     INC $1BBD
01/B8DB: 68           PLA 
01/B8DC: 60           RTS 
01/B8DD: A9 00        LDA #$00
01/B8DF: 8D BD 1B     STA $1BBD
01/B8E2: 20 07 B9     JSR $B907
01/B8E5: 1A           INC 
01/B8E6: C9 05        CMP #$05
01/B8E8: D0 F8        BNE $B8E2
01/B8EA: AD BD 1B     LDA $1BBD
01/B8ED: D0 17        BNE $B906
01/B8EF: A5 E8        LDA $E8
01/B8F1: 20 01 90     JSR $9001       ; get pointer to character properties
01/B8F4: AD 93 1B     LDA $1B93
01/B8F7: 85 43        STA $43
01/B8F9: C2 20        REP #$20
01/B8FB: BD 0B 00     LDA $000B,X
01/B8FE: 18           CLC 
01/B8FF: 65 43        ADC $43
01/B901: 9D 0B 00     STA $000B,X
01/B904: E2 20        SEP #$20
01/B906: 60           RTS 
01/B907: 48           PHA 
01/B908: 20 B4 87     JSR $87B4       ; tax
01/B90B: BD 8B 1B     LDA $1B8B,X
01/B90E: F0 22        BEQ $B932
01/B910: 20 A2 B9     JSR $B9A2
01/B913: BD 03 00     LDA $0003,X
01/B916: 10 1A        BPL $B932
01/B918: A9 00        LDA #$00
01/B91A: 9D 03 00     STA $0003,X
01/B91D: BD 04 00     LDA $0004,X
01/B920: 29 7F        AND #$7F
01/B922: 9D 04 00     STA $0004,X
01/B925: C2 20        REP #$20
01/B927: BD 09 00     LDA $0009,X
01/B92A: 9D 07 00     STA $0007,X
01/B92D: E2 20        SEP #$20
01/B92F: EE BD 1B     INC $1BBD
01/B932: 68           PLA 
01/B933: 60           RTS 
01/B934: A9 10        LDA #$10
01/B936: A0 03 00     LDY #$0003
01/B939: 80 0E        BRA $B949
01/B93B: A9 20        LDA #$20
01/B93D: A0 03 00     LDY #$0003
01/B940: 80 07        BRA $B949
01/B942: A9 08        LDA #$08
01/B944: A0 03 00     LDY #$0003
01/B947: 80 00        BRA $B949
01/B949: 85 48        STA $48
01/B94B: 49 FF        EOR #$FF
01/B94D: 85 49        STA $49
01/B94F: 84 4B        STY $4B
01/B951: A9 00        LDA #$00
01/B953: 20 5C B9     JSR $B95C
01/B956: 1A           INC 
01/B957: C9 05        CMP #$05
01/B959: D0 F8        BNE $B953
01/B95B: 60           RTS 
01/B95C: 48           PHA 
01/B95D: 20 B4 87     JSR $87B4       ; tax
01/B960: BD 8B 1B     LDA $1B8B,X
01/B963: F0 17        BEQ $B97C
01/B965: 20 A2 B9     JSR $B9A2
01/B968: 86 4E        STX $4E
01/B96A: 64 50        STZ $50
01/B96C: B1 4E        LDA ($4E),Y
01/B96E: 48           PHA 
01/B96F: 25 49        AND $49
01/B971: 91 4E        STA ($4E),Y
01/B973: 68           PLA 
01/B974: 49 FF        EOR #$FF
01/B976: 25 48        AND $48
01/B978: 11 4E        ORA ($4E),Y
01/B97A: 91 4E        STA ($4E),Y
01/B97C: 68           PLA 
01/B97D: 60           RTS 

; [  ]

01/B97E: C2 20        REP #$20
01/B980: A9 57 02     LDA #$0257
01/B983: A2 00 03     LDX #$0300
01/B986: A0 00 A2     LDY #$A200
01/B989: 54 7E 7E     MVN $7E,$7E
01/B98C: E2 20        SEP #$20
01/B98E: 60           RTS 

; [  ]

01/B98F: C2 20        REP #$20
01/B991: A9 57 02     LDA #$0257
01/B994: A2 00 A2     LDX #$A200
01/B997: A0 00 03     LDY #$0300
01/B99A: 54 7E 7E     MVN $7E,$7E
01/B99D: E2 20        SEP #$20
01/B99F: 60           RTS 

; [ get pointer to selected character properties ]

01/B9A0: 85 43        STA $43
01/B9A2: A6 43        LDX $43
01/B9A4: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/B9A8: 4C 01 90     JMP $9001       ; get pointer to character properties

; [  ]

01/B9AB: 20 1F B5     JSR $B51F
01/B9AE: 4C 58 87     JMP $8758       ; error sound effect

; [  ]

01/B9B1: AD 04 1A     LDA $1A04
01/B9B4: 29 10        AND #$10
01/B9B6: F0 F3        BEQ $B9AB
01/B9B8: A9 03        LDA #$03
01/B9BA: 80 14        BRA $B9D0
01/B9BC: AD 04 1A     LDA $1A04
01/B9BF: 29 20        AND #$20
01/B9C1: F0 E8        BEQ $B9AB
01/B9C3: A9 04        LDA #$04
01/B9C5: 80 09        BRA $B9D0
01/B9C7: AD 04 1A     LDA $1A04
01/B9CA: 29 40        AND #$40
01/B9CC: F0 DD        BEQ $B9AB
01/B9CE: A9 05        LDA #$05
01/B9D0: 8D 03 1A     STA $1A03
01/B9D3: 20 05 BA     JSR $BA05
01/B9D6: C2 20        REP #$20
01/B9D8: 9D 0B 00     STA $000B,X
01/B9DB: E2 20        SEP #$20
01/B9DD: 22 B6 FD 1E  JSL $1EFDB6
01/B9E1: AE 65 1A     LDX $1A65
01/B9E4: 9A           TXS 
01/B9E5: 60           RTS 

01/B9E6: A9 00        LDA #$00
01/B9E8: 48           PHA 
01/B9E9: 20 B4 87     JSR $87B4       ; tax
01/B9EC: BD 8B 1B     LDA $1B8B,X
01/B9EF: F0 0D        BEQ $B9FE
01/B9F1: 68           PLA 
01/B9F2: 48           PHA 
01/B9F3: 20 A0 B9     JSR $B9A0
01/B9F6: BD 04 00     LDA $0004,X
01/B9F9: 09 40        ORA #$40
01/B9FB: 9D 04 00     STA $0004,X
01/B9FE: 68           PLA 
01/B9FF: 1A           INC 
01/BA00: C9 05        CMP #$05
01/BA02: D0 E4        BNE $B9E8
01/BA04: 60           RTS 

; [  ]

01/BA05: A5 E8        LDA $E8
01/BA07: 20 01 90     JSR $9001       ; get pointer to character properties
01/BA0A: AD 93 1B     LDA $1B93
01/BA0D: 85 43        STA $43
01/BA0F: C2 20        REP #$20
01/BA11: BD 0B 00     LDA $000B,X
01/BA14: 38           SEC 
01/BA15: E5 43        SBC $43
01/BA17: E2 20        SEP #$20
01/BA19: 60           RTS 

; --------------------------------------------------------------------------

; [ namingway menu ]

01/BA1A: 8B           PHB 
01/BA1B: 0B           PHD 
01/BA1C: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/BA1F: 20 2E BA     JSR $BA2E       ; namingway menu
01/BA22: 20 3F 87     JSR $873F       ; restore dialogue window graphics
01/BA25: 7B           TDC 
01/BA26: 8F 49 1B 00  STA $001B49
01/BA2A: EB           XBA 
01/BA2B: 2B           PLD 
01/BA2C: AB           PLB 
01/BA2D: 60           RTS 

; [ namingway menu (change name?) ]

; 

01/BA2E: 20 7D 8C     JSR $8C7D       ; init menu
01/BA31: A9 7E        LDA #$7E
01/BA33: 48           PHA 
01/BA34: AB           PLB 
01/BA35: EE 49 1B     INC $1B49       ; don't use standalone name change menu
01/BA38: 20 88 84     JSR $8488       ; select bg4
01/BA3B: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/BA3E: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/BA41: A0 CC E0     LDY #$E0CC
01/BA44: 20 D9 80     JSR $80D9       ; draw window
01/BA47: A0 54 E0     LDY #$E054
01/BA4A: 20 FB 82     JSR $82FB       ; draw window and text
01/BA4D: A2 88 01     LDX #$0188
01/BA50: A0 AC E0     LDY #$E0AC
01/BA53: 20 98 87     JSR $8798       ; copy text to screen buffer
01/BA56: 20 A0 8D     JSR $8DA0       ; load character graphics
01/BA59: 20 C9 98     JSR $98C9
01/BA5C: 20 DC BA     JSR $BADC
01/BA5F: A9 FF        LDA #$FF
01/BA61: 8D 4A 1B     STA $1B4A
01/BA64: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/BA67: 20 DF BB     JSR $BBDF
01/BA6A: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/BA6D: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/BA70: 20 64 94     JSR $9464       ; fade in
01/BA73: 9C 48 1B     STZ $1B48
; start of frame loop
01/BA76: AD 48 1B     LDA $1B48
01/BA79: D0 05        BNE $BA80
01/BA7B: A2 10 30     LDX #$3010
01/BA7E: 80 03        BRA $BA83
01/BA80: A2 40 30     LDX #$3040
01/BA83: 7B           TDC 
01/BA84: A0 00 03     LDY #$0300
01/BA87: 20 86 82     JSR $8286
01/BA8A: 20 DC BA     JSR $BADC
01/BA8D: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/BA90: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/BA93: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/BA96: A5 00        LDA $00
01/BA98: 29 80        AND #$80
01/BA9A: F0 0E        BEQ $BAAA       ; branch if A button is not pressed
; A button
01/BA9C: AD 48 1B     LDA $1B48
01/BA9F: D0 07        BNE $BAA8
01/BAA1: 64 00        STZ $00
01/BAA3: 64 01        STZ $01
01/BAA5: 4C F9 BA     JMP $BAF9
01/BAA8: 80 1A        BRA $BAC4
01/BAAA: A5 01        LDA $01
01/BAAC: 29 80        AND #$80
01/BAAE: D0 14        BNE $BAC4       ; branch if B button is pressed
01/BAB0: A5 01        LDA $01
01/BAB2: 29 03        AND #$03
01/BAB4: F0 0B        BEQ $BAC1
; left or right button pressed
01/BAB6: EE 48 1B     INC $1B48
01/BAB9: AD 48 1B     LDA $1B48
01/BABC: 29 01        AND #$01
01/BABE: 8D 48 1B     STA $1B48
01/BAC1: 4C 76 BA     JMP $BA76
; B button
01/BAC4: A0 CC E0     LDY #$E0CC
01/BAC7: 20 D9 80     JSR $80D9       ; draw window
01/BACA: A0 B7 E0     LDY #$E0B7
01/BACD: 20 01 83     JSR $8301       ; draw positioned text
01/BAD0: 20 8A 81     JSR $818A       ; wait for vblank
01/BAD3: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/BAD6: 20 36 83     JSR $8336
01/BAD9: 4C 7E 94     JMP $947E       ; fade out

; [  ]

01/BADC: 20 2E D1     JSR $D12E
01/BADF: AD 4A 1B     LDA $1B4A
01/BAE2: 30 0F        BMI $BAF3
01/BAE4: 85 43        STA $43
01/BAE6: C2 20        REP #$20
01/BAE8: A5 43        LDA $43
01/BAEA: 0A           ASL 
01/BAEB: AA           TAX 
01/BAEC: E2 20        SEP #$20
01/BAEE: A9 08        LDA #$08
01/BAF0: 9D 4B 1B     STA $1B4B,X
01/BAF3: A2 88 25     LDX #$2588
01/BAF6: 4C 62 93     JMP $9362

; [ namingway menu (change whose name?) ]

; 

01/BAF9: 64 45        STZ $45
01/BAFB: A5 45        LDA $45
01/BAFD: 20 19 A9     JSR $A919       ; get character id
01/BB00: D0 0C        BNE $BB0E
01/BB02: E6 45        INC $45
01/BB04: A5 45        LDA $45
01/BB06: C9 05        CMP #$05
01/BB08: D0 F1        BNE $BAFB
01/BB0A: 64 45        STZ $45
01/BB0C: 80 ED        BRA $BAFB
01/BB0E: A5 45        LDA $45
01/BB10: 8D 4A 1B     STA $1B4A
01/BB13: A9 01        LDA #$01
01/BB15: 8D 73 1A     STA $1A73
01/BB18: A0 CC E0     LDY #$E0CC
01/BB1B: 20 D9 80     JSR $80D9       ; draw window
01/BB1E: A0 72 E0     LDY #$E072
01/BB21: 20 01 83     JSR $8301       ; draw positioned text
01/BB24: A0 D0 E0     LDY #$E0D0
01/BB27: 20 D9 80     JSR $80D9       ; draw window
01/BB2A: 20 8A 81     JSR $818A       ; wait for vblank
01/BB2D: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
; start of frame loop
01/BB30: 20 DC BA     JSR $BADC
01/BB33: AD 4A 1B     LDA $1B4A
01/BB36: 20 01 90     JSR $9001       ; get pointer to character properties
01/BB39: 86 60        STX $60
01/BB3B: B2 60        LDA ($60)
01/BB3D: A0 52 01     LDY #$0152
01/BB40: 20 AB 83     JSR $83AB       ; draw character name
01/BB43: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BB46: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/BB49: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/BB4C: A5 01        LDA $01
01/BB4E: 29 01        AND #$01
01/BB50: F0 1C        BEQ $BB6E
; right button
01/BB52: A9 01        LDA #$01
01/BB54: 8D 73 1A     STA $1A73
01/BB57: AD 4A 1B     LDA $1B4A
01/BB5A: 1A           INC 
01/BB5B: C9 05        CMP #$05
01/BB5D: D0 01        BNE $BB60
01/BB5F: 7B           TDC 
01/BB60: 8D 4A 1B     STA $1B4A
01/BB63: 20 01 90     JSR $9001       ; get pointer to character properties
01/BB66: 86 45        STX $45
01/BB68: B2 45        LDA ($45)
01/BB6A: 29 3F        AND #$3F
01/BB6C: F0 E4        BEQ $BB52
01/BB6E: A5 01        LDA $01
01/BB70: 29 02        AND #$02
01/BB72: F0 1B        BEQ $BB8F
; left button
01/BB74: A9 01        LDA #$01
01/BB76: 8D 73 1A     STA $1A73
01/BB79: AD 4A 1B     LDA $1B4A
01/BB7C: 3A           DEC 
01/BB7D: 10 02        BPL $BB81
01/BB7F: A9 04        LDA #$04
01/BB81: 8D 4A 1B     STA $1B4A
01/BB84: 20 01 90     JSR $9001       ; get pointer to character properties
01/BB87: 86 45        STX $45
01/BB89: B2 45        LDA ($45)
01/BB8B: 29 3F        AND #$3F
01/BB8D: F0 E5        BEQ $BB74
01/BB8F: A5 00        LDA $00
01/BB91: 29 80        AND #$80
01/BB93: F0 03        BEQ $BB98
01/BB95: 4C A4 BB     JMP $BBA4
01/BB98: A5 01        LDA $01
01/BB9A: 29 80        AND #$80
01/BB9C: F0 03        BEQ $BBA1
01/BB9E: 4C C4 BA     JMP $BAC4
01/BBA1: 4C 30 BB     JMP $BB30
; A button
01/BBA4: AD 4A 1B     LDA $1B4A
01/BBA7: 20 19 A9     JSR $A919       ; get character id
01/BBAA: 3A           DEC 
01/BBAB: 20 B4 87     JSR $87B4       ; tax
01/BBAE: BF 57 84 01  LDA $018457,X   ; name for each character
01/BBB2: 85 43        STA $43
01/BBB4: C2 20        REP #$20
01/BBB6: A5 43        LDA $43         ; multiply by 6
01/BBB8: 0A           ASL 
01/BBB9: 85 45        STA $45
01/BBBB: 0A           ASL 
01/BBBC: 65 45        ADC $45
01/BBBE: 69 00 15     ADC #$1500
01/BBC1: AA           TAX 
01/BBC2: A9 05 00     LDA #$0005
01/BBC5: A0 0A 1B     LDY #$1B0A      ; copy name to buffer
01/BBC8: 5A           PHY 
01/BBC9: DA           PHX 
01/BBCA: 54 7E 7E     MVN $7E,$7E
01/BBCD: E2 20        SEP #$20
01/BBCF: 20 61 9B     JSR $9B61       ; name change menu
01/BBD2: 7A           PLY 
01/BBD3: FA           PLX 
01/BBD4: C2 20        REP #$20
01/BBD6: A9 05 00     LDA #$0005
01/BBD9: 54 7E 7E     MVN $7E,$7E
01/BBDC: E2 20        SEP #$20
01/BBDE: 60           RTS 

; [  ]

01/BBDF: C2 20        REP #$20
01/BBE1: A9 0F 00     LDA #$000F
01/BBE4: A2 30 81     LDX #$8130
01/BBE7: A0 20 A1     LDY #$A120
01/BBEA: 54 7E 0D     MVN $7E,$0D
01/BBED: E2 20        SEP #$20
01/BBEF: A0 80 F3     LDY #$F380
01/BBF2: 4C 95 D0     JMP $D095

; --------------------------------------------------------------------------

; [ equip menu ]

01/BBF5: EE 1F 1B     INC $1B1F
01/BBF8: 9C 27 1B     STZ $1B27
01/BBFB: 20 52 8A     JSR $8A52       ; select character (main menu)
01/BBFE: A5 E8        LDA $E8
01/BC00: 10 04        BPL $BC06       ; branch if not cancelled
01/BC02: 9C 1F 1B     STZ $1B1F
01/BC05: 60           RTS 
01/BC06: 9C AD 1B     STZ $1BAD
01/BC09: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/BC0C: 20 A9 94     JSR $94A9
01/BC0F: A9 30        LDA #$30        ; sprite layer priority: 3
01/BC11: 85 C1        STA $C1
01/BC13: 85 3F        STA $3F
01/BC15: A5 E8        LDA $E8
01/BC17: 85 D3        STA $D3
01/BC19: 20 92 89     JSR $8992       ; draw portrait
01/BC1C: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/BC1F: A5 E8        LDA $E8
01/BC21: 20 48 89     JSR $8948
01/BC24: C2 20        REP #$20
01/BC26: 98           TYA 
01/BC27: E2 20        SEP #$20
01/BC29: 85 BA        STA $BA
01/BC2B: EB           XBA 
01/BC2C: 85 BC        STA $BC
01/BC2E: 64 B9        STZ $B9
01/BC30: 64 BB        STZ $BB
01/BC32: A9 79        LDA #$79
01/BC34: 8F 0A 21 00  STA $00210A
01/BC38: A9 82        LDA #$82
01/BC3A: 85 AE        STA $AE
01/BC3C: A9 28        LDA #$28
01/BC3E: 85 C2        STA $C2
01/BC40: 85 D2        STA $D2
01/BC42: A5 E7        LDA $E7
01/BC44: 85 B7        STA $B7
01/BC46: 85 C0        STA $C0
01/BC48: A2 2E 95     LDX #$952E
01/BC4B: 86 D0        STX $D0
01/BC4D: A2 4F 82     LDX #$824F      ; transfer sprite data to ppu
01/BC50: 86 CD        STX $CD
01/BC52: 20 6D 84     JSR $846D       ; select and clear bg3
01/BC55: 20 BF 88     JSR $88BF       ; draw selected character block
01/BC58: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/BC5B: A5 E7        LDA $E7
01/BC5D: 0A           ASL 
01/BC5E: 85 43        STA $43
01/BC60: A6 43        LDX $43
01/BC62: C2 20        REP #$20
01/BC64: BF 8B DD 01  LDA $01DD8B,X
01/BC68: AA           TAX 
01/BC69: E2 20        SEP #$20
01/BC6B: A0 61 DB     LDY #$DB61
01/BC6E: DA           PHX 
01/BC6F: 5A           PHY 
01/BC70: 20 D0 84     JSR $84D0       ; transform window
01/BC73: 20 F7 BC     JSR $BCF7       ; select equipment slot
01/BC76: A5 E8        LDA $E8
01/BC78: 22 06 80 03  JSL $038006     ; update character equipment
01/BC7C: 20 DC A2     JSR $A2DC
01/BC7F: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
01/BC82: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BC85: C2 20        REP #$20
01/BC87: A2 00 F6     LDX #$F600
01/BC8A: A0 00 C6     LDY #$C600
01/BC8D: A9 FF 07     LDA #$07FF
01/BC90: 54 7E 7E     MVN $7E,$7E
01/BC93: E2 20        SEP #$20
01/BC95: A9 79        LDA #$79
01/BC97: 8F 0A 21 00  STA $00210A
01/BC9B: 20 70 84     JSR $8470       ; select bg3
01/BC9E: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/BCA1: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/BCA4: A2 B0 FF     LDX #$FFB0
01/BCA7: 86 96        STX $96
01/BCA9: A6 41        LDX $41         ; zero
01/BCAB: 86 99        STX $99
01/BCAD: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BCB0: 20 A4 94     JSR $94A4
01/BCB3: A2 00 08     LDX #$0800
01/BCB6: 86 DE        STX $DE
01/BCB8: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/BCBB: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/BCBE: A2 00 10     LDX #$1000
01/BCC1: 86 DE        STX $DE
01/BCC3: A9 02        LDA #$02
01/BCC5: 85 AE        STA $AE
01/BCC7: A5 E7        LDA $E7
01/BCC9: 09 80        ORA #$80
01/BCCB: 85 B7        STA $B7
01/BCCD: 85 C0        STA $C0
01/BCCF: A9 28        LDA #$28
01/BCD1: 85 C2        STA $C2
01/BCD3: 85 D2        STA $D2
01/BCD5: A2 2E 95     LDX #$952E
01/BCD8: 86 D0        STX $D0
01/BCDA: A2 4F 82     LDX #$824F      ; transfer sprite data to ppu
01/BCDD: 86 CD        STX $CD
01/BCDF: 20 F2 A2     JSR $A2F2
01/BCE2: FA           PLX 
01/BCE3: 7A           PLY 
01/BCE4: 20 D0 84     JSR $84D0       ; transform window
01/BCE7: A9 7A        LDA #$7A
01/BCE9: 8F 0A 21 00  STA $00210A
01/BCED: 20 19 89     JSR $8919       ; draw main menu
01/BCF0: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/BCF3: 9C 1F 1B     STZ $1B1F
01/BCF6: 60           RTS 

; [ select equipment slot ]

01/BCF7: 20 B7 84     JSR $84B7       ; select and clear bg2
01/BCFA: AD AD 1B     LDA $1BAD
01/BCFD: D0 10        BNE $BD0F
01/BCFF: C2 20        REP #$20
01/BD01: A2 00 A6     LDX #$A600      ; copy bg2 tilemap to buffer
01/BD04: A0 00 F6     LDY #$F600
01/BD07: A9 FF 07     LDA #$07FF
01/BD0A: 54 7E 7E     MVN $7E,$7E
01/BD0D: E2 20        SEP #$20
01/BD0F: A0 A9 DD     LDY #$DDA9
01/BD12: 20 FB 82     JSR $82FB       ; draw window and text
01/BD15: A5 E8        LDA $E8
01/BD17: 20 01 90     JSR $9001       ; get pointer to character properties
01/BD1A: 86 60        STX $60
01/BD1C: A5 E8        LDA $E8
01/BD1E: 22 06 80 03  JSL $038006     ; update character equipment
01/BD22: A0 1D 00     LDY #$001D
01/BD25: B1 60        LDA ($60),Y
01/BD27: A0 90 00     LDY #$0090
01/BD2A: 20 7F 83     JSR $837F       ; draw 4-digit number
01/BD2D: A0 2A 00     LDY #$002A
01/BD30: B1 60        LDA ($60),Y
01/BD32: A0 10 01     LDY #$0110
01/BD35: 20 7F 83     JSR $837F       ; draw 4-digit number
01/BD38: A0 24 00     LDY #$0024
01/BD3B: B1 60        LDA ($60),Y
01/BD3D: A0 90 01     LDY #$0190
01/BD40: 20 7F 83     JSR $837F       ; draw 4-digit number
01/BD43: A9 31        LDA #$31
01/BD45: 8D 90 A6     STA $A690
01/BD48: A9 3B        LDA #$3B
01/BD4A: 8D 10 A7     STA $A710
01/BD4D: A9 41        LDA #$41
01/BD4F: 8D 90 A7     STA $A790
01/BD52: B2 60        LDA ($60)
01/BD54: A0 C6 01     LDY #$01C6
01/BD57: 20 AB 83     JSR $83AB       ; draw character name
01/BD5A: B2 60        LDA ($60)
01/BD5C: 29 C0        AND #$C0
01/BD5E: 4A           LSR 
01/BD5F: 4A           LSR 
01/BD60: 4A           LSR 
01/BD61: 85 45        STA $45
01/BD63: 64 46        STZ $46
01/BD65: C2 20        REP #$20
01/BD67: A9 D9 E2     LDA #$E2D9
01/BD6A: 18           CLC 
01/BD6B: 65 45        ADC $45
01/BD6D: A8           TAY 
01/BD6E: E2 20        SEP #$20
01/BD70: A2 48 02     LDX #$0248
01/BD73: 20 CD 82     JSR $82CD       ; draw text
01/BD76: 64 DB        STZ $DB
01/BD78: A0 30 00     LDY #$0030
01/BD7B: A2 64 01     LDX #$0164
01/BD7E: 20 13 90     JSR $9013
01/BD81: C8           INY 
01/BD82: A2 E4 01     LDX #$01E4
01/BD85: 20 13 90     JSR $9013
01/BD88: C8           INY 
01/BD89: A2 64 02     LDX #$0264
01/BD8C: 20 13 90     JSR $9013
01/BD8F: A0 33 00     LDY #$0033
01/BD92: A2 64 00     LDX #$0064
01/BD95: 20 13 90     JSR $9013
01/BD98: C8           INY 
01/BD99: B1 60        LDA ($60),Y
01/BD9B: C9 02        CMP #$02
01/BD9D: 90 08        BCC $BDA7
01/BD9F: 5A           PHY 
01/BDA0: A0 B6 00     LDY #$00B6
01/BDA3: 20 69 83     JSR $8369       ; draw 2-digit number
01/BDA6: 7A           PLY 
01/BDA7: C8           INY 
01/BDA8: A2 E4 00     LDX #$00E4
01/BDAB: 20 13 90     JSR $9013
01/BDAE: C8           INY 
01/BDAF: B1 60        LDA ($60),Y
01/BDB1: C9 02        CMP #$02
01/BDB3: 90 06        BCC $BDBB
01/BDB5: A0 36 01     LDY #$0136
01/BDB8: 20 69 83     JSR $8369       ; draw 2-digit number
01/BDBB: AD AD 1B     LDA $1BAD
01/BDBE: D0 37        BNE $BDF7
01/BDC0: 20 A2 84     JSR $84A2       ; select bg1
01/BDC3: A0 A9 DD     LDY #$DDA9
01/BDC6: 20 D9 80     JSR $80D9       ; draw window
01/BDC9: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/BDCC: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/BDCF: EE AD 1B     INC $1BAD
01/BDD2: C2 20        REP #$20
01/BDD4: A2 00 C6     LDX #$C600      ; copy bg4 tilemap to buffer
01/BDD7: A0 00 F6     LDY #$F600
01/BDDA: A9 FF 07     LDA #$07FF
01/BDDD: 54 7E 7E     MVN $7E,$7E
01/BDE0: E2 20        SEP #$20
01/BDE2: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
01/BDE5: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BDE8: A9 7A        LDA #$7A
01/BDEA: 8F 0A 21 00  STA $00210A
01/BDEE: 64 96        STZ $96
01/BDF0: 64 97        STZ $97
01/BDF2: 20 BA 84     JSR $84BA       ; select bg2
01/BDF5: 80 03        BRA $BDFA
01/BDF7: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
; start of frame loop
01/BDFA: A9 00        LDA #$00
01/BDFC: EB           XBA 
01/BDFD: AD 37 1B     LDA $1B37
01/BE00: 0A           ASL 
01/BE01: 6D 37 1B     ADC $1B37
01/BE04: C2 20        REP #$20
01/BE06: 69 28 1B     ADC #$1B28      ; get pointer to inventory cursor position
01/BE09: 85 51        STA $51
01/BE0B: 1A           INC 
01/BE0C: 85 54        STA $54
01/BE0E: 1A           INC 
01/BE0F: 85 57        STA $57
01/BE11: E2 20        SEP #$20
01/BE13: AD 37 1B     LDA $1B37
01/BE16: 0A           ASL 
01/BE17: 0A           ASL 
01/BE18: 0A           ASL 
01/BE19: 0A           ASL 
01/BE1A: 69 10        ADC #$10
01/BE1C: 85 46        STA $46
01/BE1E: A9 60        LDA #$60
01/BE20: 85 45        STA $45
01/BE22: 20 81 82     JSR $8281       ; draw cursor sprite
01/BE25: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/BE28: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/BE2B: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/BE2E: A5 01        LDA $01
01/BE30: 29 08        AND #$08
01/BE32: F0 0B        BEQ $BE3F
; up button
01/BE34: AD 37 1B     LDA $1B37
01/BE37: 3A           DEC 
01/BE38: 10 02        BPL $BE3C
01/BE3A: A9 04        LDA #$04
01/BE3C: 8D 37 1B     STA $1B37
01/BE3F: A5 01        LDA $01
01/BE41: 29 04        AND #$04
01/BE43: F0 0D        BEQ $BE52
; down button
01/BE45: AD 37 1B     LDA $1B37
01/BE48: 1A           INC 
01/BE49: C9 05        CMP #$05
01/BE4B: D0 02        BNE $BE4F
01/BE4D: A9 00        LDA #$00
01/BE4F: 8D 37 1B     STA $1B37
01/BE52: A5 00        LDA $00
01/BE54: 29 80        AND #$80
01/BE56: F0 27        BEQ $BE7F
; A button
01/BE58: AD 37 1B     LDA $1B37
01/BE5B: 0A           ASL 
01/BE5C: 20 B4 87     JSR $87B4       ; tax
01/BE5F: BF C7 C0 01  LDA $01C0C7,X   ; set max and min valid item id
01/BE63: 8D 1D 1B     STA $1B1D
01/BE66: BF C8 C0 01  LDA $01C0C8,X
01/BE6A: 8D 1E 1B     STA $1B1E
01/BE6D: 20 89 BE     JSR $BE89       ; select item from inventory
01/BE70: 20 DC A2     JSR $A2DC
01/BE73: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
01/BE76: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BE79: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/BE7C: 4C F7 BC     JMP $BCF7
; B button
01/BE7F: A5 01        LDA $01
01/BE81: 29 80        AND #$80
01/BE83: F0 01        BEQ $BE86
01/BE85: 60           RTS 
01/BE86: 4C FA BD     JMP $BDFA

; [ select item from inventory ]

01/BE89: A9 00        LDA #$00
01/BE8B: EB           XBA 
01/BE8C: B2 57        LDA ($57)       ; scroll position
01/BE8E: C2 20        REP #$20
01/BE90: 0A           ASL 
01/BE91: 0A           ASL 
01/BE92: 0A           ASL 
01/BE93: 0A           ASL 
01/BE94: 18           CLC 
01/BE95: 69 98 FF     ADC #$FF98
01/BE98: 85 99        STA $99
01/BE9A: E2 20        SEP #$20
01/BE9C: 20 88 84     JSR $8488       ; select bg4
01/BE9F: A5 E8        LDA $E8
01/BEA1: 20 01 90     JSR $9001       ; get pointer to character properties
01/BEA4: 86 E5        STX $E5
01/BEA6: 20 72 A1     JSR $A172
01/BEA9: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/BEAC: 20 A4 94     JSR $94A4
01/BEAF: A5 E8        LDA $E8
01/BEB1: 20 01 90     JSR $9001       ; get pointer to character properties
01/BEB4: 86 60        STX $60
; start of frame loop
01/BEB6: B2 51        LDA ($51)       ; cursor y position
01/BEB8: 0A           ASL 
01/BEB9: 0A           ASL 
01/BEBA: 0A           ASL 
01/BEBB: 0A           ASL 
01/BEBC: 69 76        ADC #$76
01/BEBE: 85 46        STA $46
01/BEC0: B2 54        LDA ($54)       ; cursor x position
01/BEC2: F0 02        BEQ $BEC6
01/BEC4: A9 68        LDA #$68
01/BEC6: 69 08        ADC #$08
01/BEC8: 85 45        STA $45
01/BECA: 20 7C 82     JSR $827C       ; draw cursor sprite
01/BECD: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/BED0: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; right button
01/BED3: A5 01        LDA $01
01/BED5: 29 01        AND #$01
01/BED7: F0 09        BEQ $BEE2
01/BED9: B2 54        LDA ($54)
01/BEDB: 1A           INC 
01/BEDC: 29 01        AND #$01
01/BEDE: 92 54        STA ($54)
01/BEE0: F0 40        BEQ $BF22
; left button
01/BEE2: A5 01        LDA $01
01/BEE4: 29 02        AND #$02
01/BEE6: F0 09        BEQ $BEF1
01/BEE8: B2 54        LDA ($54)
01/BEEA: 1A           INC 
01/BEEB: 29 01        AND #$01
01/BEED: 92 54        STA ($54)
01/BEEF: D0 06        BNE $BEF7
; up button
01/BEF1: A5 01        LDA $01
01/BEF3: 29 08        AND #$08
01/BEF5: F0 25        BEQ $BF1C
01/BEF7: B2 51        LDA ($51)
01/BEF9: 3A           DEC 
01/BEFA: 10 1E        BPL $BF1A
01/BEFC: B2 57        LDA ($57)
01/BEFE: 3A           DEC 
01/BEFF: 30 1B        BMI $BF1C
01/BF01: 92 57        STA ($57)
01/BF03: A9 08        LDA #$08
01/BF05: C2 20        REP #$20
01/BF07: C6 99        DEC $99
01/BF09: C6 99        DEC $99
01/BF0B: E2 20        SEP #$20
01/BF0D: 20 A1 94     JSR $94A1
01/BF10: 3A           DEC 
01/BF11: D0 F2        BNE $BF05
01/BF13: 20 A5 82     JSR $82A5
01/BF16: 90 BB        BCC $BED3
01/BF18: 80 02        BRA $BF1C
01/BF1A: 92 51        STA ($51)
; down button
01/BF1C: A5 01        LDA $01
01/BF1E: 29 04        AND #$04
01/BF20: F0 29        BEQ $BF4B
01/BF22: B2 51        LDA ($51)
01/BF24: 1A           INC 
01/BF25: C9 06        CMP #$06
01/BF27: D0 20        BNE $BF49
01/BF29: B2 57        LDA ($57)
01/BF2B: 1A           INC 
01/BF2C: C9 13        CMP #$13
01/BF2E: F0 1B        BEQ $BF4B
01/BF30: 92 57        STA ($57)
01/BF32: A9 08        LDA #$08
01/BF34: C2 20        REP #$20
01/BF36: E6 99        INC $99
01/BF38: E6 99        INC $99
01/BF3A: E2 20        SEP #$20
01/BF3C: 20 A1 94     JSR $94A1
01/BF3F: 3A           DEC 
01/BF40: D0 F2        BNE $BF34
01/BF42: 20 A5 82     JSR $82A5
01/BF45: 90 8C        BCC $BED3
01/BF47: 80 02        BRA $BF4B
01/BF49: 92 51        STA ($51)
; A button
01/BF4B: A5 00        LDA $00
01/BF4D: 29 80        AND #$80
01/BF4F: F0 4B        BEQ $BF9C
01/BF51: A6 60        LDX $60
01/BF53: 86 5D        STX $5D
01/BF55: B2 51        LDA ($51)
01/BF57: 18           CLC 
01/BF58: 72 57        ADC ($57)
01/BF5A: 0A           ASL 
01/BF5B: 72 54        ADC ($54)
01/BF5D: 0A           ASL 
01/BF5E: 20 B4 87     JSR $87B4       ; tax
01/BF61: BD 40 14     LDA $1440,X
01/BF64: 86 4B        STX $4B
01/BF66: F0 09        BEQ $BF71       ; branch if inventory slot empty (remove item)
01/BF68: A6 5D        LDX $5D
01/BF6A: 86 E5        STX $E5
01/BF6C: 20 A6 BF     JSR $BFA6       ; check if item can be equipped
01/BF6F: 90 03        BCC $BF74
01/BF71: 4C D6 C0     JMP $C0D6       ; equip/remove item
01/BF74: 20 58 87     JSR $8758       ; error sound effect
01/BF77: A5 EB        LDA $EB
01/BF79: F0 21        BEQ $BF9C
01/BF7B: 20 DC A2     JSR $A2DC
01/BF7E: 20 A2 84     JSR $84A2       ; select bg1
01/BF81: A0 D9 DD     LDY #$DDD9
01/BF84: 20 FB 82     JSR $82FB       ; draw window and text
01/BF87: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/BF8A: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/BF8D: 20 36 83     JSR $8336
01/BF90: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/BF93: A0 A9 DD     LDY #$DDA9
01/BF96: 20 D9 80     JSR $80D9       ; draw window
01/BF99: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
; B button
01/BF9C: A5 01        LDA $01
01/BF9E: 29 80        AND #$80
01/BFA0: F0 01        BEQ $BFA3
01/BFA2: 60           RTS 
01/BFA3: 4C B6 BE     JMP $BEB6

; [ check if item can be equipped ]

01/BFA6: 9C EB 01     STZ $01EB
01/BFA9: C9 B0        CMP #$B0
01/BFAB: B0 05        BCS $BFB2       ; branch if not a weapon or armor
01/BFAD: 20 1A C0     JSR $C01A       ; check if item can go in equipment slot
01/BFB0: B0 02        BCS $BFB4
01/BFB2: 18           CLC 
01/BFB3: 60           RTS 
01/BFB4: 20 75 C2     JSR $C275       ; check item equipability
01/BFB7: B0 01        BCS $BFBA
01/BFB9: 60           RTS 
01/BFBA: AD 37 1B     LDA $1B37
01/BFBD: C9 02        CMP #$02
01/BFBF: 90 01        BCC $BFC2
01/BFC1: 60           RTS 
01/BFC2: B2 E5        LDA ($E5)
01/BFC4: 29 C0        AND #$C0
01/BFC6: C9 C0        CMP #$C0        ; branch if ambidextrous
01/BFC8: F0 10        BEQ $BFDA
01/BFCA: 18           CLC 
01/BFCB: 2A           ROL 
01/BFCC: 2A           ROL 
01/BFCD: 2A           ROL 
01/BFCE: 20 B4 87     JSR $87B4       ; tax
01/BFD1: BF F6 BF 01  LDA $01BFF6,X
01/BFD5: CD 37 1B     CMP $1B37
01/BFD8: D0 09        BNE $BFE3       ; branch if not main hand
01/BFDA: AD 39 1B     LDA $1B39
01/BFDD: A2 00 5F     LDX #$5F00      ; allow all weapons and shields
01/BFE0: 4C 0A C0     JMP $C00A
01/BFE3: AD 39 1B     LDA $1B39
01/BFE6: A2 4D 5F     LDX #$5F4D      ; allow bows and arrows
01/BFE9: 20 0A C0     JSR $C00A
01/BFEC: B0 06        BCS $BFF4
01/BFEE: A2 61 6C     LDX #$6C61      ; allow shields
01/BFF1: 4C 0A C0     JMP $C00A
01/BFF4: 38           SEC 
01/BFF5: 60           RTS 

; main hand slot for each handedness
01/BFF6: 02 01 00 02

; [ check if item is in range ]

01/BFFA: A2 81 9B     LDX #$9B81      ; allow armor
01/BFFD: 80 08        BRA $C007
01/BFFF: A2 9C AF     LDX #$AF9C      ; allow accessory
01/C002: 80 03        BRA $C007
01/C004: A2 6D 80     LDX #$806D      ; allow helmet
01/C007: AD 39 1B     LDA $1B39
01/C00A: 86 45        STX $45
01/C00C: C5 45        CMP $45
01/C00E: 90 08        BCC $C018
01/C010: C5 46        CMP $46
01/C012: F0 02        BEQ $C016
01/C014: B0 02        BCS $C018
01/C016: 38           SEC 
01/C017: 60           RTS 
01/C018: 18           CLC 
01/C019: 60           RTS 

; [ check if item can go in equipment slot ]

01/C01A: 8D 39 1B     STA $1B39
01/C01D: F0 F7        BEQ $C016
01/C01F: AD 37 1B     LDA $1B37
01/C022: 20 B4 87     JSR $87B4       ; tax
01/C025: BF D1 C0 01  LDA $01C0D1,X
01/C029: 8D 3A 1B     STA $1B3A
01/C02C: C9 30        CMP #$30
01/C02E: F0 D4        BEQ $C004       ; branch if helmet slot
01/C030: C9 31        CMP #$31
01/C032: F0 C6        BEQ $BFFA       ; branch if armor slot
01/C034: C9 32        CMP #$32
01/C036: F0 C7        BEQ $BFFF       ; branch if accessory slot
01/C038: AD 39 1B     LDA $1B39
01/C03B: AD 37 1B     LDA $1B37
01/C03E: F0 04        BEQ $C044
01/C040: A9 33        LDA #$33        ; right hand
01/C042: 80 02        BRA $C046
01/C044: A9 35        LDA #$35        ; left hand
01/C046: 85 43        STA $43
01/C048: A4 43        LDY $43
01/C04A: B1 E5        LDA ($E5),Y
01/C04C: 8D 38 1B     STA $1B38
01/C04F: D0 02        BNE $C053
01/C051: 38           SEC 
01/C052: 60           RTS 
01/C053: A2 44 4C     LDX #$4C44      ; allow harp, rune axe, wrench
01/C056: 20 0A C0     JSR $C00A
01/C059: 90 04        BCC $C05F
01/C05B: E6 EB        INC $EB
01/C05D: 18           CLC 
01/C05E: 60           RTS 
01/C05F: AD 39 1B     LDA $1B39
01/C062: A2 44 4C     LDX #$4C44
01/C065: 20 0A C0     JSR $C00A
01/C068: B0 F1        BCS $C05B
01/C06A: AD 39 1B     LDA $1B39
01/C06D: A2 00 43     LDX #$4300
01/C070: 20 0A C0     JSR $C00A
01/C073: 90 1D        BCC $C092
01/C075: B2 E5        LDA ($E5)
01/C077: 29 C0        AND #$C0
01/C079: C9 C0        CMP #$C0
01/C07B: F0 09        BEQ $C086
01/C07D: AD 38 1B     LDA $1B38
01/C080: A2 61 6C     LDX #$6C61
01/C083: 4C 0A C0     JMP $C00A
01/C086: AD 38 1B     LDA $1B38
01/C089: A2 00 43     LDX #$4300
01/C08C: 20 0A C0     JSR $C00A
01/C08F: 90 EC        BCC $C07D
01/C091: 60           RTS 
01/C092: A2 61 6C     LDX #$6C61
01/C095: 20 0A C0     JSR $C00A
01/C098: 90 09        BCC $C0A3
01/C09A: AD 38 1B     LDA $1B38
01/C09D: A2 00 43     LDX #$4300
01/C0A0: 4C 0A C0     JMP $C00A
01/C0A3: A2 4D 53     LDX #$534D
01/C0A6: 20 0A C0     JSR $C00A
01/C0A9: 90 09        BCC $C0B4
01/C0AB: AD 38 1B     LDA $1B38
01/C0AE: A2 54 5F     LDX #$5F54
01/C0B1: 4C 0A C0     JMP $C00A
01/C0B4: A2 54 5F     LDX #$5F54
01/C0B7: 20 0A C0     JSR $C00A
01/C0BA: 90 09        BCC $C0C5
01/C0BC: AD 38 1B     LDA $1B38
01/C0BF: A2 4D 53     LDX #$534D
01/C0C2: 4C 0A C0     JMP $C00A
01/C0C5: 18           CLC 
01/C0C6: 60           RTS 

; valid item ranges for each equipment slot (5 * 2 bytes)
01/C0C7: 01 6C 01 6C 6D 80 81 9B 9C AF

; character properties pointer for each equipment slot (5 * 1 byte)
01/C0D1: 33 35 30 31 32

; [ equip/remove item ]

01/C0D6: AD 37 1B     LDA $1B37       ; equipped item slot
01/C0D9: 20 B4 87     JSR $87B4       ; tax
01/C0DC: BF D1 C0 01  LDA $01C0D1,X
01/C0E0: A6 4B        LDX $4B
01/C0E2: 85 43        STA $43
01/C0E4: A4 43        LDY $43
01/C0E6: AD 37 1B     LDA $1B37
01/C0E9: C9 02        CMP #$02
01/C0EB: 90 6A        BCC $C157       ; branch if a weapon slot
; armor slot
01/C0ED: B1 60        LDA ($60),Y
01/C0EF: D0 13        BNE $C104       ; branch if slot is not empty
01/C0F1: BD 40 14     LDA $1440,X
01/C0F4: D0 01        BNE $C0F7
01/C0F6: 60           RTS 
01/C0F7: 91 60        STA ($60),Y
01/C0F9: DE 41 14     DEC $1441,X
01/C0FC: D0 05        BNE $C103
01/C0FE: A9 00        LDA #$00
01/C100: 9D 40 14     STA $1440,X
01/C103: 60           RTS 
01/C104: BD 40 14     LDA $1440,X
01/C107: D0 0D        BNE $C116
01/C109: B1 60        LDA ($60),Y
01/C10B: 9D 40 14     STA $1440,X
01/C10E: FE 41 14     INC $1441,X
01/C111: A9 00        LDA #$00
01/C113: 91 60        STA ($60),Y
01/C115: 60           RTS 
01/C116: D1 60        CMP ($60),Y
01/C118: F0 E9        BEQ $C103
01/C11A: BD 41 14     LDA $1441,X
01/C11D: C9 01        CMP #$01
01/C11F: D0 0D        BNE $C12E
01/C121: B1 60        LDA ($60),Y
01/C123: 48           PHA 
01/C124: BD 40 14     LDA $1440,X
01/C127: 91 60        STA ($60),Y
01/C129: 68           PLA 
01/C12A: 9D 40 14     STA $1440,X
01/C12D: 60           RTS 
01/C12E: B1 60        LDA ($60),Y
01/C130: DA           PHX 
01/C131: 20 38 C2     JSR $C238       ; find item in inventory
01/C134: F0 06        BEQ $C13C       ; branch if found
01/C136: 7B           TDC             ; find an empty slot
01/C137: 20 38 C2     JSR $C238       ; find item in inventory
01/C13A: D0 17        BNE $C153       ; branch if no empty slots
01/C13C: B1 60        LDA ($60),Y
01/C13E: 9D 40 14     STA $1440,X
01/C141: FE 41 14     INC $1441,X
01/C144: FA           PLX 
01/C145: BD 40 14     LDA $1440,X
01/C148: 91 60        STA ($60),Y
01/C14A: DE 41 14     DEC $1441,X
01/C14D: D0 03        BNE $C152
01/C14F: 9E 40 14     STZ $1440,X
01/C152: 60           RTS 
01/C153: FA           PLX 
01/C154: 4C 58 87     JMP $8758       ; error sound effect
; weapon slot
01/C157: B1 60        LDA ($60),Y
01/C159: D0 2D        BNE $C188
01/C15B: BD 40 14     LDA $1440,X
01/C15E: D0 01        BNE $C161
01/C160: 60           RTS 
01/C161: 91 60        STA ($60),Y
01/C163: 20 5C C2     JSR $C25C       ; check if item is an arrow
01/C166: 90 0F        BCC $C177
01/C168: C8           INY 
01/C169: BD 41 14     LDA $1441,X
01/C16C: 91 60        STA ($60),Y
01/C16E: A9 00        LDA #$00
01/C170: 9D 40 14     STA $1440,X
01/C173: 9D 41 14     STA $1441,X
01/C176: 60           RTS 
01/C177: C8           INY 
01/C178: B1 60        LDA ($60),Y
01/C17A: 1A           INC 
01/C17B: 91 60        STA ($60),Y
01/C17D: DE 41 14     DEC $1441,X
01/C180: D0 05        BNE $C187
01/C182: A9 00        LDA #$00
01/C184: 9D 40 14     STA $1440,X
01/C187: 60           RTS 
01/C188: BD 40 14     LDA $1440,X
01/C18B: D0 13        BNE $C1A0
01/C18D: B1 60        LDA ($60),Y
01/C18F: 9D 40 14     STA $1440,X
01/C192: C8           INY 
01/C193: B1 60        LDA ($60),Y
01/C195: 9D 41 14     STA $1441,X
01/C198: A9 00        LDA #$00
01/C19A: 91 60        STA ($60),Y
01/C19C: 88           DEY 
01/C19D: 91 60        STA ($60),Y
01/C19F: 60           RTS 
01/C1A0: D1 60        CMP ($60),Y
01/C1A2: D0 1F        BNE $C1C3
01/C1A4: 20 5C C2     JSR $C25C       ; check if item is an arrow
01/C1A7: 90 DE        BCC $C187
01/C1A9: BD 41 14     LDA $1441,X
01/C1AC: C8           INY 
01/C1AD: 18           CLC 
01/C1AE: 71 60        ADC ($60),Y
01/C1B0: C9 64        CMP #$64
01/C1B2: B0 04        BCS $C1B8
01/C1B4: 91 60        STA ($60),Y
01/C1B6: 80 B6        BRA $C16E
01/C1B8: 38           SEC 
01/C1B9: E9 63        SBC #$63
01/C1BB: 9D 41 14     STA $1441,X
01/C1BE: A9 63        LDA #$63
01/C1C0: 91 60        STA ($60),Y
01/C1C2: 60           RTS 
01/C1C3: BD 40 14     LDA $1440,X
01/C1C6: 20 5C C2     JSR $C25C       ; check if item is an arrow
01/C1C9: 90 02        BCC $C1CD
01/C1CB: 80 07        BRA $C1D4
01/C1CD: BD 41 14     LDA $1441,X
01/C1D0: C9 01        CMP #$01
01/C1D2: D0 08        BNE $C1DC
01/C1D4: 20 68 C2     JSR $C268       ; swap equipment with inventory (item id)
01/C1D7: C8           INY 
01/C1D8: E8           INX 
01/C1D9: 4C 68 C2     JMP $C268       ; swap equipment with inventory (quantity)
01/C1DC: C8           INY 
01/C1DD: A9 63        LDA #$63
01/C1DF: 38           SEC 
01/C1E0: F1 60        SBC ($60),Y
01/C1E2: 85 E3        STA $E3
01/C1E4: 88           DEY 
01/C1E5: B1 60        LDA ($60),Y
01/C1E7: 20 38 C2     JSR $C238       ; find item in inventory
01/C1EA: F0 0A        BEQ $C1F6
01/C1EC: A9 00        LDA #$00
01/C1EE: 20 38 C2     JSR $C238       ; find item in inventory
01/C1F1: F0 03        BEQ $C1F6
01/C1F3: 4C 54 C1     JMP $C154
01/C1F6: B1 60        LDA ($60),Y
01/C1F8: 9D 40 14     STA $1440,X
01/C1FB: C8           INY 
01/C1FC: B1 60        LDA ($60),Y
01/C1FE: 18           CLC 
01/C1FF: 7D 41 14     ADC $1441,X
01/C202: 9D 41 14     STA $1441,X
01/C205: A6 4B        LDX $4B
01/C207: BD 40 14     LDA $1440,X
01/C20A: 20 5C C2     JSR $C25C       ; check if item is an arrow
01/C20D: B0 15        BCS $C224
01/C20F: A9 01        LDA #$01
01/C211: 91 60        STA ($60),Y
01/C213: 88           DEY 
01/C214: BD 40 14     LDA $1440,X
01/C217: 91 60        STA ($60),Y
01/C219: DE 41 14     DEC $1441,X
01/C21C: D0 05        BNE $C223
01/C21E: A9 00        LDA #$00
01/C220: 9D 40 14     STA $1440,X
01/C223: 60           RTS 
01/C224: BD 41 14     LDA $1441,X
01/C227: 91 60        STA ($60),Y
01/C229: 88           DEY 
01/C22A: BD 40 14     LDA $1440,X
01/C22D: 91 60        STA ($60),Y
01/C22F: A9 00        LDA #$00
01/C231: 9D 40 14     STA $1440,X
01/C234: 9D 41 14     STA $1441,X
01/C237: 60           RTS 

; [ find item in inventory ]

;   A: item id (can be zero to find an empty slot)
; $E3: max stack size

01/C238: 5A           PHY 
01/C239: A0 30 00     LDY #$0030
01/C23C: A6 41        LDX $41         ; zero
01/C23E: DD 40 14     CMP $1440,X
01/C241: F0 09        BEQ $C24C
01/C243: E8           INX 
01/C244: E8           INX 
01/C245: 88           DEY 
01/C246: D0 F6        BNE $C23E
01/C248: 7A           PLY 
01/C249: A9 01        LDA #$01        ; return 1 if not found
01/C24B: 60           RTS 
01/C24C: 48           PHA 
01/C24D: BD 41 14     LDA $1441,X
01/C250: C5 E3        CMP $E3
01/C252: 90 03        BCC $C257
01/C254: 68           PLA 
01/C255: 80 EC        BRA $C243
01/C257: 68           PLA 
01/C258: 7A           PLY 
01/C259: A9 00        LDA #$00
01/C25B: 60           RTS 

; [ check if item is an arrow ]

01/C25C: C9 54        CMP #$54
01/C25E: 90 06        BCC $C266
01/C260: C9 60        CMP #$60
01/C262: B0 02        BCS $C266
01/C264: 38           SEC             ; set carry if item is an arrow
01/C265: 60           RTS 
01/C266: 18           CLC             ; clear carry if item is not an arrow
01/C267: 60           RTS 

; [ swap equipment with inventory ]

; swaps one byte, either item id or quantity

01/C268: B1 60        LDA ($60),Y
01/C26A: 48           PHA 
01/C26B: BD 40 14     LDA $1440,X
01/C26E: 91 60        STA ($60),Y
01/C270: 68           PLA 
01/C271: 9D 40 14     STA $1440,X
01/C274: 60           RTS 

; [ check item equipability ]

01/C275: A9 00        LDA #$00
01/C277: EB           XBA 
01/C278: AD 39 1B     LDA $1B39
01/C27B: C9 B0        CMP #$B0
01/C27D: B0 3A        BCS $C2B9       ; branch if not a weapon or armor
01/C27F: C2 20        REP #$20
01/C281: 0A           ASL 
01/C282: 0A           ASL 
01/C283: 0A           ASL 
01/C284: AA           TAX 
01/C285: E2 20        SEP #$20
01/C287: BF 06 91 0F  LDA $0F9106,X   ; item properties, byte 6
01/C28B: 29 1F        AND #$1F
01/C28D: 0A           ASL 
01/C28E: 20 B4 87     JSR $87B4       ; tax
01/C291: C2 20        REP #$20
01/C293: BF 50 A5 0F  LDA $0FA550,X   ; item equipability
01/C297: 85 45        STA $45
01/C299: E2 20        SEP #$20
01/C29B: A0 01 00     LDY #$0001
01/C29E: B1 E5        LDA ($E5),Y     ; character job
01/C2A0: 29 0F        AND #$0F
01/C2A2: 1A           INC 
01/C2A3: 85 48        STA $48
01/C2A5: 64 49        STZ $49
01/C2A7: C2 20        REP #$20
01/C2A9: A9 01 00     LDA #$0001      ; set bit for job
01/C2AC: C6 48        DEC $48
01/C2AE: F0 03        BEQ $C2B3
01/C2B0: 0A           ASL 
01/C2B1: 80 F9        BRA $C2AC
01/C2B3: 25 45        AND $45
01/C2B5: D0 04        BNE $C2BB
01/C2B7: E2 20        SEP #$20
01/C2B9: 18           CLC 
01/C2BA: 60           RTS 
01/C2BB: E2 20        SEP #$20
01/C2BD: 38           SEC 
01/C2BE: 60           RTS 

; --------------------------------------------------------------------------

; [ shop menu ]

01/C2BF: 8B           PHB 
01/C2C0: 0B           PHD 
01/C2C1: A2 00 01     LDX #$0100
01/C2C4: DA           PHX 
01/C2C5: 2B           PLD 
01/C2C6: A9 7E        LDA #$7E
01/C2C8: 48           PHA 
01/C2C9: AB           PLB 
01/C2CA: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/C2CD: 20 7D 8C     JSR $8C7D       ; init menu
01/C2D0: A2 00 ED     LDX #$ED00      ; items $00-$ED valid (all but key items)
01/C2D3: 8E 1D 1B     STX $1B1D
01/C2D6: A9 20        LDA #$20        ; sprite layer priority: 2
01/C2D8: 85 C1        STA $C1
01/C2DA: 9C 79 1B     STZ $1B79
01/C2DD: 9C 7A 1B     STZ $1B7A
01/C2E0: 20 A4 94     JSR $94A4
01/C2E3: A9 20        LDA #$20
01/C2E5: 85 3F        STA $3F
01/C2E7: 9C 94 1B     STZ $1B94
01/C2EA: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/C2ED: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/C2F0: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/C2F3: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/C2F6: 20 03 CB     JSR $CB03
01/C2F9: A9 0A        LDA #$0A
01/C2FB: 8D 7C 1B     STA $1B7C
01/C2FE: 20 5F C3     JSR $C35F
01/C301: 20 7E 94     JSR $947E       ; fade out
01/C304: 20 3F 87     JSR $873F       ; restore dialogue window graphics
01/C307: 7B           TDC 
01/C308: EB           XBA 
01/C309: 2B           PLD 
01/C30A: AB           PLB 
01/C30B: 60           RTS 

; [  ]

01/C30C: 20 88 84     JSR $8488       ; select bg4
01/C30F: A2 C0 48     LDX #$48C0
01/C312: 8E 71 1A     STX $1A71
01/C315: 20 B3 98     JSR $98B3
01/C318: 20 CE 91     JSR $91CE
01/C31B: A0 A6 DE     LDY #$DEA6
01/C31E: 20 D9 80     JSR $80D9       ; draw window
01/C321: 20 EC C3     JSR $C3EC
01/C324: A0 AA DE     LDY #$DEAA
01/C327: 20 D9 80     JSR $80D9       ; draw window
01/C32A: A0 AE DE     LDY #$DEAE
01/C32D: 20 D9 80     JSR $80D9       ; draw window
01/C330: A0 B2 DE     LDY #$DEB2
01/C333: 20 D9 80     JSR $80D9       ; draw window
01/C336: A9 00        LDA #$00
01/C338: EB           XBA 
01/C339: AD 01 1A     LDA $1A01
01/C33C: 0A           ASL 
01/C33D: 0A           ASL 
01/C33E: 6D 01 1A     ADC $1A01
01/C341: C2 20        REP #$20
01/C343: 18           CLC 
01/C344: 69 BE DE     ADC #$DEBE
01/C347: A8           TAY 
01/C348: E2 20        SEP #$20
01/C34A: A2 46 00     LDX #$0046
01/C34D: 20 CD 82     JSR $82CD       ; draw text
01/C350: A0 CD DE     LDY #$DECD
01/C353: 4C 01 83     JMP $8301       ; draw positioned text

; [  ]

01/C356: 20 0C C3     JSR $C30C
01/C359: A0 BA DE     LDY #$DEBA
01/C35C: 4C D9 80     JMP $80D9       ; draw window

; [  ]

01/C35F: 20 A0 8D     JSR $8DA0       ; load character graphics
01/C362: 20 56 C3     JSR $C356
01/C365: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/C368: 20 64 94     JSR $9464       ; fade in
01/C36B: 80 0F        BRA $C37C

; [  ]

01/C36D: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/C370: 20 56 C3     JSR $C356
01/C373: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/C376: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/C379: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/C37C: AD 79 1B     LDA $1B79
01/C37F: 0A           ASL 
01/C380: 0A           ASL 
01/C381: 0A           ASL 
01/C382: 85 45        STA $45
01/C384: 0A           ASL 
01/C385: 0A           ASL 
01/C386: 65 45        ADC $45
01/C388: 69 10        ADC #$10
01/C38A: 85 45        STA $45
01/C38C: A9 30        LDA #$30
01/C38E: 85 46        STA $46
01/C390: 20 81 82     JSR $8281       ; draw cursor sprite
01/C393: 20 1E 92     JSR $921E
01/C396: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C399: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/C39C: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/C39F: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/C3A2: A5 01        LDA $01
01/C3A4: 29 01        AND #$01
01/C3A6: F0 0D        BEQ $C3B5
01/C3A8: AD 79 1B     LDA $1B79
01/C3AB: 1A           INC 
01/C3AC: C9 03        CMP #$03
01/C3AE: D0 02        BNE $C3B2
01/C3B0: A9 00        LDA #$00
01/C3B2: 8D 79 1B     STA $1B79
01/C3B5: A5 01        LDA $01
01/C3B7: 29 02        AND #$02
01/C3B9: F0 0B        BEQ $C3C6
01/C3BB: AD 79 1B     LDA $1B79
01/C3BE: 3A           DEC 
01/C3BF: 10 02        BPL $C3C3
01/C3C1: A9 02        LDA #$02
01/C3C3: 8D 79 1B     STA $1B79
01/C3C6: A5 00        LDA $00
01/C3C8: 29 80        AND #$80
01/C3CA: F0 16        BEQ $C3E2
01/C3CC: AD 79 1B     LDA $1B79
01/C3CF: C9 02        CMP #$02
01/C3D1: D0 01        BNE $C3D4
01/C3D3: 60           RTS 
01/C3D4: 48           PHA 
01/C3D5: 68           PLA 
01/C3D6: A2 01 C4     LDX #$C401
01/C3D9: 20 4B 83     JSR $834B       ; do jump table
01/C3DC: 20 DC A2     JSR $A2DC
01/C3DF: 4C 6D C3     JMP $C36D
01/C3E2: A5 01        LDA $01
01/C3E4: 29 80        AND #$80
01/C3E6: F0 01        BEQ $C3E9
01/C3E8: 60           RTS 
01/C3E9: 4C 7C C3     JMP $C37C

; [  ]

01/C3EC: A0 0A DF     LDY #$DF0A
01/C3EF: 20 01 83     JSR $8301       ; draw positioned text
01/C3F2: 20 88 84     JSR $8488       ; select bg4
01/C3F5: A0 A6 01     LDY #$01A6
01/C3F8: AD A2 16     LDA $16A2
01/C3FB: AE A0 16     LDX $16A0
01/C3FE: 4C A6 8F     JMP $8FA6       ; draw number text (7 digits)

; buy/sell jump table
01/C401: C405 C7BE

; [ buy menu ]

01/C405: A5 34        LDA $34
01/C407: 85 DB        STA $DB
01/C409: A9 00        LDA #$00
01/C40B: 20 38 C2     JSR $C238       ; find item in inventory
01/C40E: C9 00        CMP #$00
01/C410: F0 18        BEQ $C42A
01/C412: 20 1E 92     JSR $921E
01/C415: 20 F2 A2     JSR $A2F2
01/C418: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C41B: 20 A2 84     JSR $84A2       ; select bg1
01/C41E: A0 0F DF     LDY #$DF0F
01/C421: 20 FB 82     JSR $82FB       ; draw window and text
01/C424: 20 E3 83     JSR $83E3       ; open window
01/C427: 4C 36 83     JMP $8336
01/C42A: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/C42D: 20 88 84     JSR $8488       ; select bg4
01/C430: A0 AA DE     LDY #$DEAA
01/C433: 20 D9 80     JSR $80D9       ; draw window
01/C436: 20 EC C3     JSR $C3EC
01/C439: A0 B2 DE     LDY #$DEB2
01/C43C: 20 D9 80     JSR $80D9       ; draw window
01/C43F: A0 F1 DE     LDY #$DEF1
01/C442: 20 01 83     JSR $8301       ; draw positioned text
01/C445: A0 B6 DE     LDY #$DEB6
01/C448: 20 D9 80     JSR $80D9       ; draw window
01/C44B: 20 A0 C4     JSR $C4A0       ; load shop list
01/C44E: 98           TYA 
01/C44F: 8D 7D 1B     STA $1B7D
01/C452: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C455: 20 E3 83     JSR $83E3       ; open window
01/C458: 9C CB 1B     STZ $1BCB
; start of frame loop
01/C45B: 20 0D CB     JSR $CB0D
01/C45E: 20 1E 92     JSR $921E
01/C461: AD 7C 1B     LDA $1B7C
01/C464: A0 9A 01     LDY #$019A
01/C467: 20 69 83     JSR $8369       ; draw 2-digit number
01/C46A: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C46D: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/C470: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/C473: 20 1F CB     JSR $CB1F       ; update item quantity
01/C476: AD CB 1B     LDA $1BCB
01/C479: F0 06        BEQ $C481
01/C47B: 9C CB 1B     STZ $1BCB
01/C47E: 20 9A C4     JSR $C49A       ; update shop list
; A button
01/C481: A5 00        LDA $00
01/C483: 29 80        AND #$80
01/C485: F0 09        BEQ $C490
01/C487: A0 10 03     LDY #$0310
01/C48A: 20 B5 C5     JSR $C5B5       ; select item to buy
01/C48D: 4C DC A2     JMP $A2DC
; B button
01/C490: A5 01        LDA $01
01/C492: 29 80        AND #$80
01/C494: F0 01        BEQ $C497
01/C496: 60           RTS 
01/C497: 4C 5B C4     JMP $C45B

; [ update shop list ]

01/C49A: 20 A0 C4     JSR $C4A0       ; load shop list
01/C49D: 4C 3A 94     JMP $943A       ; transfer bg4 screen buffer to vram

; [ load shop list ]

01/C4A0: A6 41        LDX $41         ; zero
01/C4A2: 8E 78 1A     STX $1A78
01/C4A5: 8E 7A 1A     STX $1A7A
01/C4A8: 8E 7C 1A     STX $1A7C
01/C4AB: 8E 7E 1A     STX $1A7E
01/C4AE: 20 88 84     JSR $8488       ; select bg4
01/C4B1: A2 55 1B     LDX #$1B55
01/C4B4: 86 51        STX $51
01/C4B6: A9 00        LDA #$00
01/C4B8: EB           XBA 
01/C4B9: AD 00 1A     LDA $1A00
01/C4BC: 0A           ASL 
01/C4BD: 0A           ASL 
01/C4BE: 0A           ASL 
01/C4BF: C2 20        REP #$20
01/C4C1: 69 00 A3     ADC #$A300      ; 13/A300 (shop data)
01/C4C4: 85 5A        STA $5A
01/C4C6: E2 20        SEP #$20
01/C4C8: A9 13        LDA #$13
01/C4CA: 85 5C        STA $5C
01/C4CC: A4 41        LDY $41         ; zero
; start of item loop
01/C4CE: 8C 80 1A     STY $1A80
01/C4D1: B7 5A        LDA [$5A],Y
01/C4D3: C9 FF        CMP #$FF
01/C4D5: D0 01        BNE $C4D8
01/C4D7: 60           RTS 
01/C4D8: 85 5D        STA $5D
01/C4DA: 92 51        STA ($51)
01/C4DC: 20 AE C5     JSR $C5AE       ; increment shop list pointer
01/C4DF: 5A           PHY 
01/C4E0: 20 B4 87     JSR $87B4       ; tax
01/C4E3: BF 50 A4 0F  LDA $0FA450,X   ; item prices
01/C4E7: 10 4A        BPL $C533
; 1000x price multiplier
01/C4E9: 29 7F        AND #$7F
01/C4EB: 8F 02 42 00  STA $004202
01/C4EF: A9 FA        LDA #$FA        ; multiply by 250
01/C4F1: 8F 03 42 00  STA $004203
01/C4F5: C2 20        REP #$20
01/C4F7: 98           TYA 
01/C4F8: 0A           ASL 
01/C4F9: AA           TAX 
01/C4FA: BF 9E C5 01  LDA $01C59E,X
01/C4FE: A8           TAY 
01/C4FF: E2 20        SEP #$20
01/C501: AF 16 42 00  LDA $004216
01/C505: 85 45        STA $45
01/C507: AF 17 42 00  LDA $004217
01/C50B: 85 46        STA $46
01/C50D: A9 00        LDA #$00
01/C50F: 85 47        STA $47         ; multiply by 4
01/C511: 26 45        ROL $45
01/C513: 26 46        ROL $46
01/C515: 26 47        ROL $47
01/C517: 26 45        ROL $45
01/C519: 26 46        ROL $46
01/C51B: 26 47        ROL $47
01/C51D: A6 45        LDX $45
01/C51F: C2 20        REP #$20
01/C521: 8A           TXA 
01/C522: 92 51        STA ($51)
01/C524: E6 51        INC $51
01/C526: E6 51        INC $51
01/C528: E2 20        SEP #$20
01/C52A: A5 47        LDA $47
01/C52C: 92 51        STA ($51)
01/C52E: 20 AE C5     JSR $C5AE       ; increment shop list pointer
01/C531: 80 28        BRA $C55B
; 10x price multiplier
01/C533: 8F 02 42 00  STA $004202
01/C537: A9 0A        LDA #$0A        ; multiply by 10
01/C539: 8F 03 42 00  STA $004203
01/C53D: C2 20        REP #$20
01/C53F: 98           TYA 
01/C540: 0A           ASL 
01/C541: AA           TAX 
01/C542: BF 9E C5 01  LDA $01C59E,X
01/C546: A8           TAY 
01/C547: AF 16 42 00  LDA $004216
01/C54B: AA           TAX 
01/C54C: 92 51        STA ($51)
01/C54E: E6 51        INC $51
01/C550: E6 51        INC $51
01/C552: E2 20        SEP #$20
01/C554: A9 00        LDA #$00
01/C556: 92 51        STA ($51)
01/C558: 20 AE C5     JSR $C5AE       ; increment shop list pointer
01/C55B: 20 AA CA     JSR $CAAA
01/C55E: C2 20        REP #$20
01/C560: 98           TYA 
01/C561: 38           SEC 
01/C562: E9 30 00     SBC #$0030
01/C565: AA           TAX 
01/C566: E2 20        SEP #$20
01/C568: A0 0C DF     LDY #$DF0C
01/C56B: 20 CD 82     JSR $82CD       ; draw text
01/C56E: 7A           PLY 
01/C56F: A5 5D        LDA $5D
01/C571: 5A           PHY 
01/C572: C2 20        REP #$20
01/C574: 98           TYA 
01/C575: 0A           ASL 
01/C576: AA           TAX 
01/C577: BF 8E C5 01  LDA $01C58E,X
01/C57B: A8           TAY 
01/C57C: E2 20        SEP #$20
01/C57E: A5 5D        LDA $5D
01/C580: 20 60 90     JSR $9060
01/C583: 7A           PLY 
01/C584: C8           INY 
01/C585: C0 08 00     CPY #$0008
01/C588: F0 03        BEQ $C58D
01/C58A: 4C CE C4     JMP $C4CE
01/C58D: 60           RTS 

01/C58E: 0246 02C6 0346 03C6 0446 04C6 0546 05C6
01/C59E: 0296 0316 0396 0416 0496 0516 0596 0616

; [ increment shop list pointer ]

01/C5AE: C2 20        REP #$20
01/C5B0: E6 51        INC $51
01/C5B2: E2 20        SEP #$20
01/C5B4: 60           RTS 

; [ select item to buy ]

; start of frame loop
01/C5B5: AD 7B 1B     LDA $1B7B       ; cursor position
01/C5B8: 0A           ASL 
01/C5B9: 0A           ASL 
01/C5BA: 0A           ASL 
01/C5BB: 0A           ASL 
01/C5BC: 69 50        ADC #$50
01/C5BE: 85 46        STA $46
01/C5C0: A9 10        LDA #$10
01/C5C2: 85 45        STA $45
01/C5C4: 20 81 82     JSR $8281       ; draw cursor sprite
01/C5C7: 20 72 C7     JSR $C772
01/C5CA: 20 1E 92     JSR $921E
01/C5CD: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C5D0: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/C5D3: A5 01        LDA $01
01/C5D5: 29 80        AND #$80
01/C5D7: F0 01        BEQ $C5DA
01/C5D9: 60           RTS 
; A button
01/C5DA: A5 00        LDA $00
01/C5DC: 29 80        AND #$80
01/C5DE: F0 0F        BEQ $C5EF
01/C5E0: 20 65 C6     JSR $C665       ; select item to buy
01/C5E3: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/C5E6: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/C5E9: 20 F2 C3     JSR $C3F2
01/C5EC: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
; up button
01/C5EF: A5 01        LDA $01
01/C5F1: 29 08        AND #$08
01/C5F3: F0 15        BEQ $C60A
01/C5F5: AD 7B 1B     LDA $1B7B
01/C5F8: 3A           DEC 
01/C5F9: 10 04        BPL $C5FF
01/C5FB: AD 7D 1B     LDA $1B7D
01/C5FE: 3A           DEC 
01/C5FF: 8D 7B 1B     STA $1B7B
01/C602: 20 B4 87     JSR $87B4       ; tax
01/C605: BD 78 1A     LDA $1A78,X
01/C608: D0 EB        BNE $C5F5
; down button
01/C60A: A5 01        LDA $01
01/C60C: 29 04        AND #$04
01/C60E: F0 16        BEQ $C626
01/C610: AD 7B 1B     LDA $1B7B
01/C613: 1A           INC 
01/C614: CD 7D 1B     CMP $1B7D
01/C617: 90 02        BCC $C61B
01/C619: A9 00        LDA #$00
01/C61B: 8D 7B 1B     STA $1B7B
01/C61E: 20 B4 87     JSR $87B4       ; tax
01/C621: BD 78 1A     LDA $1A78,X
01/C624: D0 EA        BNE $C610
; left or right button
01/C626: A5 01        LDA $01
01/C628: 29 03        AND #$03
01/C62A: F0 13        BEQ $C63F
01/C62C: AD 7A 1B     LDA $1B7A
01/C62F: 49 FF        EOR #$FF
01/C631: 29 01        AND #$01
01/C633: 8D 7A 1B     STA $1B7A
01/C636: 20 0D CB     JSR $CB0D
01/C639: 20 9A C4     JSR $C49A       ; update shop list
01/C63C: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
; X button
01/C63F: A5 00        LDA $00
01/C641: 29 40        AND #$40
01/C643: F0 1D        BEQ $C662
01/C645: AD 7A 1B     LDA $1B7A
01/C648: F0 18        BEQ $C662
01/C64A: AD 7C 1B     LDA $1B7C
01/C64D: 18           CLC 
01/C64E: 69 0A        ADC #$0A        ; increase by 10
01/C650: C9 64        CMP #$64
01/C652: 90 02        BCC $C656
01/C654: A9 0A        LDA #$0A
01/C656: 8D 7C 1B     STA $1B7C
01/C659: A0 9A 01     LDY #$019A
01/C65C: 20 69 83     JSR $8369       ; draw 2-digit number
01/C65F: 20 9A C4     JSR $C49A       ; update shop list
01/C662: 4C B5 C5     JMP $C5B5

; [ buy item ]

01/C665: AD 7A 1B     LDA $1B7A
01/C668: F0 04        BEQ $C66E
01/C66A: AD 7C 1B     LDA $1B7C
01/C66D: 3A           DEC 
01/C66E: 1A           INC 
01/C66F: 85 45        STA $45
01/C671: 8D 75 1B     STA $1B75
01/C674: AD 7B 1B     LDA $1B7B
01/C677: 0A           ASL 
01/C678: 0A           ASL 
01/C679: 20 B4 87     JSR $87B4       ; tax
01/C67C: BD 56 1B     LDA $1B56,X
01/C67F: 85 37        STA $37
01/C681: BD 57 1B     LDA $1B57,X
01/C684: 85 38        STA $38
01/C686: BD 58 1B     LDA $1B58,X
01/C689: 85 39        STA $39
01/C68B: 64 3A        STZ $3A
01/C68D: 64 3B        STZ $3B
01/C68F: 64 3C        STZ $3C
01/C691: 64 3D        STZ $3D
01/C693: 64 3E        STZ $3E
01/C695: C2 20        REP #$20
01/C697: A5 37        LDA $37
01/C699: 18           CLC 
01/C69A: 65 3B        ADC $3B
01/C69C: 85 3B        STA $3B
01/C69E: A5 39        LDA $39
01/C6A0: 65 3D        ADC $3D
01/C6A2: 85 3D        STA $3D
01/C6A4: E2 20        SEP #$20
01/C6A6: C6 45        DEC $45
01/C6A8: D0 EB        BNE $C695
01/C6AA: AE A0 16     LDX $16A0
01/C6AD: 86 37        STX $37
01/C6AF: AD A2 16     LDA $16A2
01/C6B2: 85 39        STA $39
01/C6B4: 64 3A        STZ $3A
01/C6B6: C2 20        REP #$20
01/C6B8: A5 37        LDA $37
01/C6BA: 38           SEC 
01/C6BB: E5 3B        SBC $3B
01/C6BD: 85 37        STA $37
01/C6BF: A5 39        LDA $39
01/C6C1: E5 3D        SBC $3D
01/C6C3: 85 39        STA $39
01/C6C5: E2 20        SEP #$20
01/C6C7: A5 3A        LDA $3A
01/C6C9: 10 53        BPL $C71E
01/C6CB: A2 C0 50     LDX #$50C0
01/C6CE: 8E 71 1A     STX $1A71
01/C6D1: 20 CE 91     JSR $91CE
01/C6D4: A9 09        LDA #$09
01/C6D6: 8D 01 FE     STA $FE01
01/C6D9: 8D 05 FE     STA $FE05
01/C6DC: 8D 09 FE     STA $FE09
01/C6DF: 8D 0D FE     STA $FE0D
01/C6E2: 8D 11 FE     STA $FE11
01/C6E5: 8D 15 FE     STA $FE15
01/C6E8: 8D 19 FE     STA $FE19
01/C6EB: 8D 1D FE     STA $FE1D
01/C6EE: 8D 21 FE     STA $FE21
01/C6F1: 8D 25 FE     STA $FE25
01/C6F4: 9C 73 1A     STZ $1A73
01/C6F7: 20 1E 92     JSR $921E
01/C6FA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C6FD: 20 A2 84     JSR $84A2       ; select bg1
01/C700: A0 3B DF     LDY #$DF3B
01/C703: 20 FB 82     JSR $82FB       ; draw window and text
01/C706: 20 E3 83     JSR $83E3       ; open window
01/C709: 20 58 87     JSR $8758       ; error sound effect
01/C70C: 20 36 83     JSR $8336
01/C70F: A2 C0 48     LDX #$48C0
01/C712: 8E 71 1A     STX $1A71
01/C715: 20 CE 91     JSR $91CE
01/C718: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/C71B: 4C 2D 94     JMP $942D       ; transfer bg1 screen buffer to vram
01/C71E: A9 00        LDA #$00
01/C720: 20 38 C2     JSR $C238       ; find item in inventory
01/C723: C9 00        CMP #$00
01/C725: F0 03        BEQ $C72A
01/C727: 4C 12 C4     JMP $C412
01/C72A: DA           PHX 
01/C72B: A5 37        LDA $37
01/C72D: 8D A0 16     STA $16A0
01/C730: A6 38        LDX $38
01/C732: 8E A1 16     STX $16A1
01/C735: FA           PLX 
01/C736: AD 7B 1B     LDA $1B7B
01/C739: 0A           ASL 
01/C73A: 0A           ASL 
01/C73B: 85 43        STA $43
01/C73D: A4 43        LDY $43
01/C73F: B9 55 1B     LDA $1B55,Y
01/C742: 9D 40 14     STA $1440,X
01/C745: AD 75 1B     LDA $1B75
01/C748: 9D 41 14     STA $1441,X
01/C74B: 20 A2 84     JSR $84A2       ; select bg1
01/C74E: A0 61 DF     LDY #$DF61
01/C751: 20 FB 82     JSR $82FB       ; draw window and text
01/C754: 20 1E 92     JSR $921E
01/C757: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C75A: A9 2B        LDA #$2B        ; cash register sound effect
01/C75C: 20 62 87     JSR $8762       ; play sound effect
01/C75F: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/C762: 20 36 83     JSR $8336
01/C765: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C768: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/C76B: A5 02        LDA $02
01/C76D: 05 03        ORA $03
01/C76F: D0 F4        BNE $C765       ; wait for keypress
01/C771: 60           RTS 

; [  ]

01/C772: 9C 15 FE     STZ $FE15
01/C775: 9C 19 FE     STZ $FE19
01/C778: 9C 1D FE     STZ $FE1D
01/C77B: 9C 21 FE     STZ $FE21
01/C77E: 9C 25 FE     STZ $FE25
01/C781: AD 7B 1B     LDA $1B7B
01/C784: 0A           ASL 
01/C785: 0A           ASL 
01/C786: 20 B4 87     JSR $87B4       ; tax
01/C789: BD 55 1B     LDA $1B55,X
01/C78C: D0 01        BNE $C78F
01/C78E: 60           RTS 
01/C78F: C9 CE        CMP #$CE
01/C791: B0 FB        BCS $C78E
01/C793: 8D 39 1B     STA $1B39
01/C796: A9 00        LDA #$00
01/C798: 20 A1 C7     JSR $C7A1
01/C79B: 1A           INC 
01/C79C: C9 05        CMP #$05
01/C79E: D0 F8        BNE $C798
01/C7A0: 60           RTS 

; [  ]

01/C7A1: 48           PHA 
01/C7A2: 85 57        STA $57
01/C7A4: 20 19 A9     JSR $A919       ; get character id
01/C7A7: F0 13        BEQ $C7BC
01/C7A9: 86 E5        STX $E5
01/C7AB: 20 75 C2     JSR $C275       ; check item equipability
01/C7AE: 90 0C        BCC $C7BC
01/C7B0: A5 57        LDA $57
01/C7B2: 0A           ASL 
01/C7B3: 0A           ASL 
01/C7B4: 20 B4 87     JSR $87B4       ; tax
01/C7B7: A9 08        LDA #$08
01/C7B9: 9D 15 FE     STA $FE15,X
01/C7BC: 68           PLA 
01/C7BD: 60           RTS 

; [ sell menu ]

01/C7BE: 20 03 CB     JSR $CB03
01/C7C1: A2 B8 FF     LDX #$FFB8
01/C7C4: 86 9F        STX $9F
01/C7C6: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
01/C7C9: 20 0C C3     JSR $C30C
01/C7CC: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/C7CF: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/C7D2: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/C7D5: 20 A2 84     JSR $84A2       ; select bg1
01/C7D8: A0 AA DE     LDY #$DEAA
01/C7DB: 20 D9 80     JSR $80D9       ; draw window
01/C7DE: A0 A7 DF     LDY #$DFA7
01/C7E1: 20 01 83     JSR $8301       ; draw positioned text
01/C7E4: A0 FF DE     LDY #$DEFF
01/C7E7: 20 01 83     JSR $8301       ; draw positioned text
01/C7EA: 20 70 84     JSR $8470       ; select bg3
01/C7ED: 20 A4 94     JSR $94A4
01/C7F0: 20 72 A1     JSR $A172
01/C7F3: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/C7F6: 20 A2 84     JSR $84A2       ; select bg1
01/C7F9: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C7FC: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/C7FF: 20 E3 83     JSR $83E3       ; open window
; start of frame loop
01/C802: A9 20        LDA #$20
01/C804: 85 3F        STA $3F
01/C806: AD 7A 1B     LDA $1B7A
01/C809: F0 05        BEQ $C810
01/C80B: A2 58 30     LDX #$3058
01/C80E: 80 03        BRA $C813
01/C810: A2 40 30     LDX #$3040
01/C813: A0 00 03     LDY #$0300
01/C816: A9 00        LDA #$00
01/C818: 20 86 82     JSR $8286
01/C81B: AD 7C 1B     LDA $1B7C
01/C81E: A0 9A 01     LDY #$019A
01/C821: 20 69 83     JSR $8369       ; draw 2-digit number
01/C824: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C827: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/C82A: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/C82D: 20 1F CB     JSR $CB1F       ; update item quantity
; A button
01/C830: A5 00        LDA $00
01/C832: 29 80        AND #$80
01/C834: F0 09        BEQ $C83F
01/C836: A0 10 03     LDY #$0310
01/C839: 20 9C CA     JSR $CA9C
01/C83C: 4C 49 C8     JMP $C849       ; select item to sell
; B button
01/C83F: A5 01        LDA $01
01/C841: 29 80        AND #$80
01/C843: F0 01        BEQ $C846
01/C845: 60           RTS 
01/C846: 4C 02 C8     JMP $C802

; [ select item to sell ]

01/C849: A9 20        LDA #$20
01/C84B: 85 3F        STA $3F
01/C84D: AD 94 1B     LDA $1B94
01/C850: 0A           ASL 
01/C851: 0A           ASL 
01/C852: 0A           ASL 
01/C853: 0A           ASL 
01/C854: 69 58        ADC #$58
01/C856: 85 46        STA $46
01/C858: AD 95 1B     LDA $1B95
01/C85B: F0 04        BEQ $C861
01/C85D: A9 78        LDA #$78
01/C85F: 80 02        BRA $C863
01/C861: A9 08        LDA #$08
01/C863: 85 45        STA $45
01/C865: 20 81 82     JSR $8281       ; draw cursor sprite
01/C868: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/C86B: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/C86E: A5 01        LDA $01
01/C870: 29 80        AND #$80
01/C872: F0 02        BEQ $C876
01/C874: 18           CLC 
01/C875: 60           RTS 
; A button
01/C876: A5 00        LDA $00
01/C878: 29 80        AND #$80
01/C87A: F0 27        BEQ $C8A3
01/C87C: 20 36 C9     JSR $C936       ; confirm sell item
01/C87F: 90 15        BCC $C896
01/C881: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/C884: 20 6D 84     JSR $846D       ; select and clear bg3
01/C887: 20 72 A1     JSR $A172
01/C88A: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/C88D: 20 F2 C3     JSR $C3F2
01/C890: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/C893: 20 1D 94     JSR $941D       ; clear bg2 screen buffer in vram
01/C896: A9 20        LDA #$20
01/C898: 85 3F        STA $3F
01/C89A: 20 88 84     JSR $8488       ; select bg4
01/C89D: A0 1C 03     LDY #$031C
01/C8A0: 20 DF A2     JSR $A2DF
; right button
01/C8A3: A5 01        LDA $01
01/C8A5: 29 01        AND #$01
01/C8A7: F0 0B        BEQ $C8B4
01/C8A9: AD 95 1B     LDA $1B95
01/C8AC: 1A           INC 
01/C8AD: 29 01        AND #$01
01/C8AF: 8D 95 1B     STA $1B95
01/C8B2: F0 4C        BEQ $C900
; left button
01/C8B4: A5 01        LDA $01
01/C8B6: 29 02        AND #$02
01/C8B8: F0 0B        BEQ $C8C5
01/C8BA: AD 95 1B     LDA $1B95
01/C8BD: 1A           INC 
01/C8BE: 29 01        AND #$01
01/C8C0: 8D 95 1B     STA $1B95
01/C8C3: D0 06        BNE $C8CB
; up button
01/C8C5: A5 01        LDA $01
01/C8C7: 29 08        AND #$08
01/C8C9: F0 2F        BEQ $C8FA
01/C8CB: AD 94 1B     LDA $1B94
01/C8CE: 3A           DEC 
01/C8CF: 30 05        BMI $C8D6
01/C8D1: 8D 94 1B     STA $1B94
01/C8D4: 80 24        BRA $C8FA
01/C8D6: AD 96 1B     LDA $1B96
01/C8D9: 3A           DEC 
01/C8DA: 30 1E        BMI $C8FA
01/C8DC: 8D 96 1B     STA $1B96
01/C8DF: A9 08        LDA #$08
01/C8E1: 85 45        STA $45
01/C8E3: C2 20        REP #$20
01/C8E5: C6 9F        DEC $9F
01/C8E7: C6 9F        DEC $9F
01/C8E9: E2 20        SEP #$20
01/C8EB: 20 A1 94     JSR $94A1
01/C8EE: C6 45        DEC $45
01/C8F0: D0 F1        BNE $C8E3
01/C8F2: 20 A5 82     JSR $82A5
01/C8F5: B0 03        BCS $C8FA
01/C8F7: 4C 6E C8     JMP $C86E
; down button
01/C8FA: A5 01        LDA $01
01/C8FC: 29 04        AND #$04
01/C8FE: F0 33        BEQ $C933
01/C900: AD 94 1B     LDA $1B94
01/C903: 1A           INC 
01/C904: C9 08        CMP #$08
01/C906: F0 05        BEQ $C90D
01/C908: 8D 94 1B     STA $1B94
01/C90B: 80 26        BRA $C933
01/C90D: AD 96 1B     LDA $1B96
01/C910: 1A           INC 
01/C911: C9 11        CMP #$11
01/C913: F0 1E        BEQ $C933
01/C915: 8D 96 1B     STA $1B96
01/C918: A9 08        LDA #$08
01/C91A: 85 45        STA $45
01/C91C: C2 20        REP #$20
01/C91E: E6 9F        INC $9F
01/C920: E6 9F        INC $9F
01/C922: E2 20        SEP #$20
01/C924: 20 A1 94     JSR $94A1
01/C927: C6 45        DEC $45
01/C929: D0 F1        BNE $C91C
01/C92B: 20 A5 82     JSR $82A5
01/C92E: B0 03        BCS $C933
01/C930: 4C 6E C8     JMP $C86E
01/C933: 4C 49 C8     JMP $C849

; [ confirm sell item ]

01/C936: A9 30        LDA #$30
01/C938: 85 3F        STA $3F
01/C93A: AD 94 1B     LDA $1B94
01/C93D: 18           CLC 
01/C93E: 6D 96 1B     ADC $1B96
01/C941: 0A           ASL 
01/C942: 0A           ASL 
01/C943: 6D 95 1B     ADC $1B95
01/C946: 6D 95 1B     ADC $1B95
01/C949: 20 B4 87     JSR $87B4       ; tax
01/C94C: 8E 98 1B     STX $1B98
01/C94F: BD 40 14     LDA $1440,X
01/C952: C9 19        CMP #$19
01/C954: F0 18        BEQ $C96E
01/C956: C9 C8        CMP #$C8
01/C958: F0 14        BEQ $C96E
01/C95A: C9 EE        CMP #$EE
01/C95C: B0 10        BCS $C96E
01/C95E: DA           PHX 
01/C95F: 20 B7 84     JSR $84B7       ; select and clear bg2
01/C962: A0 73 DF     LDY #$DF73
01/C965: 20 FB 82     JSR $82FB       ; draw window and text
01/C968: FA           PLX 
01/C969: BD 40 14     LDA $1440,X
01/C96C: D0 02        BNE $C970
01/C96E: 18           CLC 
01/C96F: 60           RTS 
01/C970: 85 5D        STA $5D
01/C972: 85 43        STA $43
01/C974: BD 41 14     LDA $1441,X
01/C977: 85 5E        STA $5E
01/C979: A6 43        LDX $43
01/C97B: BF 50 A4 0F  LDA $0FA450,X
01/C97F: 30 10        BMI $C991
01/C981: 85 43        STA $43
01/C983: C2 20        REP #$20
01/C985: A5 43        LDA $43
01/C987: 0A           ASL 
01/C988: 0A           ASL 
01/C989: 65 43        ADC $43
01/C98B: 85 5A        STA $5A
01/C98D: E2 20        SEP #$20
01/C98F: 80 17        BRA $C9A8
01/C991: 0A           ASL 
01/C992: 8F 02 42 00  STA $004202
01/C996: A9 FA        LDA #$FA
01/C998: 8F 03 42 00  STA $004203
01/C99C: DA           PHX 
01/C99D: FA           PLX 
01/C99E: C2 20        REP #$20
01/C9A0: AF 16 42 00  LDA $004216
01/C9A4: 85 5A        STA $5A
01/C9A6: E2 20        SEP #$20
01/C9A8: A5 5D        LDA $5D
01/C9AA: C9 D4        CMP #$D4
01/C9AC: B0 0A        BCS $C9B8
01/C9AE: C9 D1        CMP #$D1
01/C9B0: 90 06        BCC $C9B8
01/C9B2: A9 01        LDA #$01
01/C9B4: 85 5A        STA $5A
01/C9B6: 64 5B        STZ $5B
01/C9B8: AD 7A 1B     LDA $1B7A
01/C9BB: F0 04        BEQ $C9C1
01/C9BD: AD 7C 1B     LDA $1B7C
01/C9C0: 3A           DEC 
01/C9C1: 1A           INC 
01/C9C2: C5 5E        CMP $5E
01/C9C4: 90 02        BCC $C9C8
01/C9C6: A5 5E        LDA $5E
01/C9C8: 85 60        STA $60
01/C9CA: 8D 97 1B     STA $1B97
01/C9CD: 64 61        STZ $61
01/C9CF: 64 37        STZ $37
01/C9D1: 64 38        STZ $38
01/C9D3: 64 39        STZ $39
01/C9D5: 64 3A        STZ $3A
01/C9D7: A0 96 03     LDY #$0396
01/C9DA: 20 69 83     JSR $8369       ; draw 2-digit number
01/C9DD: C2 20        REP #$20
01/C9DF: A9 00 00     LDA #$0000
01/C9E2: 18           CLC 
01/C9E3: 65 5A        ADC $5A
01/C9E5: 90 02        BCC $C9E9
01/C9E7: E6 39        INC $39
01/C9E9: C6 60        DEC $60
01/C9EB: D0 F5        BNE $C9E2
01/C9ED: 85 37        STA $37
01/C9EF: A5 39        LDA $39
01/C9F1: A6 37        LDX $37
01/C9F3: A0 14 04     LDY #$0414
01/C9F6: E2 20        SEP #$20
01/C9F8: 20 A6 8F     JSR $8FA6       ; draw number text (7 digits)
01/C9FB: 64 DB        STZ $DB
01/C9FD: A5 5D        LDA $5D
01/C9FF: A0 D4 02     LDY #$02D4
01/CA02: 20 60 90     JSR $9060
01/CA05: AD 95 1B     LDA $1B95
01/CA08: D0 06        BNE $CA10
01/CA0A: A0 1C 03     LDY #$031C
01/CA0D: 20 9C CA     JSR $CA9C
01/CA10: 64 48        STZ $48
01/CA12: 20 E3 83     JSR $83E3       ; open window
01/CA15: A9 30        LDA #$30
01/CA17: 85 3F        STA $3F
01/CA19: A9 B0        LDA #$B0
01/CA1B: 85 46        STA $46
01/CA1D: A5 48        LDA $48
01/CA1F: D0 04        BNE $CA25
01/CA21: A9 50        LDA #$50
01/CA23: 80 02        BRA $CA27
01/CA25: A9 70        LDA #$70
01/CA27: 85 45        STA $45
01/CA29: 20 81 82     JSR $8281       ; draw cursor sprite
01/CA2C: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/CA2F: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/CA32: A5 01        LDA $01
01/CA34: 29 80        AND #$80
01/CA36: F0 05        BEQ $CA3D
01/CA38: 20 1D 94     JSR $941D       ; clear bg2 screen buffer in vram
01/CA3B: 18           CLC 
01/CA3C: 60           RTS 
; A button
01/CA3D: A5 00        LDA $00
01/CA3F: 29 80        AND #$80
01/CA41: F0 49        BEQ $CA8C
01/CA43: A5 48        LDA $48
01/CA45: F0 05        BEQ $CA4C
01/CA47: 20 1D 94     JSR $941D       ; clear bg2 screen buffer in vram
01/CA4A: 18           CLC 
01/CA4B: 60           RTS 
01/CA4C: C2 20        REP #$20
01/CA4E: AD A0 16     LDA $16A0
01/CA51: 18           CLC 
01/CA52: 65 37        ADC $37
01/CA54: 8D A0 16     STA $16A0
01/CA57: E2 20        SEP #$20
01/CA59: AD A2 16     LDA $16A2
01/CA5C: 65 39        ADC $39
01/CA5E: 8D A2 16     STA $16A2
01/CA61: C9 98        CMP #$98
01/CA63: 90 10        BCC $CA75
01/CA65: A2 7F 96     LDX #$967F
01/CA68: EC A0 16     CPX $16A0
01/CA6B: B0 08        BCS $CA75
01/CA6D: 8E A0 16     STX $16A0
01/CA70: A9 98        LDA #$98
01/CA72: 8D A2 16     STA $16A2
01/CA75: AE 98 1B     LDX $1B98
01/CA78: BD 41 14     LDA $1441,X
01/CA7B: 38           SEC 
01/CA7C: ED 97 1B     SBC $1B97
01/CA7F: 9D 41 14     STA $1441,X
01/CA82: D0 03        BNE $CA87
01/CA84: 9D 40 14     STA $1440,X
01/CA87: 20 1D 94     JSR $941D       ; clear bg2 screen buffer in vram
01/CA8A: 38           SEC 
01/CA8B: 60           RTS 
; left or right button
01/CA8C: A5 01        LDA $01
01/CA8E: 29 03        AND #$03
01/CA90: F0 07        BEQ $CA99
01/CA92: A5 48        LDA $48
01/CA94: 1A           INC 
01/CA95: 29 01        AND #$01
01/CA97: 85 48        STA $48
01/CA99: 4C 19 CA     JMP $CA19

; [ copy cursor sprite data ]

01/CA9C: C2 20        REP #$20
01/CA9E: A9 0F 00     LDA #$000F
01/CAA1: A2 00 03     LDX #$0300
01/CAA4: 54 7E 7E     MVN $7E,$7E
01/CAA7: E2 20        SEP #$20
01/CAA9: 60           RTS 

; [  ]

01/CAAA: 48           PHA 
01/CAAB: AD 7A 1B     LDA $1B7A
01/CAAE: D0 04        BNE $CAB4
01/CAB0: 68           PLA 
01/CAB1: 4C A6 8F     JMP $8FA6       ; draw number text (7 digits)
01/CAB4: 68           PLA 
01/CAB5: 64 76        STZ $76
01/CAB7: 85 75        STA $75
01/CAB9: 64 7A        STZ $7A
01/CABB: 85 79        STA $79
01/CABD: 86 73        STX $73
01/CABF: 86 77        STX $77
01/CAC1: AD 7C 1B     LDA $1B7C
01/CAC4: 3A           DEC 
01/CAC5: 85 63        STA $63
01/CAC7: 64 64        STZ $64
01/CAC9: C2 20        REP #$20
01/CACB: A5 73        LDA $73
01/CACD: 18           CLC 
01/CACE: 65 77        ADC $77
01/CAD0: 85 73        STA $73
01/CAD2: A5 75        LDA $75
01/CAD4: 65 79        ADC $79
01/CAD6: 85 75        STA $75
01/CAD8: C6 63        DEC $63
01/CADA: D0 EF        BNE $CACB
01/CADC: E2 20        SEP #$20
01/CADE: A5 75        LDA $75
01/CAE0: C9 98        CMP #$98
01/CAE2: B0 05        BCS $CAE9
01/CAE4: A6 73        LDX $73
01/CAE6: 4C A6 8F     JMP $8FA6       ; draw number text (7 digits)
01/CAE9: A6 75        LDX $75
01/CAEB: E0 80 96     CPX #$9680
01/CAEE: B0 03        BCS $CAF3
01/CAF0: 4C A6 8F     JMP $8FA6       ; draw number text (7 digits)
01/CAF3: BB           TYX 
01/CAF4: A0 BA DF     LDY #$DFBA
01/CAF7: 20 98 87     JSR $8798       ; copy text to screen buffer
01/CAFA: AE 80 1A     LDX $1A80
01/CAFD: A9 01        LDA #$01
01/CAFF: 9D 78 1A     STA $1A78,X
01/CB02: 60           RTS 

; [  ]

01/CB03: 9C 7B 1B     STZ $1B7B
01/CB06: 9C 94 1B     STZ $1B94
01/CB09: 9C 96 1B     STZ $1B96
01/CB0C: 60           RTS 

; [ draw item quantity cursor ]

01/CB0D: AD 7A 1B     LDA $1B7A
01/CB10: F0 05        BEQ $CB17
01/CB12: A2 58 30     LDX #$3058
01/CB15: 80 03        BRA $CB1A
01/CB17: A2 40 30     LDX #$3040
01/CB1A: 86 45        STX $45
01/CB1C: 4C 7C 82     JMP $827C       ; draw cursor sprite

; [ update item quantity ]

; X button
01/CB1F: A5 00        LDA $00
01/CB21: 29 40        AND #$40
01/CB23: F0 17        BEQ $CB3C
01/CB25: AD 7A 1B     LDA $1B7A
01/CB28: F0 12        BEQ $CB3C
01/CB2A: AD 7C 1B     LDA $1B7C
01/CB2D: 18           CLC 
01/CB2E: 69 0A        ADC #$0A
01/CB30: C9 64        CMP #$64
01/CB32: 90 02        BCC $CB36
01/CB34: A9 0A        LDA #$0A
01/CB36: 8D 7C 1B     STA $1B7C
01/CB39: EE CB 1B     INC $1BCB
; up button
01/CB3C: A5 01        LDA $01
01/CB3E: 29 08        AND #$08
01/CB40: F0 15        BEQ $CB57
01/CB42: AD 7A 1B     LDA $1B7A
01/CB45: F0 10        BEQ $CB57
01/CB47: AD 7C 1B     LDA $1B7C
01/CB4A: 1A           INC 
01/CB4B: C9 64        CMP #$64
01/CB4D: 90 02        BCC $CB51
01/CB4F: A9 02        LDA #$02
01/CB51: 8D 7C 1B     STA $1B7C
01/CB54: EE CB 1B     INC $1BCB
; down button
01/CB57: A5 01        LDA $01
01/CB59: 29 04        AND #$04
01/CB5B: F0 15        BEQ $CB72
01/CB5D: AD 7A 1B     LDA $1B7A
01/CB60: F0 10        BEQ $CB72
01/CB62: AD 7C 1B     LDA $1B7C
01/CB65: 3A           DEC 
01/CB66: C9 02        CMP #$02
01/CB68: B0 02        BCS $CB6C
01/CB6A: A9 63        LDA #$63
01/CB6C: 8D 7C 1B     STA $1B7C
01/CB6F: EE CB 1B     INC $1BCB
; left or right button
01/CB72: A5 01        LDA $01
01/CB74: 29 03        AND #$03
01/CB76: F0 0D        BEQ $CB85
01/CB78: AD 7A 1B     LDA $1B7A
01/CB7B: 49 FF        EOR #$FF
01/CB7D: 29 01        AND #$01
01/CB7F: 8D 7A 1B     STA $1B7A
01/CB82: EE CB 1B     INC $1BCB
01/CB85: 60           RTS 

; --------------------------------------------------------------------------

; [ save menu ]

01/CB86: AD 02 1A     LDA $1A02       ; check if save is enabled
01/CB89: D0 03        BNE $CB8E
01/CB8B: 4C 58 87     JMP $8758       ; error sound effect
01/CB8E: 20 7E 94     JSR $947E       ; fade out
01/CB91: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/CB94: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/CB97: 20 A9 94     JSR $94A9
01/CB9A: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/CB9D: 7B           TDC 
01/CB9E: 20 5F CC     JSR $CC5F       ; calculate save slot checksum
01/CBA1: 8E FC 17     STX $17FC
01/CBA4: 20 38 CC     JSR $CC38
01/CBA7: 20 DE 96     JSR $96DE
01/CBAA: 20 BA 84     JSR $84BA       ; select bg2
01/CBAD: A0 14 E0     LDY #$E014
01/CBB0: 20 01 83     JSR $8301       ; draw positioned text
01/CBB3: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/CBB6: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/CBB9: A9 01        LDA #$01
01/CBBB: 8D 9A 1B     STA $1B9A
01/CBBE: 20 B8 99     JSR $99B8
01/CBC1: A9 01        LDA #$01
01/CBC3: 8D 47 1B     STA $1B47
01/CBC6: AD 3C 1A     LDA $1A3C
01/CBC9: D0 05        BNE $CBD0
01/CBCB: A9 01        LDA #$01
01/CBCD: 8D 3C 1A     STA $1A3C
01/CBD0: 20 7F 97     JSR $977F
01/CBD3: 20 A0 8D     JSR $8DA0       ; load character graphics
01/CBD6: 20 C9 98     JSR $98C9
01/CBD9: 20 59 96     JSR $9659       ; get player input (select save slot)
01/CBDC: 90 34        BCC $CC12
01/CBDE: 20 D3 97     JSR $97D3
01/CBE1: 90 4A        BCC $CC2D
01/CBE3: AD 3C 1A     LDA $1A3C
01/CBE6: 3A           DEC 
01/CBE7: 30 18        BMI $CC01
01/CBE9: 0A           ASL 
01/CBEA: 0A           ASL 
01/CBEB: 0A           ASL 
01/CBEC: 85 46        STA $46
01/CBEE: 64 45        STZ $45
01/CBF0: A4 45        LDY $45
01/CBF2: A2 00 F6     LDX #$F600
01/CBF5: 8B           PHB 
01/CBF6: C2 20        REP #$20
01/CBF8: A9 FF 07     LDA #$07FF
01/CBFB: 54 70 7E     MVN $70,$7E
01/CBFE: E2 20        SEP #$20
01/CC00: AB           PLB 
01/CC01: 20 60 87     JSR $8760       ; cure sound effect
01/CC04: 20 BA 84     JSR $84BA       ; select bg2
01/CC07: A0 50 E0     LDY #$E050
01/CC0A: 20 D9 80     JSR $80D9       ; draw window
01/CC0D: A0 2B E0     LDY #$E02B
01/CC10: 80 03        BRA $CC15
01/CC12: A0 1A E0     LDY #$E01A
01/CC15: 20 01 83     JSR $8301       ; draw positioned text
01/CC18: 20 4E CC     JSR $CC4E
01/CC1B: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/CC1E: 20 36 83     JSR $8336
01/CC21: 20 7E 94     JSR $947E       ; fade out
01/CC24: 20 49 87     JSR $8749       ; update window color
01/CC27: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/CC2A: 4C E6 87     JMP $87E6       ; init main menu
01/CC2D: A0 50 E0     LDY #$E050
01/CC30: 20 D9 80     JSR $80D9       ; draw window
01/CC33: A0 48 E0     LDY #$E048
01/CC36: 80 DD        BRA $CC15
01/CC38: A9 01        LDA #$01
01/CC3A: 8D FB 17     STA $17FB
01/CC3D: C2 20        REP #$20
01/CC3F: A9 FF 07     LDA #$07FF
01/CC42: A2 00 10     LDX #$1000
01/CC45: A0 00 F6     LDY #$F600
01/CC48: 54 7E 7E     MVN $7E,$7E
01/CC4B: E2 20        SEP #$20
01/CC4D: 60           RTS 
01/CC4E: C2 20        REP #$20
01/CC50: A9 FF 07     LDA #$07FF
01/CC53: A2 00 F6     LDX #$F600
01/CC56: A0 00 10     LDY #$1000
01/CC59: 54 7E 7E     MVN $7E,$7E
01/CC5C: E2 20        SEP #$20
01/CC5E: 60           RTS 

; [ calculate save slot checksum ]

01/CC5F: 85 4E        STA $4E
01/CC61: 0A           ASL 
01/CC62: 65 4E        ADC $4E
01/CC64: 20 B4 87     JSR $87B4       ; tax
01/CC67: BF 86 CC 01  LDA $01CC86,X
01/CC6B: 85 4E        STA $4E
01/CC6D: C2 20        REP #$20
01/CC6F: BF 87 CC 01  LDA $01CC87,X
01/CC73: 85 4F        STA $4F
01/CC75: A5 41        LDA $41         ; zero
01/CC77: A0 FA 07     LDY #$07FA
01/CC7A: 18           CLC 
01/CC7B: 67 4E        ADC [$4E]
01/CC7D: E6 4E        INC $4E
01/CC7F: 88           DEY 
01/CC80: D0 F9        BNE $CC7B
01/CC82: AA           TAX 
01/CC83: E2 20        SEP #$20
01/CC85: 60           RTS 

; pointers to save slot data (5 * 3 bytes)
01/CC86: 7E1000  ; 0: ram
01/CC89: 700000  ; 1: slot 1
01/CC8C: 700800  ; 2: slot 2
01/CC8F: 701000  ; 3: slot 3
01/CC92: 701800  ; 4: slot 4

; --------------------------------------------------------------------------

; [ fat chocobo menu (from field) ]

01/CC95: 08           PHP 
01/CC96: 8B           PHB 
01/CC97: 0B           PHD 
01/CC98: A2 00 01     LDX #$0100
01/CC9B: DA           PHX 
01/CC9C: 2B           PLD 
01/CC9D: A9 7E        LDA #$7E
01/CC9F: 48           PHA 
01/CCA0: AB           PLB 
01/CCA1: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/CCA4: 9C 88 1A     STZ $1A88
01/CCA7: 20 FE CC     JSR $CCFE
01/CCAA: 7B           TDC 
01/CCAB: EB           XBA 
01/CCAC: 20 3F 87     JSR $873F       ; restore dialogue window graphics
01/CCAF: 2B           PLD 
01/CCB0: AB           PLB 
01/CCB1: 28           PLP 
01/CCB2: 60           RTS 

; [ fat chocobo menu (whistle) ]

01/CCB3: AD 05 1E     LDA $1E05       ; save current song id
01/CCB6: 48           PHA 
01/CCB7: 9C 19 1B     STZ $1B19
01/CCBA: A9 01        LDA #$01
01/CCBC: 8D 88 1A     STA $1A88
01/CCBF: A6 93        LDX $93
01/CCC1: 8E A5 1B     STX $1BA5
01/CCC4: A9 85        LDA #$85        ; fade out music (slow)
01/CCC6: 8D 00 1E     STA $1E00
01/CCC9: 22 04 80 04  JSL $048004     ; execute sound command
01/CCCD: 20 7E 94     JSR $947E       ; fade out
01/CCD0: A9 4C        LDA #$4C
01/CCD2: 20 62 87     JSR $8762       ; play sound effect
01/CCD5: A9 F0        LDA #$F0
01/CCD7: 20 8A 81     JSR $818A       ; wait for vblank
01/CCDA: 3A           DEC 
01/CCDB: D0 FA        BNE $CCD7
01/CCDD: A9 30        LDA #$30
01/CCDF: 20 F1 CC     JSR $CCF1       ; play song
01/CCE2: 20 FE CC     JSR $CCFE
01/CCE5: 68           PLA 
01/CCE6: 20 F1 CC     JSR $CCF1
01/CCE9: A9 00        LDA #$00
01/CCEB: EB           XBA 
01/CCEC: AE 65 1A     LDX $1A65
01/CCEF: 9A           TXS 
01/CCF0: 60           RTS 

; [ play song ]

01/CCF1: 8D 01 1E     STA $1E01
01/CCF4: A9 01        LDA #$01
01/CCF6: 8D 00 1E     STA $1E00
01/CCF9: 22 04 80 04  JSL $048004     ; execute sound command
01/CCFD: 60           RTS 

; [ fat chocobo menu ]

01/CCFE: 20 7D 8C     JSR $8C7D       ; init menu
01/CD01: 20 A0 8D     JSR $8DA0       ; load character graphics
01/CD04: A9 01        LDA #$01
01/CD06: 8D 73 1A     STA $1A73
01/CD09: C2 20        REP #$20
01/CD0B: AF 04 02 00  LDA $000204     ; save irq jump code
01/CD0F: 48           PHA 
01/CD10: AF 06 02 00  LDA $000206
01/CD14: 48           PHA 
01/CD15: E2 20        SEP #$20
01/CD17: 78           SEI 
01/CD18: A9 2C        LDA #$2C        ; irq: 01/CE2C
01/CD1A: 8F 05 02 00  STA $000205
01/CD1E: A9 CE        LDA #$CE
01/CD20: 8F 06 02 00  STA $000206
01/CD24: A9 01        LDA #$01
01/CD26: 8F 07 02 00  STA $000207
01/CD2A: A9 21        LDA #$21
01/CD2C: 8F 00 42 00  STA $004200     ; enable irq
01/CD30: AF 11 42 00  LDA $004211
01/CD34: 58           CLI 
01/CD35: EE 49 1B     INC $1B49
01/CD38: 20 2D 8D     JSR $8D2D       ; clear screen buffer
01/CD3B: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/CD3E: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/CD41: 20 69 CD     JSR $CD69
01/CD44: 20 82 D0     JSR $D082       ; load fat chocobo graphics
01/CD47: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/CD4A: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/CD4D: 20 64 94     JSR $9464       ; fade in
01/CD50: 20 86 CD     JSR $CD86
01/CD53: 9C 49 1B     STZ $1B49
01/CD56: 20 7E 94     JSR $947E       ; fade out
01/CD59: 78           SEI 
01/CD5A: C2 20        REP #$20
01/CD5C: 68           PLA 
01/CD5D: 8F 06 02 00  STA $000206
01/CD61: 68           PLA 
01/CD62: 8F 04 02 00  STA $000204
01/CD66: E2 20        SEP #$20
01/CD68: 60           RTS 

; [  ]

01/CD69: A2 C0 48     LDX #$48C0
01/CD6C: 8E 71 1A     STX $1A71
01/CD6F: 20 B3 98     JSR $98B3
01/CD72: 20 CE 91     JSR $91CE
01/CD75: 64 E0        STZ $E0
01/CD77: 20 70 84     JSR $8470       ; select bg3
01/CD7A: A0 D4 E0     LDY #$E0D4
01/CD7D: 20 D9 80     JSR $80D9       ; draw window
01/CD80: A0 DC E0     LDY #$E0DC
01/CD83: 4C FB 82     JMP $82FB       ; draw window and text

; [  ]

01/CD86: 20 D9 D0     JSR $D0D9       ; load fat chocobo sprite data
01/CD89: 20 70 84     JSR $8470       ; select bg3
01/CD8C: AD 88 1A     LDA $1A88
01/CD8F: F0 0A        BEQ $CD9B
01/CD91: AD 02 1A     LDA $1A02
01/CD94: D0 05        BNE $CD9B
01/CD96: A0 07 E1     LDY #$E107
01/CD99: 80 03        BRA $CD9E
01/CD9B: A0 F6 E0     LDY #$E0F6
01/CD9E: 20 01 83     JSR $8301       ; draw positioned text
01/CDA1: 9C 88 1A     STZ $1A88
01/CDA4: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/CDA7: A9 17        LDA #$17
01/CDA9: 8F 2C 21 00  STA $00212C
01/CDAD: 58           CLI 
01/CDAE: AD AF 1B     LDA $1BAF
01/CDB1: F0 05        BEQ $CDB8
01/CDB3: A2 40 40     LDX #$4040
01/CDB6: 80 03        BRA $CDBB
01/CDB8: A2 10 40     LDX #$4010
01/CDBB: A0 10 03     LDY #$0310
01/CDBE: 20 86 82     JSR $8286
01/CDC1: 20 2E D1     JSR $D12E
01/CDC4: A2 88 31     LDX #$3188
01/CDC7: 20 62 93     JSR $9362
01/CDCA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/CDCD: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/CDD0: A5 01        LDA $01
01/CDD2: 29 03        AND #$03
01/CDD4: F0 09        BEQ $CDDF
01/CDD6: AD AF 1B     LDA $1BAF
01/CDD9: 1A           INC 
01/CDDA: 29 01        AND #$01
01/CDDC: 8D AF 1B     STA $1BAF
01/CDDF: A5 01        LDA $01
01/CDE1: 29 80        AND #$80
01/CDE3: F0 01        BEQ $CDE6
01/CDE5: 60           RTS 
01/CDE6: A5 00        LDA $00
01/CDE8: 29 80        AND #$80
01/CDEA: F0 39        BEQ $CE25
01/CDEC: 9C B2 1B     STZ $1BB2
01/CDEF: 9C B0 1B     STZ $1BB0
01/CDF2: 9C B1 1B     STZ $1BB1
01/CDF5: A2 40 13     LDX #$1340
01/CDF8: 20 2A AE     JSR $AE2A       ; sort items
01/CDFB: A2 00 ED     LDX #$ED00      ; items $00-$ED valid (all but key items)
01/CDFE: 8E 1D 1B     STX $1B1D
01/CE01: A2 28 CE     LDX #$CE28
01/CE04: AD AF 1B     LDA $1BAF
01/CE07: 20 4B 83     JSR $834B       ; do jump table
01/CE0A: 20 40 8D     JSR $8D40       ; clear bg4 screen buffer
01/CE0D: 20 45 8D     JSR $8D45       ; clear bg3 screen buffer
01/CE10: 20 69 CD     JSR $CD69
01/CE13: 20 F2 A2     JSR $A2F2
01/CE16: 20 DC A2     JSR $A2DC
01/CE19: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/CE1C: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/CE1F: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/CE22: 4C 89 CD     JMP $CD89
01/CE25: 4C AE CD     JMP $CDAE

; fat chocobo jump table
01/CE28: CE81 D060

; [ fat chocobo irq ]

01/CE2C: 08           PHP 
01/CE2D: C2 20        REP #$20
01/CE2F: 48           PHA 
01/CE30: E2 20        SEP #$20
01/CE32: 8B           PHB 
01/CE33: A9 00        LDA #$00
01/CE35: 48           PHA 
01/CE36: AB           PLB 
01/CE37: AD 11 42     LDA $4211
01/CE3A: A9 0F        LDA #$0F
01/CE3C: 3A           DEC 
01/CE3D: D0 FD        BNE $CE3C
01/CE3F: AD E0 01     LDA $01E0
01/CE42: F0 14        BEQ $CE58
01/CE44: A9 58        LDA #$58        ; scanline 88
01/CE46: 8D 09 42     STA $4209
01/CE49: A9 00        LDA #$00
01/CE4B: 8D 0A 42     STA $420A
01/CE4E: 9C E0 01     STZ $01E0
01/CE51: A9 17        LDA #$17        ; disable bg4
01/CE53: 8D 2C 21     STA $212C
01/CE56: 80 23        BRA $CE7B
01/CE58: A9 1F        LDA #$1F        ; enable bg4
01/CE5A: 8D 2C 21     STA $212C
01/CE5D: EE E0 01     INC $01E0
01/CE60: A9 CB        LDA #$CB        ; scanline 203
01/CE62: 8D 09 42     STA $4209
01/CE65: A9 00        LDA #$00
01/CE67: 8D 0A 42     STA $420A
01/CE6A: AD 9A 01     LDA $019A
01/CE6D: EB           XBA 
01/CE6E: AD 99 01     LDA $0199
01/CE71: 8D 14 21     STA $2114       ; bg4 v-scroll
01/CE74: 8D 14 21     STA $2114
01/CE77: EB           XBA 
01/CE78: 8D 14 21     STA $2114
01/CE7B: AB           PLB 
01/CE7C: C2 20        REP #$20
01/CE7E: 68           PLA 
01/CE7F: 28           PLP 
01/CE80: 40           RTI 

; [ give item to fat chocobo ]

01/CE81: 20 70 84     JSR $8470       ; select bg3
01/CE84: A0 18 E1     LDY #$E118
01/CE87: 20 01 83     JSR $8301       ; draw positioned text
01/CE8A: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/CE8D: 20 85 84     JSR $8485       ; select and clear bg4
01/CE90: 20 72 A1     JSR $A172
01/CE93: A9 11        LDA #$11
01/CE95: 85 E2        STA $E2
01/CE97: A2 B0 FF     LDX #$FFB0
01/CE9A: 86 99        STX $99
; common code for give and take
01/CE9C: 20 70 84     JSR $8470       ; select bg3
01/CE9F: A0 D8 E0     LDY #$E0D8
01/CEA2: 20 D9 80     JSR $80D9       ; draw window
01/CEA5: 20 3A 94     JSR $943A       ; transfer bg4 screen buffer to vram
01/CEA8: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
; start of frame loop
01/CEAB: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/CEAE: 20 7F CF     JSR $CF7F
01/CEB1: 20 EA D0     JSR $D0EA
01/CEB4: A2 88 31     LDX #$3188
01/CEB7: 20 62 93     JSR $9362
01/CEBA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/CEBD: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
; B button
01/CEC0: A5 01        LDA $01
01/CEC2: 29 80        AND #$80
01/CEC4: F0 08        BEQ $CECE
01/CEC6: A2 40 13     LDX #$1340
01/CEC9: 20 2A AE     JSR $AE2A       ; sort items
01/CECC: 18           CLC 
01/CECD: 60           RTS 
; A button
01/CECE: A5 00        LDA $00
01/CED0: 29 80        AND #$80
01/CED2: F0 0E        BEQ $CEE2
01/CED4: A5 E2        LDA $E2
01/CED6: C9 11        CMP #$11
01/CED8: F0 05        BEQ $CEDF
01/CEDA: 20 1A D0     JSR $D01A
01/CEDD: 80 03        BRA $CEE2
01/CEDF: 20 B7 CF     JSR $CFB7
; right button
01/CEE2: A5 01        LDA $01
01/CEE4: 29 01        AND #$01
01/CEE6: F0 0D        BEQ $CEF5
01/CEE8: AD B1 1B     LDA $1BB1
01/CEEB: F0 05        BEQ $CEF2
01/CEED: 9C B1 1B     STZ $1BB1
01/CEF0: 80 54        BRA $CF46
01/CEF2: EE B1 1B     INC $1BB1
; left button
01/CEF5: A5 01        LDA $01
01/CEF7: 29 02        AND #$02
01/CEF9: F0 0D        BEQ $CF08
01/CEFB: AD B1 1B     LDA $1BB1
01/CEFE: D0 05        BNE $CF05
01/CF00: EE B1 1B     INC $1BB1
01/CF03: 80 09        BRA $CF0E
01/CF05: 9C B1 1B     STZ $1BB1
; up button
01/CF08: A5 01        LDA $01
01/CF0A: 29 08        AND #$08
01/CF0C: F0 32        BEQ $CF40
01/CF0E: AD B0 1B     LDA $1BB0
01/CF11: D0 2A        BNE $CF3D
01/CF13: AD B2 1B     LDA $1BB2
01/CF16: F0 28        BEQ $CF40
01/CF18: CE B2 1B     DEC $1BB2
01/CF1B: A9 08        LDA #$08
01/CF1D: C2 20        REP #$20
01/CF1F: C6 99        DEC $99
01/CF21: C6 99        DEC $99
01/CF23: E2 20        SEP #$20
01/CF25: 48           PHA 
01/CF26: 20 7F CF     JSR $CF7F
01/CF29: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/CF2C: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/CF2F: 68           PLA 
01/CF30: 3A           DEC 
01/CF31: D0 EA        BNE $CF1D
01/CF33: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/CF36: A6 02        LDX $02
01/CF38: 86 00        STX $00
01/CF3A: 4C C0 CE     JMP $CEC0
01/CF3D: CE B0 1B     DEC $1BB0
; down button
01/CF40: A5 01        LDA $01
01/CF42: 29 04        AND #$04
01/CF44: F0 36        BEQ $CF7C
01/CF46: AD B0 1B     LDA $1BB0
01/CF49: C9 06        CMP #$06
01/CF4B: D0 2C        BNE $CF79
01/CF4D: AD B2 1B     LDA $1BB2
01/CF50: C5 E2        CMP $E2
01/CF52: F0 28        BEQ $CF7C
01/CF54: EE B2 1B     INC $1BB2
01/CF57: A9 08        LDA #$08
01/CF59: C2 20        REP #$20
01/CF5B: E6 99        INC $99
01/CF5D: E6 99        INC $99
01/CF5F: E2 20        SEP #$20
01/CF61: 48           PHA 
01/CF62: 20 7F CF     JSR $CF7F
01/CF65: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/CF68: 20 3D 94     JSR $943D       ; transfer bg4 screen buffer to vram
01/CF6B: 68           PLA 
01/CF6C: 3A           DEC 
01/CF6D: D0 EA        BNE $CF59
01/CF6F: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/CF72: A6 02        LDX $02
01/CF74: 86 00        STX $00
01/CF76: 4C C0 CE     JMP $CEC0
01/CF79: EE B0 1B     INC $1BB0
01/CF7C: 4C AB CE     JMP $CEAB

; [  ]

01/CF7F: AD B0 1B     LDA $1BB0
01/CF82: 0A           ASL 
01/CF83: 0A           ASL 
01/CF84: 0A           ASL 
01/CF85: 0A           ASL 
01/CF86: 18           CLC 
01/CF87: 69 5F        ADC #$5F
01/CF89: 85 5B        STA $5B
01/CF8B: AD B1 1B     LDA $1BB1
01/CF8E: F0 04        BEQ $CF94
01/CF90: A9 78        LDA #$78
01/CF92: 80 02        BRA $CF96
01/CF94: A9 08        LDA #$08
01/CF96: 85 5A        STA $5A
01/CF98: A6 5A        LDX $5A
01/CF9A: A0 00 03     LDY #$0300
01/CF9D: 7B           TDC 
01/CF9E: 20 86 82     JSR $8286
01/CFA1: 22 41 FC 1E  JSL $1EFC41
01/CFA5: 60           RTS 

; [  ]

01/CFA6: AD B2 1B     LDA $1BB2
01/CFA9: 18           CLC 
01/CFAA: 6D B0 1B     ADC $1BB0
01/CFAD: 0A           ASL 
01/CFAE: 6D B1 1B     ADC $1BB1
01/CFB1: 0A           ASL 
01/CFB2: 85 43        STA $43
01/CFB4: A6 43        LDX $43
01/CFB6: 60           RTS 

; [  ]

01/CFB7: 20 A6 CF     JSR $CFA6
01/CFBA: BD 40 14     LDA $1440,X
01/CFBD: F0 0C        BEQ $CFCB
01/CFBF: C9 19        CMP #$19
01/CFC1: F0 08        BEQ $CFCB
01/CFC3: C9 C8        CMP #$C8
01/CFC5: F0 04        BEQ $CFCB
01/CFC7: C9 EE        CMP #$EE
01/CFC9: 90 02        BCC $CFCD
01/CFCB: 80 2D        BRA $CFFA
01/CFCD: A9 7E        LDA #$7E
01/CFCF: 85 45        STA $45
01/CFD1: A4 41        LDY $41         ; zero
01/CFD3: B9 40 13     LDA $1340,Y
01/CFD6: F0 23        BEQ $CFFB
01/CFD8: DD 40 14     CMP $1440,X
01/CFDB: D0 0B        BNE $CFE8
01/CFDD: B9 41 13     LDA $1341,Y
01/CFE0: 18           CLC 
01/CFE1: 7D 41 14     ADC $1441,X
01/CFE4: C9 64        CMP #$64
01/CFE6: 90 13        BCC $CFFB
01/CFE8: C8           INY 
01/CFE9: C8           INY 
01/CFEA: C6 45        DEC $45
01/CFEC: D0 E5        BNE $CFD3
01/CFEE: 20 70 84     JSR $8470       ; select bg3
01/CFF1: A0 3A E1     LDY #$E13A
01/CFF4: 20 01 83     JSR $8301       ; draw positioned text
01/CFF7: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/CFFA: 60           RTS 
01/CFFB: BD 40 14     LDA $1440,X
01/CFFE: 99 40 13     STA $1340,Y
01/D001: BD 41 14     LDA $1441,X
01/D004: 18           CLC 
01/D005: 79 41 13     ADC $1341,Y
01/D008: 99 41 13     STA $1341,Y
01/D00B: 9E 40 14     STZ $1440,X
01/D00E: 9E 41 14     STZ $1441,X
01/D011: 20 85 84     JSR $8485       ; select and clear bg4
01/D014: 20 72 A1     JSR $A172
01/D017: 4C 3A 94     JMP $943A       ; transfer bg4 screen buffer to vram

; [  ]

01/D01A: 20 A6 CF     JSR $CFA6
01/D01D: BD 40 13     LDA $1340,X
01/D020: F0 D8        BEQ $CFFA
01/D022: A9 30        LDA #$30
01/D024: 85 45        STA $45
01/D026: A4 41        LDY $41         ; zero
01/D028: B9 40 14     LDA $1440,Y
01/D02B: F0 12        BEQ $D03F
01/D02D: C8           INY 
01/D02E: C8           INY 
01/D02F: C6 45        DEC $45
01/D031: D0 F5        BNE $D028
01/D033: 20 70 84     JSR $8470       ; select bg3
01/D036: A0 4B E1     LDY #$E14B
01/D039: 20 01 83     JSR $8301       ; draw positioned text
01/D03C: 4C 47 94     JMP $9447       ; transfer bg3 screen buffer to vram
01/D03F: C2 20        REP #$20
01/D041: BD 40 13     LDA $1340,X
01/D044: 99 40 14     STA $1440,Y
01/D047: 9E 40 13     STZ $1340,X
01/D04A: E2 20        SEP #$20
01/D04C: 20 52 D0     JSR $D052
01/D04F: 4C 3A 94     JMP $943A       ; transfer bg4 screen buffer to vram

; [  ]

01/D052: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/D055: 20 B7 84     JSR $84B7       ; select and clear bg2
01/D058: 20 67 A1     JSR $A167
01/D05B: 22 28 FC 1E  JSL $1EFC28
01/D05F: 60           RTS 

; [ take item from fat chocobo ]

01/D060: A2 A8 FF     LDX #$FFA8
01/D063: 86 99        STX $99
01/D065: EE CC 1B     INC $1BCC
01/D068: 20 70 84     JSR $8470       ; select bg3
01/D06B: A0 29 E1     LDY #$E129
01/D06E: 20 01 83     JSR $8301       ; draw positioned text
01/D071: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/D074: A9 38        LDA #$38
01/D076: 85 E2        STA $E2
01/D078: 20 52 D0     JSR $D052
01/D07B: 20 9C CE     JSR $CE9C
01/D07E: 9C CC 1B     STZ $1BCC
01/D081: 60           RTS 

; [ load fat chocobo graphics ]

01/D082: C2 20        REP #$20
01/D084: A9 0F 00     LDA #$000F
01/D087: A2 10 81     LDX #$8110      ; 0D/8110 (fat chocobo palette)
01/D08A: A0 20 A1     LDY #$A120
01/D08D: 54 7E 0D     MVN $7E,$0D
01/D090: E2 20        SEP #$20
01/D092: A0 00 F2     LDY #$F200      ; 1B/F200 (fat chocobo graphics)
01/D095: 8B           PHB 
01/D096: 0B           PHD 
01/D097: A9 1B        LDA #$1B
01/D099: 48           PHA 
01/D09A: AB           PLB 
01/D09B: A2 00 21     LDX #$2100
01/D09E: DA           PHX 
01/D09F: 2B           PLD 
01/D0A0: A9 80        LDA #$80
01/D0A2: 85 15        STA $15
01/D0A4: A2 00 46     LDX #$4600
01/D0A7: 86 16        STX $16
01/D0A9: A9 10        LDA #$10
01/D0AB: 8D 45 01     STA $0145
01/D0AE: A2 08 00     LDX #$0008
01/D0B1: B9 00 00     LDA $0000,Y
01/D0B4: 85 18        STA $18
01/D0B6: B9 01 00     LDA $0001,Y
01/D0B9: 85 19        STA $19
01/D0BB: C8           INY 
01/D0BC: C8           INY 
01/D0BD: CA           DEX 
01/D0BE: D0 F1        BNE $D0B1
01/D0C0: A2 08 00     LDX #$0008
01/D0C3: B9 00 00     LDA $0000,Y
01/D0C6: 85 18        STA $18
01/D0C8: 64 19        STZ $19
01/D0CA: C8           INY 
01/D0CB: CA           DEX 
01/D0CC: D0 F5        BNE $D0C3
01/D0CE: CE 45 01     DEC $0145
01/D0D1: D0 DB        BNE $D0AE
01/D0D3: 20 D9 D0     JSR $D0D9       ; load fat chocobo sprite data
01/D0D6: 2B           PLD 
01/D0D7: AB           PLB 
01/D0D8: 60           RTS 

; [ load fat chocobo sprite data ]

01/D0D9: C2 20        REP #$20
01/D0DB: A9 3F 00     LDA #$003F
01/D0DE: A2 7D FC     LDX #$FC7D      ; 1E/FC7D
01/D0E1: A0 80 04     LDY #$0480
01/D0E4: 54 7E 1E     MVN $7E,$1E
01/D0E7: E2 20        SEP #$20
01/D0E9: 60           RTS 

; [  ]

01/D0EA: 20 2E D1     JSR $D12E
01/D0ED: 20 A6 CF     JSR $CFA6
01/D0F0: AD AF 1B     LDA $1BAF
01/D0F3: F0 05        BEQ $D0FA
01/D0F5: BD 40 13     LDA $1340,X
01/D0F8: 80 03        BRA $D0FD
01/D0FA: BD 40 14     LDA $1440,X
01/D0FD: D0 01        BNE $D100
01/D0FF: 60           RTS 
01/D100: C9 CE        CMP #$CE
01/D102: B0 FB        BCS $D0FF
01/D104: 8D 39 1B     STA $1B39
01/D107: 7B           TDC 
01/D108: 20 11 D1     JSR $D111
01/D10B: 1A           INC 
01/D10C: C9 05        CMP #$05
01/D10E: D0 F8        BNE $D108
01/D110: 60           RTS 

; [  ]

01/D111: 48           PHA 
01/D112: 85 57        STA $57
01/D114: 20 19 A9     JSR $A919       ; get character id
01/D117: F0 13        BEQ $D12C
01/D119: 86 E5        STX $E5
01/D11B: 20 75 C2     JSR $C275       ; check item equipability
01/D11E: 90 0C        BCC $D12C
01/D120: A5 57        LDA $57
01/D122: 0A           ASL 
01/D123: 85 43        STA $43
01/D125: A6 43        LDX $43
01/D127: A9 08        LDA #$08
01/D129: 9D 4B 1B     STA $1B4B,X
01/D12C: 68           PLA 
01/D12D: 60           RTS 

; [  ]

01/D12E: C2 20        REP #$20
01/D130: 9C 4B 1B     STZ $1B4B
01/D133: 9C 4D 1B     STZ $1B4D
01/D136: 9C 4F 1B     STZ $1B4F
01/D139: 9C 51 1B     STZ $1B51
01/D13C: 9C 53 1B     STZ $1B53
01/D13F: E2 20        SEP #$20
01/D141: 60           RTS 

; --------------------------------------------------------------------------

; [ config menu ]

01/D142: A9 30        LDA #$30
01/D144: 85 3F        STA $3F
01/D146: 20 A9 94     JSR $94A9
01/D149: A2 FC FF     LDX #$FFFC
01/D14C: 86 8D        STX $8D
01/D14E: 86 8A        STX $8A
01/D150: 20 A4 94     JSR $94A4
01/D153: 20 7E 94     JSR $947E       ; fade out
01/D156: A9 13        LDA #$13
01/D158: 8F 2C 21 00  STA $00212C
01/D15C: A2 40 40     LDX #$4040
01/D15F: 86 1D        STX $1D
01/D161: A2 89 FE     LDX #$FE89      ; 1E/FE89
01/D164: 86 1F        STX $1F
01/D166: A9 1E        LDA #$1E
01/D168: 8D 21 01     STA $0121
01/D16B: A2 20 00     LDX #$0020
01/D16E: 8E 22 01     STX $0122
01/D171: 20 78 80     JSR $8078       ; transfer data to vram
01/D174: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/D177: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/D17A: 20 BB 82     JSR $82BB       ; init controller
01/D17D: 20 A1 D1     JSR $D1A1
01/D180: 20 7E 94     JSR $947E       ; fade out
01/D183: A9 1F        LDA #$1F
01/D185: 8F 2C 21 00  STA $00212C
01/D189: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/D18C: 20 3B 8D     JSR $8D3B       ; clear bg1 screen buffer
01/D18F: 20 23 94     JSR $9423       ; transfer bg2 screen buffer to vram
01/D192: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/D195: 20 FD 88     JSR $88FD
01/D198: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/D19B: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/D19E: 4C 64 94     JMP $9464       ; fade in
01/D1A1: 20 A2 84     JSR $84A2       ; select bg1
01/D1A4: A0 68 E1     LDY #$E168
01/D1A7: 20 FB 82     JSR $82FB       ; draw window and text
01/D1AA: A0 5C E1     LDY #$E15C
01/D1AD: 20 D9 80     JSR $80D9       ; draw window
01/D1B0: A0 60 E1     LDY #$E160
01/D1B3: 20 01 83     JSR $8301       ; draw positioned text
01/D1B6: A9 53        LDA #$53
01/D1B8: 8D 1E BB     STA $BB1E
01/D1BB: A9 48        LDA #$48
01/D1BD: 8D 9E BB     STA $BB9E
01/D1C0: A9 43        LDA #$43
01/D1C2: 8D 1E BC     STA $BC1E
01/D1C5: A2 9E 02     LDX #$029E
01/D1C8: A0 CD E2     LDY #$E2CD
01/D1CB: 20 98 87     JSR $8798       ; copy text to screen buffer
01/D1CE: A2 1E 02     LDX #$021E
01/D1D1: A0 CD E2     LDY #$E2CD
01/D1D4: 20 98 87     JSR $8798       ; copy text to screen buffer
01/D1D7: 20 79 D7     JSR $D779       ; change battle speed numerals to gray
01/D1DA: A0 22 BB     LDY #$BB22      ; bg1 (17,20)
01/D1DD: 20 06 D4     JSR $D406       ; draw color slider tick marks
01/D1E0: A0 A2 BB     LDY #$BBA2
01/D1E3: 20 06 D4     JSR $D406       ; draw color slider tick marks
01/D1E6: A0 22 BC     LDY #$BC22
01/D1E9: 20 06 D4     JSR $D406       ; draw color slider tick marks
01/D1EC: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/D1EF: AE AA 16     LDX $16AA
01/D1F2: 20 4A D4     JSR $D44A       ; get components from window color
01/D1F5: 20 64 94     JSR $9464       ; fade in
; start of frame loop
01/D1F8: AD B8 16     LDA $16B8       ; controller setting
01/D1FB: 20 1D D6     JSR $D61D       ; get toggle cursor x position
01/D1FE: 8D 04 03     STA $0304
01/D201: A9 80        LDA #$80
01/D203: 8D 05 03     STA $0305
01/D206: AD BE 16     LDA $16BE       ; battle mode
01/D209: 20 1D D6     JSR $D61D       ; get toggle cursor x position
01/D20C: 85 45        STA $45
01/D20E: A9 30        LDA #$30
01/D210: 85 46        STA $46
01/D212: 20 81 82     JSR $8281       ; draw cursor sprite
01/D215: 20 79 D7     JSR $D779       ; change battle speed numerals to gray
01/D218: AD AC 16     LDA $16AC
01/D21B: 0A           ASL 
01/D21C: 0A           ASL 
01/D21D: 20 B4 87     JSR $87B4       ; tax
01/D220: A9 00        LDA #$00
01/D222: 9D 1F B8     STA $B81F,X
01/D225: AD AD 16     LDA $16AD
01/D228: 0A           ASL 
01/D229: 0A           ASL 
01/D22A: 20 B4 87     JSR $87B4       ; tax
01/D22D: A9 00        LDA #$00
01/D22F: 9D 9F B8     STA $B89F,X
01/D232: AD A7 1B     LDA $1BA7
01/D235: 48           PHA 
01/D236: 0A           ASL 
01/D237: 0A           ASL 
01/D238: 0A           ASL 
01/D239: 0A           ASL 
01/D23A: 69 30        ADC #$30
01/D23C: 85 46        STA $46
01/D23E: 68           PLA 
01/D23F: C9 07        CMP #$07
01/D241: 90 04        BCC $D247
01/D243: A9 68        LDA #$68
01/D245: 80 02        BRA $D249
01/D247: A9 18        LDA #$18
01/D249: 85 45        STA $45
01/D24B: 20 7C 82     JSR $827C       ; draw cursor sprite
01/D24E: AD A8 1B     LDA $1BA8
01/D251: 0A           ASL 
01/D252: 69 86        ADC #$86
01/D254: 8D 20 03     STA $0320
01/D257: A9 A0        LDA #$A0
01/D259: 8D 21 03     STA $0321
01/D25C: AD A9 1B     LDA $1BA9
01/D25F: 0A           ASL 
01/D260: 69 86        ADC #$86
01/D262: 8D 24 03     STA $0324
01/D265: A9 B0        LDA #$B0
01/D267: 8D 25 03     STA $0325
01/D26A: AD AA 1B     LDA $1BAA
01/D26D: 0A           ASL 
01/D26E: 69 86        ADC #$86
01/D270: 8D 28 03     STA $0328
01/D273: A9 C0        LDA #$C0
01/D275: 8D 29 03     STA $0329
01/D278: 20 27 D4     JSR $D427       ; get window color from components
01/D27B: A6 45        LDX $45
01/D27D: 8E AA 16     STX $16AA
01/D280: 20 49 87     JSR $8749       ; update window color
01/D283: A9 04        LDA #$04
01/D285: 8D 22 03     STA $0322
01/D288: 8D 26 03     STA $0326
01/D28B: 8D 2A 03     STA $032A
01/D28E: A9 30        LDA #$30
01/D290: 8D 23 03     STA $0323
01/D293: 8D 27 03     STA $0327
01/D296: 8D 2B 03     STA $032B
01/D299: AD B6 16     LDA $16B6
01/D29C: 20 1D D6     JSR $D61D       ; get toggle cursor x position
01/D29F: 8D 0C 03     STA $030C
01/D2A2: A9 60        LDA #$60
01/D2A4: 8D 0D 03     STA $030D
01/D2A7: AD A9 16     LDA $16A9
01/D2AA: 20 1D D6     JSR $D61D       ; get toggle cursor x position
01/D2AD: 8D 08 03     STA $0308
01/D2B0: A9 70        LDA #$70
01/D2B2: 8D 09 03     STA $0309
01/D2B5: AD B7 16     LDA $16B7
01/D2B8: 20 1D D6     JSR $D61D       ; get toggle cursor x position
01/D2BB: 8D 14 03     STA $0314
01/D2BE: A9 90        LDA #$90
01/D2C0: 8D 15 03     STA $0315
01/D2C3: A2 0A 30     LDX #$300A
01/D2C6: 8E 06 03     STX $0306
01/D2C9: 8E 0A 03     STX $030A
01/D2CC: 8E 0E 03     STX $030E
01/D2CF: 8E 16 03     STX $0316
01/D2D2: 8E 1A 03     STX $031A
01/D2D5: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D2D8: 20 30 94     JSR $9430       ; transfer bg1 screen buffer to vram
01/D2DB: 20 B2 80     JSR $80B2       ; transfer palettes to ppu
01/D2DE: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/D2E1: A5 01        LDA $01
01/D2E3: 29 80        AND #$80
01/D2E5: F0 01        BEQ $D2E8
01/D2E7: 60           RTS 
; A button
01/D2E8: A5 00        LDA $00
01/D2EA: 29 80        AND #$80
01/D2EC: F0 1E        BEQ $D30C
01/D2EE: AD A7 1B     LDA $1BA7
01/D2F1: C9 04        CMP #$04
01/D2F3: D0 08        BNE $D2FD
01/D2F5: AD A9 16     LDA $16A9
01/D2F8: F0 23        BEQ $D31D
01/D2FA: 20 7E D4     JSR $D47E       ; button mapping menu
01/D2FD: C9 05        CMP #$05
01/D2FF: D0 0B        BNE $D30C
01/D301: AD B8 16     LDA $16B8
01/D304: F0 06        BEQ $D30C
01/D306: 20 56 D6     JSR $D656       ; multi-controller menu
01/D309: 20 6A 8D     JSR $8D6A       ; clear sprite data
; up button
01/D30C: A5 01        LDA $01
01/D30E: 29 08        AND #$08
01/D310: F0 0B        BEQ $D31D
01/D312: AD A7 1B     LDA $1BA7
01/D315: 3A           DEC 
01/D316: 10 02        BPL $D31A
01/D318: A9 09        LDA #$09
01/D31A: 8D A7 1B     STA $1BA7
; down button
01/D31D: A5 01        LDA $01
01/D31F: 29 04        AND #$04
01/D321: F0 0C        BEQ $D32F
01/D323: AD A7 1B     LDA $1BA7
01/D326: 1A           INC 
01/D327: C9 0A        CMP #$0A
01/D329: D0 01        BNE $D32C
01/D32B: 7B           TDC 
01/D32C: 8D A7 1B     STA $1BA7
; left button
01/D32F: A5 01        LDA $01
01/D331: 29 02        AND #$02
01/D333: F0 61        BEQ $D396
; 0: change battle mode
01/D335: AD A7 1B     LDA $1BA7
01/D338: D0 05        BNE $D33F
01/D33A: 20 3C D6     JSR $D63C       ; toggle active/wait mode
01/D33D: 80 57        BRA $D396
; 1: change battle speed
01/D33F: 3A           DEC 
01/D340: D0 0B        BNE $D34D
01/D342: AD AC 16     LDA $16AC
01/D345: 3A           DEC 
01/D346: 30 4E        BMI $D396
01/D348: 8D AC 16     STA $16AC
01/D34B: 80 49        BRA $D396
; 2: change battle message speed
01/D34D: 3A           DEC 
01/D34E: D0 0B        BNE $D35B
01/D350: AD AD 16     LDA $16AD
01/D353: 3A           DEC 
01/D354: 30 40        BMI $D396
01/D356: 8D AD 16     STA $16AD
01/D359: 80 3B        BRA $D396
; 3: toggle stereo/mono
01/D35B: 3A           DEC 
01/D35C: D0 05        BNE $D363
01/D35E: 20 28 D6     JSR $D628       ; toggle stereo/mono
01/D361: 80 33        BRA $D396
; 4: toggle default/custom button mapping
01/D363: 3A           DEC 
01/D364: D0 05        BNE $D36B
01/D366: 20 45 D6     JSR $D645       ; toggle default/custom button mapping
01/D369: 80 2B        BRA $D396
; 5: toggle single/multi-controller
01/D36B: 3A           DEC 
01/D36C: D0 05        BNE $D373
01/D36E: 20 33 D6     JSR $D633       ; toggle single/multi-controller
01/D371: 80 23        BRA $D396
; 7-9: change window color
01/D373: 3A           DEC 
01/D374: F0 18        BEQ $D38E
01/D376: 3A           DEC 
01/D377: 0A           ASL 
01/D378: 20 B4 87     JSR $87B4       ; tax
01/D37B: C2 20        REP #$20
01/D37D: BF 21 D4 01  LDA $01D421,X
01/D381: 85 45        STA $45
01/D383: E2 20        SEP #$20
01/D385: B2 45        LDA ($45)
01/D387: 3A           DEC             ; decrement color component
01/D388: 30 0C        BMI $D396
01/D38A: 92 45        STA ($45)
01/D38C: 80 08        BRA $D396
; 6: toggle cursor reset/memory
01/D38E: AD B7 16     LDA $16B7
01/D391: 49 01        EOR #$01
01/D393: 8D B7 16     STA $16B7
; right button
01/D396: A5 01        LDA $01
01/D398: 29 01        AND #$01
01/D39A: F0 67        BEQ $D403
; 0: change battle mode
01/D39C: AD A7 1B     LDA $1BA7
01/D39F: D0 05        BNE $D3A6
01/D3A1: 20 3C D6     JSR $D63C       ; toggle active/wait mode
01/D3A4: 80 5D        BRA $D403
; 1: change battle speed
01/D3A6: 3A           DEC 
01/D3A7: D0 0D        BNE $D3B6
01/D3A9: AD AC 16     LDA $16AC
01/D3AC: 1A           INC 
01/D3AD: C9 06        CMP #$06
01/D3AF: F0 52        BEQ $D403
01/D3B1: 8D AC 16     STA $16AC
01/D3B4: 80 4D        BRA $D403
; 2: change battle message speed
01/D3B6: 3A           DEC 
01/D3B7: D0 0D        BNE $D3C6
01/D3B9: AD AD 16     LDA $16AD
01/D3BC: 1A           INC 
01/D3BD: C9 06        CMP #$06
01/D3BF: F0 42        BEQ $D403
01/D3C1: 8D AD 16     STA $16AD
01/D3C4: 80 3D        BRA $D403
; 3: toggle stereo/mono
01/D3C6: 3A           DEC 
01/D3C7: D0 05        BNE $D3CE
01/D3C9: 20 28 D6     JSR $D628       ; toggle stereo/mono
01/D3CC: 80 35        BRA $D403
; 4: toggle default/custom button mapping
01/D3CE: 3A           DEC 
01/D3CF: D0 05        BNE $D3D6
01/D3D1: 20 45 D6     JSR $D645       ; toggle default/custom button mapping
01/D3D4: 80 2D        BRA $D403
; 5: toggle single/multi-controller
01/D3D6: 3A           DEC 
01/D3D7: D0 05        BNE $D3DE
01/D3D9: 20 33 D6     JSR $D633       ; toggle single/multi-controller
01/D3DC: 80 25        BRA $D403
; 7-9: change window color
01/D3DE: 3A           DEC 
01/D3DF: F0 1A        BEQ $D3FB
01/D3E1: 3A           DEC 
01/D3E2: 0A           ASL 
01/D3E3: 20 B4 87     JSR $87B4       ; tax
01/D3E6: C2 20        REP #$20
01/D3E8: BF 21 D4 01  LDA $01D421,X
01/D3EC: 85 45        STA $45
01/D3EE: E2 20        SEP #$20
01/D3F0: B2 45        LDA ($45)
01/D3F2: 1A           INC             ; increment color component
01/D3F3: C9 20        CMP #$20
01/D3F5: F0 0C        BEQ $D403
01/D3F7: 92 45        STA ($45)
01/D3F9: 80 08        BRA $D403
; 6: toggle cursor reset/memory
01/D3FB: AD B7 16     LDA $16B7
01/D3FE: 49 01        EOR #$01
01/D400: 8D B7 16     STA $16B7
01/D403: 4C F8 D1     JMP $D1F8

; [ draw color slider tick marks ]

01/D406: A6 41        LDX $41         ; zero
01/D408: BF 18 D4 01  LDA $01D418,X
01/D40C: 99 00 00     STA $0000,Y
01/D40F: C8           INY 
01/D410: C8           INY 
01/D411: E8           INX 
01/D412: E0 09 00     CPX #$0009
01/D415: D0 F1        BNE $D408
01/D417: 60           RTS 

; color slider tick marks
01/D418: 01 02 02 02 01 02 02 02 03

; pointers to window color components
01/D421: 1BA8 1BA9 1BAA

; [ get window color from components ]

01/D427: AD A9 1B     LDA $1BA9
01/D42A: 85 43        STA $43
01/D42C: C2 20        REP #$20
01/D42E: A5 43        LDA $43
01/D430: 0A           ASL 
01/D431: 0A           ASL 
01/D432: 0A           ASL 
01/D433: 0A           ASL 
01/D434: 0A           ASL 
01/D435: 85 45        STA $45
01/D437: E2 20        SEP #$20
01/D439: AD A8 1B     LDA $1BA8
01/D43C: 05 45        ORA $45
01/D43E: 85 45        STA $45
01/D440: AD AA 1B     LDA $1BAA
01/D443: 0A           ASL 
01/D444: 0A           ASL 
01/D445: 05 46        ORA $46
01/D447: 85 46        STA $46
01/D449: 60           RTS 

; [ get components from window color ]

01/D44A: 86 45        STX $45
01/D44C: A5 45        LDA $45
01/D44E: 29 1F        AND #$1F
01/D450: 8D A8 1B     STA $1BA8       ; red
01/D453: C2 20        REP #$20
01/D455: AD AA 16     LDA $16AA
01/D458: 4A           LSR 
01/D459: 4A           LSR 
01/D45A: 4A           LSR 
01/D45B: 4A           LSR 
01/D45C: 4A           LSR 
01/D45D: E2 20        SEP #$20
01/D45F: 29 1F        AND #$1F
01/D461: 8D A9 1B     STA $1BA9       ; green
01/D464: A5 46        LDA $46
01/D466: 4A           LSR 
01/D467: 4A           LSR 
01/D468: 8D AA 1B     STA $1BAA       ; blue
01/D46B: 60           RTS 

; [ set stereo/mono ]

01/D46C: A9 90        LDA #$90
01/D46E: 8D 00 1E     STA $1E00
01/D471: AD B6 16     LDA $16B6
01/D474: 29 01        AND #$01
01/D476: 8D 01 1E     STA $1E01
01/D479: 22 04 80 04  JSL $048004     ; execute sound command
01/D47D: 60           RTS 

; [ button mapping menu ]

01/D47E: 20 BA 84     JSR $84BA       ; select bg2
01/D481: A0 00 E2     LDY #$E200
01/D484: 20 D9 80     JSR $80D9       ; draw window
01/D487: A0 5C E1     LDY #$E15C
01/D48A: 20 D9 80     JSR $80D9       ; draw window
01/D48D: A0 04 E2     LDY #$E204
01/D490: 20 01 83     JSR $8301       ; draw positioned text
01/D493: A2 94 03     LDX #$0394
01/D496: A0 38 E2     LDY #$E238
01/D499: 20 CD 82     JSR $82CD       ; draw text
01/D49C: A2 14 04     LDX #$0414
01/D49F: A0 38 E2     LDY #$E238
01/D4A2: 20 CD 82     JSR $82CD       ; draw text
01/D4A5: A0 4C E2     LDY #$E24C
01/D4A8: A2 94 02     LDX #$0294
01/D4AB: 20 CD 82     JSR $82CD       ; draw text
01/D4AE: A0 4C E2     LDY #$E24C
01/D4B1: A2 14 03     LDX #$0314
01/D4B4: 20 CD 82     JSR $82CD       ; draw text
01/D4B7: A0 4C E2     LDY #$E24C
01/D4BA: A2 14 02     LDX #$0214
01/D4BD: 20 CD 82     JSR $82CD       ; draw text
01/D4C0: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/D4C3: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D4C6: 20 E3 83     JSR $83E3       ; open window
01/D4C9: 20 DB D4     JSR $D4DB       ; get player input (button mapping menu)
01/D4CC: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/D4CF: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/D4D2: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D4D5: 20 17 84     JSR $8417       ; close window
01/D4D8: 4C A2 84     JMP $84A2       ; select bg1

; [ get player input (button mapping menu) ]

01/D4DB: AD B9 1B     LDA $1BB9
01/D4DE: 0A           ASL 
01/D4DF: 0A           ASL 
01/D4E0: 0A           ASL 
01/D4E1: 0A           ASL 
01/D4E2: 69 4B        ADC #$4B
01/D4E4: 85 46        STA $46
01/D4E6: A9 0A        LDA #$0A
01/D4E8: 85 45        STA $45
01/D4EA: A0 14 03     LDY #$0314
01/D4ED: 20 84 82     JSR $8284       ; draw cursor sprite
01/D4F0: AD AE 16     LDA $16AE
01/D4F3: 20 0A D6     JSR $D60A       ; get button mapping cursor x position
01/D4F6: A9 4A        LDA #$4A
01/D4F8: 85 46        STA $46
01/D4FA: 20 81 82     JSR $8281       ; draw cursor sprite
01/D4FD: AD AF 16     LDA $16AF
01/D500: 20 0A D6     JSR $D60A       ; get button mapping cursor x position
01/D503: A9 5A        LDA #$5A
01/D505: 85 46        STA $46
01/D507: 20 7C 82     JSR $827C       ; draw cursor sprite
01/D50A: AD B0 16     LDA $16B0
01/D50D: 20 0A D6     JSR $D60A       ; get button mapping cursor x position
01/D510: A9 6A        LDA #$6A
01/D512: 85 46        STA $46
01/D514: A0 0C 03     LDY #$030C
01/D517: 20 84 82     JSR $8284       ; draw cursor sprite
01/D51A: AD B1 16     LDA $16B1
01/D51D: 20 B4 87     JSR $87B4       ; tax
01/D520: BF 19 D6 01  LDA $01D619,X
01/D524: 85 45        STA $45
01/D526: A9 7A        LDA #$7A
01/D528: 85 46        STA $46
01/D52A: A0 08 03     LDY #$0308
01/D52D: 20 84 82     JSR $8284       ; draw cursor sprite
01/D530: AD B2 16     LDA $16B2
01/D533: 20 B4 87     JSR $87B4       ; tax
01/D536: BF 19 D6 01  LDA $01D619,X
01/D53A: 85 45        STA $45
01/D53C: A9 8A        LDA #$8A
01/D53E: 85 46        STA $46
01/D540: A0 18 03     LDY #$0318
01/D543: 20 84 82     JSR $8284       ; draw cursor sprite
01/D546: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D549: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/D54C: A5 01        LDA $01
01/D54E: 29 80        AND #$80
01/D550: F0 05        BEQ $D557
01/D552: A9 05        LDA #$05
01/D554: 8D B9 1B     STA $1BB9
; up button
01/D557: A5 01        LDA $01
01/D559: 29 08        AND #$08
01/D55B: F0 0B        BEQ $D568
01/D55D: AD B9 1B     LDA $1BB9
01/D560: 3A           DEC 
01/D561: 10 02        BPL $D565
01/D563: A9 05        LDA #$05
01/D565: 8D B9 1B     STA $1BB9
; down button
01/D568: A5 01        LDA $01
01/D56A: 29 04        AND #$04
01/D56C: F0 0D        BEQ $D57B
01/D56E: AD B9 1B     LDA $1BB9
01/D571: 1A           INC 
01/D572: C9 06        CMP #$06
01/D574: D0 02        BNE $D578
01/D576: A9 00        LDA #$00
01/D578: 8D B9 1B     STA $1BB9
; right button
01/D57B: A5 01        LDA $01
01/D57D: 29 01        AND #$01
01/D57F: F0 19        BEQ $D59A
01/D581: AD B9 1B     LDA $1BB9
01/D584: C9 05        CMP #$05
01/D586: F0 30        BEQ $D5B8
01/D588: 20 B4 87     JSR $87B4       ; tax
01/D58B: BD AE 16     LDA $16AE,X
01/D58E: 1A           INC 
01/D58F: DF 51 D6 01  CMP $01D651,X
01/D593: D0 02        BNE $D597
01/D595: A9 00        LDA #$00
01/D597: 9D AE 16     STA $16AE,X
; left button
01/D59A: A5 01        LDA $01
01/D59C: 29 02        AND #$02
01/D59E: F0 18        BEQ $D5B8
01/D5A0: AD B9 1B     LDA $1BB9
01/D5A3: C9 05        CMP #$05
01/D5A5: F0 11        BEQ $D5B8
01/D5A7: 20 B4 87     JSR $87B4       ; tax
01/D5AA: BD AE 16     LDA $16AE,X
01/D5AD: 3A           DEC 
01/D5AE: 10 05        BPL $D5B5
01/D5B0: BF 51 D6 01  LDA $01D651,X
01/D5B4: 3A           DEC 
01/D5B5: 9D AE 16     STA $16AE,X
; A button
01/D5B8: A5 00        LDA $00
01/D5BA: 29 80        AND #$80
01/D5BC: F0 0A        BEQ $D5C8
01/D5BE: AD B9 1B     LDA $1BB9
01/D5C1: C9 05        CMP #$05
01/D5C3: D0 03        BNE $D5C8
01/D5C5: 20 DC D5     JSR $D5DC
01/D5C8: A5 01        LDA $01
01/D5CA: 29 C0        AND #$C0
01/D5CC: D0 09        BNE $D5D7
01/D5CE: A5 00        LDA $00
01/D5D0: 29 C0        AND #$C0
01/D5D2: D0 03        BNE $D5D7
01/D5D4: 4C DB D4     JMP $D4DB
01/D5D7: 20 DC D5     JSR $D5DC
01/D5DA: 80 F8        BRA $D5D4

; [ validate button mapping ??? ]

01/D5DC: AD AE 16     LDA $16AE
01/D5DF: CD AF 16     CMP $16AF
01/D5E2: F0 23        BEQ $D607
01/D5E4: CD B0 16     CMP $16B0
01/D5E7: F0 1E        BEQ $D607
01/D5E9: AD AF 16     LDA $16AF
01/D5EC: CD B0 16     CMP $16B0
01/D5EF: F0 16        BEQ $D607
01/D5F1: FA           PLX 
01/D5F2: AE AE 16     LDX $16AE
01/D5F5: 8E 37 1A     STX $1A37
01/D5F8: AE B0 16     LDX $16B0
01/D5FB: 8E 39 1A     STX $1A39
01/D5FE: AD B2 16     LDA $16B2
01/D601: 8D 3B 1A     STA $1A3B
01/D604: 4C BB 82     JMP $82BB       ; init controller
01/D607: 4C 58 87     JMP $8758       ; error sound effect

; [ get button mapping cursor x position ]

01/D60A: 20 B4 87     JSR $87B4       ; tax
01/D60D: BF 14 D6 01  LDA $01D614,X
01/D611: 85 45        STA $45
01/D613: 60           RTS 

; button mapping cursor x positions
01/D614: 44 5C 74 8C A4 44 6C 94 BC

; [ get toggle cursor x position ]

01/D61D: 29 01        AND #$01
01/D61F: F0 04        BEQ $D625
01/D621: A9 A0        LDA #$A0
01/D623: 80 02        BRA $D627
01/D625: A9 68        LDA #$68
01/D627: 60           RTS 

; [ toggle stereo/mono ]

01/D628: AD B6 16     LDA $16B6
01/D62B: 49 01        EOR #$01
01/D62D: 8D B6 16     STA $16B6
01/D630: 4C 6C D4     JMP $D46C       ; set stereo/mono

; [ toggle single/multi-controller ]

01/D633: AD B8 16     LDA $16B8
01/D636: 49 01        EOR #$01
01/D638: 8D B8 16     STA $16B8
01/D63B: 60           RTS 

; [ toggle active/wait mode ]

01/D63C: AD BE 16     LDA $16BE
01/D63F: 49 01        EOR #$01
01/D641: 8D BE 16     STA $16BE
01/D644: 60           RTS 

; [ toggle default/custom button mapping ]

01/D645: AD A9 16     LDA $16A9
01/D648: 49 01        EOR #$01
01/D64A: 8D A9 16     STA $16A9
01/D64D: 8D 64 1A     STA $1A64
01/D650: 60           RTS 

01/D651: 05 05 05 04 04

; [ multi-controller menu ]

01/D656: 20 BA 84     JSR $84BA       ; select bg2
01/D659: A0 5C E1     LDY #$E15C
01/D65C: 20 D9 80     JSR $80D9       ; draw window
01/D65F: A0 63 E2     LDY #$E263
01/D662: 20 FB 82     JSR $82FB       ; draw window and text
01/D665: 64 48        STZ $48
01/D667: 64 49        STZ $49
01/D669: A0 12 02     LDY #$0212
01/D66C: A6 48        LDX $48
01/D66E: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/D672: 5A           PHY 
01/D673: 20 01 90     JSR $9001       ; get pointer to character properties
01/D676: BD 00 00     LDA $0000,X
01/D679: 20 AB 83     JSR $83AB       ; draw character name
01/D67C: 7A           PLY 
01/D67D: 5A           PHY 
01/D67E: 20 B9 87     JSR $87B9       ; iny8
01/D681: 20 BD 87     JSR $87BD       ; iny4
01/D684: BB           TYX 
01/D685: A0 F8 E1     LDY #$E1F8
01/D688: 20 CD 82     JSR $82CD       ; draw text
01/D68B: 7A           PLY 
01/D68C: 20 8B 87     JSR $878B       ; next row (Y)
01/D68F: 20 8B 87     JSR $878B       ; next row (Y)
01/D692: E6 48        INC $48
01/D694: A5 48        LDA $48
01/D696: C9 05        CMP #$05
01/D698: D0 D2        BNE $D66C
01/D69A: AD C7 1B     LDA $1BC7
01/D69D: 85 45        STA $45
01/D69F: A5 45        LDA $45
01/D6A1: 20 12 A9     JSR $A912       ; get character id (battle order)
01/D6A4: D0 0C        BNE $D6B2
01/D6A6: E6 45        INC $45
01/D6A8: A5 45        LDA $45
01/D6AA: C9 05        CMP #$05
01/D6AC: D0 F1        BNE $D69F
01/D6AE: 64 45        STZ $45
01/D6B0: 80 ED        BRA $D69F
01/D6B2: A5 45        LDA $45
01/D6B4: 8D C7 1B     STA $1BC7
01/D6B7: 20 6A 8D     JSR $8D6A       ; clear sprite data
01/D6BA: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D6BD: 20 E3 83     JSR $83E3       ; open window
; start of frame loop
01/D6C0: AD C7 1B     LDA $1BC7
01/D6C3: 0A           ASL 
01/D6C4: 0A           ASL 
01/D6C5: 0A           ASL 
01/D6C6: 0A           ASL 
01/D6C7: 69 4A        ADC #$4A
01/D6C9: 85 46        STA $46
01/D6CB: A9 38        LDA #$38
01/D6CD: 85 45        STA $45
01/D6CF: 20 81 82     JSR $8281       ; draw cursor sprite
01/D6D2: 64 45        STZ $45
01/D6D4: 64 46        STZ $46
01/D6D6: A5 45        LDA $45
01/D6D8: 0A           ASL 
01/D6D9: 20 B4 87     JSR $87B4       ; tax
01/D6DC: C2 20        REP #$20
01/D6DE: BF 6F D7 01  LDA $01D76F,X   ; tilemap offset
01/D6E2: A8           TAY 
01/D6E3: E2 20        SEP #$20
01/D6E5: A5 45        LDA $45
01/D6E7: 20 51 D7     JSR $D751       ; get controller for character
01/D6EA: 4A           LSR 
01/D6EB: 18           CLC 
01/D6EC: 69 81        ADC #$81        ; "1" or "2"
01/D6EE: 99 00 A6     STA $A600,Y
01/D6F1: E6 45        INC $45
01/D6F3: A5 45        LDA $45
01/D6F5: C9 05        CMP #$05
01/D6F7: D0 DD        BNE $D6D6
01/D6F9: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/D6FC: 20 4F 82     JSR $824F       ; transfer sprite data to ppu
01/D6FF: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/D702: A5 01        LDA $01
01/D704: 29 80        AND #$80
01/D706: F0 03        BEQ $D70B
01/D708: 4C 1D 94     JMP $941D       ; clear bg2 screen buffer in vram
; up button
01/D70B: A5 01        LDA $01
01/D70D: 29 08        AND #$08
01/D70F: F0 10        BEQ $D721
01/D711: AD C7 1B     LDA $1BC7
01/D714: 3A           DEC 
01/D715: 10 02        BPL $D719
01/D717: A9 04        LDA #$04
01/D719: 8D C7 1B     STA $1BC7
01/D71C: 20 5F D7     JSR $D75F
01/D71F: F0 F0        BEQ $D711
; down button
01/D721: A5 01        LDA $01
01/D723: 29 04        AND #$04
01/D725: F0 12        BEQ $D739
01/D727: AD C7 1B     LDA $1BC7
01/D72A: 1A           INC 
01/D72B: C9 05        CMP #$05
01/D72D: D0 02        BNE $D731
01/D72F: A9 00        LDA #$00
01/D731: 8D C7 1B     STA $1BC7
01/D734: 20 5F D7     JSR $D75F
01/D737: F0 EE        BEQ $D727
; left or right button
01/D739: A5 01        LDA $01
01/D73B: 29 03        AND #$03
01/D73D: F0 0C        BEQ $D74B
01/D73F: 20 4E D7     JSR $D74E
01/D742: 3A           DEC 
01/D743: 3A           DEC 
01/D744: 10 02        BPL $D748
01/D746: A9 02        LDA #$02
01/D748: 9D B9 16     STA $16B9,X
01/D74B: 4C C0 D6     JMP $D6C0

; [ get controller for character ]

01/D74E: AD C7 1B     LDA $1BC7
; A: character slot
01/D751: 20 B4 87     JSR $87B4       ; tax
01/D754: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/D758: 20 B4 87     JSR $87B4       ; tax
01/D75B: BD B9 16     LDA $16B9,X
01/D75E: 60           RTS 

; [ get character id ]

01/D75F: 20 B4 87     JSR $87B4       ; tax
01/D762: BF 9D FF 14  LDA $14FF9D,X   ; character battle order
01/D766: 20 01 90     JSR $9001       ; get pointer to character properties
01/D769: BD 00 00     LDA $0000,X
01/D76C: 29 3F        AND #$3F
01/D76E: 60           RTS 

; tilemap offsets for character controller numeral
01/D76F: 026E 02EE 036E 03EE 046E

; [ change battle speed numerals to gray ]

01/D779: A0 1F B8     LDY #$B81F      ; bg1 (15,8)
01/D77C: 20 82 D7     JSR $D782
01/D77F: A0 9F B8     LDY #$B89F      ; bg1 (15,10)
01/D782: A9 04        LDA #$04
01/D784: A2 06 00     LDX #$0006
01/D787: 99 00 00     STA $0000,Y
01/D78A: C8           INY 
01/D78B: C8           INY 
01/D78C: C8           INY 
01/D78D: C8           INY 
01/D78E: CA           DEX 
01/D78F: D0 F6        BNE $D787
01/D791: 60           RTS 

; --------------------------------------------------------------------------

; [ treasure menu ]

01/D792: 8B           PHB 
01/D793: 0B           PHD 
01/D794: 20 3A 87     JSR $873A       ; save dialogue window graphics
01/D797: 20 7D 8C     JSR $8C7D       ; init menu
01/D79A: 9C 83 1A     STZ $1A83
01/D79D: A6 41        LDX $41         ; zero
01/D79F: 8A           TXA 
01/D7A0: 8E B3 1B     STX $1BB3
01/D7A3: 8E B5 1B     STX $1BB5
01/D7A6: 8D B7 1B     STA $1BB7
01/D7A9: A9 08        LDA #$08
01/D7AB: 85 45        STA $45
01/D7AD: A6 41        LDX $41         ; zero
01/D7AF: 9B           TXY 
01/D7B0: BD 04 18     LDA $1804,X
01/D7B3: F0 1C        BEQ $D7D1
01/D7B5: C9 54        CMP #$54
01/D7B7: 90 0E        BCC $D7C7
01/D7B9: C9 60        CMP #$60
01/D7BB: B0 0A        BCS $D7C7
01/D7BD: 99 28 FF     STA $FF28,Y
01/D7C0: A9 0A        LDA #$0A
01/D7C2: 99 29 FF     STA $FF29,Y
01/D7C5: 80 12        BRA $D7D9
01/D7C7: 99 28 FF     STA $FF28,Y
01/D7CA: A9 01        LDA #$01
01/D7CC: 99 29 FF     STA $FF29,Y
01/D7CF: 80 08        BRA $D7D9
01/D7D1: A9 00        LDA #$00
01/D7D3: 99 28 FF     STA $FF28,Y
01/D7D6: 99 29 FF     STA $FF29,Y
01/D7D9: C8           INY 
01/D7DA: C8           INY 
01/D7DB: E8           INX 
01/D7DC: C6 45        DEC $45
01/D7DE: D0 D0        BNE $D7B0
01/D7E0: 20 F2 D7     JSR $D7F2
01/D7E3: 20 7E 94     JSR $947E       ; fade out
01/D7E6: 9C C6 1B     STZ $1BC6
01/D7E9: 20 3F 87     JSR $873F       ; restore dialogue window graphics
01/D7EC: A9 00        LDA #$00
01/D7EE: EB           XBA 
01/D7EF: 2B           PLD 
01/D7F0: AB           PLB 
01/D7F1: 60           RTS 

; [  ]

01/D7F2: A2 E0 FF     LDX #$FFE0
01/D7F5: 86 93        STX $93
01/D7F7: A2 88 FF     LDX #$FF88
01/D7FA: 86 9F        STX $9F
01/D7FC: 20 BA 84     JSR $84BA       ; select bg2
01/D7FF: 20 40 DB     JSR $DB40
01/D802: 20 A2 84     JSR $84A2       ; select bg1
01/D805: A2 00 ED     LDX #$ED00      ; items $00-$ED valid (all but key items)
01/D808: 8E 1D 1B     STX $1B1D
01/D80B: EE C6 1B     INC $1BC6
01/D80E: 20 5C A1     JSR $A15C
01/D811: 20 88 84     JSR $8488       ; select bg4
01/D814: A0 75 E2     LDY #$E275
01/D817: 20 D9 80     JSR $80D9       ; draw window
01/D81A: 20 70 84     JSR $8470       ; select bg3
01/D81D: 20 72 A1     JSR $A172
01/D820: 20 11 94     JSR $9411       ; transfer screen buffer to vram (all)
01/D823: 20 A4 94     JSR $94A4
01/D826: 64 60        STZ $60
01/D828: 20 64 94     JSR $9464       ; fade in
01/D82B: 20 3A D8     JSR $D83A
01/D82E: A5 60        LDA $60
01/D830: F0 06        BEQ $D838
01/D832: 20 11 DB     JSR $DB11
01/D835: B0 F4        BCS $D82B
01/D837: 60           RTS 
01/D838: 80 60        BRA $D89A
01/D83A: 20 BA 84     JSR $84BA       ; select bg2
01/D83D: A0 8A E2     LDY #$E28A
01/D840: 20 01 83     JSR $8301       ; draw positioned text
01/D843: 20 87 D8     JSR $D887
01/D846: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D849: 20 23 94     JSR $9423       ; transfer bg2 screen buffer to vram
01/D84C: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; left or right button
01/D84F: A5 01        LDA $01
01/D851: 29 03        AND #$03
01/D853: F0 06        BEQ $D85B
01/D855: A5 60        LDA $60
01/D857: 49 FF        EOR #$FF
01/D859: 85 60        STA $60
; B button
01/D85B: A5 01        LDA $01
01/D85D: 29 80        AND #$80
01/D85F: F0 0B        BEQ $D86C
01/D861: A5 60        LDA $60
01/D863: C9 FF        CMP #$FF
01/D865: D0 01        BNE $D868
01/D867: 60           RTS 
01/D868: A9 FF        LDA #$FF
01/D86A: 85 60        STA $60
; A button
01/D86C: A5 00        LDA $00
01/D86E: 29 80        AND #$80
01/D870: F0 01        BEQ $D873
01/D872: 60           RTS 
; down button
01/D873: A5 01        LDA $01
01/D875: 29 04        AND #$04
01/D877: F0 0B        BEQ $D884
01/D879: 64 60        STZ $60
01/D87B: 20 87 D8     JSR $D887
01/D87E: EE 83 1A     INC $1A83
01/D881: 4C 3E D9     JMP $D93E
01/D884: 4C 3A D8     JMP $D83A

; [  ]

01/D887: A5 60        LDA $60
01/D889: D0 04        BNE $D88F
01/D88B: A9 48        LDA #$48
01/D88D: 80 02        BRA $D891
01/D88F: A9 B8        LDA #$B8
01/D891: 85 45        STA $45
01/D893: A9 0E        LDA #$0E
01/D895: 85 46        STA $46
01/D897: 4C 81 82     JMP $8281       ; draw cursor sprite
01/D89A: A4 41        LDY $41         ; zero
01/D89C: A9 08        LDA #$08
01/D89E: 85 48        STA $48
01/D8A0: B9 28 FF     LDA $FF28,Y
01/D8A3: F0 2C        BEQ $D8D1
01/D8A5: A9 30        LDA #$30
01/D8A7: 85 45        STA $45
01/D8A9: A6 41        LDX $41         ; zero
01/D8AB: B9 28 FF     LDA $FF28,Y
01/D8AE: DD 40 14     CMP $1440,X
01/D8B1: D0 18        BNE $D8CB
01/D8B3: B9 29 FF     LDA $FF29,Y
01/D8B6: 18           CLC 
01/D8B7: 7D 41 14     ADC $1441,X
01/D8BA: C9 64        CMP #$64
01/D8BC: B0 0D        BCS $D8CB
01/D8BE: 9D 41 14     STA $1441,X
01/D8C1: A9 00        LDA #$00
01/D8C3: 99 28 FF     STA $FF28,Y
01/D8C6: 99 29 FF     STA $FF29,Y
01/D8C9: 80 06        BRA $D8D1
01/D8CB: E8           INX 
01/D8CC: E8           INX 
01/D8CD: C6 45        DEC $45
01/D8CF: D0 DA        BNE $D8AB
01/D8D1: C8           INY 
01/D8D2: C8           INY 
01/D8D3: C6 48        DEC $48
01/D8D5: D0 C9        BNE $D8A0
01/D8D7: A9 08        LDA #$08
01/D8D9: 85 45        STA $45
01/D8DB: A4 41        LDY $41         ; zero
01/D8DD: B9 28 FF     LDA $FF28,Y
01/D8E0: F0 1A        BEQ $D8FC
01/D8E2: A9 00        LDA #$00
01/D8E4: 5A           PHY 
01/D8E5: 20 38 C2     JSR $C238       ; find item in inventory
01/D8E8: 7A           PLY 
01/D8E9: C9 00        CMP #$00
01/D8EB: D0 0F        BNE $D8FC
01/D8ED: C2 20        REP #$20
01/D8EF: B9 28 FF     LDA $FF28,Y
01/D8F2: 9D 40 14     STA $1440,X
01/D8F5: A5 41        LDA $41         ; zero
01/D8F7: 99 28 FF     STA $FF28,Y
01/D8FA: E2 20        SEP #$20
01/D8FC: C8           INY 
01/D8FD: C8           INY 
01/D8FE: C6 45        DEC $45
01/D900: D0 DB        BNE $D8DD
01/D902: A0 08 00     LDY #$0008
01/D905: A6 41        LDX $41         ; zero
01/D907: 8A           TXA 
01/D908: 18           CLC 
01/D909: 7D 29 FF     ADC $FF29,X
01/D90C: E8           INX 
01/D90D: E8           INX 
01/D90E: 88           DEY 
01/D90F: D0 F7        BNE $D908
01/D911: 20 29 D9     JSR $D929
01/D914: C9 00        CMP #$00
01/D916: D0 26        BNE $D93E
01/D918: E6 60        INC $60
01/D91A: 20 87 D8     JSR $D887
01/D91D: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D920: 20 BA 84     JSR $84BA       ; select bg2
01/D923: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/D926: 4C 36 83     JMP $8336

; [  ]

01/D929: 48           PHA 
01/D92A: 20 9F 84     JSR $849F       ; select and clear bg1
01/D92D: 20 5C A1     JSR $A15C
01/D930: 20 70 84     JSR $8470       ; select bg3
01/D933: 20 72 A1     JSR $A172
01/D936: 20 2D 94     JSR $942D       ; transfer bg1 screen buffer to vram
01/D939: 20 47 94     JSR $9447       ; transfer bg3 screen buffer to vram
01/D93C: 68           PLA 
01/D93D: 60           RTS 

; [  ]

01/D93E: AD 83 1A     LDA $1A83
01/D941: 9C 83 1A     STZ $1A83
01/D944: D0 10        BNE $D956
01/D946: 20 3A D8     JSR $D83A
01/D949: A5 60        LDA $60
01/D94B: F0 06        BEQ $D953
01/D94D: 20 11 DB     JSR $DB11
01/D950: B0 F4        BCS $D946
01/D952: 60           RTS 
01/D953: 4C 9A D8     JMP $D89A
01/D956: 20 5B D9     JSR $D95B
01/D959: 80 EB        BRA $D946
01/D95B: 20 BA 84     JSR $84BA       ; select bg2
01/D95E: A0 95 E2     LDY #$E295
01/D961: 20 01 83     JSR $8301       ; draw positioned text
01/D964: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
; start of frame loop
01/D967: AD B3 1B     LDA $1BB3
01/D96A: 0A           ASL 
01/D96B: 0A           ASL 
01/D96C: 0A           ASL 
01/D96D: 0A           ASL 
01/D96E: 69 30        ADC #$30
01/D970: 85 5B        STA $5B
01/D972: AD B4 1B     LDA $1BB4
01/D975: F0 04        BEQ $D97B
01/D977: A9 70        LDA #$70
01/D979: 80 02        BRA $D97D
01/D97B: A9 00        LDA #$00
01/D97D: 85 5A        STA $5A
01/D97F: A6 5A        LDX $5A
01/D981: A0 04 03     LDY #$0304
01/D984: 7B           TDC 
01/D985: 20 86 82     JSR $8286
01/D988: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/D98B: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/D98E: A5 01        LDA $01
01/D990: 29 80        AND #$80
01/D992: F0 08        BEQ $D99C
01/D994: 64 60        STZ $60
01/D996: A0 04 03     LDY #$0304
01/D999: 4C DF A2     JMP $A2DF
; A button
01/D99C: A5 00        LDA $00
01/D99E: 29 80        AND #$80
01/D9A0: F0 03        BEQ $D9A5
01/D9A2: 20 EA D9     JSR $D9EA
; right button
01/D9A5: A5 01        LDA $01
01/D9A7: 29 01        AND #$01
01/D9A9: F0 0B        BEQ $D9B6
01/D9AB: AD B4 1B     LDA $1BB4
01/D9AE: 1A           INC 
01/D9AF: 29 01        AND #$01
01/D9B1: 8D B4 1B     STA $1BB4
01/D9B4: F0 26        BEQ $D9DC
; left button
01/D9B6: A5 01        LDA $01
01/D9B8: 29 02        AND #$02
01/D9BA: F0 0B        BEQ $D9C7
01/D9BC: AD B4 1B     LDA $1BB4
01/D9BF: 1A           INC 
01/D9C0: 29 01        AND #$01
01/D9C2: 8D B4 1B     STA $1BB4
01/D9C5: D0 06        BNE $D9CD
; up button
01/D9C7: A5 01        LDA $01
01/D9C9: 29 08        AND #$08
01/D9CB: F0 09        BEQ $D9D6
01/D9CD: AD B3 1B     LDA $1BB3
01/D9D0: 3A           DEC 
01/D9D1: 30 03        BMI $D9D6
01/D9D3: 8D B3 1B     STA $1BB3
; down button
01/D9D6: A5 01        LDA $01
01/D9D8: 29 04        AND #$04
01/D9DA: F0 0B        BEQ $D9E7
01/D9DC: AD B3 1B     LDA $1BB3
01/D9DF: 1A           INC 
01/D9E0: C9 04        CMP #$04
01/D9E2: F0 03        BEQ $D9E7
01/D9E4: 8D B3 1B     STA $1BB3
01/D9E7: 4C 67 D9     JMP $D967

; [  ]

01/D9EA: AD B5 1B     LDA $1BB5
01/D9ED: 0A           ASL 
01/D9EE: 0A           ASL 
01/D9EF: 0A           ASL 
01/D9F0: 0A           ASL 
01/D9F1: 69 86        ADC #$86
01/D9F3: 85 46        STA $46
01/D9F5: AD B6 1B     LDA $1BB6
01/D9F8: F0 04        BEQ $D9FE
01/D9FA: A9 70        LDA #$70
01/D9FC: 80 02        BRA $DA00
01/D9FE: A9 00        LDA #$00
01/DA00: 85 45        STA $45
01/DA02: 20 81 82     JSR $8281       ; draw cursor sprite
01/DA05: 20 4C 82     JSR $824C       ; transfer sprite data to ppu
01/DA08: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
; B button
01/DA0B: A5 01        LDA $01
01/DA0D: 29 80        AND #$80
01/DA0F: F0 03        BEQ $DA14
01/DA11: 4C F2 A2     JMP $A2F2
; A button
01/DA14: A5 00        LDA $00
01/DA16: 29 80        AND #$80
01/DA18: F0 06        BEQ $DA20
01/DA1A: 20 F2 A2     JSR $A2F2
01/DA1D: 4C AC DA     JMP $DAAC
; right button
01/DA20: A5 01        LDA $01
01/DA22: 29 01        AND #$01
01/DA24: F0 0B        BEQ $DA31
01/DA26: AD B6 1B     LDA $1BB6
01/DA29: 1A           INC 
01/DA2A: 29 01        AND #$01
01/DA2C: 8D B6 1B     STA $1BB6
01/DA2F: F0 48        BEQ $DA79
; left button
01/DA31: A5 01        LDA $01
01/DA33: 29 02        AND #$02
01/DA35: F0 0B        BEQ $DA42
01/DA37: AD B6 1B     LDA $1BB6
01/DA3A: 1A           INC 
01/DA3B: 29 01        AND #$01
01/DA3D: 8D B6 1B     STA $1BB6
01/DA40: D0 06        BNE $DA48
; up button
01/DA42: A5 01        LDA $01
01/DA44: 29 08        AND #$08
01/DA46: F0 2B        BEQ $DA73
01/DA48: AD B5 1B     LDA $1BB5
01/DA4B: 3A           DEC 
01/DA4C: 10 22        BPL $DA70
01/DA4E: AD B7 1B     LDA $1BB7
01/DA51: 3A           DEC 
01/DA52: 30 1F        BMI $DA73
01/DA54: 8D B7 1B     STA $1BB7
01/DA57: A9 08        LDA #$08
01/DA59: C2 20        REP #$20
01/DA5B: C6 9F        DEC $9F
01/DA5D: C6 9F        DEC $9F
01/DA5F: E2 20        SEP #$20
01/DA61: 20 A1 94     JSR $94A1
01/DA64: 3A           DEC 
01/DA65: D0 F2        BNE $DA59
01/DA67: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/DA6A: A6 02        LDX $02
01/DA6C: 86 00        STX $00
01/DA6E: 80 9B        BRA $DA0B
01/DA70: 8D B5 1B     STA $1BB5
; down button
01/DA73: A5 01        LDA $01
01/DA75: 29 04        AND #$04
01/DA77: F0 30        BEQ $DAA9
01/DA79: AD B5 1B     LDA $1BB5
01/DA7C: 1A           INC 
01/DA7D: C9 05        CMP #$05
01/DA7F: D0 25        BNE $DAA6
01/DA81: AD B7 1B     LDA $1BB7
01/DA84: 1A           INC 
01/DA85: C9 14        CMP #$14
01/DA87: F0 20        BEQ $DAA9
01/DA89: 8D B7 1B     STA $1BB7
01/DA8C: A9 08        LDA #$08
01/DA8E: C2 20        REP #$20
01/DA90: E6 9F        INC $9F
01/DA92: E6 9F        INC $9F
01/DA94: E2 20        SEP #$20
01/DA96: 20 A1 94     JSR $94A1
01/DA99: 3A           DEC 
01/DA9A: D0 F2        BNE $DA8E
01/DA9C: 20 C0 82     JSR $82C0       ; update controller (w/ sound effect)
01/DA9F: A6 02        LDX $02
01/DAA1: 86 00        STX $00
01/DAA3: 4C 0B DA     JMP $DA0B
01/DAA6: 8D B5 1B     STA $1BB5
01/DAA9: 4C EA D9     JMP $D9EA

; [  ]

01/DAAC: AD B3 1B     LDA $1BB3
01/DAAF: 0A           ASL 
01/DAB0: 6D B4 1B     ADC $1BB4
01/DAB3: 0A           ASL 
01/DAB4: 20 B4 87     JSR $87B4       ; tax
01/DAB7: AD B5 1B     LDA $1BB5
01/DABA: 18           CLC 
01/DABB: 6D B7 1B     ADC $1BB7
01/DABE: 0A           ASL 
01/DABF: 6D B6 1B     ADC $1BB6
01/DAC2: 0A           ASL 
01/DAC3: 85 43        STA $43
01/DAC5: A4 43        LDY $43
01/DAC7: B9 40 14     LDA $1440,Y
01/DACA: C9 19        CMP #$19
01/DACC: F0 35        BEQ $DB03
01/DACE: C9 C8        CMP #$C8
01/DAD0: F0 31        BEQ $DB03
01/DAD2: C9 EE        CMP #$EE
01/DAD4: B0 2D        BCS $DB03
01/DAD6: B9 40 14     LDA $1440,Y
01/DAD9: DD 28 FF     CMP $FF28,X
01/DADC: D0 13        BNE $DAF1
01/DADE: BD 29 FF     LDA $FF29,X
01/DAE1: 18           CLC 
01/DAE2: 79 41 14     ADC $1441,Y
01/DAE5: C9 64        CMP #$64
01/DAE7: B0 1A        BCS $DB03
01/DAE9: 99 41 14     STA $1441,Y
01/DAEC: 9E 29 FF     STZ $FF29,X
01/DAEF: 80 12        BRA $DB03
01/DAF1: C2 20        REP #$20
01/DAF3: B9 40 14     LDA $1440,Y
01/DAF6: 48           PHA 
01/DAF7: BD 28 FF     LDA $FF28,X
01/DAFA: 99 40 14     STA $1440,Y
01/DAFD: 68           PLA 
01/DAFE: 9D 28 FF     STA $FF28,X
01/DB01: E2 20        SEP #$20
01/DB03: 4C 29 D9     JMP $D929
01/DB06: C2 20        REP #$20
01/DB08: A5 41        LDA $41         ; zero
01/DB0A: 9D 28 FF     STA $FF28,X
01/DB0D: E2 20        SEP #$20
01/DB0F: 80 F2        BRA $DB03

; [  ]

01/DB11: A6 41        LDX $41         ; zero
01/DB13: BD 28 FF     LDA $FF28,X
01/DB16: C9 19        CMP #$19
01/DB18: F0 11        BEQ $DB2B
01/DB1A: C9 C8        CMP #$C8
01/DB1C: F0 0D        BEQ $DB2B
01/DB1E: C9 EE        CMP #$EE
01/DB20: B0 09        BCS $DB2B
01/DB22: E8           INX 
01/DB23: E8           INX 
01/DB24: E0 10 00     CPX #$0010
01/DB27: D0 EA        BNE $DB13
01/DB29: 18           CLC 
01/DB2A: 60           RTS 
01/DB2B: 20 BA 84     JSR $84BA       ; select bg2
01/DB2E: A0 A0 E2     LDY #$E2A0
01/DB31: 20 FB 82     JSR $82FB       ; draw window and text
01/DB34: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/DB37: 20 58 87     JSR $8758       ; error sound effect
01/DB3A: 20 36 83     JSR $8336
01/DB3D: 20 36 8D     JSR $8D36       ; clear bg2 screen buffer
01/DB40: A0 71 E2     LDY #$E271
01/DB43: 20 D9 80     JSR $80D9       ; draw window
01/DB46: A0 79 E2     LDY #$E279
01/DB49: 20 FB 82     JSR $82FB       ; draw window and text
01/DB4C: 20 20 94     JSR $9420       ; transfer bg2 screen buffer to vram
01/DB4F: 38           SEC 
01/DB50: 60           RTS 

; --------------------------------------------------------------------------

01/DB51: 4E 00 04 04
01/DB55: 5C 00 08 04
01/DB59: 02 02 05 11
01/DB5D: 0E 02 16 11
01/DB61: 00 00 16 1A
01/DB65: EA 05 08 03
01/DB69: EC 04 07 02

; main menu options (22,0) 7x11
01/DB6D: 2C 00 07 11
; "" (item)
01/DB71: 70 00 CA CB DC EA 01
; "" (magic)
01/DB78: F0 00 A8 A7 8C FF 01
; "" (equip)
01/DB7F: 70 01 98 8C 20 FF 01
; "" (status)
01/DB86: F0 01 D6 DC C2 D9 D6 01
; "" (order)
01/DB8E: 70 02 9E B0 20 8F 8D 01
; "" (row)
01/DB96: F0 02 99 8B 92 8B 01
; "" (config)
01/DB9D: 70 03 D3 F6 E5 B8 2B 01
; "" (save)
01/DBA5: F0 03 D7 C2 3A 00

; "" (magic)
01/DBAB: F0 00 A8 A7 8C FF 00
; "" (unable to fight)
01/DBB2: 97 B6 9D 8C A5 A2 8C 00

; alphabets for name change menu

; hiragana
01/DBBA: 8A 8B 8C 8D 8E B0 B1 B2 B3 B4
01/DBC4: 8F 90 91 92 93 10 11 12 13 14
01/DBCE: 94 95 96 97 98 15 16 17 18 19
01/DBD8: 99 9A 9B 9C 9D 1A 1B 1C 1D 1E
01/DBE2: 9E 9F A0 A1 A2 1F 20 21 22 23
01/DBEC: A3 A4 A5 A6 A7 24 25 26 27 28
01/DBF6: A8 A9 AA AB AC 7B 7C 7D 7E 7F
01/DC00: AD AE AF B5 B6 00 00 00 00 00

; katakana
01/DC0A: CA CB CC CD CE F0 F1 F2 F3 F4
01/DC14: CF D0 D1 D2 D3 29 2A 2B 2C 2D
01/DC1E: D4 D5 D6 D7 D8 2E 2F 30 31 32
01/DC28: D9 DA DB DC DD 33 34 35 36 37
01/DC32: DE DF E0 E1 E2 38 39 3A 3B 3C
01/DC3C: E3 E4 E5 E6 E7 3D 3E 3F 40 41
01/DC46: E8E9 EA EB EC B7 B8 BA BB BC
01/DC50: ED EE EF F5 F6 BD BE BF 0F 00

; latin
01/DC5A: 42 43 44 45 46 5C 5D 5E 5F 60
01/DC64: 47 48 49 4A 4B 61 62 63 64 65
01/DC6E: 4C 4D 4E 4F 50 66 67 68 69 6A
01/DC78: 51 52 53 54 55 6B 6C 6D 6E 6F
01/DC82: 56 57 58 59 5A 70 71 72 73 74
01/DC8C: 5B 80 81 82 83 75 C4 C5 C6 C7
01/DC96: 84 85 86 87 88 C8 00 00 00 00
01/DCA0: 89 B9 C9 C2 C3 00 00 00 00 00

01/DCAA: 4D 5D 6D BD

; "" (hiragana)
01/DCAE: 46 02 A4 B0 10 9E 01
; "" (katakana)
01/DCB5: C6 02 CF D9 CF DE 01
; ""
01/DCBC: 46 03 42 43 44 01
; "" (end)
01/DCC2: C6 05 8E B5 B1 00

01/DCC8: 0000 0050 00A0

01/DCCE: 02 00 1B 30
01/DCD2: 2C 00 07 03
01/DCD6: 12 00 13 03
01/DCDA: 90 02 0D 02

; "" (not necessary)
01/DCDE: D2 02 98 A2 A4 9B AF 8C A3 FF 8A B1 A8 97 B6 00
; "" (doesn't work)
01/DCEE: D2 02 8C A8 91 8B 8F 9E 8B AF 8C 1D 96 00

01/DCFC: 02 00 07 03
; "" (item)
01/DD00: 46 00 CA CB DC EA 00
; "" (recover hp) *** unused ***
01/DD07: 54 00 49 51 7B 8F 8B A5 91 95 A8 96 00
; "" (use on whom?)
01/DD14: 54 00 1A B3 9F 9B 8F 8B A8 96 8F 00
; "" (can't use here)
01/DD20: 54 00 93 93 1D A3 9B 8F 8D A8 97 B6 00
; "" (nothing here)
01/DD2D: 54 00 9E 9F AC 8A B1 A8 97 B6 00

01/DD38: 42 01 0E 15
01/DD3C: 5C 01 0E 15

01/DD40: 10 02 0A 03
; "" (can't use magic)
01/DD44: 52 02 A8 A7 8C A3 9B 8F 8D A8 97 B6 00

01/DD51: 02 02 1C 11
01/DD55: 02 00 13 07
01/DD59: 42 01 13 07
01/DD5D: 82 02 13 07
01/DD61: C2 03 13 07
01/DD65: 02 05 13 07
01/DD69: AC 00 07 07
01/DD6D: 10 00 15 1A
01/DD71: 02 02 07 03
01/DD75: 02 00 07 07

; "" (mp needed)
01/DD79: 06 01 95 7F 8C A4 4E 51 00
; "" (use on whom!?)
01/DD82: 86 02 1A B3 9F FF C4 C5 00

01/DD8B: DD95 DD99 DD9D DDA1 DDA5

01/DD95: 02 00 1B0B
01/DD99: 42 01 1B 0B
01/DD9D: 82 02 1B 0B
01/DDA1: C2 03 1B 0B
01/DDA5: 02 05 1B 0B

01/DDA9: 02 00 1B 0B
; "" (right hand)
01/DDAD: 5C 00 A9 11 9C 01
; "" (left hand)
01/DDB3: DC 00 A4 1A B1 9C 01
; "" (head)
01/DDBA: 5C 01 8A 99 A8 01
; "" (body)
01/DDC0: DC 01 8F B0 1A 01
; "" (arm)
01/DDC6: 5C 02 8C 1D 00

; "" (inventory full)
01/DDCB: 48 01 AC 9A AC A2 10 8B 7C 24 8B 1D 96 00

01/DDD9: 92 03 0B 06
; "" (item must be equipped with both hands)
; ""
; ""
01/DDDD: D4 03 FF B1 7F 8C 9C 1D FF 9B 8F 8C 01
01/DDEA: 58 04 CA CB DC EA 1D 96 01
01/DDF3: D4 04 A7 8F A3 98 8C 20 1D 90 A8 97 B6 00

01/DE01: 40 00 1D 18
01/DE05: A4 01 0B 04
; "" (status)
01/DE09: F0 01 D6 DC C2 D9 D6 00

; "" (level)
01/DE11: 14 01 F3 3B F2 01
; "" (experience)
01/DE17: A2 01 92 8B 92 B6 9A 01
; ""
01/DE1F: 06 02 49 51 01
; ""
01/DE24: 86 02 4E 51 01
; "" (ability)
01/DE29: 44 03 CA 39 F1 DC B8 C2 01
; "" (strength)
01/DE32: C6 03 9A 8F B0 01
; "" (agility)
01/DE38: 46 04 96 1F AD 94 01
; "" (stamina)
01/DE3F: C6 04 99 8B B1 7F 91 01
; "" (intellect)
01/DE47: 46 05 9A 97 8B 01
; "" (spirit)
01/DE4D: C6 05 97 8B 95 B6 01
; "" (attack)
01/DE54: 5A 03 93 8C 13 90 01
; "" (hit rate)
01/DE5B: DA 03 AB 8B 9A 7E 8C B1 9B 01
; "" (defense)
01/DE65: 5A 04 23 8C 11 7F 01
; "" (evasion rate)
01/DE6C: DA 04 8F 8B A4 B1 9B 01
; "" (magic defense)
01/DE74: 5A 05 A8 A7 8C 23 8C 11 7F 01
; "" (magic evasion rate)
01/DE7E: DA 05 A8 A7 8C 8F 8B A4 B1 9B 01
; "" (multiplier)
01/DE89: 6E 03 8F 8B 01
01/DE8E: 6E 04 8F 8B 01
01/DE93: 6E 05 8F 8B 00

; "" (to next level)
01/DE98: 62 02 9B 11 A2 F3 3B F2 A8 1D FF 8A 9D 00

01/DEA6: 22 01 0B 03
01/DEAA: 02 01 0F 03
01/DEAE: 02 00 06 02
01/DEB2: 10 00 14 02
01/DEB6: 02 02 14 11
01/DEBA: 2C 02 07 0B

; ""
01/DEBE: 21 90 AD FF 00
; ""
01/DEC3: 23 8C 12 AD 00
; ""
01/DEC8: 1E 8C 12 AD 00

; "" (welcome! what is your business?)
01/DECD: 54 00 8B B0 7C 95 7D 8B C4 FF 1E B6 9E 14 AF 8C 92 B6 1D C5 01
; "" (buy sell exit)
01/DEE2: 48 01 8F 8C FF FF FF 8C B2 FF FF FF 1D B2 00

; "" (which do you want)
01/DEF1: 54 00 1E B3 9F 8B 99 95 A8 95 7F 8C C5 01
; "" (how many?)
01/DEFF: 46 01 8B 91 9B C5 FF FF FF 81 00

; "" (gil)
01/DF0A: 76 01 2A F2 00

01/DF0F: 82 02 14 04
; "" (inventory is full)
; ""
01/DF13: C4 02 8E 90 7D 91 94 B6 FF AC 9A AC A2 10 2D DA BD 2D DA BD 1A AF 01
01/DF2A: 44 03 97 8B B1 95 9E 8B 9D FF A3 8B B6 9E 8B AF 00

01/DF3B: 8A 02 10 04
; "" (not enough gil)
; ""
01/DF3F: CC 02 8E 90 7D 91 94 B6 FF 8E 8F A1 10 99 B1 9E 8B AF 01
01/DF52: 4C 03 A4 AD 8F 95 A3 FF93 A8 B1 A8 96 9E 00

01/DF61: 8A 02 0B 02
; "" (thank you)
01/DF65: CC 02 8A B1 10 9D 8C 14 15 8B A8 95 99 00

01/DF73: 92 02 0B 0D
; ""
01/DF78: 5A 03 1D 95 99 B0 01
; "" (gil per item)
01/DF7E: E4 03 2A F2 1D 01
; "" (are you sure?)
01/DF84: 54 04 8E A4 90 9D B1 8B 99 95 A8 96 10 01
; ""
01/DF92: D6 04 AF B4 95 8B 1D 96 8F C5 01
; "" (yes no)
01/DF9D: 58 05 A3 8B FF FF 8B 8B 8D 00

; "" (I'll take most anything)
01/DFA7: 99 8B 9C 8B A2 AC A2 A3 FF 8E A4 90 9D B1 95 A8 96 AF 00

; ""
01/DFBA: 46 59 51 46 4F 45 00

01/DFC1: 00 00 1D 05
01/DFC5: 00 00 10 02

; "" (new game)
01/DFC9: 46 00 DF BE C2 2C C2 EA 00

; "" (battle speed)
01/DFD2: 68 00 38 DD F2 D6 3E C2 37 00

01/DFDC: 2C 00 07 08
01/DFE0: 2C 04 07 05
01/DFE4: EC 05 07 03

; "" (is this data okay?)
; ""
01/DFE8: 6E 00 93 A2 36 C2 D9 1D 01
01/DFF1: EE 00 8B 8B 1D 96 8F C5 00
; "" (yes)
; "" (no)
01/DFFA: 72 01 A3 8B 01
01/DFFF: F2 01 8B 8B 8D 00

; ""
01/E005: 6E 04 55 4A 4E 46 00

; ""
01/E00C: 90 00 46 4E 51 55 5A 00

01/E014: 46 00 D7 C2 3A 00

; "" (save cancelled)
01/E01A: 46 00 D7 C2 3A A3 D0 BD F6 D7 F2 94 B3 A8 95 99 00

; "" (saved)
01/E02B: EE 02 D7 C2 3A 95 A8 95 99 00

; "" (do you want to erase the previous data?)
; ""
01/E035: 6E 00 A8 8D A2 36 C2 D9 7B 01
01/E03F: EE 00 92 95 A8 96 8F C5 00

; "" (cancel)
01/E048: F2 02 D0 BD F6 D7 F2 00

01/E050: AC 02 07 02
01/E054: 42 01 0D 01

; "" (what's your name?)
01/E058: 4E 00 E1 E9 F6 2B CC BA CB FF B9 8E 9E A8 8D A2
01/E068: FF 14 A6 B6 93 8C 1D C5 C9 00

; "" (change who's name?)
01/E072: 4E 00 B9 1E 9E 99 94 A8 10 14 A6 B6 93 8C 9E 94
01/E082: 8B A8 96 8F C5 C9 00

; "" (what's your new name?) *** unused ***
01/E089: 4E 00 B9 1D FF 8A 99 B0 95 8B FF 8E 9E A8 8D A3
01/E099: C5 C9 00

; "" (is that okay?) *** unused ***
01/E09C: 4E 00 B9 1D FF AF B4 95 8B B6 1D 96 A1 C5 C9 00

; "" (change don't change)
01/E0AC: 8F 8D B2 FF FF FF 8F 8D 9E 8B 00
; "" (that's better)
01/E0B7: 4E 00 B9 98 A2 A7 8C 10 AF B4 95 7E 8C 14 15 8B
01/E0C7: A8 96 9E C9 00

01/E0CC: 0C 00 17 02
01/E0D0: 10 01 06 02
01/E0D4: 4C 00 14 02
01/E0D8: 82 02 1B 0F
01/E0DC: 84 01 0C 02

; "" (fat chocobo)
01/E0E0: 8E 00 1D 21 DA BF D3 3C 01
; "" (give take)
01/E0E9: C8 01 8A 17 92 B2 FF FF A4 90 1A 96 00
; "" (what should i do?)
01/E0F6: 9A 00 B9 AF C2 8E FF 9E B6 8F AF 8C 8F C2 8B C9 00
; "" (no need to blow the whistle)
01/E107: 9A 00 B9 93 B6 9E 9D 93 1D E5 CD A5 91 9E AF C9 00
; "" (what will you give me?)
01/E118: 9A 00 FF B9 9E 9F 7B 91 B3 B2 B6 1A C2 8B C9 FF 00
; "" (what do you want?)
01/E129: 9A 00 FF B9 9E 9F 10 A7 95 8B B6 1A C2 8B C9 FF 00
; "" (i can't eat any more)
01/E13A: 9A 00 FF B9 8C C2 B6 FF AC 8C 918D 9E 8B C9 FF 00
; "" (organize your bag)
01/E14B: 9A 00 FF B9 9F AC 9B 7B 97 8B B1 95 9E C2 C9 FF 00

01/E15C: 54 00 07 02

01/E160: 98 00 D3 F6 E5 B8 2B 00

01/E168: 04 01 18 14
; "" (battle mode)
01/E16C: 4A 01 38 DD F2 EC C2 37 01
; "" (wait active)
01/E175: 5E 01 CC CD CB DD FF FF FF CA D1 DC B8 3A 01
; "" (battle speed)
01/E184: CA 01 38 DD F2 D6 3E C2 37 01
; "" (battle message)
01/E18E: 4A 02 38 DD F2 EB BC D7 C2 2F 01
; "" (window color)
01/E19A: CA 04 CC B8 F6 37 CC CF F0 C2 01
; "" (normal custom)
01/E1A4: 5E 03 E2 C2 E8 F2 FF FF FF CF D6 D9 EA 01
; "" (cursor position)
01/E1B2: 4A 04 CF C2 D8 F2 8B 9A 01
; "" (reset memory)
01/E1BB: 5E 04 AC 1E 96 FF FF FF FF 90 8E 91 01
; "" (sound)
01/E1C8: CA 02 D4 CC F6 37 01
; "" (stereo monaural)
01/E1DF: DE 02 D6 DC F3 CE FF FF FF EC E2 F0 F2 01
; "" (fast)
01/E1DD: 1E 02 A3 AD 8B 01
; "" (slow)
01/E1E3: 2E 02 8E 98 8B 01
; "" (single multi)
01/E1E9: DE 03 D5 F6 2B F2 FF FF FF E8 F2 DA 01
; "" (controller)
01/E1F6: 4A 03 D3 F6 DD F4 C2 F0 C2 00

01/E200: C0 01 1C 0C
01/E204: 96 00 CF D6 D9 E8 CB 2E 01
01/E20D: 06 02 92 7C 9C 8B 01
01/E214: 86 02 9A 7E 8C 95 01
01/E21B: 06 03 EB DF BE C2 01
01/E222: 86 03 4D 3C D9 F6 A3 01
01/E22A: 06 04 54 55 42 53 55 01
01/E232: 86 04 8E B5 B1 00

01/E238: AA 95 96 B2 FF 92 7C 9C 8B FF 9A 7E 8C 95 FF EB DF BE C2 00
01/E24C: 42 FF FF 43 FF FF 59 FF FF 5A FF FF 54 46 4D 46 44 55 00

01/E25F: 02 02 1B 06
01/E263: CA 01 14 0B
01/E267: 96 00 3D BC 37 D7 F3 D1 D9 00

01/E271: 10 00 14 02
01/E275: C2 00 1B 0A

01/E279: 02 00 06 02
01/E27D: 46 00 8E 99 8F B0 01
01/E284: 72 00 8E B5 B1 01
01/E28A: 56 00 96 22 9C AC 7C 9C 8B 91 00

01/E295: 56 00 93 8C 8F B6 FF FF FF FF 00

01/E2A0: 90 02 0B 04
01/E2A4: D2 02 16 7E 8C AF 8C 9E CA CB DC EA 10 01
01/E2B2: 54 03 A2 93 7C 9C 8B A8 96 AF 00

; summon item message
01/E2BD: 58 02 07 06  ; (12,9) 7x6
; ""
; ""
01/E2C1: A6 02 A3 01
01/E2C5: 9C 03 7B 8E 23 8D 99 00

; battle speed numerals
; ""
01/E2CD: 81 FF 82 FF 83 FF 84 FF 85 FF 86 00

; character handedness (8 bytes each)
; ""
; ""
; ""
; ""
01/E2D9: 21 90 AF 8C 00 00 00 00
01/E2E1: A4 1A B1 90 90 00 00 00
01/E2E9: A9 11 90 90 00 00 00 00
01/E2F1: B1 7F 8C 90 90 00 00 00

01/E2F9: FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

; [  ]

01/E300: C9 01        CMP #$01
01/E302: F0 05        BEQ $E309
01/E304: C9 02        CMP #$02
01/E306: F0 17        BEQ $E31F
01/E308: 6B           RTL 
01/E309: A9 07        LDA #$07
01/E30B: 8D 1B F1     STA $F11B
01/E30E: A9 05        LDA #$05
01/E310: 8D 1C F1     STA $F11C
01/E313: A9 14        LDA #$14
01/E315: 8D 18 F1     STA $F118
01/E318: 9C 16 F1     STZ $F116
01/E31B: A9 AE        LDA #$AE
01/E31D: 80 16        BRA $E335
01/E31F: A9 03        LDA #$03
01/E321: 8D 1B F1     STA $F11B
01/E324: A9 08        LDA #$08
01/E326: 8D 1C F1     STA $F11C
01/E329: A9 08        LDA #$08
01/E32B: 8D 16 F1     STA $F116
01/E32E: A9 FF        LDA #$FF
01/E330: 8D 18 F1     STA $F118
01/E333: A9 9E        LDA #$9E
01/E335: 22 26 F6 02  JSL $02F626
01/E339: 20 1C E4     JSR $E41C
01/E33C: 22 43 E7 02  JSL $02E743
01/E340: 7B           TDC 
01/E341: AA           TAX 
01/E342: 48           PHA 
01/E343: 20 96 F9     JSR $F996
01/E346: 68           PLA 
01/E347: 18           CLC 
01/E348: 69 20        ADC #$20
01/E34A: E8           INX 
01/E34B: E0 08 00     CPX #$0008
01/E34E: D0 F2        BNE $E342
01/E350: 7B           TDC 
01/E351: 22 59 E7 02  JSL $02E759
01/E355: AD 48 00     LDA $0048
01/E358: 0A           ASL 
01/E359: AA           TAX 
01/E35A: BD 53 F0     LDA $F053,X
01/E35D: 18           CLC 
01/E35E: 69 10        ADC #$10
01/E360: 8D 11 F1     STA $F111
01/E363: BD 54 F0     LDA $F054,X
01/E366: 38           SEC 
01/E367: E9 08        SBC #$08
01/E369: 8D 12 F1     STA $F112
01/E36C: 9C 15 F1     STZ $F115
01/E36F: 9C 14 F1     STZ $F114
01/E372: 9C 17 F1     STZ $F117
01/E375: 20 09 EE     JSR $EE09       ; wait one frame
01/E378: 20 BD E3     JSR $E3BD
01/E37B: 22 95 F6 02  JSL $02F695
01/E37F: AD 17 F1     LDA $F117
01/E382: CD 18 F1     CMP $F118
01/E385: F0 0A        BEQ $E391
01/E387: AD 17 F1     LDA $F117
01/E38A: 22 59 E7 02  JSL $02E759
01/E38E: EE 17 F1     INC $F117
01/E391: AD 16 F1     LDA $F116
01/E394: D0 0D        BNE $E3A3
01/E396: 7B           TDC 
01/E397: AA           TAX 
01/E398: A9 04        LDA #$04
01/E39A: 20 96 F9     JSR $F996
01/E39D: E8           INX 
01/E39E: E0 08 00     CPX #$0008
01/E3A1: D0 F5        BNE $E398
01/E3A3: EE 14 F1     INC $F114
01/E3A6: AD 14 F1     LDA $F114
01/E3A9: 2D 1B F1     AND $F11B
01/E3AC: D0 03        BNE $E3B1
01/E3AE: EE 15 F1     INC $F115
01/E3B1: AD 15 F1     LDA $F115
01/E3B4: CD 1C F1     CMP $F11C
01/E3B7: D0 BC        BNE $E375
01/E3B9: 20 1C E4     JSR $E41C
01/E3BC: 6B           RTL 

; [  ]

01/E3BD: 7B           TDC 
01/E3BE: AA           TAX 
01/E3BF: A8           TAY 
01/E3C0: 20 75 F9     JSR $F975
01/E3C3: 18           CLC 
01/E3C4: 6D 11 F1     ADC $F111
01/E3C7: 85 00        STA $00
01/E3C9: 20 65 F9     JSR $F965
01/E3CC: 18           CLC 
01/E3CD: 6D 12 F1     ADC $F112
01/E3D0: 85 02        STA $02
01/E3D2: DA           PHX 
01/E3D3: AD 15 F1     LDA $F115
01/E3D6: 18           CLC 
01/E3D7: 6D 16 F1     ADC $F116
01/E3DA: AA           TAX 
01/E3DB: BF 1C F8 0D  LDA $0DF81C,X
01/E3DF: 85 04        STA $04
01/E3E1: BF 0C F8 0D  LDA $0DF80C,X
01/E3E5: FA           PLX 
01/E3E6: 20 F0 E3     JSR $E3F0
01/E3E9: E8           INX 
01/E3EA: E0 08 00     CPX #$0008
01/E3ED: D0 D1        BNE $E3C0
01/E3EF: 60           RTS 

; [  ]

01/E3F0: 99 42 03     STA $0342,Y
01/E3F3: A5 02        LDA $02
01/E3F5: 99 41 03     STA $0341,Y
01/E3F8: AD C0 6C     LDA $6CC0
01/E3FB: D0 09        BNE $E406
01/E3FD: A5 00        LDA $00
01/E3FF: 99 40 03     STA $0340,Y
01/E402: A5 04        LDA $04
01/E404: 80 0E        BRA $E414
01/E406: A5 00        LDA $00
01/E408: 49 FF        EOR #$FF
01/E40A: 38           SEC 
01/E40B: E9 10        SBC #$10
01/E40D: 99 40 03     STA $0340,Y
01/E410: A5 04        LDA $04
01/E412: 49 40        EOR #$40
01/E414: 99 43 03     STA $0343,Y
01/E417: C8           INY 
01/E418: C8           INY 
01/E419: C8           INY 
01/E41A: C8           INY 
01/E41B: 60           RTS 

; [  ]

01/E41C: 22 03 E7 02  JSL $02E703
01/E420: 60           RTS 

; [  ]

01/E421: AD C4 34     LDA $34C4
01/E424: 8D 85 F4     STA $F485
01/E427: A9 65        LDA #$65
01/E429: 22 D7 F5 02  JSL $02F5D7
01/E42D: 22 C1 EE 01  JSL $01EEC1
01/E431: A9 02        LDA #$02
01/E433: 8D 87 EF     STA $EF87
01/E436: 20 1C E4     JSR $E41C
01/E439: 7B           TDC 
01/E43A: 8D 33 F1     STA $F133
01/E43D: A9 80        LDA #$80
01/E43F: 8D 34 F1     STA $F134
01/E442: A9 28        LDA #$28
01/E444: 8D B3 F1     STA $F1B3
01/E447: 8D B4 F1     STA $F1B4
01/E44A: AD 48 00     LDA $0048
01/E44D: 0A           ASL 
01/E44E: AA           TAX 
01/E44F: A9 48        LDA #$48
01/E451: 8D 14 F1     STA $F114
01/E454: AD C2 34     LDA $34C2
01/E457: 30 17        BMI $E470
01/E459: 9C 84 F4     STZ $F484
01/E45C: BD 53 F0     LDA $F053,X
01/E45F: 8D 11 F1     STA $F111
01/E462: BD 54 F0     LDA $F054,X
01/E465: 38           SEC 
01/E466: E9 08        SBC #$08
01/E468: 8D 12 F1     STA $F112
01/E46B: 9C 13 F1     STZ $F113
01/E46E: 80 19        BRA $E489
01/E470: A9 40        LDA #$40
01/E472: 8D 84 F4     STA $F484
01/E475: BD 43 F0     LDA $F043,X
01/E478: 8D 11 F1     STA $F111
01/E47B: BD 44 F0     LDA $F044,X
01/E47E: 38           SEC 
01/E47F: E9 0C        SBC #$0C
01/E481: 8D 12 F1     STA $F112
01/E484: A9 F8        LDA #$F8
01/E486: 8D 13 F1     STA $F113
01/E489: A9 08        LDA #$08
01/E48B: 8D 15 F1     STA $F115
01/E48E: 22 BC E7 02  JSL $02E7BC
01/E492: 20 09 EE     JSR $EE09       ; wait one frame
01/E495: 20 E4 E4     JSR $E4E4
01/E498: 22 5C E8 02  JSL $02E85C
01/E49C: B0 29        BCS $E4C7
01/E49E: AD 18 F1     LDA $F118
01/E4A1: 85 00        STA $00
01/E4A3: AD 19 F1     LDA $F119
01/E4A6: 85 02        STA $02
01/E4A8: 7B           TDC 
01/E4A9: A8           TAY 
01/E4AA: 5A           PHY 
01/E4AB: A9 84        LDA #$84
01/E4AD: 20 0B E5     JSR $E50B
01/E4B0: A0 0C 00     LDY #$000C
01/E4B3: FA           PLX 
01/E4B4: A9 84        LDA #$84
01/E4B6: 20 CF E4     JSR $E4CF
01/E4B9: A0 18 00     LDY #$0018
01/E4BC: A2 01 00     LDX #$0001
01/E4BF: A9 84        LDA #$84
01/E4C1: 20 CF E4     JSR $E4CF
01/E4C4: 4C 92 E4     JMP $E492
01/E4C7: 22 2A F6 02  JSL $02F62A
01/E4CB: 9C 87 EF     STZ $EF87
01/E4CE: 6B           RTL 

; [  ]

01/E4CF: 48           PHA 
01/E4D0: 5A           PHY 
01/E4D1: A9 10        LDA #$10
01/E4D3: 20 96 F9     JSR $F996
01/E4D6: 20 65 F9     JSR $F965
01/E4D9: 18           CLC 
01/E4DA: 6D 19 F1     ADC $F119
01/E4DD: 85 02        STA $02
01/E4DF: 7A           PLY 
01/E4E0: 68           PLA 
01/E4E1: 4C 0B E5     JMP $E50B

; [  ]

01/E4E4: A0 1C 00     LDY #$001C
01/E4E7: C2 20        REP #$20
01/E4E9: B9 40 03     LDA $0340,Y
01/E4EC: 99 44 03     STA $0344,Y
01/E4EF: B9 42 03     LDA $0342,Y
01/E4F2: 18           CLC 
01/E4F3: 69 02 00     ADC #$0002
01/E4F6: 99 46 03     STA $0346,Y
01/E4F9: 88           DEY 
01/E4FA: 88           DEY 
01/E4FB: 88           DEY 
01/E4FC: 88           DEY 
01/E4FD: C0 FC FF     CPY #$FFFC
01/E500: D0 E7        BNE $E4E9
01/E502: 7B           TDC 
01/E503: E2 20        SEP #$20
01/E505: 60           RTS 

; [  ]

01/E506: 9C 84 F4     STZ $F484
01/E509: A9 82        LDA #$82
01/E50B: 99 42 03     STA $0342,Y
01/E50E: A5 02        LDA $02
01/E510: 99 41 03     STA $0341,Y
01/E513: AD C0 6C     LDA $6CC0
01/E516: D0 09        BNE $E521
01/E518: A5 00        LDA $00
01/E51A: 99 40 03     STA $0340,Y
01/E51D: A9 3F        LDA #$3F
01/E51F: 80 09        BRA $E52A
01/E521: A5 00        LDA $00
01/E523: 49 FF        EOR #$FF
01/E525: 99 40 03     STA $0340,Y
01/E528: A9 7F        LDA #$7F
01/E52A: 4D 84 F4     EOR $F484
01/E52D: 99 43 03     STA $0343,Y
01/E530: C8           INY 
01/E531: C8           INY 
01/E532: C8           INY 
01/E533: C8           INY 
01/E534: 60           RTS 

; [  ]

01/E535: 20 3B E5     JSR $E53B
01/E538: 4C 59 E5     JMP $E559

; [  ]

01/E53B: A0 40 00     LDY #$0040
01/E53E: C2 20        REP #$20
01/E540: B9 40 03     LDA $0340,Y
01/E543: 99 44 03     STA $0344,Y
01/E546: B9 42 03     LDA $0342,Y
01/E549: 99 46 03     STA $0346,Y
01/E54C: 88           DEY 
01/E54D: 88           DEY 
01/E54E: 88           DEY 
01/E54F: 88           DEY 
01/E550: C0 FC FF     CPY #$FFFC
01/E553: D0 EB        BNE $E540
01/E555: 7B           TDC 
01/E556: E2 20        SEP #$20
01/E558: 60           RTS 

; [  ]

01/E559: 7B           TDC 
01/E55A: A8           TAY 
01/E55B: C2 20        REP #$20
01/E55D: B9 40 03     LDA $0340,Y
01/E560: 49 FF 00     EOR #$00FF
01/E563: 99 80 03     STA $0380,Y
01/E566: B9 42 03     LDA $0342,Y
01/E569: 99 82 03     STA $0382,Y
01/E56C: C8           INY 
01/E56D: C8           INY 
01/E56E: C8           INY 
01/E56F: C8           INY 
01/E570: C0 40 00     CPY #$0040
01/E573: D0 E8        BNE $E55D
01/E575: 7B           TDC 
01/E576: E2 20        SEP #$20
01/E578: 60           RTS 

; [  ]

01/E579: 20 1C E4     JSR $E41C
01/E57C: 22 43 E7 02  JSL $02E743
01/E580: A9 10        LDA #$10
01/E582: 8D B3 F1     STA $F1B3
01/E585: 8D F3 F1     STA $F1F3
01/E588: 7B           TDC 
01/E589: 8D 98 F3     STA $F398
01/E58C: A9 30        LDA #$30
01/E58E: 8D 99 F3     STA $F399
01/E591: 20 CF E9     JSR $E9CF
01/E594: 20 8F EE     JSR $EE8F
01/E597: 20 09 EE     JSR $EE09       ; wait one frame
01/E59A: 20 35 E5     JSR $E535
01/E59D: 7B           TDC 
01/E59E: AA           TAX 
01/E59F: 20 65 F9     JSR $F965
01/E5A2: 18           CLC 
01/E5A3: 6D 99 F3     ADC $F399
01/E5A6: 85 02        STA $02
01/E5A8: AD 98 F3     LDA $F398
01/E5AB: 85 00        STA $00
01/E5AD: 7B           TDC 
01/E5AE: AA           TAX 
01/E5AF: A9 20        LDA #$20
01/E5B1: 20 96 F9     JSR $F996
01/E5B4: A0 00 00     LDY #$0000
01/E5B7: 7B           TDC 
01/E5B8: 20 06 E5     JSR $E506
01/E5BB: CE 99 F3     DEC $F399
01/E5BE: CE 99 F3     DEC $F399
01/E5C1: AD 98 F3     LDA $F398
01/E5C4: 38           SEC 
01/E5C5: E9 08        SBC #$08
01/E5C7: 8D 98 F3     STA $F398
01/E5CA: C9 80        CMP #$80
01/E5CC: D0 C9        BNE $E597
01/E5CE: A9 C0        LDA #$C0
01/E5D0: 8D 33 F1     STA $F133
01/E5D3: 18           CLC 
01/E5D4: 69 40        ADC #$40
01/E5D6: 8D 73 F1     STA $F173
01/E5D9: A9 20        LDA #$20
01/E5DB: 8D B3 F1     STA $F1B3
01/E5DE: 8D F3 F1     STA $F1F3
01/E5E1: A9 80        LDA #$80
01/E5E3: 8D 98 F3     STA $F398
01/E5E6: A9 08        LDA #$08
01/E5E8: 8D 99 F3     STA $F399
01/E5EB: 20 09 EE     JSR $EE09       ; wait one frame
01/E5EE: 20 35 E5     JSR $E535
01/E5F1: 7B           TDC 
01/E5F2: AA           TAX 
01/E5F3: 20 75 F9     JSR $F975
01/E5F6: 18           CLC 
01/E5F7: 6D 98 F3     ADC $F398
01/E5FA: 85 00        STA $00
01/E5FC: 20 65 F9     JSR $F965
01/E5FF: 18           CLC 
01/E600: 6D 99 F3     ADC $F399
01/E603: 85 02        STA $02
01/E605: 7B           TDC 
01/E606: A8           TAY 
01/E607: 20 06 E5     JSR $E506
01/E60A: 7B           TDC 
01/E60B: AA           TAX 
01/E60C: A9 20        LDA #$20
01/E60E: 20 96 F9     JSR $F996
01/E611: AD B3 F1     LDA $F1B3
01/E614: C9 08        CMP #$08
01/E616: 90 09        BCC $E621
01/E618: 7B           TDC 
01/E619: AA           TAX 
01/E61A: 3A           DEC 
01/E61B: 20 85 F9     JSR $F985
01/E61E: 4C EB E5     JMP $E5EB
01/E621: 7B           TDC 
01/E622: AA           TAX 
01/E623: AD 63 F4     LDA $F463
01/E626: 85 04        STA $04
01/E628: 06 04        ASL $04
01/E62A: 90 1B        BCC $E647
01/E62C: AD 62 F4     LDA $F462
01/E62F: 30 0A        BMI $E63B
01/E631: BD 53 F0     LDA $F053,X
01/E634: 85 00        STA $00
01/E636: BD 54 F0     LDA $F054,X
01/E639: 80 08        BRA $E643
01/E63B: BD 43 F0     LDA $F043,X
01/E63E: 85 00        STA $00
01/E640: BD 44 F0     LDA $F044,X
01/E643: 85 01        STA $01
01/E645: 80 07        BRA $E64E
01/E647: E8           INX 
01/E648: E8           INX 
01/E649: E0 10 00     CPX #$0010
01/E64C: D0 DA        BNE $E628
01/E64E: A9 08        LDA #$08
01/E650: 8D 12 F1     STA $F112
01/E653: A5 00        LDA $00
01/E655: C9 80        CMP #$80
01/E657: 90 04        BCC $E65D
01/E659: A9 58        LDA #$58
01/E65B: 80 02        BRA $E65F
01/E65D: A9 A8        LDA #$A8
01/E65F: 8D 11 F1     STA $F111
01/E662: A6 00        LDX $00
01/E664: 8E 13 F1     STX $F113
01/E667: A9 10        LDA #$10
01/E669: 8D 15 F1     STA $F115
01/E66C: 22 BC E7 02  JSL $02E7BC
01/E670: 20 09 EE     JSR $EE09       ; wait one frame
01/E673: 20 3B E5     JSR $E53B
01/E676: 22 5C E8 02  JSL $02E85C
01/E67A: B0 1C        BCS $E698
01/E67C: 64 01        STZ $01
01/E67E: 64 03        STZ $03
01/E680: AD 18 F1     LDA $F118
01/E683: 38           SEC 
01/E684: E9 08        SBC #$08
01/E686: 85 00        STA $00
01/E688: AD 19 F1     LDA $F119
01/E68B: 38           SEC 
01/E68C: E9 08        SBC #$08
01/E68E: 85 02        STA $02
01/E690: 7B           TDC 
01/E691: A8           TAY 
01/E692: 20 06 E5     JSR $E506
01/E695: 4C 70 E6     JMP $E670
01/E698: 9C 87 EF     STZ $EF87
01/E69B: 6B           RTL 

; [  ]

01/E69C: AD E2 38     LDA $38E2
01/E69F: F0 56        BEQ $E6F7
01/E6A1: AD 66 F4     LDA $F466
01/E6A4: 30 51        BMI $E6F7
01/E6A6: 20 1C E4     JSR $E41C
01/E6A9: 64 4E        STZ $4E
01/E6AB: 7B           TDC 
01/E6AC: A8           TAY 
01/E6AD: B9 99 F0     LDA $F099,Y
01/E6B0: 99 9E F0     STA $F09E,Y
01/E6B3: C8           INY 
01/E6B4: C0 05 00     CPY #$0005
01/E6B7: D0 F4        BNE $E6AD
01/E6B9: 20 09 EE     JSR $EE09       ; wait one frame
01/E6BC: AD 67 F4     LDA $F467
01/E6BF: 85 00        STA $00
01/E6C1: 7B           TDC 
01/E6C2: A8           TAY 
01/E6C3: 06 00        ASL $00
01/E6C5: 90 14        BCC $E6DB
01/E6C7: A9 07        LDA #$07
01/E6C9: 99 99 F0     STA $F099,Y
01/E6CC: 98           TYA 
01/E6CD: 0A           ASL 
01/E6CE: 0A           ASL 
01/E6CF: 0A           ASL 
01/E6D0: 0A           ASL 
01/E6D1: AA           TAX 
01/E6D2: A5 4E        LDA $4E
01/E6D4: 29 04        AND #$04
01/E6D6: 49 04        EOR #$04
01/E6D8: 9D C7 EF     STA $EFC7,X
01/E6DB: C8           INY 
01/E6DC: C0 05 00     CPY #$0005
01/E6DF: D0 E2        BNE $E6C3
01/E6E1: E6 4E        INC $4E
01/E6E3: A5 4E        LDA $4E
01/E6E5: C9 10        CMP #$10
01/E6E7: D0 D0        BNE $E6B9
01/E6E9: 7B           TDC 
01/E6EA: A8           TAY 
01/E6EB: B9 9E F0     LDA $F09E,Y
01/E6EE: 99 99 F0     STA $F099,Y
01/E6F1: C8           INY 
01/E6F2: C0 05 00     CPY #$0005
01/E6F5: D0 F4        BNE $E6EB
01/E6F7: 6B           RTL 

; [  ]

01/E6F8: DA           PHX 
01/E6F9: AD C0 6C     LDA $6CC0
01/E6FC: F0 17        BEQ $E715
01/E6FE: A5 01        LDA $01
01/E700: 18           CLC 
01/E701: 69 0F        ADC #$0F
01/E703: 10 07        BPL $E70C
01/E705: 18           CLC 
01/E706: 65 00        ADC $00
01/E708: 90 1B        BCC $E725
01/E70A: 80 05        BRA $E711
01/E70C: 18           CLC 
01/E70D: 65 00        ADC $00
01/E70F: B0 14        BCS $E725
01/E711: 49 FF        EOR #$FF
01/E713: 80 1A        BRA $E72F
01/E715: A5 01        LDA $01
01/E717: 10 07        BPL $E720
01/E719: 18           CLC 
01/E71A: 65 00        ADC $00
01/E71C: 90 07        BCC $E725
01/E71E: 80 0F        BRA $E72F
01/E720: 18           CLC 
01/E721: 65 00        ADC $00
01/E723: 90 0A        BCC $E72F
01/E725: A9 F0        LDA #$F0
01/E727: 99 40 03     STA $0340,Y
01/E72A: 99 41 03     STA $0341,Y
01/E72D: 80 2F        BRA $E75E
01/E72F: 99 40 03     STA $0340,Y
01/E732: A5 02        LDA $02
01/E734: 18           CLC 
01/E735: 65 03        ADC $03
01/E737: 99 41 03     STA $0341,Y
01/E73A: A5 04        LDA $04
01/E73C: 29 60        AND #$60
01/E73E: 4A           LSR 
01/E73F: 4A           LSR 
01/E740: 4A           LSR 
01/E741: 4A           LSR 
01/E742: AA           TAX 
01/E743: BF E6 FF 16  LDA $16FFE6,X
01/E747: 99 42 03     STA $0342,Y
01/E74A: BF E7 FF 16  LDA $16FFE7,X
01/E74E: 45 05        EOR $05
01/E750: 48           PHA 
01/E751: AD C0 6C     LDA $6CC0
01/E754: F0 04        BEQ $E75A
01/E756: 68           PLA 
01/E757: 49 40        EOR #$40
01/E759: 48           PHA 
01/E75A: 68           PLA 
01/E75B: 99 43 03     STA $0343,Y
01/E75E: C8           INY 
01/E75F: C8           INY 
01/E760: C8           INY 
01/E761: C8           INY 
01/E762: FA           PLX 
01/E763: 60           RTS 

; [  ]

01/E764: A5 00        LDA $00
01/E766: 48           PHA 
01/E767: A5 00        LDA $00
01/E769: 38           SEC 
01/E76A: E9 10        SBC #$10
01/E76C: 85 00        STA $00
01/E76E: 20 75 F9     JSR $F975
01/E771: 85 01        STA $01
01/E773: 20 65 F9     JSR $F965
01/E776: 85 03        STA $03
01/E778: BD 73 F1     LDA $F173,X
01/E77B: 85 04        STA $04
01/E77D: 64 05        STZ $05
01/E77F: 20 F8 E6     JSR $E6F8
01/E782: A5 00        LDA $00
01/E784: 18           CLC 
01/E785: 69 20        ADC #$20
01/E787: 85 00        STA $00
01/E789: A5 01        LDA $01
01/E78B: 49 FF        EOR #$FF
01/E78D: 85 01        STA $01
01/E78F: A9 40        LDA #$40
01/E791: 85 05        STA $05
01/E793: 20 F8 E6     JSR $E6F8
01/E796: 68           PLA 
01/E797: 85 00        STA $00
01/E799: 60           RTS 

; [  ]

01/E79A: 8D 3D F1     STA $F13D
01/E79D: 20 1C E4     JSR $E41C
01/E7A0: 22 43 E7 02  JSL $02E743
01/E7A4: 7B           TDC 
01/E7A5: AA           TAX 
01/E7A6: BF EE FF 16  LDA $16FFEE,X
01/E7AA: 9D B3 F1     STA $F1B3,X
01/E7AD: BF F2 FF 16  LDA $16FFF2,X
01/E7B1: 9D F3 F1     STA $F1F3,X
01/E7B4: A9 FC        LDA #$FC
01/E7B6: 20 96 F9     JSR $F996
01/E7B9: E8           INX 
01/E7BA: E0 04 00     CPX #$0004
01/E7BD: D0 E7        BNE $E7A6
01/E7BF: 20 09 EE     JSR $EE09       ; wait one frame
01/E7C2: 7B           TDC 
01/E7C3: A8           TAY 
01/E7C4: AA           TAX 
01/E7C5: AD 3D F1     LDA $F13D
01/E7C8: 85 0A        STA $0A
01/E7CA: 06 0A        ASL $0A
01/E7CC: 90 2D        BCC $E7FB
01/E7CE: AD 3E F1     LDA $F13E
01/E7D1: 30 0D        BMI $E7E0
01/E7D3: BD 53 F0     LDA $F053,X
01/E7D6: 18           CLC 
01/E7D7: 69 10        ADC #$10
01/E7D9: 85 00        STA $00
01/E7DB: BD 54 F0     LDA $F054,X
01/E7DE: 80 0B        BRA $E7EB
01/E7E0: BD 43 F0     LDA $F043,X
01/E7E3: 38           SEC 
01/E7E4: E9 0C        SBC #$0C
01/E7E6: 85 00        STA $00
01/E7E8: BD 44 F0     LDA $F044,X
01/E7EB: 85 02        STA $02
01/E7ED: DA           PHX 
01/E7EE: A2 00 00     LDX #$0000
01/E7F1: 20 64 E7     JSR $E764
01/E7F4: E8           INX 
01/E7F5: E0 04 00     CPX #$0004
01/E7F8: D0 F7        BNE $E7F1
01/E7FA: FA           PLX 
01/E7FB: E8           INX 
01/E7FC: E8           INX 
01/E7FD: E0 10 00     CPX #$0010
01/E800: D0 C8        BNE $E7CA
01/E802: 7B           TDC 
01/E803: AA           TAX 
01/E804: BF 19 E8 01  LDA $01E819,X
01/E808: 20 96 F9     JSR $F996
01/E80B: E8           INX 
01/E80C: E0 04 00     CPX #$0004
01/E80F: D0 F3        BNE $E804
01/E811: AD 33 F1     LDA $F133
01/E814: C9 80        CMP #$80
01/E816: B0 A7        BCS $E7BF
01/E818: 6B           RTL 

01/E819: FC FD FC FD

01/E81D: E6 97        INC $97
01/E81F: A5 97        LDA $97
01/E821: A8           TAY 
01/E822: B9 00 19     LDA $1900,Y     ; rng table
01/E825: 60           RTS 

; [  ]

01/E826: DA           PHX 
01/E827: 7B           TDC 
01/E828: AA           TAX 
01/E829: 46 04        LSR $04
01/E82B: 90 27        BCC $E854
01/E82D: 20 1D E8     JSR $E81D
01/E830: 29 07        AND #$07
01/E832: 18           CLC 
01/E833: 7F F6 FF 16  ADC $16FFF6,X
01/E837: 85 00        STA $00
01/E839: 20 1D E8     JSR $E81D
01/E83C: 29 1F        AND #$1F
01/E83E: 7F F7 FF 16  ADC $16FFF7,X
01/E842: 85 01        STA $01
01/E844: A5 00        LDA $00
01/E846: 38           SEC 
01/E847: E9 08        SBC #$08
01/E849: 9D 59 F4     STA $F459,X
01/E84C: A5 01        LDA $01
01/E84E: 38           SEC 
01/E84F: E9 08        SBC #$08
01/E851: 9D 5A F4     STA $F45A,X
01/E854: E8           INX 
01/E855: E8           INX 
01/E856: E0 08 00     CPX #$0008
01/E859: D0 CE        BNE $E829
01/E85B: FA           PLX 
01/E85C: 6B           RTL 

; [  ]

01/E85D: AD 58 F4     LDA $F458
01/E860: AA           TAX 
01/E861: DA           PHX 
01/E862: BF 00 F9 13  LDA $13F900,X
01/E866: 85 04        STA $04
01/E868: 22 26 E8 01  JSL $01E826
01/E86C: FA           PLX 
01/E86D: DA           PHX 
01/E86E: BF 00 FB 16  LDA $16FB00,X
01/E872: AA           TAX 
01/E873: 7B           TDC 
01/E874: A8           TAY 
01/E875: BF 09 FB 16  LDA $16FB09,X
01/E879: 99 B0 F3     STA $F3B0,Y
01/E87C: E8           INX 
01/E87D: C8           INY 
01/E87E: C0 12 00     CPY #$0012
01/E881: D0 F2        BNE $E875
01/E883: FA           PLX 
01/E884: BF A6 FA 16  LDA $16FAA6,X
01/E888: AA           TAX 
01/E889: 7B           TDC 
01/E88A: A8           TAY 
01/E88B: BF AF FA 16  LDA $16FAAF,X
01/E88F: 0A           ASL 
01/E890: DA           PHX 
01/E891: AA           TAX 
01/E892: B9 B0 F3     LDA $F3B0,Y
01/E895: 18           CLC 
01/E896: 7D 59 F4     ADC $F459,X
01/E899: 99 B0 F3     STA $F3B0,Y
01/E89C: B9 B1 F3     LDA $F3B1,Y
01/E89F: 18           CLC 
01/E8A0: 7D 5A F4     ADC $F45A,X
01/E8A3: 99 B1 F3     STA $F3B1,Y
01/E8A6: FA           PLX 
01/E8A7: E8           INX 
01/E8A8: C8           INY 
01/E8A9: C8           INY 
01/E8AA: C0 12 00     CPY #$0012
01/E8AD: D0 DC        BNE $E88B
01/E8AF: EE 58 F4     INC $F458
01/E8B2: AD 58 F4     LDA $F458
01/E8B5: C9 09        CMP #$09
01/E8B7: D0 03        BNE $E8BC
01/E8B9: 9C 58 F4     STZ $F458
01/E8BC: 6B           RTL 

; [ load battle bg tilemap ]

01/E8BD: AD 02 18     LDA $1802       ; battle bg id
01/E8C0: 29 1F        AND #$1F
01/E8C2: 48           PHA 
01/E8C3: 0A           ASL 
01/E8C4: 0A           ASL 
01/E8C5: AA           TAX 
01/E8C6: BF CE FC 0D  LDA $0DFCCE,X
01/E8CA: 85 06        STA $06
01/E8CC: BF CD FC 0D  LDA $0DFCCD,X
01/E8D0: 20 0C E9     JSR $E90C       ; load lower battle bg tilemap
01/E8D3: 7B           TDC 
01/E8D4: A8           TAY 
01/E8D5: BF CB FC 0D  LDA $0DFCCB,X
01/E8D9: DA           PHX 
01/E8DA: 20 05 E9     JSR $E905       ; get pointer to upper battle bg tilemap
01/E8DD: 20 58 E9     JSR $E958       ; load upper battle bg tilemap
01/E8E0: FA           PLX 
01/E8E1: BF CC FC 0D  LDA $0DFCCC,X
01/E8E5: F0 06        BEQ $E8ED
01/E8E7: 20 05 E9     JSR $E905       ; get pointer to upper battle bg tilemap
01/E8EA: 20 58 E9     JSR $E958       ; load upper battle bg tilemap
01/E8ED: 68           PLA 
01/E8EE: C9 10        CMP #$10
01/E8F0: D0 12        BNE $E904       ; branch if not final boss
01/E8F2: A2 00 00     LDX #$0000
01/E8F5: BD 7E 70     LDA $707E,X     ; toggle horizontal flip
01/E8F8: 09 20        ORA #$20
01/E8FA: 9D 7E 70     STA $707E,X
01/E8FD: E8           INX 
01/E8FE: E8           INX 
01/E8FF: E0 40 04     CPX #$0440
01/E902: D0 F1        BNE $E8F5
01/E904: 6B           RTL 

; [ get pointer to upper battle bg tilemap ]

01/E905: 85 27        STA $27         ; multiply by 256
01/E907: 64 26        STZ $26
01/E909: A6 26        LDX $26
01/E90B: 60           RTS 

; [ load lower battle bg tilemap ]

01/E90C: DA           PHX 
01/E90D: C2 20        REP #$20
01/E90F: 0A           ASL 
01/E910: 0A           ASL 
01/E911: 0A           ASL 
01/E912: 0A           ASL 
01/E913: 0A           ASL 
01/E914: 0A           ASL 
01/E915: 18           CLC 
01/E916: 69 80 F8     ADC #$F880
01/E919: 85 00        STA $00
01/E91B: 7B           TDC 
01/E91C: E2 20        SEP #$20
01/E91E: A9 16        LDA #$16
01/E920: 85 02        STA $02
01/E922: 7B           TDC 
01/E923: AA           TAX 
01/E924: A8           TAY 
01/E925: B7 00        LDA [$00],Y
01/E927: 85 04        STA $04
01/E929: 29 80        AND #$80
01/E92B: 85 05        STA $05
01/E92D: A5 04        LDA $04
01/E92F: 29 3F        AND #$3F
01/E931: 1A           INC 
01/E932: 18           CLC 
01/E933: 65 06        ADC $06
01/E935: 9D FD 6E     STA $6EFD,X
01/E938: E8           INX 
01/E939: A5 04        LDA $04
01/E93B: 29 40        AND #$40
01/E93D: 4A           LSR 
01/E93E: 4A           LSR 
01/E93F: 4A           LSR 
01/E940: 4A           LSR 
01/E941: 18           CLC 
01/E942: 69 04        ADC #$04
01/E944: 09 02        ORA #$02
01/E946: 05 05        ORA $05
01/E948: 9D FD 6E     STA $6EFD,X
01/E94B: E8           INX 
01/E94C: C8           INY 
01/E94D: 98           TYA 
01/E94E: 29 3F        AND #$3F
01/E950: A8           TAY 
01/E951: E0 80 02     CPX #$0280      ; load 320 tiles (10 rows)
01/E954: D0 CF        BNE $E925
01/E956: FA           PLX 
01/E957: 60           RTS 

; [ load upper battle bg tilemap ]

01/E958: A9 00        LDA #$00        ; load 256 tiles (8 rows)
01/E95A: 85 04        STA $04
01/E95C: BF 80 ED 16  LDA $16ED80,X   ; upper battle background tilemap
01/E960: 85 02        STA $02
01/E962: 29 80        AND #$80
01/E964: 85 03        STA $03         ; vertical flip
01/E966: A5 02        LDA $02
01/E968: 29 3F        AND #$3F        ; tile index
01/E96A: 1A           INC 
01/E96B: 99 FD 6C     STA $6CFD,Y     ; vram buffer
01/E96E: C8           INY 
01/E96F: A5 02        LDA $02
01/E971: 29 40        AND #$40        ; palette (1 or 2)
01/E973: 4A           LSR 
01/E974: 4A           LSR 
01/E975: 4A           LSR 
01/E976: 4A           LSR 
01/E977: 18           CLC 
01/E978: 69 04        ADC #$04
01/E97A: 09 02        ORA #$02
01/E97C: 05 03        ORA $03
01/E97E: 99 FD 6C     STA $6CFD,Y
01/E981: C8           INY 
01/E982: E8           INX 
01/E983: C6 04        DEC $04
01/E985: D0 D5        BNE $E95C
01/E987: 60           RTS 

; [ update monster rows ]

01/E988: 7B           TDC 
01/E989: AA           TAX 
01/E98A: A9 80        LDA #$80
01/E98C: 9D EB 35     STA $35EB,X
01/E98F: E8           INX 
01/E990: E0 08 00     CPX #$0008
01/E993: D0 F7        BNE $E98C
01/E995: 7B           TDC 
01/E996: AA           TAX 
01/E997: BD 33 F3     LDA $F333,X
01/E99A: A8           TAY 
01/E99B: B9 23 F1     LDA $F123,Y
01/E99E: C9 FF        CMP #$FF
01/E9A0: D0 06        BNE $E9A8
01/E9A2: E8           INX 
01/E9A3: E0 08 00     CPX #$0008
01/E9A6: D0 EF        BNE $E997
01/E9A8: BD 33 F3     LDA $F333,X
01/E9AB: 20 69 EA     JSR $EA69
01/E9AE: A5 00        LDA $00
01/E9B0: 85 02        STA $02
01/E9B2: 7B           TDC 
01/E9B3: AA           TAX 
01/E9B4: BD 23 F1     LDA $F123,X
01/E9B7: C9 FF        CMP #$FF
01/E9B9: F0 0D        BEQ $E9C8
01/E9BB: 8A           TXA 
01/E9BC: 20 69 EA     JSR $EA69
01/E9BF: 3A           DEC 
01/E9C0: C5 02        CMP $02
01/E9C2: 90 04        BCC $E9C8
01/E9C4: 7B           TDC 
01/E9C5: 9D EB 35     STA $35EB,X
01/E9C8: E8           INX 
01/E9C9: E0 08 00     CPX #$0008
01/E9CC: D0 E6        BNE $E9B4
01/E9CE: 6B           RTL 

; [  ]

01/E9CF: 22 DB F5 02  JSL $02F5DB
01/E9D3: 60           RTS 

; [ h-flip tilemap ]

01/E9D4: A2 FD 6C     LDX #$6CFD
01/E9D7: 86 00        STX $00
01/E9D9: A2 12 00     LDX #$0012      ; 18 rows
01/E9DC: 86 02        STX $02
01/E9DE: 4C 37 EA     JMP $EA37

; [ modify monster tilemap (demon wall/back attack) ]

01/E9E1: A2 FD 6C     LDX #$6CFD
01/E9E4: 86 00        STX $00
01/E9E6: A2 12 00     LDX #$0012      ; 18 rows
01/E9E9: 86 02        STX $02
01/E9EB: AD 11 F4     LDA $F411
01/E9EE: F0 47        BEQ $EA37       ; branch if no demon wall offset
01/E9F0: 0A           ASL 
01/E9F1: 85 06        STA $06
01/E9F3: 18           CLC 
01/E9F4: 65 00        ADC $00
01/E9F6: 85 04        STA $04
01/E9F8: A5 01        LDA $01
01/E9FA: 69 00        ADC #$00
01/E9FC: 85 05        STA $05
01/E9FE: A9 40        LDA #$40
01/EA00: 38           SEC 
01/EA01: E5 06        SBC $06
01/EA03: A8           TAY 
01/EA04: 84 06        STY $06
01/EA06: C2 20        REP #$20
01/EA08: 7B           TDC 
01/EA09: A8           TAY 
01/EA0A: B1 04        LDA ($04),Y
01/EA0C: 91 00        STA ($00),Y
01/EA0E: C8           INY 
01/EA0F: C8           INY 
01/EA10: C4 06        CPY $06
01/EA12: D0 F6        BNE $EA0A
01/EA14: A9 00 22     LDA #$2200      ; blank tile ???
01/EA17: 91 00        STA ($00),Y
01/EA19: C8           INY 
01/EA1A: C8           INY 
01/EA1B: C0 40 00     CPY #$0040
01/EA1E: D0 F7        BNE $EA17
01/EA20: A5 04        LDA $04
01/EA22: 18           CLC 
01/EA23: 69 40 00     ADC #$0040
01/EA26: 85 04        STA $04
01/EA28: A5 00        LDA $00
01/EA2A: 18           CLC 
01/EA2B: 69 40 00     ADC #$0040
01/EA2E: 85 00        STA $00
01/EA30: 7B           TDC 
01/EA31: E2 20        SEP #$20
01/EA33: C6 02        DEC $02
01/EA35: D0 CF        BNE $EA06
; h-flip
01/EA37: AD C0 6C     LDA $6CC0
01/EA3A: F0 2C        BEQ $EA68       ; return if not back attack
01/EA3C: C2 20        REP #$20
01/EA3E: 7B           TDC 
01/EA3F: A8           TAY 
01/EA40: B1 00        LDA ($00),Y     ; push a full row onto the stack
01/EA42: 48           PHA 
01/EA43: C8           INY 
01/EA44: C8           INY 
01/EA45: C0 40 00     CPY #$0040
01/EA48: D0 F6        BNE $EA40
01/EA4A: 7B           TDC 
01/EA4B: A8           TAY 
01/EA4C: 68           PLA 
01/EA4D: 49 00 40     EOR #$4000      ; reverse order and toggle h-flip
01/EA50: 91 00        STA ($00),Y
01/EA52: C8           INY 
01/EA53: C8           INY 
01/EA54: C0 40 00     CPY #$0040
01/EA57: D0 F3        BNE $EA4C
01/EA59: A5 00        LDA $00
01/EA5B: 18           CLC 
01/EA5C: 69 40 00     ADC #$0040
01/EA5F: 85 00        STA $00
01/EA61: C6 02        DEC $02
01/EA63: D0 D9        BNE $EA3E
01/EA65: 7B           TDC 
01/EA66: E2 20        SEP #$20
01/EA68: 6B           RTL 

; [  ]

01/EA69: A8           TAY 
01/EA6A: B9 A5 29     LDA $29A5,Y
01/EA6D: 4A           LSR 
01/EA6E: 4A           LSR 
01/EA6F: 4A           LSR 
01/EA70: 4A           LSR 
01/EA71: 85 00        STA $00
01/EA73: 98           TYA 
01/EA74: 0A           ASL 
01/EA75: A8           TAY 
01/EA76: B9 A1 F2     LDA $F2A1,Y
01/EA79: 18           CLC 
01/EA7A: 65 00        ADC $00
01/EA7C: 60           RTS 

; [  ]

01/EA7D: DA           PHX 
01/EA7E: C2 20        REP #$20
01/EA80: 48           PHA 
01/EA81: 64 20        STZ $20
01/EA83: 64 22        STZ $22
01/EA85: A5 1C        LDA $1C
01/EA87: F0 20        BEQ $EAA9
01/EA89: A5 1E        LDA $1E
01/EA8B: F0 1C        BEQ $EAA9
01/EA8D: A2 10 00     LDX #$0010
01/EA90: 26 1C        ROL $1C
01/EA92: 26 22        ROL $22
01/EA94: 38           SEC 
01/EA95: A5 22        LDA $22
01/EA97: E5 1E        SBC $1E
01/EA99: 85 22        STA $22
01/EA9B: B0 07        BCS $EAA4
01/EA9D: A5 22        LDA $22
01/EA9F: 65 1E        ADC $1E
01/EAA1: 85 22        STA $22
01/EAA3: 18           CLC 
01/EAA4: 26 20        ROL $20
01/EAA6: CA           DEX 
01/EAA7: D0 E7        BNE $EA90
01/EAA9: 68           PLA 
01/EAAA: E2 20        SEP #$20
01/EAAC: FA           PLX 
01/EAAD: 60           RTS 

; [  ]

01/EAAE: DA           PHX 
01/EAAF: A5 47        LDA $47
01/EAB1: AA           TAX 
01/EAB2: BF 17 FD 0D  LDA $0DFD17,X
01/EAB6: AA           TAX 
01/EAB7: BD 16 2A     LDA $2A16,X
01/EABA: AA           TAX 
01/EABB: 86 1C        STX $1C
01/EABD: A2 0A 00     LDX #$000A
01/EAC0: 86 1E        STX $1E
01/EAC2: 20 7D EA     JSR $EA7D
01/EAC5: A5 22        LDA $22
01/EAC7: 18           CLC 
01/EAC8: 69 70        ADC #$70
01/EACA: 8D 7A F0     STA $F07A
01/EACD: A5 20        LDA $20
01/EACF: 18           CLC 
01/EAD0: 69 70        ADC #$70
01/EAD2: 8D 79 F0     STA $F079
01/EAD5: FA           PLX 
01/EAD6: A9 04        LDA #$04
01/EAD8: 9D D0 EF     STA $EFD0,X
01/EADB: A9 09        LDA #$09
01/EADD: 8D 78 F0     STA $F078
01/EAE0: 6B           RTL 

; [  ]

01/EAE1: AD 81 35     LDA $3581
01/EAE4: 8D C0 6C     STA $6CC0
01/EAE7: 7B           TDC 
01/EAE8: A2 50 ED     LDX #$ED50
01/EAEB: 9D 00 00     STA $0000,X     ; clear $ED50-$F4BB
01/EAEE: E8           INX 
01/EAEF: E0 BC F4     CPX #$F4BC
01/EAF2: D0 F7        BNE $EAEB
01/EAF4: A2 0C 18     LDX #$180C
01/EAF7: 9D 00 00     STA $0000,X
01/EAFA: E8           INX 
01/EAFB: E0 47 18     CPX #$1847
01/EAFE: D0 F7        BNE $EAF7
01/EB00: 7B           TDC 
01/EB01: AA           TAX 
01/EB02: 64 D7        STZ $D7
01/EB04: 64 47        STZ $47
01/EB06: 86 48        STX $48
01/EB08: 86 4A        STX $4A
01/EB0A: 86 4C        STX $4C
01/EB0C: 64 4E        STZ $4E
01/EB0E: 86 5F        STX $5F
01/EB10: 86 61        STX $61
01/EB12: 64 63        STZ $63
01/EB14: 64 64        STZ $64
01/EB16: 86 37        STX $37
01/EB18: 86 39        STX $39
01/EB1A: 8D C1 6C     STA $6CC1
01/EB1D: 8D C2 6C     STA $6CC2
01/EB20: EE 7B F0     INC $F07B
01/EB23: EE 7F F0     INC $F07F
01/EB26: EE 83 F0     INC $F083
01/EB29: EE 87 F0     INC $F087
01/EB2C: EE 8B F0     INC $F08B
01/EB2F: 9D 4F 00     STA $004F,X
01/EB32: E8           INX 
01/EB33: E8           INX 
01/EB34: E8           INX 
01/EB35: E8           INX 
01/EB36: E0 10 00     CPX #$0010
01/EB39: D0 F4        BNE $EB2F
01/EB3B: AE 00 18     LDX $1800
01/EB3E: E0 F4 00     CPX #$00F4
01/EB41: D0 04        BNE $EB47
01/EB43: A9 02        LDA #$02
01/EB45: 80 07        BRA $EB4E
01/EB47: E0 AF 01     CPX #$01AF
01/EB4A: D0 05        BNE $EB51
01/EB4C: A9 12        LDA #$12
01/EB4E: 8D 11 F4     STA $F411
01/EB51: EE 8B F2     INC $F28B
01/EB54: 7B           TDC 
01/EB55: AA           TAX 
01/EB56: A9 FF        LDA #$FF
01/EB58: 9D B4 F2     STA $F2B4,X
01/EB5B: A9 80        LDA #$80
01/EB5D: 9D 6B EF     STA $EF6B,X     ; clear menu cursor positions
01/EB60: 9D 7A EF     STA $EF7A,X     ; clear target cursor positions
01/EB63: E8           INX 
01/EB64: E0 08 00     CPX #$0008
01/EB67: D0 ED        BNE $EB56
01/EB69: A9 02        LDA #$02
01/EB6B: 8D 3A 18     STA $183A
01/EB6E: 8D 3C 18     STA $183C
01/EB71: 8D 3E 18     STA $183E
01/EB74: A2 01 01     LDX #$0101
01/EB77: 8E 69 EF     STX $EF69
01/EB7A: 8E 83 EF     STX $EF83
01/EB7D: 8E 76 EF     STX $EF76
01/EB80: 8E 78 EF     STX $EF78
01/EB83: EE 73 EF     INC $EF73
01/EB86: 7B           TDC 
01/EB87: AA           TAX 
01/EB88: C2 20        REP #$20
01/EB8A: A9 C0 B6     LDA #$B6C0      ; 0C/B6C0 (attack graphics)
01/EB8D: 9F 00 F0 7F  STA $7FF000,X
01/EB91: 18           CLC 
01/EB92: 69 18 00     ADC #$0018
01/EB95: E8           INX 
01/EB96: E8           INX 
01/EB97: E0 00 06     CPX #$0600
01/EB9A: D0 F1        BNE $EB8D
01/EB9C: A9 00 00     LDA #$0000
01/EB9F: E2 20        SEP #$20
01/EBA1: 7B           TDC 
01/EBA2: AA           TAX 
01/EBA3: BF 4A F9 03  LDA $03F94A,X   ; init final battle bg hdma scroll offsets
01/EBA7: 9D 88 F4     STA $F488,X
01/EBAA: E8           INX 
01/EBAB: E0 0012      CPX #$0012
01/EBAE: D0 F3        BNE $EBA3
01/EBB0: 22 3E FC 03  JSL $03FC3E
01/EBB4: A9 18        LDA #$18        ; set button repeat rates
01/EBB6: 8D DD 01     STA $01DD
01/EBB9: A9 03        LDA #$03
01/EBBB: 8D DC 01     STA $01DC
01/EBBE: 6B           RTL 

; [ draw pause window text ]

01/EBBF: 7B           TDC 
01/EBC0: AA           TAX 
01/EBC1: A8           TAY 
01/EBC2: BF A8 FE 16  LDA $16FEA8,X
01/EBC6: 99 42 DC     STA $DC42,Y
01/EBC9: E8           INX 
01/EBCA: C8           INY 
01/EBCB: C8           INY 
01/EBCC: E0 05 00     CPX #$0005
01/EBCF: D0 F1        BNE $EBC2
01/EBD1: 6B           RTL 

; [ init bg scroll hdma ]

01/EBD2: 7B           TDC 
01/EBD3: AA           TAX 
01/EBD4: BF 29 FF 0D  LDA $0DFF29,X   ; load bg scroll hdma tables
01/EBD8: 9D FD 75     STA $75FD,X
01/EBDB: E8           INX 
01/EBDC: E0 15 00     CPX #$0015
01/EBDF: D0 F3        BNE $EBD4
01/EBE1: 7B           TDC 
01/EBE2: AA           TAX 
01/EBE3: 9D 12 76     STA $7612,X     ; clear hdma data
01/EBE6: E8           INX 
01/EBE7: E0 20 16     CPX #$1620
01/EBEA: D0 F7        BNE $EBE3
01/EBEC: 7B           TDC 
01/EBED: AA           TAX 
01/EBEE: A9 FE        LDA #$FE
01/EBF0: 9D 14 7D     STA $7D14,X     ; bg3 v-scroll
01/EBF3: 3A           DEC 
01/EBF4: E8           INX 
01/EBF5: E8           INX 
01/EBF6: E8           INX 
01/EBF7: E8           INX 
01/EBF8: E0 80 03     CPX #$0380
01/EBFB: D0 F3        BNE $EBF0
01/EBFD: A2 30 02     LDX #$0230
01/EC00: BD 14 7D     LDA $7D14,X
01/EC03: 3A           DEC 
01/EC04: 9D 94 79     STA $7994,X     ; bg2 v-scroll
01/EC07: E8           INX 
01/EC08: E8           INX 
01/EC09: E8           INX 
01/EC0A: E8           INX 
01/EC0B: E0 80 02     CPX #$0280
01/EC0E: D0 F0        BNE $EC00
01/EC10: C2 20        REP #$20
01/EC12: 7B           TDC 
01/EC13: AA           TAX 
01/EC14: A9 73 01     LDA #$0173
01/EC17: A0 08 00     LDY #$0008
01/EC1A: 9D 94 80     STA $8094,X
01/EC1D: 48           PHA 
01/EC1E: 18           CLC 
01/EC1F: 69 68 00     ADC #$0068
01/EC22: 9D 14 83     STA $8314,X
01/EC25: 18           CLC 
01/EC26: 69 F0 00     ADC #$00F0
01/EC29: 9D F4 8A     STA $8AF4,X
01/EC2C: 68           PLA 
01/EC2D: 88           DEY 
01/EC2E: D0 07        BNE $EC37
01/EC30: 18           CLC 
01/EC31: 69 04 00     ADC #$0004
01/EC34: A0 0C 00     LDY #$000C
01/EC37: E0 10 01     CPX #$0110
01/EC3A: D0 04        BNE $EC40
01/EC3C: 18           CLC 
01/EC3D: 69 04 00     ADC #$0004
01/EC40: E8           INX 
01/EC41: E8           INX 
01/EC42: E8           INX 
01/EC43: E8           INX 
01/EC44: E0 30 01     CPX #$0130
01/EC47: D0 D1        BNE $EC1A
01/EC49: 7B           TDC 
01/EC4A: AA           TAX 
01/EC4B: A9 6F 01     LDA #$016F
01/EC4E: A0 08 00     LDY #$0008
01/EC51: FE D3 81     INC $81D3,X
01/EC54: 9D D4 81     STA $81D4,X
01/EC57: 88           DEY 
01/EC58: D0 07        BNE $EC61
01/EC5A: 18           CLC 
01/EC5B: 69 04 00     ADC #$0004
01/EC5E: A0 0C 00     LDY #$000C
01/EC61: E0 10 01     CPX #$0110
01/EC64: D0 04        BNE $EC6A
01/EC66: 18           CLC 
01/EC67: 69 34 01     ADC #$0134
01/EC6A: E8           INX 
01/EC6B: E8           INX 
01/EC6C: E8           INX 
01/EC6D: E8           INX 
01/EC6E: E0 30 01     CPX #$0130
01/EC71: D0 DE        BNE $EC51
01/EC73: 7B           TDC 
01/EC74: AA           TAX 
01/EC75: A9 6B 00     LDA #$006B
01/EC78: A0 08 00     LDY #$0008
01/EC7B: 9D 54 84     STA $8454,X
01/EC7E: 88           DEY 
01/EC7F: D0 07        BNE $EC88
01/EC81: 18           CLC 
01/EC82: 69 04 00     ADC #$0004
01/EC85: A0 0C 00     LDY #$000C
01/EC88: E0 88 00     CPX #$0088
01/EC8B: D0 04        BNE $EC91
01/EC8D: 18           CLC 
01/EC8E: 69 04 00     ADC #$0004
01/EC91: E8           INX 
01/EC92: E8           INX 
01/EC93: E8           INX 
01/EC94: E8           INX 
01/EC95: E0 A0 00     CPX #$00A0
01/EC98: D0 E1        BNE $EC7B
01/EC9A: 7B           TDC 
01/EC9B: AA           TAX 
01/EC9C: BD 72 80     LDA $8072,X
01/EC9F: 9D C2 81     STA $81C2,X
01/ECA2: 9D 42 84     STA $8442,X
01/ECA5: E8           INX 
01/ECA6: E8           INX 
01/ECA7: E0 10 00     CPX #$0010
01/ECAA: D0 F0        BNE $EC9C
01/ECAC: 7B           TDC 
01/ECAD: AA           TAX 
01/ECAE: A9 01 01     LDA #$0101
01/ECB1: 9D F2 84     STA $84F2,X
01/ECB4: E8           INX 
01/ECB5: E8           INX 
01/ECB6: E8           INX 
01/ECB7: E8           INX 
01/ECB8: E0 00 01     CPX #$0100
01/ECBB: D0 F1        BNE $ECAE
01/ECBD: 7B           TDC 
01/ECBE: AA           TAX 
01/ECBF: A9 53 00     LDA #$0053
01/ECC2: A0 08 00     LDY #$0008
01/ECC5: 9D F4 85     STA $85F4,X
01/ECC8: 9D 74 88     STA $8874,X
01/ECCB: 48           PHA 
01/ECCC: 38           SEC 
01/ECCD: E9 0C 00     SBC #$000C
01/ECD0: 9D 74 86     STA $8674,X
01/ECD3: 9D F4 88     STA $88F4,X
01/ECD6: 38           SEC 
01/ECD7: E9 0C 00     SBC #$000C
01/ECDA: 9D F4 86     STA $86F4,X
01/ECDD: 9D 74 89     STA $8974,X
01/ECE0: 38           SEC 
01/ECE1: E9 0C 00     SBC #$000C
01/ECE4: 9D 74 87     STA $8774,X
01/ECE7: 9D F4 89     STA $89F4,X
01/ECEA: 38           SEC 
01/ECEB: E9 0C 00     SBC #$000C
01/ECEE: 9D F4 87     STA $87F4,X
01/ECF1: 9D 74 8A     STA $8A74,X
01/ECF4: 68           PLA 
01/ECF5: 88           DEY 
01/ECF6: D0 04        BNE $ECFC
01/ECF8: 18           CLC 
01/ECF9: 69 04 00     ADC #$0004
01/ECFC: 48           PHA 
01/ECFD: A9 AC 00     LDA #$00AC
01/ED00: 9D 72 88     STA $8872,X
01/ED03: 9D F2 88     STA $88F2,X
01/ED06: 9D 72 89     STA $8972,X
01/ED09: 9D F2 89     STA $89F2,X
01/ED0C: 9D 72 8A     STA $8A72,X
01/ED0F: A9 BC 01     LDA #$01BC
01/ED12: 9D F2 85     STA $85F2,X
01/ED15: 9D 72 86     STA $8672,X
01/ED18: 9D F2 86     STA $86F2,X
01/ED1B: 9D 72 87     STA $8772,X
01/ED1E: 9D F2 87     STA $87F2,X
01/ED21: 68           PLA 
01/ED22: E8           INX 
01/ED23: E8           INX 
01/ED24: E8           INX 
01/ED25: E8           INX 
01/ED26: E0 70 00     CPX #$0070
01/ED29: D0 9A        BNE $ECC5
01/ED2B: A2 1C 00     LDX #$001C
01/ED2E: A0 04 00     LDY #$0004
01/ED31: A9 34 01     LDA #$0134
01/ED34: 9D 14 7D     STA $7D14,X
01/ED37: 88           DEY 
01/ED38: D0 04        BNE $ED3E
01/ED3A: 18           CLC 
01/ED3B: 69 04 00     ADC #$0004
01/ED3E: E8           INX 
01/ED3F: E8           INX 
01/ED40: E8           INX 
01/ED41: E8           INX 
01/ED42: E0 80 00     CPX #$0080
01/ED45: D0 ED        BNE $ED34
01/ED47: 7B           TDC 
01/ED48: AA           TAX 
01/ED49: A9 00 01     LDA #$0100
01/ED4C: 9D 32 8C     STA $8C32,X
01/ED4F: A9 60 01     LDA #$0160
01/ED52: 9D 34 8C     STA $8C34,X
01/ED55: E8           INX 
01/ED56: E8           INX 
01/ED57: E8           INX 
01/ED58: E8           INX 
01/ED59: E0 80 00     CPX #$0080
01/ED5C: D0 EB        BNE $ED49
01/ED5E: 7B           TDC 
01/ED5F: E2 20        SEP #$20
01/ED61: 6B           RTL 

; [  ]

01/ED62: DA           PHX 
01/ED63: C2 20        REP #$20
01/ED65: AD 08 F4     LDA $F408
01/ED68: 18           CLC 
01/ED69: 65 2A        ADC $2A
01/ED6B: 85 02        STA $02
01/ED6D: 4C 78 ED     JMP $ED78
01/ED70: DA           PHX 
01/ED71: C2 20        REP #$20
01/ED73: AD 08 F4     LDA $F408
01/ED76: 85 02        STA $02
01/ED78: AD 06 F4     LDA $F406
01/ED7B: 85 00        STA $00
01/ED7D: 7B           TDC 
01/ED7E: AA           TAX 
01/ED7F: A5 00        LDA $00
01/ED81: 9D 12 76     STA $7612,X
01/ED84: 9D 9E 76     STA $769E,X
01/ED87: 9D 2A 77     STA $772A,X
01/ED8A: 9D B6 77     STA $77B6,X
01/ED8D: A5 02        LDA $02
01/ED8F: 9D 14 76     STA $7614,X
01/ED92: 9D A0 76     STA $76A0,X
01/ED95: 9D 2C 77     STA $772C,X
01/ED98: 9D B8 77     STA $77B8,X
01/ED9B: E8           INX 
01/ED9C: E8           INX 
01/ED9D: E8           INX 
01/ED9E: E8           INX 
01/ED9F: E0 8C 00     CPX #$008C
01/EDA2: D0 DB        BNE $ED7F
01/EDA4: 7B           TDC 
01/EDA5: E2 20        SEP #$20
01/EDA7: FA           PLX 
01/EDA8: 6B           RTL 

; [  ]

01/EDA9: 5A           PHY 
01/EDAA: 84 00        STY $00
01/EDAC: C2 20        REP #$20
01/EDAE: 0A           ASL 
01/EDAF: 0A           ASL 
01/EDB0: 0A           ASL 
01/EDB1: 0A           ASL 
01/EDB2: 85 2A        STA $2A
01/EDB4: 8A           TXA 
01/EDB5: 0A           ASL 
01/EDB6: 0A           ASL 
01/EDB7: 0A           ASL 
01/EDB8: 0A           ASL 
01/EDB9: 0A           ASL 
01/EDBA: 18           CLC 
01/EDBB: 65 00        ADC $00
01/EDBD: A8           TAY 
01/EDBE: A5 2A        LDA $2A
01/EDC0: 18           CLC 
01/EDC1: 65 00        ADC $00
01/EDC3: AA           TAX 
01/EDC4: 7B           TDC 
01/EDC5: E2 20        SEP #$20
01/EDC7: BF 00 CB 0E  LDA $0ECB00,X
01/EDCB: 99 50 ED     STA $ED50,Y
01/EDCE: 99 60 ED     STA $ED60,Y
01/EDD1: 7A           PLY 
01/EDD2: 60           RTS 

; [  ]

01/EDD3: 7B           TDC 
01/EDD4: A8           TAY 
01/EDD5: 5A           PHY 
01/EDD6: 20 09 EE     JSR $EE09       ; wait one frame
01/EDD9: 7A           PLY 
01/EDDA: A2 01 00     LDX #$0001
01/EDDD: A9 26        LDA #$26
01/EDDF: 20 A9 ED     JSR $EDA9
01/EDE2: A2 02 00     LDX #$0002
01/EDE5: A9 26        LDA #$26
01/EDE7: 20 A9 ED     JSR $EDA9
01/EDEA: A2 03 00     LDX #$0003
01/EDED: A9 27        LDA #$27
01/EDEF: 20 A9 ED     JSR $EDA9
01/EDF2: A2 04 00     LDX #$0004
01/EDF5: A9 27        LDA #$27
01/EDF7: 20 A9 ED     JSR $EDA9
01/EDFA: A2 06 00     LDX #$0006
01/EDFD: A9 27        LDA #$27
01/EDFF: 20 A9 ED     JSR $EDA9
01/EE02: C8           INY 
01/EE03: C0 10 00     CPY #$0010
01/EE06: D0 CD        BNE $EDD5
01/EE08: 6B           RTL 

; [ wait one frame ]

01/EE09: 22 06 80 02  JSL $028006     ; wait one frame
01/EE0D: 60           RTS 

; [ do special animation (far) ]

01/EE0E: 20 12 EE     JSR $EE12
01/EE11: 6B           RTL 

; [ do special animation ]

01/EE12: 38           SEC 
01/EE13: E9 A9        SBC #$A9
01/EE15: 0A           ASL 
01/EE16: AA           TAX 
01/EE17: BF 26 EE 01  LDA $01EE26,X
01/EE1B: 85 00        STA $00
01/EE1D: BF 27 EE 01  LDA $01EE27,X
01/EE21: 85 01        STA $01
01/EE23: 6C 00 00     JMP ($0000)

; special animation jump table
01/EE26:      EF06 EF06 EEF9 EEF9 EEE1 EF06 EE59
01/EE34: EF53 EF21 EFDB EFE1 EFF4 F002 F010 F01E  ; $B0
01/EE3C: EFBB EF06 EF06 EE6C EF06 EF06 EF06 EE54

; $BF
01/EE54: 22 45 F8 03  JSL $03F845
01/EE58: 60           RTS 
; $AF: demon wall moves forward
01/EE59: AD 11 F4     LDA $F411
01/EE5C: F0 0D        BEQ $EE6B
01/EE5E: CE 11 F4     DEC $F411
01/EE61: 22 DD BE 02  JSL $02BEDD
01/EE65: A9 31        LDA #$31
01/EE67: 22 D7 F5 02  JSL $02F5D7
01/EE6B: 60           RTS 
; $BB: zeromus shakes
01/EE6C: A9 54        LDA #$54
01/EE6E: 22 D7 F5 02  JSL $02F5D7
01/EE72: A2 40 00     LDX #$0040
01/EE75: DA           PHX 
01/EE76: 20 09 EE     JSR $EE09       ; wait one frame
01/EE79: 22 B2 F5 02  JSL $02F5B2
01/EE7D: FA           PLX 
01/EE7E: CA           DEX 
01/EE7F: D0 F4        BNE $EE75
01/EE81: 22 B0 F5 02  JSL $02F5B0
01/EE85: 7B           TDC 
01/EE86: 22 D7 F5 02  JSL $02F5D7
01/EE8A: 60           RTS 

; [  ]

01/EE8B: A9 20        LDA #$20
01/EE8D: 80 06        BRA $EE95
01/EE8F: A9 80        LDA #$80
01/EE91: 80 02        BRA $EE95
01/EE93: A9 E0        LDA #$E0
01/EE95: 8D 88 EF     STA $EF88
01/EE98: 9C 33 F4     STZ $F433
01/EE9B: 9C 35 F4     STZ $F435
01/EE9E: 9C 34 F4     STZ $F434
01/EEA1: A9 02        LDA #$02
01/EEA3: 8D 87 EF     STA $EF87
01/EEA6: 9C 89 EF     STZ $EF89
01/EEA9: 9C 8A EF     STZ $EF8A
01/EEAC: 60           RTS 

; [ flash screen ]

01/EEAD: A9 A0        LDA #$A0
01/EEAF: 80 16        BRA $EEC7
01/EEB1: A9 C0        LDA #$C0
01/EEB3: 80 12        BRA $EEC7
01/EEB5: A9 60        LDA #$60
01/EEB7: 80 0E        BRA $EEC7
01/EEB9: A9 20        LDA #$20        ; red
01/EEBB: 80 0A        BRA $EEC7
01/EEBD: A9 40        LDA #$40        ; green
01/EEBF: 80 06        BRA $EEC7
01/EEC1: A9 80        LDA #$80        ; blue
01/EEC3: 80 02        BRA $EEC7
01/EEC5: A9 E0        LDA #$E0        ; white
01/EEC7: 8D 88 EF     STA $EF88       ; set flash color components
01/EECA: A9 1F        LDA #$1F
01/EECC: 8D 33 F4     STA $F433
01/EECF: 8D 35 F4     STA $F435
01/EED2: 8D 34 F4     STA $F434
01/EED5: A9 01        LDA #$01
01/EED7: 8D 87 EF     STA $EF87
01/EEDA: 9C 89 EF     STZ $EF89
01/EEDD: 9C 8A EF     STZ $EF8A
01/EEE0: 6B           RTL 

; [ special animation $AD: change to next form ]

01/EEE1: 20 F9 EE     JSR $EEF9
01/EEE4: 22 2B 8D 02  JSL $028D2B
01/EEE8: 22 E1 E9 01  JSL $01E9E1
01/EEEC: A9 59        LDA #$59
01/EEEE: 22 D7 F5 02  JSL $02F5D7
01/EEF2: A9 02        LDA #$02
01/EEF4: 22 99 CC 02  JSL $02CC99
01/EEF8: 60           RTS 

; [  ]

01/EEF9: 7B           TDC 
01/EEFA: AA           TAX 
01/EEFB: 3A           DEC 
01/EEFC: 9D B4 F2     STA $F2B4,X
01/EEFF: E8           INX 
01/EF00: E0 08 00     CPX #$0008
01/EF03: D0 F7        BNE $EEFC
01/EF05: 60           RTS 

; [ unused special animation ]

01/EF06: 60           RTS 

; [ find adult rydia ]

01/EF07: 7B           TDC 
01/EF08: A8           TAY 
01/EF09: 98           TYA 
01/EF0A: AA           TAX 
01/EF0B: 22 03 E1 02  JSL $02E103     ; get pointer to character/monster properties
01/EF0F: BD 01 20     LDA $2001,X
01/EF12: 29 0F        AND #$0F
01/EF14: C9 0B        CMP #$0B
01/EF16: F0 08        BEQ $EF20       ; branch if adult rydia
01/EF18: C8           INY 
01/EF19: C0 05 00     CPY #$0005
01/EF1C: D0 EB        BNE $EF09
01/EF1E: 7B           TDC 
01/EF1F: A8           TAY 
01/EF20: 60           RTS 

; [ special animation $B1 ]

01/EF21: 20 6B EF     JSR $EF6B
01/EF24: AD 48 00     LDA $0048
01/EF27: 48           PHA 
01/EF28: AD 75 F4     LDA $F475
01/EF2B: 8D 48 00     STA $0048
01/EF2E: 22 C4 C5 02  JSL $02C5C4
01/EF32: 20 07 EF     JSR $EF07       ; find adult rydia
01/EF35: 7B           TDC 
01/EF36: 99 C1 F2     STA $F2C1,Y
01/EF39: BD 00 20     LDA $2000,X
01/EF3C: 48           PHA 
01/EF3D: 98           TYA 
01/EF3E: 0A           ASL 
01/EF3F: 0A           ASL 
01/EF40: 0A           ASL 
01/EF41: 0A           ASL 
01/EF42: AA           TAX 
01/EF43: 68           PLA 
01/EF44: 9D C4 EF     STA $EFC4,X
01/EF47: 22 C8 C5 02  JSL $02C5C8
01/EF4B: 68           PLA 
01/EF4C: 8D 48 00     STA $0048
01/EF4F: 20 81 EF     JSR $EF81
01/EF52: 60           RTS 

; [ special animation $B0: mist dragon vs. golbez ]

01/EF53: 20 07 EF     JSR $EF07       ; find adult rydia
01/EF56: 7B           TDC 
01/EF57: 9D 03 20     STA $2003,X     ; clear status
01/EF5A: 9D 04 20     STA $2004,X
01/EF5D: 9D 05 20     STA $2005,X
01/EF60: 9D 06 20     STA $2006,X
01/EF63: 98           TYA 
01/EF64: 8D 75 F4     STA $F475
01/EF67: EE 74 F4     INC $F474       ; enable mist dragon vs. golbez
01/EF6A: 60           RTS 

; [ load mist dragon vs. golbez attack properties ]

01/EF6B: 7B           TDC 
01/EF6C: AA           TAX 
01/EF6D: BD C2 34     LDA $34C2,X     ; save attack properties
01/EF70: 9D 76 F4     STA $F476,X
01/EF73: BF B3 EF 01  LDA $01EFB3,X   ; copy attack properties
01/EF77: 9D C2 34     STA $34C2,X
01/EF7A: E8           INX 
01/EF7B: E0 08 00     CPX #$0008
01/EF7E: D0 ED        BNE $EF6D
01/EF80: 60           RTS 

; [ restore attack properties ]

01/EF81: 7B           TDC 
01/EF82: AA           TAX 
01/EF83: BD 76 F4     LDA $F476,X
01/EF86: 9D C2 34     STA $34C2,X
01/EF89: E8           INX 
01/EF8A: E0 08 00     CPX #$0008
01/EF8D: D0 F4        BNE $EF83
01/EF8F: 60           RTS 

; [ show mist dragon vs. golbez ]

01/EF90: A9 C4        LDA #$C4        ; summon
01/EF92: 8D C2 33     STA $33C2
01/EF95: A9 56        LDA #$56        ; mist dragon
01/EF97: 8D C3 33     STA $33C3
01/EF9A: A9 FF        LDA #$FF        ; script terminator
01/EF9C: 8D C4 33     STA $33C4
01/EF9F: 20 6B EF     JSR $EF6B       ; load mist dragon vs. golbez attack properties
01/EFA2: EE 74 F4     INC $F474       ; this is unnecessary, it's already nonzero
01/EFA5: AD 75 F4     LDA $F475       ; adult rydia
01/EFA8: 8D C3 34     STA $34C3       ; set attacker id
01/EFAB: 22 AB BE 02  JSL $02BEAB     ; execute graphics script
01/EFAF: 20 81 EF     JSR $EF81       ; restore attack properties
01/EFB2: 6B           RTL 

; attack properties for mist dragon vs. golbez and shadow -> $34C2-$34C9
;   (target monsters 0 and 1)
01/EFB3: 00 00 80 C0 00 00 00 00

; [ special animation $B8:  ]

01/EFBB: 9C 4C F4     STZ $F44C
01/EFBE: 9C 1A F4     STZ $F41A
01/EFC1: 4C CB EF     JMP $EFCB
01/EFC4: 20 CB EF     JSR $EFCB
01/EFC7: EE 1A F4     INC $F41A
01/EFCA: 60           RTS 
01/EFCB: 22 2B 8D 02  JSL $028D2B
01/EFCF: 22 E1 E9 01  JSL $01E9E1
01/EFD3: 9C E6 38     STZ $38E6
01/EFD6: 22 3C CC 02  JSL $02CC3C
01/EFDA: 60           RTS 

; [ special animation $B2:  ]

01/EFDB: EE 73 F4     INC $F473
01/EFDE: 4C BB EF     JMP $EFBB

; [ special animation $B3:  ]

01/EFE1: 20 E4 EF     JSR $EFE4
01/EFE4: EE 4C F4     INC $F44C
01/EFE7: AD 1A F4     LDA $F41A
01/EFEA: D0 05        BNE $EFF1
01/EFEC: A9 05        LDA #$05
01/EFEE: 20 A7 F0     JSR $F0A7
01/EFF1: 4C C4 EF     JMP $EFC4

; [ special animation $B4: call edward and tellah ]

01/EFF4: EE 4C F4     INC $F44C
01/EFF7: A9 01        LDA #$01
01/EFF9: 20 A7 F0     JSR $F0A7
01/EFFC: EE 1A F4     INC $F41A
01/EFFF: 4C C4 EF     JMP $EFC4

; [ special animation $B5: call palom and porom ]

01/F002: EE 4C F4     INC $F44C
01/F005: A9 02        LDA #$02
01/F007: 20 A7 F0     JSR $F0A7
01/F00A: EE 1A F4     INC $F41A
01/F00D: 4C C4 EF     JMP $EFC4

; [ special animation $B6: call yang and cid ]

01/F010: EE 4C F4     INC $F44C
01/F013: A9 03        LDA #$03
01/F015: 20 A7 F0     JSR $F0A7
01/F018: EE 1A F4     INC $F41A
01/F01B: 4C C4 EF     JMP $EFC4

; [ special animation $B7: call fusoya and golbez ]

01/F01E: EE F7 38     INC $38F7
01/F021: EE 4C F4     INC $F44C
01/F024: A9 04        LDA #$04
01/F026: 20 A7 F0     JSR $F0A7
01/F029: EE 1A F4     INC $F41A
01/F02C: 4C C4 EF     JMP $EFC4

01/F02F: AD 4C F4     LDA $F44C
01/F032: F0 23        BEQ $F057
01/F034: AD 1A F4     LDA $F41A
01/F037: F0 0F        BEQ $F048
01/F039: AD 22 F4     LDA $F422
01/F03C: 20 58 F0     JSR $F058
01/F03F: A9 76        LDA #$76
01/F041: 85 02        STA $02
01/F043: A9 88        LDA #$88
01/F045: 20 7C F0     JSR $F07C
01/F048: AD 21 F4     LDA $F421
01/F04B: 20 58 F0     JSR $F058
01/F04E: A9 72        LDA #$72
01/F050: 85 02        STA $02
01/F052: A9 80        LDA #$80
01/F054: 20 7C F0     JSR $F07C
01/F057: 6B           RTL 

; [  ]

01/F058: 48           PHA 
01/F059: 29 0F        AND #$0F
01/F05B: 85 26        STA $26
01/F05D: A9 40        LDA #$40
01/F05F: 85 28        STA $28
01/F061: 22 5C 85 02  JSL $02855C     ; multiply (8-bit)
01/F065: 68           PLA 
01/F066: 4A           LSR 
01/F067: 4A           LSR 
01/F068: 4A           LSR 
01/F069: 4A           LSR 
01/F06A: 18           CLC 
01/F06B: 69 06        ADC #$06
01/F06D: C2 20        REP #$20
01/F06F: 0A           ASL 
01/F070: 18           CLC 
01/F071: 65 2A        ADC $2A
01/F073: 18           CLC 
01/F074: 69 FD 6C     ADC #$6CFD
01/F077: AA           TAX 
01/F078: 7B           TDC 
01/F079: E2 20        SEP #$20
01/F07B: 60           RTS 

; [  ]

01/F07C: 86 00        STX $00
01/F07E: A0 00 00     LDY #$0000
01/F081: 20 90 F0     JSR $F090
01/F084: A0 40 00     LDY #$0040
01/F087: 20 90 F0     JSR $F090
01/F08A: A0 80 00     LDY #$0080
01/F08D: 4C 90 F0     JMP $F090

; [  ]

01/F090: 48           PHA 
01/F091: 1A           INC 
01/F092: 91 00        STA ($00),Y
01/F094: C8           INY 
01/F095: A5 02        LDA $02
01/F097: 91 00        STA ($00),Y
01/F099: C8           INY 
01/F09A: 68           PLA 
01/F09B: 48           PHA 
01/F09C: 91 00        STA ($00),Y
01/F09E: C8           INY 
01/F09F: A5 02        LDA $02
01/F0A1: 91 00        STA ($00),Y
01/F0A3: 68           PLA 
01/F0A4: 1A           INC 
01/F0A5: 1A           INC 
01/F0A6: 60           RTS 

; [  ]

01/F0A7: 0A           ASL 
01/F0A8: 0A           ASL 
01/F0A9: 0A           ASL 
01/F0AA: AA           TAX 
01/F0AB: 7B           TDC 
01/F0AC: A8           TAY 
01/F0AD: BF 1C FD 0D  LDA $0DFD1C,X
01/F0B1: 99 1B F4     STA $F41B,Y
01/F0B4: E8           INX 
01/F0B5: C8           INY 
01/F0B6: C0 08 00     CPY #$0008
01/F0B9: D0 F2        BNE $F0AD
01/F0BB: A2 00 01     LDX #$0100
01/F0BE: 86 00        STX $00
01/F0C0: AE 1B F4     LDX $F41B
01/F0C3: A0 00 48     LDY #$4800
01/F0C6: A9 1A        LDA #$1A
01/F0C8: 22 AE 84 02  JSL $0284AE
01/F0CC: A2 00 01     LDX #$0100
01/F0CF: 86 00        STX $00
01/F0D1: AE 1D F4     LDX $F41D
01/F0D4: A0 80 48     LDY #$4880
01/F0D7: A9 1A        LDA #$1A
01/F0D9: 22 AE 84 02  JSL $0284AE
01/F0DD: AD 1F F4     LDA $F41F
01/F0E0: A2 04 00     LDX #$0004
01/F0E3: 22 A5 91 02  JSL $0291A5
01/F0E7: AD 20 F4     LDA $F420
01/F0EA: A2 05 00     LDX #$0005
01/F0ED: 22 A5 91 02  JSL $0291A5
01/F0F1: 60           RTS 

; [  ]

01/F0F2: AD 0F F4     LDA $F40F
01/F0F5: D0 00        BNE $F0F7
01/F0F7: AD 10 F4     LDA $F410
01/F0FA: 0A           ASL 
01/F0FB: 0A           ASL 
01/F0FC: 0A           ASL 
01/F0FD: AA           TAX 
01/F0FE: 7B           TDC 
01/F0FF: A8           TAY 
01/F100: BF 4C FD 0D  LDA $0DFD4C,X
01/F104: 99 CA F0     STA $F0CA,Y
01/F107: E8           INX 
01/F108: C8           INY 
01/F109: C0 06 00     CPY #$0006
01/F10C: D0 F2        BNE $F100
01/F10E: EE C9 F0     INC $F0C9
01/F111: 6B           RTL 

; [  ]

01/F112: 20 F9 FD     JSR $FDF9
01/F115: 22 02 F9 03  JSL $03F902     ; update final battle bg hdma data
01/F119: AD E8 38     LDA $38E8
01/F11C: F0 15        BEQ $F133
01/F11E: AD E9 38     LDA $38E9
01/F121: A8           TAY 
01/F122: AD EA 38     LDA $38EA
01/F125: AA           TAX 
01/F126: BF 60 FC 16  LDA $16FC60,X
01/F12A: 99 99 F0     STA $F099,Y
01/F12D: 99 9E F0     STA $F09E,Y
01/F130: 9C E8 38     STZ $38E8
01/F133: AD BD 38     LDA $38BD
01/F136: F0 12        BEQ $F14A       ; branch if no song change
01/F138: AD BE 38     LDA $38BE       ; song id
01/F13B: 8D 01 1E     STA $1E01
01/F13E: A9 01        LDA #$01        ; play song
01/F140: 8D 00 1E     STA $1E00
01/F143: 22 04 80 04  JSL $048004     ; execute sound command
01/F147: 9C BD 38     STZ $38BD
01/F14A: AD 16 F4     LDA $F416
01/F14D: F0 0A        BEQ $F159       ; branch if no system sound effect
01/F14F: 8D 00 1E     STA $1E00
01/F152: 22 04 80 04  JSL $048004     ; execute sound command
01/F156: 9C 16 F4     STZ $F416
01/F159: AD 12 F4     LDA $F412
01/F15C: F0 20        BEQ $F17E       ; branch if no game sound effect
01/F15E: AE 12 F4     LDX $F412
01/F161: 8E 00 1E     STX $1E00
01/F164: AE 14 F4     LDX $F414
01/F167: 8E 02 1E     STX $1E02
01/F16A: AD C0 6C     LDA $6CC0
01/F16D: F0 08        BEQ $F177
01/F16F: AD 02 1E     LDA $1E02
01/F172: 49 FF        EOR #$FF        ; reverse pan for back attack
01/F174: 8D 02 1E     STA $1E02
01/F177: 22 04 80 04  JSL $048004     ; execute sound command
01/F17B: 9C 12 F4     STZ $F412
01/F17E: 9C 2D 35     STZ $352D
01/F181: AD 72 F4     LDA $F472
01/F184: 0D 8B 38     ORA $388B
01/F187: D0 11        BNE $F19A
01/F189: AF 18 42 00  LDA $004218
01/F18D: 0F 1A 42 00  ORA $00421A
01/F191: 29 30        AND #$30
01/F193: C9 30        CMP #$30
01/F195: D0 03        BNE $F19A       ; branch if not holding R and L buttons
01/F197: EE 2D 35     INC $352D
01/F19A: 9C 11 18     STZ $1811
01/F19D: 9C 12 18     STZ $1812
01/F1A0: E6 97        INC $97
01/F1A2: 6B           RTL 

; [  ]

01/F1A3: AD 49 00     LDA $0049
01/F1A6: 0A           ASL 
01/F1A7: AA           TAX 
01/F1A8: BD 53 F0     LDA $F053,X
01/F1AB: 29 F8        AND #$F8
01/F1AD: 8D 11 F1     STA $F111
01/F1B0: A8           TAY 
01/F1B1: 84 00        STY $00
01/F1B3: 8C 33 F1     STY $F133
01/F1B6: BD 54 F0     LDA $F054,X
01/F1B9: 29 F8        AND #$F8
01/F1BB: 8D 12 F1     STA $F112
01/F1BE: A8           TAY 
01/F1BF: 8C 35 F1     STY $F135
01/F1C2: 84 02        STY $02
01/F1C4: 4A           LSR 
01/F1C5: 4A           LSR 
01/F1C6: 4A           LSR 
01/F1C7: 8D 37 F1     STA $F137
01/F1CA: C2 20        REP #$20
01/F1CC: A9 28 00     LDA #$0028
01/F1CF: 38           SEC 
01/F1D0: E5 00        SBC $00
01/F1D2: 38           SEC 
01/F1D3: E5 02        SBC $02
01/F1D5: 8D 06 F4     STA $F406
01/F1D8: A9 50 00     LDA #$0050
01/F1DB: 8D 08 F4     STA $F408
01/F1DE: E2 20        SEP #$20
01/F1E0: 22 70 ED 01  JSL $01ED70
01/F1E4: 20 09 EE     JSR $EE09       ; wait one frame
01/F1E7: C2 20        REP #$20
01/F1E9: AD 06 F4     LDA $F406
01/F1EC: 18           CLC 
01/F1ED: 69 08 00     ADC #$0008
01/F1F0: 8D 06 F4     STA $F406
01/F1F3: AD 08 F4     LDA $F408
01/F1F6: 38           SEC 
01/F1F7: E9 08 00     SBC #$0008
01/F1FA: 8D 08 F4     STA $F408
01/F1FD: 7B           TDC 
01/F1FE: E2 20        SEP #$20
01/F200: 22 70 ED 01  JSL $01ED70
01/F204: CE 37 F1     DEC $F137
01/F207: D0 DB        BNE $F1E4
01/F209: A9 38        LDA #$38
01/F20B: 8D 13 F1     STA $F113
01/F20E: A9 50        LDA #$50
01/F210: 8D 14 F1     STA $F114
01/F213: A9 08        LDA #$08
01/F215: 8D 15 F1     STA $F115
01/F218: 22 BC E7 02  JSL $02E7BC
01/F21C: 22 E1 C3 02  JSL $02C3E1
01/F220: A9 28        LDA #$28
01/F222: 22 D7 F5 02  JSL $02F5D7
01/F226: 20 09 EE     JSR $EE09       ; wait one frame
01/F229: 22 5C E8 02  JSL $02E85C
01/F22D: 22 04 C4 02  JSL $02C404
01/F231: A5 2B        LDA $2B
01/F233: 85 2A        STA $2A
01/F235: A5 2B        LDA $2B
01/F237: 30 04        BMI $F23D
01/F239: 64 2B        STZ $2B
01/F23B: 80 04        BRA $F241
01/F23D: A9 FF        LDA #$FF
01/F23F: 85 2B        STA $2B
01/F241: C2 20        REP #$20
01/F243: AD 06 F4     LDA $F406
01/F246: 18           CLC 
01/F247: 69 08 00     ADC #$0008
01/F24A: 8D 06 F4     STA $F406
01/F24D: AD 08 F4     LDA $F408
01/F250: 38           SEC 
01/F251: ED 21 F1     SBC $F121
01/F254: 8D 08 F4     STA $F408
01/F257: 7B           TDC 
01/F258: E2 20        SEP #$20
01/F25A: AD 06 F4     LDA $F406
01/F25D: F0 07        BEQ $F266
01/F25F: 22 62 ED 01  JSL $01ED62
01/F263: 4C 26 F2     JMP $F226
01/F266: A2 00 00     LDX #$0000
01/F269: 8E 06 F4     STX $F406
01/F26C: 8E 08 F4     STX $F408
01/F26F: 22 70 ED 01  JSL $01ED70
01/F273: 6B           RTL 

; [  ]

01/F274: 7B           TDC 
01/F275: AA           TAX 
01/F276: 8E 06 F4     STX $F406
01/F279: 8E 08 F4     STX $F408
01/F27C: 20 09 EE     JSR $EE09       ; wait one frame
01/F27F: 22 70 ED 01  JSL $01ED70
01/F283: C2 20        REP #$20
01/F285: AD 06 F4     LDA $F406
01/F288: 38           SEC 
01/F289: E9 08 00     SBC #$0008
01/F28C: 8D 06 F4     STA $F406
01/F28F: 7B           TDC 
01/F290: E2 20        SEP #$20
01/F292: E8           INX 
01/F293: E0 14 00     CPX #$0014
01/F296: D0 E4        BNE $F27C
01/F298: 6B           RTL 

; [  ]

01/F299: 7B           TDC 
01/F29A: AA           TAX 
01/F29B: 20 09 EE     JSR $EE09       ; wait one frame
01/F29E: 22 70 ED 01  JSL $01ED70
01/F2A2: C2 20        REP #$20
01/F2A4: AD 06 F4     LDA $F406
01/F2A7: 18           CLC 
01/F2A8: 69 08 00     ADC #$0008
01/F2AB: 8D 06 F4     STA $F406
01/F2AE: 7B           TDC 
01/F2AF: E2 20        SEP #$20
01/F2B1: E8           INX 
01/F2B2: E0 15 00     CPX #$0015
01/F2B5: D0 E4        BNE $F29B
01/F2B7: 6B           RTL 

; [  ]

01/F2B8: AD 0E F4     LDA $F40E
01/F2BB: F0 06        BEQ $F2C3
01/F2BD: A5 07        LDA $07
01/F2BF: 49 40        EOR #$40
01/F2C1: 85 07        STA $07
01/F2C3: AD 04 F4     LDA $F404
01/F2C6: 0A           ASL 
01/F2C7: AA           TAX 
01/F2C8: BF 6D FD 0D  LDA $0DFD6D,X
01/F2CC: 85 00        STA $00
01/F2CE: BF 6E FD 0D  LDA $0DFD6E,X
01/F2D2: 85 01        STA $01
01/F2D4: A9 0D        LDA #$0D
01/F2D6: 85 02        STA $02
01/F2D8: A0 00 00     LDY #$0000
01/F2DB: 20 EB F2     JSR $F2EB
01/F2DE: A0 40 00     LDY #$0040
01/F2E1: 20 EB F2     JSR $F2EB
01/F2E4: A0 80 00     LDY #$0080
01/F2E7: 20 EB F2     JSR $F2EB
01/F2EA: 6B           RTL 

; [  ]

01/F2EB: A2 03 00     LDX #$0003
01/F2EE: A7 00        LDA [$00]
01/F2F0: C9 FF        CMP #$FF
01/F2F2: D0 09        BNE $F2FD
01/F2F4: 7B           TDC 
01/F2F5: 91 04        STA ($04),Y
01/F2F7: C8           INY 
01/F2F8: A9 22        LDA #$22
01/F2FA: 4C 05 F3     JMP $F305
01/F2FD: 18           CLC 
01/F2FE: 65 06        ADC $06
01/F300: 91 04        STA ($04),Y
01/F302: C8           INY 
01/F303: A5 07        LDA $07
01/F305: 91 04        STA ($04),Y
01/F307: C8           INY 
01/F308: DA           PHX 
01/F309: A6 00        LDX $00
01/F30B: E8           INX 
01/F30C: 86 00        STX $00
01/F30E: FA           PLX 
01/F30F: CA           DEX 
01/F310: D0 DC        BNE $F2EE
01/F312: 60           RTS 

; [  ]

01/F313: 20 3C F3     JSR $F33C
01/F316: 6B           RTL 

; [  ]

01/F317: 64 4E        STZ $4E
01/F319: 20 09 EE     JSR $EE09       ; wait one frame
01/F31C: A5 4E        LDA $4E
01/F31E: 29 04        AND #$04
01/F320: 4A           LSR 
01/F321: 4A           LSR 
01/F322: D0 05        BNE $F329
01/F324: A9 34        LDA #$34
01/F326: 4C 2B F3     JMP $F32B
01/F329: A9 38        LDA #$38
01/F32B: 8D 30 F3     STA $F330
01/F32E: E6 4E        INC $4E
01/F330: A5 4E        LDA $4E
01/F332: C9 10        CMP #$10
01/F334: D0 E3        BNE $F319
01/F336: A9 38        LDA #$38
01/F338: 8D 30 F3     STA $F330
01/F33B: 60           RTS 

; [  ]

01/F33C: DA           PHX 
01/F33D: AD 21 F3     LDA $F321
01/F340: 38           SEC 
01/F341: E9 08        SBC #$08
01/F343: 8D 21 F3     STA $F321
01/F346: D0 03        BNE $F34B
01/F348: EE 2B F3     INC $F32B
01/F34B: AD 2B F3     LDA $F32B
01/F34E: F0 15        BEQ $F365
01/F350: AD 29 F3     LDA $F329
01/F353: C9 FF        CMP #$FF
01/F355: F0 0E        BEQ $F365
01/F357: AD 2B F3     LDA $F32B
01/F35A: AA           TAX 
01/F35B: BF 5C FD 0D  LDA $0DFD5C,X
01/F35F: 8D 29 F3     STA $F329
01/F362: EE 2B F3     INC $F32B
01/F365: FA           PLX 
01/F366: 60           RTS 

; [  ]

01/F367: A9 20        LDA #$20
01/F369: 8D C2 F0     STA $F0C2
01/F36C: 22 D9 F9 02  JSL $02F9D9
01/F370: 60           RTS 

; [  ]

01/F371: 20 A1 FD     JSR $FDA1
01/F374: 20 17 F3     JSR $F317
01/F377: 20 CF E9     JSR $E9CF
01/F37A: 20 67 F3     JSR $F367
01/F37D: 20 B1 FD     JSR $FDB1
01/F380: 6B           RTL 

; [  ]

01/F381: 20 A1 FD     JSR $FDA1
01/F384: 20 17 F3     JSR $F317
01/F387: 6B           RTL 

; [  ]

01/F388: EE 27 F3     INC $F327
01/F38B: 20 CF E9     JSR $E9CF
01/F38E: 20 67 F3     JSR $F367
01/F391: 9C 26 F3     STZ $F326
01/F394: 9C 27 F3     STZ $F327
01/F397: 6B           RTL 

; [  ]

01/F398: 20 09 EE     JSR $EE09       ; wait one frame
01/F39B: CA           DEX 
01/F39C: D0 FA        BNE $F398
01/F39E: 60           RTS 

; [  ]

01/F39F: EE 27 F3     INC $F327
01/F3A2: A2 20 00     LDX #$0020
01/F3A5: 20 98 F3     JSR $F398
01/F3A8: 9C 26 F3     STZ $F326
01/F3AB: 9C 27 F3     STZ $F327
01/F3AE: A2 08 00     LDX #$0008
01/F3B1: 20 98 F3     JSR $F398
01/F3B4: 60           RTS 

; [  ]

01/F3B5: 20 9F F3     JSR $F39F
01/F3B8: 6B           RTL 

; [  ]

01/F3B9: 20 1C E4     JSR $E41C
01/F3BC: 20 CF E9     JSR $E9CF
01/F3BF: 64 00        STZ $00
01/F3C1: A9 40        LDA #$40
01/F3C3: 85 02        STA $02
01/F3C5: 7B           TDC 
01/F3C6: AA           TAX 
01/F3C7: A5 00        LDA $00
01/F3C9: 9D 33 F1     STA $F133,X
01/F3CC: 18           CLC 
01/F3CD: 69 10        ADC #$10
01/F3CF: 85 00        STA $00
01/F3D1: 48           PHA 
01/F3D2: A5 02        LDA $02
01/F3D4: 9D 73 F1     STA $F173,X
01/F3D7: 18           CLC 
01/F3D8: 69 10        ADC #$10
01/F3DA: 85 02        STA $02
01/F3DC: 18           CLC 
01/F3DD: 69 70        ADC #$70
01/F3DF: 9D 77 F1     STA $F177,X
01/F3E2: 68           PLA 
01/F3E3: 18           CLC 
01/F3E4: 69 70        ADC #$70
01/F3E6: 9D 37 F1     STA $F137,X
01/F3E9: A9 18        LDA #$18
01/F3EB: 9D B3 F1     STA $F1B3,X
01/F3EE: 9D B7 F1     STA $F1B7,X
01/F3F1: 9D F3 F1     STA $F1F3,X
01/F3F4: 9D F7 F1     STA $F1F7,X
01/F3F7: E8           INX 
01/F3F8: E0 04 00     CPX #$0004
01/F3FB: D0 CA        BNE $F3C7
01/F3FD: AD 49 00     LDA $0049
01/F400: 0A           ASL 
01/F401: AA           TAX 
01/F402: AD C4 34     LDA $34C4
01/F405: 30 11        BMI $F418
01/F407: BD 53 F0     LDA $F053,X
01/F40A: 18           CLC 
01/F40B: 69 18        ADC #$18
01/F40D: 8D A8 F3     STA $F3A8
01/F410: BD 54 F0     LDA $F054,X
01/F413: 8D A9 F3     STA $F3A9
01/F416: 80 0C        BRA $F424
01/F418: BD 43 F0     LDA $F043,X
01/F41B: 8D A8 F3     STA $F3A8
01/F41E: BD 44 F0     LDA $F044,X
01/F421: 8D A9 F3     STA $F3A9
01/F424: AD A8 F3     LDA $F3A8
01/F427: 38           SEC 
01/F428: E9 08        SBC #$08
01/F42A: 8D A8 F3     STA $F3A8
01/F42D: AD A9 F3     LDA $F3A9
01/F430: 38           SEC 
01/F431: E9 08        SBC #$08
01/F433: 8D A9 F3     STA $F3A9
01/F436: A2 04 00     LDX #$0004
01/F439: 20 98 F3     JSR $F398
01/F43C: 7B           TDC 
01/F43D: AA           TAX 
01/F43E: 20 75 F9     JSR $F975
01/F441: 9D 98 F3     STA $F398,X
01/F444: 20 65 F9     JSR $F965
01/F447: 9D A0 F3     STA $F3A0,X
01/F44A: A9 F0        LDA #$F0
01/F44C: 20 96 F9     JSR $F996
01/F44F: E8           INX 
01/F450: E0 08 00     CPX #$0008
01/F453: D0 E9        BNE $F43E
01/F455: 20 8E F4     JSR $F48E
01/F458: 20 61 F4     JSR $F461
01/F45B: AD B3 F1     LDA $F1B3
01/F45E: D0 D6        BNE $F436
01/F460: 6B           RTL 

; [  ]

01/F461: 7B           TDC 
01/F462: AA           TAX 
01/F463: BD B3 F1     LDA $F1B3,X
01/F466: 9D B4 F1     STA $F1B4,X
01/F469: BD F3 F1     LDA $F1F3,X
01/F46C: 9D F4 F1     STA $F1F4,X
01/F46F: BD B7 F1     LDA $F1B7,X
01/F472: 9D B8 F1     STA $F1B8,X
01/F475: BD F7 F1     LDA $F1F7,X
01/F478: 9D F8 F1     STA $F1F8,X
01/F47B: E8           INX 
01/F47C: E0 03 00     CPX #$0003
01/F47F: D0 E2        BNE $F463
01/F481: CE B3 F1     DEC $F1B3
01/F484: CE B7 F1     DEC $F1B7
01/F487: CE F3 F1     DEC $F1F3
01/F48A: CE F7 F1     DEC $F1F7
01/F48D: 60           RTS 

; [  ]

01/F48E: 7B           TDC 
01/F48F: AA           TAX 
01/F490: A8           TAY 
01/F491: BD 98 F3     LDA $F398,X
01/F494: 18           CLC 
01/F495: 6D A8 F3     ADC $F3A8
01/F498: 99 40 03     STA $0340,Y
01/F49B: BD A0 F3     LDA $F3A0,X
01/F49E: 18           CLC 
01/F49F: 6D A9 F3     ADC $F3A9
01/F4A2: 99 41 03     STA $0341,Y
01/F4A5: BF 07 FE 0D  LDA $0DFE07,X
01/F4A9: 99 42 03     STA $0342,Y
01/F4AC: AD C0 6C     LDA $6CC0
01/F4AF: F0 13        BEQ $F4C4
01/F4B1: BD 98 F3     LDA $F398,X
01/F4B4: 18           CLC 
01/F4B5: 6D A8 F3     ADC $F3A8
01/F4B8: 49 FF        EOR #$FF
01/F4BA: 38           SEC 
01/F4BB: E9 10        SBC #$10
01/F4BD: 99 40 03     STA $0340,Y
01/F4C0: A9 7F        LDA #$7F
01/F4C2: 80 0C        BRA $F4D0
01/F4C4: BD 98 F3     LDA $F398,X
01/F4C7: 18           CLC 
01/F4C8: 6D A8 F3     ADC $F3A8
01/F4CB: 99 40 03     STA $0340,Y
01/F4CE: A9 3F        LDA #$3F
01/F4D0: 99 43 03     STA $0343,Y
01/F4D3: C8           INY 
01/F4D4: C8           INY 
01/F4D5: C8           INY 
01/F4D6: C8           INY 
01/F4D7: E8           INX 
01/F4D8: E0 08 00     CPX #$0008
01/F4DB: D0 B4        BNE $F491
01/F4DD: 60           RTS 

; [  ]

01/F4DE: 20 1C E4     JSR $E41C
01/F4E1: 20 CF E9     JSR $E9CF
01/F4E4: A9 84        LDA #$84
01/F4E6: 8D 27 F4     STA $F427
01/F4E9: A9 70        LDA #$70
01/F4EB: 85 04        STA $04
01/F4ED: 85 06        STA $06
01/F4EF: 20 27 F6     JSR $F627
01/F4F2: A9 04        LDA #$04
01/F4F4: 8D AC F3     STA $F3AC
01/F4F7: 8D AD F3     STA $F3AD
01/F4FA: 20 76 F6     JSR $F676
01/F4FD: AD C0 6C     LDA $6CC0
01/F500: F0 04        BEQ $F506
01/F502: A9 08        LDA #$08
01/F504: 80 02        BRA $F508
01/F506: A9 F8        LDA #$F8
01/F508: 85 02        STA $02
01/F50A: AD 49 00     LDA $0049
01/F50D: 0A           ASL 
01/F50E: A8           TAY 
01/F50F: AD C2 34     LDA $34C2
01/F512: 10 16        BPL $F52A
01/F514: B9 53 F0     LDA $F053,Y
01/F517: 18           CLC 
01/F518: 69 18        ADC #$18
01/F51A: 65 02        ADC $02
01/F51C: 8D 11 F1     STA $F111
01/F51F: B9 54 F0     LDA $F054,Y
01/F522: 38           SEC 
01/F523: E9 08        SBC #$08
01/F525: 8D 12 F1     STA $F112
01/F528: 80 12        BRA $F53C
01/F52A: B9 43 F0     LDA $F043,Y
01/F52D: 18           CLC 
01/F52E: 65 02        ADC $02
01/F530: 8D 11 F1     STA $F111
01/F533: B9 44 F0     LDA $F044,Y
01/F536: 38           SEC 
01/F537: E9 08        SBC #$08
01/F539: 8D 12 F1     STA $F112
01/F53C: AD 48 00     LDA $0048
01/F53F: 0A           ASL 
01/F540: A8           TAY 
01/F541: AD C4 34     LDA $34C4
01/F544: 10 14        BPL $F55A
01/F546: B9 53 F0     LDA $F053,Y
01/F549: 18           CLC 
01/F54A: 69 18        ADC #$18
01/F54C: 8D 13 F1     STA $F113
01/F54F: B9 54 F0     LDA $F054,Y
01/F552: 38           SEC 
01/F553: E9 08        SBC #$08
01/F555: 8D 14 F1     STA $F114
01/F558: 80 12        BRA $F56C
01/F55A: B9 43 F0     LDA $F043,Y
01/F55D: 18           CLC 
01/F55E: 65 02        ADC $02
01/F560: 8D 13 F1     STA $F113
01/F563: B9 44 F0     LDA $F044,Y
01/F566: 38           SEC 
01/F567: E9 08        SBC #$08
01/F569: 8D 14 F1     STA $F114
01/F56C: A9 10        LDA #$10
01/F56E: 8D 15 F1     STA $F115
01/F571: 22 BC E7 02  JSL $02E7BC
01/F575: EE 28 F4     INC $F428
01/F578: AD C2 34     LDA $34C2
01/F57B: 29 80        AND #$80
01/F57D: 85 00        STA $00
01/F57F: AD C4 34     LDA $34C4
01/F582: 29 80        AND #$80
01/F584: C5 00        CMP $00
01/F586: F0 11        BEQ $F599
01/F588: 22 5C E8 02  JSL $02E85C
01/F58C: B0 0B        BCS $F599
01/F58E: AE 18 F1     LDX $F118
01/F591: 8E 29 F4     STX $F429
01/F594: 20 A7 F6     JSR $F6A7
01/F597: 80 EF        BRA $F588
01/F599: 6B           RTL 

; [  ]

01/F59A: 20 1C E4     JSR $E41C
01/F59D: 7B           TDC 
01/F59E: AA           TAX 
01/F59F: 3A           DEC 
01/F5A0: 8D 27 F4     STA $F427
01/F5A3: BD 00 19     LDA $1900,X     ; rng table
01/F5A6: 20 0F F6     JSR $F60F
01/F5A9: 7B           TDC 
01/F5AA: 9D A6 EC     STA $ECA6,X
01/F5AD: E8           INX 
01/F5AE: E0 40 00     CPX #$0040
01/F5B1: D0 F0        BNE $F5A3
01/F5B3: 20 8B EE     JSR $EE8B
01/F5B6: A2 18 00     LDX #$0018
01/F5B9: DA           PHX 
01/F5BA: 9C 28 F4     STZ $F428
01/F5BD: 7B           TDC 
01/F5BE: A8           TAY 
01/F5BF: B9 B3 F1     LDA $F1B3,Y
01/F5C2: 4A           LSR 
01/F5C3: 4A           LSR 
01/F5C4: 4A           LSR 
01/F5C5: 4A           LSR 
01/F5C6: 4A           LSR 
01/F5C7: 29 03        AND #$03
01/F5C9: AA           TAX 
01/F5CA: BF 0F FE 0D  LDA $0DFE0F,X
01/F5CE: 99 66 EC     STA $EC66,Y
01/F5D1: C8           INY 
01/F5D2: C0 40 00     CPY #$0040
01/F5D5: D0 E8        BNE $F5BF
01/F5D7: A9 40        LDA #$40
01/F5D9: 20 BA F6     JSR $F6BA
01/F5DC: 7B           TDC 
01/F5DD: AA           TAX 
01/F5DE: BD A6 EC     LDA $ECA6,X
01/F5E1: D0 15        BNE $F5F8
01/F5E3: BD B3 F1     LDA $F1B3,X
01/F5E6: 38           SEC 
01/F5E7: E9 08        SBC #$08
01/F5E9: 9D B3 F1     STA $F1B3,X
01/F5EC: 9D F3 F1     STA $F1F3,X
01/F5EF: C9 10        CMP #$10
01/F5F1: B0 05        BCS $F5F8
01/F5F3: A9 01        LDA #$01
01/F5F5: 9D A6 EC     STA $ECA6,X
01/F5F8: E8           INX 
01/F5F9: E0 40 00     CPX #$0040
01/F5FC: D0 E0        BNE $F5DE
01/F5FE: FA           PLX 
01/F5FF: E0 09 00     CPX #$0009
01/F602: D0 04        BNE $F608
01/F604: 22 B9 EE 01  JSL $01EEB9
01/F608: CA           DEX 
01/F609: D0 AE        BNE $F5B9
01/F60B: 9C 87 EF     STZ $EF87
01/F60E: 6B           RTL 

; [  ]

01/F60F: 48           PHA 
01/F610: A8           TAY 
01/F611: B9 00 19     LDA $1900,Y     ; rng table
01/F614: 9D 33 F1     STA $F133,X
01/F617: 18           CLC 
01/F618: 69 40        ADC #$40
01/F61A: 9D 73 F1     STA $F173,X
01/F61D: 68           PLA 
01/F61E: 29 FC        AND #$FC
01/F620: 9D B3 F1     STA $F1B3,X
01/F623: 9D F3 F1     STA $F1F3,X
01/F626: 60           RTS 

; [  ]

01/F627: 9C 28 F4     STZ $F428
01/F62A: 7B           TDC 
01/F62B: AA           TAX 
01/F62C: 64 00        STZ $00
01/F62E: A9 40        LDA #$40
01/F630: 85 02        STA $02
01/F632: A5 00        LDA $00
01/F634: 9D 33 F1     STA $F133,X
01/F637: 18           CLC 
01/F638: 69 20        ADC #$20
01/F63A: 85 00        STA $00
01/F63C: A5 02        LDA $02
01/F63E: 9D 73 F1     STA $F173,X
01/F641: 18           CLC 
01/F642: 69 20        ADC #$20
01/F644: 85 02        STA $02
01/F646: A5 04        LDA $04
01/F648: 9D B3 F1     STA $F1B3,X
01/F64B: A5 06        LDA $06
01/F64D: 9D F3 F1     STA $F1F3,X
01/F650: E8           INX 
01/F651: E0 40 00     CPX #$0040
01/F654: D0 DC        BNE $F632
01/F656: 60           RTS 

; [  ]

01/F657: 20 B8 F6     JSR $F6B8
01/F65A: 7B           TDC 
01/F65B: AA           TAX 
01/F65C: A9 08        LDA #$08
01/F65E: 20 96 F9     JSR $F996
01/F661: AD AC F3     LDA $F3AC
01/F664: 20 85 F9     JSR $F985
01/F667: E8           INX 
01/F668: E0 08 00     CPX #$0008
01/F66B: D0 EF        BNE $F65C
01/F66D: AD B3 F1     LDA $F1B3
01/F670: CD AD F3     CMP $F3AD
01/F673: D0 E2        BNE $F657
01/F675: 60           RTS 

; [  ]

01/F676: 20 B8 F6     JSR $F6B8
01/F679: 7B           TDC 
01/F67A: AA           TAX 
01/F67B: A9 08        LDA #$08
01/F67D: 20 96 F9     JSR $F996
01/F680: BD B3 F1     LDA $F1B3,X
01/F683: F0 07        BEQ $F68C
01/F685: 38           SEC 
01/F686: ED AC F3     SBC $F3AC
01/F689: 9D B3 F1     STA $F1B3,X
01/F68C: BD F3 F1     LDA $F1F3,X
01/F68F: F0 07        BEQ $F698
01/F691: 38           SEC 
01/F692: ED AC F3     SBC $F3AC
01/F695: 9D F3 F1     STA $F1F3,X
01/F698: E8           INX 
01/F699: E0 08 00     CPX #$0008
01/F69C: D0 DD        BNE $F67B
01/F69E: AD F3 F1     LDA $F1F3
01/F6A1: CD AD F3     CMP $F3AD
01/F6A4: D0 D0        BNE $F676
01/F6A6: 60           RTS 

; [  ]

01/F6A7: 20 B8 F6     JSR $F6B8
01/F6AA: 7B           TDC 
01/F6AB: AA           TAX 
01/F6AC: A9 08        LDA #$08
01/F6AE: 20 96 F9     JSR $F996
01/F6B1: E8           INX 
01/F6B2: E0 10 00     CPX #$0010
01/F6B5: D0 F5        BNE $F6AC
01/F6B7: 60           RTS 

; [  ]

01/F6B8: A9 08        LDA #$08
01/F6BA: 8D 2C F4     STA $F42C
01/F6BD: 9C 2D F4     STZ $F42D
01/F6C0: 20 09 EE     JSR $EE09       ; wait one frame
01/F6C3: 7B           TDC 
01/F6C4: AA           TAX 
01/F6C5: 20 75 F9     JSR $F975
01/F6C8: 9D E6 EB     STA $EBE6,X
01/F6CB: 20 65 F9     JSR $F965
01/F6CE: 9D 26 EC     STA $EC26,X
01/F6D1: E8           INX 
01/F6D2: EC 2C F4     CPX $F42C
01/F6D5: D0 EE        BNE $F6C5
01/F6D7: 7B           TDC 
01/F6D8: AA           TAX 
01/F6D9: 86 04        STX $04
01/F6DB: A2 40 00     LDX #$0040
01/F6DE: 86 06        STX $06
01/F6E0: AD C0 6C     LDA $6CC0
01/F6E3: F0 04        BEQ $F6E9
01/F6E5: A9 08        LDA #$08
01/F6E7: 80 02        BRA $F6EB
01/F6E9: A9 F8        LDA #$F8
01/F6EB: 85 02        STA $02
01/F6ED: AD 28 F4     LDA $F428
01/F6F0: F0 08        BEQ $F6FA
01/F6F2: AE 29 F4     LDX $F429
01/F6F5: 86 00        STX $00
01/F6F7: 4C 5F F7     JMP $F75F
01/F6FA: AD C4 34     LDA $34C4
01/F6FD: 30 31        BMI $F730
01/F6FF: 7B           TDC 
01/F700: AA           TAX 
01/F701: AD C5 34     LDA $34C5
01/F704: 85 0C        STA $0C
01/F706: 06 0C        ASL $0C
01/F708: 90 1F        BCC $F729
01/F70A: BD C5 29     LDA $29C5,X
01/F70D: C9 FF        CMP #$FF
01/F70F: F0 18        BEQ $F729
01/F711: 8A           TXA 
01/F712: 0A           ASL 
01/F713: A8           TAY 
01/F714: B9 53 F0     LDA $F053,Y
01/F717: 18           CLC 
01/F718: 69 18        ADC #$18
01/F71A: 65 02        ADC $02
01/F71C: 85 00        STA $00
01/F71E: B9 54 F0     LDA $F054,Y
01/F721: 38           SEC 
01/F722: E9 08        SBC #$08
01/F724: 85 01        STA $01
01/F726: 20 5F F7     JSR $F75F
01/F729: E8           INX 
01/F72A: E0 05 00     CPX #$0005
01/F72D: D0 D7        BNE $F706
01/F72F: 60           RTS 
01/F730: 7B           TDC 
01/F731: AA           TAX 
01/F732: AD C5 34     LDA $34C5
01/F735: 85 0C        STA $0C
01/F737: 06 0C        ASL $0C
01/F739: 90 1D        BCC $F758
01/F73B: BD 23 F1     LDA $F123,X
01/F73E: C9 FF        CMP #$FF
01/F740: F0 16        BEQ $F758
01/F742: 8A           TXA 
01/F743: 0A           ASL 
01/F744: A8           TAY 
01/F745: B9 43 F0     LDA $F043,Y
01/F748: 18           CLC 
01/F749: 65 02        ADC $02
01/F74B: 85 00        STA $00
01/F74D: B9 44 F0     LDA $F044,Y
01/F750: 38           SEC 
01/F751: E9 08        SBC #$08
01/F753: 85 01        STA $01
01/F755: 20 5F F7     JSR $F75F
01/F758: E8           INX 
01/F759: E0 08 00     CPX #$0008
01/F75C: D0 D9        BNE $F737
01/F75E: 60           RTS 

; [  ]

01/F75F: EE 2B F4     INC $F42B
01/F762: DA           PHX 
01/F763: 7B           TDC 
01/F764: AA           TAX 
01/F765: A4 06        LDY $06
01/F767: BD E6 EB     LDA $EBE6,X
01/F76A: 30 07        BMI $F773
01/F76C: 18           CLC 
01/F76D: 65 00        ADC $00
01/F76F: B0 07        BCS $F778
01/F771: 80 07        BRA $F77A
01/F773: 18           CLC 
01/F774: 65 00        ADC $00
01/F776: B0 02        BCS $F77A
01/F778: 80 1A        BRA $F794
01/F77A: 99 00 03     STA $0300,Y
01/F77D: BD 26 EC     LDA $EC26,X
01/F780: 30 07        BMI $F789
01/F782: 18           CLC 
01/F783: 65 01        ADC $01
01/F785: B0 07        BCS $F78E
01/F787: 80 07        BRA $F790
01/F789: 18           CLC 
01/F78A: 65 01        ADC $01
01/F78C: B0 02        BCS $F790
01/F78E: 80 04        BRA $F794
01/F790: C9 80        CMP #$80
01/F792: 90 0A        BCC $F79E
01/F794: A9 F0        LDA #$F0
01/F796: 99 00 03     STA $0300,Y
01/F799: 99 01 03     STA $0301,Y
01/F79C: 80 03        BRA $F7A1
01/F79E: 99 01 03     STA $0301,Y
01/F7A1: AD 27 F4     LDA $F427
01/F7A4: C9 FF        CMP #$FF
01/F7A6: D0 14        BNE $F7BC
01/F7A8: BD A6 EC     LDA $ECA6,X
01/F7AB: F0 0A        BEQ $F7B7
01/F7AD: A9 F0        LDA #$F0
01/F7AF: 99 00 03     STA $0300,Y
01/F7B2: 99 01 03     STA $0301,Y
01/F7B5: 80 29        BRA $F7E0
01/F7B7: BD 66 EC     LDA $EC66,X
01/F7BA: 80 08        BRA $F7C4
01/F7BC: 8A           TXA 
01/F7BD: 29 01        AND #$01
01/F7BF: 0A           ASL 
01/F7C0: 18           CLC 
01/F7C1: 6D 27 F4     ADC $F427
01/F7C4: 99 02 03     STA $0302,Y
01/F7C7: AD C0 6C     LDA $6CC0
01/F7CA: F0 0F        BEQ $F7DB
01/F7CC: B9 00 03     LDA $0300,Y
01/F7CF: 49 FF        EOR #$FF
01/F7D1: 99 00 03     STA $0300,Y
01/F7D4: A9 7F        LDA #$7F
01/F7D6: 99 03 03     STA $0303,Y
01/F7D9: 80 05        BRA $F7E0
01/F7DB: A9 3F        LDA #$3F
01/F7DD: 99 03 03     STA $0303,Y
01/F7E0: E8           INX 
01/F7E1: C8           INY 
01/F7E2: C8           INY 
01/F7E3: C8           INY 
01/F7E4: C8           INY 
01/F7E5: EC 2C F4     CPX $F42C
01/F7E8: F0 03        BEQ $F7ED
01/F7EA: 4C 67 F7     JMP $F767
01/F7ED: 84 06        STY $06
01/F7EF: FA           PLX 
01/F7F0: 9C 2B F4     STZ $F42B
01/F7F3: 60           RTS 

; [  ]

01/F7F4: 20 A1 FD     JSR $FDA1
01/F7F7: 20 17 F3     JSR $F317
01/F7FA: 7B           TDC 
01/F7FB: 22 5D EB 02  JSL $02EB5D
01/F7FF: 20 B1 FD     JSR $FDB1
01/F802: 6B           RTL 

; [  ]

01/F803: A9 1F        LDA #$1F
01/F805: 22 5D EB 02  JSL $02EB5D
01/F809: 7B           TDC 
01/F80A: AA           TAX 
01/F80B: BD 23 F1     LDA $F123,X
01/F80E: C9 FF        CMP #$FF
01/F810: F0 0F        BEQ $F821
01/F812: 8A           TXA 
01/F813: 8D C3 34     STA $34C3
01/F816: 8D 48 00     STA $0048
01/F819: DA           PHX 
01/F81A: A9 1F        LDA #$1F
01/F81C: 22 5D EB 02  JSL $02EB5D
01/F820: FA           PLX 
01/F821: E8           INX 
01/F822: E0 08 00     CPX #$0008
01/F825: D0 E4        BNE $F80B
01/F827: 6B           RTL 

; [  ]

01/F828: 7B           TDC 
01/F829: AA           TAX 
01/F82A: A0 40 00     LDY #$0040
01/F82D: BD 06 ED     LDA $ED06,X
01/F830: D0 0B        BNE $F83D
01/F832: A9 F0        LDA #$F0
01/F834: 99 00 03     STA $0300,Y
01/F837: 99 01 03     STA $0301,Y
01/F83A: 4C 6E F8     JMP $F86E
01/F83D: AD C0 6C     LDA $6CC0
01/F840: F0 17        BEQ $F859
01/F842: BD E6 EB     LDA $EBE6,X
01/F845: 18           CLC 
01/F846: 7D 76 EC     ADC $EC76,X
01/F849: 49 FF        EOR #$FF
01/F84B: 38           SEC 
01/F84C: E9 08        SBC #$08
01/F84E: 99 00 03     STA $0300,Y
01/F851: A9 7F        LDA #$7F
01/F853: 99 03 03     STA $0303,Y
01/F856: 4C 68 F8     JMP $F868
01/F859: BD E6 EB     LDA $EBE6,X
01/F85C: 18           CLC 
01/F85D: 7D 76 EC     ADC $EC76,X
01/F860: 99 00 03     STA $0300,Y
01/F863: A9 3F        LDA #$3F
01/F865: 99 03 03     STA $0303,Y
01/F868: BD 2E EC     LDA $EC2E,X
01/F86B: 99 01 03     STA $0301,Y
01/F86E: AD 13 18     LDA $1813
01/F871: 29 02        AND #$02
01/F873: 18           CLC 
01/F874: 69 9C        ADC #$9C
01/F876: 99 02 03     STA $0302,Y
01/F879: E8           INX 
01/F87A: C8           INY 
01/F87B: C8           INY 
01/F87C: C8           INY 
01/F87D: C8           INY 
01/F87E: E0 48 00     CPX #$0048
01/F881: D0 AA        BNE $F82D
01/F883: 60           RTS 

; [  ]

01/F884: 20 A1 FD     JSR $FDA1
01/F887: 20 CF E9     JSR $E9CF
01/F88A: A9 08        LDA #$08
01/F88C: 8D 26 F3     STA $F326
01/F88F: 22 FF E6 02  JSL $02E6FF
01/F893: 7B           TDC 
01/F894: AA           TAX 
01/F895: 64 00        STZ $00
01/F897: 64 02        STZ $02
01/F899: BD 00 19     LDA $1900,X     ; rng table
01/F89C: 9D E6 EB     STA $EBE6,X
01/F89F: A5 02        LDA $02
01/F8A1: 9D 2E EC     STA $EC2E,X
01/F8A4: 18           CLC 
01/F8A5: 69 08        ADC #$08
01/F8A7: 85 02        STA $02
01/F8A9: C9 88        CMP #$88
01/F8AB: D0 02        BNE $F8AF
01/F8AD: 64 02        STZ $02
01/F8AF: 7B           TDC 
01/F8B0: 9D 76 EC     STA $EC76,X
01/F8B3: 9D 06 ED     STA $ED06,X
01/F8B6: BD 00 19     LDA $1900,X     ; rng table
01/F8B9: 9D BE EC     STA $ECBE,X
01/F8BC: E8           INX 
01/F8BD: E0 48 00     CPX #$0048
01/F8C0: D0 D7        BNE $F899
01/F8C2: 20 8F EE     JSR $EE8F
01/F8C5: A2 80 00     LDX #$0080
01/F8C8: DA           PHX 
01/F8C9: 20 09 EE     JSR $EE09       ; wait one frame
01/F8CC: 20 28 F8     JSR $F828
01/F8CF: 7B           TDC 
01/F8D0: AA           TAX 
01/F8D1: BD 00 19     LDA $1900,X     ; rng table
01/F8D4: 29 02        AND #$02
01/F8D6: 18           CLC 
01/F8D7: 69 02        ADC #$02
01/F8D9: 85 00        STA $00
01/F8DB: BD 2E EC     LDA $EC2E,X
01/F8DE: 18           CLC 
01/F8DF: 65 00        ADC $00
01/F8E1: C9 88        CMP #$88
01/F8E3: 90 04        BCC $F8E9
01/F8E5: FE 06 ED     INC $ED06,X
01/F8E8: 7B           TDC 
01/F8E9: 9D 2E EC     STA $EC2E,X
01/F8EC: E8           INX 
01/F8ED: E0 48 00     CPX #$0048
01/F8F0: D0 DF        BNE $F8D1
01/F8F2: 7B           TDC 
01/F8F3: AA           TAX 
01/F8F4: A9 18        LDA #$18
01/F8F6: 85 28        STA $28
01/F8F8: 86 00        STX $00
01/F8FA: BD BE EC     LDA $ECBE,X
01/F8FD: 18           CLC 
01/F8FE: 69 08        ADC #$08
01/F900: 9D BE EC     STA $ECBE,X
01/F903: 22 96 E7 02  JSL $02E796
01/F907: A6 00        LDX $00
01/F909: 9D 76 EC     STA $EC76,X
01/F90C: E8           INX 
01/F90D: E0 48 00     CPX #$0048
01/F910: D0 E2        BNE $F8F4
01/F912: 7B           TDC 
01/F913: AA           TAX 
01/F914: BD 00 19     LDA $1900,X     ; rng table
01/F917: 29 0F        AND #$0F
01/F919: 85 00        STA $00
01/F91B: BD E6 EB     LDA $EBE6,X
01/F91E: 38           SEC 
01/F91F: E5 00        SBC $00
01/F921: 9D E6 EB     STA $EBE6,X
01/F924: BD 0A EC     LDA $EC0A,X
01/F927: 38           SEC 
01/F928: E9 04        SBC #$04
01/F92A: 9D 0A EC     STA $EC0A,X
01/F92D: E8           INX 
01/F92E: E0 24 00     CPX #$0024
01/F931: D0 E1        BNE $F914
01/F933: FA           PLX 
01/F934: CA           DEX 
01/F935: D0 91        BNE $F8C8
01/F937: 9C 87 EF     STZ $EF87
01/F93A: 22 FF E6 02  JSL $02E6FF
01/F93E: 20 B1 FD     JSR $FDB1
01/F941: 6B           RTL 

; [  ]

01/F942: 20 A1 FD     JSR $FDA1
01/F945: A9 08        LDA #$08
01/F947: 8D 26 F3     STA $F326
01/F94A: 7B           TDC 
01/F94B: 22 5D EB 02  JSL $02EB5D
01/F94F: 20 B1 FD     JSR $FDB1
01/F952: 6B           RTL 

; [  ]

01/F953: 20 A1 FD     JSR $FDA1
01/F956: A9 08        LDA #$08
01/F958: 8D 26 F3     STA $F326
01/F95B: A9 07        LDA #$07
01/F95D: 22 5D EB 02  JSL $02EB5D
01/F961: 20 B1 FD     JSR $FDB1
01/F964: 6B           RTL 

; [  ]

01/F965: DA           PHX 
01/F966: BD B3 F1     LDA $F1B3,X
01/F969: 0A           ASL 
01/F96A: 85 28        STA $28
01/F96C: BD 33 F1     LDA $F133,X
01/F96F: 22 96 E7 02  JSL $02E796
01/F973: FA           PLX 
01/F974: 60           RTS 

; [  ]

01/F975: DA           PHX 
01/F976: BD F3 F1     LDA $F1F3,X
01/F979: 0A           ASL 
01/F97A: 85 28        STA $28
01/F97C: BD 73 F1     LDA $F173,X
01/F97F: 22 96 E7 02  JSL $02E796
01/F983: FA           PLX 
01/F984: 60           RTS 

; [  ]

01/F985: 48           PHA 
01/F986: 18           CLC 
01/F987: 7D F3 F1     ADC $F1F3,X
01/F98A: 9D F3 F1     STA $F1F3,X
01/F98D: 68           PLA 
01/F98E: 18           CLC 
01/F98F: 7D B3 F1     ADC $F1B3,X
01/F992: 9D B3 F1     STA $F1B3,X
01/F995: 60           RTS 

; [  ]

01/F996: 48           PHA 
01/F997: 18           CLC 
01/F998: 7D 73 F1     ADC $F173,X
01/F99B: 9D 73 F1     STA $F173,X
01/F99E: 68           PLA 
01/F99F: 18           CLC 
01/F9A0: 7D 33 F1     ADC $F133,X
01/F9A3: 9D 33 F1     STA $F133,X
01/F9A6: 60           RTS 

; [  ]

01/F9A7: 7B           TDC 
01/F9A8: AA           TAX 
01/F9A9: A8           TAY 
01/F9AA: BD 66 EC     LDA $EC66,X
01/F9AD: F0 21        BEQ $F9D0
01/F9AF: BD 26 EC     LDA $EC26,X
01/F9B2: D0 1C        BNE $F9D0
01/F9B4: 20 75 F9     JSR $F975
01/F9B7: 18           CLC 
01/F9B8: 7D E6 EB     ADC $EBE6,X
01/F9BB: 85 00        STA $00
01/F9BD: 20 65 F9     JSR $F965
01/F9C0: 18           CLC 
01/F9C1: 69 48        ADC #$48
01/F9C3: 85 02        STA $02
01/F9C5: A5 00        LDA $00
01/F9C7: C9 E0        CMP #$E0
01/F9C9: 90 0B        BCC $F9D6
01/F9CB: A9 01        LDA #$01
01/F9CD: 9D 26 EC     STA $EC26,X
01/F9D0: A9 F0        LDA #$F0
01/F9D2: 85 00        STA $00
01/F9D4: 85 02        STA $02
01/F9D6: AD 13 18     LDA $1813
01/F9D9: 29 02        AND #$02
01/F9DB: 18           CLC 
01/F9DC: 69 8C        ADC #$8C
01/F9DE: 9C 84 F4     STZ $F484
01/F9E1: 20 0B E5     JSR $E50B
01/F9E4: E8           INX 
01/F9E5: E0 40 00     CPX #$0040
01/F9E8: D0 C0        BNE $F9AA
01/F9EA: 60           RTS 

; [  ]

01/F9EB: 20 A1 FD     JSR $FDA1
01/F9EE: 7B           TDC 
01/F9EF: AA           TAX 
01/F9F0: BD 00 19     LDA $1900,X     ; rng table
01/F9F3: 9D 33 F1     STA $F133,X
01/F9F6: 18           CLC 
01/F9F7: 69 40        ADC #$40
01/F9F9: 9D 73 F1     STA $F173,X
01/F9FC: 9E B3 F1     STZ $F1B3,X
01/F9FF: A9 08        LDA #$08
01/FA01: 9D F3 F1     STA $F1F3,X
01/FA04: A9 98        LDA #$98
01/FA06: 9D E6 EB     STA $EBE6,X
01/FA09: 9E 26 EC     STZ $EC26,X
01/FA0C: 9E 66 EC     STZ $EC66,X
01/FA0F: E8           INX 
01/FA10: E0 40 00     CPX #$0040
01/FA13: D0 DB        BNE $F9F0
01/FA15: 20 1C E4     JSR $E41C
01/FA18: 20 93 EE     JSR $EE93
01/FA1B: 20 CF E9     JSR $E9CF
01/FA1E: 20 09 EE     JSR $EE09       ; wait one frame
01/FA21: 20 A7 F9     JSR $F9A7
01/FA24: AD E6 EB     LDA $EBE6
01/FA27: 38           SEC 
01/FA28: E9 06        SBC #$06
01/FA2A: 8D E6 EB     STA $EBE6
01/FA2D: A9 01        LDA #$01
01/FA2F: 8D 66 EC     STA $EC66
01/FA32: 7B           TDC 
01/FA33: AA           TAX 
01/FA34: A9 10        LDA #$10
01/FA36: 20 96 F9     JSR $F996
01/FA39: E8           INX 
01/FA3A: E0 40 00     CPX #$0040
01/FA3D: D0 F5        BNE $FA34
01/FA3F: AD B3 F1     LDA $F1B3
01/FA42: 18           CLC 
01/FA43: 69 02        ADC #$02
01/FA45: 8D B3 F1     STA $F1B3
01/FA48: A2 3E 00     LDX #$003E
01/FA4B: BD E6 EB     LDA $EBE6,X
01/FA4E: 9D E7 EB     STA $EBE7,X
01/FA51: BD 66 EC     LDA $EC66,X
01/FA54: 9D 67 EC     STA $EC67,X
01/FA57: BD B3 F1     LDA $F1B3,X
01/FA5A: 9D B4 F1     STA $F1B4,X
01/FA5D: BD F3 F1     LDA $F1F3,X
01/FA60: 9D F4 F1     STA $F1F4,X
01/FA63: CA           DEX 
01/FA64: E0 FF FF     CPX #$FFFF
01/FA67: D0 E2        BNE $FA4B
01/FA69: 7B           TDC 
01/FA6A: AA           TAX 
01/FA6B: BD 26 EC     LDA $EC26,X
01/FA6E: F0 AE        BEQ $FA1E
01/FA70: E8           INX 
01/FA71: E0 40 00     CPX #$0040
01/FA74: D0 F5        BNE $FA6B
01/FA76: 9C 87 EF     STZ $EF87
01/FA79: 20 B1 FD     JSR $FDB1
01/FA7C: 6B           RTL 

; [  ]

01/FA7D: 6B           RTL 

; [  ]

01/FA7E: 9C 26 F3     STZ $F326
01/FA81: 9C 85 F4     STZ $F485
01/FA84: 20 CF E9     JSR $E9CF
01/FA87: A2 78 00     LDX #$0078
01/FA8A: 20 09 EE     JSR $EE09       ; wait one frame
01/FA8D: AD 26 F3     LDA $F326
01/FA90: 1A           INC 
01/FA91: 29 0F        AND #$0F
01/FA93: 8D 26 F3     STA $F326
01/FA96: CA           DEX 
01/FA97: D0 F1        BNE $FA8A
01/FA99: A9 10        LDA #$10
01/FA9B: 8D 26 F3     STA $F326
01/FA9E: 6B           RTL 

; [  ]

01/FA9F: 20 CF E9     JSR $E9CF
01/FAA2: EE 27 F3     INC $F327
01/FAA5: A2 12 00     LDX #$0012
01/FAA8: 20 98 F3     JSR $F398
01/FAAB: 9C 27 F3     STZ $F327
01/FAAE: A2 20 00     LDX #$0020
01/FAB1: 20 09 EE     JSR $EE09       ; wait one frame
01/FAB4: 20 3C F3     JSR $F33C
01/FAB7: CA           DEX 
01/FAB8: D0 F7        BNE $FAB1
01/FABA: A9 62        LDA #$62
01/FABC: 8F 07 21 00  STA $002107
01/FAC0: 7B           TDC 
01/FAC1: 8D 33 F1     STA $F133
01/FAC4: A9 80        LDA #$80
01/FAC6: 8D 34 F1     STA $F134
01/FAC9: 20 09 EE     JSR $EE09       ; wait one frame
01/FACC: AD 33 F1     LDA $F133
01/FACF: C9 10        CMP #$10
01/FAD1: 90 14        BCC $FAE7
01/FAD3: A9 02        LDA #$02
01/FAD5: 8F 30 21 00  STA $002130
01/FAD9: 8F 2D 21 00  STA $00212D
01/FADD: A9 41        LDA #$41
01/FADF: 8F 31 21 00  STA $002131
01/FAE3: 22 CF F2 02  JSL $02F2CF
01/FAE7: 64 02        STZ $02
01/FAE9: A9 03        LDA #$03
01/FAEB: 85 06        STA $06
01/FAED: AD 33 F1     LDA $F133
01/FAF0: 22 F3 E9 02  JSL $02E9F3
01/FAF4: AD 34 F1     LDA $F134
01/FAF7: 22 F3 E9 02  JSL $02E9F3
01/FAFB: C6 06        DEC $06
01/FAFD: D0 EE        BNE $FAED
01/FAFF: EE 33 F1     INC $F133
01/FB02: EE 34 F1     INC $F134
01/FB05: AD 33 F1     LDA $F133
01/FB08: C9 40        CMP #$40
01/FB0A: D0 BD        BNE $FAC9
01/FB0C: A9 1E        LDA #$1E
01/FB0E: 8F 2C 21 00  STA $00212C
01/FB12: EE 83 F4     INC $F483
01/FB15: 6B           RTL 

; [  ]

01/FB16: 9C 46 F4     STZ $F446
01/FB19: 80 05        BRA $FB20
01/FB1B: A9 01        LDA #$01
01/FB1D: 8D 46 F4     STA $F446
01/FB20: 7B           TDC 
01/FB21: AA           TAX 
01/FB22: A8           TAY 
01/FB23: BF 13 FE 0D  LDA $0DFE13,X
01/FB27: 99 42 03     STA $0342,Y
01/FB2A: E8           INX 
01/FB2B: E0 0C 00     CPX #$000C
01/FB2E: D0 02        BNE $FB32
01/FB30: 7B           TDC 
01/FB31: AA           TAX 
01/FB32: AD C0 6C     LDA $6CC0
01/FB35: F0 09        BEQ $FB40
01/FB37: AD 46 F4     LDA $F446
01/FB3A: F0 09        BEQ $FB45
01/FB3C: A9 7F        LDA #$7F
01/FB3E: 80 07        BRA $FB47
01/FB40: AD 46 F4     LDA $F446
01/FB43: F0 F7        BEQ $FB3C
01/FB45: A9 3F        LDA #$3F
01/FB47: 99 43 03     STA $0343,Y
01/FB4A: C8           INY 
01/FB4B: C8           INY 
01/FB4C: C8           INY 
01/FB4D: C8           INY 
01/FB4E: C0 20 01     CPY #$0120
01/FB51: D0 D0        BNE $FB23
01/FB53: 7B           TDC 
01/FB54: AA           TAX 
01/FB55: A8           TAY 
01/FB56: BF 1F FE 0D  LDA $0DFE1F,X
01/FB5A: 99 E6 EB     STA $EBE6,Y
01/FB5D: BF 20 FE 0D  LDA $0DFE20,X
01/FB61: 99 76 EC     STA $EC76,Y
01/FB64: 7B           TDC 
01/FB65: 99 77 EC     STA $EC77,Y
01/FB68: E8           INX 
01/FB69: E8           INX 
01/FB6A: E0 18 00     CPX #$0018
01/FB6D: D0 02        BNE $FB71
01/FB6F: 7B           TDC 
01/FB70: AA           TAX 
01/FB71: AD 46 F4     LDA $F446
01/FB74: 99 E7 EB     STA $EBE7,Y
01/FB77: C8           INY 
01/FB78: C8           INY 
01/FB79: C0 90 00     CPY #$0090
01/FB7C: D0 D8        BNE $FB56
01/FB7E: 7B           TDC 
01/FB7F: AA           TAX 
01/FB80: A8           TAY 
01/FB81: A9 0C        LDA #$0C
01/FB83: 85 02        STA $02
01/FB85: AD 46 F4     LDA $F446
01/FB88: D0 06        BNE $FB90
01/FB8A: BF 41 FE 0D  LDA $0DFE41,X
01/FB8E: 80 04        BRA $FB94
01/FB90: BF 3C FE 0D  LDA $0DFE3C,X
01/FB94: 85 00        STA $00
01/FB96: B9 E6 EB     LDA $EBE6,Y
01/FB99: 18           CLC 
01/FB9A: 65 00        ADC $00
01/FB9C: 99 E6 EB     STA $EBE6,Y
01/FB9F: BF 37 FE 0D  LDA $0DFE37,X
01/FBA3: 85 00        STA $00
01/FBA5: B9 76 EC     LDA $EC76,Y
01/FBA8: 18           CLC 
01/FBA9: 65 00        ADC $00
01/FBAB: 99 76 EC     STA $EC76,Y
01/FBAE: C8           INY 
01/FBAF: C8           INY 
01/FBB0: C6 02        DEC $02
01/FBB2: D0 D1        BNE $FB85
01/FBB4: E8           INX 
01/FBB5: E0 06 00     CPX #$0006
01/FBB8: D0 C7        BNE $FB81
01/FBBA: 7B           TDC 
01/FBBB: AA           TAX 
01/FBBC: BF 00 19 00  LDA $001900,X   ; rng table
01/FBC0: 9D 06 ED     STA $ED06,X
01/FBC3: E8           INX 
01/FBC4: E0 06 00     CPX #$0006
01/FBC7: D0 F3        BNE $FBBC
01/FBC9: 22 43 E7 02  JSL $02E743
01/FBCD: 7B           TDC 
01/FBCE: AA           TAX 
01/FBCF: BD 00 19     LDA $1900,X     ; rng table
01/FBD2: 29 07        AND #$07
01/FBD4: 18           CLC 
01/FBD5: 69 04        ADC #$04
01/FBD7: 9D B3 F1     STA $F1B3,X
01/FBDA: 9D F3 F1     STA $F1F3,X
01/FBDD: 8A           TXA 
01/FBDE: 0A           ASL 
01/FBDF: 0A           ASL 
01/FBE0: 0A           ASL 
01/FBE1: 0A           ASL 
01/FBE2: 0A           ASL 
01/FBE3: 20 96 F9     JSR $F996
01/FBE6: E8           INX 
01/FBE7: E0 08 00     CPX #$0008
01/FBEA: D0 E3        BNE $FBCF
01/FBEC: 9C B3 F1     STZ $F1B3
01/FBEF: 9C F3 F1     STZ $F1F3
01/FBF2: 60           RTS 

; [  ]

01/FBF3: AD 13 18     LDA $1813
01/FBF6: AA           TAX 
01/FBF7: BD 01 19     LDA $1901,X
01/FBFA: 29 03        AND #$03
01/FBFC: 85 01        STA $01
01/FBFE: 7B           TDC 
01/FBFF: AA           TAX 
01/FC00: A8           TAY 
01/FC01: AD C0 6C     LDA $6CC0
01/FC04: F0 0F        BEQ $FC15
01/FC06: AD 46 F4     LDA $F446
01/FC09: F0 0F        BEQ $FC1A
01/FC0B: BD E6 EB     LDA $EBE6,X
01/FC0E: 49 FF        EOR #$FF
01/FC10: 99 40 03     STA $0340,Y
01/FC13: 80 0B        BRA $FC20
01/FC15: AD 46 F4     LDA $F446
01/FC18: F0 F1        BEQ $FC0B
01/FC1A: BD E6 EB     LDA $EBE6,X
01/FC1D: 99 40 03     STA $0340,Y
01/FC20: BD 76 EC     LDA $EC76,X
01/FC23: 18           CLC 
01/FC24: 65 01        ADC $01
01/FC26: 7D 77 EC     ADC $EC77,X
01/FC29: 99 41 03     STA $0341,Y
01/FC2C: E8           INX 
01/FC2D: E8           INX 
01/FC2E: C8           INY 
01/FC2F: C8           INY 
01/FC30: C8           INY 
01/FC31: C8           INY 
01/FC32: E0 78 00     CPX #$0078
01/FC35: D0 CA        BNE $FC01
01/FC37: 7B           TDC 
01/FC38: A8           TAY 
01/FC39: 98           TYA 
01/FC3A: 4A           LSR 
01/FC3B: 4A           LSR 
01/FC3C: 4A           LSR 
01/FC3D: AA           TAX 
01/FC3E: B9 E7 EB     LDA $EBE7,Y
01/FC41: 4A           LSR 
01/FC42: 7E 04 05     ROR $0504,X
01/FC45: 38           SEC 
01/FC46: 7E 04 05     ROR $0504,X
01/FC49: C8           INY 
01/FC4A: C8           INY 
01/FC4B: C0 78 00     CPY #$0078
01/FC4E: D0 E9        BNE $FC39
01/FC50: 60           RTS 

; [  ]

01/FC51: 7B           TDC 
01/FC52: A8           TAY 
01/FC53: B9 06 ED     LDA $ED06,Y
01/FC56: 29 04        AND #$04
01/FC58: 1A           INC 
01/FC59: 85 02        STA $02
01/FC5B: 64 03        STZ $03
01/FC5D: 98           TYA 
01/FC5E: AA           TAX 
01/FC5F: BF 46 FE 0D  LDA $0DFE46,X
01/FC63: AA           TAX 
01/FC64: C2 20        REP #$20
01/FC66: A9 0C 00     LDA #$000C
01/FC69: 85 00        STA $00
01/FC6B: A5 02        LDA $02
01/FC6D: 85 04        STA $04
01/FC6F: DE E6 EB     DEC $EBE6,X
01/FC72: C6 04        DEC $04
01/FC74: D0 F9        BNE $FC6F
01/FC76: E8           INX 
01/FC77: E8           INX 
01/FC78: C6 00        DEC $00
01/FC7A: D0 EF        BNE $FC6B
01/FC7C: 7B           TDC 
01/FC7D: E2 20        SEP #$20
01/FC7F: 98           TYA 
01/FC80: AA           TAX 
01/FC81: A9 02        LDA #$02
01/FC83: 20 96 F9     JSR $F996
01/FC86: BD 33 F1     LDA $F133,X
01/FC89: 09 80        ORA #$80
01/FC8B: 9D 33 F1     STA $F133,X
01/FC8E: 20 65 F9     JSR $F965
01/FC91: 48           PHA 
01/FC92: 98           TYA 
01/FC93: AA           TAX 
01/FC94: BF 46 FE 0D  LDA $0DFE46,X
01/FC98: AA           TAX 
01/FC99: A9 0C        LDA #$0C
01/FC9B: 85 00        STA $00
01/FC9D: 68           PLA 
01/FC9E: 9D 77 EC     STA $EC77,X
01/FCA1: E8           INX 
01/FCA2: E8           INX 
01/FCA3: C6 00        DEC $00
01/FCA5: D0 F7        BNE $FC9E
01/FCA7: B9 06 ED     LDA $ED06,Y
01/FCAA: 1A           INC 
01/FCAB: 99 06 ED     STA $ED06,Y
01/FCAE: C8           INY 
01/FCAF: C0 06 00     CPY #$0006
01/FCB2: D0 9F        BNE $FC53
01/FCB4: 60           RTS 

; [  ]

01/FCB5: 6B           RTL 

; [  ]

01/FCB6: 7B           TDC 
01/FCB7: AA           TAX 
01/FCB8: 8E 06 F4     STX $F406
01/FCBB: 8E 08 F4     STX $F408
01/FCBE: A9 03        LDA #$03
01/FCC0: 22 D7 F5 02  JSL $02F5D7
01/FCC4: 20 09 EE     JSR $EE09       ; wait one frame
01/FCC7: 22 70 ED 01  JSL $01ED70
01/FCCB: C2 20        REP #$20
01/FCCD: AD 06 F4     LDA $F406
01/FCD0: 38           SEC 
01/FCD1: E9 08 00     SBC #$0008
01/FCD4: 8D 06 F4     STA $F406
01/FCD7: AA           TAX 
01/FCD8: 7B           TDC 
01/FCD9: E2 20        SEP #$20
01/FCDB: E0 A8 FF     CPX #$FFA8
01/FCDE: D0 E4        BNE $FCC4
01/FCE0: 22 70 ED 01  JSL $01ED70
01/FCE4: A9 2C        LDA #$2C
01/FCE6: 22 5E CC 02  JSL $02CC5E
01/FCEA: A2 10 00     LDX #$0010
01/FCED: 20 98 F3     JSR $F398
01/FCF0: A9 2A        LDA #$2A
01/FCF2: 22 5E CC 02  JSL $02CC5E
01/FCF6: AE C4 34     LDX $34C4
01/FCF9: 8E 66 F4     STX $F466
01/FCFC: 22 9C E6 01  JSL $01E69C
01/FD00: 9C E2 38     STZ $38E2
01/FD03: 20 09 EE     JSR $EE09       ; wait one frame
01/FD06: 22 70 ED 01  JSL $01ED70
01/FD0A: C2 20        REP #$20
01/FD0C: AD 06 F4     LDA $F406
01/FD0F: 18           CLC 
01/FD10: 69 08 00     ADC #$0008
01/FD13: 8D 06 F4     STA $F406
01/FD16: 48           PHA 
01/FD17: 7B           TDC 
01/FD18: E2 20        SEP #$20
01/FD1A: FA           PLX 
01/FD1B: D0 E6        BNE $FD03
01/FD1D: 22 70 ED 01  JSL $01ED70
01/FD21: 6B           RTL 

; [  ]

01/FD22: 20 CF E9     JSR $E9CF
01/FD25: 20 1C E4     JSR $E41C
01/FD28: 20 16 FB     JSR $FB16
01/FD2B: 20 51 FC     JSR $FC51
01/FD2E: A2 40 00     LDX #$0040
01/FD31: DA           PHX 
01/FD32: 20 09 EE     JSR $EE09       ; wait one frame
01/FD35: EE 2B F4     INC $F42B
01/FD38: 20 51 FC     JSR $FC51
01/FD3B: 20 F3 FB     JSR $FBF3
01/FD3E: 9C 2B F4     STZ $F42B
01/FD41: FA           PLX 
01/FD42: CA           DEX 
01/FD43: D0 EC        BNE $FD31
01/FD45: AE C4 34     LDX $34C4
01/FD48: 8E 66 F4     STX $F466
01/FD4B: 22 9C E6 01  JSL $01E69C
01/FD4F: 9C E2 38     STZ $38E2
01/FD52: 6B           RTL 

; [  ]

01/FD53: 20 CF E9     JSR $E9CF
01/FD56: 20 1C E4     JSR $E41C
01/FD59: 20 1B FB     JSR $FB1B
01/FD5C: 20 51 FC     JSR $FC51
01/FD5F: 20 8F EE     JSR $EE8F
01/FD62: A2 80 00     LDX #$0080
01/FD65: DA           PHX 
01/FD66: 20 09 EE     JSR $EE09       ; wait one frame
01/FD69: EE 2B F4     INC $F42B
01/FD6C: 20 51 FC     JSR $FC51
01/FD6F: 20 F3 FB     JSR $FBF3
01/FD72: 9C 2B F4     STZ $F42B
01/FD75: 22 B5 F5 02  JSL $02F5B5
01/FD79: FA           PLX 
01/FD7A: CA           DEX 
01/FD7B: D0 E8        BNE $FD65
01/FD7D: 20 1C E4     JSR $E41C
01/FD80: 9C 87 EF     STZ $EF87
01/FD83: 22 B0 F5 02  JSL $02F5B0
01/FD87: 6B           RTL 

; [  ]

01/FD88: A2 20 00     LDX #$0020
01/FD8B: 20 98 F3     JSR $F398
01/FD8E: A9 08        LDA #$08
01/FD90: 8D 26 F3     STA $F326
01/FD93: 20 1C E4     JSR $E41C
01/FD96: 20 CF E9     JSR $E9CF
01/FD99: 22 C1 F9 03  JSL $03F9C1
01/FD9D: 20 1C E4     JSR $E41C
01/FDA0: 6B           RTL 

; [  ]

01/FDA1: A2 08 00     LDX #$0008
01/FDA4: 20 09 EE     JSR $EE09       ; wait one frame
01/FDA7: CE 21 F3     DEC $F321
01/FDAA: CE 21 F3     DEC $F321
01/FDAD: CA           DEX 
01/FDAE: D0 F4        BNE $FDA4
01/FDB0: 60           RTS 

; [  ]

01/FDB1: A2 08 00     LDX #$0008
01/FDB4: 20 09 EE     JSR $EE09       ; wait one frame
01/FDB7: EE 21 F3     INC $F321
01/FDBA: EE 21 F3     INC $F321
01/FDBD: CA           DEX 
01/FDBE: D0 F4        BNE $FDB4
01/FDC0: 60           RTS 

; [  ]

01/FDC1: A2 08 00     LDX #$0008
01/FDC4: 20 09 EE     JSR $EE09       ; wait one frame
01/FDC7: CE 21 F3     DEC $F321
01/FDCA: CE 21 F3     DEC $F321
01/FDCD: AD 26 F3     LDA $F326
01/FDD0: 18           CLC 
01/FDD1: 69 04        ADC #$04
01/FDD3: 8D 26 F3     STA $F326
01/FDD6: CA           DEX 
01/FDD7: D0 EB        BNE $FDC4
01/FDD9: 9C 26 F3     STZ $F326
01/FDDC: 60           RTS 

; [  ]

01/FDDD: A2 08 00     LDX #$0008
01/FDE0: 20 09 EE     JSR $EE09       ; wait one frame
01/FDE3: EE 21 F3     INC $F321
01/FDE6: EE 21 F3     INC $F321
01/FDE9: AD 26 F3     LDA $F326
01/FDEC: 18           CLC 
01/FDED: 69 04        ADC #$04
01/FDEF: 8D 26 F3     STA $F326
01/FDF2: CA           DEX 
01/FDF3: D0 EB        BNE $FDE0
01/FDF5: 9C 26 F3     STZ $F326
01/FDF8: 60           RTS 

; [  ]

01/FDF9: AD 20 F3     LDA $F320
01/FDFC: F0 04        BEQ $FE02
01/FDFE: C9 FF        CMP #$FF
01/FE00: D0 01        BNE $FE03
01/FE02: 60           RTS 
01/FE03: A2 16 00     LDX #$0016
01/FE06: A9 AA        LDA #$AA
01/FE08: 9D 00 05     STA $0500,X
01/FE0B: E8           INX 
01/FE0C: E0 20 00     CPX #$0020
01/FE0F: D0 F7        BNE $FE08
01/FE11: AD 27 F3     LDA $F327
01/FE14: F0 03        BEQ $FE19
01/FE16: EE 26 F3     INC $F326
01/FE19: AD 26 F3     LDA $F326
01/FE1C: 4A           LSR 
01/FE1D: 4A           LSR 
01/FE1E: 4A           LSR 
01/FE1F: 29 03        AND #$03
01/FE21: 85 0E        STA $0E
01/FE23: AD 25 F3     LDA $F325
01/FE26: 0A           ASL 
01/FE27: 0A           ASL 
01/FE28: 18           CLC 
01/FE29: 65 0E        ADC $0E
01/FE2B: AA           TAX 
01/FE2C: BF 9D FA 13  LDA $13FA9D,X
01/FE30: 8D 28 F3     STA $F328
01/FE33: 7B           TDC 
01/FE34: AA           TAX 
01/FE35: 8E 2E F3     STX $F32E
01/FE38: AD 2C F3     LDA $F32C
01/FE3B: F0 2E        BEQ $FE6B
01/FE3D: AD B3 F1     LDA $F1B3
01/FE40: 0A           ASL 
01/FE41: 85 1E        STA $1E
01/FE43: AD 33 F1     LDA $F133
01/FE46: 18           CLC 
01/FE47: 6D 2D F3     ADC $F32D
01/FE4A: 8D 33 F1     STA $F133
01/FE4D: 22 14 E0 02  JSL $02E014
01/FE51: 8D 2F F3     STA $F32F
01/FE54: AD F3 F1     LDA $F1F3
01/FE57: 0A           ASL 
01/FE58: 85 1E        STA $1E
01/FE5A: AD 73 F1     LDA $F173
01/FE5D: 18           CLC 
01/FE5E: 6D 2D F3     ADC $F32D
01/FE61: 8D 73 F1     STA $F173
01/FE64: 22 14 E0 02  JSL $02E014
01/FE68: 8D 2E F3     STA $F32E
01/FE6B: AD 28 F3     LDA $F328
01/FE6E: 0A           ASL 
01/FE6F: AA           TAX 
01/FE70: BF 60 F6 0D  LDA $0DF660,X
01/FE74: 85 1C        STA $1C
01/FE76: BF 61 F6 0D  LDA $0DF661,X
01/FE7A: 85 1D        STA $1D
01/FE7C: A9 0D        LDA #$0D
01/FE7E: 85 1E        STA $1E
01/FE80: AD 22 F3     LDA $F322
01/FE83: 18           CLC 
01/FE84: 6D 2F F3     ADC $F32F
01/FE87: 85 23        STA $23
01/FE89: AD 24 F3     LDA $F324
01/FE8C: 85 21        STA $21
01/FE8E: 64 0E        STZ $0E
01/FE90: A0 60 01     LDY #$0160
01/FE93: AD 23 F3     LDA $F323
01/FE96: 85 20        STA $20
01/FE98: AD 21 F3     LDA $F321
01/FE9B: 18           CLC 
01/FE9C: 6D 2E F3     ADC $F32E
01/FE9F: 85 22        STA $22
01/FEA1: AD 29 F3     LDA $F329
01/FEA4: 8D 2A F3     STA $F32A
01/FEA7: 22 E8 F7 03  JSL $03F7E8
01/FEAB: 90 34        BCC $FEE1
01/FEAD: 99 02 03     STA $0302,Y
01/FEB0: 0E 2A F3     ASL $F32A
01/FEB3: B0 2C        BCS $FEE1
01/FEB5: AD C0 6C     LDA $6CC0
01/FEB8: D0 0F        BNE $FEC9
01/FEBA: A5 22        LDA $22
01/FEBC: 99 00 03     STA $0300,Y
01/FEBF: A5 10        LDA $10
01/FEC1: 49 40        EOR #$40
01/FEC3: 99 03 03     STA $0303,Y
01/FEC6: 4C D8 FE     JMP $FED8
01/FEC9: A5 22        LDA $22
01/FECB: 49 FF        EOR #$FF
01/FECD: 38           SEC 
01/FECE: E9 10        SBC #$10
01/FED0: 99 00 03     STA $0300,Y
01/FED3: A5 10        LDA $10
01/FED5: 99 03 03     STA $0303,Y
01/FED8: A5 23        LDA $23
01/FEDA: 99 01 03     STA $0301,Y
01/FEDD: C8           INY 
01/FEDE: C8           INY 
01/FEDF: C8           INY 
01/FEE0: C8           INY 
01/FEE1: A5 22        LDA $22
01/FEE3: 18           CLC 
01/FEE4: 69 10        ADC #$10
01/FEE6: 85 22        STA $22
01/FEE8: C6 20        DEC $20
01/FEEA: D0 BB        BNE $FEA7
01/FEEC: A5 23        LDA $23
01/FEEE: 18           CLC 
01/FEEF: 69 10        ADC #$10
01/FEF1: 85 23        STA $23
01/FEF3: C6 21        DEC $21
01/FEF5: D0 9C        BNE $FE93
01/FEF7: 60           RTS 

; [  ]

01/FEF8: 7B           TDC 
01/FEF9: A8           TAY 
01/FEFA: AA           TAX 
01/FEFB: DA           PHX 
01/FEFC: 98           TYA 
01/FEFD: AA           TAX 
01/FEFE: 20 75 F9     JSR $F975
01/FF01: FA           PLX 
01/FF02: 18           CLC 
01/FF03: 7F 2C F8 0D  ADC $0DF82C,X
01/FF07: 9D B0 F3     STA $F3B0,X
01/FF0A: DA           PHX 
01/FF0B: 98           TYA 
01/FF0C: AA           TAX 
01/FF0D: 20 65 F9     JSR $F965
01/FF10: FA           PLX 
01/FF11: 18           CLC 
01/FF12: 7F 2D F8 0D  ADC $0DF82D,X
01/FF16: 9D B1 F3     STA $F3B1,X
01/FF19: DA           PHX 
01/FF1A: 98           TYA 
01/FF1B: AA           TAX 
01/FF1C: A9 0C        LDA #$0C
01/FF1E: 20 96 F9     JSR $F996
01/FF21: AD B3 F1     LDA $F1B3
01/FF24: F0 05        BEQ $FF2B
01/FF26: A9 FF        LDA #$FF
01/FF28: 20 85 F9     JSR $F985
01/FF2B: FA           PLX 
01/FF2C: C8           INY 
01/FF2D: E8           INX 
01/FF2E: E8           INX 
01/FF2F: E0 10 00     CPX #$0010
01/FF32: D0 C7        BNE $FEFB
01/FF34: 6B           RTL 

; --------------------------------------------------------------------------

02/8000: EA           NOP 
02/8001: EA           NOP 
02/8002: EA           NOP 

02/8003: 4C 0A 80     JMP $800A       ; execute battle graphics

02/8006: 20 13 85     JSR $8513       ; wait one frame
02/8009: 6B           RTL 

02/800A: 20 0E 80     JSR $800E       ; execute battle graphics
02/800D: 6B           RTL 

; [ execute battle graphics ]

02/800E: 0A           ASL 
02/800F: AA           TAX 
02/8010: BF 1F 80 02  LDA $02801F,X
02/8014: 85 02        STA $02
02/8016: BF 20 80 02  LDA $028020,X
02/801A: 85 03        STA $03
02/801C: 6C 02 00     JMP ($0002)

; battle graphics jump table
02/801F: ABDD ABD2 8295 8181 8178 BEAF 8158 8160
02/802F: 8168 8170 A20C A39E A12C A1D7 9EAD 82B0
02/803F: E8F9 BED7 812D 8069 8064 804B

; [ battle graphics $15:  ]

02/804B: 7B           TDC 
02/804C: 8F 40 01 00  STA $000140     ; disable multi-controller update
02/8050: AD 4B F4     LDA $F44B
02/8053: D0 03        BNE $8058
02/8055: EE 4B F4     INC $F44B
02/8058: 20 1E 85     JSR $851E       ; wait for vblank
02/805B: 20 6D 96     JSR $966D       ; do forced menu vram update
02/805E: AD 21 18     LDA $1821
02/8061: D0 F5        BNE $8058
02/8063: 60           RTS 

; [ battle graphics $14: update monster rows ]

02/8064: 22 88 E9 01  JSL $01E988
02/8068: 60           RTS 

; [ battle graphics $13: party runs away ]

02/8069: 20 4B 80     JSR $804B
02/806C: AD 25 F4     LDA $F425
02/806F: F0 04        BEQ $8075
02/8071: EE 96 F3     INC $F396
02/8074: 60           RTS 
02/8075: 9C 85 F4     STZ $F485
02/8078: A9 21        LDA #$21
02/807A: 20 DF F5     JSR $F5DF
02/807D: 7B           TDC 
02/807E: AA           TAX 
02/807F: BD C5 29     LDA $29C5,X
02/8082: C9 FF        CMP #$FF
02/8084: F0 13        BEQ $8099
02/8086: 8A           TXA 
02/8087: 0A           ASL 
02/8088: 0A           ASL 
02/8089: A8           TAY 
02/808A: 9E 99 F0     STZ $F099,X
02/808D: B9 15 F0     LDA $F015,Y
02/8090: 29 C0        AND #$C0
02/8092: D0 05        BNE $8099
02/8094: A9 03        LDA #$03
02/8096: 9D 99 F0     STA $F099,X
02/8099: A9 01        LDA #$01
02/809B: 9D BC F2     STA $F2BC,X
02/809E: 9D AF F0     STA $F0AF,X
02/80A1: E8           INX 
02/80A2: E0 05 00     CPX #$0005
02/80A5: D0 D8        BNE $807F
02/80A7: EE 96 F3     INC $F396
02/80AA: 20 13 85     JSR $8513       ; wait one frame
02/80AD: AD CF EF     LDA $EFCF
02/80B0: 0D DF EF     ORA $EFDF
02/80B3: 0D EF EF     ORA $EFEF
02/80B6: 0D FF EF     ORA $EFFF
02/80B9: 0D 0F F0     ORA $F00F
02/80BC: D0 EC        BNE $80AA
02/80BE: 7B           TDC 
02/80BF: AA           TAX 
02/80C0: 9E D1 EF     STZ $EFD1,X
02/80C3: 9E D3 EF     STZ $EFD3,X
02/80C6: 8A           TXA 
02/80C7: 18           CLC 
02/80C8: 69 10        ADC #$10
02/80CA: AA           TAX 
02/80CB: E0 50 00     CPX #$0050
02/80CE: D0 F0        BNE $80C0
02/80D0: 20 13 85     JSR $8513       ; wait one frame
02/80D3: 7B           TDC 
02/80D4: AA           TAX 
02/80D5: 64 02        STZ $02
02/80D7: 64 04        STZ $04
02/80D9: A5 04        LDA $04
02/80DB: A8           TAY 
02/80DC: B9 C5 29     LDA $29C5,Y
02/80DF: C9 FF        CMP #$FF
02/80E1: F0 2B        BEQ $810E
02/80E3: A5 04        LDA $04
02/80E5: 0A           ASL 
02/80E6: 0A           ASL 
02/80E7: A8           TAY 
02/80E8: B9 15 F0     LDA $F015,Y
02/80EB: 29 C0        AND #$C0
02/80ED: D0 1F        BNE $810E
02/80EF: BD C4 EF     LDA $EFC4,X
02/80F2: F0 1A        BEQ $810E
02/80F4: BD CE EF     LDA $EFCE,X
02/80F7: 09 01        ORA #$01
02/80F9: 9D CE EF     STA $EFCE,X
02/80FC: 20 23 81     JSR $8123
02/80FF: BD C5 EF     LDA $EFC5,X
02/8102: C9 F0        CMP #$F0
02/8104: 90 0A        BCC $8110
02/8106: 7B           TDC 
02/8107: 9D C4 EF     STA $EFC4,X
02/810A: E6 02        INC $02
02/810C: 80 02        BRA $8110
02/810E: E6 02        INC $02
02/8110: E6 04        INC $04
02/8112: 8A           TXA 
02/8113: 18           CLC 
02/8114: 69 10        ADC #$10
02/8116: AA           TAX 
02/8117: E0 50 00     CPX #$0050
02/811A: D0 BD        BNE $80D9
02/811C: A5 02        LDA $02
02/811E: C9 05        CMP #$05
02/8120: D0 AE        BNE $80D0
02/8122: 60           RTS 

; [  ]

02/8123: 22 3F F6 03  JSL $03F63F
02/8127: 60           RTS 

; [  ]

02/8128: 22 30 F6 03  JSL $03F630
02/812C: 60           RTS 

; [ battle graphics $12: victory animation ]

02/812D: EE 72 F4     INC $F472
02/8130: 20 4B 80     JSR $804B
02/8133: 7B           TDC 
02/8134: AA           TAX 
02/8135: A8           TAY 
02/8136: 98           TYA 
02/8137: AA           TAX 
02/8138: 20 07 E1     JSR $E107
02/813B: BD 03 20     LDA $2003,X
02/813E: 29 C0        AND #$C0
02/8140: D0 0A        BNE $814C
02/8142: A9 08        LDA #$08
02/8144: 99 99 F0     STA $F099,Y
02/8147: A9 01        LDA #$01
02/8149: 99 6D F4     STA $F46D,Y
02/814C: C8           INY 
02/814D: C0 05 00     CPY #$0005
02/8150: D0 E4        BNE $8136
02/8152: A9 0F        LDA #$0F
02/8154: 8D 3B F4     STA $F43B
02/8157: 60           RTS 

; [ battle graphics $06: draw inventory item text ]

02/8158: A6 00        LDX $00
02/815A: 8E 16 18     STX $1816
02/815D: 4C A4 9F     JMP $9FA4       ; draw inventory item text

; [ battle graphics $07:  ]

; unused ???, draw spell name ???

02/8160: A6 00        LDX $00
02/8162: 8E 16 18     STX $1816
02/8165: 4C 8E A0     JMP $A08E       ; draw spell name (spell list)

; [ battle graphics $08: update arrow quantity ]

; $00: character id
; $01: arrow hand (0: left, 1: right)

02/8168: A6 00        LDX $00
02/816A: 8E 16 18     STX $1816
02/816D: 4C CD 9D     JMP $9DCD       ; draw equipped item text

; [ battle graphics $09: draw battle command list ]

02/8170: A5 00        LDA $00         ; character id
02/8172: 8D 16 18     STA $1816
02/8175: 4C BF 9C     JMP $9CBF       ; draw battle command list

; [ battle graphics $04: toggle character rows ]

02/8178: AD 14 F0     LDA $F014
02/817B: 49 01        EOR #$01
02/817D: 8D 14 F0     STA $F014
02/8180: 60           RTS 

; [ battle graphics $03: init battle graphics ]

02/8181: 20 D0 89     JSR $89D0       ; init hardware registers
02/8184: 20 8F 89     JSR $898F
02/8187: 20 63 9A     JSR $9A63       ; init menu text and tilemaps
02/818A: 22 D2 EB 01  JSL $01EBD2     ; init bg scroll hdma
02/818E: 20 1C 8B     JSR $8B1C       ; load graphics
02/8191: 20 8A E0     JSR $E08A
02/8194: 20 FB 88     JSR $88FB
02/8197: 20 5B 87     JSR $875B
02/819A: 20 C2 90     JSR $90C2
02/819D: AD C0 6C     LDA $6CC0
02/81A0: F0 0E        BEQ $81B0
02/81A2: AD 4E ED     LDA $ED4E
02/81A5: 29 40        AND #$40
02/81A7: D0 07        BNE $81B0       ; branch if monsters are flying
02/81A9: A9 01        LDA #$01
02/81AB: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/81AE: 80 05        BRA $81B5
02/81B0: A9 FF        LDA #$FF
02/81B2: 20 63 82     JSR $8263
02/81B5: 20 63 AA     JSR $AA63
02/81B8: A9 F2        LDA #$F2
02/81BA: 8D C2 6C     STA $6CC2
02/81BD: A9 1F        LDA #$1F
02/81BF: 8F 2C 21 00  STA $00212C
02/81C3: 8F 2E 21 00  STA $00212E
02/81C7: AF 10 42 00  LDA $004210
02/81CB: 10 FA        BPL $81C7
02/81CD: A9 8D        LDA #$8D
02/81CF: 8F 09 42 00  STA $004209
02/81D3: 7B           TDC 
02/81D4: 8F 0A 42 00  STA $00420A
02/81D8: 8F 07 42 00  STA $004207
02/81DC: 8F 08 42 00  STA $004208
02/81E0: 22 46 FE 03  JSL $03FE46     ; init hdma tables
02/81E4: A9 A1        LDA #$A1
02/81E6: 8F 00 42 00  STA $004200     ; enable nmi and irq
02/81EA: 58           CLI 
02/81EB: 20 1E 85     JSR $851E       ; wait for vblank
02/81EE: 9C 3D F1     STZ $F13D
02/81F1: 7B           TDC 
02/81F2: AA           TAX 
02/81F3: 8E 13 18     STX $1813
02/81F6: A9 16        LDA #$16
02/81F8: 8D 8E F2     STA $F28E
02/81FB: A9 20        LDA #$20
02/81FD: 8D 33 F1     STA $F133
02/8200: A9 10        LDA #$10
02/8202: 8D 34 F1     STA $F134
02/8205: 20 1E 85     JSR $851E       ; wait for vblank
02/8208: AD 3D F1     LDA $F13D
02/820B: 8D C1 6C     STA $6CC1
02/820E: C9 0F        CMP #$0F
02/8210: F0 03        BEQ $8215
02/8212: EE 3D F1     INC $F13D
02/8215: AD 33 F1     LDA $F133
02/8218: F0 13        BEQ $822D
02/821A: AD 33 F1     LDA $F133
02/821D: 3A           DEC 
02/821E: 8D 33 F1     STA $F133
02/8221: 0A           ASL 
02/8222: 0A           ASL 
02/8223: 0A           ASL 
02/8224: 29 F0        AND #$F0
02/8226: 09 02        ORA #$02
02/8228: 8D C2 6C     STA $6CC2
02/822B: 80 03        BRA $8230
02/822D: 9C C2 6C     STZ $6CC2
02/8230: 20 6D 96     JSR $966D       ; do forced menu vram update
02/8233: AD 8E F2     LDA $F28E
02/8236: F0 19        BEQ $8251
02/8238: AD 8E F2     LDA $F28E
02/823B: 3A           DEC 
02/823C: 8D 8E F2     STA $F28E
02/823F: 48           PHA 
02/8240: AA           TAX 
02/8241: BF 00 FF 1C  LDA $1CFF00,X   ; sine table
02/8245: 0A           ASL 
02/8246: 0A           ASL 
02/8247: 20 63 82     JSR $8263
02/824A: 68           PLA 
02/824B: D0 04        BNE $8251
02/824D: 7B           TDC 
02/824E: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/8251: AD 1E 18     LDA $181E
02/8254: 0D 20 18     ORA $1820
02/8257: 0D 8E F2     ORA $F28E
02/825A: 0D 33 F1     ORA $F133
02/825D: D0 A6        BNE $8205
02/825F: EE 4A F4     INC $F44A
02/8262: 60           RTS 

; [  ]

02/8263: A2 00 00     LDX #$0000
02/8266: 48           PHA 
02/8267: AD 4E ED     LDA $ED4E
02/826A: 29 40        AND #$40
02/826C: D0 19        BNE $8287       ; branch if monsters are flying
02/826E: AD C0 6C     LDA $6CC0
02/8271: F0 06        BEQ $8279
02/8273: 68           PLA 
02/8274: 49 FF        EOR #$FF
02/8276: 1A           INC 
02/8277: 80 01        BRA $827A
02/8279: 68           PLA 
02/827A: 9D 12 76     STA $7612,X
02/827D: E8           INX 
02/827E: E8           INX 
02/827F: E8           INX 
02/8280: E8           INX 
02/8281: E0 60 02     CPX #$0260
02/8284: D0 F4        BNE $827A
02/8286: 60           RTS 
02/8287: 68           PLA 
02/8288: 9D 14 76     STA $7614,X
02/828B: E8           INX 
02/828C: E8           INX 
02/828D: E8           INX 
02/828E: E8           INX 
02/828F: E0 60 02     CPX #$0260
02/8292: D0 F4        BNE $8288
02/8294: 60           RTS 

; [ battle graphics $02: wait one frame ]

; called from battle main

02/8295: 20 1E 85     JSR $851E       ; wait for vblank
02/8298: 20 6D 96     JSR $966D       ; do forced menu vram update
02/829B: 20 FA 96     JSR $96FA       ; do periodic menu vram update
02/829E: 20 B9 82     JSR $82B9
02/82A1: 20 C8 96     JSR $96C8
02/82A4: 22 41 F7 03  JSL $03F741
02/82A8: 90 03        BCC $82AD
02/82AA: 20 D2 AB     JSR $ABD2
02/82AD: 4C 2E 89     JMP $892E

; [ battle graphics $0F: wait one frame ]

; called from battle graphics

02/82B0: 20 1E 85     JSR $851E       ; wait for vblank
02/82B3: 20 6D 96     JSR $966D       ; do forced menu vram update
02/82B6: 20 19 97     JSR $9719       ; do periodic menu text update
;fallthrough

; [  ]

02/82B9: 20 05 89     JSR $8905
02/82BC: 20 E1 82     JSR $82E1       ; update flying monster v-scroll
02/82BF: 20 7F 8B     JSR $8B7F
02/82C2: 7B           TDC 
02/82C3: AA           TAX 
02/82C4: A8           TAY 
02/82C5: BD 1B 32     LDA $321B,X     ; find an empty item slot
02/82C8: F0 0F        BEQ $82D9
02/82CA: E8           INX 
02/82CB: E8           INX 
02/82CC: E8           INX 
02/82CD: E8           INX 
02/82CE: C8           INY 
02/82CF: E0 C0 00     CPX #$00C0
02/82D2: D0 F1        BNE $82C5
02/82D4: A9 FF        LDA #$FF        ; inventory is full
02/82D6: 80 02        BRA $82DA
02/82D8: 60           RTS 
02/82D9: 98           TYA 
02/82DA: 8D F4 38     STA $38F4
02/82DD: 8D 1D 18     STA $181D
02/82E0: 60           RTS 

; [ update flying monster v-scroll ]

02/82E1: AD 4E ED     LDA $ED4E
02/82E4: 29 40        AND #$40
02/82E6: F0 19        BEQ $8301       ; return if monsters are not flying
02/82E8: AD 53 F3     LDA $F353
02/82EB: F0 FB        BEQ $82E8       ; wait for irq
02/82ED: AD 13 18     LDA $1813
02/82F0: 48           PHA 
02/82F1: 4A           LSR 
02/82F2: 4A           LSR 
02/82F3: 29 0F        AND #$0F
02/82F5: AA           TAX 
02/82F6: BF B4 FF 0D  LDA $0DFFB4,X
02/82FA: 20 02 83     JSR $8302       ; set monster hdma v-scroll value
02/82FD: 68           PLA 
02/82FE: 8D 4F ED     STA $ED4F
02/8301: 60           RTS 

; [ set monster hdma v-scroll value ]

02/8302: A2 00 00     LDX #$0000
02/8305: 9D 14 76     STA $7614,X
02/8308: 9D A0 76     STA $76A0,X
02/830B: 9D 2C 77     STA $772C,X
02/830E: 9D B8 77     STA $77B8,X
02/8311: E8           INX 
02/8312: E8           INX 
02/8313: E8           INX 
02/8314: E8           INX 
02/8315: E0 8C 00     CPX #$008C
02/8318: D0 EB        BNE $8305
02/831A: 60           RTS 

; [  ]

02/831B: AD 4E ED     LDA $ED4E
02/831E: 29 40        AND #$40
02/8320: F0 22        BEQ $8344       ; branch if monsters are not flying
02/8322: AD 4F ED     LDA $ED4F
02/8325: 4A           LSR 
02/8326: 4A           LSR 
02/8327: 29 0F        AND #$0F
02/8329: AA           TAX 
02/832A: BF C4 FF 0D  LDA $0DFFC4,X
02/832E: C2 20        REP #$20
02/8330: 18           CLC 
02/8331: 69 E6 D9     ADC #$D9E6
02/8334: AA           TAX 
02/8335: A9 40 00     LDA #$0040
02/8338: 85 0E        STA $0E
02/833A: E2 20        SEP #$20
02/833C: A9 7E        LDA #$7E
02/833E: A0 10 45     LDY #$4510
02/8341: 20 9A 86     JSR $869A       ; transfer data to vram
02/8344: 60           RTS 

; [ battle nmi ]

02/8345: 08           PHP 
02/8346: C2 30        REP #$30
02/8348: 48           PHA 
02/8349: DA           PHX 
02/834A: 5A           PHY 
02/834B: 8B           PHB 
02/834C: 0B           PHD 
02/834D: A2 00 00     LDX #$0000
02/8350: DA           PHX 
02/8351: 2B           PLD 
02/8352: 7B           TDC 
02/8353: E2 20        SEP #$20
02/8355: AF 10 42 00  LDA $004210
02/8359: A9 7E        LDA #$7E
02/835B: 48           PHA 
02/835C: AB           PLB 
02/835D: AD 12 18     LDA $1812
02/8360: F0 03        BEQ $8365
02/8362: 4C C6 83     JMP $83C6
02/8365: 9C 7E F4     STZ $F47E
02/8368: EE 12 18     INC $1812
02/836B: 9C 53 F3     STZ $F353       ; clear irq flag
02/836E: 22 03 FE 03  JSL $03FE03     ; transfer sprite data to ppu
02/8372: 22 BE FE 03  JSL $03FEBE     ; transfer color palettes to ppu
02/8376: 20 1B 83     JSR $831B
02/8379: 20 86 92     JSR $9286
02/837C: 20 33 94     JSR $9433       ; transfer menu tilemap to vram
02/837F: AD C1 6C     LDA $6CC1
02/8382: 8F 00 21 00  STA $002100     ; set screen brightness
02/8386: AD C2 6C     LDA $6CC2
02/8389: 8F 06 21 00  STA $002106
02/838D: 22 3E FC 03  JSL $03FC3E
02/8391: 20 11 A8     JSR $A811
02/8394: 22 D0 FD 03  JSL $03FDD0     ; update controller
02/8398: 22 9C FB 03  JSL $03FB9C
02/839C: B0 06        BCS $83A4
02/839E: EE 7E F4     INC $F47E
02/83A1: 20 23 AC     JSR $AC23       ; update cursor
02/83A4: 20 E3 BB     JSR $BBE3       ; draw cursor sprite
02/83A7: 20 29 BB     JSR $BB29
02/83AA: 20 D2 BA     JSR $BAD2
02/83AD: 20 AF AC     JSR $ACAF
02/83B0: 20 4C E2     JSR $E24C       ; draw character sprites
02/83B3: 20 3D E6     JSR $E63D
02/83B6: 20 D9 E5     JSR $E5D9
02/83B9: 20 6B FB     JSR $FB6B
02/83BC: 20 F7 FA     JSR $FAF7
02/83BF: 20 05 E5     JSR $E505       ; draw damage numeral sprites
02/83C2: 22 12 F1 01  JSL $01F112
02/83C6: AF 7E F4 7E  LDA $7EF47E
02/83CA: F0 09        BEQ $83D5
02/83CC: AD D9 38     LDA $38D9
02/83CF: D0 04        BNE $83D5
02/83D1: 22 CD F7 03  JSL $03F7CD     ; increment game time
02/83D5: C2 30        REP #$30
02/83D7: EE 13 18     INC $1813       ; increment frame counter
02/83DA: 2B           PLD 
02/83DB: AB           PLB 
02/83DC: 7A           PLY 
02/83DD: FA           PLX 
02/83DE: 68           PLA 
02/83DF: 28           PLP 
02/83E0: 40           RTI 

; [ clear vram ]

; +X: start address (vram)
; +Y: size (in bytes)

02/83E1: 8B           PHB 
02/83E2: 7B           TDC 
02/83E3: 48           PHA 
02/83E4: AB           PLB 
02/83E5: 8E 16 21     STX $2116
02/83E8: A2 07 84     LDX #$8407
02/83EB: 8E 52 43     STX $4352
02/83EE: A9 09        LDA #$09
02/83F0: 8D 50 43     STA $4350
02/83F3: A9 18        LDA #$18
02/83F5: 8D 51 43     STA $4351
02/83F8: A9 02        LDA #$02
02/83FA: 8D 54 43     STA $4354
02/83FD: 8C 55 43     STY $4355
02/8400: A9 20        LDA #$20
02/8402: 8D 0B 42     STA $420B
02/8405: AB           PLB 
02/8406: 60           RTS 

02/8407: 00 00

; [ transfer summon graphics to vram ??? ]

02/8409: 48           PHA 
02/840A: DA           PHX 
02/840B: 5A           PHY 
02/840C: 8E 71 F3     STX $F371
02/840F: 8D 73 F3     STA $F373
02/8412: 9C 70 F3     STZ $F370
02/8415: 9C 74 F3     STZ $F374
02/8418: AD A8 EF     LDA $EFA8
02/841B: 0D B1 EF     ORA $EFB1
02/841E: F0 06        BEQ $8426
02/8420: 20 13 85     JSR $8513       ; wait one frame
02/8423: 4C 18 84     JMP $8418
; start of frame loop
02/8426: AE 71 F3     LDX $F371
02/8429: 86 00        STX $00
02/842B: AD 73 F3     LDA $F373
02/842E: 85 02        STA $02
02/8430: 64 04        STZ $04
02/8432: 64 07        STZ $07
; start of tile loop ???
02/8434: AD 70 F3     LDA $F370
02/8437: A8           TAY 
02/8438: B7 00        LDA [$00],Y
02/843A: 30 33        BMI $846F
02/843C: 85 06        STA $06
02/843E: A5 04        LDA $04
02/8440: 0A           ASL 
02/8441: 0A           ASL 
02/8442: A8           TAY 
02/8443: AD 74 F3     LDA $F374
02/8446: C2 20        REP #$20
02/8448: 0A           ASL 
02/8449: 0A           ASL 
02/844A: 0A           ASL 
02/844B: 0A           ASL 
02/844C: 0A           ASL 
02/844D: 18           CLC 
02/844E: 69 E6 DB     ADC #$DBE6
02/8451: 99 60 F3     STA $F360,Y
02/8454: A5 06        LDA $06
02/8456: 0A           ASL 
02/8457: 0A           ASL 
02/8458: 0A           ASL 
02/8459: 0A           ASL 
02/845A: 99 62 F3     STA $F362,Y
02/845D: 7B           TDC 
02/845E: E2 20        SEP #$20
02/8460: A5 04        LDA $04
02/8462: AA           TAX 
02/8463: FE 5C F3     INC $F35C,X
02/8466: EE 70 F3     INC $F370
02/8469: EE 74 F3     INC $F374
02/846C: 4C 99 84     JMP $8499
02/846F: C9 FF        CMP #$FF
02/8471: F0 34        BEQ $84A7       ; branch if terminator
02/8473: 29 7F        AND #$7F
02/8475: 85 06        STA $06
02/8477: A5 04        LDA $04
02/8479: 0A           ASL 
02/847A: 0A           ASL 
02/847B: A8           TAY 
02/847C: C2 20        REP #$20
02/847E: A9 76 F3     LDA #$F376
02/8481: 99 60 F3     STA $F360,Y
02/8484: A5 06        LDA $06
02/8486: 0A           ASL 
02/8487: 0A           ASL 
02/8488: 0A           ASL 
02/8489: 0A           ASL 
02/848A: 99 62 F3     STA $F362,Y
02/848D: 7B           TDC 
02/848E: E2 20        SEP #$20
02/8490: A5 04        LDA $04
02/8492: AA           TAX 
02/8493: FE 5C F3     INC $F35C,X
02/8496: EE 70 F3     INC $F370
02/8499: E6 04        INC $04
02/849B: A5 04        LDA $04
02/849D: C9 04        CMP #$04
02/849F: D0 93        BNE $8434
02/84A1: 20 13 85     JSR $8513       ; wait one frame
02/84A4: 4C 26 84     JMP $8426
02/84A7: 20 13 85     JSR $8513       ; wait one frame
02/84AA: 7A           PLY 
02/84AB: FA           PLX 
02/84AC: 68           PLA 
02/84AD: 60           RTS 

; [  ]

02/84AE: 20 B2 84     JSR $84B2
02/84B1: 6B           RTL 

; [  ]

02/84B2: 48           PHA 
02/84B3: DA           PHX 
02/84B4: 5A           PHY 
02/84B5: A6 00        LDX $00
02/84B7: DA           PHX 
02/84B8: AD A8 EF     LDA $EFA8
02/84BB: 0D B1 EF     ORA $EFB1
02/84BE: F0 05        BEQ $84C5
02/84C0: 20 13 85     JSR $8513       ; wait one frame
02/84C3: 80 F3        BRA $84B8
02/84C5: FA           PLX 
02/84C6: 86 00        STX $00
02/84C8: 7A           PLY 
02/84C9: FA           PLX 
02/84CA: 68           PLA 
02/84CB: 8D AF EF     STA $EFAF
02/84CE: 8E A9 EF     STX $EFA9
02/84D1: 8C AB EF     STY $EFAB
02/84D4: A2 80 00     LDX #$0080
02/84D7: 8E AD EF     STX $EFAD
02/84DA: C2 20        REP #$20
02/84DC: A5 00        LDA $00
02/84DE: 0A           ASL 
02/84DF: 29 00 FF     AND #$FF00
02/84E2: 85 00        STA $00
02/84E4: 7B           TDC 
02/84E5: E2 20        SEP #$20
02/84E7: A5 01        LDA $01
02/84E9: 8D B0 EF     STA $EFB0
02/84EC: EE A8 EF     INC $EFA8
02/84EF: 20 13 85     JSR $8513       ; wait one frame
02/84F2: CE B0 EF     DEC $EFB0
02/84F5: F0 1B        BEQ $8512
02/84F7: C2 20        REP #$20
02/84F9: AD A9 EF     LDA $EFA9
02/84FC: 18           CLC 
02/84FD: 69 80 00     ADC #$0080
02/8500: 8D A9 EF     STA $EFA9
02/8503: AD AB EF     LDA $EFAB
02/8506: 18           CLC 
02/8507: 69 40 00     ADC #$0040
02/850A: 8D AB EF     STA $EFAB
02/850D: 7B           TDC 
02/850E: E2 20        SEP #$20
02/8510: 80 DA        BRA $84EC
02/8512: 60           RTS 

; [ wait one frame ]

02/8513: 5A           PHY 
02/8514: DA           PHX 
02/8515: A9 0F        LDA #$0F        ; battle graphics $0F: wait one frame
02/8517: 22 03 80 02  JSL $028003     ; execute battle graphics
02/851B: FA           PLX 
02/851C: 7A           PLY 
02/851D: 60           RTS 

; [ wait for vblank ]

02/851E: EE 11 18     INC $1811
02/8521: AD 11 18     LDA $1811
02/8524: D0 FB        BNE $8521
02/8526: 60           RTS 

; [ divide (far) ]

02/8527: 20 2B 85     JSR $852B
02/852A: 6B           RTL 

; [ divide ]

02/852B: DA           PHX 
02/852C: C2 20        REP #$20
02/852E: 48           PHA 
02/852F: 64 2A        STZ $2A
02/8531: 64 2C        STZ $2C
02/8533: A5 26        LDA $26
02/8535: F0 20        BEQ $8557
02/8537: A5 28        LDA $28
02/8539: F0 1C        BEQ $8557
02/853B: A2 10 00     LDX #$0010
02/853E: 26 26        ROL $26
02/8540: 26 2C        ROL $2C
02/8542: 38           SEC 
02/8543: A5 2C        LDA $2C
02/8545: E5 28        SBC $28
02/8547: 85 2C        STA $2C
02/8549: B0 07        BCS $8552
02/854B: A5 2C        LDA $2C
02/854D: 65 28        ADC $28
02/854F: 85 2C        STA $2C
02/8551: 18           CLC 
02/8552: 26 2A        ROL $2A
02/8554: CA           DEX 
02/8555: D0 E7        BNE $853E
02/8557: 68           PLA 
02/8558: E2 20        SEP #$20
02/855A: FA           PLX 
02/855B: 60           RTS 

; [ multiply (8-bit, far) ]

02/855C: 20 60 85     JSR $8560
02/855F: 6B           RTL 

; [ multiply (8-bit) ]

; +$2A = $26 * $28

02/8560: DA           PHX 
02/8561: A2 08 00     LDX #$0008
02/8564: 64 2A        STZ $2A
02/8566: 64 2B        STZ $2B
02/8568: 66 28        ROR $28
02/856A: 90 07        BCC $8573
02/856C: A5 26        LDA $26
02/856E: 18           CLC 
02/856F: 65 2B        ADC $2B
02/8571: 85 2B        STA $2B
02/8573: 66 2B        ROR $2B
02/8575: 66 2A        ROR $2A
02/8577: CA           DEX 
02/8578: D0 EE        BNE $8568
02/857A: FA           PLX 
02/857B: 60           RTS 

; [ multiply (16-bit) ]

; +++$2C = +$26 * +$28

02/857C: DA           PHX 
02/857D: C2 20        REP #$20
02/857F: 48           PHA 
02/8580: 7B           TDC 
02/8581: 85 2E        STA $2E
02/8583: 85 2A        STA $2A
02/8585: 85 2C        STA $2C
02/8587: A2 10 00     LDX #$0010
02/858A: 46 26        LSR $26
02/858C: 90 0D        BCC $859B
02/858E: 18           CLC 
02/858F: A5 2A        LDA $2A
02/8591: 65 28        ADC $28
02/8593: 85 2A        STA $2A
02/8595: A5 2C        LDA $2C
02/8597: 65 2E        ADC $2E
02/8599: 85 2C        STA $2C
02/859B: 06 28        ASL $28
02/859D: 26 2E        ROL $2E
02/859F: CA           DEX 
02/85A0: D0 E8        BNE $858A
02/85A2: 68           PLA 
02/85A3: E2 20        SEP #$20
02/85A5: FA           PLX 
02/85A6: 60           RTS 

; [ multiply (16-bit) ]

; +++$22 = +$1C * +$1E
; unused

02/85A7: DA           PHX 
02/85A8: C2 20        REP #$20
02/85AA: 48           PHA 
02/85AB: 7B           TDC 
02/85AC: 85 24        STA $24
02/85AE: 85 20        STA $20
02/85B0: 85 22        STA $22
02/85B2: A2 10 00     LDX #$0010
02/85B5: 46 1C        LSR $1C
02/85B7: 90 0D        BCC $85C6
02/85B9: 18           CLC 
02/85BA: A5 20        LDA $20
02/85BC: 65 1E        ADC $1E
02/85BE: 85 20        STA $20
02/85C0: A5 22        LDA $22
02/85C2: 65 24        ADC $24
02/85C4: 85 22        STA $22
02/85C6: 06 1E        ASL $1E
02/85C8: 26 24        ROL $24
02/85CA: CA           DEX 
02/85CB: D0 E8        BNE $85B5
02/85CD: 68           PLA 
02/85CE: E2 20        SEP #$20
02/85D0: FA           PLX 
02/85D1: 60           RTS 

; [ hardware multiply ]

02/85D2: DA           PHX 
02/85D3: A5 1C        LDA $1C
02/85D5: 8F 02 42 00  STA $004202
02/85D9: A5 1E        LDA $1E
02/85DB: 8F 03 42 00  STA $004203
02/85DF: 8B           PHB 
02/85E0: 7B           TDC 
02/85E1: 48           PHA 
02/85E2: AB           PLB 
02/85E3: AE 16 42     LDX $4216
02/85E6: 86 20        STX $20
02/85E8: AB           PLB 
02/85E9: FA           PLX 
02/85EA: 60           RTS 

; [ hardware divide ]

02/85EB: DA           PHX 
02/85EC: 8B           PHB 
02/85ED: 7B           TDC 
02/85EE: 48           PHA 
02/85EF: AB           PLB 
02/85F0: 64 1F        STZ $1F
02/85F2: A6 1C        LDX $1C
02/85F4: 8E 04 42     STX $4204
02/85F7: A5 1E        LDA $1E
02/85F9: 8D 06 42     STA $4206
02/85FC: A2 04 00     LDX #$0004
02/85FF: CA           DEX 
02/8600: D0 FD        BNE $85FF
02/8602: AE 14 42     LDX $4214
02/8605: 86 20        STX $20
02/8607: AE 16 42     LDX $4216
02/860A: 86 22        STX $22
02/860C: AB           PLB 
02/860D: FA           PLX 
02/860E: 60           RTS 

; [ transfer 3bpp graphics to vram ]

02/860F: 8B           PHB 
02/8610: 48           PHA 
02/8611: AB           PLB 
02/8612: 8C 16 21     STY $2116
02/8615: 86 02        STX $02
02/8617: A0 00 00     LDY #$0000
02/861A: C2 20        REP #$20
02/861C: 48           PHA 
02/861D: A2 08 00     LDX #$0008
02/8620: B1 02        LDA ($02),Y
02/8622: 8D 18 21     STA $2118
02/8625: C8           INY 
02/8626: C8           INY 
02/8627: CA           DEX 
02/8628: D0 F6        BNE $8620
02/862A: A2 08 00     LDX #$0008
02/862D: 68           PLA 
02/862E: E2 20        SEP #$20
02/8630: B1 02        LDA ($02),Y
02/8632: 8D 18 21     STA $2118
02/8635: 9C 19 21     STZ $2119
02/8638: C8           INY 
02/8639: CA           DEX 
02/863A: D0 F4        BNE $8630
02/863C: C6 00        DEC $00
02/863E: D0 DA        BNE $861A
02/8640: AB           PLB 
02/8641: 60           RTS 

; [ transfer 3bpp graphics to vram ]

; unused

02/8642: 8B           PHB 
02/8643: 48           PHA 
02/8644: AB           PLB 
02/8645: 8C 16 21     STY $2116
02/8648: 86 10        STX $10
02/864A: A0 00 00     LDY #$0000
02/864D: C2 20        REP #$20
02/864F: 48           PHA 
02/8650: A2 08 00     LDX #$0008
02/8653: B1 10        LDA ($10),Y
02/8655: 8D 18 21     STA $2118
02/8658: C8           INY 
02/8659: C8           INY 
02/865A: CA           DEX 
02/865B: D0 F6        BNE $8653
02/865D: A2 08 00     LDX #$0008
02/8660: 68           PLA 
02/8661: E2 20        SEP #$20
02/8663: B1 10        LDA ($10),Y
02/8665: 8D 18 21     STA $2118
02/8668: 9C 19 21     STZ $2119
02/866B: C8           INY 
02/866C: CA           DEX 
02/866D: D0 F4        BNE $8663
02/866F: C6 0E        DEC $0E
02/8671: D0 DA        BNE $864D
02/8673: AB           PLB 
02/8674: 60           RTS 

; [ transfer data to vram (channel 5) ]

02/8675: 8B           PHB 
02/8676: 48           PHA 
02/8677: 7B           TDC 
02/8678: 48           PHA 
02/8679: AB           PLB 
02/867A: 68           PLA 
02/867B: 8C 16 21     STY $2116
02/867E: 8E 52 43     STX $4352
02/8681: 8D 54 43     STA $4354
02/8684: A9 01        LDA #$01
02/8686: 8D 50 43     STA $4350
02/8689: A9 18        LDA #$18
02/868B: 8D 51 43     STA $4351
02/868E: A6 00        LDX $00
02/8690: 8E 55 43     STX $4355
02/8693: A9 20        LDA #$20
02/8695: 8D 0B 42     STA $420B
02/8698: AB           PLB 
02/8699: 60           RTS 

; [ transfer data to vram (channel 4) ]

02/869A: 8B           PHB 
02/869B: 48           PHA 
02/869C: 7B           TDC 
02/869D: 48           PHA 
02/869E: AB           PLB 
02/869F: 68           PLA 
02/86A0: 8C 16 21     STY $2116
02/86A3: 8E 42 43     STX $4342
02/86A6: 8D 44 43     STA $4344
02/86A9: A9 01        LDA #$01
02/86AB: 8D 40 43     STA $4340
02/86AE: A9 18        LDA #$18
02/86B0: 8D 41 43     STA $4341
02/86B3: A6 0E        LDX $0E
02/86B5: 8E 45 43     STX $4345
02/86B8: A9 10        LDA #$10
02/86BA: 8D 0B 42     STA $420B
02/86BD: AB           PLB 
02/86BE: 60           RTS 

; [ convert hex to decimal ]

02/86BF: 86 26        STX $26
02/86C1: A2 10 27     LDX #$2710      ; 10,000
02/86C4: 86 28        STX $28
02/86C6: 20 2B 85     JSR $852B       ; divide
02/86C9: A5 2A        LDA $2A
02/86CB: 18           CLC 
02/86CC: 69 80        ADC #$80
02/86CE: 8D 0C 18     STA $180C
02/86D1: A6 2C        LDX $2C
02/86D3: 86 26        STX $26
02/86D5: A2 E8 03     LDX #$03E8      ; 1000
02/86D8: 86 28        STX $28
02/86DA: 20 2B 85     JSR $852B       ; divide
02/86DD: A5 2A        LDA $2A
02/86DF: 18           CLC 
02/86E0: 69 80        ADC #$80
02/86E2: 8D 0D 18     STA $180D
02/86E5: A6 2C        LDX $2C
02/86E7: 86 26        STX $26
02/86E9: A2 64 00     LDX #$0064      ; 100
02/86EC: 86 28        STX $28
02/86EE: 20 2B 85     JSR $852B       ; divide
02/86F1: A5 2A        LDA $2A
02/86F3: 18           CLC 
02/86F4: 69 80        ADC #$80
02/86F6: 8D 0E 18     STA $180E
02/86F9: A6 2C        LDX $2C
02/86FB: 86 26        STX $26
02/86FD: A2 0A 00     LDX #$000A      ; 10
02/8700: 86 28        STX $28
02/8702: 20 2B 85     JSR $852B       ; divide
02/8705: A5 2A        LDA $2A
02/8707: 18           CLC 
02/8708: 69 80        ADC #$80
02/870A: 8D 0F 18     STA $180F
02/870D: A5 2C        LDA $2C
02/870F: 18           CLC 
02/8710: 69 80        ADC #$80
02/8712: 8D 10 18     STA $1810
02/8715: 60           RTS 

; [ normalize number text ]

02/8716: A2 00 00     LDX #$0000
02/8719: BD 0D 18     LDA $180D,X     ; shift out the top digit
02/871C: 9D 0C 18     STA $180C,X
02/871F: E8           INX 
02/8720: E0 05 00     CPX #$0005
02/8723: D0 F4        BNE $8719
02/8725: A2 00 00     LDX #$0000
02/8728: BD 0C 18     LDA $180C,X
02/872B: C9 80        CMP #$80
02/872D: D0 0B        BNE $873A       ; return if digit is not zero
02/872F: A9 FF        LDA #$FF
02/8731: 9D 0C 18     STA $180C,X     ; hide digit
02/8734: E8           INX 
02/8735: E0 03 00     CPX #$0003      ; don't hide ones digit
02/8738: D0 EE        BNE $8728
02/873A: 60           RTS 

; [  ]

02/873B: A2 00 00     LDX #$0000
02/873E: BD AD F4     LDA $F4AD,X
02/8741: C9 80        CMP #$80
02/8743: D0 0B        BNE $8750
02/8745: A9 FF        LDA #$FF
02/8747: 9D AD F4     STA $F4AD,X
02/874A: E8           INX 
02/874B: E0 07 00     CPX #$0007
02/874E: D0 EE        BNE $873E
02/8750: 60           RTS 

; character cursor data
02/8751: BC FF AB FF C9 FF 98 FF 8A FF

; [  ]

02/875B: A2 00 00     LDX #$0000
02/875E: BF 51 87 02  LDA $028751,X
02/8762: 9D DF 29     STA $29DF,X
02/8765: E8           INX 
02/8766: E0 0A 00     CPX #$000A
02/8769: D0 F3        BNE $875E
02/876B: 20 E3 87     JSR $87E3
02/876E: A2 00 00     LDX #$0000
02/8771: A0 00 00     LDY #$0000
02/8774: 64 02        STZ $02
02/8776: BD A5 29     LDA $29A5,X
02/8779: 4A           LSR 
02/877A: 4A           LSR 
02/877B: 4A           LSR 
02/877C: 4A           LSR 
02/877D: 99 FD 74     STA $74FD,Y
02/8780: BD A5 29     LDA $29A5,X
02/8783: 29 0F        AND #$0F
02/8785: 99 FE 74     STA $74FE,Y
02/8788: C8           INY 
02/8789: C8           INY 
02/878A: A5 02        LDA $02
02/878C: 9D 33 F3     STA $F333,X
02/878F: 9D 3B F3     STA $F33B,X
02/8792: E6 02        INC $02
02/8794: E8           INX 
02/8795: E0 08 00     CPX #$0008
02/8798: D0 DC        BNE $8776
02/879A: 20 B1 87     JSR $87B1
02/879D: A2 00 00     LDX #$0000
02/87A0: A0 07 00     LDY #$0007
02/87A3: B9 3B F3     LDA $F33B,Y
02/87A6: 9D 33 F3     STA $F333,X
02/87A9: 88           DEY 
02/87AA: E8           INX 
02/87AB: E0 08 00     CPX #$0008
02/87AE: D0 F3        BNE $87A3
02/87B0: 60           RTS 

; [  ]

02/87B1: A9 20        LDA #$20
02/87B3: 85 02        STA $02
02/87B5: A2 00 00     LDX #$0000
02/87B8: A0 00 00     LDY #$0000
02/87BB: BD FD 74     LDA $74FD,X
02/87BE: DD FF 74     CMP $74FF,X
02/87C1: D0 0E        BNE $87D1
02/87C3: BD FE 74     LDA $74FE,X
02/87C6: DD 00 75     CMP $7500,X
02/87C9: 90 0B        BCC $87D6
02/87CB: 20 58 88     JSR $8858
02/87CE: 4C D6 87     JMP $87D6
02/87D1: 90 03        BCC $87D6
02/87D3: 20 58 88     JSR $8858
02/87D6: E8           INX 
02/87D7: E8           INX 
02/87D8: C8           INY 
02/87D9: E0 0E 00     CPX #$000E
02/87DC: D0 DD        BNE $87BB
02/87DE: C6 02        DEC $02
02/87E0: D0 D3        BNE $87B5
02/87E2: 60           RTS 

; [  ]

02/87E3: A2 00 00     LDX #$0000
02/87E6: A0 00 00     LDY #$0000
02/87E9: 64 02        STZ $02
02/87EB: BD A5 29     LDA $29A5,X
02/87EE: 4A           LSR 
02/87EF: 4A           LSR 
02/87F0: 4A           LSR 
02/87F1: 4A           LSR 
02/87F2: 99 FD 74     STA $74FD,Y
02/87F5: BD A5 29     LDA $29A5,X
02/87F8: 29 0F        AND #$0F
02/87FA: 99 FE 74     STA $74FE,Y
02/87FD: C8           INY 
02/87FE: C8           INY 
02/87FF: A5 02        LDA $02
02/8801: 9D 43 F3     STA $F343,X
02/8804: 9D 4B F3     STA $F34B,X
02/8807: E6 02        INC $02
02/8809: E8           INX 
02/880A: E0 08 00     CPX #$0008
02/880D: D0 DC        BNE $87EB
02/880F: 20 26 88     JSR $8826
02/8812: A2 00 00     LDX #$0000
02/8815: A0 07 00     LDY #$0007
02/8818: B9 43 F3     LDA $F343,Y
02/881B: 9D 4B F3     STA $F34B,X
02/881E: 88           DEY 
02/881F: E8           INX 
02/8820: E0 08 00     CPX #$0008
02/8823: D0 F3        BNE $8818
02/8825: 60           RTS 
02/8826: A9 20        LDA #$20
02/8828: 85 02        STA $02
02/882A: A2 00 00     LDX #$0000
02/882D: A0 00 00     LDY #$0000
02/8830: BD FE 74     LDA $74FE,X
02/8833: DD 00 75     CMP $7500,X
02/8836: D0 0E        BNE $8846
02/8838: BD FD 74     LDA $74FD,X
02/883B: DD FF 74     CMP $74FF,X
02/883E: 90 0B        BCC $884B
02/8840: 20 6B 88     JSR $886B
02/8843: 4C 4B 88     JMP $884B
02/8846: 90 03        BCC $884B
02/8848: 20 6B 88     JSR $886B
02/884B: E8           INX 
02/884C: E8           INX 
02/884D: C8           INY 
02/884E: E0 0E 00     CPX #$000E
02/8851: D0 DD        BNE $8830
02/8853: C6 02        DEC $02
02/8855: D0 D3        BNE $882A
02/8857: 60           RTS 
02/8858: B9 3B F3     LDA $F33B,Y
02/885B: 85 00        STA $00
02/885D: B9 3C F3     LDA $F33C,Y
02/8860: 99 3B F3     STA $F33B,Y
02/8863: A5 00        LDA $00
02/8865: 99 3C F3     STA $F33C,Y
02/8868: 4C 7B 88     JMP $887B
02/886B: B9 43 F3     LDA $F343,Y
02/886E: 85 00        STA $00
02/8870: B9 44 F3     LDA $F344,Y
02/8873: 99 43 F3     STA $F343,Y
02/8876: A5 00        LDA $00
02/8878: 99 44 F3     STA $F344,Y
02/887B: BD FF 74     LDA $74FF,X
02/887E: 85 00        STA $00
02/8880: BD FD 74     LDA $74FD,X
02/8883: 9D FF 74     STA $74FF,X
02/8886: A5 00        LDA $00
02/8888: 9D FD 74     STA $74FD,X
02/888B: BD 00 75     LDA $7500,X
02/888E: 85 00        STA $00
02/8890: BD FE 74     LDA $74FE,X
02/8893: 9D 00 75     STA $7500,X
02/8896: A5 00        LDA $00
02/8898: 9D FE 74     STA $74FE,X
02/889B: 60           RTS 
02/889C: A0 00 00     LDY #$0000
02/889F: B9 BD 29     LDA $29BD,Y
02/88A2: 0A           ASL 
02/88A3: AA           TAX 
02/88A4: BD C3 6C     LDA $6CC3,X
02/88A7: 85 00        STA $00
02/88A9: BD C4 6C     LDA $6CC4,X
02/88AC: 85 01        STA $01
02/88AE: 98           TYA 
02/88AF: 0A           ASL 
02/88B0: AA           TAX 
02/88B1: 86 02        STX $02
02/88B3: A5 00        LDA $00
02/88B5: 9D A1 F2     STA $F2A1,X
02/88B8: A5 01        LDA $01
02/88BA: 9D A2 F2     STA $F2A2,X
02/88BD: 84 26        STY $26
02/88BF: A9 80        LDA #$80
02/88C1: 85 28        STA $28
02/88C3: 20 60 85     JSR $8560       ; multiply (8-bit)
02/88C6: A6 2A        LDX $2A
02/88C8: BD 85 22     LDA $2285,X
02/88CB: 29 20        AND #$20
02/88CD: F0 05        BEQ $88D4
02/88CF: A6 02        LDX $02
02/88D1: 4C EC 88     JMP $88EC
02/88D4: BD 83 22     LDA $2283,X
02/88D7: A6 02        LDX $02
02/88D9: 29 38        AND #$38
02/88DB: F0 17        BEQ $88F4
02/88DD: 29 30        AND #$30
02/88DF: F0 0B        BEQ $88EC
02/88E1: A9 02        LDA #$02
02/88E3: 9D A1 F2     STA $F2A1,X
02/88E6: 9D A2 F2     STA $F2A2,X
02/88E9: 4C F4 88     JMP $88F4
02/88EC: A9 04        LDA #$04
02/88EE: 9D A1 F2     STA $F2A1,X
02/88F1: 9D A2 F2     STA $F2A2,X
02/88F4: C8           INY 
02/88F5: C0 08 00     CPY #$0008
02/88F8: D0 A5        BNE $889F
02/88FA: 60           RTS 

; [  ]

02/88FB: 22 80 F6 03  JSL $03F680
02/88FF: 20 05 89     JSR $8905
02/8902: 4C 9C 88     JMP $889C
02/8905: A2 00 00     LDX #$0000
02/8908: BD F3 6C     LDA $6CF3,X
02/890B: 9D 53 F0     STA $F053,X
02/890E: 9D 39 F0     STA $F039,X
02/8911: 18           CLC 
02/8912: 69 18        ADC #$18
02/8914: 9D 6D F0     STA $F06D,X
02/8917: BD F4 6C     LDA $6CF4,X
02/891A: 9D 54 F0     STA $F054,X
02/891D: 9D 3A F0     STA $F03A,X
02/8920: 18           CLC 
02/8921: 69 18        ADC #$18
02/8923: 9D 6E F0     STA $F06E,X
02/8926: E8           INX 
02/8927: E8           INX 
02/8928: E0 0A 00     CPX #$000A
02/892B: D0 DB        BNE $8908
02/892D: 60           RTS 

; [  ]

02/892E: A9 05        LDA #$05
02/8930: 85 00        STA $00
02/8932: 7B           TDC 
02/8933: 85 02        STA $02
02/8935: A2 00 00     LDX #$0000
02/8938: A0 00 00     LDY #$0000
02/893B: C2 20        REP #$20
02/893D: BD 03 20     LDA $2003,X
02/8940: 99 15 F0     STA $F015,Y
02/8943: BD 05 20     LDA $2005,X
02/8946: 99 17 F0     STA $F017,Y
02/8949: 8A           TXA 
02/894A: 18           CLC 
02/894B: 69 80 00     ADC #$0080
02/894E: AA           TAX 
02/894F: 98           TYA 
02/8950: 18           CLC 
02/8951: 69 04 00     ADC #$0004
02/8954: A8           TAY 
02/8955: 7B           TDC 
02/8956: E2 20        SEP #$20
02/8958: 5A           PHY 
02/8959: A5 02        LDA $02
02/895B: A8           TAY 
02/895C: BD 80 1F     LDA $1F80,X
02/895F: 3A           DEC 
02/8960: C9 FF        CMP #$FF
02/8962: F0 02        BEQ $8966
02/8964: A5 02        LDA $02
02/8966: 99 C5 29     STA $29C5,Y
02/8969: 7A           PLY 
02/896A: E6 02        INC $02
02/896C: C6 00        DEC $00
02/896E: D0 CB        BNE $893B
02/8970: A2 00 00     LDX #$0000
02/8973: BD B5 29     LDA $29B5,X
02/8976: 9D 23 F1     STA $F123,X
02/8979: E8           INX 
02/897A: E0 08 00     CPX #$0008
02/897D: D0 F4        BNE $8973
02/897F: 60           RTS 

; [ clear sprite data ]

02/8980: A2 00 00     LDX #$0000
02/8983: A9 F0        LDA #$F0
02/8985: 9D 00 03     STA $0300,X
02/8988: E8           INX 
02/8989: E0 20 02     CPX #$0220
02/898C: D0 F7        BNE $8985
02/898E: 60           RTS 

; [  ]

02/898F: 22 E1 EA 01  JSL $01EAE1
02/8993: 22 BE FE 03  JSL $03FEBE     ; transfer color palettes to ppu
02/8997: 20 80 89     JSR $8980       ; clear sprite data
02/899A: 20 66 8A     JSR $8A66       ; clear tilemap buffer
02/899D: A0 00 58     LDY #$5800
02/89A0: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89A3: A0 00 5C     LDY #$5C00
02/89A6: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89A9: A0 00 60     LDY #$6000
02/89AC: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89AF: A0 00 64     LDY #$6400
02/89B2: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89B5: A0 00 68     LDY #$6800
02/89B8: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89BB: A0 00 6C     LDY #$6C00
02/89BE: 20 7C 8A     JSR $8A7C       ; transfer tilemap to vram
02/89C1: 20 2E 89     JSR $892E
02/89C4: 20 16 E1     JSR $E116
02/89C7: A9 01        LDA #$01
02/89C9: 8F 40 01 00  STA $000140     ; enable multi-controller update
02/89CD: 4C 1E F9     JMP $F91E

; [ init hardware registers ]

02/89D0: 7B           TDC 
02/89D1: 48           PHA 
02/89D2: AB           PLB 
02/89D3: 8D 00 42     STA $4200       ; disable nmi and irq
02/89D6: 8D 33 21     STA $2133
02/89D9: 8D 30 21     STA $2130
02/89DC: A9 02        LDA #$02
02/89DE: 8D 03 02     STA $0203
02/89E1: A2 45 83     LDX #$8345      ; 02/8345 (battle nmi)
02/89E4: 8E 01 02     STX $0201
02/89E7: A9 5C        LDA #$5C
02/89E9: 8D 00 02     STA $0200
02/89EC: 8D 04 02     STA $0204
02/89EF: A9 02        LDA #$02
02/89F1: 8D 07 02     STA $0207
02/89F4: A2 51 8A     LDX #$8A51      ; 02/8A51 (battle irq)
02/89F7: 8E 05 02     STX $0205
02/89FA: A2 00 70     LDX #$7000
02/89FD: A0 00 20     LDY #$2000
02/8A00: 20 E1 83     JSR $83E1       ; clear vram ($7000-$7FFF)
02/8A03: A2 00 40     LDX #$4000
02/8A06: A0 20 00     LDY #$0020
02/8A09: 20 E1 83     JSR $83E1       ; clear vram ($4000-$400F)
02/8A0C: A2 F0 1F     LDX #$1FF0
02/8A0F: A0 20 00     LDY #$0020
02/8A12: 20 E1 83     JSR $83E1       ; clear vram ($1FF0-$1FFF)
02/8A15: A9 33        LDA #$33
02/8A17: 8D 23 21     STA $2123
02/8A1A: 8D 25 21     STA $2125
02/8A1D: A9 08        LDA #$08
02/8A1F: 8D 26 21     STA $2126
02/8A22: A9 F8        LDA #$F8
02/8A24: 8D 27 21     STA $2127
02/8A27: 7B           TDC 
02/8A28: 8D 2E 21     STA $212E
02/8A2B: 8D 2F 21     STA $212F
02/8A2E: A9 7E        LDA #$7E
02/8A30: 48           PHA 
02/8A31: AB           PLB 
02/8A32: C2 20        REP #$20
02/8A34: AD 00 18     LDA $1800       ; battle id
02/8A37: 85 26        STA $26
02/8A39: A9 08 00     LDA #$0008
02/8A3C: 85 28        STA $28
02/8A3E: 7B           TDC 
02/8A3F: E2 20        SEP #$20
02/8A41: 20 7C 85     JSR $857C       ; multiply (16-bit)
02/8A44: A6 2A        LDX $2A
02/8A46: BF 06 80 0E  LDA $0E8006,X   ; battle properties byte 6
02/8A4A: 8D 4E ED     STA $ED4E
02/8A4D: 9C 87 EF     STZ $EF87       ; disable color flash
02/8A50: 60           RTS 

; [ battle irq ]

02/8A51: 08           PHP 
02/8A52: C2 20        REP #$20
02/8A54: 48           PHA 
02/8A55: E2 20        SEP #$20
02/8A57: AF 11 42 00  LDA $004211
02/8A5B: A9 01        LDA #$01
02/8A5D: 8F 53 F3 7E  STA $7EF353     ; set irq flag
02/8A61: C2 20        REP #$20
02/8A63: 68           PLA 
02/8A64: 28           PLP 
02/8A65: 40           RTI 

; [ clear tilemap buffer ]

02/8A66: A2 00 00     LDX #$0000
02/8A69: C2 20        REP #$20
02/8A6B: A9 00 02     LDA #$0200
02/8A6E: 9D FD 6C     STA $6CFD,X     ; tilemap buffer
02/8A71: E8           INX 
02/8A72: E8           INX 
02/8A73: E0 00 08     CPX #$0800
02/8A76: D0 F6        BNE $8A6E
02/8A78: 7B           TDC 
02/8A79: E2 20        SEP #$20
02/8A7B: 60           RTS 

; [ transfer tilemap to vram ]

02/8A7C: A2 00 08     LDX #$0800
02/8A7F: 86 00        STX $00
02/8A81: A2 FD 6C     LDX #$6CFD
02/8A84: A9 7E        LDA #$7E
02/8A86: 4C 75 86     JMP $8675       ; transfer data to vram

; [  ]

02/8A89: AD 09 F1     LDA $F109
02/8A8C: AA           TAX 
02/8A8D: BD BD 29     LDA $29BD,X
02/8A90: C9 FF        CMP #$FF
02/8A92: D0 01        BNE $8A95
02/8A94: 60           RTS 
02/8A95: BD A5 29     LDA $29A5,X
02/8A98: 29 F0        AND #$F0
02/8A9A: 4A           LSR 
02/8A9B: 4A           LSR 
02/8A9C: 4A           LSR 
02/8A9D: 4A           LSR 
02/8A9E: 1A           INC 
02/8A9F: 1A           INC 
02/8AA0: 85 00        STA $00
02/8AA2: BD A5 29     LDA $29A5,X
02/8AA5: 29 0F        AND #$0F
02/8AA7: 85 01        STA $01
02/8AA9: A5 01        LDA $01
02/8AAB: 85 26        STA $26
02/8AAD: A9 40        LDA #$40
02/8AAF: 85 28        STA $28
02/8AB1: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8AB4: A5 00        LDA $00
02/8AB6: C2 20        REP #$20
02/8AB8: 0A           ASL 
02/8AB9: 18           CLC 
02/8ABA: 65 2A        ADC $2A
02/8ABC: 69 FD 6C     ADC #$6CFD
02/8ABF: 85 04        STA $04
02/8AC1: 7B           TDC 
02/8AC2: E2 20        SEP #$20
02/8AC4: AD 09 F1     LDA $F109
02/8AC7: AA           TAX 
02/8AC8: BD BD 29     LDA $29BD,X
02/8ACB: 0A           ASL 
02/8ACC: AA           TAX 
02/8ACD: BD C3 6C     LDA $6CC3,X
02/8AD0: 85 00        STA $00
02/8AD2: BD C4 6C     LDA $6CC4,X
02/8AD5: 85 01        STA $01
02/8AD7: A5 00        LDA $00
02/8AD9: C9 02        CMP #$02
02/8ADB: D0 13        BNE $8AF0
02/8ADD: A9 04        LDA #$04
02/8ADF: 85 00        STA $00
02/8AE1: 85 01        STA $01
02/8AE3: C2 20        REP #$20
02/8AE5: A5 04        LDA $04
02/8AE7: 38           SEC 
02/8AE8: E9 02 00     SBC #$0002
02/8AEB: 85 04        STA $04
02/8AED: 7B           TDC 
02/8AEE: E2 20        SEP #$20
02/8AF0: AD 0A F1     LDA $F10A
02/8AF3: 0A           ASL 
02/8AF4: 0A           ASL 
02/8AF5: 85 06        STA $06
02/8AF7: A0 01 00     LDY #$0001
02/8AFA: A5 00        LDA $00
02/8AFC: AA           TAX 
02/8AFD: B1 04        LDA ($04),Y
02/8AFF: 29 E3        AND #$E3
02/8B01: 05 06        ORA $06
02/8B03: 91 04        STA ($04),Y
02/8B05: C8           INY 
02/8B06: C8           INY 
02/8B07: CA           DEX 
02/8B08: D0 F3        BNE $8AFD
02/8B0A: C2 20        REP #$20
02/8B0C: A5 04        LDA $04
02/8B0E: 18           CLC 
02/8B0F: 69 40 00     ADC #$0040
02/8B12: 85 04        STA $04
02/8B14: 7B           TDC 
02/8B15: E2 20        SEP #$20
02/8B17: C6 01        DEC $01
02/8B19: D0 DC        BNE $8AF7
02/8B1B: 60           RTS 

; --------------------------------------------------------------------------

; [ load graphics ]

02/8B1C: 20 D2 91     JSR $91D2       ; load battle bg graphics
02/8B1F: 20 37 91     JSR $9137       ; load menu graphics (bg3)
02/8B22: 20 73 90     JSR $9073       ; load menu graphics (bg2)
02/8B25: 20 63 90     JSR $9063       ; load misc. sprite graphics
02/8B28: 20 CA 8E     JSR $8ECA       ; load monster graphics
02/8B2B: 20 44 8B     JSR $8B44       ; load misc. monster graphics
02/8B2E: 20 2F 8D     JSR $8D2F       ; load monster tilemap
02/8B31: A2 80 04     LDX #$0480
02/8B34: 86 00        STX $00
02/8B36: A9 7E        LDA #$7E
02/8B38: A2 FD 6C     LDX #$6CFD
02/8B3B: A0 00 60     LDY #$6000
02/8B3E: 20 75 86     JSR $8675       ; transfer data to vram
02/8B41: 4C 7F 8B     JMP $8B7F

; [ load misc. monster graphics ]

02/8B44: A2 28 00     LDX #$0028
02/8B47: 86 00        STX $00
02/8B49: A2 00 80     LDX #$8000
02/8B4C: A0 90 42     LDY #$4290
02/8B4F: A9 09        LDA #$09
02/8B51: 20 0F 86     JSR $860F       ; transfer 3bpp graphics to vram
02/8B54: A2 02 00     LDX #$0002
02/8B57: 86 00        STX $00
02/8B59: A2 30 FF     LDX #$FF30
02/8B5C: A0 10 45     LDY #$4510
02/8B5F: A9 0C        LDA #$0C
02/8B61: 20 0F 86     JSR $860F       ; transfer 3bpp graphics to vram
02/8B64: 7B           TDC 
02/8B65: AA           TAX 
02/8B66: 9D E6 D9     STA $D9E6,X
02/8B69: E8           INX 
02/8B6A: E0 00 01     CPX #$0100
02/8B6D: D0 F7        BNE $8B66
02/8B6F: A2 08 00     LDX #$0008
02/8B72: 86 00        STX $00
02/8B74: A0 30 FF     LDY #$FF30
02/8B77: A2 E6 D9     LDX #$D9E6
02/8B7A: A9 0C        LDA #$0C
02/8B7C: 4C 3D DA     JMP $DA3D       ; load 3bpp graphics

; [  ]

02/8B7F: 7B           TDC 
02/8B80: AA           TAX 
02/8B81: 8A           TXA 
02/8B82: 0A           ASL 
02/8B83: A8           TAY 
02/8B84: BD 23 F1     LDA $F123,X
02/8B87: C9 FF        CMP #$FF
02/8B89: F0 2A        BEQ $8BB5
02/8B8B: 5A           PHY 
02/8B8C: 0A           ASL 
02/8B8D: A8           TAY 
02/8B8E: B9 C4 6C     LDA $6CC4,Y
02/8B91: 0A           ASL 
02/8B92: 0A           ASL 
02/8B93: 38           SEC 
02/8B94: E9 04        SBC #$04
02/8B96: 85 00        STA $00
02/8B98: 7A           PLY 
02/8B99: BD A5 29     LDA $29A5,X
02/8B9C: 29 0F        AND #$0F
02/8B9E: 0A           ASL 
02/8B9F: 0A           ASL 
02/8BA0: 0A           ASL 
02/8BA1: 18           CLC 
02/8BA2: 65 00        ADC $00
02/8BA4: 99 E4 6C     STA $6CE4,Y
02/8BA7: BD A5 29     LDA $29A5,X
02/8BAA: 29 F0        AND #$F0
02/8BAC: 4A           LSR 
02/8BAD: 18           CLC 
02/8BAE: 69 08        ADC #$08
02/8BB0: 99 E3 6C     STA $6CE3,Y
02/8BB3: 80 08        BRA $8BBD
02/8BB5: A9 FF        LDA #$FF
02/8BB7: 99 E3 6C     STA $6CE3,Y
02/8BBA: 99 E4 6C     STA $6CE4,Y
02/8BBD: E8           INX 
02/8BBE: E0 08 00     CPX #$0008
02/8BC1: D0 BE        BNE $8B81
02/8BC3: 20 FB 88     JSR $88FB
02/8BC6: 60           RTS 

; [  ]

02/8BC7: 22 E1 E9 01  JSL $01E9E1
02/8BCB: 60           RTS 

; [  ]

02/8BCC: 8D 9E F4     STA $F49E
02/8BCF: 8C 4F F4     STY $F44F
02/8BD2: 85 26        STA $26
02/8BD4: A9 05        LDA #$05
02/8BD6: 85 28        STA $28
02/8BD8: A9 20        LDA #$20
02/8BDA: 8D 9D F4     STA $F49D
02/8BDD: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8BE0: A6 2A        LDX $2A
02/8BE2: 7B           TDC 
02/8BE3: A8           TAY 
02/8BE4: BF 00 CE 0F  LDA $0FCE00,X
02/8BE8: 99 A3 EF     STA $EFA3,Y
02/8BEB: E8           INX 
02/8BEC: C8           INY 
02/8BED: C0 05 00     CPY #$0005
02/8BF0: D0 F2        BNE $8BE4
02/8BF2: AD A4 EF     LDA $EFA4
02/8BF5: 10 03        BPL $8BFA
02/8BF7: 20 66 8A     JSR $8A66       ; clear tilemap buffer
02/8BFA: AD A6 EF     LDA $EFA6
02/8BFD: 29 30        AND #$30
02/8BFF: 4A           LSR 
02/8C00: 4A           LSR 
02/8C01: 4A           LSR 
02/8C02: 4A           LSR 
02/8C03: 85 06        STA $06
02/8C05: AA           TAX 
02/8C06: AD A5 EF     LDA $EFA5
02/8C09: 9D 0D F1     STA $F10D,X
02/8C0C: E8           INX 
02/8C0D: E8           INX 
02/8C0E: E8           INX 
02/8C0F: 20 50 91     JSR $9150
02/8C12: A5 06        LDA $06
02/8C14: 0A           ASL 
02/8C15: A8           TAY 
02/8C16: AD A4 EF     LDA $EFA4
02/8C19: 29 3F        AND #$3F
02/8C1B: 0A           ASL 
02/8C1C: AA           TAX 
02/8C1D: BF 5E FF 0D  LDA $0DFF5E,X   ; monster graphics sizes
02/8C21: 85 00        STA $00
02/8C23: 99 C3 6C     STA $6CC3,Y
02/8C26: BF 5F FF 0D  LDA $0DFF5F,X
02/8C2A: 85 01        STA $01
02/8C2C: 99 C4 6C     STA $6CC4,Y
02/8C2F: 5A           PHY 
02/8C30: AC 4F F4     LDY $F44F
02/8C33: AD A3 EF     LDA $EFA3
02/8C36: 99 A5 29     STA $29A5,Y
02/8C39: 7A           PLY 
02/8C3A: AD A3 EF     LDA $EFA3
02/8C3D: 29 F0        AND #$F0
02/8C3F: 4A           LSR 
02/8C40: 4A           LSR 
02/8C41: 4A           LSR 
02/8C42: 4A           LSR 
02/8C43: 1A           INC 
02/8C44: 1A           INC 
02/8C45: 85 04        STA $04
02/8C47: AD A3 EF     LDA $EFA3
02/8C4A: 29 0F        AND #$0F
02/8C4C: 85 05        STA $05
02/8C4E: A5 05        LDA $05
02/8C50: 85 26        STA $26
02/8C52: A9 40        LDA #$40
02/8C54: 85 28        STA $28
02/8C56: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8C59: A5 04        LDA $04
02/8C5B: 0A           ASL 
02/8C5C: C2 20        REP #$20
02/8C5E: 18           CLC 
02/8C5F: 65 2A        ADC $2A
02/8C61: 69 FD 6C     ADC #$6CFD
02/8C64: 85 04        STA $04
02/8C66: 7B           TDC 
02/8C67: E2 20        SEP #$20
02/8C69: A5 06        LDA $06
02/8C6B: 1A           INC 
02/8C6C: 1A           INC 
02/8C6D: 1A           INC 
02/8C6E: 0A           ASL 
02/8C6F: 0A           ASL 
02/8C70: 85 07        STA $07
02/8C72: AD A4 EF     LDA $EFA4
02/8C75: 29 40        AND #$40
02/8C77: F0 02        BEQ $8C7B
02/8C79: E6 07        INC $07
02/8C7B: A5 0A        LDA $0A
02/8C7D: AA           TAX 
02/8C7E: BD DF 6C     LDA $6CDF,X
02/8C81: 85 06        STA $06
02/8C83: AD A7 EF     LDA $EFA7
02/8C86: 0A           ASL 
02/8C87: AA           TAX 
02/8C88: BF 00 CF 0E  LDA $0ECF00,X   ; pointers to boss graphics maps
02/8C8C: 85 26        STA $26
02/8C8E: BF 01 CF 0E  LDA $0ECF01,X
02/8C92: 85 27        STA $27
02/8C94: A9 0E        LDA #$0E
02/8C96: 85 28        STA $28
02/8C98: 7B           TDC 
02/8C99: AA           TAX 
02/8C9A: 64 09        STZ $09
02/8C9C: A5 00        LDA $00
02/8C9E: 85 02        STA $02
02/8CA0: A0 00 00     LDY #$0000
02/8CA3: 20 E1 8C     JSR $8CE1
02/8CA6: 91 04        STA ($04),Y
02/8CA8: C8           INY 
02/8CA9: A5 07        LDA $07
02/8CAB: 25 0C        AND $0C
02/8CAD: 05 08        ORA $08
02/8CAF: 05 2A        ORA $2A
02/8CB1: 91 04        STA ($04),Y
02/8CB3: C8           INY 
02/8CB4: C6 02        DEC $02
02/8CB6: D0 EB        BNE $8CA3
02/8CB8: C2 20        REP #$20
02/8CBA: A5 04        LDA $04
02/8CBC: 18           CLC 
02/8CBD: 69 40 00     ADC #$0040
02/8CC0: 85 04        STA $04
02/8CC2: 7B           TDC 
02/8CC3: E2 20        SEP #$20
02/8CC5: AD A1 F4     LDA $F4A1
02/8CC8: D0 0D        BNE $8CD7
02/8CCA: AD 9E F4     LDA $F49E
02/8CCD: C9 39        CMP #$39
02/8CCF: D0 09        BNE $8CDA
02/8CD1: A5 01        LDA $01
02/8CD3: C9 04        CMP #$04
02/8CD5: D0 03        BNE $8CDA
02/8CD7: 9C 9D F4     STZ $F49D
02/8CDA: C6 01        DEC $01
02/8CDC: D0 BE        BNE $8C9C
02/8CDE: 4C 9C 88     JMP $889C

; [  ]

02/8CE1: 64 2A        STZ $2A
02/8CE3: A5 09        LDA $09
02/8CE5: F0 0F        BEQ $8CF6
02/8CE7: C6 09        DEC $09
02/8CE9: A9 FE        LDA #$FE
02/8CEB: 85 0C        STA $0C
02/8CED: A9 02        LDA #$02
02/8CEF: 0D 9D F4     ORA $F49D
02/8CF2: 85 08        STA $08
02/8CF4: 7B           TDC 
02/8CF5: 60           RTS 
02/8CF6: 5A           PHY 
02/8CF7: DA           PHX 
02/8CF8: 7A           PLY 
02/8CF9: B7 26        LDA [$26],Y
02/8CFB: C9 FF        CMP #$FF
02/8CFD: F0 0B        BEQ $8D0A
02/8CFF: C9 FE        CMP #$FE
02/8D01: D0 15        BNE $8D18
02/8D03: C8           INY 
02/8D04: B7 26        LDA [$26],Y
02/8D06: 3A           DEC 
02/8D07: 85 09        STA $09
02/8D09: E8           INX 
02/8D0A: A9 FE        LDA #$FE
02/8D0C: 85 0C        STA $0C
02/8D0E: A9 02        LDA #$02
02/8D10: 0D 9D F4     ORA $F49D
02/8D13: 85 08        STA $08
02/8D15: 7B           TDC 
02/8D16: 80 10        BRA $8D28
02/8D18: 48           PHA 
02/8D19: A9 FF        LDA #$FF
02/8D1B: 85 0C        STA $0C
02/8D1D: AD 9D F4     LDA $F49D
02/8D20: 85 08        STA $08
02/8D22: 68           PLA 
02/8D23: 18           CLC 
02/8D24: 65 06        ADC $06
02/8D26: 26 2A        ROL $2A
02/8D28: E8           INX 
02/8D29: 7A           PLY 
02/8D2A: 60           RTS 

; [  ]

02/8D2B: 20 35 8D     JSR $8D35
02/8D2E: 6B           RTL 

; [ load monster tilemap ]

02/8D2F: 20 35 8D     JSR $8D35
02/8D32: 4C C7 8B     JMP $8BC7

; [  ]

02/8D35: 20 66 8A     JSR $8A66       ; clear tilemap buffer
02/8D38: AD 73 F4     LDA $F473
02/8D3B: D0 64        BNE $8DA1
02/8D3D: 7B           TDC 
02/8D3E: AA           TAX 
02/8D3F: DA           PHX 
02/8D40: 8A           TXA 
02/8D41: 85 02        STA $02
02/8D43: BD B5 29     LDA $29B5,X
02/8D46: C9 FF        CMP #$FF
02/8D48: F0 50        BEQ $8D9A
02/8D4A: 85 0A        STA $0A
02/8D4C: AA           TAX 
02/8D4D: BD B1 29     LDA $29B1,X
02/8D50: 20 C1 8E     JSR $8EC1
02/8D53: BF 00 CA 0F  LDA $0FCA00,X   ; monster graphics properties
02/8D57: 10 19        BPL $8D72
02/8D59: A5 02        LDA $02
02/8D5B: A8           TAY 
02/8D5C: B9 B4 F2     LDA $F2B4,Y
02/8D5F: C9 FF        CMP #$FF
02/8D61: D0 09        BNE $8D6C
02/8D63: BF 00 CA 0F  LDA $0FCA00,X
02/8D67: 29 3F        AND #$3F
02/8D69: 99 B4 F2     STA $F2B4,Y
02/8D6C: 20 CC 8B     JSR $8BCC
02/8D6F: 4C 9A 8D     JMP $8D9A
02/8D72: A5 0A        LDA $0A
02/8D74: AA           TAX 
02/8D75: 0A           ASL 
02/8D76: A8           TAY 
02/8D77: B9 C3 6C     LDA $6CC3,Y
02/8D7A: 85 00        STA $00
02/8D7C: B9 C4 6C     LDA $6CC4,Y
02/8D7F: 85 01        STA $01
02/8D81: FA           PLX 
02/8D82: DA           PHX 
02/8D83: BD A5 29     LDA $29A5,X
02/8D86: 29 0F        AND #$0F
02/8D88: 85 05        STA $05
02/8D8A: BD A5 29     LDA $29A5,X
02/8D8D: 29 F0        AND #$F0
02/8D8F: 4A           LSR 
02/8D90: 4A           LSR 
02/8D91: 4A           LSR 
02/8D92: 4A           LSR 
02/8D93: 1A           INC 
02/8D94: 1A           INC 
02/8D95: 85 04        STA $04
02/8D97: 20 A8 8D     JSR $8DA8
02/8D9A: FA           PLX 
02/8D9B: E8           INX 
02/8D9C: E0 08 00     CPX #$0008
02/8D9F: D0 9E        BNE $8D3F
02/8DA1: 22 2F F0 01  JSL $01F02F
02/8DA5: 4C 9C 88     JMP $889C
02/8DA8: A5 02        LDA $02
02/8DAA: 85 26        STA $26
02/8DAC: A9 80        LDA #$80
02/8DAE: 85 28        STA $28
02/8DB0: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8DB3: A6 2A        LDX $2A
02/8DB5: BD 85 22     LDA $2285,X
02/8DB8: 29 20        AND #$20
02/8DBA: D0 09        BNE $8DC5
02/8DBC: BD 83 22     LDA $2283,X
02/8DBF: 29 38        AND #$38
02/8DC1: F0 57        BEQ $8E1A
02/8DC3: 85 06        STA $06
02/8DC5: A5 00        LDA $00
02/8DC7: 4A           LSR 
02/8DC8: 3A           DEC 
02/8DC9: 18           CLC 
02/8DCA: 65 04        ADC $04
02/8DCC: 85 04        STA $04
02/8DCE: A5 01        LDA $01
02/8DD0: 4A           LSR 
02/8DD1: 3A           DEC 
02/8DD2: 18           CLC 
02/8DD3: 65 05        ADC $05
02/8DD5: 85 05        STA $05
02/8DD7: A9 02        LDA #$02
02/8DD9: 85 00        STA $00
02/8DDB: 85 01        STA $01
02/8DDD: A9 3A        LDA #$3A
02/8DDF: 85 07        STA $07
02/8DE1: BD 85 22     LDA $2285,X
02/8DE4: 29 20        AND #$20
02/8DE6: F0 0E        BEQ $8DF6
02/8DE8: C6 04        DEC $04
02/8DEA: C6 05        DEC $05
02/8DEC: A9 04        LDA #$04
02/8DEE: 85 00        STA $00
02/8DF0: 85 01        STA $01
02/8DF2: A9 41        LDA #$41
02/8DF4: 80 20        BRA $8E16
02/8DF6: A5 06        LDA $06
02/8DF8: 29 20        AND #$20
02/8DFA: F0 04        BEQ $8E00
02/8DFC: A9 2D        LDA #$2D
02/8DFE: 80 16        BRA $8E16
02/8E00: A5 06        LDA $06
02/8E02: 29 10        AND #$10
02/8E04: D0 0E        BNE $8E14
02/8E06: C6 04        DEC $04
02/8E08: C6 05        DEC $05
02/8E0A: A9 04        LDA #$04
02/8E0C: 85 00        STA $00
02/8E0E: 85 01        STA $01
02/8E10: A9 31        LDA #$31
02/8E12: 80 02        BRA $8E16
02/8E14: A9 29        LDA #$29
02/8E16: 85 06        STA $06
02/8E18: 80 22        BRA $8E3C
02/8E1A: A5 0A        LDA $0A
02/8E1C: AA           TAX 
02/8E1D: BD DB 6C     LDA $6CDB,X
02/8E20: 85 07        STA $07
02/8E22: BD DF 6C     LDA $6CDF,X
02/8E25: 85 06        STA $06
02/8E27: AD 4E ED     LDA $ED4E
02/8E2A: 29 10        AND #$10
02/8E2C: F0 0E        BEQ $8E3C
02/8E2E: 20 A5 8E     JSR $8EA5
02/8E31: A5 07        LDA $07
02/8E33: 49 40        EOR #$40
02/8E35: 85 07        STA $07
02/8E37: 22 B8 F2 01  JSL $01F2B8
02/8E3B: 60           RTS 
02/8E3C: 20 A5 8E     JSR $8EA5
02/8E3F: A5 00        LDA $00
02/8E41: AA           TAX 
02/8E42: 7B           TDC 
02/8E43: A8           TAY 
02/8E44: C2 20        REP #$20
02/8E46: A5 06        LDA $06
02/8E48: 91 04        STA ($04),Y
02/8E4A: C8           INY 
02/8E4B: C8           INY 
02/8E4C: E6 06        INC $06
02/8E4E: CA           DEX 
02/8E4F: D0 F5        BNE $8E46
02/8E51: A5 04        LDA $04
02/8E53: 18           CLC 
02/8E54: 69 40 00     ADC #$0040
02/8E57: 85 04        STA $04
02/8E59: 7B           TDC 
02/8E5A: E2 20        SEP #$20
02/8E5C: C6 01        DEC $01
02/8E5E: D0 DF        BNE $8E3F
02/8E60: C2 20        REP #$20
02/8E62: A5 04        LDA $04
02/8E64: 18           CLC 
02/8E65: 69 40 00     ADC #$0040
02/8E68: 85 04        STA $04
02/8E6A: 7B           TDC 
02/8E6B: E2 20        SEP #$20
02/8E6D: AD 4E ED     LDA $ED4E
02/8E70: 29 40        AND #$40
02/8E72: F0 30        BEQ $8EA4       ; branch if monsters are not flying
02/8E74: 7B           TDC 
02/8E75: A8           TAY 
02/8E76: A9 51        LDA #$51
02/8E78: 91 04        STA ($04),Y
02/8E7A: C8           INY 
02/8E7B: A9 3A        LDA #$3A
02/8E7D: 91 04        STA ($04),Y
02/8E7F: A5 00        LDA $00
02/8E81: 3A           DEC 
02/8E82: 0A           ASL 
02/8E83: A8           TAY 
02/8E84: A9 51        LDA #$51
02/8E86: 91 04        STA ($04),Y
02/8E88: C8           INY 
02/8E89: A9 7A        LDA #$7A
02/8E8B: 91 04        STA ($04),Y
02/8E8D: C6 00        DEC $00
02/8E8F: C6 00        DEC $00
02/8E91: F0 11        BEQ $8EA4
02/8E93: A0 02 00     LDY #$0002
02/8E96: A9 52        LDA #$52
02/8E98: 91 04        STA ($04),Y
02/8E9A: C8           INY 
02/8E9B: A9 3A        LDA #$3A
02/8E9D: 91 04        STA ($04),Y
02/8E9F: C8           INY 
02/8EA0: C6 00        DEC $00
02/8EA2: D0 F2        BNE $8E96
02/8EA4: 60           RTS 
02/8EA5: A5 05        LDA $05
02/8EA7: 85 26        STA $26
02/8EA9: A9 40        LDA #$40
02/8EAB: 85 28        STA $28
02/8EAD: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8EB0: A5 04        LDA $04
02/8EB2: 0A           ASL 
02/8EB3: C2 20        REP #$20
02/8EB5: 18           CLC 
02/8EB6: 65 2A        ADC $2A
02/8EB8: 69 FD 6C     ADC #$6CFD
02/8EBB: 85 04        STA $04
02/8EBD: 7B           TDC 
02/8EBE: E2 20        SEP #$20
02/8EC0: 60           RTS 
02/8EC1: C2 20        REP #$20
02/8EC3: 0A           ASL 
02/8EC4: 0A           ASL 
02/8EC5: AA           TAX 
02/8EC6: 7B           TDC 
02/8EC7: E2 20        SEP #$20
02/8EC9: 60           RTS 

; [ load monster graphics ]

02/8ECA: AD A4 29     LDA $29A4
02/8ECD: 29 07        AND #$07
02/8ECF: 0A           ASL 
02/8ED0: 0A           ASL 
02/8ED1: 48           PHA 
02/8ED2: 0A           ASL 
02/8ED3: AA           TAX 
02/8ED4: 7B           TDC 
02/8ED5: A8           TAY 
02/8ED6: BF DC FB 16  LDA $16FBDC,X
02/8EDA: 99 CB 6C     STA $6CCB,Y
02/8EDD: BF AC FB 16  LDA $16FBAC,X
02/8EE1: 99 D3 6C     STA $6CD3,Y
02/8EE4: E8           INX 
02/8EE5: C8           INY 
02/8EE6: C0 08 00     CPY #$0008
02/8EE9: D0 EB        BNE $8ED6
02/8EEB: 7B           TDC 
02/8EEC: A8           TAY 
02/8EED: 68           PLA 
02/8EEE: AA           TAX 
02/8EEF: BF 0C FC 16  LDA $16FC0C,X
02/8EF3: 99 DB 6C     STA $6CDB,Y
02/8EF6: BF 24 FC 16  LDA $16FC24,X
02/8EFA: 99 DF 6C     STA $6CDF,Y
02/8EFD: C8           INY 
02/8EFE: E8           INX 
02/8EFF: C0 04 00     CPY #$0004
02/8F02: D0 EB        BNE $8EEF
02/8F04: 7B           TDC 
02/8F05: AA           TAX 
02/8F06: DA           PHX 
02/8F07: 86 0A        STX $0A
02/8F09: BD AD 29     LDA $29AD,X
02/8F0C: C9 FF        CMP #$FF
02/8F0E: D0 03        BNE $8F13
02/8F10: 4C 4D 90     JMP $904D
02/8F13: 20 C1 8E     JSR $8EC1
02/8F16: BF 00 CA 0F  LDA $0FCA00,X
02/8F1A: 85 00        STA $00
02/8F1C: BF 01 CA 0F  LDA $0FCA01,X
02/8F20: 85 02        STA $02
02/8F22: BF 02 CA 0F  LDA $0FCA02,X
02/8F26: 85 04        STA $04
02/8F28: BF 03 CA 0F  LDA $0FCA03,X
02/8F2C: 85 05        STA $05
02/8F2E: A5 00        LDA $00
02/8F30: 29 40        AND #$40
02/8F32: F0 56        BEQ $8F8A
02/8F34: A9 02        LDA #$02
02/8F36: 85 06        STA $06
02/8F38: A9 03        LDA #$03
02/8F3A: 85 07        STA $07
02/8F3C: A5 0A        LDA $0A
02/8F3E: 0A           ASL 
02/8F3F: A8           TAY 
02/8F40: A5 06        LDA $06
02/8F42: 99 C3 6C     STA $6CC3,Y
02/8F45: A5 07        LDA $07
02/8F47: 99 C4 6C     STA $6CC4,Y
02/8F4A: A5 00        LDA $00
02/8F4C: 48           PHA 
02/8F4D: A6 0A        LDX $0A
02/8F4F: A5 02        LDA $02
02/8F51: 9D 0D F1     STA $F10D,X
02/8F54: E8           INX 
02/8F55: E8           INX 
02/8F56: E8           INX 
02/8F57: 20 A9 91     JSR $91A9
02/8F5A: 68           PLA 
02/8F5B: 29 3F        AND #$3F
02/8F5D: AA           TAX 
02/8F5E: 86 26        STX $26
02/8F60: A2 00 08     LDX #$0800
02/8F63: 86 28        STX $28
02/8F65: 20 7C 85     JSR $857C       ; multiply (16-bit)
02/8F68: C2 20        REP #$20
02/8F6A: A5 2A        LDA $2A
02/8F6C: 18           CLC 
02/8F6D: 69 00 80     ADC #$8000
02/8F70: AA           TAX 
02/8F71: A9 00 08     LDA #$0800
02/8F74: 85 00        STA $00
02/8F76: 7B           TDC 
02/8F77: E2 20        SEP #$20
02/8F79: DA           PHX 
02/8F7A: A5 0A        LDA $0A
02/8F7C: 0A           ASL 
02/8F7D: AA           TAX 
02/8F7E: BC CB 6C     LDY $6CCB,X
02/8F81: A9 1A        LDA #$1A
02/8F83: FA           PLX 
02/8F84: 20 75 86     JSR $8675       ; transfer data to vram
02/8F87: 4C 4D 90     JMP $904D
02/8F8A: A5 00        LDA $00
02/8F8C: 10 49        BPL $8FD7
02/8F8E: A5 00        LDA $00
02/8F90: 29 3F        AND #$3F
02/8F92: 85 26        STA $26
02/8F94: A9 05        LDA #$05
02/8F96: 85 28        STA $28
02/8F98: 20 60 85     JSR $8560       ; multiply (8-bit)
02/8F9B: A6 2A        LDX $2A
02/8F9D: A5 0A        LDA $0A
02/8F9F: 0A           ASL 
02/8FA0: A8           TAY 
02/8FA1: BF 01 CE 0F  LDA $0FCE01,X
02/8FA5: 29 3F        AND #$3F
02/8FA7: 0A           ASL 
02/8FA8: AA           TAX 
02/8FA9: BF 5E FF 0D  LDA $0DFF5E,X   ; monster graphics sizes
02/8FAD: 85 06        STA $06
02/8FAF: 99 C3 6C     STA $6CC3,Y
02/8FB2: BF 5F FF 0D  LDA $0DFF5F,X
02/8FB6: 85 07        STA $07
02/8FB8: 99 C4 6C     STA $6CC4,Y
02/8FBB: A6 2A        LDX $2A
02/8FBD: BF 02 CE 0F  LDA $0FCE02,X
02/8FC1: A6 0A        LDX $0A
02/8FC3: 9D 0D F1     STA $F10D,X
02/8FC6: E8           INX 
02/8FC7: E8           INX 
02/8FC8: E8           INX 
02/8FC9: 20 50 91     JSR $9150
02/8FCC: A5 0A        LDA $0A
02/8FCE: 0A           ASL 
02/8FCF: AA           TAX 
02/8FD0: BD D3 6C     LDA $6CD3,X
02/8FD3: AA           TAX 
02/8FD4: 4C 07 90     JMP $9007
02/8FD7: 29 3F        AND #$3F
02/8FD9: 0A           ASL 
02/8FDA: AA           TAX 
02/8FDB: BF 5E FF 0D  LDA $0DFF5E,X   ; monster graphics sizes
02/8FDF: 85 06        STA $06
02/8FE1: BF 5F FF 0D  LDA $0DFF5F,X
02/8FE5: 85 07        STA $07
02/8FE7: A5 0A        LDA $0A
02/8FE9: 0A           ASL 
02/8FEA: A8           TAY 
02/8FEB: A5 06        LDA $06
02/8FED: 99 C3 6C     STA $6CC3,Y
02/8FF0: A5 07        LDA $07
02/8FF2: 99 C4 6C     STA $6CC4,Y
02/8FF5: A6 0A        LDX $0A
02/8FF7: A5 02        LDA $02
02/8FF9: 9D 0D F1     STA $F10D,X
02/8FFC: E8           INX 
02/8FFD: E8           INX 
02/8FFE: E8           INX 
02/8FFF: 20 50 91     JSR $9150
02/9002: 20 58 90     JSR $9058
02/9005: A6 2A        LDX $2A
02/9007: 86 00        STX $00
02/9009: 86 2A        STX $2A
02/900B: A5 0A        LDA $0A
02/900D: 0A           ASL 
02/900E: AA           TAX 
02/900F: BC CB 6C     LDY $6CCB,X
02/9012: A5 05        LDA $05
02/9014: 29 70        AND #$70
02/9016: 4A           LSR 
02/9017: 4A           LSR 
02/9018: 4A           LSR 
02/9019: 4A           LSR 
02/901A: 18           CLC 
02/901B: 69 09        ADC #$09
02/901D: 48           PHA 
02/901E: C2 20        REP #$20
02/9020: A5 2A        LDA $2A
02/9022: 0A           ASL 
02/9023: 0A           ASL 
02/9024: 0A           ASL 
02/9025: 0A           ASL 
02/9026: 0A           ASL 
02/9027: 85 2A        STA $2A
02/9029: A5 04        LDA $04
02/902B: 29 FF 0F     AND #$0FFF
02/902E: 0A           ASL 
02/902F: 0A           ASL 
02/9030: 0A           ASL 
02/9031: 18           CLC 
02/9032: 69 00 80     ADC #$8000
02/9035: AA           TAX 
02/9036: 7B           TDC 
02/9037: E2 20        SEP #$20
02/9039: A5 05        LDA $05
02/903B: 30 0C        BMI $9049
02/903D: DA           PHX 
02/903E: A6 2A        LDX $2A
02/9040: 86 00        STX $00
02/9042: FA           PLX 
02/9043: 68           PLA 
02/9044: 20 75 86     JSR $8675       ; transfer data to vram
02/9047: 80 04        BRA $904D
02/9049: 68           PLA 
02/904A: 20 0F 86     JSR $860F       ; transfer 3bpp graphics to vram
02/904D: FA           PLX 
02/904E: E8           INX 
02/904F: E0 03 00     CPX #$0003
02/9052: F0 03        BEQ $9057
02/9054: 4C 06 8F     JMP $8F06
02/9057: 60           RTS 
02/9058: A5 06        LDA $06
02/905A: 85 26        STA $26
02/905C: A5 07        LDA $07
02/905E: 85 28        STA $28
02/9060: 4C 60 85     JMP $8560       ; multiply (8-bit)

; [ load misc. sprite graphics ]

02/9063: A2 50 00     LDX #$0050
02/9066: 86 00        STX $00
02/9068: A2 C0 F9     LDX #$F9C0
02/906B: A0 00 14     LDY #$1400
02/906E: A9 0C        LDA #$0C
02/9070: 4C 0F 86     JMP $860F       ; transfer 3bpp graphics to vram

; [ load menu graphics (bg2) ]

02/9073: A2 B0 4D     LDX #$4DB0
02/9076: A0 A0 04     LDY #$04A0
02/9079: 20 E1 83     JSR $83E1       ; clear vram ($4DB0-$4FFF)
02/907C: A2 B0 4D     LDX #$4DB0
02/907F: 86 04        STX $04
02/9081: 7B           TDC 
02/9082: AA           TAX 
02/9083: A4 04        LDY $04
02/9085: BF 87 FB 16  LDA $16FB87,X   ; menu tiles used in bg2 battle menu
02/9089: 20 A0 90     JSR $90A0       ; transfer bg2 menu tile to vram
02/908C: C2 20        REP #$20
02/908E: A5 04        LDA $04
02/9090: 18           CLC 
02/9091: 69 10 00     ADC #$0010
02/9094: 85 04        STA $04
02/9096: 7B           TDC 
02/9097: E2 20        SEP #$20
02/9099: E8           INX 
02/909A: E0 25 00     CPX #$0025
02/909D: D0 E4        BNE $9083
02/909F: 60           RTS 

; [ transfer bg2 menu tile to vram ]

02/90A0: DA           PHX 
02/90A1: 85 26        STA $26
02/90A3: A9 10        LDA #$10
02/90A5: 85 28        STA $28
02/90A7: 20 60 85     JSR $8560       ; multiply (8-bit)
02/90AA: C2 20        REP #$20
02/90AC: A5 2A        LDA $2A
02/90AE: 18           CLC 
02/90AF: 69 00 F0     ADC #$F000      ; 0A/F000 (menu/text graphics)
02/90B2: AA           TAX 
02/90B3: A9 10 00     LDA #$0010
02/90B6: 85 00        STA $00
02/90B8: 7B           TDC 
02/90B9: E2 20        SEP #$20
02/90BB: A9 0A        LDA #$0A
02/90BD: 20 75 86     JSR $8675       ; transfer data to vram
02/90C0: FA           PLX 
02/90C1: 60           RTS 

; [  ]

02/90C2: 7B           TDC 
02/90C3: AA           TAX 
02/90C4: BF D0 87 0D  LDA $0D87D0,X
02/90C8: 9D 50 ED     STA $ED50,X
02/90CB: BF 00 CB 0E  LDA $0ECB00,X
02/90CF: 9D 50 EE     STA $EE50,X
02/90D2: E8           INX 
02/90D3: E0 20 00     CPX #$0020
02/90D6: D0 EC        BNE $90C4
02/90D8: AE AA 16     LDX $16AA
02/90DB: 8E 52 ED     STX $ED52
02/90DE: 8E 5A ED     STX $ED5A
02/90E1: 8E 62 ED     STX $ED62
02/90E4: 8E 6A ED     STX $ED6A
02/90E7: A9 02        LDA #$02
02/90E9: A2 0E 00     LDX #$000E
02/90EC: 20 79 91     JSR $9179
02/90EF: A9 03        LDA #$03
02/90F1: A2 06 00     LDX #$0006
02/90F4: 20 79 91     JSR $9179
02/90F7: 22 6E F7 03  JSL $03F76E     ; load battle bg palette
02/90FB: A9 00        LDA #$00
02/90FD: 20 32 91     JSR $9132
02/9100: A2 09 00     LDX #$0009
02/9103: 20 A9 91     JSR $91A9
02/9106: A9 01        LDA #$01
02/9108: 20 32 91     JSR $9132
02/910B: A2 0A 00     LDX #$000A
02/910E: 20 A9 91     JSR $91A9
02/9111: A9 02        LDA #$02
02/9113: 20 32 91     JSR $9132
02/9116: A2 0B 00     LDX #$000B
02/9119: 20 A9 91     JSR $91A9
02/911C: A9 03        LDA #$03
02/911E: 20 32 91     JSR $9132
02/9121: A2 0C 00     LDX #$000C
02/9124: 20 A9 91     JSR $91A9
02/9127: A9 04        LDA #$04
02/9129: 20 32 91     JSR $9132
02/912C: A2 0D 00     LDX #$000D
02/912F: 4C A9 91     JMP $91A9

; [  ]

02/9132: 22 F5 F6 03  JSL $03F6F5
02/9136: 60           RTS 

; [ load menu graphics (bg3) ]

02/9137: A2 00 10     LDX #$1000
02/913A: 86 00        STX $00
02/913C: A9 0A        LDA #$0A
02/913E: A2 00 F0     LDX #$F000
02/9141: A0 00 50     LDY #$5000
02/9144: 20 75 86     JSR $8675       ; transfer data to vram
02/9147: A2 00 50     LDX #$5000
02/914A: A0 10 00     LDY #$0010
02/914D: 4C E1 83     JMP $83E1       ; clear vram ($5000-$5007)
02/9150: 85 26        STA $26
02/9152: A9 10        LDA #$10
02/9154: 85 28        STA $28
02/9156: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9159: C2 20        REP #$20
02/915B: 8A           TXA 
02/915C: 0A           ASL 
02/915D: 0A           ASL 
02/915E: 0A           ASL 
02/915F: 0A           ASL 
02/9160: 0A           ASL 
02/9161: A8           TAY 
02/9162: 7B           TDC 
02/9163: E2 20        SEP #$20
02/9165: A9 20        LDA #$20
02/9167: 85 00        STA $00
02/9169: A6 2A        LDX $2A
02/916B: BF 00 EE 1C  LDA $1CEE00,X
02/916F: 99 50 ED     STA $ED50,Y
02/9172: E8           INX 
02/9173: C8           INY 
02/9174: C6 00        DEC $00
02/9176: D0 F3        BNE $916B
02/9178: 60           RTS 

; [  ]

02/9179: 85 26        STA $26
02/917B: A9 10        LDA #$10
02/917D: 85 28        STA $28
02/917F: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9182: C2 20        REP #$20
02/9184: 8A           TXA 
02/9185: 0A           ASL 
02/9186: 0A           ASL 
02/9187: 0A           ASL 
02/9188: 0A           ASL 
02/9189: 0A           ASL 
02/918A: A8           TAY 
02/918B: 7B           TDC 
02/918C: E2 20        SEP #$20
02/918E: A9 10        LDA #$10
02/9190: 85 00        STA $00
02/9192: A6 2A        LDX $2A
02/9194: BF 00 CB 0E  LDA $0ECB00,X
02/9198: 99 50 ED     STA $ED50,Y
02/919B: 99 60 ED     STA $ED60,Y
02/919E: E8           INX 
02/919F: C8           INY 
02/91A0: C6 00        DEC $00
02/91A2: D0 F0        BNE $9194
02/91A4: 60           RTS 

; [  ]

02/91A5: 20 A9 91     JSR $91A9
02/91A8: 6B           RTL 

; [  ]

02/91A9: 85 26        STA $26
02/91AB: A9 20        LDA #$20
02/91AD: 85 28        STA $28
02/91AF: 20 60 85     JSR $8560       ; multiply (8-bit)
02/91B2: C2 20        REP #$20
02/91B4: 8A           TXA 
02/91B5: 0A           ASL 
02/91B6: 0A           ASL 
02/91B7: 0A           ASL 
02/91B8: 0A           ASL 
02/91B9: 0A           ASL 
02/91BA: A8           TAY 
02/91BB: 7B           TDC 
02/91BC: E2 20        SEP #$20
02/91BE: A6 2A        LDX $2A
02/91C0: A9 20        LDA #$20
02/91C2: 85 00        STA $00
02/91C4: BF 00 FD 1C  LDA $1CFD00,X
02/91C8: 99 50 ED     STA $ED50,Y
02/91CB: E8           INX 
02/91CC: C8           INY 
02/91CD: C6 00        DEC $00
02/91CF: D0 F3        BNE $91C4
02/91D1: 60           RTS 

; [ load battle bg graphics ]

02/91D2: AD 02 18     LDA $1802       ; battle bg id
02/91D5: 29 1F        AND #$1F
02/91D7: 0A           ASL 
02/91D8: AA           TAX 
02/91D9: C2 20        REP #$20
02/91DB: A9 28 00     LDA #$0028
02/91DE: 85 00        STA $00
02/91E0: BF B4 FD 16  LDA $16FDB4,X
02/91E4: AA           TAX 
02/91E5: 7B           TDC 
02/91E6: E2 20        SEP #$20
02/91E8: A9 1C        LDA #$1C
02/91EA: A0 10 40     LDY #$4010
02/91ED: 20 0F 86     JSR $860F       ; transfer 3bpp graphics to vram
02/91F0: 22 BD E8 01  JSL $01E8BD     ; load battle bg tilemap
02/91F4: A2 80 04     LDX #$0480      ; 18 rows
02/91F7: 86 00        STX $00
02/91F9: A9 7E        LDA #$7E
02/91FB: A2 FD 6C     LDX #$6CFD
02/91FE: A0 00 58     LDY #$5800
02/9201: 20 75 86     JSR $8675       ; transfer data to vram
02/9204: AD C0 6C     LDA $6CC0
02/9207: 48           PHA 
02/9208: A9 FF        LDA #$FF
02/920A: 8D C0 6C     STA $6CC0
02/920D: 22 D4 E9 01  JSL $01E9D4     ; h-flip tilemap
02/9211: 68           PLA 
02/9212: 8D C0 6C     STA $6CC0
02/9215: A2 80 04     LDX #$0480
02/9218: 86 00        STX $00
02/921A: A9 7E        LDA #$7E
02/921C: A2 FD 6C     LDX #$6CFD
02/921F: A0 00 5C     LDY #$5C00
02/9222: 4C 75 86     JMP $8675       ; transfer data to vram

; [  ]

02/9225: AD 5C F3     LDA $F35C
02/9228: F0 13        BEQ $923D
02/922A: 9C 5C F3     STZ $F35C
02/922D: A2 20 00     LDX #$0020
02/9230: 86 0E        STX $0E
02/9232: AE 60 F3     LDX $F360
02/9235: AC 62 F3     LDY $F362
02/9238: A9 7E        LDA #$7E
02/923A: 20 9A 86     JSR $869A       ; transfer data to vram
02/923D: AD 5D F3     LDA $F35D
02/9240: F0 13        BEQ $9255
02/9242: 9C 5D F3     STZ $F35D
02/9245: A2 20 00     LDX #$0020
02/9248: 86 0E        STX $0E
02/924A: AE 64 F3     LDX $F364
02/924D: AC 66 F3     LDY $F366
02/9250: A9 7E        LDA #$7E
02/9252: 20 9A 86     JSR $869A       ; transfer data to vram
02/9255: AD 5E F3     LDA $F35E
02/9258: F0 13        BEQ $926D
02/925A: 9C 5E F3     STZ $F35E
02/925D: A2 20 00     LDX #$0020
02/9260: 86 0E        STX $0E
02/9262: AE 68 F3     LDX $F368
02/9265: AC 6A F3     LDY $F36A
02/9268: A9 7E        LDA #$7E
02/926A: 20 9A 86     JSR $869A       ; transfer data to vram
02/926D: AD 5F F3     LDA $F35F
02/9270: F0 13        BEQ $9285
02/9272: 9C 5F F3     STZ $F35F
02/9275: A2 20 00     LDX #$0020
02/9278: 86 0E        STX $0E
02/927A: AE 6C F3     LDX $F36C
02/927D: AC 6E F3     LDY $F36E
02/9280: A9 7E        LDA #$7E
02/9282: 20 9A 86     JSR $869A       ; transfer data to vram
02/9285: 60           RTS 

; [  ]

02/9286: AD 5C F3     LDA $F35C
02/9289: 0D 5D F3     ORA $F35D
02/928C: 0D 5E F3     ORA $F35E
02/928F: 0D 5F F3     ORA $F35F
02/9292: F0 03        BEQ $9297
02/9294: 4C 25 92     JMP $9225
02/9297: AD A8 EF     LDA $EFA8
02/929A: F0 14        BEQ $92B0
02/929C: 9C A8 EF     STZ $EFA8
02/929F: AE AD EF     LDX $EFAD
02/92A2: 86 0E        STX $0E
02/92A4: AE A9 EF     LDX $EFA9
02/92A7: AC AB EF     LDY $EFAB
02/92AA: AD AF EF     LDA $EFAF
02/92AD: 20 9A 86     JSR $869A       ; transfer data to vram
02/92B0: AD B1 EF     LDA $EFB1
02/92B3: F0 14        BEQ $92C9
02/92B5: 9C B1 EF     STZ $EFB1
02/92B8: AE B6 EF     LDX $EFB6
02/92BB: 86 0E        STX $0E
02/92BD: AE B2 EF     LDX $EFB2
02/92C0: AC B4 EF     LDY $EFB4
02/92C3: AD B8 EF     LDA $EFB8
02/92C6: 20 9A 86     JSR $869A       ; transfer data to vram
02/92C9: 60           RTS 

; --------------------------------------------------------------------------

; [ clear message window tilemap ]

02/92CA: 7B           TDC 
02/92CB: AA           TAX 
02/92CC: 9D E6 DA     STA $DAE6,X
02/92CF: E8           INX 
02/92D0: E0 00 01     CPX #$0100
02/92D3: D0 F7        BNE $92CC
02/92D5: 60           RTS 

; [ draw message window (full) ]

02/92D6: 20 CA 92     JSR $92CA       ; clear message window tilemap
02/92D9: A2 E6 DA     LDX #$DAE6
02/92DC: 8E 5A EF     STX $EF5A
02/92DF: A2 03 00     LDX #$0003      ; (3,0)
02/92E2: 8E 56 EF     STX $EF56
02/92E5: A2 1A 04     LDX #$041A      ; 26x4
02/92E8: 8E 58 EF     STX $EF58
02/92EB: 20 B5 9B     JSR $9BB5       ; draw window
02/92EE: A9 20        LDA #$20
02/92F0: 8D 55 EF     STA $EF55
02/92F3: A9 20        LDA #$20
02/92F5: 8D 54 EF     STA $EF54
02/92F8: A2 2E DB     LDX #$DB2E
02/92FB: 8E 52 EF     STX $EF52
02/92FE: 20 55 A4     JSR $A455       ; draw text
02/9301: 4C 8E 93     JMP $938E       ; open message window

; [ draw message window (left) ]

; used for back attack

02/9304: 20 CA 92     JSR $92CA       ; clear message window tilemap
02/9307: A2 E6 DA     LDX #$DAE6
02/930A: 8E 5A EF     STX $EF5A
02/930D: A2 02 00     LDX #$0002      ; (2,0)
02/9310: 8E 56 EF     STX $EF56
02/9313: A2 0A 04     LDX #$040A      ; 10x4
02/9316: 8E 58 EF     STX $EF58
02/9319: 20 B5 9B     JSR $9BB5       ; draw window
02/931C: A9 20        LDA #$20
02/931E: 8D 55 EF     STA $EF55
02/9321: A9 20        LDA #$20
02/9323: 8D 54 EF     STA $EF54
02/9326: A2 2C DB     LDX #$DB2C
02/9329: 8E 52 EF     STX $EF52
02/932C: 20 55 A4     JSR $A455       ; draw text
02/932F: 4C 8E 93     JMP $938E       ; open message window

; [ draw message window (center) ]

; unused

02/9332: 20 CA 92     JSR $92CA       ; clear message window tilemap
02/9335: A2 E6 DA     LDX #$DAE6
02/9338: 8E 5A EF     STX $EF5A
02/933B: A2 0B 00     LDX #$000B      ; (11,0)
02/933E: 8E 56 EF     STX $EF56
02/9341: A2 0A 04     LDX #$040A      ; 10x4
02/9344: 8E 58 EF     STX $EF58
02/9347: 20 B5 9B     JSR $9BB5       ; draw window
02/934A: A9 20        LDA #$20
02/934C: 8D 55 EF     STA $EF55
02/934F: A9 20        LDA #$20
02/9351: 8D 54 EF     STA $EF54
02/9354: A2 3E DB     LDX #$DB3E
02/9357: 8E 52 EF     STX $EF52
02/935A: 20 55 A4     JSR $A455       ; draw text
02/935D: 4C 8E 93     JMP $938E       ; open message window

; [ draw message window (right) ]

02/9360: 20 CA 92     JSR $92CA       ; clear message window tilemap
02/9363: A2 E6 DA     LDX #$DAE6
02/9366: 8E 5A EF     STX $EF5A
02/9369: A2 14 00     LDX #$0014      ; (20,0)
02/936C: 8E 56 EF     STX $EF56
02/936F: A2 0A 04     LDX #$040A      ; 10x4
02/9372: 8E 58 EF     STX $EF58
02/9375: 20 B5 9B     JSR $9BB5       ; draw window
02/9378: A9 20        LDA #$20
02/937A: 8D 55 EF     STA $EF55
02/937D: A9 20        LDA #$20
02/937F: 8D 54 EF     STA $EF54
02/9382: A2 50 DB     LDX #$DB50
02/9385: 8E 52 EF     STX $EF52
02/9388: 20 55 A4     JSR $A455       ; draw text
02/938B: 4C 8E 93     JMP $938E       ; open message window

; [ open message window ]

02/938E: A2 E6 DA     LDX #$DAE6      ; message window tilemap buffer
02/9391: 8E 9E EF     STX $EF9E
02/9394: A2 E0 78     LDX #$78E0      ; message window tilemap (vram)
02/9397: 8E A0 EF     STX $EFA0
02/939A: A9 04        LDA #$04
02/939C: 8D 9D EF     STA $EF9D
02/939F: 9C 9C EF     STZ $EF9C
02/93A2: A9 01        LDA #$01
02/93A4: 8D 9B EF     STA $EF9B
02/93A7: 60           RTS 

; [ close message window ]

02/93A8: 20 CA 92     JSR $92CA       ; clear message window tilemap
02/93AB: A2 A6 DB     LDX #$DBA6
02/93AE: 8E 9E EF     STX $EF9E
02/93B1: A2 40 79     LDX #$7940
02/93B4: 8E A0 EF     STX $EFA0
02/93B7: A9 04        LDA #$04
02/93B9: 8D 9D EF     STA $EF9D
02/93BC: A9 01        LDA #$01
02/93BE: 8D 9C EF     STA $EF9C
02/93C1: 8D 9B EF     STA $EF9B
02/93C4: 60           RTS 

; [ transfer message window tilemap to vram ]

02/93C5: AD 9B EF     LDA $EF9B
02/93C8: F0 4F        BEQ $9419
02/93CA: A2 40 00     LDX #$0040
02/93CD: 86 0E        STX $0E
02/93CF: AE 9E EF     LDX $EF9E
02/93D2: AC A0 EF     LDY $EFA0
02/93D5: A9 7E        LDA #$7E
02/93D7: 20 9A 86     JSR $869A       ; transfer data to vram
02/93DA: CE 9D EF     DEC $EF9D
02/93DD: F0 37        BEQ $9416
02/93DF: AD 9C EF     LDA $EF9C
02/93E2: D0 18        BNE $93FC
02/93E4: C2 20        REP #$20
02/93E6: AD 9E EF     LDA $EF9E
02/93E9: 18           CLC 
02/93EA: 69 40 00     ADC #$0040
02/93ED: 8D 9E EF     STA $EF9E
02/93F0: AD A0 EF     LDA $EFA0
02/93F3: 18           CLC 
02/93F4: 69 20 00     ADC #$0020
02/93F7: 8D A0 EF     STA $EFA0
02/93FA: 80 16        BRA $9412
02/93FC: C2 20        REP #$20
02/93FE: AD 9E EF     LDA $EF9E
02/9401: 38           SEC 
02/9402: E9 40 00     SBC #$0040
02/9405: 8D 9E EF     STA $EF9E
02/9408: AD A0 EF     LDA $EFA0
02/940B: 38           SEC 
02/940C: E9 20 00     SBC #$0020
02/940F: 8D A0 EF     STA $EFA0
02/9412: 7B           TDC 
02/9413: E2 20        SEP #$20
02/9415: 60           RTS 
02/9416: 9C 9B EF     STZ $EF9B
02/9419: 60           RTS 

; [ transfer mp cost tilemap to vram ]

02/941A: AD 38 18     LDA $1838
02/941D: F0 13        BEQ $9432       ; branch if update is disabled
02/941F: A2 06 00     LDX #$0006      ; 3 tiles
02/9422: 86 0E        STX $0E
02/9424: A9 00        LDA #$00
02/9426: A2 39 18     LDX #$1839
02/9429: A0 39 5F     LDY #$5F39
02/942C: 20 9A 86     JSR $869A       ; transfer data to vram
02/942F: 9C 38 18     STZ $1838       ; disable update
02/9432: 60           RTS 

; [ transfer menu tilemap to vram (update) ]

02/9433: AD 24 18     LDA $1824
02/9436: F0 29        BEQ $9461       ; branch if no menu tilemap vram transfer needed
02/9438: AD 25 18     LDA $1825       ; number of transfers
02/943B: AA           TAX 
02/943C: BF 67 94 02  LDA $029467,X
02/9440: AA           TAX 
02/9441: C2 20        REP #$20
02/9443: BD 24 18     LDA $1824,X     ; source address
02/9446: 48           PHA 
02/9447: BD 26 18     LDA $1826,X     ; destination address (vram)
02/944A: A8           TAY 
02/944B: BD 28 18     LDA $1828,X     ; transfer size
02/944E: 85 0E        STA $0E
02/9450: 7B           TDC 
02/9451: E2 20        SEP #$20
02/9453: FA           PLX 
02/9454: A9 7E        LDA #$7E
02/9456: 20 9A 86     JSR $869A       ; transfer data to vram
02/9459: CE 25 18     DEC $1825
02/945C: D0 03        BNE $9461
02/945E: 9C 24 18     STZ $1824       ; disable menu tilemap vram
02/9461: 20 1A 94     JSR $941A       ; transfer mp cost tilemap to vram
02/9464: 4C C5 93     JMP $93C5       ; transfer menu window tilemap to vram

; pointers to menu tilemap vram transfer data
02/9467: 00 02 08 0E

; [ do menu text update ]

02/946B: 20 72 94     JSR $9472       ; do menu text update
02/946E: 9C 21 18     STZ $1821
02/9471: 60           RTS 

; [ do menu text update ]

02/9472: AD 21 18     LDA $1821
02/9475: 0A           ASL 
02/9476: AA           TAX 
02/9477: BF 86 94 02  LDA $029486,X
02/947B: 85 00        STA $00
02/947D: BF 87 94 02  LDA $029487,X
02/9481: 85 01        STA $01
02/9483: 6C 00 00     JMP ($0000)

; menu text update jump table
02/9486: 949A A20C 9FA4 A08E A12C A39E A1D7 9CD0
02/9496: 9631 94B4

02/949A: 60           RTS 

; [  ]

02/949B: B9 1B 32     LDA $321B,Y
02/949E: C9 61        CMP #$61
02/94A0: 90 02        BCC $94A4
02/94A2: 80 0A        BRA $94AE
02/94A4: C9 54        CMP #$54
02/94A6: 90 06        BCC $94AE
02/94A8: A9 14        LDA #$14
02/94AA: 85 04        STA $04
02/94AC: 38           SEC 
02/94AD: 60           RTS 
02/94AE: A9 01        LDA #$01
02/94B0: 85 04        STA $04
02/94B2: 18           CLC 
02/94B3: 60           RTS 

; [ copy equipped items to character properties ]

02/94B4: 20 ED 94     JSR $94ED
02/94B7: 7B           TDC 
02/94B8: AA           TAX 
02/94B9: A8           TAY 
02/94BA: C2 20        REP #$20
02/94BC: BD DB 32     LDA $32DB,X     ; equipped item id
02/94BF: 99 33 20     STA $2033,Y     ; copy to character properties
02/94C2: 29 00 FF     AND #$FF00
02/94C5: D0 03        BNE $94CA       ; branch if quantity is nonzero
02/94C7: 99 33 20     STA $2033,Y
02/94CA: BD DF 32     LDA $32DF,X
02/94CD: 99 35 20     STA $2035,Y
02/94D0: 29 00 FF     AND #$FF00
02/94D3: D0 03        BNE $94D8
02/94D5: 99 35 20     STA $2035,Y
02/94D8: 8A           TXA 
02/94D9: 18           CLC 
02/94DA: 69 08 00     ADC #$0008
02/94DD: AA           TAX 
02/94DE: 98           TYA 
02/94DF: 18           CLC 
02/94E0: 69 80 00     ADC #$0080
02/94E3: A8           TAY 
02/94E4: C0 80 02     CPY #$0280
02/94E7: D0 D3        BNE $94BC
02/94E9: 7B           TDC 
02/94EA: E2 20        SEP #$20
02/94EC: 60           RTS 

; [  ]

02/94ED: AD 1A 18     LDA $181A
02/94F0: 0A           ASL 
02/94F1: 0A           ASL 
02/94F2: 85 00        STA $00
02/94F4: AD 19 18     LDA $1819
02/94F7: 0A           ASL 
02/94F8: 0A           ASL 
02/94F9: 0A           ASL 
02/94FA: 18           CLC 
02/94FB: 65 00        ADC $00
02/94FD: AA           TAX 
02/94FE: AD 1B 18     LDA $181B
02/9501: 0A           ASL 
02/9502: 0A           ASL 
02/9503: A8           TAY 
02/9504: AD 1C 18     LDA $181C
02/9507: F0 37        BEQ $9540
02/9509: C9 01        CMP #$01
02/950B: F0 36        BEQ $9543
02/950D: C9 02        CMP #$02
02/950F: F0 72        BEQ $9583
02/9511: C9 03        CMP #$03
02/9513: F0 31        BEQ $9546
02/9515: C9 04        CMP #$04
02/9517: F0 01        BEQ $951A
02/9519: 60           RTS 
02/951A: 20 9B 94     JSR $949B
02/951D: B9 1C 32     LDA $321C,Y
02/9520: 38           SEC 
02/9521: E5 04        SBC $04
02/9523: 99 1C 32     STA $321C,Y
02/9526: B9 1A 32     LDA $321A,Y
02/9529: 9D DA 32     STA $32DA,X
02/952C: B9 1B 32     LDA $321B,Y
02/952F: 9D DB 32     STA $32DB,X
02/9532: A5 04        LDA $04
02/9534: 9D DC 32     STA $32DC,X
02/9537: B9 1D 32     LDA $321D,Y
02/953A: 9D DD 32     STA $32DD,X
02/953D: 4C 16 96     JMP $9616
02/9540: 4C FE 95     JMP $95FE
02/9543: 4C E0 95     JMP $95E0
02/9546: B9 1C 32     LDA $321C,Y
02/9549: 85 01        STA $01
02/954B: A9 14        LDA #$14
02/954D: 38           SEC 
02/954E: FD DC 32     SBC $32DC,X
02/9551: 85 00        STA $00
02/9553: C5 01        CMP $01
02/9555: 90 18        BCC $956F
02/9557: A5 01        LDA $01
02/9559: 18           CLC 
02/955A: 7D DC 32     ADC $32DC,X
02/955D: 9D DC 32     STA $32DC,X
02/9560: A9 80        LDA #$80
02/9562: 99 1A 32     STA $321A,Y
02/9565: 7B           TDC 
02/9566: 99 1B 32     STA $321B,Y
02/9569: 99 1C 32     STA $321C,Y
02/956C: 4C 16 96     JMP $9616
02/956F: BD DC 32     LDA $32DC,X
02/9572: 18           CLC 
02/9573: 65 00        ADC $00
02/9575: 9D DC 32     STA $32DC,X
02/9578: A5 01        LDA $01
02/957A: 38           SEC 
02/957B: E5 00        SBC $00
02/957D: 99 1C 32     STA $321C,Y
02/9580: 4C 16 96     JMP $9616
02/9583: BD DA 32     LDA $32DA,X
02/9586: 85 00        STA $00
02/9588: BD DB 32     LDA $32DB,X
02/958B: 85 01        STA $01
02/958D: BD DC 32     LDA $32DC,X
02/9590: 85 02        STA $02
02/9592: BD DD 32     LDA $32DD,X
02/9595: 85 03        STA $03
02/9597: 20 9B 94     JSR $949B
02/959A: B9 1C 32     LDA $321C,Y
02/959D: 38           SEC 
02/959E: E5 04        SBC $04
02/95A0: 99 1C 32     STA $321C,Y
02/95A3: B9 1A 32     LDA $321A,Y
02/95A6: 9D DA 32     STA $32DA,X
02/95A9: B9 1B 32     LDA $321B,Y
02/95AC: 9D DB 32     STA $32DB,X
02/95AF: A5 04        LDA $04
02/95B1: 9D DC 32     STA $32DC,X
02/95B4: B9 1D 32     LDA $321D,Y
02/95B7: 9D DD 32     STA $32DD,X
02/95BA: AD 1D 18     LDA $181D
02/95BD: 0A           ASL 
02/95BE: 0A           ASL 
02/95BF: A8           TAY 
02/95C0: A5 00        LDA $00
02/95C2: 99 1A 32     STA $321A,Y
02/95C5: A5 01        LDA $01
02/95C7: 99 1B 32     STA $321B,Y
02/95CA: A5 02        LDA $02
02/95CC: 99 1C 32     STA $321C,Y
02/95CF: A5 03        LDA $03
02/95D1: 99 1D 32     STA $321D,Y
02/95D4: AD 1D 18     LDA $181D
02/95D7: 8D 17 18     STA $1817
02/95DA: 20 A4 9F     JSR $9FA4       ; draw inventory item text
02/95DD: 4C 16 96     JMP $9616
02/95E0: B9 1C 32     LDA $321C,Y
02/95E3: 18           CLC 
02/95E4: 7D DC 32     ADC $32DC,X
02/95E7: C9 64        CMP #$64
02/95E9: 90 02        BCC $95ED
02/95EB: A9 63        LDA #$63
02/95ED: 99 1C 32     STA $321C,Y
02/95F0: A9 80        LDA #$80
02/95F2: 9D DA 32     STA $32DA,X
02/95F5: 9E DB 32     STZ $32DB,X
02/95F8: 9E DC 32     STZ $32DC,X
02/95FB: 4C 16 96     JMP $9616
02/95FE: A9 04        LDA #$04
02/9600: 85 00        STA $00
02/9602: BD DA 32     LDA $32DA,X
02/9605: 48           PHA 
02/9606: B9 1A 32     LDA $321A,Y
02/9609: 9D DA 32     STA $32DA,X
02/960C: 68           PLA 
02/960D: 99 1A 32     STA $321A,Y
02/9610: E8           INX 
02/9611: C8           INY 
02/9612: C6 00        DEC $00
02/9614: D0 EC        BNE $9602
02/9616: AD 19 18     LDA $1819
02/9619: 8D 16 18     STA $1816
02/961C: AE 1A 18     LDX $181A
02/961F: 8E 17 18     STX $1817
02/9622: AD 17 18     LDA $1817
02/9625: 20 CD 9D     JSR $9DCD       ; draw equipped item text
02/9628: AD 18 18     LDA $1818
02/962B: 8D 17 18     STA $1817
02/962E: 4C A4 9F     JMP $9FA4       ; draw inventory item text

; [ swap inventory slots ]

02/9631: AD 1A 18     LDA $181A
02/9634: 0A           ASL 
02/9635: 0A           ASL 
02/9636: AA           TAX 
02/9637: AD 1B 18     LDA $181B
02/963A: 0A           ASL 
02/963B: 0A           ASL 
02/963C: A8           TAY 
02/963D: A9 04        LDA #$04
02/963F: 85 00        STA $00
02/9641: BD 1A 32     LDA $321A,X     ; swap inventory slots
02/9644: 48           PHA 
02/9645: B9 1A 32     LDA $321A,Y
02/9648: 9D 1A 32     STA $321A,X
02/964B: 68           PLA 
02/964C: 99 1A 32     STA $321A,Y
02/964F: E8           INX 
02/9650: C8           INY 
02/9651: C6 00        DEC $00
02/9653: D0 EC        BNE $9641
02/9655: AD 19 18     LDA $1819
02/9658: 8D 16 18     STA $1816
02/965B: AE 1A 18     LDX $181A
02/965E: 8E 17 18     STX $1817
02/9661: 20 A4 9F     JSR $9FA4       ; draw inventory item text
02/9664: AD 18 18     LDA $1818
02/9667: 8D 17 18     STA $1817
02/966A: 4C A4 9F     JMP $9FA4       ; draw inventory item text

; [ do forced menu vram update ]

02/966D: AD 24 18     LDA $1824
02/9670: D0 0F        BNE $9681       ; branch if menu tilemap vram transfer is pending
02/9672: 20 6B 94     JSR $946B       ; do menu text update
02/9675: 20 82 96     JSR $9682       ; transfer menu tilemap to vram
02/9678: AD 1F 18     LDA $181F
02/967B: 8D 1E 18     STA $181E
02/967E: 9C 1F 18     STZ $181F
02/9681: 60           RTS 

; [ transfer menu tilemap to vram ]

02/9682: AD 1E 18     LDA $181E
02/9685: 0A           ASL 
02/9686: AA           TAX 
02/9687: BF 96 96 02  LDA $029696,X
02/968B: 85 00        STA $00
02/968D: BF 97 96 02  LDA $029697,X
02/9691: 85 01        STA $01
02/9693: 6C 00 00     JMP ($0000)

; forced menu update jump table
02/9696: 9757 9757 99CA 9983 9839 9834 982F 98FA
02/96A6: 9764 97A6 97A5 97A5 99B6

; periodic menu vram update jump table
02/96B0: 99CA 9983 9764 97A6 96D4 99B6 99CA A20C

; periodic menu text update jump table
02/96C0: A20C 99E1 99A5 99B9

; [  ]

02/96C8: 20 A1 A2     JSR $A2A1       ; draw status text
02/96CB: 20 89 99     JSR $9989       ; draw battle command window
02/96CE: 20 D3 99     JSR $99D3       ; draw monster and character names
02/96D1: 4C DC 99     JMP $99DC       ; draw character hp

; [ transfer inventory/spell list tilemap to vram ]

02/96D4: A5 4A        LDA $4A
02/96D6: 29 7C        AND #$7C
02/96D8: F0 1E        BEQ $96F8
02/96DA: C9 40        CMP #$40
02/96DC: D0 03        BNE $96E1
02/96DE: 4C 2F 98     JMP $982F       ; white magic
02/96E1: C9 20        CMP #$20
02/96E3: D0 03        BNE $96E8
02/96E5: 4C 34 98     JMP $9834       ; black magic/ninjutsu
02/96E8: C9 10        CMP #$10
02/96EA: D0 03        BNE $96EF
02/96EC: 4C 39 98     JMP $9839       ; summon
02/96EF: A5 4A        LDA $4A
02/96F1: 29 04        AND #$04
02/96F3: F0 03        BEQ $96F8
02/96F5: 4C FA 98     JMP $98FA       ; inventory
02/96F8: 60           RTS 

; unused
02/96F9: 60           RTS 

; [ do periodic menu vram update ]

02/96FA: AD 24 18     LDA $1824
02/96FD: D0 19        BNE $9718       ; branch if menu tilemap vram transfer is pending
02/96FF: EE 45 18     INC $1845       ; increment periodic menu update counter
02/9702: AD 45 18     LDA $1845
02/9705: 29 07        AND #$07
02/9707: 0A           ASL 
02/9708: AA           TAX 
02/9709: BF B0 96 02  LDA $0296B0,X
02/970D: 85 00        STA $00
02/970F: BF B1 96 02  LDA $0296B1,X
02/9713: 85 01        STA $01
02/9715: 6C 00 00     JMP ($0000)
02/9718: 60           RTS 

; [ do periodic menu text update ]

02/9719: AD 24 18     LDA $1824
02/971C: D0 19        BNE $9737       ; branch if menu tilemap vram transfer is pending
02/971E: EE 4D F4     INC $F44D
02/9721: AD 4D F4     LDA $F44D
02/9724: 29 03        AND #$03
02/9726: 0A           ASL 
02/9727: AA           TAX 
02/9728: BF C0 96 02  LDA $0296C0,X
02/972C: 85 00        STA $00
02/972E: BF C1 96 02  LDA $0296C1,X
02/9732: 85 01        STA $01
02/9734: 6C 00 00     JMP ($0000)
02/9737: 60           RTS 

; [ load menu tilemap vram transfer data ]

; Y is either 2, 8, or 14

02/9738: 5A           PHY 
02/9739: 85 26        STA $26
02/973B: A9 06        LDA #$06
02/973D: 85 28        STA $28
02/973F: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9742: A6 2A        LDX $2A
02/9744: 7A           PLY 
02/9745: A9 06        LDA #$06
02/9747: 85 00        STA $00
02/9749: BF 0C FE 16  LDA $16FE0C,X
02/974D: 99 24 18     STA $1824,Y
02/9750: C8           INY 
02/9751: E8           INX 
02/9752: C6 00        DEC $00
02/9754: D0 F3        BNE $9749
02/9756: 60           RTS 

02/9757: 60           RTS 

; pointers to character mp text buffers
02/9758: 00 1C 38 54 70

; 
02/975D: DE DF E0 E1 FF E2 E3

; [ transfer mp cost tilemap to vram ]

02/9764: AD 22 18     LDA $1822       ; selected character
02/9767: AA           TAX 
02/9768: BF 58 97 02  LDA $029758,X
02/976C: AA           TAX 
02/976D: 7B           TDC 
02/976E: A8           TAY 
02/976F: BD 92 BA     LDA $BA92,X     ; copy from text buffer to tilemap
02/9772: 99 D4 D3     STA $D3D4,Y
02/9775: BD A0 BA     LDA $BAA0,X
02/9778: 99 14 D4     STA $D414,Y
02/977B: C8           INY 
02/977C: E8           INX 
02/977D: C0 0E 00     CPY #$000E
02/9780: D0 ED        BNE $976F
02/9782: 7B           TDC 
02/9783: AA           TAX 
02/9784: A8           TAY 
02/9785: BF 5D 97 02  LDA $02975D,X   ; 
02/9789: 99 94 D4     STA $D494,Y
02/978C: C8           INY 
02/978D: C8           INY 
02/978E: E8           INX 
02/978F: E0 07 00     CPX #$0007
02/9792: D0 F1        BNE $9785
02/9794: A9 06        LDA #$06        ; mp cost window
02/9796: A0 02 00     LDY #$0002
02/9799: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/979C: A9 01        LDA #$01
02/979E: 8D 25 18     STA $1825       ; 1 transfer
02/97A1: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/97A4: 60           RTS 

02/97A5: 60           RTS 

; [ transfer equipped items tilemap to vram ]

02/97A6: A2 EC D1     LDX #$D1EC
02/97A9: 86 00        STX $00
02/97AB: A2 08 D2     LDX #$D208
02/97AE: 86 02        STX $02
02/97B0: AD 22 18     LDA $1822
02/97B3: 0A           ASL 
02/97B4: AA           TAX 
02/97B5: C2 20        REP #$20
02/97B7: BF C1 FE 16  LDA $16FEC1,X   ; pointers to equipped item text buffer
02/97BB: 48           PHA 
02/97BC: BF 25 FF 16  LDA $16FF25,X   ; pointers to right/left hand text buffer
02/97C0: AA           TAX 
02/97C1: 7B           TDC 
02/97C2: E2 20        SEP #$20
02/97C4: 7B           TDC 
02/97C5: A8           TAY 
02/97C6: BD 00 00     LDA $0000,X
02/97C9: 91 00        STA ($00),Y
02/97CB: BD 14 00     LDA $0014,X
02/97CE: 91 02        STA ($02),Y
02/97D0: E8           INX 
02/97D1: C8           INY 
02/97D2: C0 0A 00     CPY #$000A
02/97D5: D0 EF        BNE $97C6
02/97D7: A0 40 00     LDY #$0040
02/97DA: BD 00 00     LDA $0000,X
02/97DD: 91 00        STA ($00),Y
02/97DF: BD 14 00     LDA $0014,X
02/97E2: 91 02        STA ($02),Y
02/97E4: E8           INX 
02/97E5: C8           INY 
02/97E6: C0 4A 00     CPY #$004A
02/97E9: D0 EF        BNE $97DA
02/97EB: FA           PLX 
02/97EC: A0 80 00     LDY #$0080
02/97EF: BD 00 00     LDA $0000,X
02/97F2: 91 00        STA ($00),Y
02/97F4: BD 30 00     LDA $0030,X
02/97F7: 91 02        STA ($02),Y
02/97F9: E8           INX 
02/97FA: C8           INY 
02/97FB: C0 98 00     CPY #$0098
02/97FE: D0 EF        BNE $97EF
02/9800: A0 C0 00     LDY #$00C0
02/9803: BD 00 00     LDA $0000,X
02/9806: 91 00        STA ($00),Y
02/9808: BD 30 00     LDA $0030,X
02/980B: 91 02        STA ($02),Y
02/980D: E8           INX 
02/980E: C8           INY 
02/980F: C0 D8 00     CPY #$00D8
02/9812: D0 EF        BNE $9803
02/9814: A9 07        LDA #$07        ; equipped items window
02/9816: A0 02 00     LDY #$0002
02/9819: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/981C: A9 01        LDA #$01
02/981E: 8D 25 18     STA $1825       ; 1 transfer
02/9821: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/9824: 60           RTS 

02/9825: 0000 06C0 0D80 1440 1B00

; [ transfer spell list tilemap to vram ]

02/982F: A2 80 04     LDX #$0480      ; summon
02/9832: 80 08        BRA $983C
02/9834: A2 40 02     LDX #$0240      ; black magic/ninjutsu
02/9837: 80 03        BRA $983C
02/9839: A2 00 00     LDX #$0000      ; white magic
02/983C: DA           PHX 
02/983D: AD 22 18     LDA $1822
02/9840: 85 00        STA $00
02/9842: 20 AD 9E     JSR $9EAD       ; draw spell list
02/9845: FA           PLX 
02/9846: 86 06        STX $06
02/9848: A2 36 C5     LDX #$C536
02/984B: 86 00        STX $00
02/984D: A2 10 00     LDX #$0010
02/9850: 7B           TDC 
02/9851: A8           TAY 
02/9852: 3A           DEC 
02/9853: 91 00        STA ($00),Y
02/9855: C8           INY 
02/9856: C8           INY 
02/9857: C0 2A 00     CPY #$002A
02/985A: D0 F7        BNE $9853
02/985C: C2 20        REP #$20
02/985E: A5 00        LDA $00
02/9860: 18           CLC 
02/9861: 69 40 00     ADC #$0040
02/9864: 85 00        STA $00
02/9866: 7B           TDC 
02/9867: E2 20        SEP #$20
02/9869: CA           DEX 
02/986A: D0 E4        BNE $9850
02/986C: A2 2A C5     LDX #$C52A
02/986F: 86 00        STX $00
02/9871: A2 38 C5     LDX #$C538
02/9874: 86 02        STX $02
02/9876: A2 46 C5     LDX #$C546
02/9879: 86 04        STX $04
02/987B: AD 22 18     LDA $1822
02/987E: 0A           ASL 
02/987F: AA           TAX 
02/9880: C2 20        REP #$20
02/9882: BF 25 98 02  LDA $029825,X
02/9886: 18           CLC 
02/9887: 65 06        ADC $06
02/9889: AA           TAX 
02/988A: 7B           TDC 
02/988B: E2 20        SEP #$20
02/988D: A9 08        LDA #$08
02/988F: 85 06        STA $06
02/9891: 7B           TDC 
02/9892: A8           TAY 
02/9893: BD A6 97     LDA $97A6,X
02/9896: 91 00        STA ($00),Y
02/9898: BD BE 97     LDA $97BE,X
02/989B: 91 02        STA ($02),Y
02/989D: BD D6 97     LDA $97D6,X
02/98A0: 91 04        STA ($04),Y
02/98A2: C8           INY 
02/98A3: E8           INX 
02/98A4: C0 0C 00     CPY #$000C
02/98A7: D0 EA        BNE $9893
02/98A9: A0 40 00     LDY #$0040
02/98AC: BD A6 97     LDA $97A6,X
02/98AF: 91 00        STA ($00),Y
02/98B1: BD BE 97     LDA $97BE,X
02/98B4: 91 02        STA ($02),Y
02/98B6: BD D6 97     LDA $97D6,X
02/98B9: 91 04        STA ($04),Y
02/98BB: C8           INY 
02/98BC: E8           INX 
02/98BD: C0 4C 00     CPY #$004C
02/98C0: D0 EA        BNE $98AC
02/98C2: C2 20        REP #$20
02/98C4: 8A           TXA 
02/98C5: 18           CLC 
02/98C6: 69 30 00     ADC #$0030
02/98C9: AA           TAX 
02/98CA: A5 00        LDA $00
02/98CC: 18           CLC 
02/98CD: 69 80 00     ADC #$0080
02/98D0: 85 00        STA $00
02/98D2: A5 02        LDA $02
02/98D4: 18           CLC 
02/98D5: 69 80 00     ADC #$0080
02/98D8: 85 02        STA $02
02/98DA: A5 04        LDA $04
02/98DC: 18           CLC 
02/98DD: 69 80 00     ADC #$0080
02/98E0: 85 04        STA $04
02/98E2: 7B           TDC 
02/98E3: E2 20        SEP #$20
02/98E5: C6 06        DEC $06
02/98E7: D0 A8        BNE $9891
02/98E9: A9 02        LDA #$02        ; spell list
02/98EB: A0 02 00     LDY #$0002
02/98EE: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/98F1: A9 01        LDA #$01
02/98F3: 8D 25 18     STA $1825       ; 1 transfer
02/98F6: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/98F9: 60           RTS 

; [ transfer inventory tilemap to vram ]

02/98FA: 20 0E 9F     JSR $9F0E
02/98FD: A2 2A C5     LDX #$C52A      ; pointer to inventory tilemap buffer
02/9900: 86 00        STX $00
02/9902: A2 46 C5     LDX #$C546
02/9905: 86 02        STX $02
02/9907: 7B           TDC 
02/9908: AA           TAX 
02/9909: A9 18        LDA #$18        ; 24 rows
02/990B: 85 06        STA $06
; start of row loop
02/990D: 7B           TDC 
02/990E: A8           TAY 
02/990F: 3A           DEC 
02/9910: 91 00        STA ($00),Y
02/9912: 91 02        STA ($02),Y
02/9914: A0 40 00     LDY #$0040
02/9917: 91 00        STA ($00),Y
02/9919: 91 02        STA ($02),Y
02/991B: A0 02 00     LDY #$0002
02/991E: BD A6 8E     LDA $8EA6,X     ; inventory text buffer
02/9921: 91 00        STA ($00),Y
02/9923: BD D6 8E     LDA $8ED6,X
02/9926: 91 02        STA ($02),Y
02/9928: C8           INY 
02/9929: E8           INX 
02/992A: C0 1A 00     CPY #$001A
02/992D: D0 EF        BNE $991E
02/992F: A0 42 00     LDY #$0042
02/9932: BD A6 8E     LDA $8EA6,X     ; inventory text buffer
02/9935: 91 00        STA ($00),Y
02/9937: BD D6 8E     LDA $8ED6,X
02/993A: 91 02        STA ($02),Y
02/993C: C8           INY 
02/993D: E8           INX 
02/993E: C0 5A 00     CPY #$005A
02/9941: D0 EF        BNE $9932
02/9943: C2 20        REP #$20
02/9945: 8A           TXA 
02/9946: 18           CLC 
02/9947: 69 30 00     ADC #$0030
02/994A: AA           TAX 
02/994B: A5 00        LDA $00
02/994D: 18           CLC 
02/994E: 69 80 00     ADC #$0080
02/9951: 85 00        STA $00
02/9953: A5 02        LDA $02
02/9955: 18           CLC 
02/9956: 69 80 00     ADC #$0080
02/9959: 85 02        STA $02
02/995B: 7B           TDC 
02/995C: E2 20        SEP #$20
02/995E: C6 06        DEC $06
02/9960: D0 AB        BNE $990D
02/9962: A9 03        LDA #$03        ; inventory 1
02/9964: A0 02 00     LDY #$0002
02/9967: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/996A: A9 04        LDA #$04        ; inventory 2
02/996C: A0 08 00     LDY #$0008
02/996F: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/9972: A9 05        LDA #$05        ; inventory 3
02/9974: A0 0E 00     LDY #$000E
02/9977: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/997A: A9 03        LDA #$03
02/997C: 8D 25 18     STA $1825       ; 3 transfers
02/997F: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/9982: 60           RTS 

; [ draw battle command window ]

02/9983: 20 89 99     JSR $9989       ; draw battle command window
02/9986: 4C A5 99     JMP $99A5       ; transfer battle command window tilemap to vram

; [ draw battle command window ]

02/9989: A2 40 03     LDX #$0340
02/998C: BD 65 BE     LDA $BE65,X     ; copy main menu window tilemap
02/998F: 9D A5 C1     STA $C1A5,X
02/9992: CA           DEX 
02/9993: D0 F7        BNE $998C
02/9995: A9 02        LDA #$02
02/9997: 20 59 9B     JSR $9B59       ; load menu window data
02/999A: 20 C7 9B     JSR $9BC7       ; draw window
02/999D: A9 03        LDA #$03
02/999F: A2 64 00     LDX #$0064
02/99A2: 4C F1 99     JMP $99F1

; [ transfer battle command window tilemap to vram ]

02/99A5: A9 01        LDA #$01        ; battle command window
02/99A7: A0 02 00     LDY #$0002
02/99AA: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/99AD: A9 01        LDA #$01
02/99AF: 8D 25 18     STA $1825       ; 1 transfer
02/99B2: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/99B5: 60           RTS 

; [ transfer status tilemap to vram ]

02/99B6: 20 A1 A2     JSR $A2A1       ; draw status text
02/99B9: A0 02 00     LDY #$0002
02/99BC: A9 08        LDA #$08        ; status
02/99BE: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/99C1: A9 01        LDA #$01
02/99C3: 8D 25 18     STA $1825       ; 1 transfer
02/99C6: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/99C9: 60           RTS 

; [ draw main menu ]

02/99CA: 20 D3 99     JSR $99D3       ; draw monster and character names
02/99CD: 20 DC 99     JSR $99DC       ; draw character hp
02/99D0: 4C E1 99     JMP $99E1       ; transfer main menu tilemap to vram

; [ draw monster and character names ]

02/99D3: 7B           TDC             ; monster names
02/99D4: 20 05 9A     JSR $9A05
02/99D7: A9 01        LDA #$01        ; character names
02/99D9: 4C 05 9A     JMP $9A05

; [ draw character hp ]

02/99DC: A9 02        LDA #$02        ; character hp
02/99DE: 4C 05 9A     JMP $9A05

; [ transfer main menu tilemap to vram ]

02/99E1: 7B           TDC             ; main menu
02/99E2: A0 02 00     LDY #$0002
02/99E5: 20 38 97     JSR $9738       ; load menu tilemap vram transfer data
02/99E8: A9 01        LDA #$01
02/99EA: 8D 25 18     STA $1825       ; 1 transfer
02/99ED: 8D 24 18     STA $1824       ; enable menu tilemap vram transfer
02/99F0: 60           RTS 

; [  ]

02/99F1: 48           PHA 
02/99F2: AD 22 18     LDA $1822
02/99F5: 85 26        STA $26
02/99F7: 86 28        STX $28
02/99F9: 20 60 85     JSR $8560       ; multiply (8-bit)
02/99FC: A6 2A        LDX $2A
02/99FE: 8E 62 EF     STX $EF62
02/9A01: 68           PLA 
02/9A02: 4C 0B 9A     JMP $9A0B

; [  ]

; A: main menu text to update
;      0: monster names
;      1: character names
;      2: character hp
;      3: battle commands

02/9A05: A2 00 00     LDX #$0000
02/9A08: 8E 62 EF     STX $EF62
02/9A0B: 85 26        STA $26
02/9A0D: A9 06        LDA #$06
02/9A0F: 85 28        STA $28
02/9A11: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9A14: A6 2A        LDX $2A
02/9A16: 7B           TDC 
02/9A17: A8           TAY 
02/9A18: BF 42 FE 16  LDA $16FE42,X   ; main menu text update data
02/9A1C: 99 5C EF     STA $EF5C,Y
02/9A1F: C8           INY 
02/9A20: E8           INX 
02/9A21: C0 06 00     CPY #$0006
02/9A24: D0 F2        BNE $9A18
02/9A26: C2 20        REP #$20
02/9A28: AD 5E EF     LDA $EF5E
02/9A2B: 18           CLC 
02/9A2C: 6D 62 EF     ADC $EF62
02/9A2F: 8D 5E EF     STA $EF5E
02/9A32: 7B           TDC 
02/9A33: E2 20        SEP #$20
02/9A35: AD 5C EF     LDA $EF5C
02/9A38: AA           TAX 
02/9A39: 86 02        STX $02
02/9A3B: AE 60 EF     LDX $EF60
02/9A3E: 86 00        STX $00
02/9A40: AE 5E EF     LDX $EF5E
02/9A43: 7B           TDC 
02/9A44: A8           TAY 
02/9A45: BD 00 00     LDA $0000,X
02/9A48: 91 00        STA ($00),Y
02/9A4A: E8           INX 
02/9A4B: C8           INY 
02/9A4C: C4 02        CPY $02
02/9A4E: D0 F5        BNE $9A45
02/9A50: C2 20        REP #$20
02/9A52: A5 00        LDA $00
02/9A54: 18           CLC 
02/9A55: 69 40 00     ADC #$0040
02/9A58: 85 00        STA $00
02/9A5A: 7B           TDC 
02/9A5B: E2 20        SEP #$20
02/9A5D: CE 5D EF     DEC $EF5D
02/9A60: D0 E1        BNE $9A43
02/9A62: 60           RTS 

; [ init menu text and tilemaps ]

02/9A63: 20 0C A2     JSR $A20C       ; draw character names
02/9A66: 20 9C 9E     JSR $9E9C       ; init inventory text buffer
02/9A69: 20 70 A0     JSR $A070       ; init spell list text buffer
02/9A6C: 20 2C A1     JSR $A12C       ; draw hp text
02/9A6F: 20 9E A3     JSR $A39E       ; draw monster names
02/9A72: 20 D7 A1     JSR $A1D7       ; draw current/max mp
02/9A75: 20 A1 9C     JSR $9CA1       ; draw all battle command lists
02/9A78: 20 69 9D     JSR $9D69       ; init equipped item text buffer
02/9A7B: 20 F4 9A     JSR $9AF4       ; draw menu windows
02/9A7E: 20 8B 9A     JSR $9A8B       ; draw defend and row text
02/9A81: 20 A1 A2     JSR $A2A1       ; draw status text
02/9A84: 22 BF EB 01  JSL $01EBBF     ; draw pause window text
02/9A88: 4C C7 9A     JMP $9AC7       ; transfer menu tilemap to vram (init)

; [ draw defend and row text ]

02/9A8B: A2 E8 D5     LDX #$D5E8
02/9A8E: 86 00        STX $00
02/9A90: A2 1C D6     LDX #$D61C
02/9A93: 86 02        STX $02
02/9A95: 7B           TDC 
02/9A96: AA           TAX 
02/9A97: A8           TAY 
02/9A98: BF B7 9A 02  LDA $029AB7,X
02/9A9C: 91 00        STA ($00),Y
02/9A9E: BF BF 9A 02  LDA $029ABF,X
02/9AA2: 91 02        STA ($02),Y
02/9AA4: E8           INX 
02/9AA5: C8           INY 
02/9AA6: C8           INY 
02/9AA7: E0 08 00     CPX #$0008
02/9AAA: F0 0A        BEQ $9AB6
02/9AAC: E0 04 00     CPX #$0004
02/9AAF: D0 E7        BNE $9A98
02/9AB1: A0 40 00     LDY #$0040
02/9AB4: 80 E2        BRA $9A98
02/9AB6: 60           RTS 

;  (defend)
02/9AB7: E8 FF E8 FF
02/9ABB: E9 EA EB EC

;  (change row)
02/9ABF: FF FF FF E8
02/9AC3: E4 E5 E6 E7

; [ transfer menu tilemap to vram (init) ]

02/9AC7: 7B           TDC 
02/9AC8: AA           TAX 
02/9AC9: C2 20        REP #$20
02/9ACB: BF D6 FD 16  LDA $16FDD6,X
02/9ACF: 85 02        STA $02
02/9AD1: BF D8 FD 16  LDA $16FDD8,X
02/9AD5: A8           TAY 
02/9AD6: BF DA FD 16  LDA $16FDDA,X
02/9ADA: 85 00        STA $00
02/9ADC: 8A           TXA 
02/9ADD: 18           CLC 
02/9ADE: 69 06 00     ADC #$0006
02/9AE1: AA           TAX 
02/9AE2: 7B           TDC 
02/9AE3: E2 20        SEP #$20
02/9AE5: A9 7E        LDA #$7E
02/9AE7: DA           PHX 
02/9AE8: A6 02        LDX $02
02/9AEA: 20 75 86     JSR $8675       ; transfer data to vram
02/9AED: FA           PLX 
02/9AEE: E0 36 00     CPX #$0036
02/9AF1: D0 D6        BNE $9AC9
02/9AF3: 60           RTS 

; [ draw menu windows ]

02/9AF4: A2 40 18     LDX #$1840
02/9AF7: 7B           TDC 
02/9AF8: 9D 65 BE     STA $BE65,X
02/9AFB: CA           DEX 
02/9AFC: D0 FA        BNE $9AF8
02/9AFE: 7B           TDC 
02/9AFF: AA           TAX 
02/9B00: C2 20        REP #$20
02/9B02: A9 00 02     LDA #$0200
02/9B05: 9D 66 D3     STA $D366,X
02/9B08: A9 00 20     LDA #$2000
02/9B0B: 9D A6 D6     STA $D6A6,X
02/9B0E: 7B           TDC 
02/9B0F: 9D E6 DB     STA $DBE6,X
02/9B12: E8           INX 
02/9B13: E8           INX 
02/9B14: E0 40 03     CPX #$0340
02/9B17: D0 E9        BNE $9B02
02/9B19: 7B           TDC 
02/9B1A: E2 20        SEP #$20
02/9B1C: 20 59 9B     JSR $9B59       ; load menu window data
02/9B1F: 48           PHA 
02/9B20: 20 C7 9B     JSR $9BC7       ; draw window
02/9B23: 68           PLA 
02/9B24: 1A           INC 
02/9B25: C9 07        CMP #$07
02/9B27: D0 F3        BNE $9B1C
02/9B29: A9 07        LDA #$07
02/9B2B: 20 59 9B     JSR $9B59       ; load menu window data
02/9B2E: 20 BE 9B     JSR $9BBE       ; draw window
02/9B31: A9 08        LDA #$08
02/9B33: 20 59 9B     JSR $9B59       ; load menu window data
02/9B36: 20 BE 9B     JSR $9BBE       ; draw window
02/9B39: A9 09        LDA #$09
02/9B3B: 20 59 9B     JSR $9B59       ; load menu window data
02/9B3E: 20 BE 9B     JSR $9BBE       ; draw window
02/9B41: A9 0A        LDA #$0A
02/9B43: 20 59 9B     JSR $9B59       ; load menu window data
02/9B46: 20 C7 9B     JSR $9BC7       ; draw window
02/9B49: A9 0B        LDA #$0B
02/9B4B: 20 59 9B     JSR $9B59       ; load menu window data
02/9B4E: 20 C7 9B     JSR $9BC7       ; draw window
02/9B51: A9 0C        LDA #$0C
02/9B53: 20 59 9B     JSR $9B59       ; load menu window data
02/9B56: 4C AC 9B     JMP $9BAC       ; draw window

; [ load menu window data ]

; A: menu window id (see 16/FE5A)

02/9B59: 48           PHA 
02/9B5A: 85 26        STA $26
02/9B5C: A9 06        LDA #$06
02/9B5E: 85 28        STA $28
02/9B60: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9B63: A6 2A        LDX $2A
02/9B65: 7B           TDC 
02/9B66: A8           TAY 
02/9B67: BF 5A FE 16  LDA $16FE5A,X
02/9B6B: 99 56 EF     STA $EF56,Y
02/9B6E: C8           INY 
02/9B6F: E8           INX 
02/9B70: C0 06 00     CPY #$0006
02/9B73: D0 F2        BNE $9B67
02/9B75: 68           PLA 
02/9B76: 60           RTS 

; [ get window border tiles ]

02/9B77: A6 04        LDX $04
02/9B79: BF 91 9B 02  LDA $029B91,X
02/9B7D: 85 06        STA $06
02/9B7F: BF 92 9B 02  LDA $029B92,X
02/9B83: 85 07        STA $07
02/9B85: BF 93 9B 02  LDA $029B93,X
02/9B89: 85 08        STA $08
02/9B8B: E8           INX 
02/9B8C: E8           INX 
02/9B8D: E8           INX 
02/9B8E: 86 04        STX $04
02/9B90: 60           RTS 

; window border tiles
02/9B91: 10 11 12
02/9B94: 0B FF 0C
02/9B97: 0D 0E 0F

02/9B9A: F7 F8 F9
02/9B9D: FA FF FB
02/9BA0: FC FD FE

02/9BA3: 16 17 18
02/9BA6: FA FF FB
02/9BA9: FC FD FE

; [ draw window ]

02/9BAC: A2 09 00     LDX #$0009
02/9BAF: 86 04        STX $04
02/9BB1: A9 20        LDA #$20
02/9BB3: 80 16        BRA $9BCB
; message window ???
02/9BB5: A2 12 00     LDX #$0012
02/9BB8: 86 04        STX $04
02/9BBA: A9 20        LDA #$20
02/9BBC: 80 0D        BRA $9BCB
02/9BBE: A2 09 00     LDX #$0009
02/9BC1: 86 04        STX $04
02/9BC3: A9 02        LDA #$02
02/9BC5: 80 04        BRA $9BCB
02/9BC7: 7B           TDC 
02/9BC8: AA           TAX 
02/9BC9: 86 04        STX $04
02/9BCB: 85 02        STA $02
02/9BCD: AD 57 EF     LDA $EF57       ; y-offset
02/9BD0: 85 26        STA $26
02/9BD2: A9 40        LDA #$40
02/9BD4: 85 28        STA $28
02/9BD6: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9BD9: AD 56 EF     LDA $EF56       ; x-offset
02/9BDC: C2 20        REP #$20
02/9BDE: 48           PHA 
02/9BDF: 0A           ASL 
02/9BE0: 18           CLC 
02/9BE1: 65 2A        ADC $2A
02/9BE3: 6D 5A EF     ADC $EF5A       ; destination address
02/9BE6: 85 00        STA $00
02/9BE8: 68           PLA 
02/9BE9: E2 20        SEP #$20
02/9BEB: 20 77 9B     JSR $9B77       ; get window border tiles
02/9BEE: A6 00        LDX $00
02/9BF0: AD 58 EF     LDA $EF58       ; width
02/9BF3: A8           TAY 
02/9BF4: A5 06        LDA $06
02/9BF6: 9D 00 00     STA $0000,X
02/9BF9: A5 02        LDA $02
02/9BFB: 9D 01 00     STA $0001,X
02/9BFE: E8           INX 
02/9BFF: E8           INX 
02/9C00: 88           DEY 
02/9C01: 88           DEY 
02/9C02: A5 07        LDA $07
02/9C04: 9D 00 00     STA $0000,X
02/9C07: A5 02        LDA $02
02/9C09: 9D 01 00     STA $0001,X
02/9C0C: E8           INX 
02/9C0D: E8           INX 
02/9C0E: 88           DEY 
02/9C0F: D0 F1        BNE $9C02
02/9C11: A5 08        LDA $08
02/9C13: 9D 00 00     STA $0000,X
02/9C16: A5 02        LDA $02
02/9C18: 9D 01 00     STA $0001,X
02/9C1B: CE 59 EF     DEC $EF59       ; height
02/9C1E: CE 59 EF     DEC $EF59
02/9C21: 20 77 9B     JSR $9B77       ; get window border tiles
02/9C24: C2 20        REP #$20
02/9C26: A5 00        LDA $00
02/9C28: 18           CLC 
02/9C29: 69 40 00     ADC #$0040
02/9C2C: 85 00        STA $00
02/9C2E: 7B           TDC 
02/9C2F: E2 20        SEP #$20
02/9C31: A6 00        LDX $00
02/9C33: AD 58 EF     LDA $EF58
02/9C36: A8           TAY 
02/9C37: A5 06        LDA $06
02/9C39: 9D 00 00     STA $0000,X
02/9C3C: A5 02        LDA $02
02/9C3E: 9D 01 00     STA $0001,X
02/9C41: E8           INX 
02/9C42: E8           INX 
02/9C43: 88           DEY 
02/9C44: 88           DEY 
02/9C45: A5 07        LDA $07
02/9C47: 9D 00 00     STA $0000,X
02/9C4A: A5 02        LDA $02
02/9C4C: 9D 01 00     STA $0001,X
02/9C4F: E8           INX 
02/9C50: E8           INX 
02/9C51: 88           DEY 
02/9C52: D0 F1        BNE $9C45
02/9C54: A5 08        LDA $08
02/9C56: 9D 00 00     STA $0000,X
02/9C59: A5 02        LDA $02
02/9C5B: 9D 01 00     STA $0001,X
02/9C5E: CE 59 EF     DEC $EF59
02/9C61: D0 C1        BNE $9C24
02/9C63: 20 77 9B     JSR $9B77       ; get window border tiles
02/9C66: C2 20        REP #$20
02/9C68: A5 00        LDA $00
02/9C6A: 18           CLC 
02/9C6B: 69 40 00     ADC #$0040
02/9C6E: 85 00        STA $00
02/9C70: 7B           TDC 
02/9C71: E2 20        SEP #$20
02/9C73: A6 00        LDX $00
02/9C75: AD 58 EF     LDA $EF58
02/9C78: A8           TAY 
02/9C79: A5 06        LDA $06
02/9C7B: 9D 00 00     STA $0000,X
02/9C7E: A5 02        LDA $02
02/9C80: 9D 01 00     STA $0001,X
02/9C83: E8           INX 
02/9C84: E8           INX 
02/9C85: 88           DEY 
02/9C86: 88           DEY 
02/9C87: A5 07        LDA $07
02/9C89: 9D 00 00     STA $0000,X
02/9C8C: A5 02        LDA $02
02/9C8E: 9D 01 00     STA $0001,X
02/9C91: E8           INX 
02/9C92: E8           INX 
02/9C93: 88           DEY 
02/9C94: D0 F1        BNE $9C87
02/9C96: A5 08        LDA $08
02/9C98: 9D 00 00     STA $0000,X
02/9C9B: A5 02        LDA $02
02/9C9D: 9D 01 00     STA $0001,X
02/9CA0: 60           RTS 

; [ draw all battle command lists ]

02/9CA1: 9C 16 18     STZ $1816
02/9CA4: 9C 17 18     STZ $1817
02/9CA7: 20 D0 9C     JSR $9CD0       ; draw battle command name
02/9CAA: EE 17 18     INC $1817
02/9CAD: AD 17 18     LDA $1817
02/9CB0: C9 05        CMP #$05
02/9CB2: D0 F3        BNE $9CA7
02/9CB4: EE 16 18     INC $1816
02/9CB7: AD 16 18     LDA $1816
02/9CBA: C9 05        CMP #$05
02/9CBC: D0 E6        BNE $9CA4
02/9CBE: 60           RTS 

; [ draw battle command list ]

02/9CBF: 9C 17 18     STZ $1817
02/9CC2: 20 D0 9C     JSR $9CD0       ; draw battle command name
02/9CC5: EE 17 18     INC $1817
02/9CC8: AD 17 18     LDA $1817
02/9CCB: C9 05        CMP #$05
02/9CCD: D0 F3        BNE $9CC2
02/9CCF: 60           RTS 

; [ draw battle command name ]

02/9CD0: A2 FD 74     LDX #$74FD      ; text buffer
02/9CD3: 8E 50 EF     STX $EF50
02/9CD6: A9 05        LDA #$05
02/9CD8: 8D 54 EF     STA $EF54
02/9CDB: AD 17 18     LDA $1817       ; battle command slot
02/9CDE: 85 26        STA $26
02/9CE0: A9 14        LDA #$14
02/9CE2: 85 28        STA $28
02/9CE4: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9CE7: AD 17 18     LDA $1817
02/9CEA: 0A           ASL 
02/9CEB: 0A           ASL 
02/9CEC: AA           TAX 
02/9CED: 86 00        STX $00
02/9CEF: AD 16 18     LDA $1816       ; character id
02/9CF2: 0A           ASL 
02/9CF3: AA           TAX 
02/9CF4: C2 20        REP #$20
02/9CF6: BF AD FE 16  LDA $16FEAD,X   ; pointers battle command text buffers
02/9CFA: 18           CLC 
02/9CFB: 65 2A        ADC $2A         ; add command slot * 20
02/9CFD: 8D 52 EF     STA $EF52
02/9D00: BF B7 FE 16  LDA $16FEB7,X   ; pointers to battle command data
02/9D04: 18           CLC 
02/9D05: 65 00        ADC $00
02/9D07: AA           TAX 
02/9D08: 7B           TDC 
02/9D09: E2 20        SEP #$20
02/9D0B: DA           PHX 
02/9D0C: BD 01 00     LDA $0001,X     ; $3303
02/9D0F: 85 26        STA $26
02/9D11: BD 00 00     LDA $0000,X     ; $3302
02/9D14: 48           PHA 
02/9D15: A9 05        LDA #$05
02/9D17: 85 28        STA $28
02/9D19: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9D1C: A6 2A        LDX $2A
02/9D1E: A9 00        LDA #$00        ; white text
02/9D20: 85 00        STA $00
02/9D22: 68           PLA 
02/9D23: 29 80        AND #$80
02/9D25: F0 04        BEQ $9D2B
02/9D27: A9 04        LDA #$04        ; gray text
02/9D29: 85 00        STA $00
02/9D2B: 7B           TDC 
02/9D2C: A8           TAY 
02/9D2D: A9 0E        LDA #$0E        ; change tile flags
02/9D2F: 99 FD 74     STA $74FD,Y
02/9D32: C8           INY 
02/9D33: A5 00        LDA $00         ; text color
02/9D35: 99 FD 74     STA $74FD,Y
02/9D38: C8           INY 
02/9D39: BF B8 A7 0F  LDA $0FA7B8,X   ; battle command names
02/9D3D: 99 FD 74     STA $74FD,Y
02/9D40: C8           INY 
02/9D41: E8           INX 
02/9D42: C0 07 00     CPY #$0007
02/9D45: D0 F2        BNE $9D39
02/9D47: 7B           TDC 
02/9D48: 99 FD 74     STA $74FD,Y
02/9D4B: FA           PLX 
02/9D4C: BD 01 00     LDA $0001,X
02/9D4F: C9 FF        CMP #$FF
02/9D51: D0 0C        BNE $9D5F
02/9D53: A0 02 00     LDY #$0002
02/9D56: 99 FD 74     STA $74FD,Y
02/9D59: C8           INY 
02/9D5A: C0 07 00     CPY #$0007
02/9D5D: D0 F7        BNE $9D56
02/9D5F: 7B           TDC 
02/9D60: 8D 55 EF     STA $EF55
02/9D63: 20 55 A4     JSR $A455       ; draw text
02/9D66: 60           RTS 

; ??? pointers for left and right hand
02/9D67: 00 30

; [ init equipped item text buffer ]

02/9D69: 9C 16 18     STZ $1816
02/9D6C: 9C 17 18     STZ $1817
02/9D6F: 20 CD 9D     JSR $9DCD       ; draw equipped item text
02/9D72: EE 17 18     INC $1817
02/9D75: AD 17 18     LDA $1817
02/9D78: C9 02        CMP #$02
02/9D7A: D0 F3        BNE $9D6F
02/9D7C: 20 8A 9D     JSR $9D8A       ; draw right/left hand text
02/9D7F: EE 16 18     INC $1816
02/9D82: AD 16 18     LDA $1816
02/9D85: C9 05        CMP #$05
02/9D87: D0 E3        BNE $9D6C
02/9D89: 60           RTS 

; [ draw right/left hand text ]

02/9D8A: AD 16 18     LDA $1816
02/9D8D: AA           TAX 
02/9D8E: 20 07 E1     JSR $E107
02/9D91: BD 00 20     LDA $2000,X     ; left/right handed
02/9D94: 29 C0        AND #$C0
02/9D96: 4A           LSR 
02/9D97: 4A           LSR 
02/9D98: 4A           LSR 
02/9D99: 4A           LSR 
02/9D9A: 4A           LSR 
02/9D9B: 4A           LSR 
02/9D9C: 85 26        STA $26
02/9D9E: A9 14        LDA #$14
02/9DA0: 85 28        STA $28
02/9DA2: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9DA5: AD 16 18     LDA $1816
02/9DA8: 0A           ASL 
02/9DA9: AA           TAX 
02/9DAA: C2 20        REP #$20
02/9DAC: BF 25 FF 16  LDA $16FF25,X   ; pointers to right/left hand text buffer
02/9DB0: A8           TAY 
02/9DB1: 7B           TDC 
02/9DB2: E2 20        SEP #$20
02/9DB4: A6 2A        LDX $2A
02/9DB6: A9 14        LDA #$14
02/9DB8: 85 00        STA $00
02/9DBA: BF D5 FE 16  LDA $16FED5,X   ; right/left hand text
02/9DBE: 99 00 00     STA $0000,Y
02/9DC1: 7B           TDC 
02/9DC2: 99 01 00     STA $0001,Y
02/9DC5: E8           INX 
02/9DC6: C8           INY 
02/9DC7: C8           INY 
02/9DC8: C6 00        DEC $00
02/9DCA: D0 EE        BNE $9DBA
02/9DCC: 60           RTS 

; [ draw equipped item text ]

02/9DCD: A2 FD 74     LDX #$74FD
02/9DD0: 8E 50 EF     STX $EF50
02/9DD3: A9 0C        LDA #$0C
02/9DD5: 8D 54 EF     STA $EF54
02/9DD8: AD 17 18     LDA $1817
02/9DDB: AA           TAX 
02/9DDC: BF 67 9D 02  LDA $029D67,X
02/9DE0: AA           TAX 
02/9DE1: 86 02        STX $02
02/9DE3: AD 17 18     LDA $1817
02/9DE6: 0A           ASL 
02/9DE7: 0A           ASL 
02/9DE8: AA           TAX 
02/9DE9: 86 00        STX $00
02/9DEB: AD 16 18     LDA $1816
02/9DEE: 0A           ASL 
02/9DEF: AA           TAX 
02/9DF0: C2 20        REP #$20
02/9DF2: BF C1 FE 16  LDA $16FEC1,X   ; pointers to equipped item text buffer
02/9DF6: 18           CLC 
02/9DF7: 65 02        ADC $02
02/9DF9: 8D 52 EF     STA $EF52
02/9DFC: BF CB FE 16  LDA $16FECB,X
02/9E00: 18           CLC 
02/9E01: 65 00        ADC $00
02/9E03: AA           TAX 
02/9E04: 7B           TDC 
02/9E05: E2 20        SEP #$20
02/9E07: A9 00        LDA #$00
02/9E09: 85 00        STA $00
02/9E0B: A9 00        LDA #$00
02/9E0D: 85 01        STA $01
02/9E0F: BD 01 00     LDA $0001,X
02/9E12: 85 26        STA $26
02/9E14: 85 02        STA $02
02/9E16: BD 02 00     LDA $0002,X
02/9E19: 48           PHA 
02/9E1A: A9 09        LDA #$09
02/9E1C: 85 28        STA $28
02/9E1E: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9E21: BD 00 00     LDA $0000,X
02/9E24: 29 80        AND #$80
02/9E26: F0 06        BEQ $9E2E
02/9E28: A9 04        LDA #$04
02/9E2A: 85 00        STA $00
02/9E2C: 85 01        STA $01
02/9E2E: A6 2A        LDX $2A
02/9E30: 7B           TDC 
02/9E31: A8           TAY 
02/9E32: A9 0E        LDA #$0E
02/9E34: 99 FD 74     STA $74FD,Y
02/9E37: C8           INY 
02/9E38: A5 01        LDA $01
02/9E3A: 99 FD 74     STA $74FD,Y
02/9E3D: C8           INY 
02/9E3E: A9 03        LDA #$03
02/9E40: 99 FD 74     STA $74FD,Y
02/9E43: C8           INY 
02/9E44: BF 00 80 0F  LDA $0F8000,X   ; item symbol
02/9E48: 99 FD 74     STA $74FD,Y
02/9E4B: C8           INY 
02/9E4C: A9 0E        LDA #$0E
02/9E4E: 99 FD 74     STA $74FD,Y
02/9E51: C8           INY 
02/9E52: A5 00        LDA $00
02/9E54: 99 FD 74     STA $74FD,Y
02/9E57: C8           INY 
02/9E58: A9 08        LDA #$08
02/9E5A: 85 00        STA $00
02/9E5C: BF 01 80 0F  LDA $0F8001,X   ; item name
02/9E60: 99 FD 74     STA $74FD,Y
02/9E63: C8           INY 
02/9E64: E8           INX 
02/9E65: C6 00        DEC $00
02/9E67: D0 F3        BNE $9E5C
02/9E69: A5 02        LDA $02
02/9E6B: D0 0B        BNE $9E78
02/9E6D: 68           PLA 
02/9E6E: A9 05        LDA #$05
02/9E70: 99 FD 74     STA $74FD,Y
02/9E73: C8           INY 
02/9E74: A9 03        LDA #$03
02/9E76: 80 18        BRA $9E90
02/9E78: A9 C8        LDA #$C8
02/9E7A: 99 FD 74     STA $74FD,Y
02/9E7D: C8           INY 
02/9E7E: 68           PLA 
02/9E7F: AA           TAX 
02/9E80: 20 BF 86     JSR $86BF       ; convert hex to decimal
02/9E83: 20 16 87     JSR $8716       ; normalize number text
02/9E86: AD 0E 18     LDA $180E
02/9E89: 99 FD 74     STA $74FD,Y
02/9E8C: C8           INY 
02/9E8D: AD 0F 18     LDA $180F
02/9E90: 99 FD 74     STA $74FD,Y
02/9E93: C8           INY 
02/9E94: 7B           TDC 
02/9E95: 99 FD 74     STA $74FD,Y
02/9E98: 20 55 A4     JSR $A455       ; draw text
02/9E9B: 60           RTS 

; [ init inventory text buffer ]

02/9E9C: 9C 17 18     STZ $1817
02/9E9F: 20 A4 9F     JSR $9FA4       ; draw inventory item text
02/9EA2: EE 17 18     INC $1817
02/9EA5: AD 17 18     LDA $1817
02/9EA8: C9 30        CMP #$30
02/9EAA: D0 F3        BNE $9E9F
02/9EAC: 60           RTS 

; [ battle graphics $0E: draw spell list ]

02/9EAD: A5 00        LDA $00         ; character slot
02/9EAF: 0A           ASL 
02/9EB0: AA           TAX 
02/9EB1: C2 20        REP #$20
02/9EB3: BF 39 FF 16  LDA $16FF39,X   ; pointers to spell lists
02/9EB7: 85 00        STA $00
02/9EB9: BF 2F FF 16  LDA $16FF2F,X   ; pointers to spell list text buffers
02/9EBD: 85 02        STA $02
02/9EBF: 18           CLC 
02/9EC0: 69 0C 00     ADC #$000C
02/9EC3: 85 04        STA $04
02/9EC5: 7B           TDC 
02/9EC6: E2 20        SEP #$20
02/9EC8: A9 48        LDA #$48
02/9ECA: 85 07        STA $07
; start of spell loop
02/9ECC: A0 01 00     LDY #$0001
02/9ECF: B2 00        LDA ($00)
02/9ED1: 30 08        BMI $9EDB
02/9ED3: A9 00        LDA #$00        ; palette 0, white text
02/9ED5: 85 06        STA $06
02/9ED7: A9 00        LDA #$00
02/9ED9: 80 08        BRA $9EE3
02/9EDB: A9 04        LDA #$04        ; palette 1, gray text
02/9EDD: 85 06        STA $06
02/9EDF: 80 02        BRA $9EE3
02/9EE1: A5 06        LDA $06
02/9EE3: 91 02        STA ($02),Y
02/9EE5: 91 04        STA ($04),Y
02/9EE7: C8           INY 
02/9EE8: C8           INY 
02/9EE9: C0 0D 00     CPY #$000D
02/9EEC: D0 F3        BNE $9EE1
02/9EEE: C2 20        REP #$20
02/9EF0: A5 02        LDA $02
02/9EF2: 18           CLC 
02/9EF3: 69 18 00     ADC #$0018
02/9EF6: 85 02        STA $02
02/9EF8: 18           CLC 
02/9EF9: 69 0C 00     ADC #$000C
02/9EFC: 85 04        STA $04
02/9EFE: A5 00        LDA $00
02/9F00: 18           CLC 
02/9F01: 69 04 00     ADC #$0004
02/9F04: 85 00        STA $00
02/9F06: 7B           TDC 
02/9F07: E2 20        SEP #$20
02/9F09: C6 07        DEC $07
02/9F0B: D0 BF        BNE $9ECC
02/9F0D: 60           RTS 

; [  ]

02/9F0E: AD 22 18     LDA $1822
02/9F11: 8D 16 18     STA $1816
02/9F14: 9C 17 18     STZ $1817
02/9F17: 20 CD 9D     JSR $9DCD       ; draw equipped item text
02/9F1A: EE 17 18     INC $1817
02/9F1D: 20 CD 9D     JSR $9DCD       ; draw equipped item text
02/9F20: AD 9A EF     LDA $EF9A
02/9F23: F0 03        BEQ $9F28
02/9F25: 4C 65 9F     JMP $9F65
02/9F28: 7B           TDC 
02/9F29: A8           TAY 
02/9F2A: AA           TAX 
02/9F2B: A9 0C        LDA #$0C
02/9F2D: 85 02        STA $02
02/9F2F: BD 1A 32     LDA $321A,X
02/9F32: 30 08        BMI $9F3C
02/9F34: A9 00        LDA #$00
02/9F36: 85 00        STA $00
02/9F38: A9 00        LDA #$00
02/9F3A: 80 08        BRA $9F44
02/9F3C: A9 04        LDA #$04
02/9F3E: 85 00        STA $00
02/9F40: 80 02        BRA $9F44
02/9F42: A5 00        LDA $00
02/9F44: 99 A7 8E     STA $8EA7,Y
02/9F47: 99 BF 8E     STA $8EBF,Y
02/9F4A: C8           INY 
02/9F4B: C8           INY 
02/9F4C: C6 02        DEC $02
02/9F4E: D0 F2        BNE $9F42
02/9F50: C2 20        REP #$20
02/9F52: 98           TYA 
02/9F53: 18           CLC 
02/9F54: 69 18 00     ADC #$0018
02/9F57: A8           TAY 
02/9F58: 7B           TDC 
02/9F59: E2 20        SEP #$20
02/9F5B: E8           INX 
02/9F5C: E8           INX 
02/9F5D: E8           INX 
02/9F5E: E8           INX 
02/9F5F: E0 C0 00     CPX #$00C0
02/9F62: D0 C7        BNE $9F2B
02/9F64: 60           RTS 
02/9F65: 7B           TDC 
02/9F66: AA           TAX 
02/9F67: A8           TAY 
02/9F68: A9 0C        LDA #$0C
02/9F6A: 85 02        STA $02
02/9F6C: BD 1A 32     LDA $321A,X
02/9F6F: 29 04        AND #$04
02/9F71: F0 08        BEQ $9F7B
02/9F73: A9 00        LDA #$00
02/9F75: 85 00        STA $00
02/9F77: A9 00        LDA #$00
02/9F79: 80 08        BRA $9F83
02/9F7B: A9 04        LDA #$04
02/9F7D: 85 00        STA $00
02/9F7F: 80 02        BRA $9F83
02/9F81: A5 00        LDA $00
02/9F83: 99 A7 8E     STA $8EA7,Y
02/9F86: 99 BF 8E     STA $8EBF,Y
02/9F89: C8           INY 
02/9F8A: C8           INY 
02/9F8B: C6 02        DEC $02
02/9F8D: D0 F2        BNE $9F81
02/9F8F: C2 20        REP #$20
02/9F91: 98           TYA 
02/9F92: 18           CLC 
02/9F93: 69 18 00     ADC #$0018
02/9F96: A8           TAY 
02/9F97: 7B           TDC 
02/9F98: E2 20        SEP #$20
02/9F9A: E8           INX 
02/9F9B: E8           INX 
02/9F9C: E8           INX 
02/9F9D: E8           INX 
02/9F9E: E0 C0 00     CPX #$00C0
02/9FA1: D0 C5        BNE $9F68
02/9FA3: 60           RTS 

; [ draw inventory item text ]

02/9FA4: A2 FD 74     LDX #$74FD      ; init pointer to text buffer
02/9FA7: 8E 50 EF     STX $EF50
02/9FAA: AD 17 18     LDA $1817       ; inventory slot
02/9FAD: 85 26        STA $26
02/9FAF: A9 30        LDA #$30        ; 48 bytes per item slot (24 tiles)
02/9FB1: 85 28        STA $28
02/9FB3: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9FB6: C2 20        REP #$20
02/9FB8: A5 2A        LDA $2A
02/9FBA: 18           CLC 
02/9FBB: 69 A6 8E     ADC #$8EA6      ; inventory text buffer
02/9FBE: 8D 52 EF     STA $EF52
02/9FC1: 7B           TDC 
02/9FC2: E2 20        SEP #$20
02/9FC4: A9 0C        LDA #$0C        ; 2 lines, 12 characters per line
02/9FC6: 8D 54 EF     STA $EF54
02/9FC9: AD 17 18     LDA $1817
02/9FCC: 0A           ASL 
02/9FCD: 0A           ASL 
02/9FCE: AA           TAX 
02/9FCF: BD 1B 32     LDA $321B,X     ; item id
02/9FD2: 85 02        STA $02
02/9FD4: 85 26        STA $26
02/9FD6: BD 1C 32     LDA $321C,X     ; item quantity
02/9FD9: 48           PHA 
02/9FDA: A9 00        LDA #$00        ; use white palette
02/9FDC: 85 00        STA $00
02/9FDE: A9 00        LDA #$00
02/9FE0: 85 01        STA $01
02/9FE2: BD 1A 32     LDA $321A,X
02/9FE5: 29 80        AND #$80
02/9FE7: F0 06        BEQ $9FEF       ; branch if not disabled
02/9FE9: A9 04        LDA #$04        ; use gray palette
02/9FEB: 85 00        STA $00
02/9FED: 85 01        STA $01
02/9FEF: A9 09        LDA #$09
02/9FF1: 85 28        STA $28
02/9FF3: 20 60 85     JSR $8560       ; multiply (8-bit)
02/9FF6: A6 2A        LDX $2A
02/9FF8: 7B           TDC 
02/9FF9: A8           TAY 
02/9FFA: A9 0E        LDA #$0E
02/9FFC: 99 FD 74     STA $74FD,Y
02/9FFF: C8           INY 
02/A000: A5 01        LDA $01
02/A002: 99 FD 74     STA $74FD,Y
02/A005: C8           INY 
02/A006: A9 03        LDA #$03
02/A008: 99 FD 74     STA $74FD,Y
02/A00B: C8           INY 
02/A00C: BF 00 80 0F  LDA $0F8000,X   ; item symbol
02/A010: 99 FD 74     STA $74FD,Y
02/A013: C8           INY 
02/A014: A9 0E        LDA #$0E
02/A016: 99 FD 74     STA $74FD,Y
02/A019: C8           INY 
02/A01A: A5 00        LDA $00
02/A01C: 99 FD 74     STA $74FD,Y
02/A01F: C8           INY 
02/A020: A9 08        LDA #$08
02/A022: 85 00        STA $00
02/A024: BF 01 80 0F  LDA $0F8001,X   ; item name
02/A028: 99 FD 74     STA $74FD,Y
02/A02B: C8           INY 
02/A02C: E8           INX 
02/A02D: C6 00        DEC $00
02/A02F: D0 F3        BNE $A024
02/A031: A5 02        LDA $02
02/A033: D0 0B        BNE $A040
02/A035: 68           PLA 
02/A036: A9 05        LDA #$05
02/A038: 99 FD 74     STA $74FD,Y
02/A03B: C8           INY 
02/A03C: A9 03        LDA #$03
02/A03E: 80 24        BRA $A064
02/A040: A9 C8        LDA #$C8        ; colon ":"
02/A042: 99 FD 74     STA $74FD,Y
02/A045: C8           INY 
02/A046: 68           PLA 
02/A047: AA           TAX 
02/A048: 20 BF 86     JSR $86BF       ; convert hex to decimal
02/A04B: 20 16 87     JSR $8716       ; normalize number text
02/A04E: A9 03        LDA #$03
02/A050: 99 FD 74     STA $74FD,Y
02/A053: C8           INY 
02/A054: AD 0E 18     LDA $180E
02/A057: 99 FD 74     STA $74FD,Y
02/A05A: C8           INY 
02/A05B: A9 03        LDA #$03
02/A05D: 99 FD 74     STA $74FD,Y
02/A060: C8           INY 
02/A061: AD 0F 18     LDA $180F
02/A064: 99 FD 74     STA $74FD,Y
02/A067: C8           INY 
02/A068: 7B           TDC 
02/A069: 99 FD 74     STA $74FD,Y
02/A06C: 20 55 A4     JSR $A455       ; draw text
02/A06F: 60           RTS 

; [ init spell list text buffer ]

02/A070: 9C 16 18     STZ $1816
02/A073: 9C 17 18     STZ $1817
02/A076: 20 8E A0     JSR $A08E       ; draw spell name (spell list)
02/A079: EE 17 18     INC $1817
02/A07C: AD 17 18     LDA $1817
02/A07F: C9 48        CMP #$48
02/A081: D0 F3        BNE $A076
02/A083: EE 16 18     INC $1816
02/A086: AD 16 18     LDA $1816
02/A089: C9 05        CMP #$05
02/A08B: D0 E6        BNE $A073
02/A08D: 60           RTS 

; [ draw spell name (spell list) ]

02/A08E: A2 FD 74     LDX #$74FD
02/A091: 8E 50 EF     STX $EF50
02/A094: A9 06        LDA #$06
02/A096: 8D 54 EF     STA $EF54
02/A099: AD 17 18     LDA $1817
02/A09C: 85 26        STA $26
02/A09E: A9 18        LDA #$18
02/A0A0: 85 28        STA $28
02/A0A2: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A0A5: AD 16 18     LDA $1816
02/A0A8: 0A           ASL 
02/A0A9: AA           TAX 
02/A0AA: AD 17 18     LDA $1817
02/A0AD: C2 20        REP #$20
02/A0AF: 0A           ASL 
02/A0B0: 0A           ASL 
02/A0B1: 85 00        STA $00
02/A0B3: BF 2F FF 16  LDA $16FF2F,X   ; pointers to spell list text buffers
02/A0B7: 18           CLC 
02/A0B8: 65 2A        ADC $2A
02/A0BA: 8D 52 EF     STA $EF52
02/A0BD: BF 39 FF 16  LDA $16FF39,X
02/A0C1: 18           CLC 
02/A0C2: 65 00        ADC $00
02/A0C4: AA           TAX 
02/A0C5: 7B           TDC 
02/A0C6: E2 20        SEP #$20
02/A0C8: BD 01 00     LDA $0001,X
02/A0CB: 85 26        STA $26
02/A0CD: A9 00        LDA #$00
02/A0CF: 85 00        STA $00
02/A0D1: A9 00        LDA #$00
02/A0D3: 85 01        STA $01
02/A0D5: BD 00 00     LDA $0000,X
02/A0D8: 29 80        AND #$80
02/A0DA: F0 06        BEQ $A0E2
02/A0DC: A9 04        LDA #$04
02/A0DE: 85 00        STA $00
02/A0E0: 85 01        STA $01
02/A0E2: A9 06        LDA #$06
02/A0E4: 85 28        STA $28
02/A0E6: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A0E9: A6 2A        LDX $2A
02/A0EB: 7B           TDC 
02/A0EC: A8           TAY 
02/A0ED: A9 0E        LDA #$0E
02/A0EF: 99 FD 74     STA $74FD,Y
02/A0F2: C8           INY 
02/A0F3: A5 01        LDA $01
02/A0F5: 99 FD 74     STA $74FD,Y
02/A0F8: C8           INY 
02/A0F9: A9 03        LDA #$03
02/A0FB: 99 FD 74     STA $74FD,Y
02/A0FE: C8           INY 
02/A0FF: BF 00 89 0F  LDA $0F8900,X   ; spell names
02/A103: 99 FD 74     STA $74FD,Y
02/A106: C8           INY 
02/A107: A9 0E        LDA #$0E
02/A109: 99 FD 74     STA $74FD,Y
02/A10C: C8           INY 
02/A10D: A5 00        LDA $00
02/A10F: 99 FD 74     STA $74FD,Y
02/A112: C8           INY 
02/A113: A9 05        LDA #$05
02/A115: 85 00        STA $00
02/A117: BF 01 89 0F  LDA $0F8901,X
02/A11B: 99 FD 74     STA $74FD,Y
02/A11E: C8           INY 
02/A11F: E8           INX 
02/A120: C6 00        DEC $00
02/A122: D0 F3        BNE $A117
02/A124: 7B           TDC 
02/A125: 99 FD 74     STA $74FD,Y
02/A128: 20 55 A4     JSR $A455       ; draw text
02/A12B: 60           RTS 

; [ battle graphics $0C: draw hp text ]

02/A12C: A9 02        LDA #$02
02/A12E: 20 11 A4     JSR $A411       ; get battle menu text buffer data
02/A131: 7B           TDC 
02/A132: A8           TAY 
02/A133: AA           TAX 
02/A134: 64 04        STZ $04
02/A136: 64 06        STZ $06
; start of character loop
02/A138: DA           PHX 
02/A139: A5 04        LDA $04
02/A13B: C2 20        REP #$20
02/A13D: 0A           ASL 
02/A13E: AA           TAX 
02/A13F: BF CD A1 02  LDA $02A1CD,X   ; pointers to character data
02/A143: 85 00        STA $00
02/A145: 7B           TDC 
02/A146: E2 20        SEP #$20
02/A148: FA           PLX 
02/A149: 20 F8 A1     JSR $A1F8       ; check if character name/hp hidden
02/A14C: B0 17        BCS $A165
02/A14E: B2 00        LDA ($00)
02/A150: F0 13        BEQ $A165       ; branch if no character
02/A152: A9 06        LDA #$06
02/A154: 85 02        STA $02
02/A156: BF 8A FF 16  LDA $16FF8A,X   ; character current/max hp text
02/A15A: 99 FD 74     STA $74FD,Y
02/A15D: C8           INY 
02/A15E: E8           INX 
02/A15F: C6 02        DEC $02
02/A161: D0 F3        BNE $A156
02/A163: 80 0D        BRA $A172
02/A165: C2 20        REP #$20
02/A167: 8A           TXA 
02/A168: 18           CLC 
02/A169: 69 06 00     ADC #$0006
02/A16C: AA           TAX 
02/A16D: 7B           TDC 
02/A16E: E2 20        SEP #$20
02/A170: E6 06        INC $06
02/A172: E6 04        INC $04
02/A174: A5 04        LDA $04
02/A176: C9 05        CMP #$05
02/A178: D0 BE        BNE $A138
02/A17A: A5 06        LDA $06
02/A17C: F0 16        BEQ $A194       ; branch if there are no empty slots
02/A17E: A9 05        LDA #$05
02/A180: 99 FD 74     STA $74FD,Y     ; fill empty slots
02/A183: C8           INY 
02/A184: A9 09        LDA #$09
02/A186: 99 FD 74     STA $74FD,Y
02/A189: C8           INY 
02/A18A: A9 01        LDA #$01
02/A18C: 99 FD 74     STA $74FD,Y
02/A18F: C8           INY 
02/A190: C6 06        DEC $06
02/A192: D0 EA        BNE $A17E
02/A194: 7B           TDC             ; null-terminator
02/A195: 99 FC 74     STA $74FC,Y
02/A198: 20 55 A4     JSR $A455       ; draw text
02/A19B: 7B           TDC 
02/A19C: AA           TAX 
02/A19D: C2 20        REP #$20
02/A19F: BF CD A1 02  LDA $02A1CD,X   ; pointers to character data
02/A1A3: 85 00        STA $00
02/A1A5: 7B           TDC 
02/A1A6: E2 20        SEP #$20
02/A1A8: B2 00        LDA ($00)
02/A1AA: D0 04        BNE $A1B0       ; find first non-empty character slot
02/A1AC: E8           INX 
02/A1AD: E8           INX 
02/A1AE: 80 ED        BRA $A19D
02/A1B0: BF BE A1 02  LDA $02A1BE,X   ; this value is unused
02/A1B4: A9 77        LDA #$77        ; little "hp" text
02/A1B6: 9D E2 B9     STA $B9E2,X
02/A1B9: 1A           INC 
02/A1BA: 9D E4 B9     STA $B9E4,X
02/A1BD: 60           RTS 

; pointers to character hp text buffers (unused)
02/A1BE: 0024 006C 0000 0090 0048

; character display order
02/A1C8: 01 03 00 04 02

; pointers to character data
02/A1CD: 2080 2180 2000 2200 2100

; [ battle graphics $0D: draw current/max mp ]

02/A1D7: A9 03        LDA #$03        ; character current/max mp
02/A1D9: 20 2F A4     JSR $A42F       ; draw battle menu text
02/A1DC: 7B           TDC 
02/A1DD: AA           TAX 
02/A1DE: BF 58 97 02  LDA $029758,X
02/A1E2: A8           TAY 
02/A1E3: A9 DB        LDA #$DB        ; little "mp" text
02/A1E5: 99 94 BA     STA $BA94,Y
02/A1E8: 1A           INC 
02/A1E9: 99 96 BA     STA $BA96,Y
02/A1EC: E8           INX 
02/A1ED: E0 05 00     CPX #$0005
02/A1F0: D0 EC        BNE $A1DE
02/A1F2: 60           RTS 

; character display order
02/A1F3: 01 03 00 04 02

; [ check if character name/hp hidden ]

02/A1F8: DA           PHX 
02/A1F9: A5 04        LDA $04
02/A1FB: AA           TAX 
02/A1FC: BF F3 A1 02  LDA $02A1F3,X
02/A200: AA           TAX 
02/A201: BD C1 F2     LDA $F2C1,X
02/A204: F0 03        BEQ $A209
02/A206: FA           PLX 
02/A207: 38           SEC 
02/A208: 60           RTS 
02/A209: FA           PLX 
02/A20A: 18           CLC 
02/A20B: 60           RTS 

; [ battle graphics $0A: draw character names ]

02/A20C: A9 01        LDA #$01
02/A20E: 20 11 A4     JSR $A411       ; get battle menu text buffer data
02/A211: 7B           TDC 
02/A212: A8           TAY 
02/A213: AA           TAX 
02/A214: 64 04        STZ $04
02/A216: 64 06        STZ $06
02/A218: DA           PHX 
02/A219: A5 04        LDA $04
02/A21B: C2 20        REP #$20
02/A21D: 0A           ASL 
02/A21E: AA           TAX 
02/A21F: BF CD A1 02  LDA $02A1CD,X
02/A223: 85 00        STA $00
02/A225: 7B           TDC 
02/A226: E2 20        SEP #$20
02/A228: FA           PLX 
02/A229: 20 F8 A1     JSR $A1F8       ; check if character name/hp hidden
02/A22C: B0 3C        BCS $A26A
02/A22E: B2 00        LDA ($00)
02/A230: F0 38        BEQ $A26A
02/A232: A9 0E        LDA #$0E
02/A234: 99 FD 74     STA $74FD,Y
02/A237: C8           INY 
02/A238: A5 D7        LDA $D7
02/A23A: F0 15        BEQ $A251
02/A23C: DA           PHX 
02/A23D: A5 04        LDA $04
02/A23F: AA           TAX 
02/A240: BF C8 A1 02  LDA $02A1C8,X   ; character display order
02/A244: CD 22 18     CMP $1822
02/A247: F0 03        BEQ $A24C
02/A249: FA           PLX 
02/A24A: 80 05        BRA $A251
02/A24C: FA           PLX 
02/A24D: A9 08        LDA #$08
02/A24F: 80 02        BRA $A253
02/A251: A9 00        LDA #$00
02/A253: 99 FD 74     STA $74FD,Y
02/A256: C8           INY 
02/A257: A9 03        LDA #$03
02/A259: 85 02        STA $02
02/A25B: BF 7B FF 16  LDA $16FF7B,X   ; character names text
02/A25F: 99 FD 74     STA $74FD,Y
02/A262: C8           INY 
02/A263: E8           INX 
02/A264: C6 02        DEC $02
02/A266: D0 F3        BNE $A25B
02/A268: 80 0D        BRA $A277
02/A26A: C2 20        REP #$20
02/A26C: 8A           TXA 
02/A26D: 18           CLC 
02/A26E: 69 03 00     ADC #$0003
02/A271: AA           TAX 
02/A272: 7B           TDC 
02/A273: E2 20        SEP #$20
02/A275: E6 06        INC $06
02/A277: E6 04        INC $04
02/A279: A5 04        LDA $04
02/A27B: C9 05        CMP #$05
02/A27D: D0 99        BNE $A218
02/A27F: A5 06        LDA $06
02/A281: F0 16        BEQ $A299
02/A283: A9 05        LDA #$05
02/A285: 99 FD 74     STA $74FD,Y
02/A288: C8           INY 
02/A289: A9 06        LDA #$06
02/A28B: 99 FD 74     STA $74FD,Y
02/A28E: C8           INY 
02/A28F: A9 01        LDA #$01
02/A291: 99 FD 74     STA $74FD,Y
02/A294: C8           INY 
02/A295: C6 06        DEC $06
02/A297: D0 EA        BNE $A283
02/A299: 7B           TDC 
02/A29A: 99 FC 74     STA $74FC,Y
02/A29D: 20 55 A4     JSR $A455       ; draw text
02/A2A0: 60           RTS 

; [ draw status text ]

; this window is shown when choosing a target for a beneficial spell or item

02/A2A1: A2 82 BE     LDX #$BE82      ; copy character name/hp tilemap
02/A2A4: 86 00        STX $00
02/A2A6: A2 AA D6     LDX #$D6AA
02/A2A9: 86 02        STX $02
02/A2AB: C2 20        REP #$20
02/A2AD: A9 0D 00     LDA #$000D      ; copy 13 rows
02/A2B0: 85 06        STA $06
02/A2B2: A9 10 00     LDA #$0010      ; and 16 columns
02/A2B5: 85 04        STA $04
02/A2B7: A0 00 00     LDY #$0000
02/A2BA: B1 00        LDA ($00),Y
02/A2BC: 91 02        STA ($02),Y
02/A2BE: C8           INY 
02/A2BF: C8           INY 
02/A2C0: C6 04        DEC $04
02/A2C2: D0 F6        BNE $A2BA
02/A2C4: A5 00        LDA $00
02/A2C6: 18           CLC 
02/A2C7: 69 40 00     ADC #$0040
02/A2CA: 85 00        STA $00
02/A2CC: A5 02        LDA $02
02/A2CE: 18           CLC 
02/A2CF: 69 40 00     ADC #$0040
02/A2D2: 85 02        STA $02
02/A2D4: C6 06        DEC $06
02/A2D6: D0 DA        BNE $A2B2
02/A2D8: 7B           TDC 
02/A2D9: E2 20        SEP #$20
02/A2DB: 4C E2 A2     JMP $A2E2

; status effects shown in target select window
02/A2DE: FF FF 41 30

; continuation from above
02/A2E2: A2 10 D7     LDX #$D710      ; status tilemap buffer
02/A2E5: 8E 52 EF     STX $EF52
02/A2E8: 7B           TDC 
02/A2E9: AA           TAX 
; start of character loop
02/A2EA: DA           PHX 
02/A2EB: BF C8 A1 02  LDA $02A1C8,X   ; character display order
02/A2EF: A8           TAY 
02/A2F0: B9 C5 29     LDA $29C5,Y
02/A2F3: C9 FF        CMP #$FF
02/A2F5: D0 03        BNE $A2FA
02/A2F7: 4C 7C A3     JMP $A37C
02/A2FA: 98           TYA 
02/A2FB: 0A           ASL 
02/A2FC: 0A           ASL 
02/A2FD: A8           TAY 
02/A2FE: 7B           TDC 
02/A2FF: AA           TAX 
02/A300: B9 15 F0     LDA $F015,Y
02/A303: 3F DE A2 02  AND $02A2DE,X   ; clear status effects that are not shown
02/A307: 95 00        STA $00,X
02/A309: C8           INY 
02/A30A: E8           INX 
02/A30B: E0 04 00     CPX #$0004
02/A30E: D0 F0        BNE $A300
02/A310: 7B           TDC 
02/A311: AA           TAX 
02/A312: 06 03        ASL $03
02/A314: 26 02        ROL $02
02/A316: 26 01        ROL $01
02/A318: 26 00        ROL $00
02/A31A: B0 0B        BCS $A327
02/A31C: E8           INX 
02/A31D: E0 20 00     CPX #$0020
02/A320: D0 F0        BNE $A312
02/A322: A0 00 00     LDY #$0000
02/A325: 80 22        BRA $A349
02/A327: 8A           TXA 
02/A328: 0A           ASL 
02/A329: AA           TAX 
02/A32A: BF 58 A8 0F  LDA $0FA858,X   ; pointers to status names
02/A32E: 85 00        STA $00
02/A330: BF 59 A8 0F  LDA $0FA859,X
02/A334: 85 01        STA $01
02/A336: A9 0F        LDA #$0F
02/A338: 85 02        STA $02
02/A33A: 7B           TDC 
02/A33B: A8           TAY 
02/A33C: B7 00        LDA [$00],Y     ; copy status name to text buffer
02/A33E: F0 09        BEQ $A349
02/A340: 99 FD 74     STA $74FD,Y
02/A343: C8           INY 
02/A344: C0 08 00     CPY #$0008
02/A347: D0 F3        BNE $A33C
02/A349: C0 08 00     CPY #$0008
02/A34C: F0 08        BEQ $A356
02/A34E: A9 FF        LDA #$FF
02/A350: 99 FD 74     STA $74FD,Y
02/A353: C8           INY 
02/A354: 80 F3        BRA $A349
02/A356: 7B           TDC 
02/A357: 99 FD 74     STA $74FD,Y
02/A35A: A2 FD 74     LDX #$74FD
02/A35D: 8E 50 EF     STX $EF50
02/A360: A9 20        LDA #$20
02/A362: 8D 54 EF     STA $EF54
02/A365: A9 20        LDA #$20
02/A367: 8D 55 EF     STA $EF55
02/A36A: 20 55 A4     JSR $A455       ; draw text
02/A36D: C2 20        REP #$20
02/A36F: AD 52 EF     LDA $EF52       ; next character
02/A372: 18           CLC 
02/A373: 69 80 00     ADC #$0080
02/A376: 8D 52 EF     STA $EF52
02/A379: 7B           TDC 
02/A37A: E2 20        SEP #$20
02/A37C: FA           PLX 
02/A37D: E8           INX 
02/A37E: E0 05 00     CPX #$0005
02/A381: F0 03        BEQ $A386
02/A383: 4C EA A2     JMP $A2EA
02/A386: C2 20        REP #$20
02/A388: 7B           TDC 
02/A389: AA           TAX 
02/A38A: BD A6 D6     LDA $D6A6,X     ; tile tile priority
02/A38D: 09 00 20     ORA #$2000
02/A390: 9D A6 D6     STA $D6A6,X
02/A393: E8           INX 
02/A394: E8           INX 
02/A395: E0 40 03     CPX #$0340
02/A398: D0 F0        BNE $A38A
02/A39A: 7B           TDC 
02/A39B: E2 20        SEP #$20
02/A39D: 60           RTS 

; [ battle graphics $0B: draw monster names ]

02/A39E: 7B           TDC 
02/A39F: 20 11 A4     JSR $A411       ; get battle menu text buffer data
02/A3A2: A2 B1 29     LDX #$29B1
02/A3A5: 86 00        STX $00
02/A3A7: A2 CA 29     LDX #$29CA
02/A3AA: 86 08        STX $08
02/A3AC: 7B           TDC 
02/A3AD: AA           TAX 
02/A3AE: A8           TAY 
02/A3AF: A9 04        LDA #$04
02/A3B1: 85 04        STA $04
02/A3B3: 64 06        STZ $06
02/A3B5: B2 00        LDA ($00)
02/A3B7: C9 FF        CMP #$FF
02/A3B9: F0 17        BEQ $A3D2       ; branch if monster type is unused
02/A3BB: B2 08        LDA ($08)
02/A3BD: F0 13        BEQ $A3D2       ; branch if no monsters left
02/A3BF: A9 06        LDA #$06
02/A3C1: 85 02        STA $02
02/A3C3: BF 63 FF 16  LDA $16FF63,X   ; text for monster name and count
02/A3C7: 99 FD 74     STA $74FD,Y
02/A3CA: C8           INY 
02/A3CB: E8           INX 
02/A3CC: C6 02        DEC $02
02/A3CE: D0 F3        BNE $A3C3
02/A3D0: 80 0D        BRA $A3DF
02/A3D2: C2 20        REP #$20
02/A3D4: 8A           TXA 
02/A3D5: 18           CLC 
02/A3D6: 69 06 00     ADC #$0006
02/A3D9: AA           TAX 
02/A3DA: 7B           TDC 
02/A3DB: E2 20        SEP #$20
02/A3DD: E6 06        INC $06
02/A3DF: DA           PHX 
02/A3E0: A6 00        LDX $00
02/A3E2: E8           INX 
02/A3E3: 86 00        STX $00
02/A3E5: A6 08        LDX $08
02/A3E7: E8           INX 
02/A3E8: 86 08        STX $08
02/A3EA: FA           PLX 
02/A3EB: C6 04        DEC $04
02/A3ED: D0 C6        BNE $A3B5
02/A3EF: A5 06        LDA $06
02/A3F1: F0 16        BEQ $A409
02/A3F3: A9 05        LDA #$05
02/A3F5: 99 FD 74     STA $74FD,Y
02/A3F8: C8           INY 
02/A3F9: A9 0A        LDA #$0A
02/A3FB: 99 FD 74     STA $74FD,Y
02/A3FE: C8           INY 
02/A3FF: A9 01        LDA #$01
02/A401: 99 FD 74     STA $74FD,Y
02/A404: C8           INY 
02/A405: C6 06        DEC $06
02/A407: D0 EA        BNE $A3F3
02/A409: 7B           TDC 
02/A40A: 99 FC 74     STA $74FC,Y
02/A40D: 20 55 A4     JSR $A455       ; draw text
02/A410: 60           RTS 

; [ get battle menu text buffer data ]

02/A411: 48           PHA 
02/A412: 85 26        STA $26
02/A414: A9 06        LDA #$06
02/A416: 85 28        STA $28
02/A418: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A41B: A6 2A        LDX $2A
02/A41D: 7B           TDC 
02/A41E: A8           TAY 
02/A41F: BF 43 FF 16  LDA $16FF43,X   ; battle menu text buffer data
02/A423: 99 50 EF     STA $EF50,Y
02/A426: C8           INY 
02/A427: E8           INX 
02/A428: C0 06 00     CPY #$0006
02/A42B: D0 F2        BNE $A41F
02/A42D: 68           PLA 
02/A42E: 60           RTS 

; [ draw battle menu text ]

02/A42F: 20 11 A4     JSR $A411       ; get battle menu text buffer data
02/A432: 0A           ASL 
02/A433: AA           TAX 
02/A434: BF 5B FF 16  LDA $16FF5B,X   ; pointers to battle menu text
02/A438: 85 00        STA $00
02/A43A: BF 5C FF 16  LDA $16FF5C,X
02/A43E: 85 01        STA $01
02/A440: A9 16        LDA #$16
02/A442: 85 02        STA $02
02/A444: 7B           TDC 
02/A445: A8           TAY 
02/A446: B7 00        LDA [$00],Y     ; copy text to buffer
02/A448: 99 FD 74     STA $74FD,Y
02/A44B: C8           INY 
02/A44C: C0 20 00     CPY #$0020
02/A44F: D0 F5        BNE $A446
02/A451: 20 55 A4     JSR $A455       ; draw text
02/A454: 60           RTS 

; [ draw text ]

02/A455: AD 55 EF     LDA $EF55
02/A458: 85 36        STA $36
02/A45A: 0E 54 EF     ASL $EF54
02/A45D: AE 50 EF     LDX $EF50
02/A460: 86 30        STX $30
02/A462: AE 52 EF     LDX $EF52
02/A465: 86 32        STX $32
02/A467: A5 32        LDA $32
02/A469: 18           CLC 
02/A46A: 6D 54 EF     ADC $EF54
02/A46D: 85 34        STA $34
02/A46F: A5 33        LDA $33
02/A471: 69 00        ADC #$00
02/A473: 85 35        STA $35
02/A475: A0 00 00     LDY #$0000
02/A478: B2 30        LDA ($30)
02/A47A: F0 14        BEQ $A490       ; branch if terminator
02/A47C: C9 0F        CMP #$0F
02/A47E: 90 08        BCC $A488
02/A480: 20 97 A4     JSR $A497       ; draw text character
02/A483: 20 91 A4     JSR $A491       ; increment text pointer
02/A486: 80 F0        BRA $A478
; escape codes $01-$0E
02/A488: 20 26 A6     JSR $A626
02/A48B: 20 91 A4     JSR $A491       ; increment text pointer
02/A48E: 80 E8        BRA $A478
02/A490: 60           RTS 

; [ increment text pointer ]

02/A491: A6 30        LDX $30
02/A493: E8           INX 
02/A494: 86 30        STX $30
02/A496: 60           RTS 

; [ draw text character ]

02/A497: C9 42        CMP #$42
02/A499: 90 11        BCC $A4AC       ; branch if dakuten
; fallthrough

; [ draw text character (no dakuten) ]

02/A49B: DA           PHX 
02/A49C: 91 34        STA ($34),Y
02/A49E: A9 FF        LDA #$FF
02/A4A0: 91 32        STA ($32),Y
02/A4A2: C8           INY 
02/A4A3: A5 36        LDA $36         ; tile flags
02/A4A5: 91 32        STA ($32),Y
02/A4A7: 91 34        STA ($34),Y
02/A4A9: C8           INY 
02/A4AA: FA           PLX 
02/A4AB: 60           RTS 
; dakuten
02/A4AC: DA           PHX 
02/A4AD: 38           SEC 
02/A4AE: E9 0F        SBC #$0F
02/A4B0: 0A           ASL 
02/A4B1: AA           TAX 
02/A4B2: BF 40 FA 16  LDA $16FA40,X   ; dakuten
02/A4B6: 91 32        STA ($32),Y
02/A4B8: BF 41 FA 16  LDA $16FA41,X   ; kana
02/A4BC: 91 34        STA ($34),Y
02/A4BE: C8           INY 
02/A4BF: A5 36        LDA $36         ; tile flags
02/A4C1: 91 32        STA ($32),Y
02/A4C3: 91 34        STA ($34),Y
02/A4C5: C8           INY 
02/A4C6: FA           PLX 
02/A4C7: 60           RTS 

; text escape code jump table
02/A4C8: A64E A637 A657 A6A4 A64F A6AC A4E6 A6BD
02/A4D8: A6C3 A6CA A6D1 A6D8 A7AD A782 A77A

; escape code $06: variable
02/A4E6: 20 91 A4     JSR $A491       ; increment text pointer
02/A4E9: B2 30        LDA ($30)
02/A4EB: 30 01        BMI $A4EE
02/A4ED: 60           RTS 
02/A4EE: 29 7F        AND #$7F
02/A4F0: D0 06        BNE $A4F8
02/A4F2: A2 00 00     LDX #$0000
02/A4F5: 4C 03 A6     JMP $A603
02/A4F8: C9 01        CMP #$01
02/A4FA: D0 06        BNE $A502
02/A4FC: A2 03 00     LDX #$0003
02/A4FF: 4C 03 A6     JMP $A603
02/A502: C9 02        CMP #$02
02/A504: D0 03        BNE $A509
02/A506: 4C B6 A5     JMP $A5B6
02/A509: C9 03        CMP #$03
02/A50B: D0 03        BNE $A510
02/A50D: 4C 8F A5     JMP $A58F
02/A510: C9 04        CMP #$04
02/A512: D0 03        BNE $A517
02/A514: 4C 3B A5     JMP $A53B
; 5: status name
02/A517: AD 9A 35     LDA $359A
02/A51A: 0A           ASL 
02/A51B: AA           TAX 
02/A51C: BF 58 A8 0F  LDA $0FA858,X
02/A520: 85 00        STA $00
02/A522: BF 59 A8 0F  LDA $0FA859,X
02/A526: 85 01        STA $01
02/A528: A9 0F        LDA #$0F
02/A52A: 85 02        STA $02
02/A52C: A7 00        LDA [$00]
02/A52E: F0 0A        BEQ $A53A
02/A530: 20 97 A4     JSR $A497       ; draw text character
02/A533: A6 00        LDX $00
02/A535: E8           INX 
02/A536: 86 00        STX $00
02/A538: 80 F2        BRA $A52C
02/A53A: 60           RTS 
; 4: spell name
02/A53B: AD 9A 35     LDA $359A
02/A53E: C9 48        CMP #$48
02/A540: 90 23        BCC $A565
02/A542: 38           SEC 
02/A543: E9 48        SBC #$48
02/A545: 85 26        STA $26
02/A547: A9 08        LDA #$08
02/A549: 85 28        STA $28
02/A54B: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A54E: A6 2A        LDX $2A
02/A550: A9 08        LDA #$08
02/A552: 85 00        STA $00
02/A554: BF B0 8A 0F  LDA $0F8AB0,X
02/A558: C9 FF        CMP #$FF
02/A55A: F0 08        BEQ $A564
02/A55C: 20 97 A4     JSR $A497       ; draw text character
02/A55F: E8           INX 
02/A560: C6 00        DEC $00
02/A562: D0 F0        BNE $A554
02/A564: 60           RTS 
02/A565: 85 26        STA $26
02/A567: A9 06        LDA #$06
02/A569: 85 28        STA $28
02/A56B: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A56E: A0 00 00     LDY #$0000
02/A571: A6 2A        LDX $2A
02/A573: BF 00 89 0F  LDA $0F8900,X
02/A577: 20 9B A4     JSR $A49B       ; draw text character (no dakuten)
02/A57A: A9 05        LDA #$05
02/A57C: 85 00        STA $00
02/A57E: BF 01 89 0F  LDA $0F8901,X
02/A582: C9 FF        CMP #$FF
02/A584: F0 08        BEQ $A58E
02/A586: 20 97 A4     JSR $A497       ; draw text character
02/A589: E8           INX 
02/A58A: C6 00        DEC $00
02/A58C: D0 F0        BNE $A57E
02/A58E: 60           RTS 
; 3: item name
02/A58F: AD 9A 35     LDA $359A
02/A592: 85 26        STA $26
02/A594: A9 09        LDA #$09
02/A596: 85 28        STA $28
02/A598: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A59B: A0 00 00     LDY #$0000
02/A59E: A6 2A        LDX $2A
02/A5A0: E8           INX 
02/A5A1: A9 08        LDA #$08
02/A5A3: 85 00        STA $00
02/A5A5: BF 00 80 0F  LDA $0F8000,X
02/A5A9: C9 FF        CMP #$FF
02/A5AB: F0 08        BEQ $A5B5
02/A5AD: 20 97 A4     JSR $A497       ; draw text character
02/A5B0: E8           INX 
02/A5B1: C6 00        DEC $00
02/A5B3: D0 F0        BNE $A5A5
02/A5B5: 60           RTS 
; 2: character name
02/A5B6: AD 9A 35     LDA $359A
02/A5B9: C2 20        REP #$20
02/A5BB: 0A           ASL 
02/A5BC: 0A           ASL 
02/A5BD: 0A           ASL 
02/A5BE: 0A           ASL 
02/A5BF: 0A           ASL 
02/A5C0: 0A           ASL 
02/A5C1: 0A           ASL 
02/A5C2: AA           TAX 
02/A5C3: 7B           TDC 
02/A5C4: E2 20        SEP #$20
02/A5C6: BD 00 20     LDA $2000,X
02/A5C9: 3A           DEC 
02/A5CA: 29 3F        AND #$3F
02/A5CC: AA           TAX 
02/A5CD: BF 3F FB 16  LDA $16FB3F,X   ; name for each character
02/A5D1: 85 26        STA $26
02/A5D3: A9 06        LDA #$06
02/A5D5: 85 28        STA $28
02/A5D7: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A5DA: A9 06        LDA #$06
02/A5DC: 85 00        STA $00
02/A5DE: A6 2A        LDX $2A
02/A5E0: E8           INX 
02/A5E1: E8           INX 
02/A5E2: E8           INX 
02/A5E3: E8           INX 
02/A5E4: E8           INX 
02/A5E5: BD 00 15     LDA $1500,X
02/A5E8: C9 FF        CMP #$FF
02/A5EA: D0 09        BNE $A5F5
02/A5EC: CA           DEX 
02/A5ED: C6 00        DEC $00
02/A5EF: A5 00        LDA $00
02/A5F1: C9 01        CMP #$01
02/A5F3: D0 F0        BNE $A5E5
02/A5F5: A6 2A        LDX $2A
02/A5F7: BD 00 15     LDA $1500,X
02/A5FA: 20 97 A4     JSR $A497       ; draw text character
02/A5FD: E8           INX 
02/A5FE: C6 00        DEC $00
02/A600: D0 F5        BNE $A5F7
02/A602: 60           RTS 
; 0/1: battle variable
02/A603: BD 9A 35     LDA $359A,X
02/A606: 85 00        STA $00
02/A608: BD 9B 35     LDA $359B,X
02/A60B: 85 01        STA $01
02/A60D: BD 9C 35     LDA $359C,X
02/A610: 85 02        STA $02
02/A612: 22 9C F2 03  JSL $03F29C
02/A616: 20 3B 87     JSR $873B
02/A619: BD AD F4     LDA $F4AD,X
02/A61C: 20 9B A4     JSR $A49B       ; draw text character (no dakuten)
02/A61F: E8           INX 
02/A620: E0 08 00     CPX #$0008
02/A623: D0 F4        BNE $A619
02/A625: 60           RTS 

; [ text escape code ]

02/A626: 0A           ASL 
02/A627: AA           TAX 
02/A628: BF C8 A4 02  LDA $02A4C8,X
02/A62C: 85 00        STA $00
02/A62E: BF C9 A4 02  LDA $02A4C9,X
02/A632: 85 01        STA $01
02/A634: 6C 00 00     JMP ($0000)

; escape code $01: newline
02/A637: AD 54 EF     LDA $EF54
02/A63A: C2 20        REP #$20
02/A63C: 48           PHA 
02/A63D: 0A           ASL 
02/A63E: 18           CLC 
02/A63F: 65 32        ADC $32
02/A641: 85 32        STA $32
02/A643: 68           PLA 
02/A644: 18           CLC 
02/A645: 65 32        ADC $32
02/A647: 85 34        STA $34
02/A649: 7B           TDC 
02/A64A: A8           TAY 
02/A64B: E2 20        SEP #$20
02/A64D: 60           RTS 
; escape code $00: string terminator (unused)
02/A64E: 60           RTS 
; escape code $04: character name (by character id)
02/A64F: 20 91 A4     JSR $A491       ; increment text pointer
02/A652: B2 30        LDA ($30)
02/A654: 4C D1 A5     JMP $A5D1
; escape code $02: character name (by slot)
02/A657: 20 91 A4     JSR $A491       ; increment text pointer
02/A65A: B2 30        LDA ($30)
02/A65C: 48           PHA 
02/A65D: AA           TAX 
02/A65E: BD C5 29     LDA $29C5,X
02/A661: C9 FF        CMP #$FF
02/A663: D0 0D        BNE $A672
02/A665: A2 06 00     LDX #$0006
02/A668: A9 FF        LDA #$FF
02/A66A: 20 97 A4     JSR $A497       ; draw text character
02/A66D: CA           DEX 
02/A66E: D0 F8        BNE $A668
02/A670: 68           PLA 
02/A671: 60           RTS 
02/A672: 68           PLA 
02/A673: C2 20        REP #$20
02/A675: 0A           ASL 
02/A676: 0A           ASL 
02/A677: 0A           ASL 
02/A678: 0A           ASL 
02/A679: 0A           ASL 
02/A67A: 0A           ASL 
02/A67B: 0A           ASL 
02/A67C: AA           TAX 
02/A67D: 7B           TDC 
02/A67E: E2 20        SEP #$20
02/A680: BD 00 20     LDA $2000,X
02/A683: 3A           DEC 
02/A684: 29 3F        AND #$3F
02/A686: AA           TAX 
02/A687: BF 3F FB 16  LDA $16FB3F,X   ; name for each character
02/A68B: 85 26        STA $26
02/A68D: A9 06        LDA #$06
02/A68F: 85 00        STA $00
02/A691: 85 28        STA $28
02/A693: 20 60 85     JSR $8560       ; multiply (8-bit)
02/A696: A6 2A        LDX $2A
02/A698: BD 00 15     LDA $1500,X
02/A69B: 20 97 A4     JSR $A497       ; draw text character
02/A69E: E8           INX 
02/A69F: C6 00        DEC $00
02/A6A1: D0 F5        BNE $A698
02/A6A3: 60           RTS 
; escape code $03: borders and symbols
02/A6A4: 20 91 A4     JSR $A491       ; increment text pointer
02/A6A7: B2 30        LDA ($30)
02/A6A9: 4C 9B A4     JMP $A49B       ; draw text character (no dakuten)
; escape code $05: tab
02/A6AC: 20 91 A4     JSR $A491       ; increment text pointer
02/A6AF: B2 30        LDA ($30)
02/A6B1: 85 00        STA $00
02/A6B3: A9 FF        LDA #$FF
02/A6B5: 20 97 A4     JSR $A497       ; draw text character
02/A6B8: C6 00        DEC $00
02/A6BA: D0 F7        BNE $A6B3
02/A6BC: 60           RTS 
; escape code $07: character 1 variable
02/A6BD: A2 00 00     LDX #$0000
02/A6C0: 7B           TDC 
02/A6C1: 80 1A        BRA $A6DD
; escape code $08: character 2 variable
02/A6C3: A2 80 00     LDX #$0080
02/A6C6: A9 01        LDA #$01
02/A6C8: 80 13        BRA $A6DD
; escape code $09: character 3 variable
02/A6CA: A2 00 01     LDX #$0100
02/A6CD: A9 02        LDA #$02
02/A6CF: 80 0C        BRA $A6DD
; escape code $0A: character 4 variable
02/A6D1: A2 80 01     LDX #$0180
02/A6D4: A9 03        LDA #$03
02/A6D6: 80 05        BRA $A6DD
; escape code $0B: character 5 variable
02/A6D8: A2 00 02     LDX #$0200
02/A6DB: A9 04        LDA #$04
02/A6DD: 86 0A        STX $0A
02/A6DF: 48           PHA 
02/A6E0: 20 91 A4     JSR $A491       ; increment text pointer
02/A6E3: B2 30        LDA ($30)
02/A6E5: D0 04        BNE $A6EB
; 0: character name
02/A6E7: 68           PLA 
02/A6E8: 4C 5C A6     JMP $A65C
02/A6EB: AA           TAX 
02/A6EC: 68           PLA 
02/A6ED: 85 03        STA $03
02/A6EF: 8A           TXA 
02/A6F0: A6 0A        LDX $0A
; 1: current hp
02/A6F2: C9 01        CMP #$01
02/A6F4: D0 07        BNE $A6FD
02/A6F6: 64 02        STZ $02
02/A6F8: A9 07        LDA #$07
02/A6FA: 4C 50 A7     JMP $A750
; 2: max hp
02/A6FD: C9 02        CMP #$02
02/A6FF: D0 07        BNE $A708
02/A701: 64 02        STZ $02
02/A703: A9 09        LDA #$09
02/A705: 4C 50 A7     JMP $A750
; 3: current mp
02/A708: C9 03        CMP #$03
02/A70A: D0 09        BNE $A715
02/A70C: A9 01        LDA #$01
02/A70E: 85 02        STA $02
02/A710: A9 0B        LDA #$0B
02/A712: 4C 34 A7     JMP $A734
; 4: max mp
02/A715: C9 04        CMP #$04
02/A717: D0 09        BNE $A722
02/A719: A9 01        LDA #$01
02/A71B: 85 02        STA $02
02/A71D: A9 0D        LDA #$0D
02/A71F: 4C 34 A7     JMP $A734
; 5: invalid (infinite loop)
02/A722: 4C 22 A7     JMP $A722

; [  ]

02/A725: A9 FF        LDA #$FF
02/A727: 8D 0C 18     STA $180C
02/A72A: 8D 0D 18     STA $180D
02/A72D: 8D 0E 18     STA $180E
02/A730: 8D 0F 18     STA $180F
02/A733: 60           RTS 

; [  ]

02/A734: A6 0A        LDX $0A
02/A736: 20 65 A7     JSR $A765
02/A739: A5 02        LDA $02
02/A73B: AA           TAX 
02/A73C: BD 0C 18     LDA $180C,X
02/A73F: C9 FF        CMP #$FF
02/A741: F0 03        BEQ $A746
02/A743: 18           CLC 
02/A744: 69 6D        ADC #$6D
02/A746: 20 9B A4     JSR $A49B       ; draw text character (no dakuten)
02/A749: E8           INX 
02/A74A: E0 04 00     CPX #$0004
02/A74D: D0 ED        BNE $A73C
02/A74F: 60           RTS 

; [  ]

02/A750: A6 0A        LDX $0A
02/A752: 20 65 A7     JSR $A765
02/A755: A5 02        LDA $02
02/A757: AA           TAX 
02/A758: BD 0C 18     LDA $180C,X
02/A75B: 20 9B A4     JSR $A49B       ; draw text character (no dakuten)
02/A75E: E8           INX 
02/A75F: E0 04 00     CPX #$0004
02/A762: D0 F4        BNE $A758
02/A764: 60           RTS 

; [  ]

02/A765: C2 20        REP #$20
02/A767: 86 00        STX $00
02/A769: 18           CLC 
02/A76A: 65 00        ADC $00
02/A76C: AA           TAX 
02/A76D: BD 00 20     LDA $2000,X     ; get hp/mp value
02/A770: AA           TAX 
02/A771: 7B           TDC 
02/A772: E2 20        SEP #$20
02/A774: 20 BF 86     JSR $86BF       ; convert hex to decimal
02/A777: 4C 16 87     JMP $8716       ; normalize number text

; escape code $0E: change tile flags
02/A77A: 20 91 A4     JSR $A491       ; increment text pointer
02/A77D: B2 30        LDA ($30)
02/A77F: 85 36        STA $36
02/A781: 60           RTS 
; escape code $0D: monster count
02/A782: 20 91 A4     JSR $A491       ; increment text pointer
02/A785: B2 30        LDA ($30)
02/A787: AA           TAX 
02/A788: BD CA 29     LDA $29CA,X
02/A78B: F0 1C        BEQ $A7A9
02/A78D: BD B1 29     LDA $29B1,X
02/A790: C9 FF        CMP #$FF
02/A792: F0 12        BEQ $A7A6
02/A794: BD CA 29     LDA $29CA,X
02/A797: AA           TAX 
02/A798: C9 01        CMP #$01
02/A79A: D0 04        BNE $A7A0
02/A79C: A9 FF        LDA #$FF        ; blank if only 1 monster
02/A79E: 80 06        BRA $A7A6
02/A7A0: 20 BF 86     JSR $86BF       ; convert hex to decimal
02/A7A3: AD 10 18     LDA $1810
02/A7A6: 4C 9B A4     JMP $A49B       ; draw text character (no dakuten)
02/A7A9: 3A           DEC 
02/A7AA: 4C 9B A4     JMP $A49B       ; draw text character (no dakuten)
; escape code $0C: monster name
02/A7AD: 20 91 A4     JSR $A491       ; increment text pointer
02/A7B0: B2 30        LDA ($30)
02/A7B2: AA           TAX 
02/A7B3: BD CA 29     LDA $29CA,X
02/A7B6: F0 07        BEQ $A7BF
02/A7B8: BD B1 29     LDA $29B1,X
02/A7BB: C9 FF        CMP #$FF
02/A7BD: D0 0C        BNE $A7CB
02/A7BF: A2 08 00     LDX #$0008
02/A7C2: A9 FF        LDA #$FF
02/A7C4: 20 9B A4     JSR $A49B       ; draw text character (no dakuten)
02/A7C7: CA           DEX 
02/A7C8: D0 F8        BNE $A7C2
02/A7CA: 60           RTS 
02/A7CB: 48           PHA 
02/A7CC: BD D0 38     LDA $38D0,X
02/A7CF: F0 05        BEQ $A7D6
02/A7D1: 68           PLA 
02/A7D2: A9 DF        LDA #$DF
02/A7D4: 80 01        BRA $A7D7
02/A7D6: 68           PLA 
02/A7D7: C2 20        REP #$20
02/A7D9: 0A           ASL 
02/A7DA: 0A           ASL 
02/A7DB: 0A           ASL 
02/A7DC: AA           TAX 
02/A7DD: 7B           TDC 
02/A7DE: E2 20        SEP #$20
02/A7E0: A9 08        LDA #$08
02/A7E2: 85 00        STA $00
02/A7E4: BF 00 98 0E  LDA $0E9800,X
02/A7E8: 20 97 A4     JSR $A497       ; draw text character
02/A7EB: E8           INX 
02/A7EC: C6 00        DEC $00
02/A7EE: D0 F4        BNE $A7E4
02/A7F0: 60           RTS 

; [  ]

02/A7F1: C2 20        REP #$20
02/A7F3: 8A           TXA 
02/A7F4: A2 00 00     LDX #$0000
02/A7F7: 9D 74 7F     STA $7F74,X
02/A7FA: 88           DEY 
02/A7FB: D0 07        BNE $A804
02/A7FD: 18           CLC 
02/A7FE: 69 04 00     ADC #$0004
02/A801: A0 0C 00     LDY #$000C
02/A804: E8           INX 
02/A805: E8           INX 
02/A806: E8           INX 
02/A807: E8           INX 
02/A808: E0 F0 00     CPX #$00F0
02/A80B: D0 EA        BNE $A7F7
02/A80D: 7B           TDC 
02/A80E: E2 20        SEP #$20
02/A810: 60           RTS 

; [ update hdma data for menu ??? ]

02/A811: AD 20 18     LDA $1820
02/A814: C2 20        REP #$20
02/A816: 0A           ASL 
02/A817: AA           TAX 
02/A818: BF 24 A8 02  LDA $02A824,X
02/A81C: 85 0E        STA $0E
02/A81E: 7B           TDC 
02/A81F: E2 20        SEP #$20
02/A821: 6C 0E 00     JMP ($000E)

; hdma update jump table
02/A824: A82C A8DC A843 A87C

; 0: none
02/A82C: 60           RTS 

02/A82D: AD 73 EF     LDA $EF73
02/A830: D0 10        BNE $A842
02/A832: 9C 6A EF     STZ $EF6A
02/A835: E0 94 00     CPX #$0094
02/A838: 90 05        BCC $A83F
02/A83A: E0 D1 00     CPX #$00D1
02/A83D: 90 03        BCC $A842
02/A83F: EE 6A EF     INC $EF6A
02/A842: 60           RTS 
; 2: scroll menu up ???
02/A843: 20 46 A8     JSR $A846
02/A846: AE 65 EF     LDX $EF65
02/A849: E8           INX 
02/A84A: 8E 65 EF     STX $EF65
02/A84D: AC 67 EF     LDY $EF67
02/A850: 88           DEY 
02/A851: 8C 67 EF     STY $EF67
02/A854: D0 10        BNE $A866
02/A856: A0 0C 00     LDY #$000C
02/A859: 8C 67 EF     STY $EF67
02/A85C: AE 65 EF     LDX $EF65
02/A85F: E8           INX 
02/A860: E8           INX 
02/A861: E8           INX 
02/A862: E8           INX 
02/A863: 8E 65 EF     STX $EF65
02/A866: 20 F1 A7     JSR $A7F1
02/A869: CE 64 EF     DEC $EF64
02/A86C: D0 04        BNE $A872
02/A86E: 9C 20 18     STZ $1820
02/A871: 60           RTS 
02/A872: AE 71 EF     LDX $EF71
02/A875: CA           DEX 
02/A876: 8E 71 EF     STX $EF71
02/A879: 4C 2D A8     JMP $A82D
; 3: scroll menu down ???
02/A87C: 20 7F A8     JSR $A87F
02/A87F: AE 65 EF     LDX $EF65
02/A882: CA           DEX 
02/A883: 8E 65 EF     STX $EF65
02/A886: AC 67 EF     LDY $EF67
02/A889: C8           INY 
02/A88A: 8C 67 EF     STY $EF67
02/A88D: C0 0D 00     CPY #$000D
02/A890: D0 10        BNE $A8A2
02/A892: A0 01 00     LDY #$0001
02/A895: 8C 67 EF     STY $EF67
02/A898: AE 65 EF     LDX $EF65
02/A89B: CA           DEX 
02/A89C: CA           DEX 
02/A89D: CA           DEX 
02/A89E: CA           DEX 
02/A89F: 8E 65 EF     STX $EF65
02/A8A2: 20 F1 A7     JSR $A7F1
02/A8A5: CE 64 EF     DEC $EF64
02/A8A8: D0 04        BNE $A8AE
02/A8AA: 9C 20 18     STZ $1820
02/A8AD: 60           RTS 
02/A8AE: AE 71 EF     LDX $EF71
02/A8B1: E8           INX 
02/A8B2: 8E 71 EF     STX $EF71
02/A8B5: 4C 2D A8     JMP $A82D

; [ scroll menu up ??? ]

02/A8B8: AE 71 EF     LDX $EF71
02/A8BB: CA           DEX 
02/A8BC: 8E 71 EF     STX $EF71
02/A8BF: A9 0C        LDA #$0C
02/A8C1: 8D 64 EF     STA $EF64
02/A8C4: A9 02        LDA #$02
02/A8C6: 8D 20 18     STA $1820
02/A8C9: 60           RTS 

; [ scroll menu down ??? ]

02/A8CA: AE 71 EF     LDX $EF71
02/A8CD: E8           INX 
02/A8CE: 8E 71 EF     STX $EF71
02/A8D1: A9 0C        LDA #$0C
02/A8D3: 8D 64 EF     STA $EF64
02/A8D6: A9 03        LDA #$03
02/A8D8: 8D 20 18     STA $1820
02/A8DB: 60           RTS 

; 1: open/close menu
02/A8DC: AD 1E 18     LDA $181E
02/A8DF: 0D 1F 18     ORA $181F
02/A8E2: D0 08        BNE $A8EC       ; return if there is a pending vram transfer
02/A8E4: AD 44 18     LDA $1844
02/A8E7: F0 04        BEQ $A8ED
02/A8E9: 4C 2D A9     JMP $A92D
02/A8EC: 60           RTS 
; open menu
02/A8ED: C2 20        REP #$20
02/A8EF: AD 3F 18     LDA $183F
02/A8F2: 85 0E        STA $0E
02/A8F4: AD 41 18     LDA $1841
02/A8F7: 85 10        STA $10
02/A8F9: A0 00 00     LDY #$0000
02/A8FC: B1 0E        LDA ($0E),Y     ; swap 32 bytes (8 scanlines)
02/A8FE: 85 12        STA $12
02/A900: B1 10        LDA ($10),Y
02/A902: 91 0E        STA ($0E),Y
02/A904: A5 12        LDA $12
02/A906: 91 10        STA ($10),Y
02/A908: C8           INY 
02/A909: C8           INY 
02/A90A: C0 20 00     CPY #$0020
02/A90D: D0 ED        BNE $A8FC
02/A90F: A5 0E        LDA $0E
02/A911: 18           CLC 
02/A912: 69 20 00     ADC #$0020
02/A915: 8D 3F 18     STA $183F
02/A918: A5 10        LDA $10
02/A91A: 18           CLC 
02/A91B: 69 20 00     ADC #$0020
02/A91E: 8D 41 18     STA $1841
02/A921: 7B           TDC 
02/A922: E2 20        SEP #$20
02/A924: CE 43 18     DEC $1843
02/A927: D0 03        BNE $A92C
02/A929: 9C 20 18     STZ $1820       ; menu is completely open
02/A92C: 60           RTS 
; close menu
02/A92D: C2 20        REP #$20
02/A92F: AD 3F 18     LDA $183F
02/A932: 85 0E        STA $0E
02/A934: AD 41 18     LDA $1841
02/A937: 85 10        STA $10
02/A939: A0 00 00     LDY #$0000
02/A93C: B1 0E        LDA ($0E),Y     ; swap 32 bytes (8 scanlines)
02/A93E: 48           PHA 
02/A93F: B1 10        LDA ($10),Y
02/A941: 91 0E        STA ($0E),Y
02/A943: 68           PLA 
02/A944: 91 10        STA ($10),Y
02/A946: C8           INY 
02/A947: C8           INY 
02/A948: C0 20 00     CPY #$0020
02/A94B: D0 EF        BNE $A93C
02/A94D: A5 0E        LDA $0E
02/A94F: 38           SEC 
02/A950: E9 20 00     SBC #$0020
02/A953: 8D 3F 18     STA $183F
02/A956: A5 10        LDA $10
02/A958: 38           SEC 
02/A959: E9 20 00     SBC #$0020
02/A95C: 8D 41 18     STA $1841
02/A95F: 7B           TDC 
02/A960: E2 20        SEP #$20
02/A962: CE 43 18     DEC $1843
02/A965: D0 03        BNE $A96A
02/A967: 9C 20 18     STZ $1820
02/A96A: 60           RTS 

; [ open/close menu ]

02/A96B: 85 1C        STA $1C
02/A96D: A9 06        LDA #$06
02/A96F: 85 1E        STA $1E
02/A971: 20 D2 85     JSR $85D2       ; hardware multiply
02/A974: A6 20        LDX $20
02/A976: A0 00 00     LDY #$0000
02/A979: BF 69 FE 0D  LDA $0DFE69,X   ; hdma properties
02/A97D: 99 3F 18     STA $183F,Y
02/A980: E8           INX 
02/A981: C8           INY 
02/A982: C0 06 00     CPY #$0006
02/A985: D0 F2        BNE $A979
02/A987: A9 01        LDA #$01
02/A989: 8D 20 18     STA $1820
02/A98C: 60           RTS 

; [  ]

02/A98D: A2 00 00     LDX #$0000
02/A990: 86 5F        STX $5F
02/A992: 8E 85 EF     STX $EF85
02/A995: 64 63        STZ $63
02/A997: A9 80        LDA #$80
02/A999: 04 4A        TSB $4A
02/A99B: A9 08        LDA #$08
02/A99D: 20 6B A9     JSR $A96B       ; open/close menu
02/A9A0: A9 08        LDA #$08        ; mp cost
02/A9A2: 8D 1E 18     STA $181E
02/A9A5: 60           RTS 

02/A9A6: A9 80        LDA #$80
02/A9A8: 14 4A        TRB $4A
02/A9AA: A9 09        LDA #$09
02/A9AC: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9AF: A9 01        LDA #$01
02/A9B1: 04 4B        TSB $4B
02/A9B3: A9 0A        LDA #$0A
02/A9B5: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9B8: A9 01        LDA #$01
02/A9BA: 14 4B        TRB $4B
02/A9BC: A9 0B        LDA #$0B
02/A9BE: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9C1: A9 02        LDA #$02
02/A9C3: 04 4B        TSB $4B
02/A9C5: A9 0C        LDA #$0C
02/A9C7: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9CA: A9 02        LDA #$02
02/A9CC: 14 4B        TRB $4B
02/A9CE: A9 0D        LDA #$0D
02/A9D0: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9D3: A9 04        LDA #$04
02/A9D5: 04 4B        TSB $4B
02/A9D7: A9 0E        LDA #$0E
02/A9D9: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9DC: A9 04        LDA #$04
02/A9DE: 14 4B        TRB $4B
02/A9E0: A9 0F        LDA #$0F
02/A9E2: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9E5: A9 08        LDA #$08
02/A9E7: 04 4B        TSB $4B
02/A9E9: A9 10        LDA #$10
02/A9EB: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9EE: A9 08        LDA #$08
02/A9F0: 14 4B        TRB $4B
02/A9F2: A9 11        LDA #$11
02/A9F4: 4C 6B A9     JMP $A96B       ; open/close menu
02/A9F7: A9 10        LDA #$10
02/A9F9: 04 4B        TSB $4B
02/A9FB: A9 12        LDA #$12
02/A9FD: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA00: A9 10        LDA #$10
02/AA02: 14 4B        TRB $4B
02/AA04: A9 13        LDA #$13
02/AA06: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA09: A9 01        LDA #$01
02/AA0B: 04 4C        TSB $4C
02/AA0D: A9 14        LDA #$14
02/AA0F: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA12: A9 01        LDA #$01
02/AA14: 14 4C        TRB $4C
02/AA16: A9 15        LDA #$15
02/AA18: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA1B: A9 02        LDA #$02
02/AA1D: 04 4C        TSB $4C
02/AA1F: A9 16        LDA #$16
02/AA21: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA24: A9 02        LDA #$02
02/AA26: 14 4C        TRB $4C
02/AA28: A9 17        LDA #$17
02/AA2A: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA2D: A9 04        LDA #$04
02/AA2F: 04 4C        TSB $4C
02/AA31: A9 18        LDA #$18
02/AA33: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA36: A9 04        LDA #$04
02/AA38: 14 4C        TRB $4C
02/AA3A: A9 19        LDA #$19
02/AA3C: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA3F: A9 08        LDA #$08
02/AA41: 04 4C        TSB $4C
02/AA43: A9 1A        LDA #$1A
02/AA45: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA48: A9 08        LDA #$08
02/AA4A: 14 4C        TRB $4C
02/AA4C: A9 1B        LDA #$1B
02/AA4E: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA51: A9 10        LDA #$10
02/AA53: 04 4C        TSB $4C
02/AA55: A9 1C        LDA #$1C
02/AA57: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA5A: A9 10        LDA #$10
02/AA5C: 14 4C        TRB $4C
02/AA5E: A9 1D        LDA #$1D
02/AA60: 4C 6B A9     JMP $A96B       ; open/close menu
02/AA63: A9 01        LDA #$01
02/AA65: 04 4A        TSB $4A
02/AA67: 7B           TDC 
02/AA68: 20 6B A9     JSR $A96B       ; open/close menu
02/AA6B: A9 02        LDA #$02        ; main menu
02/AA6D: 8D 1E 18     STA $181E
02/AA70: 60           RTS 
02/AA71: A9 01        LDA #$01
02/AA73: 14 4A        TRB $4A
02/AA75: A9 01        LDA #$01
02/AA77: 4C 6B A9     JMP $A96B       ; open/close menu

02/AA7A: A2 00 00     LDX #$0000
02/AA7D: 86 5F        STX $5F
02/AA7F: A9 02        LDA #$02
02/AA81: 04 4A        TSB $4A
02/AA83: A9 02        LDA #$02
02/AA85: 20 6B A9     JSR $A96B       ; open/close menu
02/AA88: A9 03        LDA #$03        ; battle command list
02/AA8A: 8D 1E 18     STA $181E
02/AA8D: AD BD 38     LDA $38BD
02/AA90: D0 17        BNE $AAA9
02/AA92: AD 22 18     LDA $1822
02/AA95: AA           TAX 
02/AA96: BF B9 16 00  LDA $0016B9,X
02/AA9A: F0 04        BEQ $AAA0
02/AA9C: A9 19        LDA #$19
02/AA9E: 80 02        BRA $AAA2
02/AAA0: A9 18        LDA #$18
02/AAA2: 8D 00 1E     STA $1E00
02/AAA5: 22 04 80 04  JSL $048004     ; execute sound command
02/AAA9: A9 01        LDA #$01
02/AAAB: 8D 23 18     STA $1823
02/AAAE: 60           RTS 

; [  ]

02/AAAF: A9 02        LDA #$02
02/AAB1: 14 4A        TRB $4A
02/AAB3: A9 03        LDA #$03
02/AAB5: 4C 6B A9     JMP $A96B       ; open/close menu

; [  ]

02/AAB8: A2 73 01     LDX #$0173
02/AABB: 8E 65 EF     STX $EF65
02/AABE: A0 0C 00     LDY #$000C
02/AAC1: 8C 67 EF     STY $EF67
02/AAC4: C2 20        REP #$20
02/AAC6: 8A           TXA 
02/AAC7: A2 00 00     LDX #$0000
02/AACA: 9D F4 81     STA $81F4,X
02/AACD: 88           DEY 
02/AACE: D0 07        BNE $AAD7
02/AAD0: 18           CLC 
02/AAD1: 69 04 00     ADC #$0004
02/AAD4: A0 0C 00     LDY #$000C
02/AAD7: E8           INX 
02/AAD8: E8           INX 
02/AAD9: E8           INX 
02/AADA: E8           INX 
02/AADB: E0 F0 00     CPX #$00F0
02/AADE: D0 EA        BNE $AACA
02/AAE0: 7B           TDC 
02/AAE1: E2 20        SEP #$20
02/AAE3: 60           RTS 

; [  ]

02/AAE4: 9C 75 EF     STZ $EF75
02/AAE7: 20 B8 AA     JSR $AAB8
02/AAEA: A2 00 00     LDX #$0000
02/AAED: 86 5F        STX $5F
02/AAEF: 8E 85 EF     STX $EF85
02/AAF2: 64 63        STZ $63
02/AAF4: A9 04        LDA #$04
02/AAF6: 04 4A        TSB $4A
02/AAF8: A9 04        LDA #$04
02/AAFA: 20 6B A9     JSR $A96B       ; open/close menu
02/AAFD: A9 07        LDA #$07        ; inventory
02/AAFF: 8D 1E 18     STA $181E
02/AB02: 4C 20 AB     JMP $AB20

; [ pause battle (delay mode) ]

02/AB05: AD BE 16     LDA $16BE
02/AB08: C9 02        CMP #$02
02/AB0A: D0 05        BNE $AB11
02/AB0C: A9 09        LDA #$09        ; wait 9 frames, then pause battle
02/AB0E: 8D AC F4     STA $F4AC
02/AB11: 60           RTS 

; [ unpause battle (delay mode) ]

02/AB12: AD BE 16     LDA $16BE
02/AB15: C9 02        CMP #$02
02/AB17: D0 06        BNE $AB1F
02/AB19: 9C AC F4     STZ $F4AC
02/AB1C: 9C DA 38     STZ $38DA
02/AB1F: 60           RTS 

; [ pause battle (wait mode) ]

02/AB20: AD BE 16     LDA $16BE
02/AB23: D0 03        BNE $AB28
02/AB25: EE DA 38     INC $38DA
02/AB28: 60           RTS 

; [ unpause battle (wait mode) ]

02/AB29: AD BE 16     LDA $16BE
02/AB2C: D0 03        BNE $AB31
02/AB2E: 9C DA 38     STZ $38DA
02/AB31: 60           RTS 

; [  ]

02/AB32: A9 04        LDA #$04
02/AB34: 14 4A        TRB $4A
02/AB36: 20 29 AB     JSR $AB29
02/AB39: A9 05        LDA #$05
02/AB3B: 4C 6B A9     JMP $A96B       ; open/close menu

; [  ]

02/AB3E: A9 08        LDA #$08
02/AB40: 04 4A        TSB $4A
02/AB42: A9 06        LDA #$06
02/AB44: 20 6B A9     JSR $A96B       ; open/close menu
02/AB47: A9 09        LDA #$09        ; equipped items
02/AB49: 8D 1E 18     STA $181E
02/AB4C: 60           RTS 
02/AB4D: 9C 74 EF     STZ $EF74
02/AB50: A9 08        LDA #$08
02/AB52: 14 4A        TRB $4A
02/AB54: A9 07        LDA #$07
02/AB56: 4C 6B A9     JMP $A96B       ; open/close menu
02/AB59: 20 B8 AA     JSR $AAB8
02/AB5C: A9 10        LDA #$10
02/AB5E: 04 4A        TSB $4A
02/AB60: A9 04        LDA #$04
02/AB62: 20 6B A9     JSR $A96B       ; open/close menu
02/AB65: A9 04        LDA #$04        ; white magic spell list
02/AB67: 8D 1E 18     STA $181E
02/AB6A: 4C 20 AB     JMP $AB20
02/AB6D: A9 10        LDA #$10
02/AB6F: 14 4A        TRB $4A
02/AB71: 20 29 AB     JSR $AB29
02/AB74: A9 05        LDA #$05
02/AB76: 4C 6B A9     JMP $A96B       ; open/close menu
02/AB79: 20 B8 AA     JSR $AAB8
02/AB7C: A9 20        LDA #$20
02/AB7E: 04 4A        TSB $4A
02/AB80: A9 04        LDA #$04
02/AB82: 20 6B A9     JSR $A96B       ; open/close menu
02/AB85: A9 05        LDA #$05        ; black magic/ninjutsu spell list
02/AB87: 8D 1E 18     STA $181E
02/AB8A: 20 20 AB     JSR $AB20
02/AB8D: 60           RTS 
02/AB8E: A9 20        LDA #$20
02/AB90: 14 4A        TRB $4A
02/AB92: 20 29 AB     JSR $AB29
02/AB95: A9 05        LDA #$05
02/AB97: 4C 6B A9     JMP $A96B       ; open/close menu
02/AB9A: 20 B8 AA     JSR $AAB8
02/AB9D: A9 40        LDA #$40
02/AB9F: 04 4A        TSB $4A
02/ABA1: A9 04        LDA #$04
02/ABA3: 20 6B A9     JSR $A96B       ; open/close menu
02/ABA6: A9 06        LDA #$06        ; summon spell list
02/ABA8: 8D 1E 18     STA $181E
02/ABAB: 4C 20 AB     JMP $AB20
02/ABAE: A9 40        LDA #$40
02/ABB0: 14 4A        TRB $4A
02/ABB2: 20 29 AB     JSR $AB29
02/ABB5: A9 05        LDA #$05
02/ABB7: 4C 6B A9     JMP $A96B       ; open/close menu

; [  ]

02/ABBA: A9 80        LDA #$80
02/ABBC: 04 4D        TSB $4D
02/ABBE: A9 1E        LDA #$1E
02/ABC0: 20 6B A9     JSR $A96B       ; open/close menu
02/ABC3: A9 0C        LDA #$0C        ; status window
02/ABC5: 8D 1E 18     STA $181E
02/ABC8: 60           RTS 

; [  ]

02/ABC9: A9 80        LDA #$80
02/ABCB: 14 4D        TRB $4D
02/ABCD: A9 1F        LDA #$1F
02/ABCF: 4C 6B A9     JMP $A96B       ; open/close menu

; [ battle graphics $01: close menu ]

02/ABD2: A9 01        LDA #$01
02/ABD4: 8D AE F0     STA $F0AE
02/ABD7: A9 02        LDA #$02
02/ABD9: 8D B4 F0     STA $F0B4
02/ABDC: 60           RTS 

; [ battle graphics $00: open menu ]

02/ABDD: A9 01        LDA #$01
02/ABDF: 85 D7        STA $D7
02/ABE1: 20 0C A2     JSR $A20C       ; draw character names
02/ABE4: 9C AE F0     STZ $F0AE
02/ABE7: AD 22 18     LDA $1822
02/ABEA: AA           TAX 
02/ABEB: 9E 99 F0     STZ $F099,X
02/ABEE: A9 01        LDA #$01
02/ABF0: 8D B4 F0     STA $F0B4
02/ABF3: 60           RTS 

; [  ]

02/ABF4: AD 1E 18     LDA $181E
02/ABF7: 0D 1F 18     ORA $181F
02/ABFA: 0D 20 18     ORA $1820
02/ABFD: F0 01        BEQ $AC00
02/ABFF: 60           RTS 
02/AC00: AD B4 F0     LDA $F0B4
02/AC03: 0A           ASL 
02/AC04: AA           TAX 
02/AC05: BF 17 AC 02  LDA $02AC17,X
02/AC09: 85 0E        STA $0E
02/AC0B: BF 18 AC 02  LDA $02AC18,X
02/AC0F: 85 0F        STA $0F
02/AC11: 9C B4 F0     STZ $F0B4
02/AC14: 6C 0E 00     JMP ($000E)

02/AC17: AC22 AA7A AC1D

02/AC1D: A9 08        LDA #$08
02/AC1F: 8D 23 18     STA $1823
02/AC22: 60           RTS 

; [ update cursor ]

02/AC23: 20 F4 AB     JSR $ABF4
02/AC26: AD AC F4     LDA $F4AC
02/AC29: F0 08        BEQ $AC33
02/AC2B: CE AC F4     DEC $F4AC
02/AC2E: D0 03        BNE $AC33
02/AC30: EE DA 38     INC $38DA
02/AC33: AD 1E 18     LDA $181E
02/AC36: 0D 1F 18     ORA $181F
02/AC39: 0D 20 18     ORA $1820
02/AC3C: D0 16        BNE $AC54
02/AC3E: AD 23 18     LDA $1823
02/AC41: 0A           ASL 
02/AC42: AA           TAX 
02/AC43: BF 55 AC 02  LDA $02AC55,X
02/AC47: 8D 0E 00     STA $000E
02/AC4A: BF 56 AC 02  LDA $02AC56,X
02/AC4E: 8D 0F 00     STA $000F
02/AC51: 6C 0E 00     JMP ($000E)
02/AC54: 60           RTS 

; cursor update jump table
02/AC55: B8A1 B925 B8DD B8AE B056 B4CE B6F1 B056
02/AC65: B18F B167 B170 B302 B056 AC80 AC89 AC77
02/AC75: AC92

; $0F:
02/AC77: 20 BA AB     JSR $ABBA
02/AC7A: A9 0C        LDA #$0C
02/AC7C: 8D 23 18     STA $1823
02/AC7F: 60           RTS 
; $0D: 
02/AC80: 20 32 AB     JSR $AB32
02/AC83: A9 01        LDA #$01
02/AC85: 8D 23 18     STA $1823
02/AC88: 60           RTS 
; $0E: 
02/AC89: 20 C9 AB     JSR $ABC9
02/AC8C: A9 06        LDA #$06
02/AC8E: 8D 23 18     STA $1823
02/AC91: 60           RTS 
; $10: 
02/AC92: 20 C9 AB     JSR $ABC9
02/AC95: A9 05        LDA #$05
02/AC97: 8D 23 18     STA $1823
02/AC9A: 60           RTS 

; [  ]

02/AC9B: A2 00 00     LDX #$0000
02/AC9E: DF 7E FC 16  CMP $16FC7E,X   ; bit masks
02/ACA2: F0 09        BEQ $ACAD
02/ACA4: E8           INX 
02/ACA5: E0 08 00     CPX #$0008
02/ACA8: D0 F4        BNE $AC9E
02/ACAA: A9 FF        LDA #$FF
02/ACAC: 60           RTS 
02/ACAD: 8A           TXA 
02/ACAE: 60           RTS 

; [  ]

02/ACAF: A2 01 01     LDX #$0101
02/ACB2: 8E 76 EF     STX $EF76
02/ACB5: 8E 78 EF     STX $EF78
02/ACB8: AD 8B EF     LDA $EF8B
02/ACBB: F0 70        BEQ $AD2D
02/ACBD: A9 80        LDA #$80
02/ACBF: 8D 7A EF     STA $EF7A
02/ACC2: 8D 7C EF     STA $EF7C
02/ACC5: 8D 7E EF     STA $EF7E
02/ACC8: 8D 80 EF     STA $EF80
02/ACCB: A0 00 00     LDY #$0000
02/ACCE: AD 8F EF     LDA $EF8F
02/ACD1: 85 0E        STA $0E
02/ACD3: F0 59        BEQ $AD2E
02/ACD5: 20 9B AC     JSR $AC9B
02/ACD8: C9 FF        CMP #$FF
02/ACDA: F0 13        BEQ $ACEF
02/ACDC: 0A           ASL 
02/ACDD: A8           TAY 
02/ACDE: B9 E3 6C     LDA $6CE3,Y
02/ACE1: 8D 7A EF     STA $EF7A
02/ACE4: B9 E4 6C     LDA $6CE4,Y
02/ACE7: 8D 7B EF     STA $EF7B
02/ACEA: 7B           TDC 
02/ACEB: 8D 76 EF     STA $EF76
02/ACEE: 60           RTS 
02/ACEF: AD 13 18     LDA $1813
02/ACF2: 29 01        AND #$01
02/ACF4: F0 0C        BEQ $AD02
02/ACF6: A0 08 00     LDY #$0008
02/ACF9: AD 8F EF     LDA $EF8F
02/ACFC: 0A           ASL 
02/ACFD: 0A           ASL 
02/ACFE: 0A           ASL 
02/ACFF: 0A           ASL 
02/AD00: 85 0E        STA $0E
02/AD02: A2 00 00     LDX #$0000
02/AD05: 06 0E        ASL $0E
02/AD07: 90 17        BCC $AD20
02/AD09: 7B           TDC 
02/AD0A: 9D 76 EF     STA $EF76,X
02/AD0D: DA           PHX 
02/AD0E: 8A           TXA 
02/AD0F: 0A           ASL 
02/AD10: AA           TAX 
02/AD11: B9 E3 6C     LDA $6CE3,Y
02/AD14: 9D 7A EF     STA $EF7A,X
02/AD17: B9 E4 6C     LDA $6CE4,Y
02/AD1A: 9D 7B EF     STA $EF7B,X
02/AD1D: FA           PLX 
02/AD1E: 80 05        BRA $AD25
02/AD20: A9 01        LDA #$01
02/AD22: 9D 76 EF     STA $EF76,X
02/AD25: C8           INY 
02/AD26: C8           INY 
02/AD27: E8           INX 
02/AD28: E0 04 00     CPX #$0004
02/AD2B: D0 D8        BNE $AD05
02/AD2D: 60           RTS 
02/AD2E: AD 90 EF     LDA $EF90
02/AD31: 85 0E        STA $0E
02/AD33: 20 9B AC     JSR $AC9B
02/AD36: C9 FF        CMP #$FF
02/AD38: F0 13        BEQ $AD4D
02/AD3A: 0A           ASL 
02/AD3B: A8           TAY 
02/AD3C: B9 F3 6C     LDA $6CF3,Y
02/AD3F: 8D 7A EF     STA $EF7A
02/AD42: B9 F4 6C     LDA $6CF4,Y
02/AD45: 8D 7B EF     STA $EF7B
02/AD48: 7B           TDC 
02/AD49: 8D 76 EF     STA $EF76
02/AD4C: 60           RTS 
02/AD4D: AD 13 18     LDA $1813
02/AD50: 29 01        AND #$01
02/AD52: F0 0B        BEQ $AD5F
02/AD54: A0 06 00     LDY #$0006
02/AD57: AD 90 EF     LDA $EF90
02/AD5A: 0A           ASL 
02/AD5B: 0A           ASL 
02/AD5C: 0A           ASL 
02/AD5D: 85 0E        STA $0E
02/AD5F: A2 00 00     LDX #$0000
02/AD62: 06 0E        ASL $0E
02/AD64: 90 17        BCC $AD7D
02/AD66: 7B           TDC 
02/AD67: 9D 76 EF     STA $EF76,X
02/AD6A: DA           PHX 
02/AD6B: 8A           TXA 
02/AD6C: 0A           ASL 
02/AD6D: AA           TAX 
02/AD6E: B9 F3 6C     LDA $6CF3,Y
02/AD71: 9D 7A EF     STA $EF7A,X
02/AD74: B9 F4 6C     LDA $6CF4,Y
02/AD77: 9D 7B EF     STA $EF7B,X
02/AD7A: FA           PLX 
02/AD7B: 80 05        BRA $AD82
02/AD7D: A9 01        LDA #$01
02/AD7F: 9D 76 EF     STA $EF76,X
02/AD82: C8           INY 
02/AD83: C8           INY 
02/AD84: E8           INX 
02/AD85: E0 03 00     CPX #$0003
02/AD88: D0 D8        BNE $AD62
02/AD8A: 60           RTS 

; [ select default target ]

; A: -eas---- targeting flags
;      e: target monsters by default
;      a: can target all
;      s: target selectable

02/AD8B: 29 F0        AND #$F0
02/AD8D: 8D 8C EF     STA $EF8C
02/AD90: 29 40        AND #$40
02/AD92: F0 2A        BEQ $ADBE       ; branch if target characters by default
; monster default
02/AD94: A5 0E        LDA $0E
02/AD96: F0 05        BEQ $AD9D
02/AD98: A2 33 F3     LDX #$F333
02/AD9B: 80 03        BRA $ADA0
02/AD9D: A2 3B F3     LDX #$F33B
02/ADA0: 86 0E        STX $0E
02/ADA2: A0 00 00     LDY #$0000
02/ADA5: B1 0E        LDA ($0E),Y
02/ADA7: AA           TAX 
02/ADA8: BD 23 F1     LDA $F123,X
02/ADAB: C9 FF        CMP #$FF
02/ADAD: D0 08        BNE $ADB7
02/ADAF: C8           INY             ; try next monster
02/ADB0: C0 08 00     CPY #$0008
02/ADB3: D0 F0        BNE $ADA5
02/ADB5: 80 07        BRA $ADBE       ; no valid monsters, try characters
02/ADB7: B1 0E        LDA ($0E),Y
02/ADB9: 8D 8D EF     STA $EF8D       ; cursor on first valid monster
02/ADBC: 80 3B        BRA $ADF9
; character default
02/ADBE: A9 08        LDA #$08        ; cursor on first character
02/ADC0: 8D 8D EF     STA $EF8D
02/ADC3: A2 00 00     LDX #$0000
02/ADC6: BF 4C FC 16  LDA $16FC4C,X
02/ADCA: A8           TAY 
02/ADCB: B9 BC F2     LDA $F2BC,Y
02/ADCE: D0 0C        BNE $ADDC       ; branch if character can't be selected
02/ADD0: B9 C1 F2     LDA $F2C1,Y
02/ADD3: D0 07        BNE $ADDC       ; branch if character name and hp hidden
02/ADD5: B9 C5 29     LDA $29C5,Y
02/ADD8: C9 FF        CMP #$FF
02/ADDA: D0 1D        BNE $ADF9
02/ADDC: EE 8D EF     INC $EF8D       ; try next character
02/ADDF: E8           INX 
02/ADE0: E0 05 00     CPX #$0005
02/ADE3: D0 E1        BNE $ADC6
02/ADE5: A2 00 00     LDX #$0000
02/ADE8: BD 23 F1     LDA $F123,X
02/ADEB: C9 FF        CMP #$FF
02/ADED: D0 07        BNE $ADF6
02/ADEF: E8           INX 
02/ADF0: E0 08 00     CPX #$0008
02/ADF3: D0 F3        BNE $ADE8
02/ADF5: 60           RTS 
02/ADF6: 4C 94 AD     JMP $AD94
02/ADF9: AD 8C EF     LDA $EF8C
02/ADFC: 29 20        AND #$20
02/ADFE: F0 04        BEQ $AE04       ; branch if can't target all
02/AE00: A9 01        LDA #$01
02/AE02: 80 01        BRA $AE05
02/AE04: 7B           TDC 
02/AE05: 8D 8E EF     STA $EF8E
02/AE08: 9C 8B EF     STZ $EF8B
02/AE0B: 9C 8F EF     STZ $EF8F
02/AE0E: 9C 90 EF     STZ $EF90
02/AE11: AD 8C EF     LDA $EF8C
02/AE14: 29 70        AND #$70
02/AE16: C9 60        CMP #$60
02/AE18: F0 09        BEQ $AE23
02/AE1A: C9 20        CMP #$20
02/AE1C: D0 0A        BNE $AE28
02/AE1E: A9 0D        LDA #$0D        ; $20: target all characters
02/AE20: 4C 25 AE     JMP $AE25
02/AE23: A9 FF        LDA #$FF        ; $60: target all monsters
02/AE25: 8D 8D EF     STA $EF8D
02/AE28: 60           RTS 

; [ update target cursor ]

02/AE29: AD C0 6C     LDA $6CC0
02/AE2C: F0 13        BEQ $AE41       ; branch if not back attack
02/AE2E: A5 38        LDA $38
02/AE30: 29 03        AND #$03
02/AE32: AA           TAX 
02/AE33: BF 5D FE 0D  LDA $0DFE5D,X   ; swap left and right buttons
02/AE37: 85 1C        STA $1C
02/AE39: A5 38        LDA $38
02/AE3B: 29 FC        AND #$FC
02/AE3D: 05 1C        ORA $1C
02/AE3F: 80 02        BRA $AE43
02/AE41: A5 38        LDA $38
02/AE43: 85 1C        STA $1C
02/AE45: 29 0F        AND #$0F        ; mask direction buttons
02/AE47: 0A           ASL 
02/AE48: AA           TAX 
02/AE49: BF 5D AE 02  LDA $02AE5D,X   ; direction button jump table
02/AE4D: 85 12        STA $12
02/AE4F: BF 5E AE 02  LDA $02AE5E,X
02/AE53: 85 13        STA $13
02/AE55: 64 14        STZ $14
02/AE57: 4C 5A AE     JMP $AE5A
02/AE5A: 6C 12 00     JMP ($0012)

; direction button jump table for target cursor (----udlr)
02/AE5D: AE7D AFE0 AF72 AE7D AE7E B053 B050 AE7E
02/AE6D: AEF4 B053 B050 AEF4 AE7D AFE0 AF72 AE7D

; no direction
02/AE7D: 60
; down
02/AE7E: AD 8D EF     LDA $EF8D
02/AE81: C9 FF        CMP #$FF
02/AE83: F0 6E        BEQ $AEF3       ; return if all monsters are selected
02/AE85: C9 0D        CMP #$0D
02/AE87: F0 6A        BEQ $AEF3       ; return if all characters are selected
02/AE89: AD 8D EF     LDA $EF8D
02/AE8C: 85 0E        STA $0E         ; save previous selection
02/AE8E: C9 08        CMP #$08
02/AE90: 90 2B        BCC $AEBD       ; branch if a single monster is selected
02/AE92: A5 0E        LDA $0E
02/AE94: 0A           ASL 
02/AE95: AA           TAX 
02/AE96: BD CF 29     LDA $29CF,X     ; character cursor data
02/AE99: 29 0F        AND #$0F
02/AE9B: C9 0F        CMP #$0F
02/AE9D: D0 01        BNE $AEA0       ; branch if not the lowest target
02/AE9F: 60           RTS 
02/AEA0: 85 0E        STA $0E
02/AEA2: 38           SEC 
02/AEA3: E9 08        SBC #$08
02/AEA5: AA           TAX 
02/AEA6: BD BC F2     LDA $F2BC,X
02/AEA9: D0 E7        BNE $AE92
02/AEAB: BD C1 F2     LDA $F2C1,X
02/AEAE: D0 E2        BNE $AE92
02/AEB0: BD C5 29     LDA $29C5,X
02/AEB3: C9 FF        CMP #$FF
02/AEB5: F0 DB        BEQ $AE92
02/AEB7: A5 0E        LDA $0E
02/AEB9: 8D 8D EF     STA $EF8D       ; set new single character target
02/AEBC: 60           RTS 
02/AEBD: A5 0E        LDA $0E
02/AEBF: 0A           ASL 
02/AEC0: AA           TAX 
02/AEC1: BD CF 29     LDA $29CF,X     ; monster cursor data
02/AEC4: 29 0F        AND #$0F
02/AEC6: C9 0F        CMP #$0F
02/AEC8: D0 1A        BNE $AEE4       ; branch if not the lowest target
02/AECA: A2 00 00     LDX #$0000
02/AECD: BD 4B F3     LDA $F34B,X
02/AED0: A8           TAY 
02/AED1: B9 23 F1     LDA $F123,Y
02/AED4: C9 FF        CMP #$FF
02/AED6: D0 07        BNE $AEDF
02/AED8: E8           INX 
02/AED9: E0 08 00     CPX #$0008
02/AEDC: D0 EF        BNE $AECD
02/AEDE: 60           RTS 
02/AEDF: 98           TYA 
02/AEE0: 8D 8D EF     STA $EF8D
02/AEE3: 60           RTS 
02/AEE4: 85 0E        STA $0E
02/AEE6: AA           TAX 
02/AEE7: BD 23 F1     LDA $F123,X
02/AEEA: C9 FF        CMP #$FF
02/AEEC: F0 CF        BEQ $AEBD
02/AEEE: A5 0E        LDA $0E
02/AEF0: 8D 8D EF     STA $EF8D       ; set new single monster target
02/AEF3: 60           RTS 
; up
02/AEF4: AD 8D EF     LDA $EF8D
02/AEF7: C9 FF        CMP #$FF
02/AEF9: F0 76        BEQ $AF71
02/AEFB: C9 0D        CMP #$0D
02/AEFD: F0 72        BEQ $AF71
02/AEFF: AD 8D EF     LDA $EF8D
02/AF02: 85 0E        STA $0E
02/AF04: C9 08        CMP #$08
02/AF06: 90 2F        BCC $AF37
02/AF08: A5 0E        LDA $0E
02/AF0A: 0A           ASL 
02/AF0B: AA           TAX 
02/AF0C: BD CF 29     LDA $29CF,X
02/AF0F: 29 F0        AND #$F0
02/AF11: C9 F0        CMP #$F0
02/AF13: D0 01        BNE $AF16
02/AF15: 60           RTS 
02/AF16: 4A           LSR 
02/AF17: 4A           LSR 
02/AF18: 4A           LSR 
02/AF19: 4A           LSR 
02/AF1A: 85 0E        STA $0E
02/AF1C: 38           SEC 
02/AF1D: E9 08        SBC #$08
02/AF1F: AA           TAX 
02/AF20: BD BC F2     LDA $F2BC,X
02/AF23: D0 E3        BNE $AF08
02/AF25: BD C1 F2     LDA $F2C1,X
02/AF28: D0 DE        BNE $AF08
02/AF2A: BD C5 29     LDA $29C5,X
02/AF2D: C9 FF        CMP #$FF
02/AF2F: F0 D7        BEQ $AF08
02/AF31: A5 0E        LDA $0E
02/AF33: 8D 8D EF     STA $EF8D
02/AF36: 60           RTS 
02/AF37: A5 0E        LDA $0E
02/AF39: 0A           ASL 
02/AF3A: AA           TAX 
02/AF3B: BD CF 29     LDA $29CF,X
02/AF3E: 29 F0        AND #$F0
02/AF40: C9 F0        CMP #$F0
02/AF42: D0 1A        BNE $AF5E
02/AF44: A2 00 00     LDX #$0000
02/AF47: BD 43 F3     LDA $F343,X
02/AF4A: A8           TAY 
02/AF4B: B9 23 F1     LDA $F123,Y
02/AF4E: C9 FF        CMP #$FF
02/AF50: D0 07        BNE $AF59
02/AF52: E8           INX 
02/AF53: E0 08 00     CPX #$0008
02/AF56: D0 EF        BNE $AF47
02/AF58: 60           RTS 
02/AF59: 98           TYA 
02/AF5A: 8D 8D EF     STA $EF8D
02/AF5D: 60           RTS 
02/AF5E: 4A           LSR 
02/AF5F: 4A           LSR 
02/AF60: 4A           LSR 
02/AF61: 4A           LSR 
02/AF62: 85 0E        STA $0E
02/AF64: AA           TAX 
02/AF65: BD 23 F1     LDA $F123,X
02/AF68: C9 FF        CMP #$FF
02/AF6A: F0 CB        BEQ $AF37
02/AF6C: A5 0E        LDA $0E
02/AF6E: 8D 8D EF     STA $EF8D
02/AF71: 60           RTS 
; left (forward)
02/AF72: AD 8D EF     LDA $EF8D
02/AF75: C9 FF        CMP #$FF
02/AF77: F0 66        BEQ $AFDF
02/AF79: AD 8D EF     LDA $EF8D
02/AF7C: 85 0E        STA $0E
02/AF7E: C9 08        CMP #$08
02/AF80: 90 2D        BCC $AFAF
02/AF82: C9 0D        CMP #$0D
02/AF84: D0 07        BNE $AF8D
02/AF86: AD 31 F3     LDA $F331
02/AF89: 8D 8D EF     STA $EF8D
02/AF8C: 60           RTS 
02/AF8D: A2 00 00     LDX #$0000
02/AF90: BD 33 F3     LDA $F333,X
02/AF93: A8           TAY 
02/AF94: B9 23 F1     LDA $F123,Y
02/AF97: C9 FF        CMP #$FF
02/AF99: D0 0D        BNE $AFA8
02/AF9B: E8           INX 
02/AF9C: E0 08 00     CPX #$0008
02/AF9F: D0 EF        BNE $AF90
02/AFA1: A5 38        LDA $38
02/AFA3: 09 80        ORA #$80
02/AFA5: 85 38        STA $38
02/AFA7: 60           RTS 
02/AFA8: BD 33 F3     LDA $F333,X
02/AFAB: 8D 8D EF     STA $EF8D
02/AFAE: 60           RTS 
02/AFAF: A5 0E        LDA $0E
02/AFB1: 0A           ASL 
02/AFB2: AA           TAX 
02/AFB3: BD D0 29     LDA $29D0,X
02/AFB6: 29 F0        AND #$F0
02/AFB8: C9 F0        CMP #$F0
02/AFBA: D0 10        BNE $AFCC
02/AFBC: AD 8E EF     LDA $EF8E
02/AFBF: F0 1E        BEQ $AFDF
02/AFC1: A5 0E        LDA $0E
02/AFC3: 8D 32 F3     STA $F332
02/AFC6: A9 FF        LDA #$FF
02/AFC8: 8D 8D EF     STA $EF8D
02/AFCB: 60           RTS 
02/AFCC: 4A           LSR 
02/AFCD: 4A           LSR 
02/AFCE: 4A           LSR 
02/AFCF: 4A           LSR 
02/AFD0: 85 0E        STA $0E
02/AFD2: AA           TAX 
02/AFD3: BD 23 F1     LDA $F123,X
02/AFD6: C9 FF        CMP #$FF
02/AFD8: F0 D5        BEQ $AFAF
02/AFDA: A5 0E        LDA $0E
02/AFDC: 8D 8D EF     STA $EF8D
02/AFDF: 60           RTS 
; right (backward)
02/AFE0: AD 8D EF     LDA $EF8D
02/AFE3: C9 13        CMP #$13
02/AFE5: F0 68        BEQ $B04F
02/AFE7: C9 FF        CMP #$FF
02/AFE9: D0 22        BNE $B00D
02/AFEB: A2 00 00     LDX #$0000
02/AFEE: BD 3B F3     LDA $F33B,X
02/AFF1: A8           TAY 
02/AFF2: B9 23 F1     LDA $F123,Y
02/AFF5: C9 FF        CMP #$FF
02/AFF7: D0 0D        BNE $B006
02/AFF9: E8           INX 
02/AFFA: E0 08 00     CPX #$0008
02/AFFD: D0 EF        BNE $AFEE
02/AFFF: A5 38        LDA $38
02/B001: 09 80        ORA #$80
02/B003: 85 38        STA $38
02/B005: 60           RTS 
02/B006: BD 3B F3     LDA $F33B,X
02/B009: 8D 8D EF     STA $EF8D
02/B00C: 60           RTS 
02/B00D: AD 8D EF     LDA $EF8D
02/B010: 85 0E        STA $0E
02/B012: C9 08        CMP #$08
02/B014: 90 15        BCC $B02B
02/B016: C9 0D        CMP #$0D
02/B018: D0 01        BNE $B01B
02/B01A: 60           RTS 
02/B01B: AD 8E EF     LDA $EF8E
02/B01E: F0 0A        BEQ $B02A
02/B020: A5 0E        LDA $0E
02/B022: 8D 31 F3     STA $F331
02/B025: A9 0D        LDA #$0D
02/B027: 8D 8D EF     STA $EF8D
02/B02A: 60           RTS 
02/B02B: A5 0E        LDA $0E
02/B02D: 0A           ASL 
02/B02E: AA           TAX 
02/B02F: BD D0 29     LDA $29D0,X
02/B032: 29 0F        AND #$0F
02/B034: C9 0F        CMP #$0F
02/B036: D0 08        BNE $B040
02/B038: A9 0A        LDA #$0A
02/B03A: 8D 8D EF     STA $EF8D
02/B03D: 4C 7E AE     JMP $AE7E
02/B040: 85 0E        STA $0E
02/B042: AA           TAX 
02/B043: BD 23 F1     LDA $F123,X
02/B046: C9 FF        CMP #$FF
02/B048: F0 E1        BEQ $B02B
02/B04A: A5 0E        LDA $0E
02/B04C: 8D 8D EF     STA $EF8D
02/B04F: 60           RTS 
; forward + up or down
02/B050: 4C 72 AF     JMP $AF72
; backward + up or down
02/B053: 4C E0 AF     JMP $AFE0

; $04, $07, $0C: target select
02/B056: 20 0C B9     JSR $B90C
02/B059: AD 8C EF     LDA $EF8C
02/B05C: 29 70        AND #$70
02/B05E: D0 1C        BNE $B07C
02/B060: AD 22 18     LDA $1822
02/B063: AA           TAX 
02/B064: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/B068: 8D 90 EF     STA $EF90
02/B06B: 9C 8F EF     STZ $EF8F
02/B06E: AE 8F EF     LDX $EF8F
02/B071: 86 DA        STX $DA
02/B073: 9C 8B EF     STZ $EF8B
02/B076: A9 08        LDA #$08
02/B078: 8D 23 18     STA $1823
02/B07B: 60           RTS 
02/B07C: A9 01        LDA #$01
02/B07E: 8D 8B EF     STA $EF8B
02/B081: AD 8C EF     LDA $EF8C
02/B084: 29 10        AND #$10
02/B086: F0 03        BEQ $B08B
02/B088: 20 29 AE     JSR $AE29       ; update target cursor
02/B08B: AD 8D EF     LDA $EF8D
02/B08E: C9 FF        CMP #$FF
02/B090: F0 5F        BEQ $B0F1
02/B092: C9 08        CMP #$08
02/B094: 90 5B        BCC $B0F1
02/B096: C9 0D        CMP #$0D
02/B098: F0 28        BEQ $B0C2
02/B09A: 38           SEC 
02/B09B: E9 08        SBC #$08
02/B09D: AA           TAX 
02/B09E: BD BC F2     LDA $F2BC,X
02/B0A1: D0 0C        BNE $B0AF
02/B0A3: BD C1 F2     LDA $F2C1,X
02/B0A6: D0 07        BNE $B0AF
02/B0A8: BD C5 29     LDA $29C5,X
02/B0AB: C9 FF        CMP #$FF
02/B0AD: D0 06        BNE $B0B5
02/B0AF: A5 38        LDA $38
02/B0B1: 09 80        ORA #$80
02/B0B3: 85 38        STA $38
02/B0B5: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/B0B9: 8D 90 EF     STA $EF90
02/B0BC: 9C 8F EF     STZ $EF8F
02/B0BF: 4C 35 B1     JMP $B135
02/B0C2: A2 00 00     LDX #$0000
02/B0C5: 86 0E        STX $0E
02/B0C7: BD BC F2     LDA $F2BC,X
02/B0CA: D0 14        BNE $B0E0
02/B0CC: BD C1 F2     LDA $F2C1,X
02/B0CF: D0 0F        BNE $B0E0
02/B0D1: BD C5 29     LDA $29C5,X
02/B0D4: C9 FF        CMP #$FF
02/B0D6: F0 08        BEQ $B0E0
02/B0D8: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/B0DC: 05 0E        ORA $0E
02/B0DE: 85 0E        STA $0E
02/B0E0: E8           INX 
02/B0E1: E0 05 00     CPX #$0005
02/B0E4: D0 E1        BNE $B0C7
02/B0E6: A5 0E        LDA $0E
02/B0E8: 8D 90 EF     STA $EF90
02/B0EB: 9C 8F EF     STZ $EF8F
02/B0EE: 4C 35 B1     JMP $B135
02/B0F1: AD 8D EF     LDA $EF8D
02/B0F4: C9 FF        CMP #$FF
02/B0F6: F0 1B        BEQ $B113
02/B0F8: AA           TAX 
02/B0F9: BD 23 F1     LDA $F123,X
02/B0FC: C9 FF        CMP #$FF
02/B0FE: D0 06        BNE $B106
02/B100: A5 38        LDA $38
02/B102: 09 80        ORA #$80
02/B104: 85 38        STA $38
02/B106: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/B10A: 8D 8F EF     STA $EF8F
02/B10D: 9C 90 EF     STZ $EF90
02/B110: 4C 35 B1     JMP $B135
02/B113: A2 00 00     LDX #$0000
02/B116: 86 0E        STX $0E
02/B118: BD 23 F1     LDA $F123,X
02/B11B: C9 FF        CMP #$FF
02/B11D: F0 08        BEQ $B127
02/B11F: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/B123: 05 0E        ORA $0E
02/B125: 85 0E        STA $0E
02/B127: E8           INX 
02/B128: E0 08 00     CPX #$0008
02/B12B: D0 EB        BNE $B118
02/B12D: A5 0E        LDA $0E
02/B12F: 8D 8F EF     STA $EF8F
02/B132: 9C 90 EF     STZ $EF90
02/B135: A5 37        LDA $37
02/B137: 10 17        BPL $B150
02/B139: 20 1F B9     JSR $B91F
02/B13C: AE 8F EF     LDX $EF8F
02/B13F: 86 DA        STX $DA
02/B141: 9C 8B EF     STZ $EF8B
02/B144: 20 82 BC     JSR $BC82
02/B147: 20 8E BC     JSR $BC8E
02/B14A: A9 08        LDA #$08
02/B14C: 8D 23 18     STA $1823
02/B14F: 60           RTS 
02/B150: A5 38        LDA $38
02/B152: 10 12        BPL $B166
02/B154: 20 1F B9     JSR $B91F
02/B157: 20 82 BC     JSR $BC82
02/B15A: 20 8E BC     JSR $BC8E
02/B15D: 9C 8B EF     STZ $EF8B
02/B160: AD 91 EF     LDA $EF91
02/B163: 8D 23 18     STA $1823
02/B166: 60           RTS 
; $09: spell list
02/B167: 20 8D A9     JSR $A98D
02/B16A: A9 06        LDA #$06
02/B16C: 8D 23 18     STA $1823
02/B16F: 60           RTS 
; $0A: 
02/B170: A5 4A        LDA $4A
02/B172: 29 40        AND #$40
02/B174: F0 05        BEQ $B17B
02/B176: 20 AE AB     JSR $ABAE
02/B179: 80 0E        BRA $B189
02/B17B: A5 4A        LDA $4A
02/B17D: 29 20        AND #$20
02/B17F: F0 05        BEQ $B186
02/B181: 20 8E AB     JSR $AB8E
02/B184: 80 03        BRA $B189
02/B186: 20 6D AB     JSR $AB6D
02/B189: A9 01        LDA #$01
02/B18B: 8D 23 18     STA $1823
02/B18E: 60           RTS 
; $08
02/B18F: 9C 8B EF     STZ $EF8B
02/B192: 20 82 BC     JSR $BC82
02/B195: 20 8E BC     JSR $BC8E
02/B198: 20 4E BC     JSR $BC4E
02/B19B: A5 4D        LDA $4D
02/B19D: 29 80        AND #$80
02/B19F: F0 03        BEQ $B1A4
02/B1A1: 4C C9 AB     JMP $ABC9
02/B1A4: A5 4C        LDA $4C
02/B1A6: F0 03        BEQ $B1AB
02/B1A8: 4C 7E BA     JMP $BA7E
02/B1AB: A5 4B        LDA $4B
02/B1AD: F0 03        BEQ $B1B2
02/B1AF: 4C 6E BA     JMP $BA6E
02/B1B2: A5 4A        LDA $4A
02/B1B4: 29 80        AND #$80
02/B1B6: F0 03        BEQ $B1BB
02/B1B8: 4C A6 A9     JMP $A9A6
02/B1BB: A5 4A        LDA $4A
02/B1BD: 29 40        AND #$40
02/B1BF: F0 03        BEQ $B1C4
02/B1C1: 4C AE AB     JMP $ABAE
02/B1C4: A5 4A        LDA $4A
02/B1C6: 29 20        AND #$20
02/B1C8: F0 03        BEQ $B1CD
02/B1CA: 4C 8E AB     JMP $AB8E
02/B1CD: A5 4A        LDA $4A
02/B1CF: 29 10        AND #$10
02/B1D1: F0 03        BEQ $B1D6
02/B1D3: 4C 6D AB     JMP $AB6D
02/B1D6: A5 4A        LDA $4A
02/B1D8: 29 08        AND #$08
02/B1DA: F0 03        BEQ $B1DF
02/B1DC: 4C 4D AB     JMP $AB4D
02/B1DF: A5 4A        LDA $4A
02/B1E1: 29 04        AND #$04
02/B1E3: F0 03        BEQ $B1E8
02/B1E5: 4C 32 AB     JMP $AB32
02/B1E8: A5 4A        LDA $4A
02/B1EA: 29 02        AND #$02
02/B1EC: F0 03        BEQ $B1F1
02/B1EE: 4C AF AA     JMP $AAAF
02/B1F1: 8D 23 18     STA $1823
02/B1F4: 85 D7        STA $D7
02/B1F6: AD AE F0     LDA $F0AE
02/B1F9: D0 12        BNE $B20D
02/B1FB: AD 22 18     LDA $1822
02/B1FE: A8           TAY 
02/B1FF: AD B1 F2     LDA $F2B1
02/B202: AA           TAX 
02/B203: BF 60 FC 16  LDA $16FC60,X
02/B207: 99 99 F0     STA $F099,Y
02/B20A: 99 9E F0     STA $F09E,Y
02/B20D: 60           RTS 
02/B20E: AD 96 EF     LDA $EF96
02/B211: 29 01        AND #$01
02/B213: 49 01        EOR #$01
02/B215: AA           TAX 
02/B216: B5 0E        LDA $0E,X
02/B218: 85 0E        STA $0E
02/B21A: AD 96 EF     LDA $EF96
02/B21D: 29 01        AND #$01
02/B21F: A8           TAY 
02/B220: 20 8B B4     JSR $B48B
02/B223: AD 95 EF     LDA $EF95
02/B226: 0A           ASL 
02/B227: 0A           ASL 
02/B228: A8           TAY 
02/B229: B9 1B 32     LDA $321B,Y
02/B22C: F0 05        BEQ $B233       ; change to BEQ $B26C to fix bug (F0 3E)
02/B22E: B9 1A 32     LDA $321A,Y
02/B231: 30 53        BMI $B286
02/B233: BD DB 32     LDA $32DB,X
02/B236: F0 05        BEQ $B23D
02/B238: BD DA 32     LDA $32DA,X
02/B23B: 30 49        BMI $B286
02/B23D: BD DB 32     LDA $32DB,X
02/B240: D9 1B 32     CMP $321B,Y
02/B243: F0 2D        BEQ $B272
02/B245: B9 1C 32     LDA $321C,Y
02/B248: C9 01        CMP #$01
02/B24A: F0 20        BEQ $B26C
02/B24C: A5 0E        LDA $0E
02/B24E: 29 08        AND #$08
02/B250: F0 07        BEQ $B259
02/B252: B9 1C 32     LDA $321C,Y
02/B255: C9 15        CMP #$15
02/B257: 90 13        BCC $B26C
02/B259: BD DB 32     LDA $32DB,X
02/B25C: F0 2A        BEQ $B288
02/B25E: AD 1D 18     LDA $181D
02/B261: C9 FF        CMP #$FF
02/B263: F0 21        BEQ $B286
02/B265: A9 02        LDA #$02
02/B267: 8D 1C 18     STA $181C
02/B26A: 38           SEC 
02/B26B: 60           RTS 
02/B26C: 7B           TDC 
02/B26D: 8D 1C 18     STA $181C
02/B270: 38           SEC 
02/B271: 60           RTS 
02/B272: A5 0E        LDA $0E
02/B274: 29 08        AND #$08
02/B276: F0 0E        BEQ $B286
02/B278: B9 DC 32     LDA $32DC,Y
02/B27B: C9 14        CMP #$14
02/B27D: F0 07        BEQ $B286
02/B27F: A9 03        LDA #$03
02/B281: 8D 1C 18     STA $181C
02/B284: 38           SEC 
02/B285: 60           RTS 
02/B286: 18           CLC 
02/B287: 60           RTS 
02/B288: A9 04        LDA #$04
02/B28A: 8D 1C 18     STA $181C
02/B28D: 38           SEC 
02/B28E: 60           RTS 
02/B28F: AD 95 EF     LDA $EF95
02/B292: 29 01        AND #$01
02/B294: 49 01        EOR #$01
02/B296: AA           TAX 
02/B297: B5 0E        LDA $0E,X
02/B299: 85 0E        STA $0E
02/B29B: AD 95 EF     LDA $EF95
02/B29E: 29 01        AND #$01
02/B2A0: 20 8B B4     JSR $B48B
02/B2A3: AD 96 EF     LDA $EF96
02/B2A6: 0A           ASL 
02/B2A7: 0A           ASL 
02/B2A8: A8           TAY 
02/B2A9: B9 1B 32     LDA $321B,Y
02/B2AC: F0 40        BEQ $B2EE
02/B2AE: B9 1A 32     LDA $321A,Y
02/B2B1: 30 39        BMI $B2EC
02/B2B3: BD DB 32     LDA $32DB,X
02/B2B6: F0 05        BEQ $B2BD
02/B2B8: BD DA 32     LDA $32DA,X
02/B2BB: 30 2F        BMI $B2EC
02/B2BD: BD DB 32     LDA $32DB,X
02/B2C0: D9 1B 32     CMP $321B,Y
02/B2C3: F0 2F        BEQ $B2F4
02/B2C5: B9 1C 32     LDA $321C,Y
02/B2C8: C9 01        CMP #$01
02/B2CA: F0 22        BEQ $B2EE
02/B2CC: A5 0E        LDA $0E
02/B2CE: 29 08        AND #$08
02/B2D0: F0 07        BEQ $B2D9
02/B2D2: B9 1C 32     LDA $321C,Y
02/B2D5: C9 15        CMP #$15
02/B2D7: 90 15        BCC $B2EE
02/B2D9: BD DB 32     LDA $32DB,X
02/B2DC: F0 1D        BEQ $B2FB
02/B2DE: AD 1D 18     LDA $181D
02/B2E1: C9 FF        CMP #$FF
02/B2E3: F0 07        BEQ $B2EC
02/B2E5: A9 02        LDA #$02
02/B2E7: 8D 1C 18     STA $181C
02/B2EA: 38           SEC 
02/B2EB: 60           RTS 
02/B2EC: 18           CLC 
02/B2ED: 60           RTS 
02/B2EE: 7B           TDC 
02/B2EF: 8D 1C 18     STA $181C
02/B2F2: 38           SEC 
02/B2F3: 60           RTS 
02/B2F4: A9 01        LDA #$01
02/B2F6: 8D 1C 18     STA $181C
02/B2F9: 38           SEC 
02/B2FA: 60           RTS 
02/B2FB: A9 04        LDA #$04
02/B2FD: 8D 1C 18     STA $181C
02/B300: 38           SEC 
02/B301: 60           RTS 
; $0B: 
02/B302: 20 0C B9     JSR $B90C
02/B305: A5 38        LDA $38
02/B307: 29 0F        AND #$0F
02/B309: C9 04        CMP #$04
02/B30B: F0 22        BEQ $B32F
02/B30D: C9 02        CMP #$02
02/B30F: D0 0A        BNE $B31B
02/B311: A5 5F        LDA $5F
02/B313: F0 29        BEQ $B33E
02/B315: C6 5F        DEC $5F
02/B317: C6 63        DEC $63
02/B319: 80 26        BRA $B341
02/B31B: C9 01        CMP #$01
02/B31D: D0 1F        BNE $B33E
02/B31F: A5 5F        LDA $5F
02/B321: C9 01        CMP #$01
02/B323: F0 06        BEQ $B32B
02/B325: E6 5F        INC $5F
02/B327: E6 63        INC $63
02/B329: 80 16        BRA $B341
02/B32B: C6 5F        DEC $5F
02/B32D: C6 63        DEC $63
02/B32F: 20 5E BC     JSR $BC5E
02/B332: 20 9C B4     JSR $B49C
02/B335: 20 4D AB     JSR $AB4D
02/B338: A9 05        LDA #$05
02/B33A: 8D 23 18     STA $1823
02/B33D: 60           RTS 
02/B33E: 9C 16 F4     STZ $F416
02/B341: A5 5F        LDA $5F
02/B343: AA           TAX 
02/B344: BF 59 FC 16  LDA $16FC59,X
02/B348: AA           TAX 
02/B349: 8E 6B EF     STX $EF6B       ; set menu cursor 1 x position
02/B34C: A9 AC        LDA #$AC
02/B34E: AA           TAX 
02/B34F: 8E 6D EF     STX $EF6D
02/B352: 20 64 BC     JSR $BC64
02/B355: A5 37        LDA $37
02/B357: 30 03        BMI $B35C
02/B359: 4C 5F B4     JMP $B45F
02/B35C: 20 1F B9     JSR $B91F
02/B35F: AD 94 EF     LDA $EF94
02/B362: D0 25        BNE $B389
02/B364: EE 94 EF     INC $EF94
02/B367: A5 63        LDA $63
02/B369: 09 80        ORA #$80
02/B36B: 8D 95 EF     STA $EF95
02/B36E: AE 6B EF     LDX $EF6B
02/B371: E8           INX 
02/B372: E8           INX 
02/B373: E8           INX 
02/B374: E8           INX 
02/B375: 8E 6F EF     STX $EF6F       ; set menu cursor 2 x position
02/B378: AE 6D EF     LDX $EF6D
02/B37B: 8E 71 EF     STX $EF71
02/B37E: 20 68 BC     JSR $BC68
02/B381: AD 9A EF     LDA $EF9A
02/B384: D0 03        BNE $B389
02/B386: 4C 85 B4     JMP $B485
02/B389: A5 63        LDA $63
02/B38B: 09 80        ORA #$80
02/B38D: 8D 96 EF     STA $EF96
02/B390: CD 95 EF     CMP $EF95
02/B393: D0 4F        BNE $B3E4
02/B395: A5 63        LDA $63
02/B397: 20 8B B4     JSR $B48B
02/B39A: BD DB 32     LDA $32DB,X
02/B39D: 85 DC        STA $DC
02/B39F: AD 9A EF     LDA $EF9A
02/B3A2: F0 0C        BEQ $B3B0
02/B3A4: BD DA 32     LDA $32DA,X
02/B3A7: 29 04        AND #$04
02/B3A9: F0 0A        BEQ $B3B5
02/B3AB: BD DA 32     LDA $32DA,X
02/B3AE: 80 11        BRA $B3C1
02/B3B0: BD DA 32     LDA $32DA,X
02/B3B3: 10 0C        BPL $B3C1
02/B3B5: 20 6F BC     JSR $BC6F
02/B3B8: 9C 94 EF     STZ $EF94
02/B3BB: 20 19 B9     JSR $B919
02/B3BE: 4C 85 B4     JMP $B485
02/B3C1: 64 0E        STZ $0E
02/B3C3: 20 8B AD     JSR $AD8B       ; select default target
02/B3C6: A9 10        LDA #$10
02/B3C8: 0D 9A EF     ORA $EF9A
02/B3CB: 85 D8        STA $D8
02/B3CD: A5 63        LDA $63
02/B3CF: 85 D9        STA $D9
02/B3D1: A9 0B        LDA #$0B
02/B3D3: 8D 91 EF     STA $EF91
02/B3D6: A9 0C        LDA #$0C
02/B3D8: 8D 23 18     STA $1823
02/B3DB: 9C 94 EF     STZ $EF94
02/B3DE: 20 82 BC     JSR $BC82
02/B3E1: 4C 85 B4     JMP $B485
02/B3E4: AD 95 EF     LDA $EF95
02/B3E7: 10 0C        BPL $B3F5
02/B3E9: 20 6F BC     JSR $BC6F
02/B3EC: 9C 94 EF     STZ $EF94
02/B3EF: 20 19 B9     JSR $B919
02/B3F2: 4C 85 B4     JMP $B485
02/B3F5: AD 96 EF     LDA $EF96
02/B3F8: 29 01        AND #$01
02/B3FA: A8           TAY 
02/B3FB: AD 95 EF     LDA $EF95
02/B3FE: 29 7F        AND #$7F
02/B400: 0A           ASL 
02/B401: 0A           ASL 
02/B402: AA           TAX 
02/B403: BD 1B 32     LDA $321B,X
02/B406: 99 94 28     STA $2894,Y
02/B409: AD 96 EF     LDA $EF96
02/B40C: 29 01        AND #$01
02/B40E: 49 01        EOR #$01
02/B410: A8           TAY 
02/B411: 20 8B B4     JSR $B48B
02/B414: BD DB 32     LDA $32DB,X
02/B417: 99 94 28     STA $2894,Y
02/B41A: 20 86 B4     JSR $B486
02/B41D: AD 93 28     LDA $2893
02/B420: D0 32        BNE $B454
02/B422: 20 0E B2     JSR $B20E
02/B425: 90 2D        BCC $B454
02/B427: AD 22 18     LDA $1822
02/B42A: 8D 19 18     STA $1819
02/B42D: AD 95 EF     LDA $EF95
02/B430: 29 7F        AND #$7F
02/B432: 8D 1B 18     STA $181B
02/B435: AD 96 EF     LDA $EF96
02/B438: 29 7F        AND #$7F
02/B43A: 8D 1A 18     STA $181A
02/B43D: A9 09        LDA #$09
02/B43F: 8D 21 18     STA $1821
02/B442: A9 09        LDA #$09        ; equipped items
02/B444: 8D 1E 18     STA $181E
02/B447: A9 07        LDA #$07        ; inventory
02/B449: 8D 1F 18     STA $181F
02/B44C: 20 6F BC     JSR $BC6F
02/B44F: 9C 94 EF     STZ $EF94
02/B452: 80 31        BRA $B485
02/B454: 20 6F BC     JSR $BC6F
02/B457: 9C 94 EF     STZ $EF94
02/B45A: 20 19 B9     JSR $B919
02/B45D: 80 26        BRA $B485
02/B45F: A5 38        LDA $38
02/B461: 10 22        BPL $B485
02/B463: 20 1F B9     JSR $B91F
02/B466: AD 94 EF     LDA $EF94
02/B469: F0 08        BEQ $B473
02/B46B: 9C 94 EF     STZ $EF94
02/B46E: 20 6F BC     JSR $BC6F
02/B471: 80 12        BRA $B485
02/B473: 20 5E BC     JSR $BC5E
02/B476: 20 4E BC     JSR $BC4E
02/B479: A6 61        LDX $61
02/B47B: 86 5F        STX $5F
02/B47D: 20 4D AB     JSR $AB4D
02/B480: A9 0D        LDA #$0D
02/B482: 8D 23 18     STA $1823
02/B485: 60           RTS 
02/B486: 22 0B F3 03  JSL $03F30B
02/B48A: 60           RTS 
02/B48B: 29 7F        AND #$7F
02/B48D: 0A           ASL 
02/B48E: 0A           ASL 
02/B48F: 85 10        STA $10
02/B491: AD 22 18     LDA $1822
02/B494: 0A           ASL 
02/B495: 0A           ASL 
02/B496: 0A           ASL 
02/B497: 18           CLC 
02/B498: 65 10        ADC $10
02/B49A: AA           TAX 
02/B49B: 60           RTS 
02/B49C: AD 94 EF     LDA $EF94
02/B49F: F0 13        BEQ $B4B4
02/B4A1: AD 95 EF     LDA $EF95
02/B4A4: 30 0B        BMI $B4B1
02/B4A6: C9 0A        CMP #$0A
02/B4A8: B0 03        BCS $B4AD
02/B4AA: 4C 68 BC     JMP $BC68
02/B4AD: EE 6A EF     INC $EF6A
02/B4B0: 60           RTS 
02/B4B1: 4C 6F BC     JMP $BC6F
02/B4B4: 60           RTS 
02/B4B5: AD 94 EF     LDA $EF94
02/B4B8: F0 13        BEQ $B4CD
02/B4BA: AD 95 EF     LDA $EF95
02/B4BD: 30 08        BMI $B4C7
02/B4BF: C9 0A        CMP #$0A
02/B4C1: B0 07        BCS $B4CA
02/B4C3: C9 06        CMP #$06
02/B4C5: 90 03        BCC $B4CA
02/B4C7: 4C 68 BC     JMP $BC68
02/B4CA: EE 6A EF     INC $EF6A
02/B4CD: 60           RTS 
; $05: inventory
02/B4CE: 20 0C B9     JSR $B90C
02/B4D1: A5 38        LDA $38
02/B4D3: 29 0F        AND #$0F
02/B4D5: C9 08        CMP #$08
02/B4D7: D0 38        BNE $B511
02/B4D9: AD 85 EF     LDA $EF85
02/B4DC: D0 15        BNE $B4F3
02/B4DE: 20 42 BC     JSR $BC42
02/B4E1: 20 B5 B4     JSR $B4B5
02/B4E4: 20 3E AB     JSR $AB3E
02/B4E7: A9 0B        LDA #$0B
02/B4E9: 8D 23 18     STA $1823
02/B4EC: 60           RTS 
02/B4ED: E6 5F        INC $5F
02/B4EF: E6 63        INC $63
02/B4F1: 80 EB        BRA $B4DE
02/B4F3: A5 60        LDA $60
02/B4F5: D0 0F        BNE $B506
02/B4F7: 20 CA A8     JSR $A8CA
02/B4FA: CE 86 EF     DEC $EF86
02/B4FD: CE 85 EF     DEC $EF85
02/B500: C6 63        DEC $63
02/B502: C6 63        DEC $63
02/B504: 80 73        BRA $B579
02/B506: C6 60        DEC $60
02/B508: C6 63        DEC $63
02/B50A: C6 63        DEC $63
02/B50C: CE 85 EF     DEC $EF85
02/B50F: 80 68        BRA $B579
02/B511: C9 04        CMP #$04
02/B513: D0 2C        BNE $B541
02/B515: AD 85 EF     LDA $EF85
02/B518: C9 17        CMP #$17
02/B51A: D0 05        BNE $B521
02/B51C: 9C 16 F4     STZ $F416
02/B51F: 80 58        BRA $B579
02/B521: A5 60        LDA $60
02/B523: C9 04        CMP #$04
02/B525: D0 0F        BNE $B536
02/B527: 20 B8 A8     JSR $A8B8
02/B52A: EE 86 EF     INC $EF86
02/B52D: EE 85 EF     INC $EF85
02/B530: E6 63        INC $63
02/B532: E6 63        INC $63
02/B534: 80 43        BRA $B579
02/B536: E6 60        INC $60
02/B538: E6 63        INC $63
02/B53A: E6 63        INC $63
02/B53C: EE 85 EF     INC $EF85
02/B53F: 80 38        BRA $B579
02/B541: C9 02        CMP #$02
02/B543: D0 15        BNE $B55A
02/B545: A5 63        LDA $63
02/B547: F0 A4        BEQ $B4ED
02/B549: A5 5F        LDA $5F
02/B54B: D0 07        BNE $B554
02/B54D: E6 5F        INC $5F
02/B54F: E6 63        INC $63
02/B551: 4C D9 B4     JMP $B4D9
02/B554: C6 5F        DEC $5F
02/B556: C6 63        DEC $63
02/B558: 80 1F        BRA $B579
02/B55A: C9 01        CMP #$01
02/B55C: D0 1B        BNE $B579
02/B55E: A5 63        LDA $63
02/B560: C9 2F        CMP #$2F
02/B562: D0 05        BNE $B569
02/B564: 9C 16 F4     STZ $F416
02/B567: 80 10        BRA $B579
02/B569: A5 5F        LDA $5F
02/B56B: C9 01        CMP #$01
02/B56D: D0 06        BNE $B575
02/B56F: C6 5F        DEC $5F
02/B571: C6 63        DEC $63
02/B573: 80 A0        BRA $B515
02/B575: E6 5F        INC $5F
02/B577: E6 63        INC $63
02/B579: 20 57 BC     JSR $BC57
02/B57C: AD 86 EF     LDA $EF86
02/B57F: C9 13        CMP #$13
02/B581: D0 03        BNE $B586
02/B583: 20 48 BC     JSR $BC48
02/B586: A5 5F        LDA $5F
02/B588: AA           TAX 
02/B589: BF 59 FC 16  LDA $16FC59,X
02/B58D: AA           TAX 
02/B58E: 8E 6B EF     STX $EF6B       ; set menu cursor 1 x position
02/B591: A5 60        LDA $60
02/B593: AA           TAX 
02/B594: BF 5B FC 16  LDA $16FC5B,X
02/B598: AA           TAX 
02/B599: 8E 6D EF     STX $EF6D       ; set menu cursor 1 y position
02/B59C: 20 64 BC     JSR $BC64
02/B59F: A5 37        LDA $37
02/B5A1: 30 03        BMI $B5A6
02/B5A3: 4C CA B6     JMP $B6CA
02/B5A6: 20 1F B9     JSR $B91F
02/B5A9: AD 94 EF     LDA $EF94
02/B5AC: D0 23        BNE $B5D1
02/B5AE: EE 94 EF     INC $EF94
02/B5B1: A5 63        LDA $63
02/B5B3: 8D 95 EF     STA $EF95
02/B5B6: AE 6B EF     LDX $EF6B
02/B5B9: E8           INX 
02/B5BA: E8           INX 
02/B5BB: E8           INX 
02/B5BC: E8           INX 
02/B5BD: 8E 6F EF     STX $EF6F       ; set menu cursor 2 x position
02/B5C0: AE 6D EF     LDX $EF6D
02/B5C3: 8E 71 EF     STX $EF71       ; set menu cursor 2 y position
02/B5C6: 20 68 BC     JSR $BC68
02/B5C9: AD 9A EF     LDA $EF9A
02/B5CC: D0 03        BNE $B5D1
02/B5CE: 4C F0 B6     JMP $B6F0
02/B5D1: A5 63        LDA $63
02/B5D3: 8D 96 EF     STA $EF96
02/B5D6: 20 6F BC     JSR $BC6F
02/B5D9: 9C 94 EF     STZ $EF94
02/B5DC: AD 95 EF     LDA $EF95
02/B5DF: CD 96 EF     CMP $EF96
02/B5E2: D0 62        BNE $B646
02/B5E4: A5 63        LDA $63
02/B5E6: 0A           ASL 
02/B5E7: 0A           ASL 
02/B5E8: AA           TAX 
02/B5E9: BD 1B 32     LDA $321B,X
02/B5EC: 85 DC        STA $DC
02/B5EE: AD 9A EF     LDA $EF9A
02/B5F1: F0 0E        BEQ $B601
02/B5F3: BD 1A 32     LDA $321A,X
02/B5F6: 29 04        AND #$04
02/B5F8: F0 13        BEQ $B60D
02/B5FA: BD 1A 32     LDA $321A,X
02/B5FD: 09 40        ORA #$40
02/B5FF: 80 15        BRA $B616
02/B601: BD 1B 32     LDA $321B,X
02/B604: C9 B0        CMP #$B0
02/B606: 90 05        BCC $B60D
02/B608: BD 1A 32     LDA $321A,X
02/B60B: 10 09        BPL $B616
02/B60D: 20 19 B9     JSR $B919
02/B610: 9C 94 EF     STZ $EF94
02/B613: 4C F0 B6     JMP $B6F0
02/B616: 48           PHA 
02/B617: 64 0E        STZ $0E
02/B619: 20 8B AD     JSR $AD8B       ; select default target
02/B61C: A9 40        LDA #$40
02/B61E: 0D 9A EF     ORA $EF9A
02/B621: 85 D8        STA $D8
02/B623: A5 63        LDA $63
02/B625: 85 D9        STA $D9
02/B627: 20 5E BC     JSR $BC5E
02/B62A: 68           PLA 
02/B62B: 29 40        AND #$40
02/B62D: F0 09        BEQ $B638
02/B62F: A9 05        LDA #$05
02/B631: 8D 91 EF     STA $EF91
02/B634: A9 0C        LDA #$0C
02/B636: 80 07        BRA $B63F
02/B638: A9 10        LDA #$10
02/B63A: 8D 91 EF     STA $EF91
02/B63D: A9 0F        LDA #$0F
02/B63F: 8D 23 18     STA $1823
02/B642: 60           RTS 
02/B643: 4C F0 B6     JMP $B6F0
02/B646: AD 95 EF     LDA $EF95
02/B649: 10 67        BPL $B6B2
02/B64B: AD 95 EF     LDA $EF95
02/B64E: 29 01        AND #$01
02/B650: A8           TAY 
02/B651: AD 96 EF     LDA $EF96
02/B654: 29 7F        AND #$7F
02/B656: 0A           ASL 
02/B657: 0A           ASL 
02/B658: AA           TAX 
02/B659: BD 1B 32     LDA $321B,X
02/B65C: 99 94 28     STA $2894,Y
02/B65F: AD 95 EF     LDA $EF95
02/B662: 29 01        AND #$01
02/B664: 49 01        EOR #$01
02/B666: A8           TAY 
02/B667: 20 8B B4     JSR $B48B
02/B66A: BD DB 32     LDA $32DB,X
02/B66D: 99 94 28     STA $2894,Y
02/B670: 20 86 B4     JSR $B486
02/B673: AD 93 28     LDA $2893
02/B676: D0 32        BNE $B6AA
02/B678: 20 8F B2     JSR $B28F
02/B67B: 90 2D        BCC $B6AA
02/B67D: AD 22 18     LDA $1822
02/B680: 8D 19 18     STA $1819
02/B683: AD 96 EF     LDA $EF96
02/B686: 29 7F        AND #$7F
02/B688: 8D 1B 18     STA $181B
02/B68B: AD 95 EF     LDA $EF95
02/B68E: 29 7F        AND #$7F
02/B690: 8D 1A 18     STA $181A
02/B693: A9 09        LDA #$09
02/B695: 8D 21 18     STA $1821
02/B698: A9 09        LDA #$09        ; equipped items
02/B69A: 8D 1E 18     STA $181E
02/B69D: A9 07        LDA #$07        ; inventory
02/B69F: 8D 1F 18     STA $181F
02/B6A2: 9C 94 EF     STZ $EF94
02/B6A5: 20 6F BC     JSR $BC6F
02/B6A8: 80 46        BRA $B6F0
02/B6AA: 9C 94 EF     STZ $EF94
02/B6AD: 20 19 B9     JSR $B919
02/B6B0: 80 3E        BRA $B6F0
02/B6B2: AD 95 EF     LDA $EF95
02/B6B5: 8D 1A 18     STA $181A
02/B6B8: AD 96 EF     LDA $EF96
02/B6BB: 8D 1B 18     STA $181B
02/B6BE: A9 08        LDA #$08
02/B6C0: 8D 21 18     STA $1821
02/B6C3: A9 07        LDA #$07        ; inventory
02/B6C5: 8D 1E 18     STA $181E
02/B6C8: 80 26        BRA $B6F0
02/B6CA: A5 38        LDA $38
02/B6CC: 10 22        BPL $B6F0
02/B6CE: 20 1F B9     JSR $B91F
02/B6D1: AD 94 EF     LDA $EF94
02/B6D4: F0 08        BEQ $B6DE
02/B6D6: 9C 94 EF     STZ $EF94
02/B6D9: 20 6F BC     JSR $BC6F
02/B6DC: 80 12        BRA $B6F0
02/B6DE: 20 5E BC     JSR $BC5E
02/B6E1: 20 4E BC     JSR $BC4E
02/B6E4: A6 61        LDX $61
02/B6E6: 86 5F        STX $5F
02/B6E8: 20 32 AB     JSR $AB32
02/B6EB: A9 01        LDA #$01
02/B6ED: 8D 23 18     STA $1823
02/B6F0: 60           RTS 
; $06: 
02/B6F1: 20 0C B9     JSR $B90C
02/B6F4: A5 38        LDA $38
02/B6F6: 29 0F        AND #$0F
02/B6F8: C9 08        CMP #$08
02/B6FA: D0 28        BNE $B724
02/B6FC: AD 85 EF     LDA $EF85
02/B6FF: F0 45        BEQ $B746
02/B701: A5 60        LDA $60
02/B703: D0 11        BNE $B716
02/B705: 20 CA A8     JSR $A8CA
02/B708: CE 86 EF     DEC $EF86
02/B70B: CE 85 EF     DEC $EF85
02/B70E: C6 63        DEC $63
02/B710: C6 63        DEC $63
02/B712: C6 63        DEC $63
02/B714: 80 2E        BRA $B744
02/B716: C6 60        DEC $60
02/B718: C6 63        DEC $63
02/B71A: C6 63        DEC $63
02/B71C: C6 63        DEC $63
02/B71E: CE 85 EF     DEC $EF85
02/B721: 4C 93 B7     JMP $B793
02/B724: C9 04        CMP #$04
02/B726: D0 30        BNE $B758
02/B728: AD 85 EF     LDA $EF85
02/B72B: C9 07        CMP #$07
02/B72D: F0 17        BEQ $B746
02/B72F: A5 60        LDA $60
02/B731: C9 04        CMP #$04
02/B733: D0 16        BNE $B74B
02/B735: 20 B8 A8     JSR $A8B8
02/B738: EE 86 EF     INC $EF86
02/B73B: EE 85 EF     INC $EF85
02/B73E: E6 63        INC $63
02/B740: E6 63        INC $63
02/B742: E6 63        INC $63
02/B744: 80 4D        BRA $B793
02/B746: 9C 16 F4     STZ $F416
02/B749: 80 48        BRA $B793
02/B74B: E6 60        INC $60
02/B74D: E6 63        INC $63
02/B74F: E6 63        INC $63
02/B751: E6 63        INC $63
02/B753: EE 85 EF     INC $EF85
02/B756: 80 3B        BRA $B793
02/B758: C9 02        CMP #$02
02/B75A: D0 19        BNE $B775
02/B75C: A5 63        LDA $63
02/B75E: F0 E6        BEQ $B746
02/B760: A5 5F        LDA $5F
02/B762: D0 0B        BNE $B76F
02/B764: E6 5F        INC $5F
02/B766: E6 5F        INC $5F
02/B768: E6 63        INC $63
02/B76A: E6 63        INC $63
02/B76C: 4C FC B6     JMP $B6FC
02/B76F: C6 5F        DEC $5F
02/B771: C6 63        DEC $63
02/B773: 80 1E        BRA $B793
02/B775: C9 01        CMP #$01
02/B777: D0 1A        BNE $B793
02/B779: A5 63        LDA $63
02/B77B: C9 17        CMP #$17
02/B77D: F0 C7        BEQ $B746
02/B77F: A5 5F        LDA $5F
02/B781: C9 02        CMP #$02
02/B783: D0 0A        BNE $B78F
02/B785: C6 5F        DEC $5F
02/B787: C6 5F        DEC $5F
02/B789: C6 63        DEC $63
02/B78B: C6 63        DEC $63
02/B78D: 80 99        BRA $B728
02/B78F: E6 5F        INC $5F
02/B791: E6 63        INC $63
02/B793: 20 57 BC     JSR $BC57
02/B796: AD 86 EF     LDA $EF86
02/B799: D0 03        BNE $B79E
02/B79B: 20 42 BC     JSR $BC42
02/B79E: AD 86 EF     LDA $EF86
02/B7A1: C9 03        CMP #$03
02/B7A3: D0 03        BNE $B7A8
02/B7A5: 20 48 BC     JSR $BC48
02/B7A8: 20 68 B8     JSR $B868       ; update mp cost in menu
02/B7AB: A5 5F        LDA $5F
02/B7AD: AA           TAX 
02/B7AE: BF 56 FC 16  LDA $16FC56,X
02/B7B2: AA           TAX 
02/B7B3: 8E 6B EF     STX $EF6B       ; set menu cursor 1 x position
02/B7B6: A5 60        LDA $60
02/B7B8: AA           TAX 
02/B7B9: BF 5B FC 16  LDA $16FC5B,X
02/B7BD: AA           TAX 
02/B7BE: 8E 6D EF     STX $EF6D
02/B7C1: 20 64 BC     JSR $BC64
02/B7C4: A5 37        LDA $37
02/B7C6: 10 48        BPL $B810
02/B7C8: 20 1F B9     JSR $B91F
02/B7CB: 20 37 B8     JSR $B837
02/B7CE: BD 7A 2C     LDA $2C7A,X
02/B7D1: 10 05        BPL $B7D8
02/B7D3: 20 19 B9     JSR $B919
02/B7D6: 80 38        BRA $B810
02/B7D8: 20 5E BC     JSR $BC5E
02/B7DB: BD 7B 2C     LDA $2C7B,X
02/B7DE: 85 DC        STA $DC
02/B7E0: BD 7A 2C     LDA $2C7A,X
02/B7E3: 48           PHA 
02/B7E4: 64 0E        STZ $0E
02/B7E6: 20 8B AD     JSR $AD8B       ; select default target
02/B7E9: A9 20        LDA #$20
02/B7EB: 85 D8        STA $D8
02/B7ED: AD 93 EF     LDA $EF93
02/B7F0: 4A           LSR 
02/B7F1: 4A           LSR 
02/B7F2: 18           CLC 
02/B7F3: 65 63        ADC $63
02/B7F5: 85 D9        STA $D9
02/B7F7: 68           PLA 
02/B7F8: 29 40        AND #$40
02/B7FA: F0 09        BEQ $B805
02/B7FC: A9 06        LDA #$06
02/B7FE: 8D 91 EF     STA $EF91
02/B801: A9 0C        LDA #$0C
02/B803: 80 07        BRA $B80C
02/B805: A9 0E        LDA #$0E
02/B807: 8D 91 EF     STA $EF91
02/B80A: A9 0F        LDA #$0F
02/B80C: 8D 23 18     STA $1823
02/B80F: 60           RTS 
02/B810: A5 38        LDA $38
02/B812: 10 18        BPL $B82C
02/B814: 20 1F B9     JSR $B91F
02/B817: 20 5E BC     JSR $BC5E
02/B81A: 20 4E BC     JSR $BC4E
02/B81D: A6 61        LDX $61
02/B81F: 86 5F        STX $5F
02/B821: 9C 38 18     STZ $1838
02/B824: 20 A6 A9     JSR $A9A6
02/B827: A9 0A        LDA #$0A
02/B829: 8D 23 18     STA $1823
02/B82C: 60           RTS 

; pointers to spell lists
02/B82D: 0000 0120 0240 0360 0480

; [  ]

02/B837: AD 22 18     LDA $1822       ; selected character
02/B83A: 0A           ASL 
02/B83B: AA           TAX 
02/B83C: BF 2D B8 02  LDA $02B82D,X
02/B840: 85 0E        STA $0E
02/B842: BF 2E B8 02  LDA $02B82E,X
02/B846: 85 0F        STA $0F
02/B848: A5 0E        LDA $0E
02/B84A: 18           CLC 
02/B84B: 6D 93 EF     ADC $EF93
02/B84E: 85 0E        STA $0E
02/B850: A5 0F        LDA $0F
02/B852: 69 00        ADC #$00
02/B854: 85 0F        STA $0F
02/B856: A5 63        LDA $63
02/B858: 0A           ASL 
02/B859: 0A           ASL 
02/B85A: 18           CLC 
02/B85B: 65 0E        ADC $0E
02/B85D: 85 0E        STA $0E
02/B85F: A5 0F        LDA $0F
02/B861: 69 00        ADC #$00
02/B863: 85 0F        STA $0F
02/B865: A6 0E        LDX $0E
02/B867: 60           RTS 

; [ update mp cost in menu ]

02/B868: 20 37 B8     JSR $B837
02/B86B: BD 7D 2C     LDA $2C7D,X     ; mp cost
02/B86E: AA           TAX 
02/B86F: 86 1C        STX $1C
02/B871: A2 64 00     LDX #$0064      ; 100s digit
02/B874: 86 1E        STX $1E
02/B876: 20 EB 85     JSR $85EB       ; hardware divide
02/B879: A5 20        LDA $20
02/B87B: 18           CLC 
02/B87C: 69 ED        ADC #$ED
02/B87E: 8D 39 18     STA $1839
02/B881: A6 22        LDX $22
02/B883: 86 1C        STX $1C
02/B885: A2 0A 00     LDX #$000A      ; 10s digit
02/B888: 86 1E        STX $1E
02/B88A: 20 EB 85     JSR $85EB       ; hardware divide
02/B88D: A5 20        LDA $20
02/B88F: 18           CLC 
02/B890: 69 ED        ADC #$ED
02/B892: 8D 3B 18     STA $183B
02/B895: A5 22        LDA $22
02/B897: 18           CLC 
02/B898: 69 ED        ADC #$ED
02/B89A: 8D 3D 18     STA $183D      ; 1s digit
02/B89D: EE 38 18     INC $1838      ; enable transfer to vram
02/B8A0: 60           RTS 
; $00:
02/B8A1: 60           RTS 

; [  ]

02/B8A2: A2 00 00     LDX #$0000
02/B8A5: 8E 8F EF     STX $EF8F
02/B8A8: 86 DA        STX $DA
02/B8AA: 9C 8B EF     STZ $EF8B
02/B8AD: 60           RTS 

; $03: 
02/B8AE: A5 37        LDA $37
02/B8B0: 10 11        BPL $B8C3
02/B8B2: A9 1A        LDA #$1A
02/B8B4: 8D B1 F2     STA $F2B1
02/B8B7: 20 A2 B8     JSR $B8A2
02/B8BA: A9 08        LDA #$08
02/B8BC: 8D 23 18     STA $1823
02/B8BF: 20 1F B9     JSR $B91F
02/B8C2: 60           RTS 
02/B8C3: A5 38        LDA $38
02/B8C5: 10 11        BPL $B8D8
02/B8C7: 20 13 B9     JSR $B913
02/B8CA: 80 03        BRA $B8CF
02/B8CC: 20 1F B9     JSR $B91F
02/B8CF: 20 7E BA     JSR $BA7E
02/B8D2: A9 01        LDA #$01
02/B8D4: 8D 23 18     STA $1823
02/B8D7: 60           RTS 
02/B8D8: 29 01        AND #$01
02/B8DA: D0 F0        BNE $B8CC
02/B8DC: 60           RTS 
; $02: 
02/B8DD: A5 37        LDA $37
02/B8DF: 10 11        BPL $B8F2
02/B8E1: A9 1B        LDA #$1B
02/B8E3: 8D B1 F2     STA $F2B1
02/B8E6: 20 A2 B8     JSR $B8A2
02/B8E9: A9 08        LDA #$08
02/B8EB: 8D 23 18     STA $1823
02/B8EE: 20 1F B9     JSR $B91F
02/B8F1: 60           RTS 
02/B8F2: A5 38        LDA $38
02/B8F4: 10 11        BPL $B907
02/B8F6: 20 1F B9     JSR $B91F
02/B8F9: 80 03        BRA $B8FE
02/B8FB: 20 13 B9     JSR $B913
02/B8FE: 20 6E BA     JSR $BA6E
02/B901: A9 01        LDA #$01
02/B903: 8D 23 18     STA $1823
02/B906: 60           RTS 
02/B907: 29 02        AND #$02
02/B909: D0 F0        BNE $B8FB
02/B90B: 60           RTS 

; [  ]

02/B90C: A5 38        LDA $38
02/B90E: 29 0F        AND #$0F
02/B910: D0 01        BNE $B913
02/B912: 60           RTS 
02/B913: A9 14        LDA #$14        ; system sound effect $14
02/B915: 8D 16 F4     STA $F416
02/B918: 60           RTS 

; [ play error sound effect ]

02/B919: A9 12        LDA #$12        ; system sound effect $12
02/B91B: 8D 16 F4     STA $F416
02/B91E: 60           RTS 

; [  ]

02/B91F: A9 13        LDA #$13        ; system sound effect $13
02/B921: 8D 16 F4     STA $F416
02/B924: 60           RTS 

; $01: 
02/B925: 20 0C B9     JSR $B90C
02/B928: A5 38        LDA $38
02/B92A: 29 0F        AND #$0F
02/B92C: C9 08        CMP #$08
02/B92E: D0 14        BNE $B944
02/B930: A5 60        LDA $60
02/B932: D0 04        BNE $B938
02/B934: A9 05        LDA #$05
02/B936: 85 60        STA $60
02/B938: C6 60        DEC $60
02/B93A: 20 BF BA     JSR $BABF
02/B93D: BD 02 33     LDA $3302,X
02/B940: 30 EE        BMI $B930
02/B942: 80 44        BRA $B988
02/B944: C9 04        CMP #$04
02/B946: D0 0E        BNE $B956
02/B948: A5 60        LDA $60
02/B94A: C9 04        CMP #$04
02/B94C: D0 04        BNE $B952
02/B94E: 64 60        STZ $60
02/B950: 80 02        BRA $B954
02/B952: E6 60        INC $60
02/B954: 80 32        BRA $B988
02/B956: C9 02        CMP #$02
02/B958: D0 15        BNE $B96F
02/B95A: A9 80        LDA #$80
02/B95C: 85 D8        STA $D8
02/B95E: A9 05        LDA #$05
02/B960: 85 D9        STA $D9
02/B962: 20 76 BA     JSR $BA76
02/B965: A9 03        LDA #$03
02/B967: 8D 23 18     STA $1823
02/B96A: A9 0C        LDA #$0C
02/B96C: 4C 58 BA     JMP $BA58
02/B96F: C9 01        CMP #$01
02/B971: D0 15        BNE $B988
02/B973: A9 80        LDA #$80
02/B975: 85 D8        STA $D8
02/B977: A9 06        LDA #$06
02/B979: 85 D9        STA $D9
02/B97B: 20 69 BA     JSR $BA69
02/B97E: A9 02        LDA #$02
02/B980: 8D 23 18     STA $1823
02/B983: A9 4C        LDA #$4C
02/B985: 4C 58 BA     JMP $BA58
02/B988: 20 BF BA     JSR $BABF
02/B98B: BD 02 33     LDA $3302,X
02/B98E: 30 B8        BMI $B948
02/B990: A9 28        LDA #$28
02/B992: 20 58 BA     JSR $BA58
02/B995: A5 37        LDA $37
02/B997: 10 46        BPL $B9DF
02/B999: A6 5F        LDX $5F
02/B99B: 86 61        STX $61
02/B99D: 20 5E BC     JSR $BC5E
02/B9A0: 20 BF BA     JSR $BABF
02/B9A3: 20 1F B9     JSR $B91F
02/B9A6: BD 03 33     LDA $3303,X
02/B9A9: 85 DC        STA $DC
02/B9AB: 8D B1 F2     STA $F2B1
02/B9AE: BD 02 33     LDA $3302,X     ; command targeting flags
02/B9B1: DA           PHX 
02/B9B2: 48           PHA 
02/B9B3: A9 01        LDA #$01
02/B9B5: 85 0E        STA $0E
02/B9B7: 68           PLA 
02/B9B8: 20 8B AD     JSR $AD8B       ; select default target
02/B9BB: FA           PLX 
02/B9BC: BD 03 33     LDA $3303,X     ; command id
02/B9BF: C9 16        CMP #$16
02/B9C1: F0 1D        BEQ $B9E0
02/B9C3: C9 18        CMP #$18
02/B9C5: F0 64        BEQ $BA2B
02/B9C7: C9 05        CMP #$05
02/B9C9: 90 03        BCC $B9CE
02/B9CB: 4C 45 BA     JMP $BA45
02/B9CE: 0A           ASL 
02/B9CF: AA           TAX 
02/B9D0: BF E8 B9 02  LDA $02B9E8,X
02/B9D4: 85 0E        STA $0E
02/B9D6: BF E9 B9 02  LDA $02B9E9,X
02/B9DA: 85 0F        STA $0F
02/B9DC: 6C 0E 00     JMP ($000E)
02/B9DF: 60           RTS 

; throw (dart)
02/B9E0: A9 08        LDA #$08
02/B9E2: 8D 9A EF     STA $EF9A
02/B9E5: 4C 0A BA     JMP $BA0A

02/B9E8: B9F4 BA07 BA1E BA2B BA38 BA45

; 0: fight
02/B9F4: A9 80        LDA #$80
02/B9F6: 85 D8        STA $D8
02/B9F8: A5 60        LDA $60
02/B9FA: 85 D9        STA $D9
02/B9FC: A9 01        LDA #$01
02/B9FE: 8D 91 EF     STA $EF91
02/BA01: A9 04        LDA #$04
02/BA03: 8D 23 18     STA $1823
02/BA06: 60           RTS 
; 1: item
02/BA07: 9C 9A EF     STZ $EF9A
02/BA0A: A9 05        LDA #$05
02/BA0C: 8D 23 18     STA $1823
02/BA0F: 9C 94 EF     STZ $EF94
02/BA12: 9C 97 EF     STZ $EF97
02/BA15: 9C 98 EF     STZ $EF98
02/BA18: 9C 99 EF     STZ $EF99
02/BA1B: 4C E4 AA     JMP $AAE4
; 2: white magic
02/BA1E: A9 00        LDA #$00
02/BA20: 8D 93 EF     STA $EF93
02/BA23: A9 09        LDA #$09
02/BA25: 8D 23 18     STA $1823
02/BA28: 4C 59 AB     JMP $AB59
; 3: black magic/ninja
02/BA2B: A9 60        LDA #$60
02/BA2D: 8D 93 EF     STA $EF93
02/BA30: A9 09        LDA #$09
02/BA32: 8D 23 18     STA $1823
02/BA35: 4C 79 AB     JMP $AB79
; 4: summon
02/BA38: A9 C0        LDA #$C0
02/BA3A: 8D 93 EF     STA $EF93
02/BA3D: A9 09        LDA #$09
02/BA3F: 8D 23 18     STA $1823
02/BA42: 4C 9A AB     JMP $AB9A
; default
02/BA45: A9 80        LDA #$80
02/BA47: 85 D8        STA $D8
02/BA49: A5 60        LDA $60
02/BA4B: 85 D9        STA $D9
02/BA4D: A9 01        LDA #$01
02/BA4F: 8D 91 EF     STA $EF91
02/BA52: A9 07        LDA #$07
02/BA54: 8D 23 18     STA $1823
02/BA57: 60           RTS 

; [  ]

02/BA58: 8D 6B EF     STA $EF6B       ; set menu cursor 1 x position
02/BA5B: A5 60        LDA $60
02/BA5D: AA           TAX 
02/BA5E: BF 51 FC 16  LDA $16FC51,X
02/BA62: AA           TAX 
02/BA63: 8E 6D EF     STX $EF6D       ; set menu cursor 1 y position
02/BA66: 4C 64 BC     JMP $BC64

; [  ]

02/BA69: A5 60        LDA $60
02/BA6B: 4C 86 BA     JMP $BA86
02/BA6E: A5 60        LDA $60
02/BA70: 18           CLC 
02/BA71: 69 05        ADC #$05
02/BA73: 4C 86 BA     JMP $BA86
02/BA76: A5 60        LDA $60
02/BA78: 18           CLC 
02/BA79: 69 0A        ADC #$0A
02/BA7B: 4C 86 BA     JMP $BA86
02/BA7E: A5 60        LDA $60
02/BA80: 18           CLC 
02/BA81: 69 0F        ADC #$0F
02/BA83: 4C 86 BA     JMP $BA86
02/BA86: 0A           ASL 
02/BA87: AA           TAX 
02/BA88: BF 97 BA 02  LDA $02BA97,X
02/BA8C: 85 0E        STA $0E
02/BA8E: BF 98 BA 02  LDA $02BA98,X
02/BA92: 85 0F        STA $0F
02/BA94: 6C 0E 00     JMP ($000E)

02/BA97: A9AF A9C1 A9D3 A9E5 A9F7 A9B8 A9CA A9DC
02/BAA7: A9EE AA00 AA09 AA1B AA2D AA3F AA51 AA12
02/BAB7: AA24 AA36 AA48 AA5A

; [  ]

02/BABF: AD 22 18     LDA $1822
02/BAC2: AA           TAX 
02/BAC3: BF D4 FF 0D  LDA $0DFFD4,X
02/BAC7: 85 0E        STA $0E
02/BAC9: A5 60        LDA $60
02/BACB: 0A           ASL 
02/BACC: 0A           ASL 
02/BACD: 18           CLC 
02/BACE: 65 0E        ADC $0E
02/BAD0: AA           TAX 
02/BAD1: 60           RTS 
02/BAD2: A2 00 00     LDX #$0000
02/BAD5: BF 3C FC 16  LDA $16FC3C,X
02/BAD9: 9D 18 03     STA $0318,X
02/BADC: E8           INX 
02/BADD: E0 10 00     CPX #$0010
02/BAE0: D0 F3        BNE $BAD5
02/BAE2: AD 83 EF     LDA $EF83
02/BAE5: F0 07        BEQ $BAEE
02/BAE7: AD 01 05     LDA $0501
02/BAEA: 09 50        ORA #$50
02/BAEC: 80 05        BRA $BAF3
02/BAEE: AD 01 05     LDA $0501
02/BAF1: 29 0F        AND #$0F
02/BAF3: 8D 01 05     STA $0501
02/BAF6: AD 84 EF     LDA $EF84
02/BAF9: F0 07        BEQ $BB02
02/BAFB: AD 02 05     LDA $0502
02/BAFE: 09 05        ORA #$05
02/BB00: 80 05        BRA $BB07
02/BB02: AD 02 05     LDA $0502
02/BB05: 29 F0        AND #$F0
02/BB07: 8D 02 05     STA $0502
02/BB0A: 60           RTS 
02/BB0B: 48           PHA 
02/BB0C: AD C0 6C     LDA $6CC0
02/BB0F: F0 07        BEQ $BB18
02/BB11: 68           PLA 
02/BB12: 49 FF        EOR #$FF
02/BB14: 38           SEC 
02/BB15: E9 08        SBC #$08
02/BB17: 60           RTS 
02/BB18: 68           PLA 
02/BB19: 60           RTS 

; [  ]

02/BB1A: 48           PHA 
02/BB1B: AD C0 6C     LDA $6CC0
02/BB1E: F0 07        BEQ $BB27
02/BB20: 68           PLA 
02/BB21: 49 FF        EOR #$FF
02/BB23: 38           SEC 
02/BB24: E9 10        SBC #$10
02/BB26: 60           RTS 
02/BB27: 68           PLA 
02/BB28: 60           RTS 

; [ draw target cursor sprites ]

02/BB29: AD C0 6C     LDA $6CC0
02/BB2C: F0 07        BEQ $BB35       ; branch if not a back attack
02/BB2E: A2 4A 71     LDX #$714A      ; tile id and flags (h-flip)
02/BB31: 86 0E        STX $0E
02/BB33: 80 05        BRA $BB3A
02/BB35: A2 4A 31     LDX #$314A      ; tile id and flags
02/BB38: 86 0E        STX $0E
02/BB3A: AD 7A EF     LDA $EF7A       ; cursor 1
02/BB3D: 20 1A BB     JSR $BB1A
02/BB40: 8D 08 03     STA $0308
02/BB43: AD 7B EF     LDA $EF7B
02/BB46: 8D 09 03     STA $0309
02/BB49: A6 0E        LDX $0E
02/BB4B: 8E 0A 03     STX $030A
02/BB4E: AD 7C EF     LDA $EF7C       ; cursor 2
02/BB51: 20 1A BB     JSR $BB1A
02/BB54: 8D 0C 03     STA $030C
02/BB57: AD 7D EF     LDA $EF7D
02/BB5A: 8D 0D 03     STA $030D
02/BB5D: A6 0E        LDX $0E
02/BB5F: 8E 0E 03     STX $030E
02/BB62: AD 7E EF     LDA $EF7E       ; cursor 3
02/BB65: 20 1A BB     JSR $BB1A
02/BB68: 8D 10 03     STA $0310
02/BB6B: AD 7F EF     LDA $EF7F
02/BB6E: 8D 11 03     STA $0311
02/BB71: A6 0E        LDX $0E
02/BB73: 8E 12 03     STX $0312
02/BB76: AD 80 EF     LDA $EF80       ; cursor 4
02/BB79: 20 1A BB     JSR $BB1A
02/BB7C: 8D 14 03     STA $0314
02/BB7F: AD 81 EF     LDA $EF81
02/BB82: 8D 15 03     STA $0315
02/BB85: A6 0E        LDX $0E
02/BB87: 8E 16 03     STX $0316
02/BB8A: AD 76 EF     LDA $EF76       ; set x position msb and large sprite flag
02/BB8D: F0 07        BEQ $BB96
02/BB8F: AD 00 05     LDA $0500
02/BB92: 09 10        ORA #$10
02/BB94: 80 07        BRA $BB9D
02/BB96: AD 00 05     LDA $0500
02/BB99: 29 CF        AND #$CF
02/BB9B: 09 20        ORA #$20
02/BB9D: 8D 00 05     STA $0500
02/BBA0: AD 77 EF     LDA $EF77
02/BBA3: F0 07        BEQ $BBAC
02/BBA5: AD 00 05     LDA $0500
02/BBA8: 09 40        ORA #$40
02/BBAA: 80 07        BRA $BBB3
02/BBAC: AD 00 05     LDA $0500
02/BBAF: 29 3F        AND #$3F
02/BBB1: 09 80        ORA #$80
02/BBB3: 8D 00 05     STA $0500
02/BBB6: AD 78 EF     LDA $EF78
02/BBB9: F0 07        BEQ $BBC2
02/BBBB: AD 01 05     LDA $0501
02/BBBE: 09 01        ORA #$01
02/BBC0: 80 07        BRA $BBC9
02/BBC2: AD 01 05     LDA $0501
02/BBC5: 29 FC        AND #$FC
02/BBC7: 09 02        ORA #$02
02/BBC9: 8D 01 05     STA $0501
02/BBCC: AD 79 EF     LDA $EF79
02/BBCF: F0 07        BEQ $BBD8
02/BBD1: AD 01 05     LDA $0501
02/BBD4: 09 04        ORA #$04
02/BBD6: 80 07        BRA $BBDF
02/BBD8: AD 01 05     LDA $0501
02/BBDB: 29 F3        AND #$F3
02/BBDD: 09 08        ORA #$08
02/BBDF: 8D 01 05     STA $0501
02/BBE2: 60           RTS 

; [ draw menu cursor sprite ]

02/BBE3: AD 6B EF     LDA $EF6B       ; menu cursor 1 position
02/BBE6: 8D 00 03     STA $0300
02/BBE9: AD 6D EF     LDA $EF6D
02/BBEC: 8D 01 03     STA $0301
02/BBEF: AD 6F EF     LDA $EF6F       ; menu cursor 2 position
02/BBF2: 8D 04 03     STA $0304
02/BBF5: AD 71 EF     LDA $EF71
02/BBF8: 8D 05 03     STA $0305
02/BBFB: A2 4A 31     LDX #$314A      ; tile id and flags
02/BBFE: 8E 02 03     STX $0302
02/BC01: 8E 06 03     STX $0306
02/BC04: AD 69 EF     LDA $EF69       ; set x position msb and large sprite flag
02/BC07: 0D 6E EF     ORA $EF6E
02/BC0A: F0 07        BEQ $BC13
02/BC0C: AD 00 05     LDA $0500
02/BC0F: 09 03        ORA #$03
02/BC11: 80 07        BRA $BC1A
02/BC13: AD 00 05     LDA $0500
02/BC16: 29 FC        AND #$FC
02/BC18: 09 02        ORA #$02
02/BC1A: 8D 00 05     STA $0500
02/BC1D: AD 6A EF     LDA $EF6A
02/BC20: 0D 72 EF     ORA $EF72
02/BC23: F0 0A        BEQ $BC2F
02/BC25: AD 00 05     LDA $0500
02/BC28: 09 0C        ORA #$0C
02/BC2A: 8D 00 05     STA $0500
02/BC2D: 80 07        BRA $BC36
02/BC2F: AD 00 05     LDA $0500
02/BC32: 29 F3        AND #$F3
02/BC34: 09 08        ORA #$08
02/BC36: 8D 00 05     STA $0500
02/BC39: 60           RTS 

02/BC3A: 9C 83 EF     STZ $EF83
02/BC3D: 60           RTS 

02/BC3E: 9C 84 EF     STZ $EF84
02/BC41: 60           RTS 

02/BC42: A9 01        LDA #$01
02/BC44: 8D 83 EF     STA $EF83
02/BC47: 60           RTS 

02/BC48: A9 01        LDA #$01
02/BC4A: 8D 84 EF     STA $EF84
02/BC4D: 60           RTS 

02/BC4E: A9 01        LDA #$01
02/BC50: 8D 83 EF     STA $EF83
02/BC53: 8D 84 EF     STA $EF84
02/BC56: 60           RTS 

02/BC57: 9C 83 EF     STZ $EF83
02/BC5A: 9C 84 EF     STZ $EF84
02/BC5D: 60           RTS 

02/BC5E: A9 01        LDA #$01
02/BC60: 8D 69 EF     STA $EF69
02/BC63: 60           RTS 

02/BC64: 9C 69 EF     STZ $EF69
02/BC67: 60           RTS 

02/BC68: 9C 6A EF     STZ $EF6A
02/BC6B: 9C 73 EF     STZ $EF73
02/BC6E: 60           RTS 

02/BC6F: A9 01        LDA #$01
02/BC71: 8D 6A EF     STA $EF6A
02/BC74: 8D 73 EF     STA $EF73
02/BC77: 60           RTS 

02/BC78: 9C 69 EF     STZ $EF69
02/BC7B: 9C 6A EF     STZ $EF6A
02/BC7E: 9C 73 EF     STZ $EF73
02/BC81: 60           RTS 

02/BC82: A9 01        LDA #$01
02/BC84: 8D 69 EF     STA $EF69
02/BC87: 8D 6A EF     STA $EF6A
02/BC8A: 8D 73 EF     STA $EF73
02/BC8D: 60           RTS 

02/BC8E: A9 01        LDA #$01
02/BC90: 8D 76 EF     STA $EF76
02/BC93: 8D 77 EF     STA $EF77
02/BC96: 8D 78 EF     STA $EF78
02/BC99: 8D 79 EF     STA $EF79
02/BC9C: 60           RTS 

; --------------------------------------------------------------------------

; [ do special animation ]

02/BC9D: 22 0E EE 01  JSL $01EE0E
02/BCA1: 60           RTS 

; [ draw attack name window ]

02/BCA2: AD C0 6C     LDA $6CC0
02/BCA5: F0 03        BEQ $BCAA
02/BCA7: 4C 04 93     JMP $9304       ; draw message window (left)
02/BCAA: 4C 60 93     JMP $9360       ; draw message window (right)

; [  ]

02/BCAD: A0 00 60     LDY #$6000
02/BCB0: 80 03        BRA $BCB5
02/BCB2: A0 00 64     LDY #$6400
02/BCB5: A2 80 04     LDX #$0480
02/BCB8: 86 00        STX $00
02/BCBA: A9 7E        LDA #$7E
02/BCBC: A2 FD 6C     LDX #$6CFD
02/BCBF: 4C B2 84     JMP $84B2

; [ clear bg1 h-scroll hdma data ]

02/BCC2: A2 00 00     LDX #$0000
02/BCC5: 9D 13 76     STA $7613,X     ; clear bg1 h-scroll hdma data
02/BCC8: E8           INX 
02/BCC9: E8           INX 
02/BCCA: E8           INX 
02/BCCB: E8           INX 
02/BCCC: E0 30 02     CPX #$0230
02/BCCF: D0 F4        BNE $BCC5
02/BCD1: 60           RTS 

; [ set ??? palette to black and white ]

; used for flashing active monster ???

02/BCD2: 7B           TDC 
02/BCD3: A8           TAY 
02/BCD4: 7B           TDC 
02/BCD5: 99 30 EE     STA $EE30,Y
02/BCD8: E8           INX 
02/BCD9: C8           INY 
02/BCDA: C0 20 00     CPY #$0020
02/BCDD: D0 F5        BNE $BCD4
02/BCDF: A2 FF 7F     LDX #$7FFF
02/BCE2: 8E 32 EE     STX $EE32
02/BCE5: 60           RTS 

; [  ]

02/BCE6: 64 4E        STZ $4E
02/BCE8: A9 01        LDA #$01
02/BCEA: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BCED: 20 13 85     JSR $8513       ; wait one frame
02/BCF0: A5 4E        LDA $4E
02/BCF2: 29 04        AND #$04
02/BCF4: 4A           LSR 
02/BCF5: 4A           LSR 
02/BCF6: 49 01        EOR #$01
02/BCF8: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BCFB: E6 4E        INC $4E
02/BCFD: A5 4E        LDA $4E
02/BCFF: C9 10        CMP #$10
02/BD01: D0 EA        BNE $BCED
02/BD03: 7B           TDC 
02/BD04: 4C C2 BC     JMP $BCC2       ; clear bg1 h-scroll hdma data

; [  ]

02/BD07: C2 20        REP #$20
02/BD09: A5 00        LDA $00
02/BD0B: 29 1F 00     AND #$001F
02/BD0E: C9 1F 00     CMP #$001F
02/BD11: F0 08        BEQ $BD1B
02/BD13: A5 00        LDA $00
02/BD15: 18           CLC 
02/BD16: 69 01 00     ADC #$0001
02/BD19: 85 00        STA $00
02/BD1B: A5 00        LDA $00
02/BD1D: 29 E0 03     AND #$03E0
02/BD20: C9 E0 03     CMP #$03E0
02/BD23: F0 08        BEQ $BD2D
02/BD25: A5 00        LDA $00
02/BD27: 18           CLC 
02/BD28: 69 20 00     ADC #$0020
02/BD2B: 85 00        STA $00
02/BD2D: A5 00        LDA $00
02/BD2F: 29 00 7C     AND #$7C00
02/BD32: C9 00 7C     CMP #$7C00
02/BD35: F0 08        BEQ $BD3F
02/BD37: A5 00        LDA $00
02/BD39: 18           CLC 
02/BD3A: 69 00 04     ADC #$0400
02/BD3D: 85 00        STA $00
02/BD3F: 7B           TDC 
02/BD40: E2 20        SEP #$20
02/BD42: 60           RTS 

; [  ]

02/BD43: 85 26        STA $26
02/BD45: 64 27        STZ $27
02/BD47: C2 20        REP #$20
02/BD49: A5 26        LDA $26
02/BD4B: 0A           ASL 
02/BD4C: 0A           ASL 
02/BD4D: 0A           ASL 
02/BD4E: 0A           ASL 
02/BD4F: 0A           ASL 
02/BD50: 85 28        STA $28
02/BD52: 0A           ASL 
02/BD53: 0A           ASL 
02/BD54: 0A           ASL 
02/BD55: 0A           ASL 
02/BD56: 0A           ASL 
02/BD57: 85 2A        STA $2A
02/BD59: A5 00        LDA $00
02/BD5B: 29 1F 00     AND #$001F
02/BD5E: F0 14        BEQ $BD74
02/BD60: C5 26        CMP $26
02/BD62: 90 09        BCC $BD6D
02/BD64: A5 00        LDA $00
02/BD66: 38           SEC 
02/BD67: E5 26        SBC $26
02/BD69: 85 00        STA $00
02/BD6B: 80 07        BRA $BD74
02/BD6D: A5 00        LDA $00
02/BD6F: 29 E0 7F     AND #$7FE0
02/BD72: 85 00        STA $00
02/BD74: A5 00        LDA $00
02/BD76: 29 E0 03     AND #$03E0
02/BD79: F0 14        BEQ $BD8F
02/BD7B: C5 28        CMP $28
02/BD7D: 90 09        BCC $BD88
02/BD7F: A5 00        LDA $00
02/BD81: 38           SEC 
02/BD82: E5 28        SBC $28
02/BD84: 85 00        STA $00
02/BD86: 80 07        BRA $BD8F
02/BD88: A5 00        LDA $00
02/BD8A: 29 1F 3E     AND #$3E1F
02/BD8D: 85 00        STA $00
02/BD8F: A5 00        LDA $00
02/BD91: 29 00 7C     AND #$7C00
02/BD94: F0 14        BEQ $BDAA
02/BD96: C5 2A        CMP $2A
02/BD98: 90 09        BCC $BDA3
02/BD9A: A5 00        LDA $00
02/BD9C: 38           SEC 
02/BD9D: E5 2A        SBC $2A
02/BD9F: 85 00        STA $00
02/BDA1: 80 07        BRA $BDAA
02/BDA3: A5 00        LDA $00
02/BDA5: 29 FF 03     AND #$03FF
02/BDA8: 85 00        STA $00
02/BDAA: 7B           TDC 
02/BDAB: E2 20        SEP #$20
02/BDAD: 60           RTS 

; [  ]

02/BDAE: AD C2 34     LDA $34C2
02/BDB1: 30 1F        BMI $BDD2
02/BDB3: AD 29 35     LDA $3529
02/BDB6: D0 1A        BNE $BDD2
02/BDB8: A5 48        LDA $48
02/BDBA: AA           TAX 
02/BDBB: A9 01        LDA #$01
02/BDBD: 9D AF F0     STA $F0AF,X
02/BDC0: 9E 99 F0     STZ $F099,X
02/BDC3: 20 B8 C5     JSR $C5B8
02/BDC6: DA           PHX 
02/BDC7: 20 13 85     JSR $8513       ; wait one frame
02/BDCA: FA           PLX 
02/BDCB: BD C5 EF     LDA $EFC5,X
02/BDCE: C9 C0        CMP #$C0
02/BDD0: D0 F4        BNE $BDC6
02/BDD2: 60           RTS 

; [  ]

02/BDD3: 7B           TDC 
02/BDD4: AA           TAX 
02/BDD5: A8           TAY 
02/BDD6: C2 20        REP #$20
02/BDD8: B9 D4 F2     LDA $F2D4,Y
02/BDDB: 99 F4 F2     STA $F2F4,Y
02/BDDE: B9 D6 F2     LDA $F2D6,Y
02/BDE1: 99 F6 F2     STA $F2F6,Y
02/BDE4: BD 83 22     LDA $2283,X
02/BDE7: 99 D4 F2     STA $F2D4,Y
02/BDEA: BD 85 22     LDA $2285,X
02/BDED: 99 D6 F2     STA $F2D6,Y
02/BDF0: 8A           TXA 
02/BDF1: 18           CLC 
02/BDF2: 69 80 00     ADC #$0080
02/BDF5: AA           TAX 
02/BDF6: 7B           TDC 
02/BDF7: E2 20        SEP #$20
02/BDF9: C8           INY 
02/BDFA: C8           INY 
02/BDFB: C8           INY 
02/BDFC: C8           INY 
02/BDFD: E0 00 04     CPX #$0400
02/BE00: D0 D4        BNE $BDD6
02/BE02: 7B           TDC 
02/BE03: AA           TAX 
02/BE04: BD D4 F2     LDA $F2D4,X
02/BE07: 29 F8        AND #$F8
02/BE09: 0A           ASL 
02/BE0A: 85 00        STA $00
02/BE0C: BD D6 F2     LDA $F2D6,X
02/BE0F: 0A           ASL 
02/BE10: 0A           ASL 
02/BE11: 29 80        AND #$80
02/BE13: 05 00        ORA $00
02/BE15: 85 00        STA $00
02/BE17: BD F4 F2     LDA $F2F4,X
02/BE1A: 29 F8        AND #$F8
02/BE1C: 0A           ASL 
02/BE1D: 85 01        STA $01
02/BE1F: BD F6 F2     LDA $F2F6,X
02/BE22: 0A           ASL 
02/BE23: 0A           ASL 
02/BE24: 29 80        AND #$80
02/BE26: 05 01        ORA $01
02/BE28: 85 01        STA $01
02/BE2A: C5 00        CMP $00
02/BE2C: F0 1E        BEQ $BE4C
02/BE2E: A5 00        LDA $00
02/BE30: 45 01        EOR $01
02/BE32: 85 03        STA $03
02/BE34: A5 00        LDA $00
02/BE36: 25 01        AND $01
02/BE38: 85 02        STA $02
02/BE3A: 7B           TDC 
02/BE3B: A8           TAY 
02/BE3C: 06 03        ASL $03
02/BE3E: B0 0A        BCS $BE4A
02/BE40: 06 02        ASL $02
02/BE42: B0 08        BCS $BE4C
02/BE44: C8           INY 
02/BE45: C0 04 00     CPY #$0004
02/BE48: D0 F2        BNE $BE3C
02/BE4A: 80 0A        BRA $BE56
02/BE4C: E8           INX 
02/BE4D: E8           INX 
02/BE4E: E8           INX 
02/BE4F: E8           INX 
02/BE50: E0 20 00     CPX #$0020
02/BE53: D0 AF        BNE $BE04
02/BE55: 60           RTS 
02/BE56: DA           PHX 
02/BE57: A9 07        LDA #$07
02/BE59: 8D 14 F3     STA $F314
02/BE5C: AD 14 F3     LDA $F314
02/BE5F: 8D 15 F3     STA $F315
02/BE62: 20 13 85     JSR $8513       ; wait one frame
02/BE65: 7B           TDC 
02/BE66: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BE69: CE 15 F3     DEC $F315
02/BE6C: D0 F4        BNE $BE62
02/BE6E: A9 08        LDA #$08
02/BE70: 38           SEC 
02/BE71: ED 14 F3     SBC $F314
02/BE74: 8D 15 F3     STA $F315
02/BE77: 20 13 85     JSR $8513       ; wait one frame
02/BE7A: A9 01        LDA #$01
02/BE7C: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BE7F: CE 15 F3     DEC $F315
02/BE82: D0 F3        BNE $BE77
02/BE84: CE 14 F3     DEC $F314
02/BE87: D0 D3        BNE $BE5C
02/BE89: FA           PLX 
02/BE8A: 60           RTS 

; [  ]

02/BE8B: 20 07 E7     JSR $E707
02/BE8E: AD 5A F3     LDA $F35A
02/BE91: F0 17        BEQ $BEAA
02/BE93: A9 FF        LDA #$FF
02/BE95: 8D 20 F3     STA $F320
02/BE98: 20 79 F2     JSR $F279
02/BE9B: 20 13 85     JSR $8513       ; wait one frame
02/BE9E: 20 36 C7     JSR $C736
02/BEA1: 9C 5A F3     STZ $F35A
02/BEA4: 9C 20 F3     STZ $F320
02/BEA7: 20 54 C7     JSR $C754
02/BEAA: 60           RTS 

; [ execute graphics script (far) ]

02/BEAB: 20 F0 BE     JSR $BEF0       ; execute graphics script
02/BEAE: 6B           RTL 

; [ battle graphics $05: graphics script ]

02/BEAF: 20 C8 96     JSR $96C8
02/BEB2: 20 F0 BE     JSR $BEF0       ; execute graphics script
02/BEB5: AD 74 F4     LDA $F474
02/BEB8: F0 07        BEQ $BEC1       ; branch if no mist dragon vs. golbez
02/BEBA: 22 90 EF 01  JSL $01EF90     ; show mist dragon vs. golbez
02/BEBE: 9C 74 F4     STZ $F474
02/BEC1: 60           RTS 

; [ init buffer pointers ]

02/BEC2: A2 C2 33     LDX #$33C2      ; graphics script buffer
02/BEC5: 86 3F        STX $3F
02/BEC7: A2 22 35     LDX #$3522      ; reflected targets
02/BECA: 86 43        STX $43
02/BECC: A2 D4 34     LDX #$34D4      ; damage buffer
02/BECF: 86 41        STX $41
02/BED1: A2 CA 34     LDX #$34CA      ; battle messages
02/BED4: 86 45        STX $45
02/BED6: 60           RTS 

; [ battle graphics $11: display damage numerals ]

02/BED7: 20 C2 BE     JSR $BEC2       ; init buffer pointers
02/BEDA: 4C A6 C9     JMP $C9A6       ; damage numerals

; [  ]

02/BEDD: 20 B2 BC     JSR $BCB2
02/BEE0: A9 01        LDA #$01
02/BEE2: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BEE5: 20 D3 BD     JSR $BDD3
02/BEE8: 20 AD BC     JSR $BCAD
02/BEEB: 7B           TDC 
02/BEEC: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/BEEF: 6B           RTL 

; --------------------------------------------------------------------------

; [ execute graphics script ]

02/BEF0: AD 25 F4     LDA $F425
02/BEF3: F0 01        BEQ $BEF6
02/BEF5: 60           RTS 
02/BEF6: 9C 5A F3     STZ $F35A
02/BEF9: 20 13 85     JSR $8513       ; wait one frame
02/BEFC: 20 C2 BE     JSR $BEC2       ; init buffer pointers
02/BEFF: AD C3 34     LDA $34C3       ; attacker id
02/BF02: 85 48        STA $48
02/BF04: 7B           TDC 
02/BF05: AA           TAX 
02/BF06: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/BF0A: CD C5 34     CMP $34C5       ; find first target
02/BF0D: F0 08        BEQ $BF17
02/BF0F: E8           INX 
02/BF10: E0 08 00     CPX #$0008
02/BF13: D0 F1        BNE $BF06
02/BF15: 7B           TDC             ; zero if no targets found
02/BF16: AA           TAX 
02/BF17: 8A           TXA 
02/BF18: 85 49        STA $49         ; target id
02/BF1A: AD C2 34     LDA $34C2
02/BF1D: 10 30        BPL $BF4F       ; branch if character attacker
02/BF1F: AD 4E ED     LDA $ED4E
02/BF22: 29 10        AND #$10
02/BF24: D0 29        BNE $BF4F       ; branch if enemy character
02/BF26: AD C2 34     LDA $34C2
02/BF29: 29 40        AND #$40
02/BF2B: D0 22        BNE $BF4F       ; branch if monster flash is disabled
02/BF2D: 20 DD E8     JSR $E8DD
02/BF30: 20 35 8D     JSR $8D35
02/BF33: 20 E2 E8     JSR $E8E2
02/BF36: A5 48        LDA $48
02/BF38: 8D 09 F1     STA $F109
02/BF3B: A9 07        LDA #$07
02/BF3D: 8D 0A F1     STA $F10A
02/BF40: 20 89 8A     JSR $8A89
02/BF43: 20 C7 8B     JSR $8BC7
02/BF46: 20 D2 BC     JSR $BCD2
02/BF49: 20 B2 BC     JSR $BCB2
02/BF4C: 20 E6 BC     JSR $BCE6
02/BF4F: B2 3F        LDA ($3F)
02/BF51: C9 A9        CMP #$A9
02/BF53: 90 2A        BCC $BF7F
02/BF55: C9 C0        CMP #$C0
02/BF57: 90 16        BCC $BF6F
02/BF59: C9 E8        CMP #$E8
02/BF5B: 90 1A        BCC $BF77
02/BF5D: C9 FF        CMP #$FF
02/BF5F: F0 26        BEQ $BF87
02/BF61: C9 F0        CMP #$F0
02/BF63: 90 05        BCC $BF6A
; $F0-$FE: other commands
02/BF65: 20 A7 C8     JSR $C8A7       ; do graphics script command $F0-$FE
02/BF68: 80 18        BRA $BF82
; $E8-$EF: unused
02/BF6A: 20 E9 C8     JSR $C8E9
02/BF6D: 80 13        BRA $BF82
; $A9-$BF: special animation
02/BF6F: 20 9D BC     JSR $BC9D       ; do special animation
02/BF72: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/BF75: 80 D8        BRA $BF4F
; $C0-$E7: command animation
02/BF77: 20 33 C0     JSR $C033       ; do command animation
02/BF7A: 20 07 E7     JSR $E707
02/BF7D: 80 03        BRA $BF82
; $00-$A8: magic animation
02/BF7F: 20 C1 EA     JSR $EAC1       ; do magic animation
02/BF82: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/BF85: 80 C8        BRA $BF4F
; $FF: end of script
02/BF87: 7B           TDC 
02/BF88: AA           TAX 
02/BF89: 9E AF F0     STZ $F0AF,X
02/BF8C: E8           INX 
02/BF8D: E0 05 00     CPX #$0005
02/BF90: D0 F7        BNE $BF89
02/BF92: 20 F9 E8     JSR $E8F9
02/BF95: 20 2F 8D     JSR $8D2F
02/BF98: 22 DD BE 02  JSL $02BEDD
02/BF9C: 7B           TDC 
02/BF9D: AA           TAX 
02/BF9E: 86 0A        STX $0A
02/BFA0: DA           PHX 
02/BFA1: 8A           TXA 
02/BFA2: A8           TAY 
02/BFA3: 20 07 E1     JSR $E107
02/BFA6: BD 03 20     LDA $2003,X
02/BFA9: 29 08        AND #$08
02/BFAB: F0 0B        BEQ $BFB8
02/BFAD: B9 35 F2     LDA $F235,Y
02/BFB0: C9 0E        CMP #$0E
02/BFB2: F0 2D        BEQ $BFE1
02/BFB4: A9 0E        LDA #$0E
02/BFB6: 80 0C        BRA $BFC4
02/BFB8: B9 35 F2     LDA $F235,Y
02/BFBB: C9 0E        CMP #$0E
02/BFBD: D0 22        BNE $BFE1
02/BFBF: BD 01 20     LDA $2001,X
02/BFC2: 29 1F        AND #$1F
02/BFC4: 99 35 F2     STA $F235,Y
02/BFC7: 48           PHA 
02/BFC8: 98           TYA 
02/BFC9: 0A           ASL 
02/BFCA: 0A           ASL 
02/BFCB: A8           TAY 
02/BFCC: B9 15 F0     LDA $F015,Y
02/BFCF: 29 C7        AND #$C7
02/BFD1: 85 00        STA $00
02/BFD3: BD 03 20     LDA $2003,X
02/BFD6: 29 38        AND #$38
02/BFD8: 05 00        ORA $00
02/BFDA: 99 15 F0     STA $F015,Y
02/BFDD: 68           PLA 
02/BFDE: 20 FB BF     JSR $BFFB
02/BFE1: C2 20        REP #$20
02/BFE3: A5 0A        LDA $0A
02/BFE5: 18           CLC 
02/BFE6: 69 00 04     ADC #$0400
02/BFE9: 85 0A        STA $0A
02/BFEB: 7B           TDC 
02/BFEC: E2 20        SEP #$20
02/BFEE: FA           PLX 
02/BFEF: E8           INX 
02/BFF0: E0 05 00     CPX #$0005
02/BFF3: D0 AB        BNE $BFA0
02/BFF5: 20 74 C9     JSR $C974       ; wait for message window
02/BFF8: 4C A8 93     JMP $93A8       ; close message window

; [  ]

02/BFFB: DA           PHX 
02/BFFC: C9 0F        CMP #$0F
02/BFFE: 90 06        BCC $C006
02/C000: 20 F1 E0     JSR $E0F1
02/C003: 4C 11 C0     JMP $C011
02/C006: AA           TAX 
02/C007: 86 26        STX $26
02/C009: A2 00 08     LDX #$0800
02/C00C: 86 28        STX $28
02/C00E: 20 7C 85     JSR $857C       ; multiply (16-bit)
02/C011: C2 20        REP #$20
02/C013: A5 2A        LDA $2A
02/C015: 18           CLC 
02/C016: 69 00 80     ADC #$8000
02/C019: AA           TAX 
02/C01A: A9 00 08     LDA #$0800
02/C01D: 85 00        STA $00
02/C01F: 7B           TDC 
02/C020: E2 20        SEP #$20
02/C022: A4 0A        LDY $0A
02/C024: A9 1A        LDA #$1A
02/C026: 20 B2 84     JSR $84B2
02/C029: FA           PLX 
02/C02A: 60           RTS 

; [ get next graphics script byte ]

02/C02B: A6 3F        LDX $3F
02/C02D: E8           INX 
02/C02E: 86 3F        STX $3F
02/C030: B2 3F        LDA ($3F)
02/C032: 60           RTS 

; [ do command animation ]

02/C033: 38           SEC 
02/C034: E9 C0        SBC #$C0
02/C036: 0A           ASL 
02/C037: AA           TAX 
02/C038: AD C4 34     LDA $34C4
02/C03B: 8D 85 F4     STA $F485
02/C03E: BF 4D C0 02  LDA $02C04D,X
02/C042: 85 00        STA $00
02/C044: BF 4E C0 02  LDA $02C04E,X
02/C048: 85 01        STA $01
02/C04A: 6C 00 00     JMP ($0000)

; command animation jump table
02/C04D: C6BF C7B1 C6D2 C6DF C718 C81D C619 C7A9  ; $00
02/C05D: C6C5 C5CC C7F1 C7F1 C88B C0B4 C2D9 C6C5
02/C06D: C09D C79A C793 C7F1 C7A9 C0B4 C117 C7F1  ; $10
02/C07D: C7F1 C7A1 C6B8 C2A9 C555 C0B4 C476 C6BF
02/C08D: C0C1 C0B4 C0B4 C0B4 C0B4 C72A C0B4 C0B4  ; $20

; [ command animation $10: twin 1 ]

02/C09D: AD 39 35     LDA $3539
02/C0A0: 29 7F        AND #$7F
02/C0A2: AA           TAX 
02/C0A3: A9 0A        LDA #$0A
02/C0A5: 9D 99 F0     STA $F099,X
02/C0A8: AD 3A 35     LDA $353A
02/C0AB: 29 7F        AND #$7F
02/C0AD: AA           TAX 
02/C0AE: A9 0A        LDA #$0A
02/C0B0: 9D 99 F0     STA $F099,X
02/C0B3: 60           RTS 

; [ unused command animation ]

02/C0B4: 60           RTS 

; [  ]

02/C0B5: 29 7F        AND #$7F
02/C0B7: AA           TAX 
02/C0B8: A9 01        LDA #$01
02/C0BA: 9D AF F0     STA $F0AF,X
02/C0BD: 9E 99 F0     STZ $F099,X
02/C0C0: 60           RTS 

; [ command animation $20: twin 2 ]

02/C0C1: AD 29 35     LDA $3529
02/C0C4: D0 3C        BNE $C102
02/C0C6: AD 39 35     LDA $3539
02/C0C9: 30 03        BMI $C0CE
02/C0CB: 20 B5 C0     JSR $C0B5
02/C0CE: AD 3A 35     LDA $353A
02/C0D1: 30 03        BMI $C0D6
02/C0D3: 20 B5 C0     JSR $C0B5
02/C0D6: AD 39 35     LDA $3539
02/C0D9: 30 11        BMI $C0EC
02/C0DB: 0A           ASL 
02/C0DC: 0A           ASL 
02/C0DD: 0A           ASL 
02/C0DE: 0A           ASL 
02/C0DF: AA           TAX 
02/C0E0: DA           PHX 
02/C0E1: 20 13 85     JSR $8513       ; wait one frame
02/C0E4: FA           PLX 
02/C0E5: BD C5 EF     LDA $EFC5,X
02/C0E8: C9 C0        CMP #$C0
02/C0EA: D0 F4        BNE $C0E0
02/C0EC: AD 3A 35     LDA $353A
02/C0EF: 30 11        BMI $C102
02/C0F1: 0A           ASL 
02/C0F2: 0A           ASL 
02/C0F3: 0A           ASL 
02/C0F4: 0A           ASL 
02/C0F5: AA           TAX 
02/C0F6: DA           PHX 
02/C0F7: 20 13 85     JSR $8513       ; wait one frame
02/C0FA: FA           PLX 
02/C0FB: BD C5 EF     LDA $EFC5,X
02/C0FE: C9 C0        CMP #$C0
02/C100: D0 F4        BNE $C0F6
02/C102: 7B           TDC 
02/C103: A8           TAY 
02/C104: B9 39 35     LDA $3539,Y
02/C107: 29 7F        AND #$7F
02/C109: 99 39 35     STA $3539,Y
02/C10C: AA           TAX 
02/C10D: 9E 99 F0     STZ $F099,X
02/C110: C8           INY 
02/C111: C0 02 00     CPY #$0002
02/C114: D0 EE        BNE $C104
02/C116: 60           RTS 

; [ command animation $16: throw ]

02/C117: 20 AE BD     JSR $BDAE
02/C11A: AD 80 35     LDA $3580       ; thrown item id
02/C11D: C9 41        CMP #$41
02/C11F: F0 04        BEQ $C125       ; branch if ninja star
02/C121: C9 40        CMP #$40
02/C123: D0 09        BNE $C12E       ; branch if not shuriken
02/C125: A9 40        LDA #$40
02/C127: 85 50        STA $50
02/C129: 64 51        STZ $51
02/C12B: 4C CB CF     JMP $CFCB
02/C12E: A9 11        LDA #$11
02/C130: 20 70 D9     JSR $D970       ; load weapon graphics
02/C133: AD 80 35     LDA $3580
02/C136: C2 20        REP #$20
02/C138: 0A           ASL 
02/C139: 0A           ASL 
02/C13A: AA           TAX 
02/C13B: 7B           TDC 
02/C13C: E2 20        SEP #$20
02/C13E: BF 10 9E 0F  LDA $0F9E10,X
02/C142: 20 A0 D8     JSR $D8A0
02/C145: BF 11 9E 0F  LDA $0F9E11,X
02/C149: 48           PHA 
02/C14A: 20 8D C2     JSR $C28D
02/C14D: A9 0F        LDA #$0F
02/C14F: 20 F9 C7     JSR $C7F9
02/C152: 20 B8 C5     JSR $C5B8
02/C155: BD C5 EF     LDA $EFC5,X
02/C158: 8D 11 F1     STA $F111
02/C15B: BD C6 EF     LDA $EFC6,X
02/C15E: 8D 12 F1     STA $F112
02/C161: A5 49        LDA $49
02/C163: 0A           ASL 
02/C164: AA           TAX 
02/C165: BD 43 F0     LDA $F043,X
02/C168: 29 F8        AND #$F8
02/C16A: 8D 13 F1     STA $F113
02/C16D: BD 44 F0     LDA $F044,X
02/C170: 29 F8        AND #$F8
02/C172: 8D 14 F1     STA $F114
02/C175: A9 08        LDA #$08
02/C177: 8D 15 F1     STA $F115
02/C17A: 20 C0 E7     JSR $E7C0
02/C17D: AD 1C F1     LDA $F11C
02/C180: 4A           LSR 
02/C181: 4A           LSR 
02/C182: 4A           LSR 
02/C183: AA           TAX 
02/C184: 4A           LSR 
02/C185: 8D 39 F1     STA $F139
02/C188: 86 28        STX $28
02/C18A: A2 00 00     LDX #$0000
02/C18D: 86 26        STX $26
02/C18F: 20 2B 85     JSR $852B       ; divide
02/C192: A6 2A        LDX $2A
02/C194: 8E 33 F1     STX $F133
02/C197: 9C 35 F1     STZ $F135
02/C19A: 9C 36 F1     STZ $F136
02/C19D: 9C 37 F1     STZ $F137
02/C1A0: EE 39 F1     INC $F139
02/C1A3: A9 25        LDA #$25
02/C1A5: 20 DF F5     JSR $F5DF
02/C1A8: 20 13 85     JSR $8513       ; wait one frame
02/C1AB: EE 37 F1     INC $F137
02/C1AE: 20 60 E8     JSR $E860
02/C1B1: B0 6F        BCS $C222
02/C1B3: CE 39 F1     DEC $F139
02/C1B6: 30 0D        BMI $C1C5
02/C1B8: AD 35 F1     LDA $F135
02/C1BB: 18           CLC 
02/C1BC: 6D 33 F1     ADC $F133
02/C1BF: 8D 35 F1     STA $F135
02/C1C2: 4C CF C1     JMP $C1CF
02/C1C5: AD 35 F1     LDA $F135
02/C1C8: 38           SEC 
02/C1C9: ED 33 F1     SBC $F133
02/C1CC: 8D 35 F1     STA $F135
02/C1CF: AD 35 F1     LDA $F135
02/C1D2: AA           TAX 
02/C1D3: BF 00 FF 1C  LDA $1CFF00,X   ; sine table
02/C1D7: 85 26        STA $26
02/C1D9: AD 1C F1     LDA $F11C
02/C1DC: 4A           LSR 
02/C1DD: 85 28        STA $28
02/C1DF: 20 60 85     JSR $8560       ; multiply (8-bit)
02/C1E2: A5 48        LDA $48
02/C1E4: AA           TAX 
02/C1E5: BF 15 FD 16  LDA $16FD15,X
02/C1E9: 8D CA F0     STA $F0CA
02/C1EC: AD 37 F1     LDA $F137
02/C1EF: 29 08        AND #$08
02/C1F1: 4A           LSR 
02/C1F2: AA           TAX 
02/C1F3: BF 50 FD 16  LDA $16FD50,X
02/C1F7: 8D CB F0     STA $F0CB
02/C1FA: BF 51 FD 16  LDA $16FD51,X
02/C1FE: 18           CLC 
02/C1FF: 6D 18 F1     ADC $F118
02/C202: 8D CC F0     STA $F0CC
02/C205: BF 52 FD 16  LDA $16FD52,X
02/C209: 18           CLC 
02/C20A: 6D 19 F1     ADC $F119
02/C20D: 38           SEC 
02/C20E: E5 2B        SBC $2B
02/C210: 8D CD F0     STA $F0CD
02/C213: BF 53 FD 16  LDA $16FD53,X
02/C217: 8D CE F0     STA $F0CE
02/C21A: A9 01        LDA #$01
02/C21C: 8D C9 F0     STA $F0C9
02/C21F: 4C A8 C1     JMP $C1A8
02/C222: A5 49        LDA $49
02/C224: 0A           ASL 
02/C225: AA           TAX 
02/C226: BD 43 F0     LDA $F043,X
02/C229: 38           SEC 
02/C22A: E9 08        SBC #$08
02/C22C: 8D CC F0     STA $F0CC
02/C22F: BD 44 F0     LDA $F044,X
02/C232: 38           SEC 
02/C233: E9 08        SBC #$08
02/C235: 8D CD F0     STA $F0CD
02/C238: 7B           TDC 
02/C239: AA           TAX 
02/C23A: BF 50 FD 16  LDA $16FD50,X
02/C23E: 8D CB F0     STA $F0CB
02/C241: A9 01        LDA #$01
02/C243: 8D C9 F0     STA $F0C9
02/C246: 68           PLA 
02/C247: 20 70 D9     JSR $D970       ; load weapon graphics
02/C24A: A9 28        LDA #$28
02/C24C: 20 DF F5     JSR $F5DF
02/C24F: A2 14 00     LDX #$0014
02/C252: 9C 11 F1     STZ $F111
02/C255: 20 13 85     JSR $8513       ; wait one frame
02/C258: EE 11 F1     INC $F111
02/C25B: AD 11 F1     LDA $F111
02/C25E: C9 10        CMP #$10
02/C260: F0 14        BEQ $C276
02/C262: AA           TAX 
02/C263: BF 39 FD 16  LDA $16FD39,X
02/C267: 18           CLC 
02/C268: 6D CD F0     ADC $F0CD
02/C26B: 8D CD F0     STA $F0CD
02/C26E: A9 01        LDA #$01
02/C270: 8D C9 F0     STA $F0C9
02/C273: 4C 55 C2     JMP $C255
02/C276: 9C C9 F0     STZ $F0C9
02/C279: 20 A1 C2     JSR $C2A1
02/C27C: 7B           TDC 
02/C27D: 4C F9 C7     JMP $C7F9

; [  ]

02/C280: 20 F9 C7     JSR $C7F9
02/C283: A2 1E 00     LDX #$001E
02/C286: 20 A0 C8     JSR $C8A0       ; wait
02/C289: 7B           TDC 
02/C28A: 4C F9 C7     JMP $C7F9

; [  ]

02/C28D: A5 48        LDA $48
02/C28F: AA           TAX 
02/C290: A9 01        LDA #$01
02/C292: 9D BC F2     STA $F2BC,X
02/C295: 20 13 85     JSR $8513       ; wait one frame
02/C298: 20 B8 C5     JSR $C5B8
02/C29B: BD CF EF     LDA $EFCF,X
02/C29E: D0 F5        BNE $C295
02/C2A0: 60           RTS 

; [  ]

02/C2A1: A5 48        LDA $48
02/C2A3: AA           TAX 
02/C2A4: 7B           TDC 
02/C2A5: 9D BC F2     STA $F2BC,X
02/C2A8: 60           RTS 

; [ command animation $1B: defend ]

02/C2A9: A9 02        LDA #$02
02/C2AB: 4C F9 C7     JMP $C7F9

; [  ]

02/C2AE: DA           PHX 
02/C2AF: A5 48        LDA $48
02/C2B1: AA           TAX 
02/C2B2: 20 07 E1     JSR $E107
02/C2B5: A5 48        LDA $48
02/C2B7: 0A           ASL 
02/C2B8: 0A           ASL 
02/C2B9: 0A           ASL 
02/C2BA: 0A           ASL 
02/C2BB: A8           TAY 
02/C2BC: BD 00 20     LDA $2000,X
02/C2BF: 29 3F        AND #$3F
02/C2C1: 99 C4 EF     STA $EFC4,Y
02/C2C4: FA           PLX 
02/C2C5: 60           RTS 

; [  ]

02/C2C6: 8D 79 F2     STA $F279
02/C2C9: AD C5 34     LDA $34C5
02/C2CC: 8D 81 F2     STA $F281
02/C2CF: 8D 84 F2     STA $F284
02/C2D2: 8D 83 F2     STA $F283
02/C2D5: 7B           TDC 
02/C2D6: 4C 24 F5     JMP $F524

; [ command animation $0E: kick ]

02/C2D9: A9 73        LDA #$73
02/C2DB: 20 DF F5     JSR $F5DF
02/C2DE: AD C2 34     LDA $34C2
02/C2E1: 10 35        BPL $C318
02/C2E3: A9 0C        LDA #$0C
02/C2E5: 20 A2 C6     JSR $C6A2
02/C2E8: 7B           TDC 
02/C2E9: 20 C6 C2     JSR $C2C6
02/C2EC: A9 03        LDA #$03
02/C2EE: 8D 81 F2     STA $F281
02/C2F1: EE 2E F4     INC $F42E
02/C2F4: EE 81 F4     INC $F481
02/C2F7: 22 74 F2 01  JSL $01F274
02/C2FB: 7B           TDC 
02/C2FC: 8D 2E F4     STA $F42E
02/C2FF: 8D 81 F4     STA $F481
02/C302: 8D 83 F2     STA $F283
02/C305: EE 0E F4     INC $F40E
02/C308: A9 0D        LDA #$0D
02/C30A: 20 A2 C6     JSR $C6A2
02/C30D: 22 99 F2 01  JSL $01F299
02/C311: 7B           TDC 
02/C312: 8D 0E F4     STA $F40E
02/C315: 4C A2 C6     JMP $C6A2
02/C318: 20 8D C2     JSR $C28D
02/C31B: 20 7B C8     JSR $C87B
02/C31E: A9 0F        LDA #$0F
02/C320: 20 F9 C7     JSR $C7F9
02/C323: A9 10        LDA #$10
02/C325: 8D 13 F1     STA $F113
02/C328: A9 4C        LDA #$4C
02/C32A: 8D 14 F1     STA $F114
02/C32D: 20 B8 C5     JSR $C5B8
02/C330: BD C5 EF     LDA $EFC5,X
02/C333: 8D 11 F1     STA $F111
02/C336: BD C6 EF     LDA $EFC6,X
02/C339: 8D 12 F1     STA $F112
02/C33C: A9 08        LDA #$08
02/C33E: 8D 15 F1     STA $F115
02/C341: 20 C0 E7     JSR $E7C0
02/C344: A9 01        LDA #$01
02/C346: 20 C6 C2     JSR $C2C6
02/C349: 20 F8 F4     JSR $F4F8
02/C34C: A9 01        LDA #$01
02/C34E: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/C351: A9 03        LDA #$03
02/C353: 8D 81 F2     STA $F281
02/C356: A9 01        LDA #$01
02/C358: 8D 83 F2     STA $F283
02/C35B: EE 2E F4     INC $F42E
02/C35E: EE 81 F4     INC $F481
02/C361: 20 C7 C3     JSR $C3C7
02/C364: 20 B8 C5     JSR $C5B8
02/C367: BD CE EF     LDA $EFCE,X
02/C36A: 49 01        EOR #$01
02/C36C: 9D CE EF     STA $EFCE,X
02/C36F: BD C5 EF     LDA $EFC5,X
02/C372: 8D 11 F1     STA $F111
02/C375: BD C6 EF     LDA $EFC6,X
02/C378: 8D 12 F1     STA $F112
02/C37B: AD 14 F0     LDA $F014
02/C37E: D0 0B        BNE $C38B
02/C380: DA           PHX 
02/C381: A5 48        LDA $48
02/C383: AA           TAX 
02/C384: BF 1F FD 16  LDA $16FD1F,X
02/C388: FA           PLX 
02/C389: 80 09        BRA $C394
02/C38B: DA           PHX 
02/C38C: A5 48        LDA $48
02/C38E: AA           TAX 
02/C38F: BF 24 FD 16  LDA $16FD24,X
02/C393: FA           PLX 
02/C394: 8D 13 F1     STA $F113
02/C397: A5 48        LDA $48
02/C399: AA           TAX 
02/C39A: BF 1A FD 16  LDA $16FD1A,X
02/C39E: 8D 14 F1     STA $F114
02/C3A1: A9 08        LDA #$08
02/C3A3: 8D 15 F1     STA $F115
02/C3A6: 20 C0 E7     JSR $E7C0
02/C3A9: 7B           TDC 
02/C3AA: 8D 81 F4     STA $F481
02/C3AD: 8D 2E F4     STA $F42E
02/C3B0: 8D 83 F2     STA $F283
02/C3B3: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/C3B6: 20 C7 C3     JSR $C3C7
02/C3B9: BD CE EF     LDA $EFCE,X
02/C3BC: 49 01        EOR #$01
02/C3BE: 9D CE EF     STA $EFCE,X
02/C3C1: 20 83 C8     JSR $C883
02/C3C4: 4C 79 C2     JMP $C279

; [  ]

02/C3C7: 20 13 85     JSR $8513       ; wait one frame
02/C3CA: 20 60 E8     JSR $E860
02/C3CD: B0 11        BCS $C3E0
02/C3CF: 20 B8 C5     JSR $C5B8
02/C3D2: AD 18 F1     LDA $F118
02/C3D5: 9D C5 EF     STA $EFC5,X
02/C3D8: AD 19 F1     LDA $F119
02/C3DB: 9D C6 EF     STA $EFC6,X
02/C3DE: 80 E7        BRA $C3C7
02/C3E0: 60           RTS 

; [  ]

02/C3E1: AD 1C F1     LDA $F11C
02/C3E4: 4A           LSR 
02/C3E5: 4A           LSR 
02/C3E6: 4A           LSR 
02/C3E7: AA           TAX 
02/C3E8: 4A           LSR 
02/C3E9: 8D 39 F1     STA $F139
02/C3EC: 86 28        STX $28
02/C3EE: A2 80 00     LDX #$0080
02/C3F1: 86 26        STX $26
02/C3F3: 20 2B 85     JSR $852B       ; divide
02/C3F6: A6 2A        LDX $2A
02/C3F8: 8E 33 F1     STX $F133
02/C3FB: 7B           TDC 
02/C3FC: AA           TAX 
02/C3FD: 8E 35 F1     STX $F135
02/C400: EE 39 F1     INC $F139
02/C403: 6B           RTL 

; [  ]

02/C404: CE 39 F1     DEC $F139
02/C407: 30 0C        BMI $C415
02/C409: AD 35 F1     LDA $F135
02/C40C: 18           CLC 
02/C40D: 6D 33 F1     ADC $F133
02/C410: 8D 35 F1     STA $F135
02/C413: 80 0A        BRA $C41F
02/C415: AD 35 F1     LDA $F135
02/C418: 38           SEC 
02/C419: ED 33 F1     SBC $F133
02/C41C: 8D 35 F1     STA $F135
02/C41F: AD 35 F1     LDA $F135
02/C422: AA           TAX 
02/C423: BF 00 FF 1C  LDA $1CFF00,X   ; sine table
02/C427: 85 26        STA $26
02/C429: AD 1C F1     LDA $F11C
02/C42C: 4A           LSR 
02/C42D: 85 28        STA $28
02/C42F: 20 60 85     JSR $8560       ; multiply (8-bit)
02/C432: 6B           RTL 

; [  ]

02/C433: 22 E1 C3 02  JSL $02C3E1
02/C437: 20 13 85     JSR $8513       ; wait one frame
02/C43A: 20 60 E8     JSR $E860
02/C43D: B0 1E        BCS $C45D
02/C43F: 22 04 C4 02  JSL $02C404
02/C443: 20 B8 C5     JSR $C5B8
02/C446: AD 18 F1     LDA $F118
02/C449: 8D 37 F1     STA $F137
02/C44C: 9D C5 EF     STA $EFC5,X
02/C44F: AD 19 F1     LDA $F119
02/C452: 8D 38 F1     STA $F138
02/C455: 38           SEC 
02/C456: E5 2B        SBC $2B
02/C458: 9D C6 EF     STA $EFC6,X
02/C45B: 80 DA        BRA $C437
02/C45D: 20 B8 C5     JSR $C5B8
02/C460: AD 37 F1     LDA $F137
02/C463: 9D C5 EF     STA $EFC5,X
02/C466: AD 38 F1     LDA $F138
02/C469: 9D C6 EF     STA $EFC6,X
02/C46C: 60           RTS 

; [  ]

02/C46D: DA           PHX 
02/C46E: 20 66 8A     JSR $8A66       ; clear tilemap buffer
02/C471: 20 B2 BC     JSR $BCB2
02/C474: FA           PLX 
02/C475: 60           RTS 

; [ command animation $1E: jump 2 ]

02/C476: AD C2 34     LDA $34C2
02/C479: 10 19        BPL $C494
02/C47B: 20 6D C4     JSR $C46D
02/C47E: A9 01        LDA #$01
02/C480: 8D 0E F4     STA $F40E
02/C483: A9 0D        LDA #$0D
02/C485: 20 A2 C6     JSR $C6A2
02/C488: 22 A3 F1 01  JSL $01F1A3
02/C48C: 7B           TDC 
02/C48D: 8D 0E F4     STA $F40E
02/C490: 20 A2 C6     JSR $C6A2
02/C493: 60           RTS 
02/C494: 20 8D C2     JSR $C28D
02/C497: A5 49        LDA $49
02/C499: 0A           ASL 
02/C49A: AA           TAX 
02/C49B: BD 5D F0     LDA $F05D,X
02/C49E: 29 F8        AND #$F8
02/C4A0: 85 00        STA $00
02/C4A2: 8D 33 F1     STA $F133
02/C4A5: BD 5E F0     LDA $F05E,X
02/C4A8: 38           SEC 
02/C4A9: E9 18        SBC #$18
02/C4AB: 29 F8        AND #$F8
02/C4AD: 8D 34 F1     STA $F134
02/C4B0: 85 01        STA $01
02/C4B2: 20 B8 C5     JSR $C5B8
02/C4B5: 7B           TDC 
02/C4B6: 9D C6 EF     STA $EFC6,X
02/C4B9: A5 00        LDA $00
02/C4BB: 38           SEC 
02/C4BC: E5 01        SBC $01
02/C4BE: 9D C5 EF     STA $EFC5,X
02/C4C1: 90 03        BCC $C4C6
02/C4C3: 20 AE C2     JSR $C2AE
02/C4C6: BD CE EF     LDA $EFCE,X
02/C4C9: 49 01        EOR #$01
02/C4CB: 9D CE EF     STA $EFCE,X
02/C4CE: A9 0F        LDA #$0F
02/C4D0: 20 F9 C7     JSR $C7F9
02/C4D3: 20 13 85     JSR $8513       ; wait one frame
02/C4D6: 20 B8 C5     JSR $C5B8
02/C4D9: BD C5 EF     LDA $EFC5,X
02/C4DC: 18           CLC 
02/C4DD: 69 08        ADC #$08
02/C4DF: 9D C5 EF     STA $EFC5,X
02/C4E2: 90 03        BCC $C4E7
02/C4E4: 20 AE C2     JSR $C2AE
02/C4E7: BD C6 EF     LDA $EFC6,X
02/C4EA: 18           CLC 
02/C4EB: 69 08        ADC #$08
02/C4ED: 9D C6 EF     STA $EFC6,X
02/C4F0: AD 34 F1     LDA $F134
02/C4F3: 38           SEC 
02/C4F4: E9 08        SBC #$08
02/C4F6: 8D 34 F1     STA $F134
02/C4F9: D0 D8        BNE $C4D3
02/C4FB: BD C5 EF     LDA $EFC5,X
02/C4FE: 8D 11 F1     STA $F111
02/C501: BD C6 EF     LDA $EFC6,X
02/C504: 8D 12 F1     STA $F112
02/C507: AD 14 F0     LDA $F014
02/C50A: D0 0B        BNE $C517
02/C50C: DA           PHX 
02/C50D: A5 48        LDA $48
02/C50F: AA           TAX 
02/C510: BF 1F FD 16  LDA $16FD1F,X
02/C514: FA           PLX 
02/C515: 80 09        BRA $C520
02/C517: DA           PHX 
02/C518: A5 48        LDA $48
02/C51A: AA           TAX 
02/C51B: BF 24 FD 16  LDA $16FD24,X
02/C51F: FA           PLX 
02/C520: 8D 13 F1     STA $F113
02/C523: 48           PHA 
02/C524: A5 48        LDA $48
02/C526: AA           TAX 
02/C527: BF 1A FD 16  LDA $16FD1A,X
02/C52B: 48           PHA 
02/C52C: 8D 14 F1     STA $F114
02/C52F: A9 08        LDA #$08
02/C531: 8D 15 F1     STA $F115
02/C534: 20 C0 E7     JSR $E7C0
02/C537: A9 28        LDA #$28
02/C539: 20 DF F5     JSR $F5DF
02/C53C: 20 33 C4     JSR $C433
02/C53F: 20 B8 C5     JSR $C5B8
02/C542: 68           PLA 
02/C543: 9D C6 EF     STA $EFC6,X
02/C546: 68           PLA 
02/C547: 9D C5 EF     STA $EFC5,X
02/C54A: BD CE EF     LDA $EFCE,X
02/C54D: 49 01        EOR #$01
02/C54F: 9D CE EF     STA $EFCE,X
02/C552: 4C 79 C2     JMP $C279

; [ command animation $1C: appear (show) ]

02/C555: 20 8D C2     JSR $C28D
02/C558: 20 B8 C5     JSR $C5B8
02/C55B: 8A           TXA 
02/C55C: A8           TAY 
02/C55D: B9 CE EF     LDA $EFCE,Y
02/C560: 29 FE        AND #$FE
02/C562: 99 CE EF     STA $EFCE,Y
02/C565: A5 48        LDA $48
02/C567: AA           TAX 
02/C568: 20 07 E1     JSR $E107
02/C56B: BD 00 20     LDA $2000,X
02/C56E: 29 3F        AND #$3F
02/C570: 99 C4 EF     STA $EFC4,Y
02/C573: 7B           TDC 
02/C574: 99 D1 EF     STA $EFD1,Y
02/C577: 99 D3 EF     STA $EFD3,Y
02/C57A: 99 C8 EF     STA $EFC8,Y
02/C57D: A5 48        LDA $48
02/C57F: AA           TAX 
02/C580: A9 01        LDA #$01
02/C582: 9D AF F0     STA $F0AF,X
02/C585: A9 03        LDA #$03
02/C587: 20 F9 C7     JSR $C7F9
02/C58A: 20 13 85     JSR $8513       ; wait one frame
02/C58D: A5 48        LDA $48
02/C58F: AA           TAX 
02/C590: AD 14 F0     LDA $F014
02/C593: D0 06        BNE $C59B
02/C595: BF 1F FD 16  LDA $16FD1F,X
02/C599: 80 04        BRA $C59F
02/C59B: BF 24 FD 16  LDA $16FD24,X
02/C59F: 85 04        STA $04
02/C5A1: 20 B8 C5     JSR $C5B8
02/C5A4: 20 28 81     JSR $8128
02/C5A7: BD C5 EF     LDA $EFC5,X
02/C5AA: C5 04        CMP $04
02/C5AC: D0 DC        BNE $C58A
02/C5AE: A5 48        LDA $48
02/C5B0: AA           TAX 
02/C5B1: 7B           TDC 
02/C5B2: 9D AF F0     STA $F0AF,X
02/C5B5: 4C 79 C2     JMP $C279

; [  ]

02/C5B8: A5 48        LDA $48
02/C5BA: 0A           ASL 
02/C5BB: 0A           ASL 
02/C5BC: 0A           ASL 
02/C5BD: 0A           ASL 
02/C5BE: AA           TAX 
02/C5BF: 60           RTS 

; [  ]

02/C5C0: A5 49        LDA $49
02/C5C2: 80 F6        BRA $C5BA

; [ command animation $09: hide (far) ]

02/C5C4: 20 CC C5     JSR $C5CC       ; 
02/C5C7: 6B           RTL 

; [ command animation $1C: appear (far) ]

02/C5C8: 20 55 C5     JSR $C555       ; 
02/C5CB: 6B           RTL 

; [ command animation $09: hide ]

02/C5CC: A9 0F        LDA #$0F
02/C5CE: 20 F9 C7     JSR $C7F9
02/C5D1: A2 0A 00     LDX #$000A
02/C5D4: 20 A0 C8     JSR $C8A0       ; wait
02/C5D7: A9 03        LDA #$03
02/C5D9: 20 F9 C7     JSR $C7F9
02/C5DC: 20 8D C2     JSR $C28D
02/C5DF: 20 B8 C5     JSR $C5B8
02/C5E2: BD CE EF     LDA $EFCE,X
02/C5E5: 09 01        ORA #$01
02/C5E7: 9D CE EF     STA $EFCE,X
02/C5EA: 9E D1 EF     STZ $EFD1,X
02/C5ED: 9E D3 EF     STZ $EFD3,X
02/C5F0: 9E C8 EF     STZ $EFC8,X
02/C5F3: A5 48        LDA $48
02/C5F5: AA           TAX 
02/C5F6: A9 01        LDA #$01
02/C5F8: 9D AF F0     STA $F0AF,X
02/C5FB: 20 13 85     JSR $8513       ; wait one frame
02/C5FE: 20 B8 C5     JSR $C5B8
02/C601: AA           TAX 
02/C602: 20 23 81     JSR $8123
02/C605: BD C5 EF     LDA $EFC5,X
02/C608: C9 F0        CMP #$F0
02/C60A: 90 EF        BCC $C5FB
02/C60C: 7B           TDC 
02/C60D: 9D C4 EF     STA $EFC4,X
02/C610: BD CE EF     LDA $EFCE,X
02/C613: 29 FE        AND #$FE
02/C615: 9D CE EF     STA $EFCE,X
02/C618: 60           RTS 

; [ command animation $06: jump 1 ]

02/C619: A9 3D        LDA #$3D
02/C61B: 20 02 C8     JSR $C802
02/C61E: AD C2 34     LDA $34C2
02/C621: 30 3C        BMI $C65F
02/C623: 20 7B C8     JSR $C87B
02/C626: 20 AE BD     JSR $BDAE
02/C629: A9 04        LDA #$04
02/C62B: 20 F9 C7     JSR $C7F9
02/C62E: A2 0A 00     LDX #$000A
02/C631: 20 A0 C8     JSR $C8A0       ; wait
02/C634: A9 0C        LDA #$0C
02/C636: 20 F9 C7     JSR $C7F9
02/C639: 20 8D C2     JSR $C28D
02/C63C: 20 13 85     JSR $8513       ; wait one frame
02/C63F: 20 B8 C5     JSR $C5B8
02/C642: BD C5 EF     LDA $EFC5,X
02/C645: 38           SEC 
02/C646: E9 02        SBC #$02
02/C648: 9D C5 EF     STA $EFC5,X
02/C64B: BD C6 EF     LDA $EFC6,X
02/C64E: 38           SEC 
02/C64F: E9 08        SBC #$08
02/C651: 9D C6 EF     STA $EFC6,X
02/C654: C9 F8        CMP #$F8
02/C656: 90 E4        BCC $C63C
02/C658: 7B           TDC 
02/C659: 9D C4 EF     STA $EFC4,X
02/C65C: 4C 83 C8     JMP $C883
02/C65F: A9 03        LDA #$03
02/C661: 20 A2 C6     JSR $C6A2
02/C664: A2 0A 00     LDX #$000A
02/C667: 20 A0 C8     JSR $C8A0       ; wait
02/C66A: A9 08        LDA #$08
02/C66C: 20 A2 C6     JSR $C6A2
02/C66F: 7B           TDC 
02/C670: AA           TAX 
02/C671: 8E 06 F4     STX $F406
02/C674: 8E 08 F4     STX $F408
02/C677: 20 13 85     JSR $8513       ; wait one frame
02/C67A: 22 70 ED 01  JSL $01ED70
02/C67E: C2 20        REP #$20
02/C680: AD 06 F4     LDA $F406
02/C683: 38           SEC 
02/C684: E9 02 00     SBC #$0002
02/C687: 8D 06 F4     STA $F406
02/C68A: AD 08 F4     LDA $F408
02/C68D: 18           CLC 
02/C68E: 69 08 00     ADC #$0008
02/C691: 8D 08 F4     STA $F408
02/C694: 7B           TDC 
02/C695: E2 20        SEP #$20
02/C697: E8           INX 
02/C698: E0 10 00     CPX #$0010
02/C69B: D0 DA        BNE $C677
02/C69D: A9 0A        LDA #$0A
02/C69F: 4C A2 C6     JMP $C6A2

; [  ]

02/C6A2: 8D 04 F4     STA $F404
02/C6A5: 20 2F 8D     JSR $8D2F
02/C6A8: A0 40 61     LDY #$6140
02/C6AB: A2 00 01     LDX #$0100
02/C6AE: 86 00        STX $00
02/C6B0: A9 7E        LDA #$7E
02/C6B2: A2 7D 6F     LDX #$6F7D
02/C6B5: 4C B2 84     JMP $84B2

; [ command animation $1A: row (change) ]

02/C6B8: 20 78 81     JSR $8178       ; toggle character rows
02/C6BB: 7B           TDC 
02/C6BC: 4C F9 C7     JMP $C7F9

; [ command animation $00/$1F: fight/focus 2 ]

02/C6BF: 20 AE BD     JSR $BDAE
02/C6C2: 4C B8 CF     JMP $CFB8

; [ command animation $08/$0F: sing/brace ]

02/C6C5: 20 AE BD     JSR $BDAE
02/C6C8: A9 0B        LDA #$0B
02/C6CA: 20 F9 C7     JSR $C7F9
02/C6CD: A9 01        LDA #$01
02/C6CF: 4C 79 C7     JMP $C779

; [ command animation $02: white magic ]

02/C6D2: 20 AE BD     JSR $BDAE
02/C6D5: A9 0C        LDA #$0C
02/C6D7: 20 F9 C7     JSR $C7F9
02/C6DA: A9 01        LDA #$01
02/C6DC: 4C 79 C7     JMP $C779

; [ command animation $03: black magic ]

02/C6DF: 20 AE BD     JSR $BDAE
02/C6E2: A9 0C        LDA #$0C
02/C6E4: 20 F9 C7     JSR $C7F9
02/C6E7: 7B           TDC 
02/C6E8: 4C 79 C7     JMP $C779

; [  ]

02/C6EB: 7B           TDC 
02/C6EC: AA           TAX 
02/C6ED: A8           TAY 
02/C6EE: B9 54 F3     LDA $F354,Y
02/C6F1: 9D C4 EF     STA $EFC4,X
02/C6F4: C8           INY 
02/C6F5: 8A           TXA 
02/C6F6: 18           CLC 
02/C6F7: 69 10        ADC #$10
02/C6F9: AA           TAX 
02/C6FA: C0 05 00     CPY #$0005
02/C6FD: D0 EF        BNE $C6EE
02/C6FF: 60           RTS 

; [  ]

02/C700: 7B           TDC 
02/C701: AA           TAX 
02/C702: A8           TAY 
02/C703: BD C4 EF     LDA $EFC4,X
02/C706: 99 54 F3     STA $F354,Y
02/C709: 9E C4 EF     STZ $EFC4,X
02/C70C: C8           INY 
02/C70D: 8A           TXA 
02/C70E: 18           CLC 
02/C70F: 69 10        ADC #$10
02/C711: AA           TAX 
02/C712: C0 05 00     CPY #$0005
02/C715: D0 EC        BNE $C703
02/C717: 60           RTS 

; [ command animation $04: summon ]

02/C718: 20 AE BD     JSR $BDAE
02/C71B: A9 0F        LDA #$0F
02/C71D: 20 F9 C7     JSR $C7F9
02/C720: AD 74 F4     LDA $F474
02/C723: D0 05        BNE $C72A       ; branch if mist dragon vs. golbez
02/C725: A9 02        LDA #$02
02/C727: 20 79 C7     JSR $C779
; fallthrough

; [ command animation $25:  ]

02/C72A: 20 54 C7     JSR $C754
02/C72D: A9 FF        LDA #$FF
02/C72F: 8D 20 F3     STA $F320
02/C732: EE 5A F3     INC $F35A
02/C735: 60           RTS 

; [  ]

02/C736: 7B           TDC 
02/C737: AA           TAX 
02/C738: 86 0A        STX $0A
02/C73A: BD 35 F2     LDA $F235,X
02/C73D: 20 FB BF     JSR $BFFB
02/C740: C2 20        REP #$20
02/C742: A5 0A        LDA $0A
02/C744: 18           CLC 
02/C745: 69 00 04     ADC #$0400
02/C748: 85 0A        STA $0A
02/C74A: 7B           TDC 
02/C74B: E2 20        SEP #$20
02/C74D: E8           INX 
02/C74E: E0 02 00     CPX #$0002
02/C751: D0 E7        BNE $C73A
02/C753: 60           RTS 

; [  ]

02/C754: 9C 59 F3     STZ $F359
02/C757: 20 1E 85     JSR $851E       ; wait for vblank
02/C75A: AD 59 F3     LDA $F359
02/C75D: 29 03        AND #$03
02/C75F: F0 0A        BEQ $C76B
02/C761: C9 02        CMP #$02
02/C763: D0 09        BNE $C76E
02/C765: 20 EB C6     JSR $C6EB
02/C768: 4C 6E C7     JMP $C76E
02/C76B: 20 00 C7     JSR $C700
02/C76E: EE 59 F3     INC $F359
02/C771: AD 59 F3     LDA $F359
02/C774: C9 20        CMP #$20
02/C776: D0 DF        BNE $C757
02/C778: 60           RTS 

; [  ]

02/C779: 48           PHA 
02/C77A: A9 01        LDA #$01
02/C77C: 8D 66 F2     STA $F266
02/C77F: 8D 67 F2     STA $F267
02/C782: 9C A0 F2     STZ $F2A0
02/C785: 68           PLA 
02/C786: 48           PHA 
02/C787: 20 2F EA     JSR $EA2F
02/C78A: 68           PLA 
02/C78B: 22 00 E3 01  JSL $01E300
02/C78F: 7B           TDC 
02/C790: 4C F9 C7     JMP $C7F9

; [ command animation $12: cry ]

02/C793: A9 74        LDA #$74
02/C795: 20 02 C8     JSR $C802
02/C798: 80 0F        BRA $C7A9

; [ command animation $11: bluff ]

02/C79A: A9 75        LDA #$75
02/C79C: 20 02 C8     JSR $C802
02/C79F: 80 08        BRA $C7A9

; [ command animation $19: regen ]

02/C7A1: 20 AE BD     JSR $BDAE
02/C7A4: A9 24        LDA #$24
02/C7A6: 20 DF F5     JSR $F5DF

; [ command animation $07/$14: recall/search ]

02/C7A9: 20 AE BD     JSR $BDAE
02/C7AC: A9 0F        LDA #$0F
02/C7AE: 4C 80 C2     JMP $C280

; [ command animation $01: item ]

02/C7B1: 20 AE BD     JSR $BDAE
02/C7B4: A9 0C        LDA #$0C
02/C7B6: 20 80 C2     JSR $C280
02/C7B9: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/C7BC: AA           TAX 
02/C7BD: BF E0 D4 0F  LDA $0FD4E0,X
02/C7C1: C9 48        CMP #$48
02/C7C3: D0 0F        BNE $C7D4
02/C7C5: A9 60        LDA #$60
02/C7C7: 85 50        STA $50
02/C7C9: 1A           INC 
02/C7CA: 85 51        STA $51
02/C7CC: A9 01        LDA #$01
02/C7CE: 8D 80 F4     STA $F480
02/C7D1: 4C CB CF     JMP $CFCB
02/C7D4: C9 4C        CMP #$4C
02/C7D6: D0 0F        BNE $C7E7
02/C7D8: A9 62        LDA #$62
02/C7DA: 85 50        STA $50
02/C7DC: 1A           INC 
02/C7DD: 85 51        STA $51
02/C7DF: A9 02        LDA #$02
02/C7E1: 8D 80 F4     STA $F480
02/C7E4: 4C CB CF     JMP $CFCB
02/C7E7: BF E0 D4 0F  LDA $0FD4E0,X
02/C7EB: F0 03        BEQ $C7F0
02/C7ED: 20 C9 EA     JSR $EAC9
02/C7F0: 60           RTS 

; [ command animation: medicine, prayer, protect, steal, ninjutsu ]

02/C7F1: 20 AE BD     JSR $BDAE
02/C7F4: A9 0C        LDA #$0C
02/C7F6: 4C 80 C2     JMP $C280

; [  ]

02/C7F9: 48           PHA 
02/C7FA: A5 48        LDA $48
02/C7FC: AA           TAX 
02/C7FD: 68           PLA 
02/C7FE: 9D 99 F0     STA $F099,X
02/C801: 60           RTS 

; [  ]

02/C802: 48           PHA 
02/C803: AD C2 34     LDA $34C2
02/C806: 8D 85 F4     STA $F485
02/C809: 68           PLA 
02/C80A: 4C DF F5     JMP $F5DF

; [  ]

02/C80D: A9 08        LDA #$08
02/C80F: A2 0F 00     LDX #$000F
02/C812: 8D 57 F4     STA $F457
02/C815: 20 79 91     JSR $9179
02/C818: A9 14        LDA #$14
02/C81A: 4C 22 FE     JMP $FE22

; [ command animation $05: dark wave ]

02/C81D: EE 68 F4     INC $F468
02/C820: AD C2 34     LDA $34C2
02/C823: 10 28        BPL $C84D
02/C825: A9 18        LDA #$18
02/C827: 20 BD D8     JSR $D8BD
02/C82A: A9 0B        LDA #$0B
02/C82C: 20 A2 C6     JSR $C6A2
02/C82F: A2 3C 00     LDX #$003C
02/C832: 20 A0 C8     JSR $C8A0       ; wait
02/C835: A9 63        LDA #$63
02/C837: 20 02 C8     JSR $C802
02/C83A: A9 0C        LDA #$0C
02/C83C: 20 A2 C6     JSR $C6A2
02/C83F: 20 0D C8     JSR $C80D
02/C842: 22 21 E4 01  JSL $01E421
02/C846: 9C 68 F4     STZ $F468
02/C849: 7B           TDC 
02/C84A: 4C A2 C6     JMP $C6A2
02/C84D: 20 7B C8     JSR $C87B
02/C850: A9 0B        LDA #$0B
02/C852: 20 F9 C7     JSR $C7F9
02/C855: A2 1E 00     LDX #$001E
02/C858: 20 A0 C8     JSR $C8A0       ; wait
02/C85B: A9 63        LDA #$63
02/C85D: 20 02 C8     JSR $C802
02/C860: A9 0F        LDA #$0F
02/C862: 20 F9 C7     JSR $C7F9
02/C865: A2 3C 00     LDX #$003C
02/C868: 20 A0 C8     JSR $C8A0       ; wait
02/C86B: 20 0D C8     JSR $C80D
02/C86E: 22 21 E4 01  JSL $01E421
02/C872: 9C 68 F4     STZ $F468
02/C875: 20 83 C8     JSR $C883
02/C878: 4C 9C C8     JMP $C89C

; [  ]

02/C87B: AD 48 00     LDA $0048
02/C87E: AA           TAX 
02/C87F: FE 6D F4     INC $F46D,X
02/C882: 60           RTS 

; [  ]

02/C883: AD 48 00     LDA $0048
02/C886: AA           TAX 
02/C887: 9E 6D F4     STZ $F46D,X
02/C88A: 60           RTS 

; [ command animation $0C: aim ]

02/C88B: A9 0F        LDA #$0F
02/C88D: 20 F9 C7     JSR $C7F9
02/C890: A2 1E 00     LDX #$001E      ; 30 frames
02/C893: 20 A0 C8     JSR $C8A0       ; wait
02/C896: 20 AE BD     JSR $BDAE
02/C899: 20 B8 CF     JSR $CFB8
02/C89C: 7B           TDC 
02/C89D: 4C F9 C7     JMP $C7F9

; [ wait ]

; +X: number of frames to wait

02/C8A0: 20 13 85     JSR $8513       ; wait one frame
02/C8A3: CA           DEX 
02/C8A4: D0 FA        BNE $C8A0
02/C8A6: 60           RTS 

; [ do graphics script command $F0-$FE ]

02/C8A7: 38           SEC 
02/C8A8: E9 F0        SBC #$F0
02/C8AA: 0A           ASL 
02/C8AB: AA           TAX 
02/C8AC: BF BB C8 02  LDA $02C8BB,X
02/C8B0: 85 00        STA $00
02/C8B2: BF BC C8 02  LDA $02C8BC,X
02/C8B6: 85 01        STA $01
02/C8B8: 6C 00 00     JMP ($0000)

; graphics script command $F0-$FE jump table
02/C8BB: CCA2 C8ED C8F4 CC32 C8E9 C8E9 C8E9 C8DB
02/C8CB: C97F C8E9 C8EC C8EC C8EC C8EC C8EC C8EC

; $F7: 
02/C8DB: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/C8DE: 29 80        AND #$80
02/C8E0: F0 03        BEQ $C8E5
02/C8E2: 4C 79 F2     JMP $F279
02/C8E5: 20 26 F2     JSR $F226
02/C8E8: 60           RTS 
; unused
02/C8E9: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/C8EC: 60           RTS 
; $F1: battle dialogue (slowest message speed)
02/C8ED: A9 01        LDA #$01
02/C8EF: 8D 9C F4     STA $F49C
02/C8F2: 80 03        BRA $C8F7
; $F2: battle dialogue (config message speed)
02/C8F4: 9C 9C F4     STZ $F49C
02/C8F7: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/C8FA: 20 74 C9     JSR $C974       ; wait for message window
02/C8FD: 20 A8 93     JSR $93A8       ; close message window
02/C900: 20 74 C9     JSR $C974       ; wait for message window
02/C903: B2 3F        LDA ($3F)
02/C905: C2 20        REP #$20
02/C907: 0A           ASL 
02/C908: AA           TAX 
02/C909: BF 00 F2 0E  LDA $0EF200,X   ; pointers to battle dialogue
02/C90D: 85 00        STA $00
02/C90F: BF 01 F2 0E  LDA $0EF201,X
02/C913: 85 01        STA $01
02/C915: A9 0E 00     LDA #$000E
02/C918: 85 02        STA $02
02/C91A: 7B           TDC 
02/C91B: E2 20        SEP #$20
02/C91D: A8           TAY 
02/C91E: B7 00        LDA [$00],Y
02/C920: 99 FD 74     STA $74FD,Y
02/C923: C8           INY 
02/C924: C0 80 00     CPY #$0080
02/C927: D0 F5        BNE $C91E
02/C929: A2 FD 74     LDX #$74FD
02/C92C: 8E 50 EF     STX $EF50
02/C92F: 20 D6 92     JSR $92D6       ; draw message window (full)
02/C932: 20 4A C9     JSR $C94A       ; wait for battle message
02/C935: 20 A8 93     JSR $93A8       ; close message window
02/C938: 4C 74 C9     JMP $C974       ; wait for message window

; [ wait for battle message ]

; A: battle message id

02/C93B: 48           PHA 
02/C93C: A2 10 00     LDX #$0010      ; 16 frames
02/C93F: 20 A0 C8     JSR $C8A0       ; wait
02/C942: 68           PLA 
02/C943: AA           TAX 
02/C944: BF 74 FD 16  LDA $16FD74,X   ; battle messages that wait for keypress
02/C948: D0 1B        BNE $C965
; close automatically (battle dialogue jumps in here)
02/C94A: AD 9C F4     LDA $F49C
02/C94D: F0 04        BEQ $C953
02/C94F: A9 05        LDA #$05        ; use slowest message speed (5)
02/C951: 80 03        BRA $C956
02/C953: AD AD 16     LDA $16AD       ; battle message speed
02/C956: 0A           ASL 
02/C957: AA           TAX 
02/C958: C2 20        REP #$20
02/C95A: BF 00 F8 0D  LDA $0DF800,X   ; battle message durations
02/C95E: AA           TAX 
02/C95F: 7B           TDC 
02/C960: E2 20        SEP #$20
02/C962: 4C A0 C8     JMP $C8A0       ; wait
; wait for keypress
02/C965: EE 3A F4     INC $F43A
02/C968: 20 1E 85     JSR $851E       ; wait for vblank
02/C96B: 20 E1 82     JSR $82E1       ; update flying monster v-scroll
02/C96E: AD 3A F4     LDA $F43A
02/C971: D0 F5        BNE $C968
02/C973: 60           RTS 

; [ wait for message window ]

02/C974: AD 9B EF     LDA $EF9B
02/C977: F0 05        BEQ $C97E
02/C979: 20 13 85     JSR $8513       ; wait one frame
02/C97C: 80 F6        BRA $C974
02/C97E: 60           RTS 

; [ graphics script command $F8: display text ]

; 0: attacker name (unused)
; 1: target name (unused)
; 2: attack name
; 3: battle message
; 4: damage numerals

02/C97F: 20 74 C9     JSR $C974       ; wait for message window
02/C982: A2 FD 74     LDX #$74FD
02/C985: 8E 50 EF     STX $EF50
02/C988: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/C98B: 0A           ASL 
02/C98C: AA           TAX 
02/C98D: BF 9C C9 02  LDA $02C99C,X
02/C991: 85 00        STA $00
02/C993: BF 9D C9 02  LDA $02C99D,X
02/C997: 85 01        STA $01
02/C999: 6C 00 00     JMP ($0000)

; text display jump table
02/C99C: CADE CAFA CB32 CBF2 C9A6

; 4: damage numerals
02/C9A6: 7B           TDC 
02/C9A7: AA           TAX 
02/C9A8: BD D4 34     LDA $34D4,X     ; copy character damage values to buffer
02/C9AB: 9D F6 DB     STA $DBF6,X
02/C9AE: E8           INX 
02/C9AF: E0 0A 00     CPX #$000A
02/C9B2: D0 F4        BNE $C9A8
02/C9B4: 7B           TDC 
02/C9B5: AA           TAX 
02/C9B6: BD DE 34     LDA $34DE,X     ; copy monster damage values to buffer
02/C9B9: 9D E6 DB     STA $DBE6,X
02/C9BC: E8           INX 
02/C9BD: E0 10 00     CPX #$0010
02/C9C0: D0 F4        BNE $C9B6
02/C9C2: 64 00        STZ $00
02/C9C4: 7B           TDC 
02/C9C5: AA           TAX 
02/C9C6: BD E6 DB     LDA $DBE6,X     ; put monsters before characters
02/C9C9: 9D D4 34     STA $34D4,X
02/C9CC: 05 00        ORA $00
02/C9CE: 85 00        STA $00
02/C9D0: E8           INX 
02/C9D1: E0 1A 00     CPX #$001A
02/C9D4: D0 F0        BNE $C9C6
02/C9D6: A5 00        LDA $00
02/C9D8: D0 01        BNE $C9DB       ; return if all damage values are zero
02/C9DA: 60           RTS 
02/C9DB: 7B           TDC 
02/C9DC: AA           TAX 
02/C9DD: 3A           DEC 
02/C9DE: 9D E6 DB     STA $DBE6,X     ; set buffer to $FF
02/C9E1: E8           INX 
02/C9E2: E0 46 00     CPX #$0046
02/C9E5: D0 F7        BNE $C9DE
02/C9E7: 7B           TDC 
02/C9E8: AA           TAX 
02/C9E9: 7B           TDC 
02/C9EA: 9D FA F0     STA $F0FA,X     ; disable character/monster damage numerals
02/C9ED: A9 31        LDA #$31        ; use white text (palette 0)
02/C9EF: 9D ED F0     STA $F0ED,X
02/C9F2: E8           INX 
02/C9F3: E0 0D 00     CPX #$000D
02/C9F6: D0 F1        BNE $C9E9
02/C9F8: 7B           TDC 
02/C9F9: AA           TAX 
02/C9FA: A8           TAY 
02/C9FB: 86 02        STX $02
02/C9FD: C2 20        REP #$20
02/C9FF: B1 41        LDA ($41),Y     ; damage value
02/CA01: 85 00        STA $00
02/CA03: 29 FF 3F     AND #$3FFF
02/CA06: AA           TAX 
02/CA07: 7B           TDC 
02/CA08: E2 20        SEP #$20
02/CA0A: 20 BF 86     JSR $86BF       ; convert hex to decimal
02/CA0D: 20 16 87     JSR $8716       ; normalize number text
02/CA10: 5A           PHY 
02/CA11: C8           INY 
02/CA12: B1 41        LDA ($41),Y
02/CA14: 29 40        AND #$40
02/CA16: F0 12        BEQ $CA2A       ; branch if not miss
02/CA18: A9 FF        LDA #$FF
02/CA1A: 8D 0C 18     STA $180C
02/CA1D: 8D 0F 18     STA $180F
02/CA20: A9 6C        LDA #$6C        ; set "miss" tiles
02/CA22: 8D 0D 18     STA $180D
02/CA25: A9 6D        LDA #$6D
02/CA27: 8D 0E 18     STA $180E
02/CA2A: 7B           TDC 
02/CA2B: AA           TAX 
02/CA2C: A4 02        LDY $02
02/CA2E: BD 0C 18     LDA $180C,X     ; number digit
02/CA31: C9 FF        CMP #$FF
02/CA33: F0 03        BEQ $CA38       ; branch if no digit
02/CA35: 38           SEC 
02/CA36: E9 10        SBC #$10
02/CA38: 99 E7 DB     STA $DBE7,Y     ; copy 4 digits to buffer
02/CA3B: C8           INY 
02/CA3C: E8           INX 
02/CA3D: E0 04 00     CPX #$0004
02/CA40: D0 EC        BNE $CA2E
02/CA42: 7A           PLY 
02/CA43: C2 20        REP #$20
02/CA45: A5 02        LDA $02         ; increment buffer pointer
02/CA47: 18           CLC 
02/CA48: 69 05 00     ADC #$0005
02/CA4B: 85 02        STA $02
02/CA4D: B1 41        LDA ($41),Y
02/CA4F: D0 0B        BNE $CA5C       ; branch if damage is nonzero
02/CA51: 98           TYA 
02/CA52: 4A           LSR 
02/CA53: AA           TAX 
02/CA54: 7B           TDC 
02/CA55: E2 20        SEP #$20
02/CA57: FE FA F0     INC $F0FA,X     ; enable character/monster damage numerals
02/CA5A: 80 03        BRA $CA5F
02/CA5C: 7B           TDC 
02/CA5D: E2 20        SEP #$20
02/CA5F: C8           INY 
02/CA60: B1 41        LDA ($41),Y
02/CA62: 29 40        AND #$40
02/CA64: F0 09        BEQ $CA6F       ; branch if not miss
02/CA66: 98           TYA 
02/CA67: 3A           DEC 
02/CA68: 4A           LSR 
02/CA69: AA           TAX 
02/CA6A: A9 FF        LDA #$FF
02/CA6C: 9D FA F0     STA $F0FA,X
02/CA6F: B1 41        LDA ($41),Y
02/CA71: 10 09        BPL $CA7C       ; branch if hp damage
02/CA73: 98           TYA 
02/CA74: 3A           DEC 
02/CA75: 4A           LSR 
02/CA76: AA           TAX 
02/CA77: A9 3D        LDA #$3D        ; use green text (palette 6)
02/CA79: 9D ED F0     STA $F0ED,X
02/CA7C: C8           INY 
02/CA7D: C0 1A 00     CPY #$001A
02/CA80: F0 03        BEQ $CA85
02/CA82: 4C FD C9     JMP $C9FD
02/CA85: 7B           TDC 
02/CA86: AA           TAX 
02/CA87: A8           TAY 
02/CA88: BD 5D F0     LDA $F05D,X     ; monster x positions
02/CA8B: 99 D3 F0     STA $F0D3,Y
02/CA8E: E8           INX 
02/CA8F: BD 5D F0     LDA $F05D,X
02/CA92: 99 E0 F0     STA $F0E0,Y
02/CA95: E8           INX 
02/CA96: C8           INY 
02/CA97: C0 08 00     CPY #$0008
02/CA9A: D0 EC        BNE $CA88
02/CA9C: 7B           TDC 
02/CA9D: AA           TAX 
02/CA9E: A8           TAY 
02/CA9F: BD C5 EF     LDA $EFC5,X
02/CAA2: 18           CLC 
02/CAA3: 7D C7 EF     ADC $EFC7,X
02/CAA6: 99 DB F0     STA $F0DB,Y     ; x position
02/CAA9: BD C6 EF     LDA $EFC6,X
02/CAAC: 18           CLC 
02/CAAD: 7D C8 EF     ADC $EFC8,X
02/CAB0: 69 18        ADC #$18
02/CAB2: 99 E8 F0     STA $F0E8,Y     ; y position
02/CAB5: 8A           TXA 
02/CAB6: 18           CLC 
02/CAB7: 69 10        ADC #$10
02/CAB9: AA           TAX 
02/CABA: C8           INY 
02/CABB: C0 05 00     CPY #$0005
02/CABE: D0 DF        BNE $CA9F
02/CAC0: 9C 08 F1     STZ $F108       ; clear frame counter
02/CAC3: C2 20        REP #$20
02/CAC5: AD 41 00     LDA $0041
02/CAC8: 18           CLC 
02/CAC9: 69 1A 00     ADC #$001A      ; increment damage buffer pointer
02/CACC: 8D 41 00     STA $0041
02/CACF: 7B           TDC 
02/CAD0: E2 20        SEP #$20
02/CAD2: EE 07 F1     INC $F107       ; enable damage numeral animation
02/CAD5: 20 13 85     JSR $8513       ; wait one frame
02/CAD8: AD 07 F1     LDA $F107
02/CADB: D0 F8        BNE $CAD5
02/CADD: 60           RTS 
; 0: attacker name (unused)
02/CADE: AD C2 34     LDA $34C2
02/CAE1: 30 07        BMI $CAEA       ; branch if monster attacker
02/CAE3: A9 02        LDA #$02        ; character name
02/CAE5: 8D FD 74     STA $74FD
02/CAE8: 80 05        BRA $CAEF
02/CAEA: A9 0C        LDA #$0C        ; monster name
02/CAEC: 8D FD 74     STA $74FD
02/CAEF: A5 48        LDA $48         ; target id
02/CAF1: 8D FE 74     STA $74FE
02/CAF4: 9C FF 74     STZ $74FF
02/CAF7: 4C 04 93     JMP $9304       ; draw message window (left)
; 1: target name (unused)
02/CAFA: AD C4 34     LDA $34C4
02/CAFD: 29 40        AND #$40
02/CAFF: F0 11        BEQ $CB12       ; branch if not multi-target
02/CB01: 7B           TDC 
02/CB02: AA           TAX 
02/CB03: BF 49 FD 16  LDA $16FD49,X   ;  (all)
02/CB07: 9D FD 74     STA $74FD,X
02/CB0A: E8           INX 
02/CB0B: E0 04 00     CPX #$0004
02/CB0E: D0 F3        BNE $CB03
02/CB10: 80 1D        BRA $CB2F
02/CB12: AD C4 34     LDA $34C4
02/CB15: 30 07        BMI $CB1E       ; branch if monster target
02/CB17: A9 02        LDA #$02        ; character name
02/CB19: 8D FD 74     STA $74FD
02/CB1C: 80 05        BRA $CB23
02/CB1E: A9 0C        LDA #$0C        ; monster name
02/CB20: 8D FD 74     STA $74FD
02/CB23: A5 49        LDA $49         ; target id
02/CB25: AA           TAX 
02/CB26: BD BD 29     LDA $29BD,X     ; monster type
02/CB29: 8D FE 74     STA $74FE
02/CB2C: 9C FF 74     STZ $74FF
02/CB2F: 4C 32 93     JMP $9332       ; draw message window (center)
; 2: attack name
02/CB32: AD C7 34     LDA $34C7
02/CB35: 29 70        AND #$70
02/CB37: C9 40        CMP #$40
02/CB39: F0 31        BEQ $CB6C       ; branch if magic used
02/CB3B: C9 20        CMP #$20
02/CB3D: F0 2A        BEQ $CB69       ; branch if item used
02/CB3F: C9 10        CMP #$10
02/CB41: F0 01        BEQ $CB44       ; branch if command used
02/CB43: 60           RTS 
; command name
02/CB44: AD C8 34     LDA $34C8
02/CB47: 85 26        STA $26
02/CB49: A9 05        LDA #$05
02/CB4B: 85 28        STA $28
02/CB4D: 20 60 85     JSR $8560       ; multiply (8-bit)
02/CB50: 7B           TDC 
02/CB51: A8           TAY 
02/CB52: A6 2A        LDX $2A
02/CB54: BF B8 A7 0F  LDA $0FA7B8,X
02/CB58: 99 FD 74     STA $74FD,Y
02/CB5B: E8           INX 
02/CB5C: C8           INY 
02/CB5D: C0 05 00     CPY #$0005
02/CB60: D0 F2        BNE $CB54
02/CB62: 7B           TDC 
02/CB63: 99 FD 74     STA $74FD,Y
02/CB66: 4C A2 BC     JMP $BCA2       ; draw attack name window
02/CB69: 4C 6F CB     JMP $CB6F       ; item name
02/CB6C: 4C 98 CB     JMP $CB98       ; attack name
; item name
02/CB6F: AD C8 34     LDA $34C8
02/CB72: D0 01        BNE $CB75
02/CB74: 60           RTS 
02/CB75: 85 26        STA $26
02/CB77: A9 09        LDA #$09
02/CB79: 85 28        STA $28
02/CB7B: 20 60 85     JSR $8560       ; multiply (8-bit)
02/CB7E: 7B           TDC 
02/CB7F: A8           TAY 
02/CB80: A6 2A        LDX $2A
02/CB82: E8           INX 
02/CB83: BF 00 80 0F  LDA $0F8000,X
02/CB87: 99 FD 74     STA $74FD,Y
02/CB8A: C8           INY 
02/CB8B: E8           INX 
02/CB8C: C0 08 00     CPY #$0008
02/CB8F: D0 F2        BNE $CB83
02/CB91: 7B           TDC 
02/CB92: 99 FD 74     STA $74FD,Y
02/CB95: 4C A2 BC     JMP $BCA2       ; draw attack name window
; attack name
02/CB98: AD C8 34     LDA $34C8
02/CB9B: D0 01        BNE $CB9E       ; branch if attack name is shown
02/CB9D: 60           RTS 
02/CB9E: C9 48        CMP #$48
02/CBA0: 90 25        BCC $CBC7       ; branch if character magic
; monster attack name
02/CBA2: 38           SEC 
02/CBA3: E9 48        SBC #$48
02/CBA5: 85 26        STA $26
02/CBA7: A9 08        LDA #$08
02/CBA9: 85 28        STA $28
02/CBAB: 20 60 85     JSR $8560       ; multiply (8-bit)
02/CBAE: A6 2A        LDX $2A
02/CBB0: 7B           TDC 
02/CBB1: A8           TAY 
02/CBB2: BF B0 8A 0F  LDA $0F8AB0,X   ; attack names
02/CBB6: 99 FD 74     STA $74FD,Y
02/CBB9: C8           INY 
02/CBBA: E8           INX 
02/CBBB: C0 08 00     CPY #$0008
02/CBBE: D0 F2        BNE $CBB2
02/CBC0: 7B           TDC 
02/CBC1: 99 FD 74     STA $74FD,Y
02/CBC4: 4C A2 BC     JMP $BCA2       ; draw attack name window
; spell name
02/CBC7: AD C8 34     LDA $34C8
02/CBCA: 85 26        STA $26
02/CBCC: A9 06        LDA #$06
02/CBCE: 85 28        STA $28
02/CBD0: 20 60 85     JSR $8560       ; multiply (8-bit)
02/CBD3: 7B           TDC 
02/CBD4: A8           TAY 
02/CBD5: A6 2A        LDX $2A
02/CBD7: A9 03        LDA #$03
02/CBD9: 99 FD 74     STA $74FD,Y
02/CBDC: C8           INY 
02/CBDD: BF 00 89 0F  LDA $0F8900,X   ; spell names
02/CBE1: 99 FD 74     STA $74FD,Y
02/CBE4: C8           INY 
02/CBE5: E8           INX 
02/CBE6: C0 07 00     CPY #$0007
02/CBE9: D0 F2        BNE $CBDD
02/CBEB: 7B           TDC 
02/CBEC: 99 FD 74     STA $74FD,Y
02/CBEF: 4C A2 BC     JMP $BCA2       ; draw attack name window
; 3: battle message
02/CBF2: 20 74 C9     JSR $C974       ; wait for message window
02/CBF5: 20 A8 93     JSR $93A8       ; close message window
02/CBF8: 20 74 C9     JSR $C974       ; wait for message window
02/CBFB: B2 45        LDA ($45)
02/CBFD: C9 FF        CMP #$FF
02/CBFF: D0 01        BNE $CC02
02/CC01: 60           RTS 
02/CC02: 48           PHA 
02/CC03: C2 20        REP #$20
02/CC05: 0A           ASL 
02/CC06: AA           TAX 
02/CC07: BF 00 B2 0F  LDA $0FB200,X   ; pointers to battle messages
02/CC0B: 85 00        STA $00
02/CC0D: 7B           TDC 
02/CC0E: E2 20        SEP #$20
02/CC10: A9 0F        LDA #$0F
02/CC12: 85 02        STA $02
02/CC14: A6 45        LDX $45
02/CC16: E8           INX 
02/CC17: 86 45        STX $45
02/CC19: 7B           TDC 
02/CC1A: A8           TAY 
02/CC1B: AA           TAX 
02/CC1C: B7 00        LDA [$00],Y     ; copy to text buffer
02/CC1E: 99 FD 74     STA $74FD,Y
02/CC21: C8           INY 
02/CC22: E8           INX 
02/CC23: E0 80 00     CPX #$0080
02/CC26: D0 F4        BNE $CC1C
02/CC28: 20 D6 92     JSR $92D6       ; draw message window (full)
02/CC2B: 68           PLA 
02/CC2C: 20 3B C9     JSR $C93B       ; wait for battle message
02/CC2F: 4C F2 CB     JMP $CBF2

; [ graphics script command $F3:  ]

02/CC32: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/CC35: 8D BE 38     STA $38BE
02/CC38: EE BD 38     INC $38BD
02/CC3B: 60           RTS 

; [  ]

02/CC3C: 20 B2 BC     JSR $BCB2
02/CC3F: 64 4E        STZ $4E
02/CC41: 20 13 85     JSR $8513       ; wait one frame
02/CC44: A5 4E        LDA $4E
02/CC46: 29 01        AND #$01
02/CC48: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/CC4B: EE 4E 00     INC $004E
02/CC4E: AD 4E 00     LDA $004E
02/CC51: C9 60        CMP #$60
02/CC53: D0 EC        BNE $CC41
02/CC55: 20 AD BC     JSR $BCAD
02/CC58: A9 01        LDA #$01
02/CC5A: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/CC5D: 6B           RTL 

; [  ]

02/CC5E: 48           PHA 
02/CC5F: A9 01        LDA #$01
02/CC61: 8D 82 F4     STA $F482
02/CC64: 68           PLA 
02/CC65: 20 A8 CC     JSR $CCA8
02/CC68: 6B           RTL 

; [  ]

02/CC69: A2 00 00     LDX #$0000
02/CC6C: 20 13 85     JSR $8513       ; wait one frame
02/CC6F: DA           PHX 
02/CC70: 8A           TXA 
02/CC71: 20 02 83     JSR $8302       ; set monster hdma v-scroll value
02/CC74: FA           PLX 
02/CC75: 8A           TXA 
02/CC76: 18           CLC 
02/CC77: 69 10        ADC #$10
02/CC79: AA           TAX 
02/CC7A: E0 90 00     CPX #$0090
02/CC7D: D0 ED        BNE $CC6C
02/CC7F: 22 DD BE 02  JSL $02BEDD
02/CC83: A2 90 00     LDX #$0090
02/CC86: 20 13 85     JSR $8513       ; wait one frame
02/CC89: DA           PHX 
02/CC8A: 8A           TXA 
02/CC8B: 20 02 83     JSR $8302       ; set monster hdma v-scroll value
02/CC8E: FA           PLX 
02/CC8F: 8A           TXA 
02/CC90: 38           SEC 
02/CC91: E9 10        SBC #$10
02/CC93: AA           TAX 
02/CC94: C9 F0        CMP #$F0
02/CC96: D0 EE        BNE $CC86
02/CC98: 60           RTS 

; [  ]

02/CC99: 48           PHA 
02/CC9A: 20 B2 BC     JSR $BCB2
02/CC9D: 68           PLA 
02/CC9E: 20 CA CC     JSR $CCCA
02/CCA1: 6B           RTL 

; [ graphics script command $F0: change boss frame ]

; ssgggggg
;   s: monster slot
;   g: boss frame id

02/CCA2: 9C 82 F4     STZ $F482
02/CCA5: 20 2B C0     JSR $C02B       ; get next graphics script byte
02/CCA8: 48           PHA 
02/CCA9: 4A           LSR 
02/CCAA: 4A           LSR 
02/CCAB: 4A           LSR 
02/CCAC: 4A           LSR 
02/CCAD: 4A           LSR 
02/CCAE: 4A           LSR 
02/CCAF: A8           TAY 
02/CCB0: 68           PLA 
02/CCB1: 29 3F        AND #$3F
02/CCB3: 99 B4 F2     STA $F2B4,Y     ; boss frame id
02/CCB6: 20 CC 8B     JSR $8BCC
02/CCB9: 20 C7 8B     JSR $8BC7
02/CCBC: AD 82 F4     LDA $F482
02/CCBF: F0 03        BEQ $CCC4
02/CCC1: 4C AD BC     JMP $BCAD
02/CCC4: 20 B2 BC     JSR $BCB2
02/CCC7: AD A6 EF     LDA $EFA6
02/CCCA: 29 0F        AND #$0F
02/CCCC: F0 17        BEQ $CCE5
02/CCCE: C9 01        CMP #$01
02/CCD0: F0 3F        BEQ $CD11
02/CCD2: C9 02        CMP #$02
02/CCD4: F0 30        BEQ $CD06
02/CCD6: C9 03        CMP #$03
02/CCD8: F0 17        BEQ $CCF1
02/CCDA: C9 04        CMP #$04
02/CCDC: F0 03        BEQ $CCE1
02/CCDE: 4C 69 CC     JMP $CC69
02/CCE1: 22 80 F9 03  JSL $03F980
02/CCE5: A9 01        LDA #$01
02/CCE7: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/CCEA: 20 AD BC     JSR $BCAD
02/CCED: 7B           TDC 
02/CCEE: 4C C2 BC     JMP $BCC2       ; clear bg1 h-scroll hdma data
02/CCF1: A9 30        LDA #$30
02/CCF3: 85 4E        STA $4E
02/CCF5: 20 13 85     JSR $8513       ; wait one frame
02/CCF8: 9C E6 38     STZ $38E6
02/CCFB: 22 C8 FA 03  JSL $03FAC8
02/CCFF: C6 4E        DEC $4E
02/CD01: D0 F2        BNE $CCF5
02/CD03: 4C E5 CC     JMP $CCE5
02/CD06: A9 59        LDA #$59
02/CD08: 20 DF F5     JSR $F5DF
02/CD0B: 20 56 BE     JSR $BE56
02/CD0E: 4C E5 CC     JMP $CCE5
02/CD11: 64 4E        STZ $4E
02/CD13: A2 08 00     LDX #$0008
02/CD16: 20 A0 C8     JSR $C8A0       ; wait
02/CD19: 20 34 CD     JSR $CD34
02/CD1C: E6 4E        INC $4E
02/CD1E: A5 4E        LDA $4E
02/CD20: C9 07        CMP #$07
02/CD22: D0 EF        BNE $CD13
02/CD24: 20 AD BC     JSR $BCAD
02/CD27: A2 08 00     LDX #$0008
02/CD2A: 20 A0 C8     JSR $C8A0       ; wait
02/CD2D: 20 34 CD     JSR $CD34
02/CD30: C6 4E        DEC $4E
02/CD32: D0 F3        BNE $CD27
02/CD34: A5 4E        LDA $4E
02/CD36: 0A           ASL 
02/CD37: 0A           ASL 
02/CD38: 0A           ASL 
02/CD39: 0A           ASL 
02/CD3A: 29 F0        AND #$F0
02/CD3C: 09 01        ORA #$01
02/CD3E: 8D C2 6C     STA $6CC2
02/CD41: 60           RTS 

; --------------------------------------------------------------------------

; [ weapon animation $0A: whip ]

02/CD42: A9 01        LDA #$01
02/CD44: 8D 33 F2     STA $F233
02/CD47: 80 03        BRA $CD4C

; [ weapon animation $01: sword ]

02/CD49: 9C 33 F2     STZ $F233
02/CD4C: A5 4E        LDA $4E
02/CD4E: D0 03        BNE $CD53
02/CD50: 4C EC CE     JMP $CEEC
02/CD53: 4C E3 CE     JMP $CEE3

; [ weapon animation $0B: hammer ]

02/CD56: A9 2C        LDA #$2C
02/CD58: 80 02        BRA $CD5C

; [ weapon animation $02: rod ]

02/CD5A: A9 0B        LDA #$0B
02/CD5C: 8D A0 F4     STA $F4A0
02/CD5F: 9C 33 F2     STZ $F233
02/CD62: A5 4E        LDA $4E
02/CD64: D0 03        BNE $CD69
02/CD66: 4C 84 CE     JMP $CE84
02/CD69: 4C 7B CE     JMP $CE7B

; [  ]

02/CD6C: A5 52        LDA $52
02/CD6E: 1A           INC 
02/CD6F: 29 04        AND #$04
02/CD71: AA           TAX 
02/CD72: AD 42 F2     LDA $F242
02/CD75: F0 05        BEQ $CD7C
02/CD77: 8A           TXA 
02/CD78: 18           CLC 
02/CD79: 69 08        ADC #$08
02/CD7B: AA           TAX 
02/CD7C: BF 58 FD 16  LDA $16FD58,X
02/CD80: 8D CB F0     STA $F0CB
02/CD83: BF 59 FD 16  LDA $16FD59,X
02/CD87: 8D D1 F0     STA $F0D1
02/CD8A: BF 5A FD 16  LDA $16FD5A,X
02/CD8E: 8D D2 F0     STA $F0D2
02/CD91: BF 5B FD 16  LDA $16FD5B,X
02/CD95: 8D CE F0     STA $F0CE
02/CD98: 60           RTS 

; [  ]

02/CD99: AD 33 F2     LDA $F233
02/CD9C: F0 23        BEQ $CDC1
02/CD9E: AD 42 F2     LDA $F242
02/CDA1: D0 04        BNE $CDA7
02/CDA3: A9 3F        LDA #$3F
02/CDA5: 80 02        BRA $CDA9
02/CDA7: A9 7F        LDA #$7F
02/CDA9: 8D CE F0     STA $F0CE
02/CDAC: AD CD F0     LDA $F0CD
02/CDAF: 18           CLC 
02/CDB0: 69 08        ADC #$08
02/CDB2: 8D CD F0     STA $F0CD
02/CDB5: A5 52        LDA $52
02/CDB7: 1A           INC 
02/CDB8: 29 04        AND #$04
02/CDBA: F0 05        BEQ $CDC1
02/CDBC: A9 82        LDA #$82
02/CDBE: 8D CB F0     STA $F0CB
02/CDC1: 60           RTS 

; [  ]

02/CDC2: 8D CF F0     STA $F0CF
02/CDC5: 20 B8 C5     JSR $C5B8
02/CDC8: 9E CD EF     STZ $EFCD,X
02/CDCB: 9E D3 EF     STZ $EFD3,X
02/CDCE: A9 10        LDA #$10
02/CDD0: 85 54        STA $54
02/CDD2: 20 07 E7     JSR $E707
02/CDD5: 20 13 85     JSR $8513       ; wait one frame
02/CDD8: A5 52        LDA $52
02/CDDA: 29 07        AND #$07
02/CDDC: D0 09        BNE $CDE7
02/CDDE: AD A0 F4     LDA $F4A0
02/CDE1: 20 DF F5     JSR $F5DF
02/CDE4: 20 86 D5     JSR $D586
02/CDE7: 20 B8 C5     JSR $C5B8
02/CDEA: A5 52        LDA $52
02/CDEC: 29 01        AND #$01
02/CDEE: D0 03        BNE $CDF3
02/CDF0: FE D3 EF     INC $EFD3,X
02/CDF3: E6 52        INC $52
02/CDF5: A5 52        LDA $52
02/CDF7: 29 03        AND #$03
02/CDF9: 20 EC D6     JSR $D6EC
02/CDFC: A5 52        LDA $52
02/CDFE: 29 02        AND #$02
02/CE00: 18           CLC 
02/CE01: 69 A0        ADC #$A0
02/CE03: 8D C6 F0     STA $F0C6
02/CE06: 20 7C D7     JSR $D77C
02/CE09: 20 6C CD     JSR $CD6C
02/CE0C: 20 99 CD     JSR $CD99
02/CE0F: 20 B8 C5     JSR $C5B8
02/CE12: BD C5 EF     LDA $EFC5,X
02/CE15: 18           CLC 
02/CE16: 7D C7 EF     ADC $EFC7,X
02/CE19: 6D D1 F0     ADC $F0D1
02/CE1C: 8D CC F0     STA $F0CC
02/CE1F: BD C6 EF     LDA $EFC6,X
02/CE22: 18           CLC 
02/CE23: 7D C8 EF     ADC $EFC8,X
02/CE26: 6D D2 F0     ADC $F0D2
02/CE29: 8D CD F0     STA $F0CD
02/CE2C: A5 48        LDA $48
02/CE2E: AA           TAX 
02/CE2F: BF 15 FD 16  LDA $16FD15,X
02/CE33: 18           CLC 
02/CE34: 6D CF F0     ADC $F0CF
02/CE37: 8D CA F0     STA $F0CA
02/CE3A: EE C9 F0     INC $F0C9
02/CE3D: AD C4 34     LDA $34C4
02/CE40: 10 0A        BPL $CE4C
02/CE42: AD C7 34     LDA $34C7
02/CE45: 29 08        AND #$08
02/CE47: D0 03        BNE $CE4C
02/CE49: EE C1 F0     INC $F0C1
02/CE4C: C6 54        DEC $54
02/CE4E: F0 03        BEQ $CE53
02/CE50: 4C D5 CD     JMP $CDD5
02/CE53: 9C C9 F0     STZ $F0C9
02/CE56: 60           RTS 

; [  ]

02/CE57: 48           PHA 
02/CE58: A5 48        LDA $48
02/CE5A: AA           TAX 
02/CE5B: BF 10 FD 16  LDA $16FD10,X
02/CE5F: 80 08        BRA $CE69
02/CE61: 48           PHA 
02/CE62: A5 48        LDA $48
02/CE64: AA           TAX 
02/CE65: BF 15 FD 16  LDA $16FD15,X
02/CE69: 9D BC F0     STA $F0BC,X
02/CE6C: 68           PLA 
02/CE6D: 9D 99 F0     STA $F099,X
02/CE70: A5 4E        LDA $4E
02/CE72: AA           TAX 
02/CE73: B5 50        LDA $50,X
02/CE75: 20 BD D8     JSR $D8BD
02/CE78: 64 52        STZ $52
02/CE7A: 60           RTS 

; [  ]

02/CE7B: A9 06        LDA #$06
02/CE7D: 20 57 CE     JSR $CE57
02/CE80: 7B           TDC 
02/CE81: 4C C2 CD     JMP $CDC2

; [  ]

02/CE84: A9 05        LDA #$05
02/CE86: 20 61 CE     JSR $CE61
02/CE89: A9 06        LDA #$06
02/CE8B: 4C C2 CD     JMP $CDC2

; [  ]

02/CE8E: A9 05        LDA #$05
02/CE90: 20 61 CE     JSR $CE61
02/CE93: A9 06        LDA #$06
02/CE95: 4C 84 D3     JMP $D384

; [  ]

02/CE98: A9 06        LDA #$06
02/CE9A: 20 57 CE     JSR $CE57
02/CE9D: 7B           TDC 
02/CE9E: 4C 84 D3     JMP $D384

; [  ]

02/CEA1: A9 06        LDA #$06
02/CEA3: 20 57 CE     JSR $CE57
02/CEA6: 20 B8 C5     JSR $C5B8
02/CEA9: 7B           TDC 
02/CEAA: 9D D3 EF     STA $EFD3,X
02/CEAD: 4C 01 D4     JMP $D401

; [  ]

02/CEB0: A9 06        LDA #$06
02/CEB2: 20 61 CE     JSR $CE61
02/CEB5: 20 B8 C5     JSR $C5B8
02/CEB8: A9 03        LDA #$03
02/CEBA: 9D D3 EF     STA $EFD3,X
02/CEBD: A9 06        LDA #$06
02/CEBF: 4C 01 D4     JMP $D401

; [  ]

02/CEC2: A9 06        LDA #$06
02/CEC4: 20 61 CE     JSR $CE61
02/CEC7: 20 B8 C5     JSR $C5B8
02/CECA: A9 03        LDA #$03
02/CECC: 9D D3 EF     STA $EFD3,X
02/CECF: A9 06        LDA #$06
02/CED1: 4C 9C D5     JMP $D59C

; [  ]

02/CED4: A9 06        LDA #$06
02/CED6: 20 57 CE     JSR $CE57
02/CED9: 20 B8 C5     JSR $C5B8
02/CEDC: 7B           TDC 
02/CEDD: 9D D3 EF     STA $EFD3,X
02/CEE0: 4C 9C D5     JMP $D59C

; [  ]

02/CEE3: A9 06        LDA #$06
02/CEE5: 20 57 CE     JSR $CE57
02/CEE8: 7B           TDC 
02/CEE9: 4C F6 CE     JMP $CEF6

; [  ]

02/CEEC: A9 05        LDA #$05
02/CEEE: 20 61 CE     JSR $CE61
02/CEF1: A9 06        LDA #$06
02/CEF3: 4C F6 CE     JMP $CEF6

; [  ]

02/CEF6: 8D CF F0     STA $F0CF
02/CEF9: 20 B8 C5     JSR $C5B8
02/CEFC: 9E CD EF     STZ $EFCD,X
02/CEFF: 9E D3 EF     STZ $EFD3,X
02/CF02: A9 10        LDA #$10
02/CF04: 85 54        STA $54
02/CF06: A5 49        LDA $49
02/CF08: 0A           ASL 
02/CF09: A8           TAY 
02/CF0A: B9 43 F0     LDA $F043,Y
02/CF0D: 8D C4 F0     STA $F0C4
02/CF10: B9 44 F0     LDA $F044,Y
02/CF13: 8D C5 F0     STA $F0C5
02/CF16: 20 13 85     JSR $8513       ; wait one frame
02/CF19: A5 52        LDA $52
02/CF1B: 29 07        AND #$07
02/CF1D: D0 09        BNE $CF28
02/CF1F: AD A0 F4     LDA $F4A0
02/CF22: 20 DF F5     JSR $F5DF
02/CF25: 20 86 D5     JSR $D586
02/CF28: 20 B8 C5     JSR $C5B8
02/CF2B: A5 52        LDA $52
02/CF2D: 29 01        AND #$01
02/CF2F: D0 03        BNE $CF34
02/CF31: FE D3 EF     INC $EFD3,X
02/CF34: E6 52        INC $52
02/CF36: EE 2B F4     INC $F42B
02/CF39: 9C C7 F0     STZ $F0C7
02/CF3C: A9 3F        LDA #$3F
02/CF3E: 8D C8 F0     STA $F0C8
02/CF41: 86 00        STX $00
02/CF43: A5 53        LDA $53
02/CF45: 0A           ASL 
02/CF46: 0A           ASL 
02/CF47: 0A           ASL 
02/CF48: 85 04        STA $04
02/CF4A: A5 52        LDA $52
02/CF4C: 29 07        AND #$07
02/CF4E: 18           CLC 
02/CF4F: 65 04        ADC $04
02/CF51: AA           TAX 
02/CF52: A9 A0        LDA #$A0
02/CF54: 8D C6 F0     STA $F0C6
02/CF57: BF 49 FA 0D  LDA $0DFA49,X
02/CF5B: 8D C3 F0     STA $F0C3
02/CF5E: A9 10        LDA #$10
02/CF60: 8D C2 F0     STA $F0C2
02/CF63: 9C 2B F4     STZ $F42B
02/CF66: 20 6C CD     JSR $CD6C
02/CF69: 20 99 CD     JSR $CD99
02/CF6C: A6 00        LDX $00
02/CF6E: BD C5 EF     LDA $EFC5,X
02/CF71: 18           CLC 
02/CF72: 7D C7 EF     ADC $EFC7,X
02/CF75: 6D D1 F0     ADC $F0D1
02/CF78: 8D CC F0     STA $F0CC
02/CF7B: BD C6 EF     LDA $EFC6,X
02/CF7E: 18           CLC 
02/CF7F: 7D C8 EF     ADC $EFC8,X
02/CF82: 6D D2 F0     ADC $F0D2
02/CF85: 8D CD F0     STA $F0CD
02/CF88: A5 48        LDA $48
02/CF8A: AA           TAX 
02/CF8B: BF 15 FD 16  LDA $16FD15,X
02/CF8F: 18           CLC 
02/CF90: 6D CF F0     ADC $F0CF
02/CF93: 8D CA F0     STA $F0CA
02/CF96: EE C9 F0     INC $F0C9
02/CF99: AD 68 F4     LDA $F468
02/CF9C: D0 0F        BNE $CFAD
02/CF9E: AD C4 34     LDA $34C4
02/CFA1: 10 0A        BPL $CFAD
02/CFA3: AD C7 34     LDA $34C7
02/CFA6: 29 08        AND #$08
02/CFA8: D0 03        BNE $CFAD
02/CFAA: EE C1 F0     INC $F0C1
02/CFAD: C6 54        DEC $54
02/CFAF: F0 03        BEQ $CFB4
02/CFB1: 4C 16 CF     JMP $CF16
02/CFB4: 9C C9 F0     STZ $F0C9
02/CFB7: 60           RTS 

; [  ]

02/CFB8: 9C 80 F4     STZ $F480
02/CFBB: A5 48        LDA $48
02/CFBD: 0A           ASL 
02/CFBE: 0A           ASL 
02/CFBF: 0A           ASL 
02/CFC0: AA           TAX 
02/CFC1: BD DB 32     LDA $32DB,X
02/CFC4: 85 50        STA $50
02/CFC6: BD DF 32     LDA $32DF,X
02/CFC9: 85 51        STA $51
02/CFCB: A5 49        LDA $49
02/CFCD: 0A           ASL 
02/CFCE: AA           TAX 
02/CFCF: AD C4 34     LDA $34C4
02/CFD2: 30 05        BMI $CFD9
02/CFD4: BD D5 34     LDA $34D5,X
02/CFD7: 80 03        BRA $CFDC
02/CFD9: BD DF 34     LDA $34DF,X
02/CFDC: 29 40        AND #$40
02/CFDE: 4A           LSR 
02/CFDF: 4A           LSR 
02/CFE0: 4A           LSR 
02/CFE1: 85 00        STA $00
02/CFE3: AD C7 34     LDA $34C7
02/CFE6: 05 00        ORA $00
02/CFE8: 8D C7 34     STA $34C7
02/CFEB: AD C2 34     LDA $34C2
02/CFEE: 30 3B        BMI $D02B
02/CFF0: 20 B8 C5     JSR $C5B8
02/CFF3: BD C5 EF     LDA $EFC5,X
02/CFF6: C9 C0        CMP #$C0
02/CFF8: D0 F9        BNE $CFF3
02/CFFA: AD 80 F4     LDA $F480
02/CFFD: D0 10        BNE $D00F
02/CFFF: A5 50        LDA $50
02/D001: C9 60        CMP #$60
02/D003: 90 02        BCC $D007
02/D005: 64 50        STZ $50
02/D007: A5 51        LDA $51
02/D009: C9 60        CMP #$60
02/D00B: 90 02        BCC $D00F
02/D00D: 64 51        STZ $51
02/D00F: 20 3F D1     JSR $D13F      ; do weapon animation
02/D012: 20 07 E7     JSR $E707
02/D015: 20 6E D0     JSR $D06E
02/D018: A5 48        LDA $48
02/D01A: AA           TAX 
02/D01B: 7B           TDC 
02/D01C: 9D BC F0     STA $F0BC,X
02/D01F: 9D 99 F0     STA $F099,X
02/D022: 20 B8 C5     JSR $C5B8
02/D025: A9 01        LDA #$01
02/D027: 9D CD EF     STA $EFCD,X
02/D02A: 60           RTS 
02/D02B: AD 4E ED     LDA $ED4E
02/D02E: 29 10        AND #$10
02/D030: F0 1B        BEQ $D04D
02/D032: A9 18        LDA #$18
02/D034: 20 BD D8     JSR $D8BD
02/D037: 20 50 D0     JSR $D050
02/D03A: 20 50 D0     JSR $D050
02/D03D: A2 08 00     LDX #$0008
02/D040: 20 A0 C8     JSR $C8A0       ; wait
02/D043: 9C C9 F0     STZ $F0C9
02/D046: 20 07 E7     JSR $E707
02/D049: 7B           TDC 
02/D04A: 20 A2 C6     JSR $C6A2
02/D04D: 4C 6E D0     JMP $D06E

; [  ]

02/D050: 9C 10 F4     STZ $F410
02/D053: 22 F2 F0 01  JSL $01F0F2
02/D057: A9 06        LDA #$06
02/D059: 20 A2 C6     JSR $C6A2
02/D05C: EE 10 F4     INC $F410
02/D05F: 22 F2 F0 01  JSL $01F0F2
02/D063: A9 05        LDA #$05
02/D065: 20 A2 C6     JSR $C6A2
02/D068: 60           RTS 

; [  ]

02/D069: 22 9C E6 01  JSL $01E69C
02/D06D: 60           RTS 

; [  ]

02/D06E: AD C4 34     LDA $34C4
02/D071: 30 76        BMI $D0E9
02/D073: 7B           TDC 
02/D074: AA           TAX 
02/D075: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/D079: CD C6 34     CMP $34C6
02/D07C: F0 08        BEQ $D086
02/D07E: E8           INX 
02/D07F: E0 08 00     CPX #$0008
02/D082: D0 F1        BNE $D075
02/D084: 7B           TDC 
02/D085: AA           TAX 
02/D086: 8A           TXA 
02/D087: 8D 33 F1     STA $F133
02/D08A: 64 4E        STZ $4E
02/D08C: AD C7 34     LDA $34C7
02/D08F: 29 08        AND #$08
02/D091: D0 08        BNE $D09B
02/D093: A9 2A        LDA #$2A
02/D095: 20 DF F5     JSR $F5DF
02/D098: 20 86 D5     JSR $D586
02/D09B: A5 49        LDA $49
02/D09D: A8           TAY 
02/D09E: B9 99 F0     LDA $F099,Y
02/D0A1: 99 9E F0     STA $F09E,Y
02/D0A4: 20 13 85     JSR $8513       ; wait one frame
02/D0A7: 20 07 D1     JSR $D107
02/D0AA: 20 C0 C5     JSR $C5C0
02/D0AD: AD C7 34     LDA $34C7
02/D0B0: 29 08        AND #$08
02/D0B2: D0 15        BNE $D0C9
02/D0B4: AD C7 34     LDA $34C7
02/D0B7: 29 04        AND #$04
02/D0B9: 0A           ASL 
02/D0BA: 0A           ASL 
02/D0BB: 85 00        STA $00
02/D0BD: A5 4E        LDA $4E
02/D0BF: 29 04        AND #$04
02/D0C1: 49 04        EOR #$04
02/D0C3: 18           CLC 
02/D0C4: 65 00        ADC $00
02/D0C6: 9D C7 EF     STA $EFC7,X
02/D0C9: E6 4E        INC $4E
02/D0CB: A5 4E        LDA $4E
02/D0CD: C9 10        CMP #$10
02/D0CF: D0 D3        BNE $D0A4
02/D0D1: 7B           TDC 
02/D0D2: 9D C7 EF     STA $EFC7,X
02/D0D5: A5 49        LDA $49
02/D0D7: A8           TAY 
02/D0D8: B9 9E F0     LDA $F09E,Y
02/D0DB: 99 99 F0     STA $F099,Y
02/D0DE: A5 49        LDA $49
02/D0E0: AA           TAX 
02/D0E1: 7B           TDC 
02/D0E2: 9D 16 F3     STA $F316,X
02/D0E5: 9D 1B F3     STA $F31B,X
02/D0E8: 60           RTS 
02/D0E9: AD C2 34     LDA $34C2
02/D0EC: 10 18        BPL $D106
02/D0EE: AD C7 34     LDA $34C7
02/D0F1: 29 08        AND #$08
02/D0F3: D0 11        BNE $D106
02/D0F5: 20 07 E7     JSR $E707
02/D0F8: 7B           TDC 
02/D0F9: 20 BD D8     JSR $D8BD
02/D0FC: A9 08        LDA #$08
02/D0FE: 8D C8 34     STA $34C8
02/D101: A9 08        LDA #$08
02/D103: 20 34 D7     JSR $D734
02/D106: 60           RTS 

; [  ]

02/D107: AD C6 34     LDA $34C6
02/D10A: F0 23        BEQ $D12F
02/D10C: A5 49        LDA $49
02/D10E: AA           TAX 
02/D10F: AD 33 F1     LDA $F133
02/D112: 0A           ASL 
02/D113: 0A           ASL 
02/D114: 0A           ASL 
02/D115: 0A           ASL 
02/D116: A8           TAY 
02/D117: B9 C5 EF     LDA $EFC5,Y
02/D11A: 38           SEC 
02/D11B: E9 10        SBC #$10
02/D11D: 9D 16 F3     STA $F316,X
02/D120: B9 C6 EF     LDA $EFC6,Y
02/D123: 9D 1B F3     STA $F31B,X
02/D126: A5 49        LDA $49
02/D128: A8           TAY 
02/D129: A9 0E        LDA #$0E
02/D12B: 99 99 F0     STA $F099,Y
02/D12E: 60           RTS 
02/D12F: AD C7 34     LDA $34C7
02/D132: 29 08        AND #$08
02/D134: D0 08        BNE $D13E
02/D136: A5 49        LDA $49
02/D138: A8           TAY 
02/D139: A9 07        LDA #$07
02/D13B: 99 99 F0     STA $F099,Y
02/D13E: 60           RTS 

; [ do weapon animation ]

02/D13F: A5 48        LDA $48
02/D141: 0A           ASL 
02/D142: 0A           ASL 
02/D143: AA           TAX 
02/D144: BD 15 F0     LDA $F015,X
02/D147: 29 30        AND #$30
02/D149: F0 04        BEQ $D14F
02/D14B: 7B           TDC 
02/D14C: AA           TAX 
02/D14D: 86 50        STX $50
02/D14F: 9C 42 F2     STZ $F242
02/D152: BD 16 F0     LDA $F016,X
02/D155: 29 08        AND #$08
02/D157: F0 03        BEQ $D15C
02/D159: EE 42 F2     INC $F242
02/D15C: 64 4E        STZ $4E
02/D15E: A5 4E        LDA $4E
02/D160: AA           TAX 
02/D161: B5 50        LDA $50,X
02/D163: 20 21 D5     JSR $D521
02/D166: BF 13 9E 0F  LDA $0F9E13,X
02/D16A: 0A           ASL 
02/D16B: AA           TAX 
02/D16C: BF 8A D1 02  LDA $02D18A,X   ; weapon animation jump table
02/D170: 85 00        STA $00
02/D172: BF 8B D1 02  LDA $02D18B,X
02/D176: 85 01        STA $01
02/D178: 20 87 D1     JSR $D187
02/D17B: 20 07 E7     JSR $E707
02/D17E: E6 4E        INC $4E
02/D180: A5 4E        LDA $4E
02/D182: C9 02        CMP #$02
02/D184: D0 D8        BNE $D15E
02/D186: 60           RTS 
02/D187: 6C 00 00     JMP ($0000)

; weapon animation jump table
02/D18A: D7A8 CD49 CD5A D7B4 D52A D55D D1A2 D248
02/D19A: D370 D3F7 CD42 CD56

; [ weapon animation $06: shuriken ]

02/D1A2: 9C 33 F2     STZ $F233
02/D1A5: A5 4E        LDA $4E
02/D1A7: D0 05        BNE $D1AE
02/D1A9: 20 8E CE     JSR $CE8E
02/D1AC: 80 03        BRA $D1B1
02/D1AE: 20 98 CE     JSR $CE98
02/D1B1: 20 B8 C5     JSR $C5B8
02/D1B4: 9E CD EF     STZ $EFCD,X
02/D1B7: BD C5 EF     LDA $EFC5,X
02/D1BA: 18           CLC 
02/D1BB: 7D C7 EF     ADC $EFC7,X
02/D1BE: 38           SEC 
02/D1BF: E9 08        SBC #$08
02/D1C1: 8D 11 F1     STA $F111
02/D1C4: BD C6 EF     LDA $EFC6,X
02/D1C7: 18           CLC 
02/D1C8: 7D C8 EF     ADC $EFC8,X
02/D1CB: 8D 12 F1     STA $F112
02/D1CE: A9 08        LDA #$08
02/D1D0: 8D 15 F1     STA $F115
02/D1D3: A5 49        LDA $49
02/D1D5: 0A           ASL 
02/D1D6: A8           TAY 
02/D1D7: B9 43 F0     LDA $F043,Y
02/D1DA: 8D 13 F1     STA $F113
02/D1DD: B9 44 F0     LDA $F044,Y
02/D1E0: 8D 14 F1     STA $F114
02/D1E3: 20 C0 E7     JSR $E7C0
02/D1E6: 20 07 E7     JSR $E707
02/D1E9: 64 52        STZ $52
02/D1EB: 20 13 85     JSR $8513       ; wait one frame
02/D1EE: 7B           TDC 
02/D1EF: 20 EC D6     JSR $D6EC
02/D1F2: A5 52        LDA $52
02/D1F4: 29 01        AND #$01
02/D1F6: 0A           ASL 
02/D1F7: 18           CLC 
02/D1F8: 69 80        ADC #$80
02/D1FA: 8D C6 F0     STA $F0C6
02/D1FD: 20 60 E8     JSR $E860
02/D200: B0 1F        BCS $D221
02/D202: AD 18 F1     LDA $F118
02/D205: 18           CLC 
02/D206: 69 18        ADC #$18
02/D208: 8D C4 F0     STA $F0C4
02/D20B: AD 19 F1     LDA $F119
02/D20E: 18           CLC 
02/D20F: 69 18        ADC #$18
02/D211: 8D C5 F0     STA $F0C5
02/D214: AD C4 34     LDA $34C4
02/D217: 10 03        BPL $D21C
02/D219: EE C1 F0     INC $F0C1
02/D21C: E6 52        INC $52
02/D21E: 4C EB D1     JMP $D1EB
02/D221: AD C4 34     LDA $34C4
02/D224: 10 12        BPL $D238
02/D226: AD C7 34     LDA $34C7
02/D229: 29 08        AND #$08
02/D22B: D0 0B        BNE $D238
02/D22D: A9 A0        LDA #$A0
02/D22F: 8D C6 F0     STA $F0C6
02/D232: EE C1 F0     INC $F0C1
02/D235: 20 02 D7     JSR $D702
02/D238: 60           RTS 
02/D239: AE 11 F1     LDX $F111
02/D23C: DA           PHX 
02/D23D: AE 13 F1     LDX $F113
02/D240: 8E 11 F1     STX $F111
02/D243: FA           PLX 
02/D244: 8E 13 F1     STX $F113
02/D247: 60           RTS 

; [ weapon animation $07:  ]

02/D248: 9C 33 F2     STZ $F233
02/D24B: A5 4E        LDA $4E
02/D24D: D0 05        BNE $D254
02/D24F: 20 8E CE     JSR $CE8E
02/D252: 80 03        BRA $D257
02/D254: 20 98 CE     JSR $CE98
02/D257: AD C4 34     LDA $34C4
02/D25A: 30 01        BMI $D25D
02/D25C: 60           RTS 
02/D25D: 9C 34 F2     STZ $F234
02/D260: 20 B8 C5     JSR $C5B8
02/D263: 9E CD EF     STZ $EFCD,X
02/D266: BD C5 EF     LDA $EFC5,X
02/D269: 18           CLC 
02/D26A: 7D C7 EF     ADC $EFC7,X
02/D26D: 38           SEC 
02/D26E: E9 10        SBC #$10
02/D270: 8D 11 F1     STA $F111
02/D273: BD C6 EF     LDA $EFC6,X
02/D276: 18           CLC 
02/D277: 7D C8 EF     ADC $EFC8,X
02/D27A: 8D 12 F1     STA $F112
02/D27D: A9 08        LDA #$08
02/D27F: 8D 15 F1     STA $F115
02/D282: A5 49        LDA $49
02/D284: 0A           ASL 
02/D285: A8           TAY 
02/D286: B9 43 F0     LDA $F043,Y
02/D289: 38           SEC 
02/D28A: E9 08        SBC #$08
02/D28C: 8D 13 F1     STA $F113
02/D28F: B9 44 F0     LDA $F044,Y
02/D292: 38           SEC 
02/D293: E9 08        SBC #$08
02/D295: 8D 14 F1     STA $F114
02/D298: 20 C0 E7     JSR $E7C0
02/D29B: 20 07 E7     JSR $E707
02/D29E: 64 52        STZ $52
02/D2A0: A9 7C        LDA #$7C
02/D2A2: 20 DF F5     JSR $F5DF
02/D2A5: 20 CE D2     JSR $D2CE
02/D2A8: 20 43 D3     JSR $D343
02/D2AB: AE 11 F1     LDX $F111
02/D2AE: DA           PHX 
02/D2AF: AE 13 F1     LDX $F113
02/D2B2: 8E 11 F1     STX $F111
02/D2B5: FA           PLX 
02/D2B6: 8E 13 F1     STX $F113
02/D2B9: A9 08        LDA #$08
02/D2BB: 8D 15 F1     STA $F115
02/D2BE: 20 C0 E7     JSR $E7C0
02/D2C1: 20 C7 D2     JSR $D2C7
02/D2C4: 4C 07 E7     JMP $E707
02/D2C7: A9 01        LDA #$01
02/D2C9: 8D 26 F4     STA $F426
02/D2CC: 80 03        BRA $D2D1
02/D2CE: 9C 26 F4     STZ $F426
02/D2D1: 22 E1 C3 02  JSL $02C3E1
02/D2D5: 20 13 85     JSR $8513       ; wait one frame
02/D2D8: A9 10        LDA #$10
02/D2DA: 8D C2 F0     STA $F0C2
02/D2DD: A9 21        LDA #$21
02/D2DF: 8D C3 F0     STA $F0C3
02/D2E2: A9 FF        LDA #$FF
02/D2E4: 8D C7 F0     STA $F0C7
02/D2E7: E6 52        INC $52
02/D2E9: A5 52        LDA $52
02/D2EB: 29 06        AND #$06
02/D2ED: 4A           LSR 
02/D2EE: AA           TAX 
02/D2EF: BF 68 FD 16  LDA $16FD68,X
02/D2F3: 8D C6 F0     STA $F0C6
02/D2F6: AD 33 F2     LDA $F233
02/D2F9: D0 06        BNE $D301
02/D2FB: BF 6C FD 16  LDA $16FD6C,X
02/D2FF: 80 04        BRA $D305
02/D301: BF 70 FD 16  LDA $16FD70,X
02/D305: 8D C8 F0     STA $F0C8
02/D308: 20 60 E8     JSR $E860
02/D30B: B0 35        BCS $D342
02/D30D: 22 04 C4 02  JSL $02C404
02/D311: AD 18 F1     LDA $F118
02/D314: 8D 37 F1     STA $F137
02/D317: 18           CLC 
02/D318: 69 18        ADC #$18
02/D31A: 8D C4 F0     STA $F0C4
02/D31D: AD 26 F4     LDA $F426
02/D320: D0 0B        BNE $D32D
02/D322: AD 19 F1     LDA $F119
02/D325: 8D 38 F1     STA $F138
02/D328: 38           SEC 
02/D329: E5 2B        SBC $2B
02/D32B: 80 09        BRA $D336
02/D32D: AD 19 F1     LDA $F119
02/D330: 8D 38 F1     STA $F138
02/D333: 18           CLC 
02/D334: 65 2B        ADC $2B
02/D336: 18           CLC 
02/D337: 69 18        ADC #$18
02/D339: 8D C5 F0     STA $F0C5
02/D33C: EE C1 F0     INC $F0C1
02/D33F: 4C D5 D2     JMP $D2D5
02/D342: 60           RTS 
02/D343: AD C7 34     LDA $34C7
02/D346: 29 08        AND #$08
02/D348: D0 25        BNE $D36F
02/D34A: AE 13 F1     LDX $F113
02/D34D: 8E 44 03     STX $0344
02/D350: A9 A0        LDA #$A0
02/D352: 8D 46 03     STA $0346
02/D355: A9 3F        LDA #$3F
02/D357: 8D 47 03     STA $0347
02/D35A: AD C0 6C     LDA $6CC0
02/D35D: F0 10        BEQ $D36F
02/D35F: A9 7F        LDA #$7F
02/D361: 8D 47 03     STA $0347
02/D364: AD 13 F1     LDA $F113
02/D367: 49 FF        EOR #$FF
02/D369: 38           SEC 
02/D36A: E9 08        SBC #$08
02/D36C: 8D 44 03     STA $0344
02/D36F: 60           RTS 

; [ weapon animation $08: boomerang ]

02/D370: A9 01        LDA #$01
02/D372: 8D 33 F2     STA $F233
02/D375: A5 4E        LDA $4E
02/D377: D0 05        BNE $D37E
02/D379: 20 8E CE     JSR $CE8E
02/D37C: 80 03        BRA $D381
02/D37E: 20 98 CE     JSR $CE98
02/D381: 4C 57 D2     JMP $D257
02/D384: 8D CF F0     STA $F0CF
02/D387: 20 B8 C5     JSR $C5B8
02/D38A: 9E CD EF     STZ $EFCD,X
02/D38D: 9E D3 EF     STZ $EFD3,X
02/D390: A9 05        LDA #$05
02/D392: 85 54        STA $54
02/D394: A9 25        LDA #$25
02/D396: 20 DF F5     JSR $F5DF
02/D399: 20 13 85     JSR $8513       ; wait one frame
02/D39C: 20 B8 C5     JSR $C5B8
02/D39F: A5 52        LDA $52
02/D3A1: 29 01        AND #$01
02/D3A3: D0 03        BNE $D3A8
02/D3A5: FE D3 EF     INC $EFD3,X
02/D3A8: E6 52        INC $52
02/D3AA: 86 00        STX $00
02/D3AC: 20 6C CD     JSR $CD6C
02/D3AF: AD 33 F2     LDA $F233
02/D3B2: F0 0E        BEQ $D3C2
02/D3B4: AD 42 F2     LDA $F242
02/D3B7: D0 04        BNE $D3BD
02/D3B9: A9 3F        LDA #$3F
02/D3BB: 80 02        BRA $D3BF
02/D3BD: A9 7F        LDA #$7F
02/D3BF: 8D CE F0     STA $F0CE
02/D3C2: A6 00        LDX $00
02/D3C4: BD C5 EF     LDA $EFC5,X
02/D3C7: 18           CLC 
02/D3C8: 7D C7 EF     ADC $EFC7,X
02/D3CB: 6D D1 F0     ADC $F0D1
02/D3CE: 8D CC F0     STA $F0CC
02/D3D1: BD C6 EF     LDA $EFC6,X
02/D3D4: 18           CLC 
02/D3D5: 7D C8 EF     ADC $EFC8,X
02/D3D8: 6D D2 F0     ADC $F0D2
02/D3DB: 8D CD F0     STA $F0CD
02/D3DE: A5 48        LDA $48
02/D3E0: AA           TAX 
02/D3E1: BF 15 FD 16  LDA $16FD15,X
02/D3E5: 18           CLC 
02/D3E6: 6D CF F0     ADC $F0CF
02/D3E9: 8D CA F0     STA $F0CA
02/D3EC: EE C9 F0     INC $F0C9
02/D3EF: C6 54        DEC $54
02/D3F1: D0 A6        BNE $D399
02/D3F3: 9C C9 F0     STZ $F0C9
02/D3F6: 60           RTS 

; [ weapon animation $09: harp ]

02/D3F7: A5 4E        LDA $4E
02/D3F9: D0 03        BNE $D3FE
02/D3FB: 4C A1 CE     JMP $CEA1
02/D3FE: 4C B0 CE     JMP $CEB0
02/D401: 8D CF F0     STA $F0CF
02/D404: 20 B8 C5     JSR $C5B8
02/D407: 9E CD EF     STZ $EFCD,X
02/D40A: A9 10        LDA #$10
02/D40C: 85 54        STA $54
02/D40E: BD C5 EF     LDA $EFC5,X
02/D411: 18           CLC 
02/D412: 7D C7 EF     ADC $EFC7,X
02/D415: 8D 11 F1     STA $F111
02/D418: BD C6 EF     LDA $EFC6,X
02/D41B: 18           CLC 
02/D41C: 7D C8 EF     ADC $EFC8,X
02/D41F: 18           CLC 
02/D420: 69 08        ADC #$08
02/D422: 8D 12 F1     STA $F112
02/D425: A9 08        LDA #$08
02/D427: 8D 15 F1     STA $F115
02/D42A: A5 49        LDA $49
02/D42C: 0A           ASL 
02/D42D: A8           TAY 
02/D42E: B9 43 F0     LDA $F043,Y
02/D431: 8D 13 F1     STA $F113
02/D434: 38           SEC 
02/D435: E9 08        SBC #$08
02/D437: B9 44 F0     LDA $F044,Y
02/D43A: 8D 14 F1     STA $F114
02/D43D: 20 C0 E7     JSR $E7C0
02/D440: AD CF F0     LDA $F0CF
02/D443: F0 03        BEQ $D448
02/D445: 20 60 E8     JSR $E860
02/D448: 20 07 E7     JSR $E707
02/D44B: 20 47 E7     JSR $E747
02/D44E: A9 08        LDA #$08
02/D450: 20 5D E7     JSR $E75D
02/D453: A9 3A        LDA #$3A
02/D455: 20 DF F5     JSR $F5DF
02/D458: 20 13 85     JSR $8513       ; wait one frame
02/D45B: E6 52        INC $52
02/D45D: A9 10        LDA #$10
02/D45F: 8D C2 F0     STA $F0C2
02/D462: A9 21        LDA #$21
02/D464: 8D C3 F0     STA $F0C3
02/D467: A9 FE        LDA #$FE
02/D469: 8D C7 F0     STA $F0C7
02/D46C: A5 52        LDA $52
02/D46E: 29 02        AND #$02
02/D470: 18           CLC 
02/D471: 69 A0        ADC #$A0
02/D473: 8D C6 F0     STA $F0C6
02/D476: A9 3F        LDA #$3F
02/D478: 8D C8 F0     STA $F0C8
02/D47B: 20 B8 C5     JSR $C5B8
02/D47E: A9 80        LDA #$80
02/D480: 8D CB F0     STA $F0CB
02/D483: A9 3F        LDA #$3F
02/D485: 8D CE F0     STA $F0CE
02/D488: BD C5 EF     LDA $EFC5,X
02/D48B: 18           CLC 
02/D48C: 7D C7 EF     ADC $EFC7,X
02/D48F: 38           SEC 
02/D490: E9 04        SBC #$04
02/D492: 8D CC F0     STA $F0CC
02/D495: BD C6 EF     LDA $EFC6,X
02/D498: 18           CLC 
02/D499: 7D C8 EF     ADC $EFC8,X
02/D49C: 8D CD F0     STA $F0CD
02/D49F: AD 42 F2     LDA $F242
02/D4A2: F0 0E        BEQ $D4B2
02/D4A4: AD CC F0     LDA $F0CC
02/D4A7: 18           CLC 
02/D4A8: 69 08        ADC #$08
02/D4AA: 8D CC F0     STA $F0CC
02/D4AD: A9 7F        LDA #$7F
02/D4AF: 8D CE F0     STA $F0CE
02/D4B2: A5 48        LDA $48
02/D4B4: AA           TAX 
02/D4B5: BF 15 FD 16  LDA $16FD15,X
02/D4B9: 18           CLC 
02/D4BA: 6D CF F0     ADC $F0CF
02/D4BD: 8D CA F0     STA $F0CA
02/D4C0: C6 54        DEC $54
02/D4C2: 20 60 E8     JSR $E860
02/D4C5: B0 32        BCS $D4F9
02/D4C7: AD 18 F1     LDA $F118
02/D4CA: 18           CLC 
02/D4CB: 69 18        ADC #$18
02/D4CD: 8D C4 F0     STA $F0C4
02/D4D0: 7B           TDC 
02/D4D1: AA           TAX 
02/D4D2: 20 7E E7     JSR $E77E
02/D4D5: 85 00        STA $00
02/D4D7: AD 33 F1     LDA $F133
02/D4DA: 18           CLC 
02/D4DB: 69 10        ADC #$10
02/D4DD: 8D 33 F1     STA $F133
02/D4E0: AD 19 F1     LDA $F119
02/D4E3: 18           CLC 
02/D4E4: 69 10        ADC #$10
02/D4E6: 65 00        ADC $00
02/D4E8: 8D C5 F0     STA $F0C5
02/D4EB: AD C4 34     LDA $34C4
02/D4EE: 10 03        BPL $D4F3
02/D4F0: EE C1 F0     INC $F0C1
02/D4F3: EE C9 F0     INC $F0C9
02/D4F6: 4C 58 D4     JMP $D458
02/D4F9: 64 52        STZ $52
02/D4FB: AD C4 34     LDA $34C4
02/D4FE: 10 1B        BPL $D51B
02/D500: AD C7 34     LDA $34C7
02/D503: 29 08        AND #$08
02/D505: D0 14        BNE $D51B
02/D507: EE C1 F0     INC $F0C1
02/D50A: 20 13 85     JSR $8513       ; wait one frame
02/D50D: EE C1 F0     INC $F0C1
02/D510: E6 52        INC $52
02/D512: A5 52        LDA $52
02/D514: C9 08        CMP #$08
02/D516: D0 E3        BNE $D4FB
02/D518: 20 32 D7     JSR $D732
02/D51B: 9C C9 F0     STZ $F0C9
02/D51E: 4C 07 E7     JMP $E707
02/D521: C2 20        REP #$20
02/D523: 0A           ASL 
02/D524: 0A           ASL 
02/D525: AA           TAX 
02/D526: 7B           TDC 
02/D527: E2 20        SEP #$20
02/D529: 60           RTS 

; [ weapon animation $04: bow ]

02/D52A: A5 4E        LDA $4E
02/D52C: D0 20        BNE $D54E
02/D52E: A5 50        LDA $50
02/D530: 20 21 D5     JSR $D521
02/D533: BF 13 9E 0F  LDA $0F9E13,X
02/D537: C9 04        CMP #$04
02/D539: D0 18        BNE $D553
02/D53B: A5 51        LDA $51
02/D53D: 20 21 D5     JSR $D521
02/D540: BF 13 9E 0F  LDA $0F9E13,X
02/D544: C9 05        CMP #$05
02/D546: D0 0B        BNE $D553
02/D548: 20 D4 CE     JSR $CED4
02/D54B: E6 4E        INC $4E
02/D54D: 60           RTS 
02/D54E: A5 50        LDA $50
02/D550: F0 01        BEQ $D553
02/D552: 60           RTS 
02/D553: 7B           TDC 
02/D554: 85 50        STA $50
02/D556: 85 51        STA $51
02/D558: 85 4E        STA $4E
02/D55A: 4C A8 D7     JMP $D7A8

; [ weapon animation $05: unarmed ]

02/D55D: A5 4E        LDA $4E
02/D55F: D0 20        BNE $D581
02/D561: A5 50        LDA $50
02/D563: 20 21 D5     JSR $D521
02/D566: BF 13 9E 0F  LDA $0F9E13,X
02/D56A: C9 05        CMP #$05
02/D56C: D0 E5        BNE $D553
02/D56E: A5 51        LDA $51
02/D570: 20 21 D5     JSR $D521
02/D573: BF 13 9E 0F  LDA $0F9E13,X
02/D577: C9 04        CMP #$04
02/D579: D0 D8        BNE $D553
02/D57B: 20 C2 CE     JSR $CEC2
02/D57E: E6 4E        INC $4E
02/D580: 60           RTS 
02/D581: A5 50        LDA $50
02/D583: F0 CE        BEQ $D553
02/D585: 60           RTS 
02/D586: AD C7 34     LDA $34C7
02/D589: 29 04        AND #$04
02/D58B: F0 0E        BEQ $D59B
02/D58D: AD 87 EF     LDA $EF87
02/D590: D0 09        BNE $D59B
02/D592: 22 B5 EE 01  JSL $01EEB5
02/D596: A9 03        LDA #$03
02/D598: 8D 87 EF     STA $EF87
02/D59B: 60           RTS 
02/D59C: 8D CF F0     STA $F0CF
02/D59F: 20 B8 C5     JSR $C5B8
02/D5A2: 9E CD EF     STZ $EFCD,X
02/D5A5: A9 10        LDA #$10
02/D5A7: 85 54        STA $54
02/D5A9: BD C5 EF     LDA $EFC5,X
02/D5AC: 18           CLC 
02/D5AD: 7D C7 EF     ADC $EFC7,X
02/D5B0: 8D 11 F1     STA $F111
02/D5B3: BD C6 EF     LDA $EFC6,X
02/D5B6: 18           CLC 
02/D5B7: 7D C8 EF     ADC $EFC8,X
02/D5BA: 18           CLC 
02/D5BB: 69 08        ADC #$08
02/D5BD: 8D 12 F1     STA $F112
02/D5C0: A9 08        LDA #$08
02/D5C2: 8D 15 F1     STA $F115
02/D5C5: A5 49        LDA $49
02/D5C7: 0A           ASL 
02/D5C8: A8           TAY 
02/D5C9: B9 43 F0     LDA $F043,Y
02/D5CC: 8D 13 F1     STA $F113
02/D5CF: 38           SEC 
02/D5D0: E9 08        SBC #$08
02/D5D2: B9 44 F0     LDA $F044,Y
02/D5D5: 8D 14 F1     STA $F114
02/D5D8: 20 C0 E7     JSR $E7C0
02/D5DB: A9 16        LDA #$16
02/D5DD: 20 DF F5     JSR $F5DF
02/D5E0: AD CF F0     LDA $F0CF
02/D5E3: F0 03        BEQ $D5E8
02/D5E5: 20 60 E8     JSR $E860
02/D5E8: 20 07 E7     JSR $E707
02/D5EB: 20 13 85     JSR $8513       ; wait one frame
02/D5EE: E6 52        INC $52
02/D5F0: A9 10        LDA #$10
02/D5F2: 8D C2 F0     STA $F0C2
02/D5F5: A9 21        LDA #$21
02/D5F7: 8D C3 F0     STA $F0C3
02/D5FA: A9 FF        LDA #$FF
02/D5FC: 8D C7 F0     STA $F0C7
02/D5FF: A9 A0        LDA #$A0
02/D601: 8D C6 F0     STA $F0C6
02/D604: A9 3F        LDA #$3F
02/D606: 8D C8 F0     STA $F0C8
02/D609: 20 B8 C5     JSR $C5B8
02/D60C: A5 52        LDA $52
02/D60E: 1A           INC 
02/D60F: 29 FC        AND #$FC
02/D611: D0 04        BNE $D617
02/D613: A9 82        LDA #$82
02/D615: 80 02        BRA $D619
02/D617: A9 80        LDA #$80
02/D619: 8D CB F0     STA $F0CB
02/D61C: A9 3F        LDA #$3F
02/D61E: 8D CE F0     STA $F0CE
02/D621: 20 B8 C5     JSR $C5B8
02/D624: BD C5 EF     LDA $EFC5,X
02/D627: 18           CLC 
02/D628: 7D C7 EF     ADC $EFC7,X
02/D62B: 69 FC        ADC #$FC
02/D62D: 8D CC F0     STA $F0CC
02/D630: BD C6 EF     LDA $EFC6,X
02/D633: 18           CLC 
02/D634: 7D C8 EF     ADC $EFC8,X
02/D637: 69 08        ADC #$08
02/D639: 8D CD F0     STA $F0CD
02/D63C: AD 42 F2     LDA $F242
02/D63F: F0 0E        BEQ $D64F
02/D641: AD CC F0     LDA $F0CC
02/D644: 18           CLC 
02/D645: 69 0C        ADC #$0C
02/D647: 8D CC F0     STA $F0CC
02/D64A: A9 7F        LDA #$7F
02/D64C: 8D CE F0     STA $F0CE
02/D64F: A5 48        LDA $48
02/D651: AA           TAX 
02/D652: BF 15 FD 16  LDA $16FD15,X
02/D656: 18           CLC 
02/D657: 6D CF F0     ADC $F0CF
02/D65A: 8D CA F0     STA $F0CA
02/D65D: C6 54        DEC $54
02/D65F: 20 60 E8     JSR $E860
02/D662: B0 25        BCS $D689
02/D664: AD 18 F1     LDA $F118
02/D667: 18           CLC 
02/D668: 69 18        ADC #$18
02/D66A: 8D C4 F0     STA $F0C4
02/D66D: AD 19 F1     LDA $F119
02/D670: 18           CLC 
02/D671: 69 18        ADC #$18
02/D673: 8D C5 F0     STA $F0C5
02/D676: AD C4 34     LDA $34C4
02/D679: 10 03        BPL $D67E
02/D67B: EE C1 F0     INC $F0C1
02/D67E: AD 80 F4     LDA $F480
02/D681: D0 03        BNE $D686
02/D683: EE C9 F0     INC $F0C9
02/D686: 4C EB D5     JMP $D5EB
02/D689: 9C C9 F0     STZ $F0C9
02/D68C: AD C4 34     LDA $34C4
02/D68F: 10 21        BPL $D6B2
02/D691: AD C7 34     LDA $34C7
02/D694: 29 08        AND #$08
02/D696: D0 1A        BNE $D6B2
02/D698: A9 A2        LDA #$A2
02/D69A: 8D C6 F0     STA $F0C6
02/D69D: EE C1 F0     INC $F0C1
02/D6A0: AD 80 F4     LDA $F480
02/D6A3: C9 02        CMP #$02
02/D6A5: F0 03        BEQ $D6AA
02/D6A7: 4C 02 D7     JMP $D702
02/D6AA: A9 A0        LDA #$A0
02/D6AC: 8D C6 F0     STA $F0C6
02/D6AF: 4C B3 D6     JMP $D6B3
02/D6B2: 60           RTS 
02/D6B3: 64 52        STZ $52
02/D6B5: A2 08 00     LDX #$0008
02/D6B8: 20 A0 C8     JSR $C8A0       ; wait
02/D6BB: A9 18        LDA #$18
02/D6BD: 20 DF F5     JSR $F5DF
02/D6C0: 20 86 D5     JSR $D586
02/D6C3: E6 52        INC $52
02/D6C5: A5 52        LDA $52
02/D6C7: 48           PHA 
02/D6C8: 29 03        AND #$03
02/D6CA: 18           CLC 
02/D6CB: 20 EC D6     JSR $D6EC
02/D6CE: 68           PLA 
02/D6CF: 6A           ROR 
02/D6D0: 6A           ROR 
02/D6D1: 6A           ROR 
02/D6D2: 29 40        AND #$40
02/D6D4: 09 3F        ORA #$3F
02/D6D6: 8D C8 F0     STA $F0C8
02/D6D9: 20 7C D7     JSR $D77C
02/D6DC: EE C1 F0     INC $F0C1
02/D6DF: A5 52        LDA $52
02/D6E1: C9 04        CMP #$04
02/D6E3: D0 D0        BNE $D6B5
02/D6E5: 60           RTS 
02/D6E6: E6 52        INC $52
02/D6E8: A5 52        LDA $52
02/D6EA: 29 07        AND #$07
02/D6EC: 18           CLC 
02/D6ED: 69 10        ADC #$10
02/D6EF: 8D C2 F0     STA $F0C2
02/D6F2: A9 21        LDA #$21
02/D6F4: 8D C3 F0     STA $F0C3
02/D6F7: A9 FF        LDA #$FF
02/D6F9: 8D C7 F0     STA $F0C7
02/D6FC: A9 3F        LDA #$3F
02/D6FE: 8D C8 F0     STA $F0C8
02/D701: 60           RTS 
02/D702: A2 08 00     LDX #$0008
02/D705: 64 52        STZ $52
02/D707: DA           PHX 
02/D708: 20 13 85     JSR $8513       ; wait one frame
02/D70B: FA           PLX 
02/D70C: CA           DEX 
02/D70D: D0 F8        BNE $D707
02/D70F: A9 18        LDA #$18
02/D711: 20 DF F5     JSR $F5DF
02/D714: 20 86 D5     JSR $D586
02/D717: 20 E6 D6     JSR $D6E6
02/D71A: 20 7C D7     JSR $D77C
02/D71D: EE C1 F0     INC $F0C1
02/D720: A2 04 00     LDX #$0004
02/D723: AD C8 34     LDA $34C8
02/D726: C9 10        CMP #$10
02/D728: 90 02        BCC $D72C
02/D72A: A9 10        LDA #$10
02/D72C: 1A           INC 
02/D72D: C5 52        CMP $52
02/D72F: D0 D6        BNE $D707
02/D731: 60           RTS 
02/D732: A9 18        LDA #$18
02/D734: 8D 9F F4     STA $F49F
02/D737: 64 52        STZ $52
02/D739: 20 13 85     JSR $8513       ; wait one frame
02/D73C: 20 13 85     JSR $8513       ; wait one frame
02/D73F: A5 52        LDA $52
02/D741: 29 03        AND #$03
02/D743: F0 09        BEQ $D74E
02/D745: AD 9F F4     LDA $F49F
02/D748: 20 DF F5     JSR $F5DF
02/D74B: 20 86 D5     JSR $D586
02/D74E: 20 E6 D6     JSR $D6E6
02/D751: A9 A0        LDA #$A0
02/D753: 8D C6 F0     STA $F0C6
02/D756: 20 7C D7     JSR $D77C
02/D759: EE C1 F0     INC $F0C1
02/D75C: 20 13 85     JSR $8513       ; wait one frame
02/D75F: 20 13 85     JSR $8513       ; wait one frame
02/D762: A9 A2        LDA #$A2
02/D764: 8D C6 F0     STA $F0C6
02/D767: EE C1 F0     INC $F0C1
02/D76A: 20 13 85     JSR $8513       ; wait one frame
02/D76D: AD C8 34     LDA $34C8
02/D770: C9 10        CMP #$10
02/D772: 90 02        BCC $D776
02/D774: A9 10        LDA #$10
02/D776: 1A           INC 
02/D777: C5 52        CMP $52
02/D779: D0 BE        BNE $D739
02/D77B: 60           RTS 
02/D77C: AD 13 18     LDA $1813
02/D77F: A8           TAY 
02/D780: B9 00 19     LDA $1900,Y     ; rng table
02/D783: 29 1F        AND #$1F
02/D785: 18           CLC 
02/D786: 69 08        ADC #$08
02/D788: 85 00        STA $00
02/D78A: B9 04 19     LDA $1904,Y
02/D78D: 29 1F        AND #$1F
02/D78F: 85 02        STA $02
02/D791: A5 49        LDA $49
02/D793: 0A           ASL 
02/D794: A8           TAY 
02/D795: B9 43 F0     LDA $F043,Y
02/D798: 18           CLC 
02/D799: 65 00        ADC $00
02/D79B: 8D C4 F0     STA $F0C4
02/D79E: B9 44 F0     LDA $F044,Y
02/D7A1: 18           CLC 
02/D7A2: 65 02        ADC $02
02/D7A4: 8D C5 F0     STA $F0C5
02/D7A7: 60           RTS 

; [ weapon animation $00:  ]

02/D7A8: A5 50        LDA $50
02/D7AA: 05 51        ORA $51
02/D7AC: F0 01        BEQ $D7AF
02/D7AE: 60           RTS 
02/D7AF: 20 B4 D7     JSR $D7B4
02/D7B2: E6 4E        INC $4E

; [ weapon animation $03: claw ]

02/D7B4: A5 4E        LDA $4E
02/D7B6: 29 01        AND #$01
02/D7B8: 85 00        STA $00
02/D7BA: A5 48        LDA $48
02/D7BC: AA           TAX 
02/D7BD: A9 05        LDA #$05
02/D7BF: 18           CLC 
02/D7C0: 65 00        ADC $00
02/D7C2: 9D 99 F0     STA $F099,X
02/D7C5: A5 4E        LDA $4E
02/D7C7: AA           TAX 
02/D7C8: B5 50        LDA $50,X
02/D7CA: 20 BD D8     JSR $D8BD
02/D7CD: 64 52        STZ $52
02/D7CF: 20 B8 C5     JSR $C5B8
02/D7D2: 9E CD EF     STZ $EFCD,X
02/D7D5: A9 02        LDA #$02
02/D7D7: 9D D3 EF     STA $EFD3,X
02/D7DA: AD C8 34     LDA $34C8
02/D7DD: 4A           LSR 
02/D7DE: 4A           LSR 
02/D7DF: 4A           LSR 
02/D7E0: 18           CLC 
02/D7E1: 69 08        ADC #$08
02/D7E3: 85 54        STA $54
02/D7E5: 9C C9 F0     STZ $F0C9
02/D7E8: 9C C1 F0     STZ $F0C1
02/D7EB: 20 07 E7     JSR $E707
02/D7EE: 20 13 85     JSR $8513       ; wait one frame
02/D7F1: A5 52        LDA $52
02/D7F3: 29 03        AND #$03
02/D7F5: D0 08        BNE $D7FF
02/D7F7: A9 08        LDA #$08
02/D7F9: 20 DF F5     JSR $F5DF
02/D7FC: 20 86 D5     JSR $D586
02/D7FF: A5 48        LDA $48
02/D801: AA           TAX 
02/D802: BF 15 FD 16  LDA $16FD15,X
02/D806: 8D CA F0     STA $F0CA
02/D809: A9 80        LDA #$80
02/D80B: 8D CB F0     STA $F0CB
02/D80E: A9 3F        LDA #$3F
02/D810: 8D CE F0     STA $F0CE
02/D813: AD 13 18     LDA $1813
02/D816: AA           TAX 
02/D817: BD 00 19     LDA $1900,X     ; rng table
02/D81A: 29 01        AND #$01
02/D81C: 85 00        STA $00
02/D81E: BD 01 19     LDA $1901,X
02/D821: 29 01        AND #$01
02/D823: 85 01        STA $01
02/D825: 20 B8 C5     JSR $C5B8
02/D828: BD C5 EF     LDA $EFC5,X
02/D82B: 38           SEC 
02/D82C: E9 0A        SBC #$0A
02/D82E: 18           CLC 
02/D82F: 7D C7 EF     ADC $EFC7,X
02/D832: 65 00        ADC $00
02/D834: 8D CC F0     STA $F0CC
02/D837: BD C6 EF     LDA $EFC6,X
02/D83A: 18           CLC 
02/D83B: 7D C8 EF     ADC $EFC8,X
02/D83E: 65 00        ADC $00
02/D840: 8D CD F0     STA $F0CD
02/D843: AD 42 F2     LDA $F242
02/D846: F0 11        BEQ $D859
02/D848: AD CC F0     LDA $F0CC
02/D84B: 18           CLC 
02/D84C: 69 12        ADC #$12
02/D84E: 8D CC F0     STA $F0CC
02/D851: AD CE F0     LDA $F0CE
02/D854: 49 40        EOR #$40
02/D856: 8D CE F0     STA $F0CE
02/D859: A5 48        LDA $48
02/D85B: 0A           ASL 
02/D85C: 0A           ASL 
02/D85D: AA           TAX 
02/D85E: BD 15 F0     LDA $F015,X
02/D861: 29 30        AND #$30
02/D863: D0 03        BNE $D868
02/D865: EE C9 F0     INC $F0C9
02/D868: A5 52        LDA $52
02/D86A: 29 01        AND #$01
02/D86C: 0A           ASL 
02/D86D: 18           CLC 
02/D86E: 69 A0        ADC #$A0
02/D870: 8D C6 F0     STA $F0C6
02/D873: A5 52        LDA $52
02/D875: 29 01        AND #$01
02/D877: D0 0B        BNE $D884
02/D879: A5 52        LDA $52
02/D87B: 29 06        AND #$06
02/D87D: 4A           LSR 
02/D87E: 20 EC D6     JSR $D6EC
02/D881: 20 7C D7     JSR $D77C
02/D884: AD C4 34     LDA $34C4
02/D887: 10 0A        BPL $D893
02/D889: AD C7 34     LDA $34C7
02/D88C: 29 08        AND #$08
02/D88E: D0 03        BNE $D893
02/D890: EE C1 F0     INC $F0C1
02/D893: C6 54        DEC $54
02/D895: F0 05        BEQ $D89C
02/D897: E6 52        INC $52
02/D899: 4C EE D7     JMP $D7EE
02/D89C: 9C C9 F0     STZ $F0C9
02/D89F: 60           RTS 

; [ load weapon palette ]

02/D8A0: DA           PHX 
02/D8A1: C2 20        REP #$20
02/D8A3: 0A           ASL 
02/D8A4: 0A           ASL 
02/D8A5: 0A           ASL 
02/D8A6: 0A           ASL 
02/D8A7: AA           TAX 
02/D8A8: 7B           TDC 
02/D8A9: E2 20        SEP #$20
02/D8AB: 7B           TDC 
02/D8AC: A8           TAY 
02/D8AD: BF 00 CB 0E  LDA $0ECB00,X
02/D8B1: 99 30 EF     STA $EF30,Y
02/D8B4: C8           INY 
02/D8B5: E8           INX 
02/D8B6: C0 10 00     CPY #$0010
02/D8B9: D0 F2        BNE $D8AD
02/D8BB: FA           PLX 
02/D8BC: 60           RTS 

; [  ]

02/D8BD: C2 20        REP #$20
02/D8BF: 0A           ASL 
02/D8C0: 0A           ASL 
02/D8C1: AA           TAX 
02/D8C2: 7B           TDC 
02/D8C3: E2 20        SEP #$20
02/D8C5: BF 11 9E 0F  LDA $0F9E11,X
02/D8C9: 20 70 D9     JSR $D970       ; load weapon graphics
02/D8CC: BF 12 9E 0F  LDA $0F9E12,X
02/D8D0: 85 53        STA $53
02/D8D2: 20 E3 D8     JSR $D8E3
02/D8D5: BF 10 9E 0F  LDA $0F9E10,X
02/D8D9: 20 A0 D8     JSR $D8A0
02/D8DC: BF 13 9E 0F  LDA $0F9E13,X
02/D8E0: 85 4F        STA $4F
02/D8E2: 60           RTS 

; [  ]

02/D8E3: DA           PHX 
02/D8E4: 48           PHA 
02/D8E5: AA           TAX 
02/D8E6: BF 57 FB 16  LDA $16FB57,X
02/D8EA: 85 26        STA $26
02/D8EC: A9 18        LDA #$18
02/D8EE: 85 28        STA $28
02/D8F0: 20 60 85     JSR $8560       ; multiply (8-bit)
02/D8F3: 68           PLA 
02/D8F4: C9 08        CMP #$08
02/D8F6: 90 26        BCC $D91E
02/D8F8: A2 00 1A     LDX #$1A00
02/D8FB: 8E B7 F0     STX $F0B7
02/D8FE: A9 1C        LDA #$1C
02/D900: 8D B9 F0     STA $F0B9
02/D903: A9 08        LDA #$08
02/D905: 8D BA F0     STA $F0BA
02/D908: 8D BB F0     STA $F0BB
02/D90B: C2 20        REP #$20
02/D90D: A5 2A        LDA $2A
02/D90F: 18           CLC 
02/D910: 69 00 D9     ADC #$D900
02/D913: 8D B5 F0     STA $F0B5
02/D916: 7B           TDC 
02/D917: E2 20        SEP #$20
02/D919: 20 A5 D9     JSR $D9A5
02/D91C: FA           PLX 
02/D91D: 60           RTS 
02/D91E: 48           PHA 
02/D91F: C9 04        CMP #$04
02/D921: D0 04        BNE $D927
02/D923: A9 77        LDA #$77
02/D925: 80 1A        BRA $D941
02/D927: C9 05        CMP #$05
02/D929: D0 04        BNE $D92F
02/D92B: A9 79        LDA #$79
02/D92D: 80 12        BRA $D941
02/D92F: C9 06        CMP #$06
02/D931: D0 04        BNE $D937
02/D933: A9 78        LDA #$78
02/D935: 80 0A        BRA $D941
02/D937: C9 07        CMP #$07
02/D939: D0 04        BNE $D93F
02/D93B: A9 0E        LDA #$0E
02/D93D: 80 02        BRA $D941
02/D93F: A9 07        LDA #$07
02/D941: 8D A0 F4     STA $F4A0
02/D944: 68           PLA 
02/D945: C2 20        REP #$20
02/D947: A5 2A        LDA $2A
02/D949: 18           CLC 
02/D94A: 69 00 D9     ADC #$D900
02/D94D: A8           TAY 
02/D94E: 7B           TDC 
02/D94F: E2 20        SEP #$20
02/D951: A2 10 00     LDX #$0010
02/D954: 86 00        STX $00
02/D956: A2 E6 DB     LDX #$DBE6
02/D959: A9 1C        LDA #$1C
02/D95B: 20 3D DA     JSR $DA3D       ; load 3bpp graphics
02/D95E: A2 00 02     LDX #$0200
02/D961: 86 00        STX $00
02/D963: A9 7E        LDA #$7E
02/D965: A2 E6 DB     LDX #$DBE6
02/D968: A0 00 1A     LDY #$1A00
02/D96B: 20 B2 84     JSR $84B2
02/D96E: FA           PLX 
02/D96F: 60           RTS 

; [ load weapon graphics ]

02/D970: DA           PHX 
02/D971: AA           TAX 
02/D972: BF 6D FB 16  LDA $16FB6D,X
02/D976: 85 26        STA $26
02/D978: A9 18        LDA #$18
02/D97A: 85 28        STA $28
02/D97C: 20 60 85     JSR $8560       ; multiply (8-bit)
02/D97F: A2 00 18     LDX #$1800
02/D982: 8E B7 F0     STX $F0B7
02/D985: A9 1C        LDA #$1C
02/D987: 8D B9 F0     STA $F0B9
02/D98A: A9 08        LDA #$08
02/D98C: 8D BA F0     STA $F0BA
02/D98F: 8D BB F0     STA $F0BB
02/D992: C2 20        REP #$20
02/D994: A5 2A        LDA $2A
02/D996: 18           CLC 
02/D997: 69 00 D9     ADC #$D900
02/D99A: 8D B5 F0     STA $F0B5
02/D99D: 7B           TDC 
02/D99E: E2 20        SEP #$20
02/D9A0: 20 A5 D9     JSR $D9A5
02/D9A3: FA           PLX 
02/D9A4: 60           RTS 

; [  ]

02/D9A5: AD A8 EF     LDA $EFA8
02/D9A8: F0 05        BEQ $D9AF
02/D9AA: 20 13 85     JSR $8513       ; wait one frame
02/D9AD: 80 F6        BRA $D9A5
02/D9AF: AD BB F0     LDA $F0BB
02/D9B2: AA           TAX 
02/D9B3: 86 00        STX $00
02/D9B5: A2 E6 DB     LDX #$DBE6
02/D9B8: AC B5 F0     LDY $F0B5
02/D9BB: AD B9 F0     LDA $F0B9
02/D9BE: 20 3D DA     JSR $DA3D       ; load 3bpp graphics
02/D9C1: 4E BB F0     LSR $F0BB
02/D9C4: 4E BB F0     LSR $F0BB
02/D9C7: A2 E6 DB     LDX #$DBE6
02/D9CA: 8E B5 F0     STX $F0B5
02/D9CD: A2 40 00     LDX #$0040
02/D9D0: 8E AD EF     STX $EFAD
02/D9D3: 8E B6 EF     STX $EFB6
02/D9D6: A9 7E        LDA #$7E
02/D9D8: 8D AF EF     STA $EFAF
02/D9DB: 8D B8 EF     STA $EFB8
02/D9DE: 20 13 85     JSR $8513       ; wait one frame
02/D9E1: C2 20        REP #$20
02/D9E3: AD B5 F0     LDA $F0B5
02/D9E6: 8D A9 EF     STA $EFA9
02/D9E9: 18           CLC 
02/D9EA: 69 40 00     ADC #$0040
02/D9ED: 8D B2 EF     STA $EFB2
02/D9F0: AD B7 F0     LDA $F0B7
02/D9F3: 8D AB EF     STA $EFAB
02/D9F6: 18           CLC 
02/D9F7: 69 00 01     ADC #$0100
02/D9FA: 8D B4 EF     STA $EFB4
02/D9FD: AD B5 F0     LDA $F0B5
02/DA00: 18           CLC 
02/DA01: 69 80 00     ADC #$0080
02/DA04: 8D B5 F0     STA $F0B5
02/DA07: AD B7 F0     LDA $F0B7
02/DA0A: 18           CLC 
02/DA0B: 69 20 00     ADC #$0020
02/DA0E: 8D B7 F0     STA $F0B7
02/DA11: 7B           TDC 
02/DA12: E2 20        SEP #$20
02/DA14: CE BA F0     DEC $F0BA
02/DA17: D0 14        BNE $DA2D
02/DA19: A9 08        LDA #$08
02/DA1B: 8D BA F0     STA $F0BA
02/DA1E: C2 20        REP #$20
02/DA20: AD B7 F0     LDA $F0B7
02/DA23: 18           CLC 
02/DA24: 69 00 01     ADC #$0100
02/DA27: 8D B7 F0     STA $F0B7
02/DA2A: 7B           TDC 
02/DA2B: E2 20        SEP #$20
02/DA2D: A9 01        LDA #$01
02/DA2F: 8D A8 EF     STA $EFA8
02/DA32: 8D B1 EF     STA $EFB1
02/DA35: CE BB F0     DEC $F0BB
02/DA38: D0 A4        BNE $D9DE
02/DA3A: 4C 13 85     JMP $8513       ; wait one frame

; [ load 3bpp graphics ]

;    A: source bank
;   +Y: source address
;   +X: destination address
; +$00: tile count

02/DA3D: 84 02        STY $02
02/DA3F: 85 04        STA $04
02/DA41: 7B           TDC 
02/DA42: A8           TAY 
02/DA43: C2 20        REP #$20
02/DA45: A9 08 00     LDA #$0008
02/DA48: 85 06        STA $06
02/DA4A: B7 02        LDA [$02],Y
02/DA4C: 9D 00 00     STA $0000,X
02/DA4F: C8           INY 
02/DA50: C8           INY 
02/DA51: E8           INX 
02/DA52: E8           INX 
02/DA53: C6 06        DEC $06
02/DA55: D0 F3        BNE $DA4A
02/DA57: A9 08 00     LDA #$0008
02/DA5A: 85 06        STA $06
02/DA5C: B7 02        LDA [$02],Y
02/DA5E: 29 FF 00     AND #$00FF
02/DA61: 9D 00 00     STA $0000,X
02/DA64: C8           INY 
02/DA65: E8           INX 
02/DA66: E8           INX 
02/DA67: C6 06        DEC $06
02/DA69: D0 F1        BNE $DA5C
02/DA6B: C6 00        DEC $00
02/DA6D: D0 D6        BNE $DA45
02/DA6F: 7B           TDC 
02/DA70: E2 20        SEP #$20
02/DA72: 60           RTS 

; --------------------------------------------------------------------------

; [  ]

02/DA73: DA           PHX 
02/DA74: 5A           PHY 
02/DA75: A5 47        LDA $47
02/DA77: AA           TAX 
02/DA78: BD A3 F0     LDA $F0A3,X
02/DA7B: AA           TAX 
02/DA7C: 86 1C        STX $1C
02/DA7E: A5 47        LDA $47
02/DA80: 18           CLC 
02/DA81: 69 09        ADC #$09
02/DA83: C2 20        REP #$20
02/DA85: 0A           ASL 
02/DA86: 0A           ASL 
02/DA87: 0A           ASL 
02/DA88: 0A           ASL 
02/DA89: 0A           ASL 
02/DA8A: A8           TAY 
02/DA8B: A5 1C        LDA $1C
02/DA8D: 0A           ASL 
02/DA8E: 0A           ASL 
02/DA8F: 0A           ASL 
02/DA90: 0A           ASL 
02/DA91: 0A           ASL 
02/DA92: AA           TAX 
02/DA93: 7B           TDC 
02/DA94: E2 20        SEP #$20
02/DA96: 5A           PHY 
02/DA97: AD AD F0     LDA $F0AD
02/DA9A: D0 16        BNE $DAB2
02/DA9C: AD 83 F2     LDA $F283
02/DA9F: D0 11        BNE $DAB2
02/DAA1: A9 20        LDA #$20
02/DAA3: 85 1C        STA $1C
02/DAA5: BF 00 FD 1C  LDA $1CFD00,X
02/DAA9: 99 50 ED     STA $ED50,Y
02/DAAC: E8           INX 
02/DAAD: C8           INY 
02/DAAE: C6 1C        DEC $1C
02/DAB0: D0 F3        BNE $DAA5
02/DAB2: 7A           PLY 
02/DAB3: A5 D7        LDA $D7
02/DAB5: F0 22        BEQ $DAD9
02/DAB7: A5 47        LDA $47
02/DAB9: CD 22 18     CMP $1822
02/DABC: D0 1B        BNE $DAD9
02/DABE: AD 13 18     LDA $1813
02/DAC1: 29 04        AND #$04
02/DAC3: F0 0C        BEQ $DAD1
02/DAC5: A9 EF        LDA #$EF
02/DAC7: 99 52 ED     STA $ED52,Y
02/DACA: A9 3D        LDA #$3D
02/DACC: 99 53 ED     STA $ED53,Y
02/DACF: 80 08        BRA $DAD9
02/DAD1: A9 00        LDA #$00
02/DAD3: 99 52 ED     STA $ED52,Y
02/DAD6: 99 53 ED     STA $ED53,Y
02/DAD9: 7A           PLY 
02/DADA: FA           PLX 
02/DADB: 60           RTS 

; [  ]

02/DADC: DA           PHX 
02/DADD: A5 47        LDA $47
02/DADF: 18           CLC 
02/DAE0: 69 09        ADC #$09
02/DAE2: C2 20        REP #$20
02/DAE4: 0A           ASL 
02/DAE5: 0A           ASL 
02/DAE6: 0A           ASL 
02/DAE7: 0A           ASL 
02/DAE8: 0A           ASL 
02/DAE9: AA           TAX 
02/DAEA: A9 F6 7D     LDA #$7DF6
02/DAED: 9D 56 ED     STA $ED56,X
02/DAF0: A9 30 7D     LDA #$7D30
02/DAF3: 9D 58 ED     STA $ED58,X
02/DAF6: 7B           TDC 
02/DAF7: 9D 60 ED     STA $ED60,X
02/DAFA: E2 20        SEP #$20
02/DAFC: FA           PLX 
02/DAFD: 60           RTS 

; [  ]

02/DAFE: DA           PHX 
02/DAFF: A5 47        LDA $47
02/DB01: 0A           ASL 
02/DB02: 0A           ASL 
02/DB03: AA           TAX 
02/DB04: BD 15 F0     LDA $F015,X
02/DB07: 29 C0        AND #$C0
02/DB09: D0 08        BNE $DB13
02/DB0B: A5 47        LDA $47
02/DB0D: AA           TAX 
02/DB0E: BD BC F2     LDA $F2BC,X
02/DB11: F0 02        BEQ $DB15
02/DB13: FA           PLX 
02/DB14: 60           RTS 
02/DB15: FA           PLX 
02/DB16: BD C5 EF     LDA $EFC5,X
02/DB19: C9 D0        CMP #$D0
02/DB1B: F0 07        BEQ $DB24
02/DB1D: C9 E0        CMP #$E0
02/DB1F: F0 03        BEQ $DB24
02/DB21: 4C 60 DB     JMP $DB60
02/DB24: AD 14 F0     LDA $F014
02/DB27: D0 0B        BNE $DB34
02/DB29: DA           PHX 
02/DB2A: A5 47        LDA $47
02/DB2C: AA           TAX 
02/DB2D: BF 1F FD 16  LDA $16FD1F,X
02/DB31: FA           PLX 
02/DB32: 80 09        BRA $DB3D
02/DB34: DA           PHX 
02/DB35: A5 47        LDA $47
02/DB37: AA           TAX 
02/DB38: BF 24 FD 16  LDA $16FD24,X
02/DB3C: FA           PLX 
02/DB3D: DD C5 EF     CMP $EFC5,X
02/DB40: F0 1E        BEQ $DB60
02/DB42: 48           PHA 
02/DB43: BD CE EF     LDA $EFCE,X
02/DB46: 29 0F        AND #$0F
02/DB48: 9D CE EF     STA $EFCE,X
02/DB4B: 68           PLA 
02/DB4C: C9 D0        CMP #$D0
02/DB4E: D0 04        BNE $DB54
02/DB50: A9 08        LDA #$08
02/DB52: 80 5E        BRA $DBB2
02/DB54: BD CE EF     LDA $EFCE,X
02/DB57: 09 20        ORA #$20
02/DB59: 9D CE EF     STA $EFCE,X
02/DB5C: A9 08        LDA #$08
02/DB5E: 80 52        BRA $DBB2
02/DB60: DA           PHX 
02/DB61: A5 47        LDA $47
02/DB63: AA           TAX 
02/DB64: BD AF F0     LDA $F0AF,X
02/DB67: F0 03        BEQ $DB6C
02/DB69: FA           PLX 
02/DB6A: 80 03        BRA $DB6F
02/DB6C: FA           PLX 
02/DB6D: 80 6A        BRA $DBD9
02/DB6F: BD C5 EF     LDA $EFC5,X
02/DB72: C9 C0        CMP #$C0
02/DB74: F0 63        BEQ $DBD9
02/DB76: 48           PHA 
02/DB77: BD CE EF     LDA $EFCE,X
02/DB7A: 29 0F        AND #$0F
02/DB7C: 9D CE EF     STA $EFCE,X
02/DB7F: 68           PLA 
02/DB80: 9E D1 EF     STZ $EFD1,X
02/DB83: 9E D3 EF     STZ $EFD3,X
02/DB86: C9 B0        CMP #$B0
02/DB88: D0 0C        BNE $DB96
02/DB8A: BD CE EF     LDA $EFCE,X
02/DB8D: 09 20        ORA #$20
02/DB8F: 9D CE EF     STA $EFCE,X
02/DB92: A9 10        LDA #$10
02/DB94: 80 19        BRA $DBAF
02/DB96: AD 14 F0     LDA $F014
02/DB99: D0 0B        BNE $DBA6
02/DB9B: DA           PHX 
02/DB9C: A5 47        LDA $47
02/DB9E: AA           TAX 
02/DB9F: BF EE FC 16  LDA $16FCEE,X
02/DBA3: FA           PLX 
02/DBA4: 80 09        BRA $DBAF
02/DBA6: DA           PHX 
02/DBA7: A5 47        LDA $47
02/DBA9: AA           TAX 
02/DBAA: BF F3 FC 16  LDA $16FCF3,X
02/DBAE: FA           PLX 
02/DBAF: 38           SEC 
02/DBB0: E9 08        SBC #$08
02/DBB2: 9D CF EF     STA $EFCF,X
02/DBB5: B9 15 F0     LDA $F015,Y
02/DBB8: 29 30        AND #$30
02/DBBA: F0 15        BEQ $DBD1
02/DBBC: 29 20        AND #$20
02/DBBE: F0 08        BEQ $DBC8
02/DBC0: BD CE EF     LDA $EFCE,X
02/DBC3: 09 10        ORA #$10
02/DBC5: 9D CE EF     STA $EFCE,X
02/DBC8: BD CF EF     LDA $EFCF,X
02/DBCB: 0A           ASL 
02/DBCC: 9D CF EF     STA $EFCF,X
02/DBCF: 80 08        BRA $DBD9
02/DBD1: BD CE EF     LDA $EFCE,X
02/DBD4: 09 40        ORA #$40
02/DBD6: 9D CE EF     STA $EFCE,X
02/DBD9: 60           RTS 

; [  ]

02/DBDA: DA           PHX 
02/DBDB: A5 47        LDA $47
02/DBDD: AA           TAX 
02/DBDE: BD BC F2     LDA $F2BC,X
02/DBE1: D0 05        BNE $DBE8
02/DBE3: BD AF F0     LDA $F0AF,X
02/DBE6: F0 02        BEQ $DBEA
02/DBE8: FA           PLX 
02/DBE9: 60           RTS 
02/DBEA: FA           PLX 
02/DBEB: BD CE EF     LDA $EFCE,X
02/DBEE: 29 0F        AND #$0F
02/DBF0: 9D CE EF     STA $EFCE,X
02/DBF3: BD C5 EF     LDA $EFC5,X
02/DBF6: C9 B0        CMP #$B0
02/DBF8: F0 4F        BEQ $DC49
02/DBFA: 9E D1 EF     STZ $EFD1,X
02/DBFD: 9E D3 EF     STZ $EFD3,X
02/DC00: C9 C0        CMP #$C0
02/DC02: D0 04        BNE $DC08
02/DC04: A9 08        LDA #$08
02/DC06: 80 19        BRA $DC21
02/DC08: AD 14 F0     LDA $F014
02/DC0B: D0 0B        BNE $DC18
02/DC0D: DA           PHX 
02/DC0E: A5 47        LDA $47
02/DC10: AA           TAX 
02/DC11: BF EE FC 16  LDA $16FCEE,X
02/DC15: FA           PLX 
02/DC16: 80 09        BRA $DC21
02/DC18: DA           PHX 
02/DC19: A5 47        LDA $47
02/DC1B: AA           TAX 
02/DC1C: BF F3 FC 16  LDA $16FCF3,X
02/DC20: FA           PLX 
02/DC21: 9D CF EF     STA $EFCF,X
02/DC24: B9 15 F0     LDA $F015,Y
02/DC27: 29 30        AND #$30
02/DC29: F0 15        BEQ $DC40
02/DC2B: 29 20        AND #$20
02/DC2D: F0 08        BEQ $DC37
02/DC2F: BD CE EF     LDA $EFCE,X
02/DC32: 09 10        ORA #$10
02/DC34: 9D CE EF     STA $EFCE,X
02/DC37: BD CF EF     LDA $EFCF,X
02/DC3A: 0A           ASL 
02/DC3B: 9D CF EF     STA $EFCF,X
02/DC3E: 80 08        BRA $DC48
02/DC40: BD CE EF     LDA $EFCE,X
02/DC43: 09 40        ORA #$40
02/DC45: 9D CE EF     STA $EFCE,X
02/DC48: 60           RTS 
02/DC49: BD CE EF     LDA $EFCE,X
02/DC4C: 09 01        ORA #$01
02/DC4E: 9D CE EF     STA $EFCE,X
02/DC51: 60           RTS 
02/DC52: DA           PHX 
02/DC53: A5 47        LDA $47
02/DC55: AA           TAX 
02/DC56: BD BC F2     LDA $F2BC,X
02/DC59: D0 05        BNE $DC60
02/DC5B: BD AF F0     LDA $F0AF,X
02/DC5E: F0 02        BEQ $DC62
02/DC60: FA           PLX 
02/DC61: 60           RTS 
02/DC62: FA           PLX 
02/DC63: AD 14 F0     LDA $F014
02/DC66: D0 11        BNE $DC79
02/DC68: DA           PHX 
02/DC69: A5 47        LDA $47
02/DC6B: AA           TAX 
02/DC6C: BF EE FC 16  LDA $16FCEE,X
02/DC70: 85 0E        STA $0E
02/DC72: BF 1F FD 16  LDA $16FD1F,X
02/DC76: FA           PLX 
02/DC77: 80 0F        BRA $DC88
02/DC79: DA           PHX 
02/DC7A: A5 47        LDA $47
02/DC7C: AA           TAX 
02/DC7D: BF F3 FC 16  LDA $16FCF3,X
02/DC81: 85 0E        STA $0E
02/DC83: BF 24 FD 16  LDA $16FD24,X
02/DC87: FA           PLX 
02/DC88: 48           PHA 
02/DC89: BD C5 EF     LDA $EFC5,X
02/DC8C: C9 C0        CMP #$C0
02/DC8E: D0 0E        BNE $DC9E
02/DC90: A5 0E        LDA $0E
02/DC92: C9 18        CMP #$18
02/DC94: D0 06        BNE $DC9C
02/DC96: A9 10        LDA #$10
02/DC98: 85 0E        STA $0E
02/DC9A: 80 02        BRA $DC9E
02/DC9C: 46 0E        LSR $0E
02/DC9E: 68           PLA 
02/DC9F: DD C5 EF     CMP $EFC5,X
02/DCA2: F0 40        BEQ $DCE4
02/DCA4: 9E D1 EF     STZ $EFD1,X
02/DCA7: 9E D3 EF     STZ $EFD3,X
02/DCAA: BD CE EF     LDA $EFCE,X
02/DCAD: 29 0F        AND #$0F
02/DCAF: 9D CE EF     STA $EFCE,X
02/DCB2: A5 0E        LDA $0E
02/DCB4: 9D CF EF     STA $EFCF,X
02/DCB7: B9 15 F0     LDA $F015,Y
02/DCBA: 29 30        AND #$30
02/DCBC: F0 15        BEQ $DCD3
02/DCBE: 29 20        AND #$20
02/DCC0: F0 08        BEQ $DCCA
02/DCC2: BD CE EF     LDA $EFCE,X
02/DCC5: 09 10        ORA #$10
02/DCC7: 9D CE EF     STA $EFCE,X
02/DCCA: BD CF EF     LDA $EFCF,X
02/DCCD: 0A           ASL 
02/DCCE: 9D CF EF     STA $EFCF,X
02/DCD1: 80 08        BRA $DCDB
02/DCD3: BD CE EF     LDA $EFCE,X
02/DCD6: 09 40        ORA #$40
02/DCD8: 9D CE EF     STA $EFCE,X
02/DCDB: BD CE EF     LDA $EFCE,X
02/DCDE: 09 20        ORA #$20
02/DCE0: 9D CE EF     STA $EFCE,X
02/DCE3: 60           RTS 
02/DCE4: BD CE EF     LDA $EFCE,X
02/DCE7: 29 FE        AND #$FE
02/DCE9: 9D CE EF     STA $EFCE,X
02/DCEC: 60           RTS 

; [  ]

02/DCED: DA           PHX 
02/DCEE: 5A           PHY 
02/DCEF: 8A           TXA 
02/DCF0: 0A           ASL 
02/DCF1: 0A           ASL 
02/DCF2: A8           TAY 
02/DCF3: BF 15 FD 16  LDA $16FD15,X
02/DCF7: C2 20        REP #$20
02/DCF9: 0A           ASL 
02/DCFA: 0A           ASL 
02/DCFB: 85 0E        STA $0E
02/DCFD: 7B           TDC 
02/DCFE: E2 20        SEP #$20
02/DD00: AD 78 F0     LDA $F078
02/DD03: 9D 8F F0     STA $F08F,X
02/DD06: 0A           ASL 
02/DD07: 0A           ASL 
02/DD08: 0A           ASL 
02/DD09: 0A           ASL 
02/DD0A: 85 10        STA $10
02/DD0C: B9 7B F0     LDA $F07B,Y
02/DD0F: D0 03        BNE $DD14
02/DD11: 4C 96 DD     JMP $DD96
02/DD14: B9 7C F0     LDA $F07C,Y
02/DD17: 1A           INC 
02/DD18: 99 7C F0     STA $F07C,Y
02/DD1B: 29 07        AND #$07
02/DD1D: D0 07        BNE $DD26
02/DD1F: B9 7D F0     LDA $F07D,Y
02/DD22: 1A           INC 
02/DD23: 99 7D F0     STA $F07D,Y
02/DD26: 8A           TXA 
02/DD27: 0A           ASL 
02/DD28: AA           TAX 
02/DD29: BD F3 6C     LDA $6CF3,X
02/DD2C: 85 12        STA $12
02/DD2E: BD F4 6C     LDA $6CF4,X
02/DD31: 85 13        STA $13
02/DD33: B9 7D F0     LDA $F07D,Y
02/DD36: 29 01        AND #$01
02/DD38: 0A           ASL 
02/DD39: 0A           ASL 
02/DD3A: 0A           ASL 
02/DD3B: 18           CLC 
02/DD3C: 65 10        ADC $10
02/DD3E: AA           TAX 
02/DD3F: A4 0E        LDY $0E
02/DD41: 64 0E        STZ $0E
02/DD43: BF E1 FA 13  LDA $13FAE1,X
02/DD47: 18           CLC 
02/DD48: 65 12        ADC $12
02/DD4A: 20 0B BB     JSR $BB0B
02/DD4D: 99 00 03     STA $0300,Y
02/DD50: E8           INX 
02/DD51: C8           INY 
02/DD52: BF E1 FA 13  LDA $13FAE1,X
02/DD56: 18           CLC 
02/DD57: 65 13        ADC $13
02/DD59: 99 00 03     STA $0300,Y
02/DD5C: E8           INX 
02/DD5D: C8           INY 
02/DD5E: AD 78 F0     LDA $F078
02/DD61: C9 09        CMP #$09
02/DD63: D0 0A        BNE $DD6F
02/DD65: DA           PHX 
02/DD66: A5 0E        LDA $0E
02/DD68: AA           TAX 
02/DD69: BD 79 F0     LDA $F079,X
02/DD6C: FA           PLX 
02/DD6D: 80 04        BRA $DD73
02/DD6F: BF E1 FA 13  LDA $13FAE1,X
02/DD73: 99 00 03     STA $0300,Y
02/DD76: E8           INX 
02/DD77: C8           INY 
02/DD78: AD C0 6C     LDA $6CC0
02/DD7B: F0 08        BEQ $DD85
02/DD7D: BF E1 FA 13  LDA $13FAE1,X
02/DD81: 49 40        EOR #$40
02/DD83: 80 04        BRA $DD89
02/DD85: BF E1 FA 13  LDA $13FAE1,X
02/DD89: 99 00 03     STA $0300,Y
02/DD8C: E8           INX 
02/DD8D: C8           INY 
02/DD8E: E6 0E        INC $0E
02/DD90: A5 0E        LDA $0E
02/DD92: C9 02        CMP #$02
02/DD94: D0 AD        BNE $DD43
02/DD96: 7A           PLY 
02/DD97: FA           PLX 
02/DD98: 60           RTS 

; [  ]

02/DD99: 9C C2 EF     STZ $EFC2
02/DD9C: AD C3 EF     LDA $EFC3
02/DD9F: 09 01        ORA #$01
02/DDA1: 8D C3 EF     STA $EFC3
02/DDA4: 60           RTS 

; [  ]

02/DDA5: DA           PHX 
02/DDA6: A5 47        LDA $47
02/DDA8: AA           TAX 
02/DDA9: BD AF F0     LDA $F0AF,X
02/DDAC: D0 26        BNE $DDD4
02/DDAE: BD 6D F4     LDA $F46D,X
02/DDB1: D0 23        BNE $DDD6
02/DDB3: A5 47        LDA $47
02/DDB5: 0A           ASL 
02/DDB6: 0A           ASL 
02/DDB7: AA           TAX 
02/DDB8: BD 15 F0     LDA $F015,X
02/DDBB: 29 F7        AND #$F7
02/DDBD: 85 0E        STA $0E
02/DDBF: BD 16 F0     LDA $F016,X
02/DDC2: 29 B8        AND #$B8
02/DDC4: 05 0E        ORA $0E
02/DDC6: 85 0E        STA $0E
02/DDC8: BD 18 F0     LDA $F018,X
02/DDCB: 29 01        AND #$01
02/DDCD: 05 0E        ORA $0E
02/DDCF: D0 08        BNE $DDD9
02/DDD1: FA           PLX 
02/DDD2: 38           SEC 
02/DDD3: 60           RTS 
02/DDD4: E6 64        INC $64
02/DDD6: FA           PLX 
02/DDD7: 38           SEC 
02/DDD8: 60           RTS 
02/DDD9: FA           PLX 
02/DDDA: 18           CLC 
02/DDDB: 60           RTS 

; [  ]

02/DDDC: DA           PHX 
02/DDDD: 5A           PHY 
02/DDDE: 64 64        STZ $64
02/DDE0: A5 47        LDA $47
02/DDE2: 0A           ASL 
02/DDE3: 0A           ASL 
02/DDE4: A8           TAY 
02/DDE5: BD CF EF     LDA $EFCF,X
02/DDE8: D0 03        BNE $DDED
02/DDEA: 4C 87 DE     JMP $DE87
02/DDED: E6 64        INC $64
02/DDEF: BD CE EF     LDA $EFCE,X
02/DDF2: 85 0E        STA $0E
02/DDF4: 29 20        AND #$20
02/DDF6: F0 19        BEQ $DE11
02/DDF8: BD CE EF     LDA $EFCE,X
02/DDFB: 09 01        ORA #$01
02/DDFD: 9D CE EF     STA $EFCE,X
02/DE00: A5 0E        LDA $0E
02/DE02: 29 40        AND #$40
02/DE04: D0 07        BNE $DE0D
02/DE06: 20 99 DD     JSR $DD99
02/DE09: A9 01        LDA #$01
02/DE0B: 80 1B        BRA $DE28
02/DE0D: A9 02        LDA #$02
02/DE0F: 80 17        BRA $DE28
02/DE11: BD CE EF     LDA $EFCE,X
02/DE14: 29 FE        AND #$FE
02/DE16: 9D CE EF     STA $EFCE,X
02/DE19: A5 0E        LDA $0E
02/DE1B: 29 40        AND #$40
02/DE1D: D0 07        BNE $DE26
02/DE1F: 20 99 DD     JSR $DD99
02/DE22: A9 FF        LDA #$FF
02/DE24: 80 02        BRA $DE28
02/DE26: A9 FE        LDA #$FE
02/DE28: 85 0F        STA $0F
02/DE2A: BD C5 EF     LDA $EFC5,X
02/DE2D: 18           CLC 
02/DE2E: 65 0F        ADC $0F
02/DE30: 9D C5 EF     STA $EFC5,X
02/DE33: A5 0E        LDA $0E
02/DE35: 29 10        AND #$10
02/DE37: F0 14        BEQ $DE4D
02/DE39: BD D1 EF     LDA $EFD1,X
02/DE3C: 29 07        AND #$07
02/DE3E: DA           PHX 
02/DE3F: AA           TAX 
02/DE40: BF E5 FF 0D  LDA $0DFFE5,X
02/DE44: FA           PLX 
02/DE45: 9D C8 EF     STA $EFC8,X
02/DE48: A9 03        LDA #$03
02/DE4A: 9D D2 EF     STA $EFD2,X
02/DE4D: A9 03        LDA #$03
02/DE4F: 9D D0 EF     STA $EFD0,X
02/DE52: DE CF EF     DEC $EFCF,X
02/DE55: DA           PHX 
02/DE56: A5 47        LDA $47
02/DE58: AA           TAX 
02/DE59: BD 8F F0     LDA $F08F,X
02/DE5C: 8D 78 F0     STA $F078
02/DE5F: BD 94 F0     LDA $F094,X
02/DE62: 8D 77 F0     STA $F077
02/DE65: BD 99 F0     LDA $F099,X
02/DE68: C9 0E        CMP #$0E
02/DE6A: F0 04        BEQ $DE70
02/DE6C: C9 07        CMP #$07
02/DE6E: D0 13        BNE $DE83
02/DE70: 20 A5 DD     JSR $DDA5
02/DE73: 90 0E        BCC $DE83
02/DE75: A5 47        LDA $47
02/DE77: AA           TAX 
02/DE78: BD 99 F0     LDA $F099,X
02/DE7B: F0 06        BEQ $DE83
02/DE7D: FA           PLX 
02/DE7E: 9D D0 EF     STA $EFD0,X
02/DE81: 80 01        BRA $DE84
02/DE83: FA           PLX 
02/DE84: 7A           PLY 
02/DE85: FA           PLX 
02/DE86: 60           RTS 
02/DE87: 20 73 DA     JSR $DA73
02/DE8A: 9C 78 F0     STZ $F078
02/DE8D: 9E CC EF     STZ $EFCC,X
02/DE90: AD 96 F3     LDA $F396
02/DE93: D0 03        BNE $DE98
02/DE95: 9E C8 EF     STZ $EFC8,X
02/DE98: A9 01        LDA #$01
02/DE9A: 9D D0 EF     STA $EFD0,X
02/DE9D: B9 15 F0     LDA $F015,Y
02/DEA0: 85 0E        STA $0E
02/DEA2: B9 16 F0     LDA $F016,Y
02/DEA5: 85 0F        STA $0F
02/DEA7: B9 17 F0     LDA $F017,Y
02/DEAA: 85 10        STA $10
02/DEAC: B9 18 F0     LDA $F018,Y
02/DEAF: 85 11        STA $11
02/DEB1: A5 0E        LDA $0E
02/DEB3: 29 80        AND #$80
02/DEB5: F0 0A        BEQ $DEC1
02/DEB7: E6 64        INC $64
02/DEB9: A9 09        LDA #$09
02/DEBB: 9D D0 EF     STA $EFD0,X
02/DEBE: 4C DE DF     JMP $DFDE
02/DEC1: A5 0E        LDA $0E
02/DEC3: 29 40        AND #$40
02/DEC5: F0 0E        BEQ $DED5
02/DEC7: E6 64        INC $64
02/DEC9: A9 03        LDA #$03
02/DECB: 9D CC EF     STA $EFCC,X
02/DECE: 1A           INC 
02/DECF: 9D D0 EF     STA $EFD0,X
02/DED2: 4C DE DF     JMP $DFDE
02/DED5: A5 0F        LDA $0F
02/DED7: 29 03        AND #$03
02/DED9: 9D CC EF     STA $EFCC,X
02/DEDC: A5 0E        LDA $0E
02/DEDE: 29 01        AND #$01
02/DEE0: F0 08        BEQ $DEEA
02/DEE2: 20 DC DA     JSR $DADC
02/DEE5: A9 04        LDA #$04
02/DEE7: 9D D0 EF     STA $EFD0,X
02/DEEA: A5 10        LDA $10
02/DEEC: 29 01        AND #$01
02/DEEE: F0 12        BEQ $DF02
02/DEF0: 5A           PHY 
02/DEF1: A5 47        LDA $47
02/DEF3: A8           TAY 
02/DEF4: B9 AF F0     LDA $F0AF,Y
02/DEF7: D0 08        BNE $DF01
02/DEF9: 7A           PLY 
02/DEFA: 22 AE EA 01  JSL $01EAAE
02/DEFE: 4C D0 DF     JMP $DFD0
02/DF01: 7A           PLY 
02/DF02: A5 10        LDA $10
02/DF04: 29 80        AND #$80
02/DF06: F0 0B        BEQ $DF13
02/DF08: A9 04        LDA #$04
02/DF0A: 9D D0 EF     STA $EFD0,X
02/DF0D: 8D 78 F0     STA $F078
02/DF10: 4C D0 DF     JMP $DFD0
02/DF13: A5 0E        LDA $0E
02/DF15: 29 04        AND #$04
02/DF17: F0 0D        BEQ $DF26
02/DF19: A9 04        LDA #$04
02/DF1B: 9D D0 EF     STA $EFD0,X
02/DF1E: A9 01        LDA #$01
02/DF20: 8D 78 F0     STA $F078
02/DF23: 4C D0 DF     JMP $DFD0
02/DF26: A5 0E        LDA $0E
02/DF28: 29 02        AND #$02
02/DF2A: F0 0D        BEQ $DF39
02/DF2C: A9 04        LDA #$04
02/DF2E: 9D D0 EF     STA $EFD0,X
02/DF31: A9 02        LDA #$02
02/DF33: 8D 78 F0     STA $F078
02/DF36: 4C D0 DF     JMP $DFD0
02/DF39: A5 0F        LDA $0F
02/DF3B: 29 80        AND #$80
02/DF3D: F0 0C        BEQ $DF4B
02/DF3F: A9 04        LDA #$04
02/DF41: 9D D0 EF     STA $EFD0,X
02/DF44: 0A           ASL 
02/DF45: 8D 78 F0     STA $F078
02/DF48: 4C D0 DF     JMP $DFD0
02/DF4B: 5A           PHY 
02/DF4C: A5 47        LDA $47
02/DF4E: A8           TAY 
02/DF4F: B9 AF F0     LDA $F0AF,Y
02/DF52: F0 04        BEQ $DF58
02/DF54: 7A           PLY 
02/DF55: 4C 59 DF     JMP $DF59
02/DF58: 7A           PLY 
02/DF59: A5 0F        LDA $0F
02/DF5B: 29 20        AND #$20
02/DF5D: F0 0D        BEQ $DF6C
02/DF5F: E6 64        INC $64
02/DF61: A9 04        LDA #$04
02/DF63: 9D D0 EF     STA $EFD0,X
02/DF66: 8D 78 F0     STA $F078
02/DF69: 4C D0 DF     JMP $DFD0
02/DF6C: A5 0F        LDA $0F
02/DF6E: 29 10        AND #$10
02/DF70: F0 0E        BEQ $DF80
02/DF72: E6 64        INC $64
02/DF74: A9 04        LDA #$04
02/DF76: 9D D0 EF     STA $EFD0,X
02/DF79: 1A           INC 
02/DF7A: 8D 78 F0     STA $F078
02/DF7D: 4C D0 DF     JMP $DFD0
02/DF80: A5 0F        LDA $0F
02/DF82: 29 08        AND #$08
02/DF84: F0 0A        BEQ $DF90
02/DF86: E6 64        INC $64
02/DF88: A9 07        LDA #$07
02/DF8A: 8D 78 F0     STA $F078
02/DF8D: 4C D0 DF     JMP $DFD0
02/DF90: A5 0F        LDA $0F
02/DF92: 29 40        AND #$40
02/DF94: F0 2B        BEQ $DFC1
02/DF96: AD 2D 35     LDA $352D
02/DF99: D0 26        BNE $DFC1
02/DF9B: A5 64        LDA $64
02/DF9D: D0 22        BNE $DFC1
02/DF9F: DA           PHX 
02/DFA0: A9 04        LDA #$04
02/DFA2: 85 1E        STA $1E
02/DFA4: A5 47        LDA $47
02/DFA6: 0A           ASL 
02/DFA7: 0A           ASL 
02/DFA8: 18           CLC 
02/DFA9: 6D 13 18     ADC $1813
02/DFAC: 0A           ASL 
02/DFAD: 0A           ASL 
02/DFAE: 0A           ASL 
02/DFAF: 20 18 E0     JSR $E018
02/DFB2: FA           PLX 
02/DFB3: 18           CLC 
02/DFB4: 69 F8        ADC #$F8
02/DFB6: 9D C8 EF     STA $EFC8,X
02/DFB9: A9 06        LDA #$06
02/DFBB: 8D 78 F0     STA $F078
02/DFBE: 4C D0 DF     JMP $DFD0
02/DFC1: A5 11        LDA $11
02/DFC3: 29 01        AND #$01
02/DFC5: F0 09        BEQ $DFD0
02/DFC7: A9 04        LDA #$04
02/DFC9: 9D D0 EF     STA $EFD0,X
02/DFCC: 3A           DEC 
02/DFCD: 8D 78 F0     STA $F078
02/DFD0: A5 0F        LDA $0F
02/DFD2: 29 08        AND #$08
02/DFD4: F0 05        BEQ $DFDB
02/DFD6: 20 DA DB     JSR $DBDA
02/DFD9: 80 03        BRA $DFDE
02/DFDB: 20 52 DC     JSR $DC52
02/DFDE: 20 3A E0     JSR $E03A
02/DFE1: 20 FE DA     JSR $DAFE
02/DFE4: 20 A5 DD     JSR $DDA5
02/DFE7: 90 10        BCC $DFF9
02/DFE9: DA           PHX 
02/DFEA: A5 47        LDA $47
02/DFEC: AA           TAX 
02/DFED: BD 99 F0     LDA $F099,X
02/DFF0: F0 06        BEQ $DFF8
02/DFF2: FA           PLX 
02/DFF3: 9D D0 EF     STA $EFD0,X
02/DFF6: 80 01        BRA $DFF9
02/DFF8: FA           PLX 
02/DFF9: AD 2D 35     LDA $352D
02/DFFC: F0 13        BEQ $E011
02/DFFE: A5 64        LDA $64
02/E000: D0 0F        BNE $E011
02/E002: A5 47        LDA $47
02/E004: A8           TAY 
02/E005: B9 C5 29     LDA $29C5,Y
02/E008: C9 FF        CMP #$FF
02/E00A: F0 05        BEQ $E011
02/E00C: A9 03        LDA #$03
02/E00E: 9D D0 EF     STA $EFD0,X
02/E011: 7A           PLY 
02/E012: FA           PLX 
02/E013: 60           RTS 

; [  ]

02/E014: 20 18 E0     JSR $E018
02/E017: 6B           RTL 

; [  ]

02/E018: AA           TAX 
02/E019: BF 00 FF 1C  LDA $1CFF00,X   ; sine table
02/E01D: 10 10        BPL $E02F
02/E01F: 49 FF        EOR #$FF
02/E021: 85 1C        STA $1C
02/E023: 20 D2 85     JSR $85D2       ; hardware multiply
02/E026: A5 21        LDA $21
02/E028: 49 FF        EOR #$FF
02/E02A: 1A           INC 
02/E02B: 10 0B        BPL $E038
02/E02D: 38           SEC 
02/E02E: 60           RTS 
02/E02F: 85 1C        STA $1C
02/E031: 20 D2 85     JSR $85D2       ; hardware multiply
02/E034: A5 21        LDA $21
02/E036: 30 F5        BMI $E02D
02/E038: 18           CLC 
02/E039: 60           RTS 
02/E03A: B9 15 F0     LDA $F015,Y
02/E03D: 29 30        AND #$30
02/E03F: F0 12        BEQ $E053
02/E041: 29 20        AND #$20
02/E043: F0 04        BEQ $E049
02/E045: A9 20        LDA #$20
02/E047: 80 02        BRA $E04B
02/E049: A9 10        LDA #$10
02/E04B: 8D 77 F0     STA $F077
02/E04E: 20 99 DD     JSR $DD99
02/E051: 80 2B        BRA $E07E
02/E053: B9 15 F0     LDA $F015,Y
02/E056: 29 08        AND #$08
02/E058: F0 04        BEQ $E05E
02/E05A: A9 40        LDA #$40
02/E05C: 80 17        BRA $E075
02/E05E: 5A           PHY 
02/E05F: 98           TYA 
02/E060: 4A           LSR 
02/E061: 4A           LSR 
02/E062: A8           TAY 
02/E063: B9 35 F2     LDA $F235,Y
02/E066: C9 0F        CMP #$0F
02/E068: 90 10        BCC $E07A
02/E06A: 7A           PLY 
02/E06B: C9 0F        CMP #$0F
02/E06D: D0 04        BNE $E073
02/E06F: A9 30        LDA #$30
02/E071: 80 02        BRA $E075
02/E073: A9 30        LDA #$30
02/E075: 8D 77 F0     STA $F077
02/E078: 80 04        BRA $E07E
02/E07A: 7A           PLY 
02/E07B: 9C 77 F0     STZ $F077
02/E07E: DA           PHX 
02/E07F: A5 47        LDA $47
02/E081: AA           TAX 
02/E082: AD 77 F0     LDA $F077
02/E085: 9D 94 F0     STA $F094,X
02/E088: FA           PLX 
02/E089: 60           RTS 

; [  ]

02/E08A: A2 00 00     LDX #$0000
02/E08D: 86 0A        STX $0A
02/E08F: DA           PHX 
02/E090: BD C5 29     LDA $29C5,X
02/E093: C9 FF        CMP #$FF
02/E095: F0 45        BEQ $E0DC
02/E097: DA           PHX 
02/E098: 20 07 E1     JSR $E107
02/E09B: BD 03 20     LDA $2003,X
02/E09E: 29 08        AND #$08
02/E0A0: F0 04        BEQ $E0A6
02/E0A2: A9 0E        LDA #$0E
02/E0A4: 80 05        BRA $E0AB
02/E0A6: BD 01 20     LDA $2001,X
02/E0A9: 29 1F        AND #$1F
02/E0AB: FA           PLX 
02/E0AC: 9D 35 F2     STA $F235,X
02/E0AF: C9 0F        CMP #$0F
02/E0B1: 90 06        BCC $E0B9
02/E0B3: 20 F1 E0     JSR $E0F1
02/E0B6: 4C C4 E0     JMP $E0C4
02/E0B9: AA           TAX 
02/E0BA: 86 26        STX $26
02/E0BC: A2 00 08     LDX #$0800
02/E0BF: 86 28        STX $28
02/E0C1: 20 7C 85     JSR $857C       ; multiply (16-bit)
02/E0C4: C2 20        REP #$20
02/E0C6: A5 2A        LDA $2A
02/E0C8: 18           CLC 
02/E0C9: 69 00 80     ADC #$8000
02/E0CC: AA           TAX 
02/E0CD: A9 00 08     LDA #$0800
02/E0D0: 85 00        STA $00
02/E0D2: A4 0A        LDY $0A
02/E0D4: 7B           TDC 
02/E0D5: E2 20        SEP #$20
02/E0D7: A9 1A        LDA #$1A
02/E0D9: 20 75 86     JSR $8675       ; transfer data to vram
02/E0DC: C2 20        REP #$20
02/E0DE: A5 0A        LDA $0A
02/E0E0: 18           CLC 
02/E0E1: 69 00 04     ADC #$0400
02/E0E4: 85 0A        STA $0A
02/E0E6: 7B           TDC 
02/E0E7: E2 20        SEP #$20
02/E0E9: FA           PLX 
02/E0EA: E8           INX 
02/E0EB: E0 05 00     CPX #$0005
02/E0EE: D0 9F        BNE $E08F
02/E0F0: 60           RTS 
02/E0F1: 38           SEC 
02/E0F2: E9 0F        SBC #$0F
02/E0F4: 0A           ASL 
02/E0F5: AA           TAX 
02/E0F6: BF 86 FC 16  LDA $16FC86,X
02/E0FA: 85 2A        STA $2A
02/E0FC: BF 87 FC 16  LDA $16FC87,X
02/E100: 85 2B        STA $2B
02/E102: 60           RTS 

; [ get pointer to character/monster properties (far) ]

02/E103: 20 07 E1     JSR $E107
02/E106: 6B           RTL 

; [ get pointer to character/monster properties ]

02/E107: C2 20        REP #$20
02/E109: 8A           TXA 
02/E10A: 0A           ASL 
02/E10B: 0A           ASL 
02/E10C: 0A           ASL 
02/E10D: 0A           ASL 
02/E10E: 0A           ASL 
02/E10F: 0A           ASL 
02/E110: 0A           ASL 
02/E111: AA           TAX 
02/E112: 7B           TDC 
02/E113: E2 20        SEP #$20
02/E115: 60           RTS 

; [  ]

02/E116: AD A8 16     LDA $16A8
02/E119: 8D 14 F0     STA $F014
02/E11C: AD C0 6C     LDA $6CC0
02/E11F: F0 08        BEQ $E129
02/E121: AD 14 F0     LDA $F014
02/E124: 49 01        EOR #$01
02/E126: 8D 14 F0     STA $F014
02/E129: A2 00 00     LDX #$0000
02/E12C: DA           PHX 
02/E12D: 86 00        STX $00
02/E12F: 8A           TXA 
02/E130: 85 47        STA $47
02/E132: 0A           ASL 
02/E133: 0A           ASL 
02/E134: 0A           ASL 
02/E135: 0A           ASL 
02/E136: A8           TAY 
02/E137: BF 10 FD 16  LDA $16FD10,X
02/E13B: 99 C9 EF     STA $EFC9,Y
02/E13E: DA           PHX 
02/E13F: BD C5 29     LDA $29C5,X
02/E142: C9 FF        CMP #$FF
02/E144: D0 03        BNE $E149
02/E146: 7B           TDC 
02/E147: 80 2F        BRA $E178
02/E149: 20 07 E1     JSR $E107
02/E14C: AD 01 18     LDA $1801
02/E14F: F0 22        BEQ $E173
02/E151: AD 00 18     LDA $1800
02/E154: C9 B6        CMP #$B6
02/E156: D0 1B        BNE $E173
02/E158: BD 01 20     LDA $2001,X
02/E15B: 29 0F        AND #$0F
02/E15D: C9 0B        CMP #$0B
02/E15F: D0 12        BNE $E173
02/E161: BD 05 20     LDA $2005,X
02/E164: 09 82        ORA #$82
02/E166: 9D 05 20     STA $2005,X
02/E169: A6 00        LDX $00
02/E16B: A9 01        LDA #$01
02/E16D: 9D C1 F2     STA $F2C1,X
02/E170: 7B           TDC 
02/E171: 80 05        BRA $E178
02/E173: BD 00 20     LDA $2000,X
02/E176: 29 3F        AND #$3F
02/E178: FA           PLX 
02/E179: 99 C4 EF     STA $EFC4,Y
02/E17C: 7B           TDC 
02/E17D: 99 C7 EF     STA $EFC7,Y
02/E180: 99 C8 EF     STA $EFC8,Y
02/E183: 99 CC EF     STA $EFCC,Y
02/E186: 99 CE EF     STA $EFCE,Y
02/E189: 99 CF EF     STA $EFCF,Y
02/E18C: 99 D1 EF     STA $EFD1,Y
02/E18F: B9 00 19     LDA $1900,Y     ; rng table
02/E192: 99 D3 EF     STA $EFD3,Y
02/E195: A9 01        LDA #$01
02/E197: 99 D0 EF     STA $EFD0,Y
02/E19A: A9 01        LDA #$01
02/E19C: 99 CD EF     STA $EFCD,Y
02/E19F: AD 14 F0     LDA $F014
02/E1A2: D0 06        BNE $E1AA
02/E1A4: BF 1F FD 16  LDA $16FD1F,X
02/E1A8: 80 04        BRA $E1AE
02/E1AA: BF 24 FD 16  LDA $16FD24,X
02/E1AE: 48           PHA 
02/E1AF: 5A           PHY 
02/E1B0: A5 47        LDA $47
02/E1B2: 0A           ASL 
02/E1B3: 0A           ASL 
02/E1B4: A8           TAY 
02/E1B5: B9 15 F0     LDA $F015,Y
02/E1B8: 29 C0        AND #$C0
02/E1BA: F0 04        BEQ $E1C0
02/E1BC: 7A           PLY 
02/E1BD: 68           PLA 
02/E1BE: 80 04        BRA $E1C4
02/E1C0: 7A           PLY 
02/E1C1: 68           PLA 
02/E1C2: A9 F0        LDA #$F0
02/E1C4: 99 C5 EF     STA $EFC5,Y
02/E1C7: BF 1A FD 16  LDA $16FD1A,X
02/E1CB: 99 C6 EF     STA $EFC6,Y
02/E1CE: 20 ED E1     JSR $E1ED
02/E1D1: 8A           TXA 
02/E1D2: 0A           ASL 
02/E1D3: AA           TAX 
02/E1D4: BF 06 FD 16  LDA $16FD06,X
02/E1D8: 99 CA EF     STA $EFCA,Y
02/E1DB: BF 07 FD 16  LDA $16FD07,X
02/E1DF: 99 CB EF     STA $EFCB,Y
02/E1E2: FA           PLX 
02/E1E3: E8           INX 
02/E1E4: E0 05 00     CPX #$0005
02/E1E7: F0 03        BEQ $E1EC
02/E1E9: 4C 2C E1     JMP $E12C
02/E1EC: 60           RTS 

; [  ]

02/E1ED: DA           PHX 
02/E1EE: 5A           PHY 
02/E1EF: 84 00        STY $00
02/E1F1: A6 00        LDX $00
02/E1F3: A5 47        LDA $47
02/E1F5: A8           TAY 
02/E1F6: 7B           TDC 
02/E1F7: 99 8F F0     STA $F08F,Y
02/E1FA: A5 47        LDA $47
02/E1FC: 0A           ASL 
02/E1FD: 0A           ASL 
02/E1FE: A8           TAY 
02/E1FF: B9 15 F0     LDA $F015,Y
02/E202: 29 C0        AND #$C0
02/E204: D0 40        BNE $E246
02/E206: AD 14 F0     LDA $F014
02/E209: D0 0B        BNE $E216
02/E20B: DA           PHX 
02/E20C: A5 47        LDA $47
02/E20E: AA           TAX 
02/E20F: BF F8 FC 16  LDA $16FCF8,X
02/E213: FA           PLX 
02/E214: 80 09        BRA $E21F
02/E216: DA           PHX 
02/E217: A5 47        LDA $47
02/E219: AA           TAX 
02/E21A: BF FD FC 16  LDA $16FCFD,X
02/E21E: FA           PLX 
02/E21F: 9D CF EF     STA $EFCF,X
02/E222: B9 15 F0     LDA $F015,Y
02/E225: 29 30        AND #$30
02/E227: F0 15        BEQ $E23E
02/E229: 29 20        AND #$20
02/E22B: F0 08        BEQ $E235
02/E22D: BD CE EF     LDA $EFCE,X
02/E230: 09 10        ORA #$10
02/E232: 9D CE EF     STA $EFCE,X
02/E235: BD CF EF     LDA $EFCF,X
02/E238: 0A           ASL 
02/E239: 9D CF EF     STA $EFCF,X
02/E23C: 80 08        BRA $E246
02/E23E: BD CE EF     LDA $EFCE,X
02/E241: 09 40        ORA #$40
02/E243: 9D CE EF     STA $EFCE,X
02/E246: 20 3A E0     JSR $E03A
02/E249: 7A           PLY 
02/E24A: FA           PLX 
02/E24B: 60           RTS 

; [ draw character sprites ]

02/E24C: A9 F0        LDA #$F0
02/E24E: A2 60 01     LDX #$0160
02/E251: 9D 00 03     STA $0300,X
02/E254: E8           INX 
02/E255: E0 00 02     CPX #$0200
02/E258: D0 F7        BNE $E251
02/E25A: A2 16 00     LDX #$0016
02/E25D: 7B           TDC 
02/E25E: 9D 00 05     STA $0500,X
02/E261: E8           INX 
02/E262: E0 20 00     CPX #$0020
02/E265: D0 F7        BNE $E25E
02/E267: AD 20 F3     LDA $F320
02/E26A: F0 01        BEQ $E26D
02/E26C: 60           RTS 
02/E26D: A2 00 00     LDX #$0000
02/E270: DA           PHX 
02/E271: 8A           TXA 
02/E272: 9C A8 F4     STZ $F4A8
02/E275: 85 47        STA $47
02/E277: 0A           ASL 
02/E278: A8           TAY 
02/E279: 0A           ASL 
02/E27A: 0A           ASL 
02/E27B: 0A           ASL 
02/E27C: AA           TAX 
02/E27D: BD CA EF     LDA $EFCA,X
02/E280: 8D C2 EF     STA $EFC2
02/E283: BD CB EF     LDA $EFCB,X
02/E286: 8D C3 EF     STA $EFC3
02/E289: A9 07        LDA #$07
02/E28B: 9D D2 EF     STA $EFD2,X
02/E28E: 20 DC DD     JSR $DDDC
02/E291: BD CF EF     LDA $EFCF,X
02/E294: F0 03        BEQ $E299
02/E296: EE A8 F4     INC $F4A8
02/E299: BD C4 EF     LDA $EFC4,X
02/E29C: D0 03        BNE $E2A1
02/E29E: 9C 78 F0     STZ $F078
02/E2A1: AD 3B F4     LDA $F43B
02/E2A4: F0 03        BEQ $E2A9
02/E2A6: 9D D2 EF     STA $EFD2,X
02/E2A9: BD C8 EF     LDA $EFC8,X
02/E2AC: 85 10        STA $10
02/E2AE: BD C5 EF     LDA $EFC5,X
02/E2B1: 18           CLC 
02/E2B2: 7D C7 EF     ADC $EFC7,X
02/E2B5: 8D BB EF     STA $EFBB
02/E2B8: 38           SEC 
02/E2B9: E9 10        SBC #$10
02/E2BB: 99 F3 6C     STA $6CF3,Y
02/E2BE: 5A           PHY 
02/E2BF: 98           TYA 
02/E2C0: 0A           ASL 
02/E2C1: A8           TAY 
02/E2C2: B9 15 F0     LDA $F015,Y
02/E2C5: 29 C7        AND #$C7
02/E2C7: D0 1D        BNE $E2E6
02/E2C9: B9 16 F0     LDA $F016,Y
02/E2CC: 30 18        BMI $E2E6
02/E2CE: 29 40        AND #$40
02/E2D0: F0 14        BEQ $E2E6
02/E2D2: 5A           PHY 
02/E2D3: A5 47        LDA $47
02/E2D5: A8           TAY 
02/E2D6: B9 AF F0     LDA $F0AF,Y
02/E2D9: F0 06        BEQ $E2E1
02/E2DB: 7A           PLY 
02/E2DC: 64 10        STZ $10
02/E2DE: 4C E6 E2     JMP $E2E6
02/E2E1: 7A           PLY 
02/E2E2: A9 F8        LDA #$F8
02/E2E4: 85 10        STA $10
02/E2E6: B9 18 F0     LDA $F018,Y
02/E2E9: 29 0C        AND #$0C
02/E2EB: F0 19        BEQ $E306
02/E2ED: 4A           LSR 
02/E2EE: 4A           LSR 
02/E2EF: 09 01        ORA #$01
02/E2F1: 85 0E        STA $0E
02/E2F3: DA           PHX 
02/E2F4: BD D1 EF     LDA $EFD1,X
02/E2F7: 25 0E        AND $0E
02/E2F9: AA           TAX 
02/E2FA: BF 02 FD 16  LDA $16FD02,X
02/E2FE: 18           CLC 
02/E2FF: 6D BB EF     ADC $EFBB
02/E302: 8D BB EF     STA $EFBB
02/E305: FA           PLX 
02/E306: 7A           PLY 
02/E307: BD C6 EF     LDA $EFC6,X
02/E30A: 18           CLC 
02/E30B: 7D C8 EF     ADC $EFC8,X
02/E30E: 8D BC EF     STA $EFBC
02/E311: BD C6 EF     LDA $EFC6,X
02/E314: 18           CLC 
02/E315: 65 10        ADC $10
02/E317: 69 08        ADC #$08
02/E319: 99 F4 6C     STA $6CF4,Y
02/E31C: BD C9 EF     LDA $EFC9,X
02/E31F: 8D C0 EF     STA $EFC0
02/E322: DA           PHX 
02/E323: BD CC EF     LDA $EFCC,X
02/E326: 0A           ASL 
02/E327: 0A           ASL 
02/E328: AA           TAX 
02/E329: 98           TYA 
02/E32A: 18           CLC 
02/E32B: 69 02        ADC #$02
02/E32D: 85 0E        STA $0E
02/E32F: 3F 29 FD 16  AND $16FD29,X
02/E333: 8D BD EF     STA $EFBD
02/E336: A5 0E        LDA $0E
02/E338: 3F 2A FD 16  AND $16FD2A,X
02/E33C: 8D BE EF     STA $EFBE
02/E33F: A5 0E        LDA $0E
02/E341: 3F 2B FD 16  AND $16FD2B,X
02/E345: 8D BF EF     STA $EFBF
02/E348: A5 47        LDA $47
02/E34A: AA           TAX 
02/E34B: BD BC F0     LDA $F0BC,X
02/E34E: F0 03        BEQ $E353
02/E350: 8D C0 EF     STA $EFC0
02/E353: FA           PLX 
02/E354: BD CE EF     LDA $EFCE,X
02/E357: 29 01        AND #$01
02/E359: 8D C1 EF     STA $EFC1
02/E35C: AD 2D 35     LDA $352D
02/E35F: F0 09        BEQ $E36A
02/E361: A5 64        LDA $64
02/E363: D0 05        BNE $E36A
02/E365: A9 01        LDA #$01
02/E367: 8D C1 EF     STA $EFC1
02/E36A: BD CD EF     LDA $EFCD,X
02/E36D: F0 0B        BEQ $E37A
02/E36F: BD D1 EF     LDA $EFD1,X
02/E372: 3D D2 EF     AND $EFD2,X
02/E375: D0 03        BNE $E37A
02/E377: FE D3 EF     INC $EFD3,X
02/E37A: FE D1 EF     INC $EFD1,X
02/E37D: BD D3 EF     LDA $EFD3,X
02/E380: 29 03        AND #$03
02/E382: 85 0E        STA $0E
02/E384: 64 0F        STZ $0F
02/E386: BD C4 EF     LDA $EFC4,X
02/E389: D0 04        BNE $E38F
02/E38B: A9 1E        LDA #$1E
02/E38D: 80 41        BRA $E3D0
02/E38F: DA           PHX 
02/E390: A5 47        LDA $47
02/E392: 0A           ASL 
02/E393: 0A           ASL 
02/E394: AA           TAX 
02/E395: BD 15 F0     LDA $F015,X
02/E398: 29 30        AND #$30
02/E39A: D0 18        BNE $E3B4
02/E39C: BD 15 F0     LDA $F015,X
02/E39F: 29 08        AND #$08
02/E3A1: F0 11        BEQ $E3B4
02/E3A3: A5 47        LDA $47
02/E3A5: AA           TAX 
02/E3A6: A9 40        LDA #$40
02/E3A8: 8D 77 F0     STA $F077
02/E3AB: 9D 94 F0     STA $F094,X
02/E3AE: FA           PLX 
02/E3AF: BD D0 EF     LDA $EFD0,X
02/E3B2: 80 06        BRA $E3BA
02/E3B4: FA           PLX 
02/E3B5: BD D0 EF     LDA $EFD0,X
02/E3B8: F0 11        BEQ $E3CB
02/E3BA: 18           CLC 
02/E3BB: 6D 77 F0     ADC $F077
02/E3BE: C2 20        REP #$20
02/E3C0: 0A           ASL 
02/E3C1: 0A           ASL 
02/E3C2: 18           CLC 
02/E3C3: 65 0E        ADC $0E
02/E3C5: AA           TAX 
02/E3C6: 7B           TDC 
02/E3C7: E2 20        SEP #$20
02/E3C9: 80 01        BRA $E3CC
02/E3CB: AA           TAX 
02/E3CC: BF 81 FB 13  LDA $13FB81,X
02/E3D0: 8D BA EF     STA $EFBA
02/E3D3: FA           PLX 
02/E3D4: BD 16 F3     LDA $F316,X
02/E3D7: 1D 1B F3     ORA $F31B,X
02/E3DA: F0 0C        BEQ $E3E8
02/E3DC: BD 16 F3     LDA $F316,X
02/E3DF: 8D BB EF     STA $EFBB
02/E3E2: BD 1B F3     LDA $F31B,X
02/E3E5: 8D BC EF     STA $EFBC
02/E3E8: 20 1C E4     JSR $E41C       ; draw character sprite
02/E3EB: AD BA EF     LDA $EFBA
02/E3EE: C9 24        CMP #$24
02/E3F0: F0 20        BEQ $E412
02/E3F2: AD 4B F4     LDA $F44B
02/E3F5: 0D A8 F4     ORA $F4A8
02/E3F8: 0D 24 F4     ORA $F424
02/E3FB: 1D BC F0     ORA $F0BC,X
02/E3FE: 1D AF F0     ORA $F0AF,X
02/E401: 1D BC F2     ORA $F2BC,X
02/E404: D0 0C        BNE $E412
02/E406: AD 2D 35     LDA $352D
02/E409: F0 04        BEQ $E40F
02/E40B: A5 64        LDA $64
02/E40D: F0 03        BEQ $E412
02/E40F: 20 ED DC     JSR $DCED
02/E412: E8           INX 
02/E413: E0 05 00     CPX #$0005
02/E416: F0 03        BEQ $E41B
02/E418: 4C 70 E2     JMP $E270
02/E41B: 60           RTS 

; [ draw character sprite ]

02/E41C: DA           PHX 
02/E41D: AD 24 F4     LDA $F424
02/E420: F0 0C        BEQ $E42E
02/E422: AD BA EF     LDA $EFBA
02/E425: C9 1E        CMP #$1E
02/E427: F0 05        BEQ $E42E
02/E429: A9 09        LDA #$09
02/E42B: 8D BA EF     STA $EFBA
02/E42E: A9 06        LDA #$06
02/E430: 85 1E        STA $1E
02/E432: AD BA EF     LDA $EFBA
02/E435: 85 1C        STA $1C
02/E437: AA           TAX 
02/E438: 20 D2 85     JSR $85D2       ; hardware multiply
02/E43B: BF 3C F8 0D  LDA $0DF83C,X   ; character sprite frame data
02/E43F: 18           CLC 
02/E440: 6D C1 EF     ADC $EFC1
02/E443: 85 1C        STA $1C
02/E445: A9 20        LDA #$20
02/E447: 85 1E        STA $1E
02/E449: A6 20        LDX $20
02/E44B: 86 0E        STX $0E
02/E44D: 20 D2 85     JSR $85D2       ; hardware multiply
02/E450: AD BA EF     LDA $EFBA
02/E453: C9 24        CMP #$24
02/E455: D0 16        BNE $E46D       ; branch if not frame $24
02/E457: AD BD EF     LDA $EFBD
02/E45A: 8D BE EF     STA $EFBE
02/E45D: 8D BF EF     STA $EFBF
02/E460: A9 08        LDA #$08        ; draw 8 tiles
02/E462: 85 22        STA $22
02/E464: AD C0 EF     LDA $EFC0
02/E467: 38           SEC 
02/E468: E9 02        SBC #$02
02/E46A: 4C 74 E4     JMP $E474
02/E46D: A9 06        LDA #$06        ; draw 6 tiles
02/E46F: 85 22        STA $22
02/E471: AD C0 EF     LDA $EFC0
02/E474: C2 20        REP #$20
02/E476: 0A           ASL 
02/E477: 0A           ASL 
02/E478: A8           TAY 
02/E479: 7B           TDC 
02/E47A: E2 20        SEP #$20
02/E47C: AE BB EF     LDX $EFBB
02/E47F: 86 12        STX $12
02/E481: A6 20        LDX $20
02/E483: 64 16        STZ $16
02/E485: AD C2 EF     LDA $EFC2
02/E488: 85 14        STA $14
02/E48A: AD C3 EF     LDA $EFC3
02/E48D: 85 15        STA $15
02/E48F: A5 16        LDA $16
02/E491: 4A           LSR 
02/E492: C9 03        CMP #$03
02/E494: 90 02        BCC $E498
02/E496: A9 02        LDA #$02
02/E498: DA           PHX 
02/E499: AA           TAX 
02/E49A: BD BD EF     LDA $EFBD,X
02/E49D: 05 15        ORA $15
02/E49F: 85 15        STA $15
02/E4A1: A6 0E        LDX $0E
02/E4A3: BF 61 F9 0D  LDA $0DF961,X   ; character sprite tile id
02/E4A7: C9 FF        CMP #$FF
02/E4A9: D0 08        BNE $E4B3
02/E4AB: 85 14        STA $14
02/E4AD: A9 01        LDA #$01
02/E4AF: 85 15        STA $15
02/E4B1: 80 05        BRA $E4B8
02/E4B3: 18           CLC 
02/E4B4: 65 14        ADC $14
02/E4B6: 85 14        STA $14
02/E4B8: E8           INX 
02/E4B9: 86 0E        STX $0E
02/E4BB: FA           PLX 
02/E4BC: BF 61 F8 0D  LDA $0DF861,X   ; x position
02/E4C0: 18           CLC 
02/E4C1: 65 12        ADC $12
02/E4C3: 20 0B BB     JSR $BB0B
02/E4C6: 99 00 03     STA $0300,Y
02/E4C9: E8           INX 
02/E4CA: C8           INY 
02/E4CB: BF 61 F8 0D  LDA $0DF861,X   ; y position
02/E4CF: 18           CLC 
02/E4D0: 65 13        ADC $13
02/E4D2: 99 00 03     STA $0300,Y
02/E4D5: E8           INX 
02/E4D6: C8           INY 
02/E4D7: AD C0 6C     LDA $6CC0
02/E4DA: F0 0D        BEQ $E4E9
; h-flip
02/E4DC: C2 20        REP #$20
02/E4DE: BF 61 F8 0D  LDA $0DF861,X   ; flags
02/E4E2: 05 14        ORA $14         ; tile id
02/E4E4: 49 00 40     EOR #$4000      ; toggle h-flip
02/E4E7: 80 08        BRA $E4F1
; no h-flip
02/E4E9: C2 20        REP #$20
02/E4EB: BF 61 F8 0D  LDA $0DF861,X
02/E4EF: 05 14        ORA $14
02/E4F1: 99 00 03     STA $0300,Y
02/E4F4: 7B           TDC 
02/E4F5: E2 20        SEP #$20
02/E4F7: E8           INX 
02/E4F8: C8           INY 
02/E4F9: E8           INX 
02/E4FA: C8           INY 
02/E4FB: E6 16        INC $16
02/E4FD: A5 16        LDA $16
02/E4FF: C5 22        CMP $22
02/E501: D0 82        BNE $E485
02/E503: FA           PLX 
02/E504: 60           RTS 

; [ draw damage numeral sprites ]

02/E505: AD 07 F1     LDA $F107
02/E508: F0 10        BEQ $E51A       ; return if damage numerals are disabled
02/E50A: 20 1E E7     JSR $E71E
02/E50D: EE 08 F1     INC $F108
02/E510: AD 08 F1     LDA $F108
02/E513: C9 2A        CMP #$2A
02/E515: D0 06        BNE $E51D
02/E517: 9C 07 F1     STZ $F107       ; disable damage numerals animation
02/E51A: 4C D8 E5     JMP $E5D8
02/E51D: A0 00 00     LDY #$0000
02/E520: A2 00 00     LDX #$0000
02/E523: 86 10        STX $10
; start of character/monster loop
02/E525: 64 14        STZ $14
02/E527: B9 FA F0     LDA $F0FA,Y
02/E52A: F0 09        BEQ $E535       ; branch if no damage numerals
02/E52C: C9 FF        CMP #$FF
02/E52E: F0 03        BEQ $E533       ; branch if miss
02/E530: 4C C2 E5     JMP $E5C2
02/E533: E6 14        INC $14
02/E535: B9 D3 F0     LDA $F0D3,Y     ; x position
02/E538: 38           SEC 
02/E539: E9 10        SBC #$10
02/E53B: 85 12        STA $12
02/E53D: DA           PHX 
02/E53E: B9 E0 F0     LDA $F0E0,Y     ; y position
02/E541: 38           SEC 
02/E542: E9 08        SBC #$08
02/E544: 85 0E        STA $0E
02/E546: 5A           PHY 
02/E547: A0 00 00     LDY #$0000
02/E54A: AD 08 F1     LDA $F108
02/E54D: AA           TAX 
02/E54E: A5 14        LDA $14
02/E550: D0 15        BNE $E567       ; branch if miss
02/E552: BF 8A FC 16  LDA $16FC8A,X   ; damage numeral y-offsets
02/E556: 18           CLC 
02/E557: 65 0E        ADC $0E
02/E559: 99 13 00     STA $0013,Y
02/E55C: E8           INX             ; successive digits are delayed by 3 frames
02/E55D: E8           INX 
02/E55E: E8           INX 
02/E55F: C8           INY 
02/E560: C0 05 00     CPY #$0005
02/E563: D0 ED        BNE $E552
02/E565: 80 15        BRA $E57C
02/E567: AD 08 F1     LDA $F108
02/E56A: AA           TAX 
02/E56B: BF 8A FC 16  LDA $16FC8A,X   ; damage numeral y-offsets
02/E56F: 18           CLC 
02/E570: 65 0E        ADC $0E         ; miss tiles bounce together
02/E572: 85 13        STA $13
02/E574: 85 14        STA $14
02/E576: 85 15        STA $15
02/E578: 85 16        STA $16
02/E57A: 85 17        STA $17
02/E57C: A9 05        LDA #$05        ; loop through 5 digits
02/E57E: 85 0E        STA $0E
02/E580: 7A           PLY 
02/E581: FA           PLX 
02/E582: AD C0 6C     LDA $6CC0
02/E585: F0 09        BEQ $E590       ; branch if not back attack
02/E587: A5 12        LDA $12
02/E589: 49 FF        EOR #$FF
02/E58B: 38           SEC 
02/E58C: E9 20        SBC #$20
02/E58E: 85 12        STA $12
; start of digit loop
02/E590: A5 12        LDA $12
02/E592: 9D 40 03     STA $0340,X     ; set sprite x position
02/E595: 18           CLC 
02/E596: 69 08        ADC #$08
02/E598: 85 12        STA $12
02/E59A: E8           INX 
02/E59B: DA           PHX 
02/E59C: A5 0E        LDA $0E
02/E59E: 3A           DEC 
02/E59F: AA           TAX 
02/E5A0: B5 13        LDA $13,X
02/E5A2: FA           PLX 
02/E5A3: 9D 40 03     STA $0340,X     ; set sprite y position
02/E5A6: E8           INX 
02/E5A7: DA           PHX 
02/E5A8: A6 10        LDX $10
02/E5AA: E8           INX 
02/E5AB: 86 10        STX $10
02/E5AD: BD E6 DB     LDA $DBE6,X     ; set sprite tile id
02/E5B0: FA           PLX 
02/E5B1: 9D 40 03     STA $0340,X
02/E5B4: E8           INX 
02/E5B5: B9 ED F0     LDA $F0ED,Y
02/E5B8: 9D 40 03     STA $0340,X     ; set sprite flags
02/E5BB: E8           INX 
02/E5BC: C6 0E        DEC $0E
02/E5BE: D0 D0        BNE $E590
02/E5C0: 80 0D        BRA $E5CF
02/E5C2: C2 20        REP #$20        ; skip character/monster
02/E5C4: A5 10        LDA $10
02/E5C6: 18           CLC 
02/E5C7: 69 05 00     ADC #$0005
02/E5CA: 85 10        STA $10
02/E5CC: 7B           TDC 
02/E5CD: E2 20        SEP #$20
02/E5CF: C8           INY             ; next character/monster
02/E5D0: C0 0D 00     CPY #$000D
02/E5D3: F0 03        BEQ $E5D8
02/E5D5: 4C 25 E5     JMP $E525
02/E5D8: 60           RTS 

; [  ]

02/E5D9: AD C9 F0     LDA $F0C9
02/E5DC: F0 51        BEQ $E62F
02/E5DE: AD CA F0     LDA $F0CA
02/E5E1: 85 0E        STA $0E
02/E5E3: 4A           LSR 
02/E5E4: 4A           LSR 
02/E5E5: A8           TAY 
02/E5E6: A5 0E        LDA $0E
02/E5E8: 29 03        AND #$03
02/E5EA: AA           TAX 
02/E5EB: BF 41 FA 0D  LDA $0DFA41,X
02/E5EF: 85 10        STA $10
02/E5F1: BF 45 FA 0D  LDA $0DFA45,X
02/E5F5: 85 11        STA $11
02/E5F7: B9 00 05     LDA $0500,Y
02/E5FA: 25 11        AND $11
02/E5FC: 05 10        ORA $10
02/E5FE: 99 00 05     STA $0500,Y
02/E601: A5 0E        LDA $0E
02/E603: C2 20        REP #$20
02/E605: 0A           ASL 
02/E606: 0A           ASL 
02/E607: AA           TAX 
02/E608: 7B           TDC 
02/E609: E2 20        SEP #$20
02/E60B: AD CD F0     LDA $F0CD
02/E60E: 9D 01 03     STA $0301,X
02/E611: AD CB F0     LDA $F0CB
02/E614: 9D 02 03     STA $0302,X
02/E617: AD C0 6C     LDA $6CC0
02/E61A: F0 14        BEQ $E630
02/E61C: AD CC F0     LDA $F0CC
02/E61F: 49 FF        EOR #$FF
02/E621: 38           SEC 
02/E622: E9 10        SBC #$10
02/E624: 9D 00 03     STA $0300,X
02/E627: AD CE F0     LDA $F0CE
02/E62A: 49 40        EOR #$40
02/E62C: 9D 03 03     STA $0303,X
02/E62F: 60           RTS 
02/E630: AD CC F0     LDA $F0CC
02/E633: 9D 00 03     STA $0300,X
02/E636: AD CE F0     LDA $F0CE
02/E639: 9D 03 03     STA $0303,X
02/E63C: 60           RTS 

; [  ]

02/E63D: AD C1 F0     LDA $F0C1
02/E640: D0 01        BNE $E643
02/E642: 60           RTS 
02/E643: 9C C1 F0     STZ $F0C1
02/E646: AD C7 F0     LDA $F0C7
02/E649: D0 05        BNE $E650
02/E64B: 20 1E E7     JSR $E71E
02/E64E: 80 10        BRA $E660
02/E650: C9 FF        CMP #$FF
02/E652: F0 0C        BEQ $E660
02/E654: C9 FE        CMP #$FE
02/E656: F0 05        BEQ $E65D
02/E658: 20 07 E7     JSR $E707
02/E65B: 80 03        BRA $E660
02/E65D: 20 E0 E6     JSR $E6E0
02/E660: AD C3 F0     LDA $F0C3
02/E663: 0A           ASL 
02/E664: AA           TAX 
02/E665: BF 89 FA 0D  LDA $0DFA89,X
02/E669: 85 14        STA $14
02/E66B: BF 8A FA 0D  LDA $0DFA8A,X
02/E66F: 85 15        STA $15
02/E671: A9 0D        LDA #$0D
02/E673: 85 16        STA $16
02/E675: AD C4 F0     LDA $F0C4
02/E678: 38           SEC 
02/E679: E9 18        SBC #$18
02/E67B: 85 0E        STA $0E
02/E67D: AD C5 F0     LDA $F0C5
02/E680: 38           SEC 
02/E681: E9 18        SBC #$18
02/E683: 85 10        STA $10
02/E685: AD C6 F0     LDA $F0C6
02/E688: 85 12        STA $12
02/E68A: AD C2 F0     LDA $F0C2
02/E68D: C2 20        REP #$20
02/E68F: 0A           ASL 
02/E690: 0A           ASL 
02/E691: AA           TAX 
02/E692: 7B           TDC 
02/E693: E2 20        SEP #$20
02/E695: A0 00 00     LDY #$0000
02/E698: B7 14        LDA [$14],Y
02/E69A: C9 FF        CMP #$FF
02/E69C: F0 41        BEQ $E6DF
02/E69E: 48           PHA 
02/E69F: 29 F0        AND #$F0
02/E6A1: 4A           LSR 
02/E6A2: 18           CLC 
02/E6A3: 65 0E        ADC $0E
02/E6A5: 20 0B BB     JSR $BB0B
02/E6A8: 9D 00 03     STA $0300,X
02/E6AB: E8           INX 
02/E6AC: 68           PLA 
02/E6AD: 29 0F        AND #$0F
02/E6AF: 0A           ASL 
02/E6B0: 0A           ASL 
02/E6B1: 0A           ASL 
02/E6B2: 18           CLC 
02/E6B3: 65 10        ADC $10
02/E6B5: 9D 00 03     STA $0300,X
02/E6B8: E8           INX 
02/E6B9: C8           INY 
02/E6BA: B7 14        LDA [$14],Y
02/E6BC: 18           CLC 
02/E6BD: 65 12        ADC $12
02/E6BF: 9D 00 03     STA $0300,X
02/E6C2: E8           INX 
02/E6C3: C8           INY 
02/E6C4: AD C0 6C     LDA $6CC0
02/E6C7: F0 0C        BEQ $E6D5
02/E6C9: AD C8 F0     LDA $F0C8
02/E6CC: 49 40        EOR #$40
02/E6CE: 9D 00 03     STA $0300,X
02/E6D1: E8           INX 
02/E6D2: 4C 98 E6     JMP $E698
02/E6D5: AD C8 F0     LDA $F0C8
02/E6D8: 9D 00 03     STA $0300,X
02/E6DB: E8           INX 
02/E6DC: 4C 98 E6     JMP $E698
02/E6DF: 60           RTS 

; [  ]

02/E6E0: A2 20 00     LDX #$0020
02/E6E3: BD 3F 03     LDA $033F,X
02/E6E6: 9D 43 03     STA $0343,X
02/E6E9: CA           DEX 
02/E6EA: D0 F7        BNE $E6E3
02/E6EC: 60           RTS 

; [  ]

02/E6ED: A2 40 00     LDX #$0040
02/E6F0: A9 F0        LDA #$F0
02/E6F2: 9D 00 03     STA $0300,X
02/E6F5: E8           INX 
02/E6F6: E0 60 01     CPX #$0160
02/E6F9: D0 F7        BNE $E6F2
02/E6FB: 9C 2B F4     STZ $F42B
02/E6FE: 60           RTS 

; [  ]

02/E6FF: 20 1E E7     JSR $E71E
02/E702: 6B           RTL 

; [  ]

02/E703: 20 07 E7     JSR $E707
02/E706: 6B           RTL 

; [  ]

02/E707: DA           PHX 
02/E708: A2 00 00     LDX #$0000
02/E70B: A9 AA        LDA #$AA
02/E70D: EE 2B F4     INC $F42B
02/E710: 9D 04 05     STA $0504,X
02/E713: E8           INX 
02/E714: E0 12 00     CPX #$0012
02/E717: D0 F7        BNE $E710
02/E719: 20 ED E6     JSR $E6ED
02/E71C: FA           PLX 
02/E71D: 60           RTS 

; [  ]

02/E71E: DA           PHX 
02/E71F: 7B           TDC 
02/E720: AA           TAX 
02/E721: EE 2B F4     INC $F42B
02/E724: 9D 04 05     STA $0504,X
02/E727: E8           INX 
02/E728: E0 12 00     CPX #$0012
02/E72B: D0 F7        BNE $E724
02/E72D: 20 ED E6     JSR $E6ED
02/E730: FA           PLX 
02/E731: 60           RTS 

; [  ]

02/E732: 48           PHA 
02/E733: 18           CLC 
02/E734: 7D 33 F1     ADC $F133,X
02/E737: 9D 33 F1     STA $F133,X
02/E73A: 68           PLA 
02/E73B: 18           CLC 
02/E73C: 7D 73 F1     ADC $F173,X
02/E73F: 9D 73 F1     STA $F173,X
02/E742: 60           RTS 
02/E743: 20 47 E7     JSR $E747
02/E746: 6B           RTL 

; [  ]

02/E747: A2 00 00     LDX #$0000
02/E74A: A9 40        LDA #$40
02/E74C: 9E 33 F1     STZ $F133,X
02/E74F: 9D 73 F1     STA $F173,X
02/E752: E8           INX 
02/E753: E0 08 00     CPX #$0008
02/E756: D0 F4        BNE $E74C
02/E758: 60           RTS 

; [  ]

02/E759: 20 5D E7     JSR $E75D
02/E75C: 6B           RTL 

; [  ]

02/E75D: A2 00 00     LDX #$0000
02/E760: 9D B3 F1     STA $F1B3,X
02/E763: 9D F3 F1     STA $F1F3,X
02/E766: E8           INX 
02/E767: E0 08 00     CPX #$0008
02/E76A: D0 F4        BNE $E760
02/E76C: 60           RTS 

; [  ]

02/E76D: 48           PHA 
02/E76E: 18           CLC 
02/E76F: 7D B3 F1     ADC $F1B3,X
02/E772: 9D B3 F1     STA $F1B3,X
02/E775: 68           PLA 
02/E776: 18           CLC 
02/E777: 7D F3 F1     ADC $F1F3,X
02/E77A: 9D F3 F1     STA $F1F3,X
02/E77D: 60           RTS 

; [  ]

02/E77E: BD B3 F1     LDA $F1B3,X
02/E781: 0A           ASL 
02/E782: 85 28        STA $28
02/E784: BD 33 F1     LDA $F133,X
02/E787: 4C 9A E7     JMP $E79A

; [  ]

02/E78A: BD F3 F1     LDA $F1F3,X
02/E78D: 0A           ASL 
02/E78E: 85 28        STA $28
02/E790: BD 73 F1     LDA $F173,X
02/E793: 4C 9A E7     JMP $E79A

; [  ]

02/E796: 20 9A E7     JSR $E79A
02/E799: 6B           RTL 

; [  ]

02/E79A: AA           TAX 
02/E79B: BF 00 FF 1C  LDA $1CFF00,X   ; sine table
02/E79F: 10 10        BPL $E7B1
02/E7A1: 49 FF        EOR #$FF
02/E7A3: 85 26        STA $26
02/E7A5: 20 60 85     JSR $8560       ; multiply (8-bit)
02/E7A8: A5 2B        LDA $2B
02/E7AA: 49 FF        EOR #$FF
02/E7AC: 1A           INC 
02/E7AD: 10 0B        BPL $E7BA
02/E7AF: 38           SEC 
02/E7B0: 60           RTS 
02/E7B1: 85 26        STA $26
02/E7B3: 20 60 85     JSR $8560       ; multiply (8-bit)
02/E7B6: A5 2B        LDA $2B
02/E7B8: 30 F5        BMI $E7AF
02/E7BA: 18           CLC 
02/E7BB: 60           RTS 

; [  ]

02/E7BC: 20 C0 E7     JSR $E7C0
02/E7BF: 6B           RTL 

; [  ]

02/E7C0: 9C 20 F1     STZ $F120
02/E7C3: AE 11 F1     LDX $F111
02/E7C6: 8E 18 F1     STX $F118
02/E7C9: 9C 16 F1     STZ $F116
02/E7CC: 9C 17 F1     STZ $F117
02/E7CF: 9C 1B F1     STZ $F11B
02/E7D2: 9C 1C F1     STZ $F11C
02/E7D5: 9C 1A F1     STZ $F11A
02/E7D8: AD 12 F1     LDA $F112
02/E7DB: CD 14 F1     CMP $F114
02/E7DE: F0 30        BEQ $E810
02/E7E0: 90 17        BCC $E7F9
02/E7E2: CE 17 F1     DEC $F117
02/E7E5: AD 12 F1     LDA $F112
02/E7E8: 38           SEC 
02/E7E9: ED 14 F1     SBC $F114
02/E7EC: 8D 1B F1     STA $F11B
02/E7EF: 4A           LSR 
02/E7F0: 18           CLC 
02/E7F1: 6D 14 F1     ADC $F114
02/E7F4: 8D 1F F1     STA $F11F
02/E7F7: 80 17        BRA $E810
02/E7F9: EE 17 F1     INC $F117
02/E7FC: AD 14 F1     LDA $F114
02/E7FF: 38           SEC 
02/E800: ED 12 F1     SBC $F112
02/E803: 8D 1B F1     STA $F11B
02/E806: 4A           LSR 
02/E807: 18           CLC 
02/E808: 6D 12 F1     ADC $F112
02/E80B: 8D 1F F1     STA $F11F
02/E80E: 80 00        BRA $E810
02/E810: AD 11 F1     LDA $F111
02/E813: CD 13 F1     CMP $F113
02/E816: F0 2E        BEQ $E846
02/E818: 90 17        BCC $E831
02/E81A: CE 16 F1     DEC $F116
02/E81D: AD 11 F1     LDA $F111
02/E820: 38           SEC 
02/E821: ED 13 F1     SBC $F113
02/E824: 8D 1C F1     STA $F11C
02/E827: 4A           LSR 
02/E828: 18           CLC 
02/E829: 6D 13 F1     ADC $F113
02/E82C: 8D 1E F1     STA $F11E
02/E82F: 80 15        BRA $E846
02/E831: EE 16 F1     INC $F116
02/E834: AD 13 F1     LDA $F113
02/E837: 38           SEC 
02/E838: ED 11 F1     SBC $F111
02/E83B: 8D 1C F1     STA $F11C
02/E83E: 4A           LSR 
02/E83F: 18           CLC 
02/E840: 6D 11 F1     ADC $F111
02/E843: 8D 1E F1     STA $F11E
02/E846: AD 1C F1     LDA $F11C
02/E849: AA           TAX 
02/E84A: 86 26        STX $26
02/E84C: AD 15 F1     LDA $F115
02/E84F: AA           TAX 
02/E850: 86 28        STX $28
02/E852: 20 2B 85     JSR $852B       ; divide
02/E855: A5 2A        LDA $2A
02/E857: 1A           INC 
02/E858: 8D 1D F1     STA $F11D
02/E85B: 60           RTS 

; [  ]

02/E85C: 20 60 E8     JSR $E860
02/E85F: 6B           RTL 

; [  ]

02/E860: 9C 21 F1     STZ $F121
02/E863: 9C 22 F1     STZ $F122
02/E866: AD 15 F1     LDA $F115
02/E869: 85 00        STA $00
02/E86B: AD 18 F1     LDA $F118
02/E86E: 18           CLC 
02/E86F: 6D 16 F1     ADC $F116
02/E872: 8D 18 F1     STA $F118
02/E875: AD 1A F1     LDA $F11A
02/E878: 18           CLC 
02/E879: 6D 1B F1     ADC $F11B
02/E87C: 8D 1A F1     STA $F11A
02/E87F: CD 1C F1     CMP $F11C
02/E882: 90 47        BCC $E8CB
02/E884: AD 17 F1     LDA $F117
02/E887: 30 0F        BMI $E898
02/E889: C2 20        REP #$20
02/E88B: A5 00        LDA $00
02/E88D: 48           PHA 
02/E88E: AD 17 F1     LDA $F117
02/E891: 29 FF 00     AND #$00FF
02/E894: 85 00        STA $00
02/E896: 80 0D        BRA $E8A5
02/E898: C2 20        REP #$20
02/E89A: A5 00        LDA $00
02/E89C: 48           PHA 
02/E89D: AD 17 F1     LDA $F117
02/E8A0: 09 00 FF     ORA #$FF00
02/E8A3: 85 00        STA $00
02/E8A5: AD 21 F1     LDA $F121
02/E8A8: 18           CLC 
02/E8A9: 65 00        ADC $00
02/E8AB: 8D 21 F1     STA $F121
02/E8AE: 68           PLA 
02/E8AF: 85 00        STA $00
02/E8B1: 7B           TDC 
02/E8B2: E2 20        SEP #$20
02/E8B4: AD 19 F1     LDA $F119
02/E8B7: 18           CLC 
02/E8B8: 6D 17 F1     ADC $F117
02/E8BB: 8D 19 F1     STA $F119
02/E8BE: AD 1A F1     LDA $F11A
02/E8C1: 38           SEC 
02/E8C2: ED 1C F1     SBC $F11C
02/E8C5: 8D 1A F1     STA $F11A
02/E8C8: 4C 7F E8     JMP $E87F
02/E8CB: C6 00        DEC $00
02/E8CD: D0 9C        BNE $E86B
02/E8CF: CE 1D F1     DEC $F11D
02/E8D2: D0 02        BNE $E8D6
02/E8D4: 38           SEC 
02/E8D5: 60           RTS 
02/E8D6: 18           CLC 
02/E8D7: 60           RTS 

; [  ]

02/E8D8: 22 41 F5 03  JSL $03F541
02/E8DC: 60           RTS 

; [  ]

02/E8DD: 22 55 F5 03  JSL $03F555
02/E8E1: 60           RTS 

; [  ]

02/E8E2: 22 6A F5 03  JSL $03F56A
02/E8E6: 60           RTS 

; [  ]

02/E8E7: AA           TAX 
02/E8E8: A9 FF        LDA #$FF
02/E8EA: 9D 23 F1     STA $F123,X
02/E8ED: 20 DD E8     JSR $E8DD
02/E8F0: 20 2F 8D     JSR $8D2F
02/E8F3: 20 E2 E8     JSR $E8E2
02/E8F6: 4C AD BC     JMP $BCAD

; [ battle graphics $10:  ]

; draw targets killed by poison or sap ???

02/E8F9: AD 9A F4     LDA $F49A
02/E8FC: C9 8C        CMP #$8C
02/E8FE: D0 06        BNE $E906
02/E900: 8D 83 F4     STA $F483
02/E903: 9C 9A F4     STZ $F49A
02/E906: AD 73 F4     LDA $F473
02/E909: D0 13        BNE $E91E
02/E90B: 7B           TDC 
02/E90C: AA           TAX 
02/E90D: BD B5 29     LDA $29B5,X
02/E910: DD 23 F1     CMP $F123,X
02/E913: D0 09        BNE $E91E
02/E915: E8           INX 
02/E916: E0 08 00     CPX #$0008
02/E919: D0 F2        BNE $E90D
02/E91B: 4C A5 E9     JMP $E9A5
02/E91E: AD E6 38     LDA $38E6
02/E921: C9 03        CMP #$03
02/E923: D0 03        BNE $E928
02/E925: 4C A5 E9     JMP $E9A5
02/E928: AD A4 29     LDA $29A4
02/E92B: 29 10        AND #$10
02/E92D: F0 11        BEQ $E940
02/E92F: AD E6 38     LDA $38E6
02/E932: D0 0C        BNE $E940
02/E934: 20 6D C4     JSR $C46D
02/E937: 20 DD E8     JSR $E8DD
02/E93A: 22 18 F4 03  JSL $03F418
02/E93E: 80 20        BRA $E960
02/E940: 20 DD E8     JSR $E8DD
02/E943: 20 35 8D     JSR $8D35
02/E946: AC 00 18     LDY $1800
02/E949: C0 B7 01     CPY #$01B7
02/E94C: D0 1B        BNE $E969
02/E94E: AD E6 38     LDA $38E6
02/E951: D0 16        BNE $E969
02/E953: EE A1 F4     INC $F4A1
02/E956: 20 2F 8D     JSR $8D2F
02/E959: 20 AD BC     JSR $BCAD
02/E95C: 22 91 F5 03  JSL $03F591
02/E960: 20 E2 E8     JSR $E8E2
02/E963: 7B           TDC 
02/E964: 20 DF F5     JSR $F5DF
02/E967: 80 3C        BRA $E9A5
02/E969: 7B           TDC 
02/E96A: AA           TAX 
02/E96B: BD B5 29     LDA $29B5,X
02/E96E: DD 2B F1     CMP $F12B,X
02/E971: F0 0E        BEQ $E981
02/E973: DA           PHX 
02/E974: 8A           TXA 
02/E975: 8D 09 F1     STA $F109
02/E978: A9 07        LDA #$07
02/E97A: 8D 0A F1     STA $F10A
02/E97D: 20 89 8A     JSR $8A89
02/E980: FA           PLX 
02/E981: E8           INX 
02/E982: E0 08 00     CPX #$0008
02/E985: D0 E4        BNE $E96B
02/E987: 20 C7 8B     JSR $8BC7
02/E98A: 20 E2 E8     JSR $E8E2
02/E98D: 20 B2 BC     JSR $BCB2
02/E990: 20 D8 E8     JSR $E8D8
02/E993: A9 01        LDA #$01
02/E995: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/E998: 20 2F 8D     JSR $8D2F
02/E99B: 20 AD BC     JSR $BCAD
02/E99E: 20 A9 E9     JSR $E9A9
02/E9A1: 7B           TDC 
02/E9A2: 20 C2 BC     JSR $BCC2       ; clear bg1 h-scroll hdma data
02/E9A5: 9C 83 F4     STZ $F483
02/E9A8: 60           RTS 

; [  ]

02/E9A9: AD 83 F4     LDA $F483
02/E9AC: D0 10        BNE $E9BE
02/E9AE: A9 80        LDA #$80
02/E9B0: 8D 85 F4     STA $F485
02/E9B3: AD E6 38     LDA $38E6
02/E9B6: AA           TAX 
02/E9B7: BF 13 F7 03  LDA $03F713,X
02/E9BB: 20 DF F5     JSR $F5DF
02/E9BE: 9C 83 F4     STZ $F483
02/E9C1: 20 13 85     JSR $8513       ; wait one frame
02/E9C4: 7B           TDC 
02/E9C5: AA           TAX 
02/E9C6: BD 30 EE     LDA $EE30,X
02/E9C9: 85 00        STA $00
02/E9CB: BD 31 EE     LDA $EE31,X
02/E9CE: 85 01        STA $01
02/E9D0: A9 01        LDA #$01
02/E9D2: 20 43 BD     JSR $BD43
02/E9D5: A5 00        LDA $00
02/E9D7: 9D 30 EE     STA $EE30,X
02/E9DA: A5 01        LDA $01
02/E9DC: 9D 31 EE     STA $EE31,X
02/E9DF: E8           INX 
02/E9E0: E8           INX 
02/E9E1: E0 20 00     CPX #$0020
02/E9E4: D0 E0        BNE $E9C6
02/E9E6: 22 C8 FA 03  JSL $03FAC8
02/E9EA: E6 4E        INC $4E
02/E9EC: A5 4E        LDA $4E
02/E9EE: C9 30        CMP #$30
02/E9F0: D0 CC        BNE $E9BE
02/E9F2: 60           RTS 

; [  ]

02/E9F3: 48           PHA 
02/E9F4: A9 20        LDA #$20
02/E9F6: 85 28        STA $28
02/E9F8: 68           PLA 
02/E9F9: 20 9A E7     JSR $E79A
02/E9FC: 85 04        STA $04
02/E9FE: 06 2B        ASL $2B
02/EA00: 26 05        ROL $05
02/EA02: A5 05        LDA $05
02/EA04: 29 01        AND #$01
02/EA06: 85 05        STA $05
02/EA08: A0 18 00     LDY #$0018
02/EA0B: 84 00        STY $00
02/EA0D: A5 02        LDA $02
02/EA0F: C2 20        REP #$20
02/EA11: 0A           ASL 
02/EA12: 0A           ASL 
02/EA13: A8           TAY 
02/EA14: A5 04        LDA $04
02/EA16: 99 12 76     STA $7612,Y
02/EA19: C8           INY 
02/EA1A: C8           INY 
02/EA1B: C8           INY 
02/EA1C: C8           INY 
02/EA1D: C6 00        DEC $00
02/EA1F: D0 F5        BNE $EA16
02/EA21: 7B           TDC 
02/EA22: E2 20        SEP #$20
02/EA24: A5 02        LDA $02
02/EA26: 18           CLC 
02/EA27: 69 18        ADC #$18
02/EA29: 85 02        STA $02
02/EA2B: 6B           RTL 

02/EA2C: FC FD FE

; [  ]

02/EA2F: 48           PHA 
02/EA30: AA           TAX 
02/EA31: BF 2C EA 02  LDA $02EA2C,X
02/EA35: 8D 7F F4     STA $F47F
02/EA38: 68           PLA 
02/EA39: 48           PHA 
02/EA3A: A5 48        LDA $48
02/EA3C: 0A           ASL 
02/EA3D: 0A           ASL 
02/EA3E: 0A           ASL 
02/EA3F: 0A           ASL 
02/EA40: AA           TAX 
02/EA41: BD C5 EF     LDA $EFC5,X
02/EA44: C9 C0        CMP #$C0
02/EA46: D0 F9        BNE $EA41
02/EA48: 68           PLA 
02/EA49: 9C A0 F2     STZ $F2A0
02/EA4C: 48           PHA 
02/EA4D: 20 06 FE     JSR $FE06
02/EA50: 68           PLA 
02/EA51: 48           PHA 
02/EA52: 18           CLC 
02/EA53: 69 06        ADC #$06
02/EA55: A2 0F 00     LDX #$000F
02/EA58: 8D 57 F4     STA $F457
02/EA5B: 20 79 91     JSR $9179
02/EA5E: 64 00        STZ $00
02/EA60: 20 26 EE     JSR $EE26
02/EA63: 64 02        STZ $02
02/EA65: 68           PLA 
02/EA66: 85 04        STA $04
02/EA68: AD E2 38     LDA $38E2
02/EA6B: 48           PHA 
02/EA6C: 9C E2 38     STZ $38E2
02/EA6F: AD C2 34     LDA $34C2
02/EA72: 8D 85 F4     STA $F485
02/EA75: A5 04        LDA $04
02/EA77: 20 BC F6     JSR $F6BC       ; execute animation script
02/EA7A: 68           PLA 
02/EA7B: 8D E2 38     STA $38E2
02/EA7E: 20 07 E7     JSR $E707
02/EA81: 60           RTS 

; --------------------------------------------------------------------------

; [ load summon graphics ]

02/EA82: 48           PHA 
02/EA83: 38           SEC 
02/EA84: E9 4D        SBC #$4D
02/EA86: 48           PHA 
02/EA87: 48           PHA 
02/EA88: AA           TAX 
02/EA89: BF 4C FE 0D  LDA $0DFE4C,X
02/EA8D: A2 0C 00     LDX #$000C
02/EA90: 20 50 91     JSR $9150
02/EA93: 68           PLA 
02/EA94: 0A           ASL 
02/EA95: AA           TAX 
02/EA96: C2 20        REP #$20
02/EA98: A9 80 00     LDA #$0080
02/EA9B: 85 00        STA $00
02/EA9D: BF F0 87 0D  LDA $0D87F0,X   ; pointers to summon graphics
02/EAA1: A8           TAY 
02/EAA2: A2 E6 DB     LDX #$DBE6
02/EAA5: 7B           TDC 
02/EAA6: E2 20        SEP #$20
02/EAA8: A9 0D        LDA #$0D
02/EAAA: 20 3D DA     JSR $DA3D       ; load 3bpp graphics
02/EAAD: 68           PLA 
02/EAAE: 0A           ASL 
02/EAAF: AA           TAX 
02/EAB0: C2 20        REP #$20
02/EAB2: BF 60 F2 0D  LDA $0DF260,X
02/EAB6: AA           TAX 
02/EAB7: 7B           TDC 
02/EAB8: E2 20        SEP #$20
02/EABA: A9 0D        LDA #$0D
02/EABC: 20 09 84     JSR $8409
02/EABF: 68           PLA 
02/EAC0: 60           RTS 

; [ do magic animation ]

02/EAC1: 9C D0 F2     STZ $F2D0
02/EAC4: B2 3F        LDA ($3F)
02/EAC6: D0 01        BNE $EAC9
02/EAC8: 60           RTS 
02/EAC9: 8D 9A F4     STA $F49A
02/EACC: 8D 7F F4     STA $F47F
02/EACF: CE 7F F4     DEC $F47F
02/EAD2: 9C 51 F4     STZ $F451
02/EAD5: 9C 85 F2     STZ $F285
02/EAD8: C9 4D        CMP #$4D
02/EADA: 90 22        BCC $EAFE
02/EADC: C9 5E        CMP #$5E
02/EADE: B0 1E        BCS $EAFE
02/EAE0: 48           PHA 
02/EAE1: 20 82 EA     JSR $EA82       ; load summon graphics
02/EAE4: 22 53 FD 03  JSL $03FD53
02/EAE8: A9 01        LDA #$01
02/EAEA: 8D 20 F3     STA $F320
02/EAED: 22 25 F8 03  JSL $03F825
02/EAF1: 20 26 F2     JSR $F226
02/EAF4: AD C5 34     LDA $34C5
02/EAF7: D0 04        BNE $EAFD
02/EAF9: 68           PLA 
02/EAFA: 4C 8B BE     JMP $BE8B
02/EAFD: 68           PLA 
02/EAFE: 3A           DEC 
02/EAFF: C2 20        REP #$20
02/EB01: 0A           ASL 
02/EB02: 0A           ASL 
02/EB03: AA           TAX 
02/EB04: 7B           TDC 
02/EB05: E2 20        SEP #$20
02/EB07: BF 50 A0 0F  LDA $0FA050,X
02/EB0B: DA           PHX 
02/EB0C: A2 0F 00     LDX #$000F
02/EB0F: 8D 57 F4     STA $F457
02/EB12: 20 79 91     JSR $9179
02/EB15: FA           PLX 
02/EB16: BF 51 A0 0F  LDA $0FA051,X
02/EB1A: DA           PHX 
02/EB1B: 20 14 FE     JSR $FE14
02/EB1E: AD C4 34     LDA $34C4
02/EB21: 8D 85 F4     STA $F485
02/EB24: FA           PLX 
02/EB25: BF 52 A0 0F  LDA $0FA052,X
02/EB29: C9 FF        CMP #$FF
02/EB2B: F0 24        BEQ $EB51
02/EB2D: 8D 97 F3     STA $F397
02/EB30: A9 01        LDA #$01
02/EB32: 8D 66 F2     STA $F266
02/EB35: 8D 67 F2     STA $F267
02/EB38: BF 53 A0 0F  LDA $0FA053,X
02/EB3C: C9 FF        CMP #$FF
02/EB3E: F0 11        BEQ $EB51
02/EB40: 0A           ASL 
02/EB41: AA           TAX 
02/EB42: BF 79 EB 02  LDA $02EB79,X   ; magic animation jump table
02/EB46: 85 00        STA $00
02/EB48: BF 7A EB 02  LDA $02EB7A,X
02/EB4C: 85 01        STA $01
02/EB4E: 20 57 EB     JSR $EB57
02/EB51: 9C D0 F2     STZ $F2D0
02/EB54: 4C 07 E7     JMP $E707
02/EB57: 9C 2B F4     STZ $F42B
02/EB5A: 6C 00 00     JMP ($0000)

; [ do magic animation (far) ]

02/EB5D: C9 FF        CMP #$FF
02/EB5F: F0 11        BEQ $EB72
02/EB61: 0A           ASL 
02/EB62: AA           TAX 
02/EB63: BF 79 EB 02  LDA $02EB79,X   ; magic animation jump table
02/EB67: 85 00        STA $00
02/EB69: BF 7A EB 02  LDA $02EB7A,X
02/EB6D: 85 01        STA $01
02/EB6F: 20 73 EB     JSR $EB73
02/EB72: 6B           RTL 
02/EB73: 9C 2B F4     STZ $F42B
02/EB76: 6C 00 00     JMP ($0000)

; magic animation jump table
02/EB79: F30D F304 F2F9 F0F4 EFBB EFC0 EE09 EF91  ; $00
02/EB89: EFAB EFB3 EE5E EE6B EE93 EE9D EEA4 EF06
02/EB99: EF0D EF14 EF28 EF2F EF36 EF72 EF79 EF80  ; $10
02/EBA9: EF80 EF80 EF8A F30A F316 EE03 EDFE EDF5
02/EBB9: ED9F ED47 ED08 ECC9 EC9F EC6A ECA4 EBF5  ; $20
02/EBC9: ECAC EC4F EBFF EC09 EC13 EC1D EBEF EBD9

; $2F: 
02/EBD9: 20 E7 F5     JSR $F5E7
02/EBDC: 20 26 F2     JSR $F226
02/EBDF: 22 C5 EE 01  JSL $01EEC5
02/EBE3: A2 20 00     LDX #$0020
02/EBE6: 20 A0 C8     JSR $C8A0       ; wait
02/EBE9: 9C 87 EF     STZ $EF87
02/EBEC: 4C 79 F2     JMP $F279
; $2E: 
02/EBEF: 20 E8 ED     JSR $EDE8
02/EBF2: 4C 16 F3     JMP $F316
; $27: big bang
02/EBF5: A9 07        LDA #$07
02/EBF7: 8D D0 F2     STA $F2D0
02/EBFA: 22 6F F8 03  JSL $03F86F
02/EBFE: 60           RTS 
; $2A: 
02/EBFF: 20 E7 F5     JSR $F5E7
02/EC02: 22 C1 EE 01  JSL $01EEC1
02/EC06: 4C 24 EC     JMP $EC24
; $2B: 
02/EC09: 20 E7 F5     JSR $F5E7
02/EC0C: 22 B9 EE 01  JSL $01EEB9
02/EC10: 4C 24 EC     JMP $EC24
; $2C: 
02/EC13: 20 E7 F5     JSR $F5E7
02/EC16: 22 B5 EE 01  JSL $01EEB5
02/EC1A: 4C 24 EC     JMP $EC24
; $2D: 
02/EC1D: 20 E7 F5     JSR $F5E7
02/EC20: 22 C5 EE 01  JSL $01EEC5
02/EC24: A2 10 00     LDX #$0010
02/EC27: 20 A0 C8     JSR $C8A0       ; wait
02/EC2A: 9C 87 EF     STZ $EF87
02/EC2D: 4C 0D F3     JMP $F30D
02/EC30: 20 47 E7     JSR $E747
02/EC33: A9 18        LDA #$18
02/EC35: 20 5D E7     JSR $E75D
02/EC38: A2 04 00     LDX #$0004
02/EC3B: A9 80        LDA #$80
02/EC3D: 20 32 E7     JSR $E732
02/EC40: E8           INX 
02/EC41: E0 08 00     CPX #$0008
02/EC44: D0 F5        BNE $EC3B
02/EC46: 20 F3 F2     JSR $F2F3
02/EC49: A9 04        LDA #$04
02/EC4B: 8D A0 F2     STA $F2A0
02/EC4E: 60           RTS 
; $29: 
02/EC4F: 20 30 EC     JSR $EC30
02/EC52: 20 16 F3     JSR $F316
02/EC55: 20 30 EC     JSR $EC30
02/EC58: 4C 2D F3     JMP $F32D
02/EC5B: A9 0A        LDA #$0A
02/EC5D: 8D 7F F4     STA $F47F
02/EC60: 22 79 E5 01  JSL $01E579
02/EC64: A9 FF        LDA #$FF
02/EC66: 8D 7F F4     STA $F47F
02/EC69: 60           RTS 
; $25: 
02/EC6A: 20 F3 F2     JSR $F2F3
02/EC6D: EE A0 F2     INC $F2A0
02/EC70: AD C4 34     LDA $34C4
02/EC73: 8D 62 F4     STA $F462
02/EC76: AD C5 34     LDA $34C5
02/EC79: 0D 22 35     ORA $3522
02/EC7C: 8D 63 F4     STA $F463
02/EC7F: 20 5B EC     JSR $EC5B
02/EC82: 20 16 F3     JSR $F316
02/EC85: AD 22 35     LDA $3522
02/EC88: F0 14        BEQ $EC9E
02/EC8A: AD C4 34     LDA $34C4
02/EC8D: 49 80        EOR #$80
02/EC8F: 8D 62 F4     STA $F462
02/EC92: AD 23 35     LDA $3523
02/EC95: 8D 63 F4     STA $F463
02/EC98: 20 5B EC     JSR $EC5B
02/EC9B: 20 2D F3     JSR $F32D
02/EC9E: 60           RTS 
; $24: 
02/EC9F: 22 B5 FC 01  JSL $01FCB5
02/ECA3: 60           RTS 
; $26: 
02/ECA4: 20 6D C4     JSR $C46D
02/ECA7: 22 B6 FC 01  JSL $01FCB6
02/ECAB: 60           RTS 
; $28: 
02/ECAC: AE C4 34     LDX $34C4
02/ECAF: DA           PHX 
02/ECB0: AD C2 34     LDA $34C2
02/ECB3: 8D C4 34     STA $34C4
02/ECB6: AD C3 34     LDA $34C3
02/ECB9: AA           TAX 
02/ECBA: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/ECBE: 8D C5 34     STA $34C5
02/ECC1: 20 0D F3     JSR $F30D
02/ECC4: FA           PLX 
02/ECC5: 8E C4 34     STX $34C4
02/ECC8: 60           RTS 
; $23: 
02/ECC9: 20 F3 F2     JSR $F2F3
02/ECCC: A9 03        LDA #$03
02/ECCE: 8D A0 F2     STA $F2A0
02/ECD1: A9 0F        LDA #$0F
02/ECD3: 85 04        STA $04
02/ECD5: 22 26 E8 01  JSL $01E826
02/ECD9: 9C 58 F4     STZ $F458
02/ECDC: A9 01        LDA #$01
02/ECDE: 20 16 F3     JSR $F316
02/ECE1: AD C4 34     LDA $34C4
02/ECE4: 8D 3E F1     STA $F13E
02/ECE7: AD C5 34     LDA $34C5
02/ECEA: F0 04        BEQ $ECF0
02/ECEC: 22 9A E7 01  JSL $01E79A
02/ECF0: 9C 58 F4     STZ $F458
02/ECF3: AD C4 34     LDA $34C4
02/ECF6: 49 80        EOR #$80
02/ECF8: 8D 3E F1     STA $F13E
02/ECFB: 20 2D F3     JSR $F32D
02/ECFE: AD 23 35     LDA $3523
02/ED01: F0 04        BEQ $ED07
02/ED03: 22 9A E7 01  JSL $01E79A
02/ED07: 60           RTS 
; $22: 
02/ED08: 22 22 FD 01  JSL $01FD22
02/ED0C: 60           RTS 

; [  ]

02/ED0D: 48           PHA 
02/ED0E: AD C4 34     LDA $34C4
02/ED11: 29 80        AND #$80
02/ED13: 8D 79 F2     STA $F279
02/ED16: AD C5 34     LDA $34C5
02/ED19: 8D 7A F2     STA $F27A
02/ED1C: 8D 81 F2     STA $F281
02/ED1F: 8D 84 F2     STA $F284
02/ED22: 20 F8 F4     JSR $F4F8
02/ED25: 20 96 F5     JSR $F596
02/ED28: A9 03        LDA #$03
02/ED2A: 8D 81 F2     STA $F281
02/ED2D: 68           PLA 
02/ED2E: 20 24 F5     JSR $F524
02/ED31: EE 2E F4     INC $F42E
02/ED34: 60           RTS 

; [  ]

02/ED35: A9 00        LDA #$00
02/ED37: 20 0D ED     JSR $ED0D
02/ED3A: 20 E7 F5     JSR $F5E7
02/ED3D: 22 9A F5 01  JSL $01F59A
02/ED41: A9 FF        LDA #$FF
02/ED43: 8D 7F F4     STA $F47F
02/ED46: 60           RTS 

; $21: 
02/ED47: AD C5 34     LDA $34C5
02/ED4A: F0 0A        BEQ $ED56
02/ED4C: 20 35 ED     JSR $ED35
02/ED4F: 20 F9 F2     JSR $F2F9
02/ED52: 9C 2E F4     STZ $F42E
02/ED55: 60           RTS 
02/ED56: AD 22 35     LDA $3522
02/ED59: F0 18        BEQ $ED73
02/ED5B: 20 16 F3     JSR $F316
02/ED5E: 20 74 ED     JSR $ED74
02/ED61: 20 35 ED     JSR $ED35
02/ED64: 20 F3 F2     JSR $F2F3
02/ED67: EE A0 F2     INC $F2A0
02/ED6A: 20 92 ED     JSR $ED92
02/ED6D: 20 2D F3     JSR $F32D
02/ED70: 9C 2E F4     STZ $F42E
02/ED73: 60           RTS 
02/ED74: AE C4 34     LDX $34C4
02/ED77: 8E 2F F4     STX $F42F
02/ED7A: AD C4 34     LDA $34C4
02/ED7D: 49 80        EOR #$80
02/ED7F: 8D C4 34     STA $34C4
02/ED82: AD 49 00     LDA $0049
02/ED85: 8D 31 F4     STA $F431
02/ED88: 20 CE ED     JSR $EDCE
02/ED8B: AD 23 35     LDA $3523
02/ED8E: 8D C5 34     STA $34C5
02/ED91: 60           RTS 
02/ED92: AD 31 F4     LDA $F431
02/ED95: 8D 49 00     STA $0049
02/ED98: AE 2F F4     LDX $F42F
02/ED9B: 8E C4 34     STX $34C4
02/ED9E: 60           RTS 
; $20: 
02/ED9F: AD C5 34     LDA $34C5
02/EDA2: F0 05        BEQ $EDA9
02/EDA4: 22 B9 F3 01  JSL $01F3B9
02/EDA8: 60           RTS 
02/EDA9: AD 22 35     LDA $3522
02/EDAC: F0 1F        BEQ $EDCD
02/EDAE: 20 16 F3     JSR $F316
02/EDB1: AD C4 34     LDA $34C4
02/EDB4: 48           PHA 
02/EDB5: 49 80        EOR #$80
02/EDB7: 8D C4 34     STA $34C4
02/EDBA: AD 49 00     LDA $0049
02/EDBD: 48           PHA 
02/EDBE: 20 CE ED     JSR $EDCE
02/EDC1: 22 B9 F3 01  JSL $01F3B9
02/EDC5: 68           PLA 
02/EDC6: 8D 49 00     STA $0049
02/EDC9: 68           PLA 
02/EDCA: 8D C4 34     STA $34C4
02/EDCD: 60           RTS 
02/EDCE: A2 00 00     LDX #$0000
02/EDD1: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/EDD5: CD 23 35     CMP $3523
02/EDD8: F0 09        BEQ $EDE3
02/EDDA: E8           INX 
02/EDDB: E0 08 00     CPX #$0008
02/EDDE: D0 F1        BNE $EDD1
02/EDE0: A2 00 00     LDX #$0000
02/EDE3: 8A           TXA 
02/EDE4: 8D 49 00     STA $0049
02/EDE7: 60           RTS 
02/EDE8: AD C2 34     LDA $34C2
02/EDEB: 29 80        AND #$80
02/EDED: 85 00        STA $00
02/EDEF: 20 26 EE     JSR $EE26
02/EDF2: 4C 22 F3     JMP $F322
; $1F: 
02/EDF5: 20 E8 ED     JSR $EDE8
02/EDF8: AD 48 00     LDA $0048
02/EDFB: 4C E7 E8     JMP $E8E7
; $1E: 
02/EDFE: 22 03 F8 01  JSL $01F803
02/EE02: 60           RTS 
; $1D: 
02/EE03: 20 F5 ED     JSR $EDF5
02/EE06: 4C 16 F3     JMP $F316

02/EE09: AD C5 34     LDA $34C5
02/EE0C: F0 05        BEQ $EE13
02/EE0E: 22 DE F4 01  JSL $01F4DE
02/EE12: 60           RTS 
02/EE13: AD 22 35     LDA $3522
02/EE16: F0 0D        BEQ $EE25
02/EE18: 20 16 F3     JSR $F316
02/EE1B: 20 74 ED     JSR $ED74
02/EE1E: 22 DE F4 01  JSL $01F4DE
02/EE22: 20 92 ED     JSR $ED92
02/EE25: 60           RTS 
02/EE26: AD C3 34     LDA $34C3
02/EE29: AA           TAX 
02/EE2A: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/EE2E: 85 01        STA $01
02/EE30: 60           RTS 
02/EE31: A2 04 00     LDX #$0004
02/EE34: 86 00        STX $00
02/EE36: A9 1C        LDA #$1C
02/EE38: A2 E6 DB     LDX #$DBE6
02/EE3B: 20 3D DA     JSR $DA3D       ; load 3bpp graphics
02/EE3E: A2 80 00     LDX #$0080
02/EE41: 86 00        STX $00
02/EE43: A9 7E        LDA #$7E
02/EE45: A2 E6 DB     LDX #$DBE6
02/EE48: A0 00 06     LDY #$0600
02/EE4B: 20 B2 84     JSR $84B2
02/EE4E: A2 80 00     LDX #$0080
02/EE51: 86 00        STX $00
02/EE53: A9 7E        LDA #$7E
02/EE55: A2 26 DC     LDX #$DC26
02/EE58: A0 00 07     LDY #$0700
02/EE5B: 4C B2 84     JMP $84B2
; $0A: 
02/EE5E: A0 80 E3     LDY #$E380
02/EE61: 20 31 EE     JSR $EE31
02/EE64: 22 71 F3 01  JSL $01F371
02/EE68: 4C 8B BE     JMP $BE8B
; $0B: 
02/EE6B: 22 81 F3 01  JSL $01F381
02/EE6F: 9C A0 F2     STZ $F2A0
02/EE72: 64 00        STZ $00
02/EE74: A9 06        LDA #$06
02/EE76: 8D D0 F2     STA $F2D0
02/EE79: A9 80        LDA #$80
02/EE7B: 85 01        STA $01
02/EE7D: 64 02        STZ $02
02/EE7F: AD 97 F3     LDA $F397
02/EE82: 20 BC F6     JSR $F6BC       ; execute animation script
02/EE85: A9 FF        LDA #$FF
02/EE87: 8D 20 F3     STA $F320
02/EE8A: 9C D0 F2     STZ $F2D0
02/EE8D: 20 0D F3     JSR $F30D
02/EE90: 4C 8B BE     JMP $BE8B
; $0C: 
02/EE93: EE 85 F2     INC $F285
02/EE96: 22 F4 F7 01  JSL $01F7F4
02/EE9A: 4C 8B BE     JMP $BE8B
; $0D: 
02/EE9D: 22 F4 F7 01  JSL $01F7F4
02/EEA1: 4C 8B BE     JMP $BE8B
; $0E: 
02/EEA4: A0 E0 E3     LDY #$E3E0
02/EEA7: 20 31 EE     JSR $EE31
02/EEAA: AE 21 F3     LDX $F321
02/EEAD: DA           PHX 
02/EEAE: A9 08        LDA #$08
02/EEB0: 8D 15 F1     STA $F115
02/EEB3: AE 21 F3     LDX $F321
02/EEB6: 8E 11 F1     STX $F111
02/EEB9: A5 49        LDA $49
02/EEBB: 0A           ASL 
02/EEBC: AA           TAX 
02/EEBD: BD A1 F2     LDA $F2A1,X
02/EEC0: 0A           ASL 
02/EEC1: 0A           ASL 
02/EEC2: 18           CLC 
02/EEC3: 7D 43 F0     ADC $F043,X
02/EEC6: 8D 13 F1     STA $F113
02/EEC9: BD 44 F0     LDA $F044,X
02/EECC: 38           SEC 
02/EECD: E9 10        SBC #$10
02/EECF: 8D 14 F1     STA $F114
02/EED2: 20 C0 E7     JSR $E7C0
02/EED5: 20 F4 EE     JSR $EEF4
02/EED8: 22 88 F3 01  JSL $01F388
02/EEDC: FA           PLX 
02/EEDD: 8E 13 F1     STX $F113
02/EEE0: AE 21 F3     LDX $F321
02/EEE3: 8E 11 F1     STX $F111
02/EEE6: A9 08        LDA #$08
02/EEE8: 8D 15 F1     STA $F115
02/EEEB: 20 C0 E7     JSR $E7C0
02/EEEE: 20 F4 EE     JSR $EEF4
02/EEF1: 4C 8B BE     JMP $BE8B
02/EEF4: 20 13 85     JSR $8513       ; wait one frame
02/EEF7: 20 60 E8     JSR $E860
02/EEFA: B0 09        BCS $EF05
02/EEFC: AE 18 F1     LDX $F118
02/EEFF: 8E 21 F3     STX $F321
02/EF02: 4C F4 EE     JMP $EEF4
02/EF05: 60           RTS 
; $0F: 
02/EF06: 22 84 F8 01  JSL $01F884
02/EF0A: 4C 8B BE     JMP $BE8B
; $10: 
02/EF0D: 22 42 F9 01  JSL $01F942
02/EF11: 4C 8B BE     JMP $BE8B
; $11: 
02/EF14: A9 05        LDA #$05
02/EF16: 8D D0 F2     STA $F2D0
02/EF19: A9 08        LDA #$08
02/EF1B: 8D 26 F3     STA $F326
02/EF1E: 20 0D F3     JSR $F30D
02/EF21: 22 7D FA 01  JSL $01FA7D
02/EF25: 4C 8B BE     JMP $BE8B
; $12: 
02/EF28: 22 53 F9 01  JSL $01F953
02/EF2C: 4C 8B BE     JMP $BE8B
; $13: 
02/EF2F: 22 EB F9 01  JSL $01F9EB
02/EF33: 4C 8B BE     JMP $BE8B
; $14: 
02/EF36: 22 7E FA 01  JSL $01FA7E
02/EF3A: 20 0D F3     JSR $F30D
02/EF3D: 20 07 E7     JSR $E707
02/EF40: 20 8B BE     JSR $BE8B
02/EF43: AD C2 34     LDA $34C2
02/EF46: 29 80        AND #$80
02/EF48: 85 00        STA $00
02/EF4A: 64 01        STZ $01
02/EF4C: A0 00 00     LDY #$0000
02/EF4F: B9 C5 29     LDA $29C5,Y
02/EF52: C9 FF        CMP #$FF
02/EF54: F0 0A        BEQ $EF60
02/EF56: 98           TYA 
02/EF57: AA           TAX 
02/EF58: BF 7E FC 16  LDA $16FC7E,X   ; bit masks
02/EF5C: 05 01        ORA $01
02/EF5E: 85 01        STA $01
02/EF60: C8           INY 
02/EF61: C0 05 00     CPY #$0005
02/EF64: D0 E9        BNE $EF4F
02/EF66: 64 02        STZ $02
02/EF68: A9 3D        LDA #$3D
02/EF6A: 20 BC F6     JSR $F6BC       ; execute animation script
02/EF6D: A9 00        LDA #$00
02/EF6F: 4C DF F5     JMP $F5DF
; $15: 
02/EF72: 22 9F FA 01  JSL $01FA9F
02/EF76: 4C 8B BE     JMP $BE8B
; $16: 
02/EF79: 22 53 FD 01  JSL $01FD53
02/EF7D: 4C 8B BE     JMP $BE8B
; $17-$19
02/EF80: 22 B5 F3 01  JSL $01F3B5
02/EF84: 20 8B BE     JSR $BE8B
02/EF87: 4C 0D F3     JMP $F30D
; $1A:
02/EF8A: 22 88 FD 01  JSL $01FD88
02/EF8E: 4C 8B BE     JMP $BE8B
; $07:
02/EF91: AD C5 34     LDA $34C5
02/EF94: F0 14        BEQ $EFAA
02/EF96: A2 B0 80     LDX #$80B0
02/EF99: 8E 89 F2     STX $F289       ; sprite $B0 is highest priority
02/EF9C: A9 01        LDA #$01
02/EF9E: 8D D0 F2     STA $F2D0
02/EFA1: 20 0D F3     JSR $F30D
02/EFA4: A2 00 00     LDX #$0000
02/EFA7: 8E 89 F2     STX $F289       ; disable sprite priority order shifting
02/EFAA: 60           RTS 
; $08: 
02/EFAB: A9 02        LDA #$02
02/EFAD: 8D D0 F2     STA $F2D0
02/EFB0: 4C 04 F3     JMP $F304
; $09: 
02/EFB3: A9 03        LDA #$03
02/EFB5: 8D D0 F2     STA $F2D0
02/EFB8: 4C 04 F3     JMP $F304
; $04: 
02/EFBB: A9 8C        LDA #$8C
02/EFBD: 4C C2 EF     JMP $EFC2
; $05: 
02/EFC0: A9 E4        LDA #$E4
02/EFC2: 8D 33 F1     STA $F133
02/EFC5: AD C5 34     LDA $34C5
02/EFC8: D0 01        BNE $EFCB
02/EFCA: 60           RTS 
02/EFCB: A9 04        LDA #$04
02/EFCD: 8D D0 F2     STA $F2D0
02/EFD0: A2 60 80     LDX #$8060
02/EFD3: 8E 89 F2     STX $F289       ; sprite $60 is highest priority
02/EFD6: 20 0D F3     JSR $F30D
02/EFD9: A9 8D        LDA #$8D
02/EFDB: 20 3B F6     JSR $F63B
02/EFDE: 22 B9 EE 01  JSL $01EEB9
02/EFE2: A9 02        LDA #$02
02/EFE4: 8D 87 EF     STA $EF87
02/EFE7: 9C D0 F2     STZ $F2D0
02/EFEA: 7B           TDC 
02/EFEB: AA           TAX 
02/EFEC: 9E E6 EB     STZ $EBE6,X
02/EFEF: 9D E7 EB     STA $EBE7,X
02/EFF2: 48           PHA 
02/EFF3: A9 80        LDA #$80
02/EFF5: 9D 06 EC     STA $EC06,X
02/EFF8: 68           PLA 
02/EFF9: 18           CLC 
02/EFFA: 69 10        ADC #$10
02/EFFC: E8           INX 
02/EFFD: E8           INX 
02/EFFE: E0 20 00     CPX #$0020
02/F001: D0 E9        BNE $EFEC
02/F003: A9 A0        LDA #$A0
02/F005: 8D 9F F2     STA $F29F
02/F008: 20 13 85     JSR $8513       ; wait one frame
02/F00B: 20 99 F6     JSR $F699
02/F00E: A2 00 00     LDX #$0000
02/F011: BD E7 EB     LDA $EBE7,X
02/F014: D0 1A        BNE $F030
02/F016: AD C4 34     LDA $34C4
02/F019: 30 0A        BMI $F025
02/F01B: 20 4F FA     JSR $FA4F
02/F01E: 29 7F        AND #$7F
02/F020: 18           CLC 
02/F021: 69 60        ADC #$60
02/F023: 80 03        BRA $F028
02/F025: 20 4F FA     JSR $FA4F
02/F028: 9D E6 EB     STA $EBE6,X
02/F02B: A9 0F        LDA #$0F
02/F02D: 9D 06 EC     STA $EC06,X
02/F030: 8A           TXA 
02/F031: 29 07        AND #$07
02/F033: 18           CLC 
02/F034: 69 03        ADC #$03
02/F036: 85 02        STA $02
02/F038: AD C4 34     LDA $34C4
02/F03B: 10 1A        BPL $F057
02/F03D: A9 3F        LDA #$3F
02/F03F: 85 00        STA $00
02/F041: BD E6 EB     LDA $EBE6,X
02/F044: 38           SEC 
02/F045: E5 02        SBC $02
02/F047: 9D E6 EB     STA $EBE6,X
02/F04A: B0 08        BCS $F054
02/F04C: BD 06 EC     LDA $EC06,X
02/F04F: 09 80        ORA #$80
02/F051: 9D 06 EC     STA $EC06,X
02/F054: 4C 6E F0     JMP $F06E
02/F057: A9 7F        LDA #$7F
02/F059: 85 00        STA $00
02/F05B: BD E6 EB     LDA $EBE6,X
02/F05E: 18           CLC 
02/F05F: 65 02        ADC $02
02/F061: 9D E6 EB     STA $EBE6,X
02/F064: 90 08        BCC $F06E
02/F066: BD 06 EC     LDA $EC06,X
02/F069: 09 80        ORA #$80
02/F06B: 9D 06 EC     STA $EC06,X
02/F06E: BD E7 EB     LDA $EBE7,X
02/F071: 18           CLC 
02/F072: 69 08        ADC #$08
02/F074: 9D E7 EB     STA $EBE7,X
02/F077: E8           INX 
02/F078: E8           INX 
02/F079: E0 20 00     CPX #$0020
02/F07C: D0 93        BNE $F011
02/F07E: A2 00 00     LDX #$0000
02/F081: A0 00 00     LDY #$0000
02/F084: BD 06 EC     LDA $EC06,X
02/F087: 10 0B        BPL $F094
02/F089: A9 F0        LDA #$F0
02/F08B: 99 C0 03     STA $03C0,Y
02/F08E: 99 C1 03     STA $03C1,Y
02/F091: 4C D7 F0     JMP $F0D7
02/F094: DE 06 EC     DEC $EC06,X
02/F097: BD E6 EB     LDA $EBE6,X
02/F09A: 99 C0 03     STA $03C0,Y
02/F09D: BD E7 EB     LDA $EBE7,X
02/F0A0: 38           SEC 
02/F0A1: E9 04        SBC #$04
02/F0A3: 99 C1 03     STA $03C1,Y
02/F0A6: AD 33 F1     LDA $F133
02/F0A9: C9 E4        CMP #$E4
02/F0AB: F0 09        BEQ $F0B6
02/F0AD: AD 13 18     LDA $1813
02/F0B0: 29 02        AND #$02
02/F0B2: 18           CLC 
02/F0B3: 6D 33 F1     ADC $F133
02/F0B6: 99 C2 03     STA $03C2,Y
02/F0B9: AD C0 6C     LDA $6CC0
02/F0BC: F0 14        BEQ $F0D2
02/F0BE: A5 00        LDA $00
02/F0C0: 49 40        EOR #$40
02/F0C2: 99 C3 03     STA $03C3,Y
02/F0C5: BD E6 EB     LDA $EBE6,X
02/F0C8: 49 FF        EOR #$FF
02/F0CA: 38           SEC 
02/F0CB: E9 10        SBC #$10
02/F0CD: 99 C0 03     STA $03C0,Y
02/F0D0: 80 05        BRA $F0D7
02/F0D2: A5 00        LDA $00
02/F0D4: 99 C3 03     STA $03C3,Y
02/F0D7: C8           INY 
02/F0D8: C8           INY 
02/F0D9: C8           INY 
02/F0DA: C8           INY 
02/F0DB: E8           INX 
02/F0DC: E8           INX 
02/F0DD: E0 20 00     CPX #$0020
02/F0E0: D0 A2        BNE $F084
02/F0E2: CE 9F F2     DEC $F29F
02/F0E5: F0 03        BEQ $F0EA
02/F0E7: 4C 08 F0     JMP $F008
02/F0EA: 9C 87 EF     STZ $EF87
02/F0ED: A2 00 00     LDX #$0000
02/F0F0: 8E 89 F2     STX $F289       ; disable sprite priority order shifting
02/F0F3: 60           RTS 
; $03
02/F0F4: AD C5 34     LDA $34C5
02/F0F7: D0 01        BNE $F0FA
02/F0F9: 60           RTS 
02/F0FA: 20 E7 F5     JSR $F5E7
02/F0FD: 20 07 E7     JSR $E707
02/F100: 22 D3 ED 01  JSL $01EDD3
02/F104: A2 05 00     LDX #$0005
02/F107: A9 27        LDA #$27
02/F109: 20 79 91     JSR $9179
02/F10C: 20 47 E7     JSR $E747
02/F10F: 7B           TDC 
02/F110: AA           TAX 
02/F111: 8E 11 F1     STX $F111
02/F114: 8E 13 F1     STX $F113
02/F117: 20 5D E7     JSR $E75D
02/F11A: A9 60        LDA #$60
02/F11C: 8F 07 21 00  STA $002107
02/F120: A9 58        LDA #$58
02/F122: 8F 08 21 00  STA $002108
02/F126: A9 03        LDA #$03
02/F128: 8D B5 F1     STA $F1B5
02/F12B: 1A           INC 
02/F12C: 8D B3 F1     STA $F1B3
02/F12F: AD 4E ED     LDA $ED4E
02/F132: 29 BF        AND #$BF
02/F134: 8D 4E ED     STA $ED4E       ; disable monster flying animation
02/F137: 7B           TDC 
02/F138: 20 02 83     JSR $8302       ; set monster hdma v-scroll value
02/F13B: 20 D2 AB     JSR $ABD2
02/F13E: 20 13 85     JSR $8513       ; wait one frame
02/F141: 20 FB F1     JSR $F1FB
02/F144: AD 11 F1     LDA $F111
02/F147: 18           CLC 
02/F148: 69 04        ADC #$04
02/F14A: 8D 11 F1     STA $F111
02/F14D: 8D 33 F1     STA $F133
02/F150: AD 13 F1     LDA $F113
02/F153: 18           CLC 
02/F154: 69 08        ADC #$08
02/F156: 8D 13 F1     STA $F113
02/F159: 8D 34 F1     STA $F134
02/F15C: A0 00 00     LDY #$0000
02/F15F: A2 00 00     LDX #$0000
02/F162: 20 7E E7     JSR $E77E
02/F165: 99 14 76     STA $7614,Y
02/F168: 99 94 76     STA $7694,Y
02/F16B: 99 14 77     STA $7714,Y
02/F16E: 99 94 77     STA $7794,Y
02/F171: 99 14 78     STA $7814,Y
02/F174: A2 01 00     LDX #$0001
02/F177: 20 7E E7     JSR $E77E
02/F17A: 48           PHA 
02/F17B: 48           PHA 
02/F17C: 99 12 76     STA $7612,Y
02/F17F: 99 92 76     STA $7692,Y
02/F182: 99 12 77     STA $7712,Y
02/F185: 99 92 77     STA $7792,Y
02/F188: 99 12 78     STA $7812,Y
02/F18B: 68           PLA 
02/F18C: 30 03        BMI $F191
02/F18E: 7B           TDC 
02/F18F: 80 02        BRA $F193
02/F191: A9 01        LDA #$01
02/F193: 99 13 76     STA $7613,Y
02/F196: 99 93 76     STA $7693,Y
02/F199: 99 13 77     STA $7713,Y
02/F19C: 99 93 77     STA $7793,Y
02/F19F: 99 13 78     STA $7813,Y
02/F1A2: 68           PLA 
02/F1A3: 99 92 79     STA $7992,Y
02/F1A6: 99 12 7A     STA $7A12,Y
02/F1A9: 99 92 7A     STA $7A92,Y
02/F1AC: 99 12 7B     STA $7B12,Y
02/F1AF: C0 30 00     CPY #$0030
02/F1B2: B0 03        BCS $F1B7
02/F1B4: 99 92 7B     STA $7B92,Y
02/F1B7: AD 33 F1     LDA $F133
02/F1BA: 18           CLC 
02/F1BB: 69 08        ADC #$08
02/F1BD: 8D 33 F1     STA $F133
02/F1C0: AD 34 F1     LDA $F134
02/F1C3: 18           CLC 
02/F1C4: 69 08        ADC #$08
02/F1C6: 8D 34 F1     STA $F134
02/F1C9: C8           INY 
02/F1CA: C8           INY 
02/F1CB: C8           INY 
02/F1CC: C8           INY 
02/F1CD: C0 80 00     CPY #$0080
02/F1D0: F0 03        BEQ $F1D5
02/F1D2: 4C 5F F1     JMP $F15F
02/F1D5: AD 12 F1     LDA $F112
02/F1D8: 4A           LSR 
02/F1D9: 4A           LSR 
02/F1DA: 4A           LSR 
02/F1DB: 8D B4 F1     STA $F1B4
02/F1DE: AD 11 F1     LDA $F111
02/F1E1: 8D 33 F1     STA $F133
02/F1E4: AD 13 F1     LDA $F113
02/F1E7: 8D 34 F1     STA $F134
02/F1EA: EE 12 F1     INC $F112
02/F1ED: AD 12 F1     LDA $F112
02/F1F0: C9 64        CMP #$64
02/F1F2: F0 03        BEQ $F1F7
02/F1F4: 4C 3E F1     JMP $F13E
02/F1F7: EE 25 F4     INC $F425
02/F1FA: 60           RTS 

; [  ]

02/F1FB: AD 12 F1     LDA $F112
02/F1FE: 29 40        AND #$40
02/F200: F0 23        BEQ $F225
02/F202: A2 00 00     LDX #$0000
02/F205: BD 70 ED     LDA $ED70,X
02/F208: 85 00        STA $00
02/F20A: BD 71 ED     LDA $ED71,X
02/F20D: 85 01        STA $01
02/F20F: A9 01        LDA #$01
02/F211: 20 43 BD     JSR $BD43
02/F214: A5 00        LDA $00
02/F216: 9D 70 ED     STA $ED70,X
02/F219: A5 01        LDA $01
02/F21B: 9D 71 ED     STA $ED71,X
02/F21E: E8           INX 
02/F21F: E8           INX 
02/F220: E0 C0 00     CPX #$00C0
02/F223: D0 E0        BNE $F205
02/F225: 60           RTS 

; [  ]

02/F226: AD 87 F4     LDA $F487
02/F229: F0 01        BEQ $F22C
02/F22B: 60           RTS 
02/F22C: EE 87 F4     INC $F487
02/F22F: A2 00 00     LDX #$0000
02/F232: BD 70 ED     LDA $ED70,X
02/F235: 9D C4 F3     STA $F3C4,X
02/F238: E8           INX 
02/F239: E0 40 00     CPX #$0040
02/F23C: D0 F4        BNE $F232
02/F23E: AD 02 18     LDA $1802       ; battle bg id
02/F241: 29 1F        AND #$1F
02/F243: AA           TAX 
02/F244: BF ED FF 0D  LDA $0DFFED,X
02/F248: AA           TAX 
02/F249: 20 13 85     JSR $8513       ; wait one frame
02/F24C: 20 53 F2     JSR $F253
02/F24F: CA           DEX 
02/F250: D0 F7        BNE $F249
02/F252: 60           RTS 

; [  ]

02/F253: DA           PHX 
02/F254: A2 00 00     LDX #$0000
02/F257: BD 70 ED     LDA $ED70,X
02/F25A: 85 00        STA $00
02/F25C: BD 71 ED     LDA $ED71,X
02/F25F: 85 01        STA $01
02/F261: A9 01        LDA #$01
02/F263: 20 43 BD     JSR $BD43
02/F266: A5 00        LDA $00
02/F268: 9D 70 ED     STA $ED70,X
02/F26B: A5 01        LDA $01
02/F26D: 9D 71 ED     STA $ED71,X
02/F270: E8           INX 
02/F271: E8           INX 
02/F272: E0 40 00     CPX #$0040
02/F275: D0 E0        BNE $F257
02/F277: FA           PLX 
02/F278: 60           RTS 

; [  ]

02/F279: AD 87 F4     LDA $F487
02/F27C: D0 01        BNE $F27F
02/F27E: 60           RTS 
02/F27F: 9C 87 F4     STZ $F487
02/F282: AD 02 18     LDA $1802       ; battle bg id
02/F285: 29 1F        AND #$1F
02/F287: AA           TAX 
02/F288: BF ED FF 0D  LDA $0DFFED,X
02/F28C: AA           TAX 
02/F28D: 20 13 85     JSR $8513       ; wait one frame
02/F290: 8A           TXA 
02/F291: 85 02        STA $02
02/F293: 20 A9 F2     JSR $F2A9
02/F296: CA           DEX 
02/F297: D0 F4        BNE $F28D
02/F299: A2 00 00     LDX #$0000
02/F29C: BD C4 F3     LDA $F3C4,X
02/F29F: 9D 70 ED     STA $ED70,X
02/F2A2: E8           INX 
02/F2A3: E0 40 00     CPX #$0040
02/F2A6: D0 F4        BNE $F29C
02/F2A8: 60           RTS 

; [  ]

02/F2A9: DA           PHX 
02/F2AA: A2 00 00     LDX #$0000
02/F2AD: BD C4 F3     LDA $F3C4,X
02/F2B0: 85 00        STA $00
02/F2B2: BD C5 F3     LDA $F3C5,X
02/F2B5: 85 01        STA $01
02/F2B7: A5 02        LDA $02
02/F2B9: 20 43 BD     JSR $BD43
02/F2BC: A5 00        LDA $00
02/F2BE: 9D 70 ED     STA $ED70,X
02/F2C1: A5 01        LDA $01
02/F2C3: 9D 71 ED     STA $ED71,X
02/F2C6: E8           INX 
02/F2C7: E8           INX 
02/F2C8: E0 40 00     CPX #$0040
02/F2CB: D0 E0        BNE $F2AD
02/F2CD: FA           PLX 
02/F2CE: 60           RTS 

; [  ]

02/F2CF: A2 00 00     LDX #$0000
02/F2D2: BD B0 ED     LDA $EDB0,X
02/F2D5: 85 00        STA $00
02/F2D7: BD B1 ED     LDA $EDB1,X
02/F2DA: 85 01        STA $01
02/F2DC: A9 01        LDA #$01
02/F2DE: 20 43 BD     JSR $BD43
02/F2E1: A5 00        LDA $00
02/F2E3: 9D B0 ED     STA $EDB0,X
02/F2E6: A5 01        LDA $01
02/F2E8: 9D B1 ED     STA $EDB1,X
02/F2EB: E8           INX 
02/F2EC: E8           INX 
02/F2ED: E0 80 00     CPX #$0080
02/F2F0: D0 E0        BNE $F2D2
02/F2F2: 6B           RTL 

; [  ]

02/F2F3: A9 01        LDA #$01
02/F2F5: 8D A0 F2     STA $F2A0
02/F2F8: 60           RTS 

; [  ]

02/F2F9: 20 F3 F2     JSR $F2F3
02/F2FC: EE A0 F2     INC $F2A0
02/F2FF: A9 01        LDA #$01
02/F301: 4C 10 F3     JMP $F310

; [  ]

02/F304: 20 F3 F2     JSR $F2F3
02/F307: 4C 10 F3     JMP $F310

; $1B:
02/F30A: EE 85 F2     INC $F285
02/F30D: 9C A0 F2     STZ $F2A0
02/F310: 20 16 F3     JSR $F316
02/F313: 4C 2D F3     JMP $F32D
; $1C: 
02/F316: AD C4 34     LDA $34C4
02/F319: 29 80        AND #$80
02/F31B: 85 00        STA $00
02/F31D: AD C5 34     LDA $34C5
02/F320: 85 01        STA $01
02/F322: AD 22 35     LDA $3522
02/F325: 85 02        STA $02
02/F327: AD 97 F3     LDA $F397
02/F32A: 4C BC F6     JMP $F6BC       ; execute animation script

; [  ]

02/F32D: AD C4 34     LDA $34C4
02/F330: 29 80        AND #$80
02/F332: 49 80        EOR #$80
02/F334: 85 00        STA $00
02/F336: AD 23 35     LDA $3523
02/F339: 85 01        STA $01
02/F33B: 64 02        STZ $02
02/F33D: AD 97 F3     LDA $F397
02/F340: 4C BC F6     JMP $F6BC       ; execute animation script

; [  ]

02/F343: AD 4E F2     LDA $F24E
02/F346: 0A           ASL 
02/F347: 0A           ASL 
02/F348: 0A           ASL 
02/F349: 85 26        STA $26
02/F34B: A5 2D        LDA $2D
02/F34D: 38           SEC 
02/F34E: E5 26        SBC $26
02/F350: 85 2D        STA $2D
02/F352: 60           RTS 

; [  ]

02/F353: AD 4E F2     LDA $F24E
02/F356: 0A           ASL 
02/F357: 0A           ASL 
02/F358: 0A           ASL 
02/F359: 18           CLC 
02/F35A: 65 2D        ADC $2D
02/F35C: 85 2D        STA $2D
02/F35E: 60           RTS 

; [  ]

02/F35F: 7B           TDC 
02/F360: AA           TAX 
02/F361: 9D 8F F2     STA $F28F,X
02/F364: E8           INX 
02/F365: E0 10 00     CPX #$0010
02/F368: D0 F7        BNE $F361
02/F36A: AD D0 F2     LDA $F2D0
02/F36D: C9 06        CMP #$06
02/F36F: D0 13        BNE $F384
02/F371: A2 8F F2     LDX #$F28F
02/F374: 86 08        STX $08
02/F376: A9 80        LDA #$80
02/F378: 8D 7A F2     STA $F27A
02/F37B: A9 C8        LDA #$C8
02/F37D: 85 2C        STA $2C
02/F37F: A9 54        LDA #$54
02/F381: 85 2D        STA $2D
02/F383: 60           RTS 
02/F384: A7 02        LDA [$02]
02/F386: 29 F0        AND #$F0
02/F388: C9 D0        CMP #$D0
02/F38A: F0 08        BEQ $F394
02/F38C: C9 E0        CMP #$E0
02/F38E: F0 04        BEQ $F394
02/F390: C9 30        CMP #$30
02/F392: D0 1C        BNE $F3B0
02/F394: A9 44        LDA #$44
02/F396: 85 2D        STA $2D
02/F398: A2 8F F2     LDX #$F28F
02/F39B: 86 08        STX $08
02/F39D: A9 80        LDA #$80
02/F39F: 8D 7A F2     STA $F27A
02/F3A2: A5 00        LDA $00
02/F3A4: D0 05        BNE $F3AB
02/F3A6: A9 D8        LDA #$D8
02/F3A8: 85 2C        STA $2C
02/F3AA: 60           RTS 
02/F3AB: A9 60        LDA #$60
02/F3AD: 85 2C        STA $2C
02/F3AF: 60           RTS 
02/F3B0: C9 40        CMP #$40
02/F3B2: D0 1A        BNE $F3CE
02/F3B4: AD 9A F4     LDA $F49A
02/F3B7: C9 91        CMP #$91
02/F3B9: F0 2A        BEQ $F3E5
02/F3BB: A9 60        LDA #$60
02/F3BD: 85 2C        STA $2C
02/F3BF: A9 44        LDA #$44
02/F3C1: 85 2D        STA $2D
02/F3C3: A2 8F F2     LDX #$F28F
02/F3C6: 86 08        STX $08
02/F3C8: A9 80        LDA #$80
02/F3CA: 8D 7A F2     STA $F27A
02/F3CD: 60           RTS 
02/F3CE: C9 50        CMP #$50
02/F3D0: D0 13        BNE $F3E5
02/F3D2: A9 80        LDA #$80
02/F3D4: 85 2C        STA $2C
02/F3D6: A9 44        LDA #$44
02/F3D8: 85 2D        STA $2D
02/F3DA: A2 8F F2     LDX #$F28F
02/F3DD: 86 08        STX $08
02/F3DF: A9 80        LDA #$80
02/F3E1: 8D 7A F2     STA $F27A
02/F3E4: 60           RTS 
02/F3E5: A0 01 00     LDY #$0001
02/F3E8: B7 02        LDA [$02],Y
02/F3EA: 29 60        AND #$60
02/F3EC: D0 22        BNE $F410
02/F3EE: A5 00        LDA $00
02/F3F0: D0 11        BNE $F403
02/F3F2: 64 2D        STZ $2D
02/F3F4: A9 18        LDA #$18
02/F3F6: 85 2C        STA $2C
02/F3F8: A9 01        LDA #$01
02/F3FA: 8D 61 F2     STA $F261
02/F3FD: A2 53 F0     LDX #$F053
02/F400: 4C 94 F4     JMP $F494
02/F403: 7B           TDC 
02/F404: AA           TAX 
02/F405: 86 2C        STX $2C
02/F407: 8D 61 F2     STA $F261
02/F40A: A2 43 F0     LDX #$F043
02/F40D: 4C 94 F4     JMP $F494
02/F410: C9 40        CMP #$40
02/F412: D0 2A        BNE $F43E
02/F414: A5 00        LDA $00
02/F416: D0 15        BNE $F42D
02/F418: A9 F4        LDA #$F4
02/F41A: 85 2D        STA $2D
02/F41C: A9 17        LDA #$17
02/F41E: 85 2C        STA $2C
02/F420: 20 53 F3     JSR $F353
02/F423: A9 01        LDA #$01
02/F425: 8D 61 F2     STA $F261
02/F428: A2 39 F0     LDX #$F039
02/F42B: 80 67        BRA $F494
02/F42D: A2 00 00     LDX #$0000
02/F430: 86 2C        STX $2C
02/F432: 20 53 F3     JSR $F353
02/F435: 7B           TDC 
02/F436: 8D 61 F2     STA $F261
02/F439: A2 29 F0     LDX #$F029
02/F43C: 80 56        BRA $F494
02/F43E: C9 60        CMP #$60
02/F440: D0 2B        BNE $F46D
02/F442: A5 00        LDA $00
02/F444: D0 15        BNE $F45B
02/F446: A9 E8        LDA #$E8
02/F448: 85 2D        STA $2D
02/F44A: A9 17        LDA #$17
02/F44C: 85 2C        STA $2C
02/F44E: 20 53 F3     JSR $F353
02/F451: A9 01        LDA #$01
02/F453: 8D 61 F2     STA $F261
02/F456: A2 39 F0     LDX #$F039
02/F459: 80 39        BRA $F494
02/F45B: 64 2C        STZ $2C
02/F45D: A9 F0        LDA #$F0
02/F45F: 85 2D        STA $2D
02/F461: 20 53 F3     JSR $F353
02/F464: 7B           TDC 
02/F465: 8D 61 F2     STA $F261
02/F468: A2 29 F0     LDX #$F029
02/F46B: 80 27        BRA $F494
02/F46D: A5 00        LDA $00
02/F46F: D0 13        BNE $F484
02/F471: 64 2C        STZ $2C
02/F473: A9 F8        LDA #$F8
02/F475: 85 2D        STA $2D
02/F477: 20 43 F3     JSR $F343
02/F47A: A9 01        LDA #$01
02/F47C: 8D 61 F2     STA $F261
02/F47F: A2 6D F0     LDX #$F06D
02/F482: 80 10        BRA $F494
02/F484: A2 00 00     LDX #$0000
02/F487: 86 2C        STX $2C
02/F489: 20 43 F3     JSR $F343
02/F48C: A9 00        LDA #$00
02/F48E: 8D 61 F2     STA $F261
02/F491: A2 5D F0     LDX #$F05D
02/F494: 86 08        STX $08
02/F496: 60           RTS 

; [  ]

02/F497: 48           PHA 
02/F498: A2 00 00     LDX #$0000
02/F49B: 9D 12 76     STA $7612,X
02/F49E: 9D 9E 76     STA $769E,X
02/F4A1: 9D 2A 77     STA $772A,X
02/F4A4: 9D B6 77     STA $77B6,X
02/F4A7: E8           INX 
02/F4A8: E8           INX 
02/F4A9: E8           INX 
02/F4AA: E8           INX 
02/F4AB: E0 8C 00     CPX #$008C
02/F4AE: D0 EB        BNE $F49B
02/F4B0: 68           PLA 
02/F4B1: 60           RTS 

; [  ]

02/F4B2: 48           PHA 
02/F4B3: AD 02 18     LDA $1802       ; battle bg id
02/F4B6: C9 10        CMP #$10
02/F4B8: D0 02        BNE $F4BC       ; branch if not final battle bg
02/F4BA: 68           PLA 
02/F4BB: 60           RTS 
02/F4BC: 68           PLA 
02/F4BD: A2 00 00     LDX #$0000
02/F4C0: 9D 92 79     STA $7992,X
02/F4C3: 9D 1E 7A     STA $7A1E,X
02/F4C6: 9D AA 7A     STA $7AAA,X
02/F4C9: 9D 36 7B     STA $7B36,X
02/F4CC: E8           INX 
02/F4CD: E8           INX 
02/F4CE: E8           INX 
02/F4CF: E8           INX 
02/F4D0: E0 8C 00     CPX #$008C
02/F4D3: D0 EB        BNE $F4C0
02/F4D5: 60           RTS 

; [  ]

02/F4D6: AD D0 F2     LDA $F2D0
02/F4D9: C9 02        CMP #$02
02/F4DB: F0 05        BEQ $F4E2
02/F4DD: C9 03        CMP #$03
02/F4DF: F0 01        BEQ $F4E2
02/F4E1: 60           RTS 
02/F4E2: A9 FF        LDA #$FF
02/F4E4: 8D 7A F2     STA $F27A
02/F4E7: 7B           TDC 
02/F4E8: A8           TAY 
02/F4E9: 99 51 F2     STA $F251,Y
02/F4EC: C8           INY 
02/F4ED: C0 10 00     CPY #$0010
02/F4F0: D0 F7        BNE $F4E9
02/F4F2: AD A0 F2     LDA $F2A0
02/F4F5: 4C 3A F9     JMP $F93A

; [  ]

02/F4F8: 20 DD E8     JSR $E8DD
02/F4FB: 20 35 8D     JSR $8D35
02/F4FE: A2 00 00     LDX #$0000
02/F501: 0E 81 F2     ASL $F281
02/F504: 90 0E        BCC $F514
02/F506: 8A           TXA 
02/F507: 8D 09 F1     STA $F109
02/F50A: A9 07        LDA #$07
02/F50C: 8D 0A F1     STA $F10A
02/F50F: DA           PHX 
02/F510: 20 89 8A     JSR $8A89
02/F513: FA           PLX 
02/F514: E8           INX 
02/F515: E0 08 00     CPX #$0008
02/F518: D0 E7        BNE $F501
02/F51A: 20 C7 8B     JSR $8BC7
02/F51D: 20 B2 BC     JSR $BCB2
02/F520: 20 E2 E8     JSR $E8E2
02/F523: 60           RTS 

; [  ]

02/F524: 18           CLC 
02/F525: 69 28        ADC #$28
02/F527: 85 26        STA $26
02/F529: A9 10        LDA #$10
02/F52B: 85 28        STA $28
02/F52D: 20 60 85     JSR $8560       ; multiply (8-bit)
02/F530: AD 79 F2     LDA $F279
02/F533: D0 32        BNE $F567
02/F535: AD 84 F2     LDA $F284
02/F538: 85 26        STA $26
02/F53A: A0 00 00     LDY #$0000
02/F53D: 06 26        ASL $26
02/F53F: 90 1F        BCC $F560
02/F541: 5A           PHY 
02/F542: 98           TYA 
02/F543: 0A           ASL 
02/F544: 0A           ASL 
02/F545: 0A           ASL 
02/F546: 0A           ASL 
02/F547: 0A           ASL 
02/F548: A8           TAY 
02/F549: A9 10        LDA #$10
02/F54B: 85 28        STA $28
02/F54D: A6 2A        LDX $2A
02/F54F: BF 00 CB 0E  LDA $0ECB00,X
02/F553: 99 70 EE     STA $EE70,Y
02/F556: 99 80 EE     STA $EE80,Y
02/F559: E8           INX 
02/F55A: C8           INY 
02/F55B: C6 28        DEC $28
02/F55D: D0 F0        BNE $F54F
02/F55F: 7A           PLY 
02/F560: C8           INY 
02/F561: C0 05 00     CPY #$0005
02/F564: D0 D7        BNE $F53D
02/F566: 60           RTS 
02/F567: A0 00 00     LDY #$0000
02/F56A: A6 2A        LDX $2A
02/F56C: BF 00 CB 0E  LDA $0ECB00,X
02/F570: 99 30 EE     STA $EE30,Y
02/F573: 99 40 EE     STA $EE40,Y
02/F576: E8           INX 
02/F577: C8           INY 
02/F578: C0 10 00     CPY #$0010
02/F57B: D0 EF        BNE $F56C
02/F57D: 60           RTS 

; [  ]

02/F57E: AD 79 F2     LDA $F279
02/F581: D0 04        BNE $F587
02/F583: 9C 83 F2     STZ $F283
02/F586: 60           RTS 
02/F587: AD 82 F2     LDA $F282
02/F58A: C9 01        CMP #$01
02/F58C: D0 07        BNE $F595
02/F58E: 9C 82 F2     STZ $F282
02/F591: 7B           TDC 
02/F592: 4C C2 BC     JMP $BCC2       ; clear bg1 h-scroll hdma data
02/F595: 60           RTS 

; [  ]

02/F596: AD 79 F2     LDA $F279
02/F599: D0 06        BNE $F5A1
02/F59B: A9 01        LDA #$01
02/F59D: 8D 83 F2     STA $F283
02/F5A0: 60           RTS 
02/F5A1: AD 82 F2     LDA $F282
02/F5A4: D0 FA        BNE $F5A0
02/F5A6: A9 01        LDA #$01
02/F5A8: 8D 82 F2     STA $F282
02/F5AB: A9 01        LDA #$01
02/F5AD: 4C C2 BC     JMP $BCC2       ; clear bg1 h-scroll hdma data

; [  ]

02/F5B0: 7B           TDC 
02/F5B1: 20 D1 F5     JSR $F5D1
02/F5B4: 6B           RTL 

; [  ]

02/F5B5: AD 13 18     LDA $1813
02/F5B8: 29 07        AND #$07
02/F5BA: AA           TAX 
02/F5BB: BF DD FF 0D  LDA $0DFFDD,X
02/F5BF: 20 97 F4     JSR $F497
02/F5C2: 6B           RTL 

; [  ]

02/F5C3: AD 13 18     LDA $1813
02/F5C6: 29 07        AND #$07
02/F5C8: AA           TAX 
02/F5C9: 20 CD F5     JSR $F5CD
02/F5CC: 6B           RTL 

; [  ]

02/F5CD: BF DD FF 0D  LDA $0DFFDD,X
02/F5D1: 20 97 F4     JSR $F497
02/F5D4: 4C B2 F4     JMP $F4B2

; [  ]

02/F5D7: 20 DF F5     JSR $F5DF
02/F5DA: 6B           RTL 

; [  ]

02/F5DB: 20 E7 F5     JSR $F5E7
02/F5DE: 6B           RTL 

; [  ]

02/F5DF: 8D 7F F4     STA $F47F
02/F5E2: DA           PHX 
02/F5E3: 5A           PHY 
02/F5E4: 4C F5 F5     JMP $F5F5
02/F5E7: DA           PHX 
02/F5E8: 5A           PHY 
02/F5E9: AD 7F F4     LDA $F47F
02/F5EC: C9 FF        CMP #$FF
02/F5EE: F0 33        BEQ $F623
02/F5F0: AA           TAX 
02/F5F1: BF 50 A3 0F  LDA $0FA350,X   ; attack sound effect
02/F5F5: 48           PHA 
02/F5F6: C9 31        CMP #$31
02/F5F8: F0 04        BEQ $F5FE
02/F5FA: C9 33        CMP #$33
02/F5FC: D0 04        BNE $F602
02/F5FE: A9 80        LDA #$80        ; pan center
02/F600: 80 0B        BRA $F60D
02/F602: AD 85 F4     LDA $F485
02/F605: 30 04        BMI $F60B
02/F607: A9 C0        LDA #$C0        ; pan left (toward monsters)
02/F609: 80 02        BRA $F60D
02/F60B: A9 40        LDA #$40        ; pan right (toward characters)
02/F60D: 8D 14 F4     STA $F414       ; sound effect pan
02/F610: 68           PLA 
02/F611: 8D 13 F4     STA $F413       ; sound effect id
02/F614: A9 FF        LDA #$FF
02/F616: 8D 15 F4     STA $F415
02/F619: A9 02        LDA #$02        ; play sound effect
02/F61B: 8D 12 F4     STA $F412
02/F61E: AD 12 F4     LDA $F412       ; wait for sound effect
02/F621: D0 FB        BNE $F61E
02/F623: 7A           PLY 
02/F624: FA           PLX 
02/F625: 60           RTS 

; [  ]

02/F626: 20 3B F6     JSR $F63B
02/F629: 6B           RTL 

; [  ]

02/F62A: 20 2E F6     JSR $F62E
02/F62D: 6B           RTL 

; [  ]

02/F62E: AD 57 F4     LDA $F457
02/F631: A2 0F 00     LDX #$000F
02/F634: 20 79 91     JSR $9179
02/F637: 9C 51 F4     STZ $F451
02/F63A: 60           RTS 

; [  ]

02/F63B: DA           PHX 
02/F63C: 48           PHA 
02/F63D: 29 08        AND #$08
02/F63F: F0 32        BEQ $F673
02/F641: 68           PLA 
02/F642: 48           PHA 
02/F643: 29 F0        AND #$F0
02/F645: D0 06        BNE $F64D
02/F647: 20 2E F6     JSR $F62E
02/F64A: 68           PLA 
02/F64B: FA           PLX 
02/F64C: 60           RTS 
02/F64D: 4A           LSR 
02/F64E: 4A           LSR 
02/F64F: 4A           LSR 
02/F650: AA           TAX 
02/F651: C2 20        REP #$20
02/F653: BF C6 FF 16  LDA $16FFC6,X
02/F657: 8D 55 F4     STA $F455
02/F65A: 7B           TDC 
02/F65B: E2 20        SEP #$20
02/F65D: 68           PLA 
02/F65E: 29 07        AND #$07
02/F660: AA           TAX 
02/F661: BF 78 F6 03  LDA $03F678,X
02/F665: 8D 52 F4     STA $F452
02/F668: EE 51 F4     INC $F451
02/F66B: 9C 53 F4     STZ $F453
02/F66E: 9C 54 F4     STZ $F454
02/F671: FA           PLX 
02/F672: 60           RTS 
02/F673: 68           PLA 
02/F674: 48           PHA 
02/F675: 29 E0        AND #$E0
02/F677: 8D 88 EF     STA $EF88
02/F67A: 68           PLA 
02/F67B: 48           PHA 
02/F67C: A9 1F        LDA #$1F
02/F67E: 8D 35 F4     STA $F435
02/F681: 8D 34 F4     STA $F434
02/F684: 8D 33 F4     STA $F433
02/F687: 9C 8A EF     STZ $EF8A
02/F68A: 9C 89 EF     STZ $EF89
02/F68D: 68           PLA 
02/F68E: 29 07        AND #$07
02/F690: 8D 87 EF     STA $EF87
02/F693: FA           PLX 
02/F694: 60           RTS 

; [  ]

02/F695: 20 99 F6     JSR $F699
02/F698: 6B           RTL 

; [  ]

02/F699: AD 51 F4     LDA $F451
02/F69C: F0 1D        BEQ $F6BB
02/F69E: AD 53 F4     LDA $F453
02/F6A1: 2D 52 F4     AND $F452
02/F6A4: D0 12        BNE $F6B8
02/F6A6: EE 54 F4     INC $F454
02/F6A9: AD 54 F4     LDA $F454
02/F6AC: 29 01        AND #$01
02/F6AE: AA           TAX 
02/F6AF: BD 55 F4     LDA $F455,X
02/F6B2: A2 0F 00     LDX #$000F
02/F6B5: 20 79 91     JSR $9179
02/F6B8: EE 53 F4     INC $F453
02/F6BB: 60           RTS 

; [ execute animation script ]

02/F6BC: 0A           ASL 
02/F6BD: AA           TAX 
02/F6BE: 9C 4E F4     STZ $F44E
02/F6C1: A9 01        LDA #$01
02/F6C3: 8D 61 F2     STA $F261
02/F6C6: A5 02        LDA $02
02/F6C8: 8D 4C F2     STA $F24C
02/F6CB: 85 06        STA $06
02/F6CD: BF E0 D5 0F  LDA $0FD5E0,X   ; pointers to animation scripts
02/F6D1: 85 02        STA $02
02/F6D3: BF E1 D5 0F  LDA $0FD5E1,X
02/F6D7: 85 03        STA $03
02/F6D9: A9 0F        LDA #$0F
02/F6DB: 85 04        STA $04
02/F6DD: 8D 80 F2     STA $F280
02/F6E0: A5 01        LDA $01
02/F6E2: 0D 4C F2     ORA $F24C
02/F6E5: D0 03        BNE $F6EA
02/F6E7: 4C F3 F8     JMP $F8F3
02/F6EA: A5 00        LDA $00
02/F6EC: 8D 85 F4     STA $F485
02/F6EF: 20 E7 F5     JSR $F5E7
02/F6F2: A6 00        LDX $00
02/F6F4: 8E 79 F2     STX $F279
02/F6F7: A5 01        LDA $01
02/F6F9: 8D 81 F2     STA $F281
02/F6FC: 8D 84 F2     STA $F284
02/F6FF: AD D0 F2     LDA $F2D0
02/F702: C9 02        CMP #$02
02/F704: F0 04        BEQ $F70A
02/F706: C9 03        CMP #$03
02/F708: D0 05        BNE $F70F
02/F70A: A9 FF        LDA #$FF
02/F70C: 8D 7A F2     STA $F27A
02/F70F: A6 02        LDX $02
02/F711: E8           INX 
02/F712: E8           INX 
02/F713: 8E 7C F2     STX $F27C
02/F716: A7 02        LDA [$02]
02/F718: 29 F0        AND #$F0
02/F71A: 4A           LSR 
02/F71B: 4A           LSR 
02/F71C: 4A           LSR 
02/F71D: AA           TAX 
02/F71E: BF 3E FF 0D  LDA $0DFF3E,X   ; animation frame sizes
02/F722: 8D 4D F2     STA $F24D
02/F725: BF 3F FF 0D  LDA $0DFF3F,X
02/F729: 8D 4E F2     STA $F24E
02/F72C: A7 02        LDA [$02]
02/F72E: 29 0F        AND #$0F
02/F730: 1A           INC 
02/F731: 8D 7B F2     STA $F27B
02/F734: 20 5F F3     JSR $F35F
02/F737: A0 00 00     LDY #$0000
02/F73A: B1 08        LDA ($08),Y
02/F73C: 18           CLC 
02/F73D: 65 2C        ADC $2C
02/F73F: 99 51 F2     STA $F251,Y
02/F742: C8           INY 
02/F743: B1 08        LDA ($08),Y
02/F745: 18           CLC 
02/F746: 65 2D        ADC $2D
02/F748: 99 51 F2     STA $F251,Y
02/F74B: C8           INY 
02/F74C: C0 10 00     CPY #$0010
02/F74F: D0 E9        BNE $F73A
02/F751: A2 00 00     LDX #$0000
02/F754: 9E 68 F2     STZ $F268,X
02/F757: E8           INX 
02/F758: E0 10 00     CPX #$0010
02/F75B: D0 F7        BNE $F754
02/F75D: 20 D6 F4     JSR $F4D6
02/F760: A0 01 00     LDY #$0001
02/F763: B7 02        LDA [$02],Y
02/F765: 29 18        AND #$18
02/F767: 4A           LSR 
02/F768: 4A           LSR 
02/F769: 4A           LSR 
02/F76A: AA           TAX 
02/F76B: BF D9 FF 0D  LDA $0DFFD9,X
02/F76F: 8D 9F F2     STA $F29F
02/F772: A0 01 00     LDY #$0001
02/F775: B7 02        LDA [$02],Y
02/F777: 10 03        BPL $F77C
02/F779: 9C 61 F2     STZ $F261
02/F77C: B7 02        LDA [$02],Y
02/F77E: 29 07        AND #$07
02/F780: 8D 49 F2     STA $F249
02/F783: A9 10        LDA #$10
02/F785: 8D 4F F2     STA $F24F
02/F788: 8D 50 F2     STA $F250
02/F78B: 20 07 E7     JSR $E707
02/F78E: 9C 7E F2     STZ $F27E
02/F791: 9C 7F F2     STZ $F27F
02/F794: 9C 4A F2     STZ $F24A
02/F797: 9C 4B F2     STZ $F24B
02/F79A: 20 F8 F4     JSR $F4F8
02/F79D: A2 00 00     LDX #$0000
02/F7A0: 8E 81 F2     STX $F281
02/F7A3: 20 13 85     JSR $8513       ; wait one frame
02/F7A6: 20 99 F6     JSR $F699
02/F7A9: AD 7E F2     LDA $F27E
02/F7AC: 2D 9F F2     AND $F29F
02/F7AF: D0 0B        BNE $F7BC
02/F7B1: AD A0 F2     LDA $F2A0
02/F7B4: C9 03        CMP #$03
02/F7B6: D0 04        BNE $F7BC
02/F7B8: 22 5D E8 01  JSL $01E85D
02/F7BC: AD A0 F2     LDA $F2A0
02/F7BF: C9 04        CMP #$04
02/F7C1: D0 04        BNE $F7C7
02/F7C3: 22 F8 FE 01  JSL $01FEF8
02/F7C7: AD 81 F2     LDA $F281
02/F7CA: F0 21        BEQ $F7ED
02/F7CC: C9 03        CMP #$03
02/F7CE: F0 1D        BEQ $F7ED
02/F7D0: C9 01        CMP #$01
02/F7D2: F0 05        BEQ $F7D9
02/F7D4: A9 04        LDA #$04
02/F7D6: 4C DB F7     JMP $F7DB
02/F7D9: A9 02        LDA #$02
02/F7DB: 85 00        STA $00
02/F7DD: AD 13 18     LDA $1813
02/F7E0: 25 00        AND $00
02/F7E2: F0 06        BEQ $F7EA
02/F7E4: 20 96 F5     JSR $F596
02/F7E7: 4C ED F7     JMP $F7ED
02/F7EA: 20 7E F5     JSR $F57E
02/F7ED: AD D0 F2     LDA $F2D0
02/F7F0: F0 2D        BEQ $F81F
02/F7F2: C9 01        CMP #$01
02/F7F4: D0 21        BNE $F817
02/F7F6: AD 7E F2     LDA $F27E
02/F7F9: 29 07        AND #$07
02/F7FB: AA           TAX 
02/F7FC: AD 79 F2     LDA $F279
02/F7FF: D0 10        BNE $F811
02/F801: BF DD FF 0D  LDA $0DFFDD,X
02/F805: 8D 68 F2     STA $F268
02/F808: 20 B2 F4     JSR $F4B2
02/F80B: 20 58 FA     JSR $FA58
02/F80E: 4C 1F F8     JMP $F81F
02/F811: 20 CD F5     JSR $F5CD
02/F814: 4C 1F F8     JMP $F81F
02/F817: C9 05        CMP #$05
02/F819: D0 04        BNE $F81F
02/F81B: 22 13 F3 01  JSL $01F313
02/F81F: EE 7E F2     INC $F27E
02/F822: AC 7C F2     LDY $F27C
02/F825: 84 02        STY $02
02/F827: AD 80 F2     LDA $F280
02/F82A: 85 04        STA $04
02/F82C: AD 7F F2     LDA $F27F
02/F82F: A8           TAY 
02/F830: B7 02        LDA [$02],Y
02/F832: C9 FF        CMP #$FF
02/F834: D0 03        BNE $F839
02/F836: 4C C8 F8     JMP $F8C8
02/F839: B7 02        LDA [$02],Y
02/F83B: 30 03        BMI $F840
02/F83D: 4C AA F8     JMP $F8AA
02/F840: 85 06        STA $06
02/F842: C9 88        CMP #$88
02/F844: D0 0F        BNE $F855
02/F846: EE 7F F2     INC $F27F
02/F849: C8           INY 
02/F84A: B7 02        LDA [$02],Y
02/F84C: EE 4E F4     INC $F44E
02/F84F: 20 3B F6     JSR $F63B
02/F852: 4C 78 F8     JMP $F878
02/F855: 29 08        AND #$08
02/F857: F0 25        BEQ $F87E
02/F859: 29 04        AND #$04
02/F85B: F0 06        BEQ $F863
02/F85D: 20 7E F5     JSR $F57E
02/F860: 4C 78 F8     JMP $F878
02/F863: A5 06        LDA $06
02/F865: 48           PHA 
02/F866: 4A           LSR 
02/F867: 4A           LSR 
02/F868: 4A           LSR 
02/F869: 4A           LSR 
02/F86A: 29 07        AND #$07
02/F86C: 20 24 F5     JSR $F524
02/F86F: 68           PLA 
02/F870: 29 03        AND #$03
02/F872: 8D 81 F2     STA $F281
02/F875: 20 96 F5     JSR $F596
02/F878: EE 7F F2     INC $F27F
02/F87B: 4C 22 F8     JMP $F822
02/F87E: A5 06        LDA $06
02/F880: 4A           LSR 
02/F881: 4A           LSR 
02/F882: 4A           LSR 
02/F883: 4A           LSR 
02/F884: 29 07        AND #$07
02/F886: 0A           ASL 
02/F887: AA           TAX 
02/F888: A5 06        LDA $06
02/F88A: 29 07        AND #$07
02/F88C: 1A           INC 
02/F88D: 85 08        STA $08
02/F88F: 20 78 FA     JSR $FA78
02/F892: AD 4A F2     LDA $F24A
02/F895: 18           CLC 
02/F896: 65 06        ADC $06
02/F898: 8D 4A F2     STA $F24A
02/F89B: AD 4B F2     LDA $F24B
02/F89E: 18           CLC 
02/F89F: 65 07        ADC $07
02/F8A1: 8D 4B F2     STA $F24B
02/F8A4: EE 7F F2     INC $F27F
02/F8A7: 4C 22 F8     JMP $F822
02/F8AA: 29 7F        AND #$7F
02/F8AC: 8D 48 F2     STA $F248
02/F8AF: AD 7A F2     LDA $F27A
02/F8B2: 8D 62 F2     STA $F262
02/F8B5: A9 01        LDA #$01
02/F8B7: 8D 47 F2     STA $F247
02/F8BA: AD 7E F2     LDA $F27E
02/F8BD: 2D 9F F2     AND $F29F
02/F8C0: D0 03        BNE $F8C5
02/F8C2: EE 7F F2     INC $F27F
02/F8C5: 4C A3 F7     JMP $F7A3
02/F8C8: 9C 7F F2     STZ $F27F
02/F8CB: AD A0 F2     LDA $F2A0
02/F8CE: F0 03        BEQ $F8D3
02/F8D0: 20 3A F9     JSR $F93A
02/F8D3: CE 7B F2     DEC $F27B
02/F8D6: F0 03        BEQ $F8DB
02/F8D8: 4C A3 F7     JMP $F7A3
02/F8DB: AD 85 F2     LDA $F285
02/F8DE: D0 03        BNE $F8E3
02/F8E0: 20 7E F5     JSR $F57E
02/F8E3: 20 F3 F8     JSR $F8F3
02/F8E6: AD 84 F2     LDA $F284
02/F8E9: 8D 67 F4     STA $F467
02/F8EC: 20 69 D0     JSR $D069
02/F8EF: 7B           TDC 
02/F8F0: 4C D1 F5     JMP $F5D1

; [  ]

02/F8F3: 7B           TDC 
02/F8F4: 8D 2E F4     STA $F42E
02/F8F7: 8D C7 EF     STA $EFC7
02/F8FA: 8D D7 EF     STA $EFD7
02/F8FD: 8D E7 EF     STA $EFE7
02/F900: 8D F7 EF     STA $EFF7
02/F903: 8D 07 F0     STA $F007
02/F906: 8D 81 F2     STA $F281
02/F909: 8D 83 F2     STA $F283
02/F90C: 8D 51 F4     STA $F451
02/F90F: AD 4E F4     LDA $F44E
02/F912: F0 03        BEQ $F917
02/F914: 9C 87 EF     STZ $EF87
02/F917: AD 79 F2     LDA $F279
02/F91A: 8D 66 F4     STA $F466
02/F91D: 60           RTS 

; [  ]

02/F91E: AD 13 18     LDA $1813
02/F921: AA           TAX 
02/F922: A0 00 00     LDY #$0000
02/F925: BD 00 19     LDA $1900,X     ; rng table
02/F928: 29 0F        AND #$0F
02/F92A: 38           SEC 
02/F92B: E9 06        SBC #$06
02/F92D: 99 B0 F3     STA $F3B0,Y
02/F930: E8           INX 
02/F931: 8A           TXA 
02/F932: AA           TAX 
02/F933: C8           INY 
02/F934: C0 12 00     CPY #$0012
02/F937: D0 EC        BNE $F925
02/F939: 60           RTS 

; [  ]

02/F93A: C9 03        CMP #$03
02/F93C: F0 04        BEQ $F942
02/F93E: C9 04        CMP #$04
02/F940: D0 01        BNE $F943
02/F942: 60           RTS 
02/F943: C9 02        CMP #$02
02/F945: D0 03        BNE $F94A
02/F947: 4C 1E F9     JMP $F91E
02/F94A: AD D0 F2     LDA $F2D0
02/F94D: C9 02        CMP #$02
02/F94F: D0 24        BNE $F975
02/F951: A2 00 00     LDX #$0000
02/F954: A9 20        LDA #$20
02/F956: 85 00        STA $00
02/F958: A9 20        LDA #$20
02/F95A: 20 42 FA     JSR $FA42
02/F95D: 18           CLC 
02/F95E: 69 D0        ADC #$D0
02/F960: 9D 68 F2     STA $F268,X
02/F963: A5 00        LDA $00
02/F965: 9D 69 F2     STA $F269,X
02/F968: 18           CLC 
02/F969: 69 0C        ADC #$0C
02/F96B: 85 00        STA $00
02/F96D: E8           INX 
02/F96E: E8           INX 
02/F96F: E0 10 00     CPX #$0010
02/F972: D0 E4        BNE $F958
02/F974: 60           RTS 
02/F975: C9 03        CMP #$03
02/F977: D0 23        BNE $F99C
02/F979: 7B           TDC 
02/F97A: AA           TAX 
02/F97B: A9 20        LDA #$20
02/F97D: 85 00        STA $00
02/F97F: A9 90        LDA #$90
02/F981: 20 42 FA     JSR $FA42
02/F984: 18           CLC 
02/F985: 69 18        ADC #$18
02/F987: 9D 68 F2     STA $F268,X
02/F98A: A5 00        LDA $00
02/F98C: 9D 69 F2     STA $F269,X
02/F98F: 18           CLC 
02/F990: 69 0C        ADC #$0C
02/F992: 85 00        STA $00
02/F994: E8           INX 
02/F995: E8           INX 
02/F996: E0 10 00     CPX #$0010
02/F999: D0 E4        BNE $F97F
02/F99B: 60           RTS 
02/F99C: 7B           TDC 
02/F99D: AA           TAX 
02/F99E: AD 79 F2     LDA $F279
02/F9A1: D0 1E        BNE $F9C1
02/F9A3: A9 08        LDA #$08
02/F9A5: 20 42 FA     JSR $FA42
02/F9A8: 38           SEC 
02/F9A9: E9 04        SBC #$04
02/F9AB: 9D 68 F2     STA $F268,X
02/F9AE: A9 0C        LDA #$0C
02/F9B0: 20 42 FA     JSR $FA42
02/F9B3: 38           SEC 
02/F9B4: E9 06        SBC #$06
02/F9B6: 9D 69 F2     STA $F269,X
02/F9B9: E8           INX 
02/F9BA: E8           INX 
02/F9BB: E0 0A 00     CPX #$000A
02/F9BE: D0 E3        BNE $F9A3
02/F9C0: 60           RTS 
02/F9C1: BD A1 F2     LDA $F2A1,X
02/F9C4: 0A           ASL 
02/F9C5: 0A           ASL 
02/F9C6: 85 00        STA $00
02/F9C8: 0A           ASL 
02/F9C9: 20 42 FA     JSR $FA42
02/F9CC: 38           SEC 
02/F9CD: E5 00        SBC $00
02/F9CF: 9D 68 F2     STA $F268,X
02/F9D2: E8           INX 
02/F9D3: E0 10 00     CPX #$0010
02/F9D6: D0 E9        BNE $F9C1
02/F9D8: 60           RTS 

; [  ]

02/F9D9: A2 10 00     LDX #$0010
02/F9DC: DA           PHX 
02/F9DD: 20 EE F9     JSR $F9EE
02/F9E0: 20 13 85     JSR $8513       ; wait one frame
02/F9E3: 20 13 85     JSR $8513       ; wait one frame
02/F9E6: FA           PLX 
02/F9E7: CA           DEX 
02/F9E8: D0 F2        BNE $F9DC
02/F9EA: 20 07 E7     JSR $E707
02/F9ED: 6B           RTL 

; [  ]

02/F9EE: A9 08        LDA #$08
02/F9F0: 20 DF F5     JSR $F5DF
02/F9F3: A9 50        LDA #$50
02/F9F5: 8D C2 F0     STA $F0C2
02/F9F8: A9 22        LDA #$22
02/F9FA: 8D C3 F0     STA $F0C3
02/F9FD: 9C C6 F0     STZ $F0C6
02/FA00: A9 FF        LDA #$FF
02/FA02: 8D C7 F0     STA $F0C7
02/FA05: A9 3E        LDA #$3E
02/FA07: 8D C8 F0     STA $F0C8
02/FA0A: A5 49        LDA $49
02/FA0C: 0A           ASL 
02/FA0D: AA           TAX 
02/FA0E: BD A1 F2     LDA $F2A1,X
02/FA11: 0A           ASL 
02/FA12: 0A           ASL 
02/FA13: 85 00        STA $00
02/FA15: 0A           ASL 
02/FA16: 20 42 FA     JSR $FA42
02/FA19: 38           SEC 
02/FA1A: E5 00        SBC $00
02/FA1C: E9 08        SBC #$08
02/FA1E: 18           CLC 
02/FA1F: 7D 43 F0     ADC $F043,X
02/FA22: 8D C4 F0     STA $F0C4
02/FA25: BD A2 F2     LDA $F2A2,X
02/FA28: 0A           ASL 
02/FA29: 0A           ASL 
02/FA2A: 85 00        STA $00
02/FA2C: 0A           ASL 
02/FA2D: 20 42 FA     JSR $FA42
02/FA30: 38           SEC 
02/FA31: E5 00        SBC $00
02/FA33: E9 08        SBC #$08
02/FA35: 18           CLC 
02/FA36: 7D 44 F0     ADC $F044,X
02/FA39: 8D C5 F0     STA $F0C5
02/FA3C: A9 01        LDA #$01
02/FA3E: 8D C1 F0     STA $F0C1
02/FA41: 60           RTS 

; [  ]

02/FA42: 85 26        STA $26
02/FA44: 20 4F FA     JSR $FA4F
02/FA47: 85 28        STA $28
02/FA49: 20 60 85     JSR $8560       ; multiply (8-bit)
02/FA4C: A5 2B        LDA $2B
02/FA4E: 60           RTS 

; [  ]

02/FA4F: E6 97        INC $97
02/FA51: A5 97        LDA $97
02/FA53: A8           TAY 
02/FA54: B9 00 19     LDA $1900,Y     ; rng table
02/FA57: 60           RTS 

; [  ]

02/FA58: A2 00 00     LDX #$0000
02/FA5B: 85 00        STA $00
02/FA5D: AD 84 F2     LDA $F284
02/FA60: 85 02        STA $02
02/FA62: 06 02        ASL $02
02/FA64: 90 0B        BCC $FA71
02/FA66: 8A           TXA 
02/FA67: 0A           ASL 
02/FA68: 0A           ASL 
02/FA69: 0A           ASL 
02/FA6A: 0A           ASL 
02/FA6B: A8           TAY 
02/FA6C: A5 00        LDA $00
02/FA6E: 99 C7 EF     STA $EFC7,Y
02/FA71: E8           INX 
02/FA72: E0 05 00     CPX #$0005
02/FA75: D0 EB        BNE $FA62
02/FA77: 60           RTS 

; [  ]

02/FA78: AD 61 F2     LDA $F261
02/FA7B: F0 05        BEQ $FA82
02/FA7D: 8A           TXA 
02/FA7E: 18           CLC 
02/FA7F: 69 10        ADC #$10
02/FA81: AA           TAX 
02/FA82: BF 91 FA 02  LDA $02FA91,X
02/FA86: 85 06        STA $06
02/FA88: BF 92 FA 02  LDA $02FA92,X
02/FA8C: 85 07        STA $07
02/FA8E: 6C 06 00     JMP ($0006)

02/FA91: FAB1 FABC FAC3 FACA FAD3 FADA FAE3 FAEC
02/FAA1: FAC3 FABC FAB1 FAD3 FACA FAEC FAE3 FADA

; $00/$0A: 
02/FAB1: 7B           TDC 
02/FAB2: 38           SEC 
02/FAB3: E5 08        SBC $08
02/FAB5: 85 06        STA $06
02/FAB7: A5 08        LDA $08
02/FAB9: 85 07        STA $07
02/FABB: 60           RTS 
; $01/$09
02/FABC: 64 06        STZ $06
02/FABE: A5 08        LDA $08
02/FAC0: 85 07        STA $07
02/FAC2: 60           RTS 
; $02/$08
02/FAC3: A5 08        LDA $08
02/FAC5: 85 06        STA $06
02/FAC7: 85 07        STA $07
02/FAC9: 60           RTS 
; $03/$0C
02/FACA: 7B           TDC 
02/FACB: 38           SEC 
02/FACC: E5 08        SBC $08
02/FACE: 85 06        STA $06
02/FAD0: 64 07        STZ $07
02/FAD2: 60           RTS 
; $04/$0B
02/FAD3: A5 08        LDA $08
02/FAD5: 85 06        STA $06
02/FAD7: 64 07        STZ $07
02/FAD9: 60           RTS 
; $05/$0F
02/FADA: 7B           TDC 
02/FADB: 38           SEC 
02/FADC: E5 08        SBC $08
02/FADE: 85 06        STA $06
02/FAE0: 85 07        STA $07
02/FAE2: 60           RTS 
; $06/$0E
02/FAE3: 64 06        STZ $06
02/FAE5: 7B           TDC 
02/FAE6: 38           SEC 
02/FAE7: E5 08        SBC $08
02/FAE9: 85 07        STA $07
02/FAEB: 60           RTS 
; $07/$0D
02/FAEC: A5 08        LDA $08
02/FAEE: 85 06        STA $06
02/FAF0: 7B           TDC 
02/FAF1: 38           SEC 
02/FAF2: E5 08        SBC $08
02/FAF4: 85 07        STA $07
02/FAF6: 60           RTS 

; [  ]

02/FAF7: AD 2E F4     LDA $F42E
02/FAFA: F0 49        BEQ $FB45
02/FAFC: AD 79 F2     LDA $F279
02/FAFF: D0 45        BNE $FB46
02/FB01: AD 83 F2     LDA $F283
02/FB04: F0 3F        BEQ $FB45
02/FB06: A2 00 00     LDX #$0000
02/FB09: AD 84 F2     LDA $F284
02/FB0C: 85 0E        STA $0E
02/FB0E: 06 0E        ASL $0E
02/FB10: 90 2D        BCC $FB3F
02/FB12: 8A           TXA 
02/FB13: C2 20        REP #$20
02/FB15: 0A           ASL 
02/FB16: 0A           ASL 
02/FB17: 0A           ASL 
02/FB18: 0A           ASL 
02/FB19: 0A           ASL 
02/FB1A: A8           TAY 
02/FB1B: B9 8E EE     LDA $EE8E,Y
02/FB1E: 48           PHA 
02/FB1F: 5A           PHY 
02/FB20: A9 0D 00     LDA #$000D
02/FB23: 85 10        STA $10
02/FB25: 98           TYA 
02/FB26: 18           CLC 
02/FB27: 69 1C 00     ADC #$001C
02/FB2A: A8           TAY 
02/FB2B: B9 70 EE     LDA $EE70,Y
02/FB2E: 99 72 EE     STA $EE72,Y
02/FB31: 88           DEY 
02/FB32: 88           DEY 
02/FB33: C6 10        DEC $10
02/FB35: D0 F4        BNE $FB2B
02/FB37: 7A           PLY 
02/FB38: 68           PLA 
02/FB39: 99 74 EE     STA $EE74,Y
02/FB3C: 7B           TDC 
02/FB3D: E2 20        SEP #$20
02/FB3F: E8           INX 
02/FB40: E0 05 00     CPX #$0005
02/FB43: D0 C9        BNE $FB0E
02/FB45: 60           RTS 
02/FB46: AD 81 F2     LDA $F281
02/FB49: C9 03        CMP #$03
02/FB4B: D0 1D        BNE $FB6A
02/FB4D: C2 20        REP #$20
02/FB4F: AD 3E EE     LDA $EE3E
02/FB52: 48           PHA 
02/FB53: A2 0C 00     LDX #$000C
02/FB56: BD 30 EE     LDA $EE30,X
02/FB59: 9D 32 EE     STA $EE32,X
02/FB5C: CA           DEX 
02/FB5D: CA           DEX 
02/FB5E: D0 F6        BNE $FB56
02/FB60: 68           PLA 
02/FB61: 8D 32 EE     STA $EE32
02/FB64: 8D 42 EE     STA $EE42
02/FB67: 7B           TDC 
02/FB68: E2 20        SEP #$20
02/FB6A: 60           RTS 

; [  ]

02/FB6B: AD 81 F4     LDA $F481
02/FB6E: F0 03        BEQ $FB73
02/FB70: 20 F7 FA     JSR $FAF7
02/FB73: AD 47 F2     LDA $F247
02/FB76: D0 01        BNE $FB79
02/FB78: 60           RTS 
02/FB79: 8D 2E F4     STA $F42E
02/FB7C: 20 F7 FA     JSR $FAF7
02/FB7F: AD 67 F2     LDA $F267
02/FB82: 3A           DEC 
02/FB83: D0 09        BNE $FB8E
02/FB85: AD 4F F2     LDA $F24F
02/FB88: 8D 50 F2     STA $F250
02/FB8B: 20 07 E7     JSR $E707
02/FB8E: 9C 47 F2     STZ $F247
02/FB91: AD 4C F2     LDA $F24C
02/FB94: 8D 63 F2     STA $F263
02/FB97: 64 18        STZ $18
02/FB99: 20 2B FD     JSR $FD2B
02/FB9C: AE B2 F2     LDX $F2B2
02/FB9F: 86 0E        STX $0E
02/FBA1: AD 50 F2     LDA $F250
02/FBA4: C2 20        REP #$20
02/FBA6: 0A           ASL 
02/FBA7: 0A           ASL 
02/FBA8: A8           TAY 
02/FBA9: 7B           TDC 
02/FBAA: E2 20        SEP #$20
02/FBAC: 0E 63 F2     ASL $F263
02/FBAF: 90 09        BCC $FBBA
02/FBB1: 0E 62 F2     ASL $F262
02/FBB4: 20 95 FC     JSR $FC95
02/FBB7: 4C BF FB     JMP $FBBF
02/FBBA: 0E 62 F2     ASL $F262
02/FBBD: B0 1A        BCS $FBD9
02/FBBF: E6 18        INC $18
02/FBC1: A5 18        LDA $18
02/FBC3: C9 08        CMP #$08
02/FBC5: D0 E5        BNE $FBAC
02/FBC7: CE 67 F2     DEC $F267
02/FBCA: D0 0C        BNE $FBD8
02/FBCC: AD 4F F2     LDA $F24F
02/FBCF: 8D 50 F2     STA $F250
02/FBD2: AD 66 F2     LDA $F266
02/FBD5: 8D 67 F2     STA $F267
02/FBD8: 60           RTS 
02/FBD9: AE B2 F2     LDX $F2B2
02/FBDC: F0 CE        BEQ $FBAC
02/FBDE: 20 E4 FB     JSR $FBE4
02/FBE1: 4C BF FB     JMP $FBBF

; [  ]

02/FBE4: A5 18        LDA $18
02/FBE6: 0A           ASL 
02/FBE7: AA           TAX 
02/FBE8: BD 51 F2     LDA $F251,X
02/FBEB: 18           CLC 
02/FBEC: 7D 68 F2     ADC $F268,X
02/FBEF: 85 12        STA $12
02/FBF1: BD 52 F2     LDA $F252,X
02/FBF4: 18           CLC 
02/FBF5: 7D 69 F2     ADC $F269,X
02/FBF8: 85 13        STA $13
02/FBFA: A2 00 00     LDX #$0000
02/FBFD: AD C0 6C     LDA $6CC0
02/FC00: F0 45        BEQ $FC47
02/FC02: BD E6 EB     LDA $EBE6,X
02/FC05: 18           CLC 
02/FC06: 69 0F        ADC #$0F
02/FC08: 10 07        BPL $FC11
02/FC0A: 18           CLC 
02/FC0B: 65 12        ADC $12
02/FC0D: 90 1A        BCC $FC29
02/FC0F: 80 05        BRA $FC16
02/FC11: 18           CLC 
02/FC12: 65 12        ADC $12
02/FC14: B0 13        BCS $FC29
02/FC16: 49 FF        EOR #$FF
02/FC18: 99 00 03     STA $0300,Y
02/FC1B: BD E7 EB     LDA $EBE7,X
02/FC1E: 18           CLC 
02/FC1F: 65 13        ADC $13
02/FC21: C9 8C        CMP #$8C
02/FC23: 90 0E        BCC $FC33
02/FC25: C9 F8        CMP #$F8
02/FC27: B0 0A        BCS $FC33
02/FC29: A9 F0        LDA #$F0
02/FC2B: 99 00 03     STA $0300,Y
02/FC2E: 99 01 03     STA $0301,Y
02/FC31: 80 03        BRA $FC36
02/FC33: 99 01 03     STA $0301,Y
02/FC36: BD E8 EB     LDA $EBE8,X
02/FC39: 99 02 03     STA $0302,Y
02/FC3C: BD E9 EB     LDA $EBE9,X
02/FC3F: 49 40        EOR #$40
02/FC41: 99 03 03     STA $0303,Y
02/FC44: 4C 82 FC     JMP $FC82
02/FC47: BD E6 EB     LDA $EBE6,X
02/FC4A: 10 07        BPL $FC53
02/FC4C: 18           CLC 
02/FC4D: 65 12        ADC $12
02/FC4F: 90 18        BCC $FC69
02/FC51: 80 05        BRA $FC58
02/FC53: 18           CLC 
02/FC54: 65 12        ADC $12
02/FC56: B0 11        BCS $FC69
02/FC58: 99 00 03     STA $0300,Y
02/FC5B: BD E7 EB     LDA $EBE7,X
02/FC5E: 18           CLC 
02/FC5F: 65 13        ADC $13
02/FC61: C9 8C        CMP #$8C
02/FC63: 90 0E        BCC $FC73
02/FC65: C9 F8        CMP #$F8
02/FC67: B0 0A        BCS $FC73
02/FC69: A9 F0        LDA #$F0
02/FC6B: 99 00 03     STA $0300,Y
02/FC6E: 99 01 03     STA $0301,Y
02/FC71: 80 03        BRA $FC76
02/FC73: 99 01 03     STA $0301,Y
02/FC76: BD E8 EB     LDA $EBE8,X
02/FC79: 99 02 03     STA $0302,Y
02/FC7C: BD E9 EB     LDA $EBE9,X
02/FC7F: 99 03 03     STA $0303,Y
02/FC82: EE 50 F2     INC $F250
02/FC85: E8           INX 
02/FC86: E8           INX 
02/FC87: E8           INX 
02/FC88: E8           INX 
02/FC89: C8           INY 
02/FC8A: C8           INY 
02/FC8B: C8           INY 
02/FC8C: C8           INY 
02/FC8D: E4 0E        CPX $0E
02/FC8F: F0 03        BEQ $FC94
02/FC91: 4C FD FB     JMP $FBFD
02/FC94: 60           RTS 

; [  ]

02/FC95: A5 18        LDA $18
02/FC97: 0A           ASL 
02/FC98: AA           TAX 
02/FC99: AD 79 F2     LDA $F279
02/FC9C: D0 0F        BNE $FCAD
02/FC9E: BD 53 F0     LDA $F053,X
02/FCA1: 85 12        STA $12
02/FCA3: BD 54 F0     LDA $F054,X
02/FCA6: 18           CLC 
02/FCA7: 69 06        ADC #$06
02/FCA9: 85 13        STA $13
02/FCAB: 80 0A        BRA $FCB7
02/FCAD: BD 43 F0     LDA $F043,X
02/FCB0: 85 12        STA $12
02/FCB2: BD 44 F0     LDA $F044,X
02/FCB5: 85 13        STA $13
02/FCB7: A2 00 00     LDX #$0000
02/FCBA: AD C0 6C     LDA $6CC0
02/FCBD: F0 2C        BEQ $FCEB
02/FCBF: BF 61 FE 0D  LDA $0DFE61,X
02/FCC3: 18           CLC 
02/FCC4: 65 12        ADC $12
02/FCC6: 49 FF        EOR #$FF
02/FCC8: 38           SEC 
02/FCC9: E9 0F        SBC #$0F
02/FCCB: 99 00 03     STA $0300,Y
02/FCCE: BF 62 FE 0D  LDA $0DFE62,X
02/FCD2: 18           CLC 
02/FCD3: 65 13        ADC $13
02/FCD5: 99 01 03     STA $0301,Y
02/FCD8: BF 63 FE 0D  LDA $0DFE63,X
02/FCDC: 99 02 03     STA $0302,Y
02/FCDF: BF 64 FE 0D  LDA $0DFE64,X
02/FCE3: 49 40        EOR #$40
02/FCE5: 99 03 03     STA $0303,Y
02/FCE8: 4C 0D FD     JMP $FD0D
02/FCEB: BF 61 FE 0D  LDA $0DFE61,X
02/FCEF: 18           CLC 
02/FCF0: 65 12        ADC $12
02/FCF2: 99 00 03     STA $0300,Y
02/FCF5: BF 62 FE 0D  LDA $0DFE62,X
02/FCF9: 18           CLC 
02/FCFA: 65 13        ADC $13
02/FCFC: 99 01 03     STA $0301,Y
02/FCFF: BF 63 FE 0D  LDA $0DFE63,X
02/FD03: 99 02 03     STA $0302,Y
02/FD06: BF 64 FE 0D  LDA $0DFE64,X
02/FD0A: 99 03 03     STA $0303,Y
02/FD0D: AD 79 F2     LDA $F279
02/FD10: F0 08        BEQ $FD1A
02/FD12: B9 03 03     LDA $0303,Y
02/FD15: 49 40        EOR #$40
02/FD17: 99 03 03     STA $0303,Y
02/FD1A: EE 50 F2     INC $F250
02/FD1D: E8           INX 
02/FD1E: E8           INX 
02/FD1F: E8           INX 
02/FD20: E8           INX 
02/FD21: C8           INY 
02/FD22: C8           INY 
02/FD23: C8           INY 
02/FD24: C8           INY 
02/FD25: E0 08 00     CPX #$0008
02/FD28: D0 90        BNE $FCBA
02/FD2A: 60           RTS 

; [  ]

02/FD2B: AD D0 F2     LDA $F2D0
02/FD2E: C9 07        CMP #$07
02/FD30: F0 0D        BEQ $FD3F
02/FD32: C9 01        CMP #$01
02/FD34: F0 09        BEQ $FD3F
02/FD36: C9 04        CMP #$04
02/FD38: F0 05        BEQ $FD3F
02/FD3A: A9 30        LDA #$30
02/FD3C: 4C 41 FD     JMP $FD41
02/FD3F: A9 20        LDA #$20
02/FD41: 85 1A        STA $1A
02/FD43: AD 4D F2     LDA $F24D
02/FD46: 0A           ASL 
02/FD47: 0A           ASL 
02/FD48: 0A           ASL 
02/FD49: 85 12        STA $12
02/FD4B: AD 4E F2     LDA $F24E
02/FD4E: 0A           ASL 
02/FD4F: 0A           ASL 
02/FD50: 0A           ASL 
02/FD51: 85 13        STA $13
02/FD53: AD 4A F2     LDA $F24A
02/FD56: 38           SEC 
02/FD57: E5 12        SBC $12
02/FD59: 85 12        STA $12
02/FD5B: AD 4B F2     LDA $F24B
02/FD5E: 38           SEC 
02/FD5F: E5 13        SBC $13
02/FD61: 85 13        STA $13
02/FD63: AD 48 F2     LDA $F248
02/FD66: AA           TAX 
02/FD67: 86 1C        STX $1C
02/FD69: AD 49 F2     LDA $F249
02/FD6C: C2 20        REP #$20
02/FD6E: 0A           ASL 
02/FD6F: 0A           ASL 
02/FD70: 0A           ASL 
02/FD71: 0A           ASL 
02/FD72: 0A           ASL 
02/FD73: 0A           ASL 
02/FD74: 0A           ASL 
02/FD75: 18           CLC 
02/FD76: 65 1C        ADC $1C
02/FD78: 0A           ASL 
02/FD79: AA           TAX 
02/FD7A: 7B           TDC 
02/FD7B: E2 20        SEP #$20
02/FD7D: BF E0 DD 0F  LDA $0FDDE0,X
02/FD81: 85 1C        STA $1C
02/FD83: BF E1 DD 0F  LDA $0FDDE1,X
02/FD87: 85 1D        STA $1D
02/FD89: A9 0F        LDA #$0F
02/FD8B: 85 1E        STA $1E
02/FD8D: AE 4D F2     LDX $F24D
02/FD90: 86 10        STX $10
02/FD92: A6 12        LDX $12
02/FD94: 86 14        STX $14
02/FD96: A0 00 00     LDY #$0000
02/FD99: A7 1C        LDA [$1C]
02/FD9B: 30 0E        BMI $FDAB
02/FD9D: A6 1C        LDX $1C
02/FD9F: E8           INX 
02/FDA0: 86 1C        STX $1C
02/FDA2: 22 D8 F4 03  JSL $03F4D8
02/FDA6: 90 26        BCC $FDCE
02/FDA8: 4C 99 FD     JMP $FD99
02/FDAB: C9 FF        CMP #$FF
02/FDAD: F0 1F        BEQ $FDCE
02/FDAF: 85 16        STA $16
02/FDB1: A6 1C        LDX $1C
02/FDB3: E8           INX 
02/FDB4: 86 1C        STX $1C
02/FDB6: A7 1C        LDA [$1C]
02/FDB8: 85 17        STA $17
02/FDBA: A6 1C        LDX $1C
02/FDBC: E8           INX 
02/FDBD: 86 1C        STX $1C
02/FDBF: A5 16        LDA $16
02/FDC1: 22 D8 F4 03  JSL $03F4D8
02/FDC5: 90 07        BCC $FDCE
02/FDC7: C6 17        DEC $17
02/FDC9: D0 F4        BNE $FDBF
02/FDCB: 4C 99 FD     JMP $FD99
02/FDCE: 8C B2 F2     STY $F2B2
02/FDD1: AD A0 F2     LDA $F2A0
02/FDD4: C9 04        CMP #$04
02/FDD6: F0 08        BEQ $FDE0
02/FDD8: C9 03        CMP #$03
02/FDDA: F0 04        BEQ $FDE0
02/FDDC: C9 02        CMP #$02
02/FDDE: D0 25        BNE $FE05
02/FDE0: A2 00 00     LDX #$0000
02/FDE3: A0 00 00     LDY #$0000
02/FDE6: B9 E6 EB     LDA $EBE6,Y
02/FDE9: 18           CLC 
02/FDEA: 7D B0 F3     ADC $F3B0,X
02/FDED: 99 E6 EB     STA $EBE6,Y
02/FDF0: B9 E7 EB     LDA $EBE7,Y
02/FDF3: 18           CLC 
02/FDF4: 7D B1 F3     ADC $F3B1,X
02/FDF7: 99 E7 EB     STA $EBE7,Y
02/FDFA: E8           INX 
02/FDFB: E8           INX 
02/FDFC: C8           INY 
02/FDFD: C8           INY 
02/FDFE: C8           INY 
02/FDFF: C8           INY 
02/FE00: C0 24 00     CPY #$0024
02/FE03: D0 E1        BNE $FDE6
02/FE05: 60           RTS 

; [  ]

02/FE06: AA           TAX 
02/FE07: BF EB FC 16  LDA $16FCEB,X
02/FE0B: 4C 14 FE     JMP $FE14

02/FE0E: 0060 0040 0020

; [  ]

02/FE14: A0 80 00     LDY #$0080
02/FE17: 8C 69 F4     STY $F469
02/FE1A: A0 00 10     LDY #$1000
02/FE1D: 8C 6B F4     STY $F46B
02/FE20: 80 0C        BRA $FE2E
02/FE22: A0 20 00     LDY #$0020
02/FE25: 8C 69 F4     STY $F469
02/FE28: A0 00 04     LDY #$0400
02/FE2B: 8C 6B F4     STY $F46B
02/FE2E: 48           PHA 
02/FE2F: C9 15        CMP #$15
02/FE31: 90 13        BCC $FE46
02/FE33: 38           SEC 
02/FE34: E9 15        SBC #$15
02/FE36: DA           PHX 
02/FE37: C2 20        REP #$20
02/FE39: 0A           ASL 
02/FE3A: AA           TAX 
02/FE3B: BF 0E FE 02  LDA $02FE0E,X
02/FE3F: 8D 69 F4     STA $F469
02/FE42: 7B           TDC 
02/FE43: E2 20        SEP #$20
02/FE45: FA           PLX 
02/FE46: A9 7F        LDA #$7F
02/FE48: 85 06        STA $06
02/FE4A: A9 0C        LDA #$0C
02/FE4C: 85 02        STA $02
02/FE4E: 68           PLA 
02/FE4F: C2 20        REP #$20
02/FE51: 0A           ASL 
02/FE52: 0A           ASL 
02/FE53: 0A           ASL 
02/FE54: 0A           ASL 
02/FE55: 0A           ASL 
02/FE56: 0A           ASL 
02/FE57: AA           TAX 
02/FE58: A9 E6 DB     LDA #$DBE6
02/FE5B: 85 08        STA $08
02/FE5D: A9 00 F0     LDA #$F000
02/FE60: 85 04        STA $04
02/FE62: AC 69 F4     LDY $F469
02/FE65: 5A           PHY 
02/FE66: BF C0 F3 0C  LDA $0CF3C0,X
02/FE6A: 48           PHA 
02/FE6B: 48           PHA 
02/FE6C: 29 FF 3F     AND #$3FFF
02/FE6F: 0A           ASL 
02/FE70: A8           TAY 
02/FE71: B7 04        LDA [$04],Y
02/FE73: 85 00        STA $00
02/FE75: 68           PLA 
02/FE76: 29 00 40     AND #$4000
02/FE79: 85 0A        STA $0A
02/FE7B: 68           PLA 
02/FE7C: 29 00 80     AND #$8000
02/FE7F: D0 2A        BNE $FEAB
02/FE81: A0 00 00     LDY #$0000
02/FE84: A7 00        LDA [$00]
02/FE86: 20 09 FF     JSR $FF09
02/FE89: 91 08        STA ($08),Y
02/FE8B: E6 00        INC $00
02/FE8D: E6 00        INC $00
02/FE8F: C8           INY 
02/FE90: C8           INY 
02/FE91: C0 10 00     CPY #$0010
02/FE94: D0 EE        BNE $FE84
02/FE96: A7 00        LDA [$00]
02/FE98: 20 09 FF     JSR $FF09
02/FE9B: 29 FF 00     AND #$00FF
02/FE9E: 91 08        STA ($08),Y
02/FEA0: E6 00        INC $00
02/FEA2: C8           INY 
02/FEA3: C8           INY 
02/FEA4: C0 20 00     CPY #$0020
02/FEA7: D0 ED        BNE $FE96
02/FEA9: 80 2B        BRA $FED6
02/FEAB: A0 0E 00     LDY #$000E
02/FEAE: A7 00        LDA [$00]
02/FEB0: 20 09 FF     JSR $FF09
02/FEB3: 91 08        STA ($08),Y
02/FEB5: E6 00        INC $00
02/FEB7: E6 00        INC $00
02/FEB9: 88           DEY 
02/FEBA: 88           DEY 
02/FEBB: C0 FE FF     CPY #$FFFE
02/FEBE: D0 EE        BNE $FEAE
02/FEC0: A0 1E 00     LDY #$001E
02/FEC3: A7 00        LDA [$00]
02/FEC5: 20 09 FF     JSR $FF09
02/FEC8: 29 FF 00     AND #$00FF
02/FECB: 91 08        STA ($08),Y
02/FECD: E6 00        INC $00
02/FECF: 88           DEY 
02/FED0: 88           DEY 
02/FED1: C0 0E 00     CPY #$000E
02/FED4: D0 ED        BNE $FEC3
02/FED6: A5 08        LDA $08
02/FED8: 18           CLC 
02/FED9: 69 20 00     ADC #$0020
02/FEDC: 85 08        STA $08
02/FEDE: E8           INX 
02/FEDF: E8           INX 
02/FEE0: 7A           PLY 
02/FEE1: 88           DEY 
02/FEE2: D0 81        BNE $FE65
02/FEE4: 7B           TDC 
02/FEE5: E2 20        SEP #$20
02/FEE7: 7B           TDC 
02/FEE8: AA           TAX 
02/FEE9: 9D A6 E9     STA $E9A6,X
02/FEEC: 9D A6 EB     STA $EBA6,X
02/FEEF: E8           INX 
02/FEF0: E0 40 00     CPX #$0040
02/FEF3: D0 F4        BNE $FEE9
02/FEF5: A0 00 18     LDY #$1800
02/FEF8: AE 6B F4     LDX $F46B
02/FEFB: 86 00        STX $00
02/FEFD: A9 7E        LDA #$7E
02/FEFF: A2 E6 DB     LDX #$DBE6
02/FF02: 20 B2 84     JSR $84B2
02/FF05: 20 20 FF     JSR $FF20
02/FF08: 60           RTS 

; [  ]

02/FF09: 48           PHA 
02/FF0A: A5 0A        LDA $0A
02/FF0C: F0 10        BEQ $FF1E
02/FF0E: 68           PLA 
02/FF0F: EB           XBA 
02/FF10: 85 0C        STA $0C
02/FF12: DA           PHX 
02/FF13: A2 10 00     LDX #$0010
02/FF16: 06 0C        ASL $0C
02/FF18: 6A           ROR 
02/FF19: CA           DEX 
02/FF1A: D0 FA        BNE $FF16
02/FF1C: FA           PLX 
02/FF1D: 60           RTS 
02/FF1E: 68           PLA 
02/FF1F: 60           RTS 

; [  ]

02/FF20: A2 40 04     LDX #$0440
02/FF23: 20 42 FF     JSR $FF42
02/FF26: A0 C0 1E     LDY #$1EC0
02/FF29: 20 35 FF     JSR $FF35
02/FF2C: A2 60 04     LDX #$0460
02/FF2F: 20 42 FF     JSR $FF42
02/FF32: A0 C0 1F     LDY #$1FC0
02/FF35: A2 40 00     LDX #$0040
02/FF38: 86 00        STX $00
02/FF3A: A9 7E        LDA #$7E
02/FF3C: A2 E6 DB     LDX #$DBE6
02/FF3F: 4C 62 FF     JMP $FF62

; [  ]

02/FF42: C2 20        REP #$20
02/FF44: BF C0 F3 0C  LDA $0CF3C0,X
02/FF48: 29 FF 03     AND #$03FF
02/FF4B: 0A           ASL 
02/FF4C: AA           TAX 
02/FF4D: BF 00 F0 7F  LDA $7FF000,X
02/FF51: A8           TAY 
02/FF52: 7B           TDC 
02/FF53: E2 20        SEP #$20
02/FF55: A2 02 00     LDX #$0002
02/FF58: 86 00        STX $00
02/FF5A: A2 E6 DB     LDX #$DBE6
02/FF5D: A9 0C        LDA #$0C
02/FF5F: 4C 3D DA     JMP $DA3D       ; load 3bpp graphics

; [  ]

02/FF62: 48           PHA 
02/FF63: DA           PHX 
02/FF64: 5A           PHY 
02/FF65: A6 00        LDX $00
02/FF67: DA           PHX 
02/FF68: AD A8 EF     LDA $EFA8
02/FF6B: F0 05        BEQ $FF72
02/FF6D: 20 13 85     JSR $8513       ; wait one frame
02/FF70: 80 F6        BRA $FF68
02/FF72: FA           PLX 
02/FF73: 86 00        STX $00
02/FF75: 7A           PLY 
02/FF76: FA           PLX 
02/FF77: 68           PLA 
02/FF78: 8D AF EF     STA $EFAF
02/FF7B: 8E A9 EF     STX $EFA9
02/FF7E: 8C AB EF     STY $EFAB
02/FF81: A2 40 00     LDX #$0040
02/FF84: 8E AD EF     STX $EFAD
02/FF87: C2 20        REP #$20
02/FF89: A5 00        LDA $00
02/FF8B: 0A           ASL 
02/FF8C: 0A           ASL 
02/FF8D: 29 00 FF     AND #$FF00
02/FF90: 85 00        STA $00
02/FF92: 7B           TDC 
02/FF93: E2 20        SEP #$20
02/FF95: A5 01        LDA $01
02/FF97: 8D B0 EF     STA $EFB0
02/FF9A: EE A8 EF     INC $EFA8
02/FF9D: 20 13 85     JSR $8513       ; wait one frame
02/FFA0: CE B0 EF     DEC $EFB0
02/FFA3: F0 1B        BEQ $FFC0
02/FFA5: C2 20        REP #$20
02/FFA7: AD A9 EF     LDA $EFA9
02/FFAA: 18           CLC 
02/FFAB: 69 40 00     ADC #$0040
02/FFAE: 8D A9 EF     STA $EFA9
02/FFB1: AD AB EF     LDA $EFAB
02/FFB4: 18           CLC 
02/FFB5: 69 20 00     ADC #$0020
02/FFB8: 8D AB EF     STA $EFAB
02/FFBB: 7B           TDC 
02/FFBC: E2 20        SEP #$20
02/FFBE: 80 DA        BRA $FF9A
02/FFC0: 60           RTS 

02/FFC1:    FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
02/FFD0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
02/FFE0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
02/FFF0: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

03/8000: 4C 09 80     JMP $8009       ; battle
03/8003: 4C 09 80     JMP $8009       ; battle
03/8006: 4C 36 80     JMP $8036       ; update character equipment

; [ battle ]

03/8009: 08           PHP 
03/800A: C2 30        REP #$30
03/800C: 8B           PHB 
03/800D: 0B           PHD 
03/800E: 48           PHA 
03/800F: DA           PHX 
03/8010: 5A           PHY 
03/8011: A9 00 00     LDA #$0000
03/8014: E2 20        SEP #$20
03/8016: C2 10        REP #$10
03/8018: 20 8A 80     JSR $808A       ; init battle
03/801B: A9 00        LDA #$00
03/801D: 8F 00 21 00  STA $002100     ; screen on, zero brightness
03/8021: 8F 0C 42 00  STA $00420C     ; disable hdma
03/8025: 8F 0B 42 00  STA $00420B     ; disable dma
03/8029: 8F 00 42 00  STA $004200     ; disable nmi and irq
03/802D: C2 30        REP #$30
03/802F: 7A           PLY 
03/8030: FA           PLX 
03/8031: 68           PLA 
03/8032: 2B           PLD 
03/8033: AB           PLB 
03/8034: 28           PLP 
03/8035: 6B           RTL 

; [ update character equipment ]

; A: character slot

03/8036: 8F 75 39 7E  STA $7E3975
03/803A: 08           PHP 
03/803B: C2 30        REP #$30
03/803D: 8B           PHB 
03/803E: 0B           PHD 
03/803F: 48           PHA 
03/8040: DA           PHX 
03/8041: 5A           PHY 
03/8042: 78           SEI 
03/8043: A9 00 00     LDA #$0000
03/8046: E2 20        SEP #$20
03/8048: C2 10        REP #$10
03/804A: A2 00 00     LDX #$0000
03/804D: DA           PHX 
03/804E: 2B           PLD 
03/804F: A9 7E        LDA #$7E
03/8051: 48           PHA 
03/8052: AB           PLB 
03/8053: 20 FD 97     JSR $97FD       ; update character equipment
03/8056: C2 30        REP #$30
03/8058: 7A           PLY 
03/8059: FA           PLX 
03/805A: 68           PLA 
03/805B: 2B           PLD 
03/805C: AB           PLB 
03/805D: 28           PLP 
03/805E: 6B           RTL 

; [ draw current/max mp ]

; update mp in magic menu every 4th time this subroutine is called

03/805F: AD 3E 35     LDA $353E
03/8062: 49 01        EOR #$01
03/8064: 8D 3E 35     STA $353E
03/8067: D0 1B        BNE $8084
03/8069: AD 3F 35     LDA $353F
03/806C: C9 02        CMP #$02
03/806E: D0 05        BNE $8075
03/8070: A9 00        LDA #$00
03/8072: 8D 3F 35     STA $353F
03/8075: AD 3F 35     LDA $353F
03/8078: D0 02        BNE $807C
03/807A: 80 05        BRA $8081
03/807C: A9 0D        LDA #$0D        ; battle graphics $0D: draw current/max mp
03/807E: 20 85 80     JSR $8085       ; execute battle graphics
03/8081: EE 3F 35     INC $353F
03/8084: 60           RTS 

; [ execute battle graphics ]

03/8085: 22 03 80 02  JSL $028003     ; execute battle graphics
03/8089: 60           RTS 

; [ init battle ]

03/808A: 20 CB 82     JSR $82CB       ; init hardware registers
03/808D: A2 FF 00     LDX #$00FF
03/8090: BF 00 EE 14  LDA $14EE00,X   ; copy rng table to buffer
03/8094: 9D 00 19     STA $1900,X
03/8097: CA           DEX 
03/8098: 10 F6        BPL $8090
03/809A: 20 35 82     JSR $8235       ; init ram
03/809D: A2 7F 00     LDX #$007F
03/80A0: 7B           TDC 
03/80A1: 18           CLC 
03/80A2: 7D 00 06     ADC $0600,X     ; seed rng with sum of $0600-$067F
03/80A5: CA           DEX 
03/80A6: 10 FA        BPL $80A2
03/80A8: 85 97        STA $97
03/80AA: 20 FD B2     JSR $B2FD       ; init graphics script
03/80AD: AD 02 18     LDA $1802
03/80B0: 48           PHA 
03/80B1: 48           PHA 
03/80B2: 29 80        AND #$80
03/80B4: 8D 2C 35     STA $352C       ; if set, enable magnetization
03/80B7: 68           PLA 
03/80B8: 29 40        AND #$40
03/80BA: 85 A9        STA $A9
03/80BC: 68           PLA 
03/80BD: 29 3F        AND #$3F
03/80BF: 8D 02 18     STA $1802
03/80C2: A5 A9        LDA $A9
03/80C4: F0 05        BEQ $80CB
03/80C6: A9 07        LDA #$07        ; if set, use cave w/ water bg
03/80C8: 8D 02 18     STA $1802
03/80CB: AD 01 18     LDA $1801
03/80CE: 29 80        AND #$80
03/80D0: 8D EF 38     STA $38EF       ; if set, use moon monster action scripts
03/80D3: AD 01 18     LDA $1801
03/80D6: 29 7F        AND #$7F
03/80D8: 8D 01 18     STA $1801
03/80DB: C2 20        REP #$20
03/80DD: AD 00 18     LDA $1800
03/80E0: C9 00 01     CMP #$0100
03/80E3: 90 07        BCC $80EC
03/80E5: 38           SEC 
03/80E6: E9 00 00     SBC #$0000      ; does nothing ???
03/80E9: 8D 00 18     STA $1800
03/80EC: AD 00 18     LDA $1800
03/80EF: 8D 3D 39     STA $393D       ; get pointer to battle properties
03/80F2: A9 08 00     LDA #$0008
03/80F5: 8D 3F 39     STA $393F
03/80F8: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/80FB: 7B           TDC 
03/80FC: E2 20        SEP #$20
03/80FE: AE 41 39     LDX $3941
03/8101: 7B           TDC 
03/8102: A8           TAY 
03/8103: BF 00 80 0E  LDA $0E8000,X
03/8107: 99 9C 29     STA $299C,Y     ; load battle properties
03/810A: C8           INY 
03/810B: E8           INX 
03/810C: C0 08 00     CPY #$0008
03/810F: D0 F2        BNE $8103
03/8111: AD 9C 29     LDA $299C
03/8114: 8D A4 29     STA $29A4
03/8117: 29 08        AND #$08
03/8119: 8D 81 35     STA $3581       ; forced back attack if set
03/811C: A2 03 00     LDX #$0003
03/811F: 9B           TXY 
03/8120: 88           DEY 
03/8121: BD 9C 29     LDA $299C,X     ; copy monster types
03/8124: 99 AD 29     STA $29AD,Y
03/8127: 99 B1 29     STA $29B1,Y
03/812A: CA           DEX 
03/812B: 88           DEY 
03/812C: 10 F3        BPL $8121
03/812E: A9 FF        LDA #$FF        ; list terminator ???
03/8130: 8D B0 29     STA $29B0
03/8133: 8D B4 29     STA $29B4
03/8136: 7B           TDC 
03/8137: AA           TAX 
03/8138: AD A0 29     LDA $29A0       ; monster type counts (2 bits each)
03/813B: 85 AB        STA $AB
03/813D: 9E CA 29     STZ $29CA,X
03/8140: 06 AB        ASL $AB
03/8142: 3E CA 29     ROL $29CA,X
03/8145: 06 AB        ASL $AB
03/8147: 3E CA 29     ROL $29CA,X
03/814A: E8           INX 
03/814B: E0 03 00     CPX #$0003
03/814E: D0 ED        BNE $813D
03/8150: 7B           TDC 
03/8151: AA           TAX 
03/8152: 9B           TXY 
03/8153: C8           INY 
03/8154: BD AD 29     LDA $29AD,X
03/8157: C9 FF        CMP #$FF
03/8159: F0 1D        BEQ $8178       ; branch at end of monster type list
03/815B: D9 AD 29     CMP $29AD,Y
03/815E: D0 12        BNE $8172       ; branch if not same as another type
03/8160: 18           CLC 
03/8161: BD CA 29     LDA $29CA,X     ; combine monster counts
03/8164: 79 CA 29     ADC $29CA,Y
03/8167: 9D CA 29     STA $29CA,X
03/816A: 7B           TDC 
03/816B: 99 CA 29     STA $29CA,Y     ; remove the duplicate
03/816E: 3A           DEC 
03/816F: 99 AD 29     STA $29AD,Y     ; mark as empty
03/8172: C8           INY 
03/8173: C0 03 00     CPY #$0003
03/8176: D0 DC        BNE $8154
03/8178: E8           INX 
03/8179: E0 02 00     CPX #$0002
03/817C: D0 D4        BNE $8152
03/817E: A9 FF        LDA #$FF
03/8180: A0 07 00     LDY #$0007
03/8183: 99 B5 29     STA $29B5,Y     ; reset monster type in each slot
03/8186: 99 BD 29     STA $29BD,Y
03/8189: 88           DEY 
03/818A: 10 F7        BPL $8183
03/818C: C8           INY 
03/818D: BB           TYX 
03/818E: BD CA 29     LDA $29CA,X
03/8191: 85 AB        STA $AB
03/8193: F0 0E        BEQ $81A3
03/8195: 8A           TXA 
03/8196: 99 B5 29     STA $29B5,Y     ; set monster type in this slot
03/8199: 99 BD 29     STA $29BD,Y
03/819C: C8           INY 
03/819D: C6 AB        DEC $AB
03/819F: A5 AB        LDA $AB
03/81A1: D0 F2        BNE $8195
03/81A3: E8           INX 
03/81A4: E0 03 00     CPX #$0003
03/81A7: D0 E5        BNE $818E
03/81A9: AD A1 29     LDA $29A1       ; get pointer to monster position data
03/81AC: 85 DF        STA $DF
03/81AE: A9 08        LDA #$08
03/81B0: 85 E1        STA $E1
03/81B2: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/81B5: A6 E3        LDX $E3
03/81B7: 7B           TDC 
03/81B8: A8           TAY 
03/81B9: BF 00 90 0E  LDA $0E9000,X   ; load monster position data
03/81BD: 99 A5 29     STA $29A5,Y
03/81C0: E8           INX 
03/81C1: C8           INY 
03/81C2: C0 08 00     CPY #$0008
03/81C5: D0 F2        BNE $81B9
03/81C7: 18           CLC 
03/81C8: AD CA 29     LDA $29CA       ; calculate total monster count
03/81CB: 6D CB 29     ADC $29CB
03/81CE: 6D CC 29     ADC $29CC
03/81D1: 8D CD 29     STA $29CD
03/81D4: AD CA 29     LDA $29CA
03/81D7: 8D F0 38     STA $38F0
03/81DA: AD CB 29     LDA $29CB
03/81DD: 8D F1 38     STA $38F1
03/81E0: AD CC 29     LDA $29CC
03/81E3: 8D F2 38     STA $38F2
03/81E6: AD A3 29     LDA $29A3       ; get pointer to monster cursor data
03/81E9: 85 DF        STA $DF
03/81EB: A9 10        LDA #$10
03/81ED: 85 E1        STA $E1
03/81EF: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/81F2: A6 E3        LDX $E3
03/81F4: 7B           TDC 
03/81F5: A8           TAY 
03/81F6: BF C0 BA 0E  LDA $0EBAC0,X   ; load monster cursor data
03/81FA: 99 CF 29     STA $29CF,Y
03/81FD: E8           INX 
03/81FE: C8           INY 
03/81FF: C0 10 00     CPY #$0010
03/8202: D0 F2        BNE $81F6
03/8204: 20 29 89     JSR $8929       ; init characters and monsters
03/8207: AD 82 22     LDA $2282
03/820A: C9 61        CMP #$61
03/820C: 90 0B        BCC $8219       ; branch if monster level is less than 97
03/820E: 38           SEC 
03/820F: E9 61        SBC #$61
03/8211: AA           TAX 
03/8212: BF 0F FF 13  LDA $13FF0F,X   ; run difficulty
03/8216: 8D D6 38     STA $38D6
03/8219: AD E5 38     LDA $38E5       ; battle song
03/821C: 29 0C        AND #$0C
03/821E: 4A           LSR 
03/821F: 4A           LSR 
03/8220: C9 03        CMP #$03
03/8222: F0 09        BEQ $822D       ; branch if no battle music
03/8224: AA           TAX 
03/8225: BF 0C FF 13  LDA $13FF0C,X
03/8229: 22 12 FF 13  JSL $13FF12     ; play battle song
03/822D: A9 03        LDA #$03        ; battle graphics $03: init battle graphics
03/822F: 20 85 80     JSR $8085       ; execute battle graphics
03/8232: 4C D9 85     JMP $85D9       ; battle main

; [ init ram ]

03/8235: A2 7F 00     LDX #$007F
03/8238: 74 80        STZ $80,X       ; clear $80-$FF
03/823A: CA           DEX 
03/823B: 10 FB        BPL $8238
03/823D: A2 7D 19     LDX #$197D
03/8240: 9E 00 20     STZ $2000,X     ; clear $2000-$397D
03/8243: CA           DEX 
03/8244: 10 FA        BPL $8240
03/8246: A2 07 00     LDX #$0007
03/8249: 9E 04 18     STZ $1804,X     ; clear $1804-$180B
03/824C: CA           DEX 
03/824D: 10 FA        BPL $8249
03/824F: A2 10 07     LDX #$0710
03/8252: A9 80        LDA #$80
03/8254: 9D 7A 2C     STA $2C7A,X     ; disable all spells
03/8257: CA           DEX 
03/8258: CA           DEX 
03/8259: CA           DEX 
03/825A: CA           DEX 
03/825B: 10 F7        BPL $8254
03/825D: A2 3F 33     LDX #$333F
03/8260: A9 FF        LDA #$FF
03/8262: 9D 7F 39     STA $397F,X     ; clear $397F-$6CBE (monster scripts)
03/8265: CA           DEX 
03/8266: 10 FA        BPL $8262
03/8268: A2 05 00     LDX #$0005
03/826B: 9D 29 39     STA $3929,X     ; clear battle menu queue
03/826E: CA           DEX 
03/826F: 10 FA        BPL $826B
03/8271: A2 07 00     LDX #$0007
03/8274: 9D F7 35     STA $35F7,X     ; clear retaliation stack
03/8277: CA           DEX 
03/8278: 10 FA        BPL $8274
03/827A: 85 D0        STA $D0         ; init #$FF
03/827C: 8D 7B 35     STA $357B
03/827F: 8D 7C 35     STA $357C
03/8282: 8D 83 35     STA $3583
03/8285: 8D 5E 35     STA $355E
03/8288: 8D 01 36     STA $3601
03/828B: 8D 02 36     STA $3602
03/828E: 8D D6 38     STA $38D6
03/8291: A9 1A        LDA #$1A
03/8293: 8D 17 33     STA $3317
03/8296: 8D 33 33     STA $3333
03/8299: 8D 4F 33     STA $334F
03/829C: 8D 6B 33     STA $336B
03/829F: 8D 87 33     STA $3387
03/82A2: 1A           INC 
03/82A3: 8D 1B 33     STA $331B       ; init 0
03/82A6: 8D 37 33     STA $3337
03/82A9: 8D 53 33     STA $3353
03/82AC: 8D 6F 33     STA $336F
03/82AF: 8D 8B 33     STA $338B
03/82B2: AD AC 16     LDA $16AC
03/82B5: 8D 38 35     STA $3538
03/82B8: 8D EE 38     STA $38EE
03/82BB: A2 18 00     LDX #$0018
03/82BE: A9 02        LDA #$02
03/82C0: 9D A4 35     STA $35A4,X     ; set extra doom counter
03/82C3: 9E A5 35     STZ $35A5,X
03/82C6: CA           DEX 
03/82C7: CA           DEX 
03/82C8: 10 F6        BPL $82C0
03/82CA: 60           RTS 

; [ init hardware registers ]

03/82CB: A9 00        LDA #$00
03/82CD: 48           PHA 
03/82CE: AB           PLB 
03/82CF: 8D 00 42     STA $4200       ; disable nmi and irq
03/82D2: A2 00 00     LDX #$0000
03/82D5: DA           PHX 
03/82D6: 2B           PLD 
03/82D7: A9 80        LDA #$80
03/82D9: 8D 00 21     STA $2100       ; screen off
03/82DC: A9 09        LDA #$09
03/82DE: 8D 05 21     STA $2105
03/82E1: A2 00 00     LDX #$0000
03/82E4: 8E 02 21     STX $2102
03/82E7: 8A           TXA 
03/82E8: 8D 01 21     STA $2101
03/82EB: A9 22        LDA #$22
03/82ED: 8D 0B 21     STA $210B
03/82F0: A9 55        LDA #$55
03/82F2: 8D 0C 21     STA $210C
03/82F5: A9 63        LDA #$63
03/82F7: 8D 07 21     STA $2107
03/82FA: A9 59        LDA #$59
03/82FC: 8D 08 21     STA $2108
03/82FF: A9 73        LDA #$73
03/8301: 8D 09 21     STA $2109
03/8304: 8D 0A 21     STA $210A
03/8307: A9 80        LDA #$80
03/8309: 8D 15 21     STA $2115
03/830C: 7B           TDC 
03/830D: AA           TAX 
03/830E: 8D 06 21     STA $2106
03/8311: 8D 0D 21     STA $210D
03/8314: 8D 0D 21     STA $210D
03/8317: 8D 0E 21     STA $210E
03/831A: 8D 0E 21     STA $210E
03/831D: 8D 0F 21     STA $210F
03/8320: 8D 0F 21     STA $210F
03/8323: 8D 10 21     STA $2110
03/8326: 8D 10 21     STA $2110
03/8329: 8D 11 21     STA $2111
03/832C: 8D 11 21     STA $2111
03/832F: 8D 12 21     STA $2112
03/8332: 8D 12 21     STA $2112
03/8335: 8D 13 21     STA $2113
03/8338: 8D 13 21     STA $2113
03/833B: 8D 14 21     STA $2114
03/833E: 8D 14 21     STA $2114
03/8341: 8D 23 21     STA $2123
03/8344: 8D 24 21     STA $2124
03/8347: 8D 25 21     STA $2125
03/834A: 8D 26 21     STA $2126
03/834D: 8D 27 21     STA $2127
03/8350: 8D 28 21     STA $2128
03/8353: 8D 29 21     STA $2129
03/8356: 8E 2A 21     STX $212A
03/8359: 8D 2C 21     STA $212C
03/835C: 8D 2D 21     STA $212D
03/835F: 8D 2E 21     STA $212E
03/8362: 8D 2F 21     STA $212F
03/8365: 8D 0B 42     STA $420B
03/8368: 8D 0C 42     STA $420C
03/836B: 8D 31 21     STA $2131
03/836E: 8D 33 21     STA $2133
03/8371: 8D 30 21     STA $2130
03/8374: A9 7E        LDA #$7E
03/8376: 48           PHA 
03/8377: AB           PLB 
03/8378: 60           RTS 

; [ random (X..A) ]

03/8379: E2 10        SEP #$10
03/837B: 86 96        STX $96
03/837D: E0 FF        CPX #$FF
03/837F: D0 02        BNE $8383
03/8381: 80 33        BRA $83B6
03/8383: C9 00        CMP #$00
03/8385: F0 2F        BEQ $83B6
03/8387: C5 96        CMP $96
03/8389: F0 2B        BEQ $83B6
03/838B: A6 97        LDX $97
03/838D: 38           SEC 
03/838E: E5 96        SBC $96
03/8390: C9 FF        CMP #$FF
03/8392: D0 05        BNE $8399
03/8394: BD 00 19     LDA $1900,X     ; rng table
03/8397: 80 1D        BRA $83B6
03/8399: 1A           INC 
03/839A: 8D 47 39     STA $3947
03/839D: 9C 48 39     STZ $3948
03/83A0: BD 00 19     LDA $1900,X     ; rng table
03/83A3: AA           TAX 
03/83A4: 8E 45 39     STX $3945
03/83A7: C2 10        REP #$10
03/83A9: 20 07 84     JSR $8407       ; divide
03/83AC: E2 10        SEP #$10
03/83AE: 18           CLC 
03/83AF: AD 4B 39     LDA $394B
03/83B2: 65 96        ADC $96
03/83B4: E6 97        INC $97
03/83B6: C2 10        REP #$10
03/83B8: 60           RTS 

; [ multiply (16-bit) ]

; +++$3941 = +$393D * +$393F

03/83B9: C2 20        REP #$20
03/83BB: A2 10 00     LDX #$0010
03/83BE: 9C 41 39     STZ $3941
03/83C1: 9C 43 39     STZ $3943
03/83C4: 6E 3F 39     ROR $393F
03/83C7: 90 0A        BCC $83D3
03/83C9: 18           CLC 
03/83CA: AD 3D 39     LDA $393D
03/83CD: 6D 43 39     ADC $3943
03/83D0: 8D 43 39     STA $3943
03/83D3: 6E 43 39     ROR $3943
03/83D6: 6E 41 39     ROR $3941
03/83D9: CA           DEX 
03/83DA: D0 E8        BNE $83C4
03/83DC: 7B           TDC 
03/83DD: E2 20        SEP #$20
03/83DF: 60           RTS 

; [ multiply (8-bit) ]

; +$E3 = $DF * $E1

03/83E0: 64 E0        STZ $E0
03/83E2: 64 E2        STZ $E2
03/83E4: C2 20        REP #$20
03/83E6: A2 10 00     LDX #$0010
03/83E9: 64 E3        STZ $E3
03/83EB: 9C 4D 39     STZ $394D
03/83EE: 66 E1        ROR $E1
03/83F0: 90 09        BCC $83FB
03/83F2: 18           CLC 
03/83F3: A5 DF        LDA $DF
03/83F5: 6D 4D 39     ADC $394D
03/83F8: 8D 4D 39     STA $394D
03/83FB: 6E 4D 39     ROR $394D
03/83FE: 66 E3        ROR $E3
03/8400: CA           DEX 
03/8401: D0 EB        BNE $83EE
03/8403: 7B           TDC 
03/8404: E2 20        SEP #$20
03/8406: 60           RTS 

; [ divide ]

; +$394B = +$3945 / +$3947
; +$3949 = remainder

03/8407: C2 20        REP #$20
03/8409: 9C 49 39     STZ $3949
03/840C: 9C 4B 39     STZ $394B
03/840F: AD 45 39     LDA $3945
03/8412: F0 2B        BEQ $843F
03/8414: AD 47 39     LDA $3947
03/8417: F0 26        BEQ $843F
03/8419: 18           CLC 
03/841A: A2 10 00     LDX #$0010
03/841D: 2E 45 39     ROL $3945
03/8420: 2E 4B 39     ROL $394B
03/8423: 38           SEC 
03/8424: AD 4B 39     LDA $394B
03/8427: ED 47 39     SBC $3947
03/842A: 8D 4B 39     STA $394B
03/842D: B0 0A        BCS $8439
03/842F: AD 4B 39     LDA $394B
03/8432: 6D 47 39     ADC $3947
03/8435: 8D 4B 39     STA $394B
03/8438: 18           CLC 
03/8439: 2E 49 39     ROL $3949
03/843C: CA           DEX 
03/843D: D0 DE        BNE $841D
03/843F: 7B           TDC 
03/8440: E2 20        SEP #$20
03/8442: 60           RTS 

; [ get script length ]

; ++$80: source address
;   $E5: max length

03/8443: 85 82        STA $82
03/8445: 84 80        STY $80
03/8447: 7B           TDC 
03/8448: A8           TAY 
03/8449: A5 E5        LDA $E5
03/844B: F0 10        BEQ $845D
03/844D: B7 80        LDA [$80],Y
03/844F: C9 FF        CMP #$FF        ; find terminator
03/8451: D0 06        BNE $8459
03/8453: C6 E5        DEC $E5
03/8455: A5 E5        LDA $E5
03/8457: F0 03        BEQ $845C
03/8459: C8           INY 
03/845A: 80 F1        BRA $844D
03/845C: C8           INY 
03/845D: 60           RTS 

; [ load array item ]

;     A: size
; ++$80: source address
;   $E5: index

03/845E: 85 E1        STA $E1
03/8460: A5 E5        LDA $E5
03/8462: 85 DF        STA $DF
03/8464: A5 E1        LDA $E1
03/8466: 85 E5        STA $E5
03/8468: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/846B: A4 E3        LDY $E3
03/846D: 7B           TDC 
03/846E: AA           TAX 
03/846F: B7 80        LDA [$80],Y     ; copy data to buffer
03/8471: 9D 9C 28     STA $289C,X
03/8474: C8           INY 
03/8475: E8           INX 
03/8476: E4 E5        CPX $E5
03/8478: D0 F5        BNE $846F
03/847A: 60           RTS 

; [ asl ]

03/847B: 0A           ASL 
03/847C: 0A           ASL 
03/847D: 0A           ASL 
03/847E: 0A           ASL 
03/847F: 0A           ASL 
03/8480: 0A           ASL 
03/8481: 60           RTS 

; [ lsr ]

03/8482: 4A           LSR 
03/8483: 4A           LSR 
03/8484: 4A           LSR 
03/8485: 4A           LSR 
03/8486: 4A           LSR 
03/8487: 4A           LSR 
03/8488: 60           RTS 

; [ set current character/monster ]

; A: character/monster id

03/8489: 8D 2F 35     STA $352F
03/848C: 85 DF        STA $DF
03/848E: A9 80        LDA #$80
03/8490: 85 E1        STA $E1
03/8492: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8495: A6 E3        LDX $E3
03/8497: 86 A6        STX $A6         ; pointer to character/monster properties
03/8499: AD 2F 35     LDA $352F
03/849C: 85 DF        STA $DF
03/849E: A9 15        LDA #$15
03/84A0: 85 E1        STA $E1
03/84A2: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/84A5: A6 E3        LDX $E3
03/84A7: 8E 30 35     STX $3530       ; pointer to timers
03/84AA: AD 2F 35     LDA $352F
03/84AD: 85 DF        STA $DF
03/84AF: A9 37        LDA #$37
03/84B1: 85 E1        STA $E1
03/84B3: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/84B6: A6 E3        LDX $E3
03/84B8: 8E 32 35     STX $3532       ; pointer to equipped item data
03/84BB: AD 2F 35     LDA $352F
03/84BE: 85 DF        STA $DF
03/84C0: A9 1C        LDA #$1C
03/84C2: 85 E1        STA $E1
03/84C4: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/84C7: A6 E3        LDX $E3
03/84C9: 8E 34 35     STX $3534       ; pointer to battle commands
03/84CC: AD 2F 35     LDA $352F
03/84CF: AA           TAX 
03/84D0: 8E 3D 39     STX $393D
03/84D3: A2 20 01     LDX #$0120
03/84D6: 8E 3F 39     STX $393F
03/84D9: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/84DC: AE 41 39     LDX $3941
03/84DF: 8E 36 35     STX $3536       ; pointer to spell list
03/84E2: 60           RTS 

; [ add (16-bit) ]

; +++$395A = +$3956 + +$3958

03/84E3: C2 20        REP #$20
03/84E5: 18           CLC 
03/84E6: AD 56 39     LDA $3956
03/84E9: 6D 58 39     ADC $3958
03/84EC: 8D 5A 39     STA $395A
03/84EF: A9 00 00     LDA #$0000
03/84F2: 69 00 00     ADC #$0000
03/84F5: 8D 5C 39     STA $395C
03/84F8: 7B           TDC 
03/84F9: E2 20        SEP #$20
03/84FB: 60           RTS 

; [ subtract (16-bit) ]

; +$3962 = +$395E + +$3960

03/84FC: C2 20        REP #$20
03/84FE: 38           SEC 
03/84FF: AD 5E 39     LDA $395E
03/8502: ED 60 39     SBC $3960
03/8505: 8D 62 39     STA $3962
03/8508: 7B           TDC 
03/8509: E2 20        SEP #$20
03/850B: 60           RTS 

; [ count bits ]

03/850C: A2 00 00     LDX #$0000
03/850F: A0 08 00     LDY #$0008
03/8512: 0A           ASL 
03/8513: 90 01        BCC $8516
03/8515: E8           INX 
03/8516: 88           DEY 
03/8517: D0 F9        BNE $8512
03/8519: 60           RTS 

; [ copy attacker/target properties from buffer ]

; used for magic, other commands modify attacker/target properties directly

03/851A: AD 53 35     LDA $3553
03/851D: D0 1D        BNE $853C       ; branch if self-target
03/851F: A5 CD        LDA $CD
03/8521: 10 05        BPL $8528
03/8523: 29 7F        AND #$7F
03/8525: 18           CLC 
03/8526: 69 05        ADC #$05
03/8528: 20 89 84     JSR $8489       ; set current character/monster
03/852B: A6 A6        LDX $A6
03/852D: 7B           TDC 
03/852E: A8           TAY 
03/852F: B9 80 26     LDA $2680,Y
03/8532: 9D 00 20     STA $2000,X
03/8535: E8           INX 
03/8536: C8           INY 
03/8537: C0 80 00     CPY #$0080
03/853A: D0 F3        BNE $852F
03/853C: A5 CE        LDA $CE
03/853E: 10 05        BPL $8545
03/8540: 29 7F        AND #$7F
03/8542: 18           CLC 
03/8543: 69 05        ADC #$05
03/8545: 20 89 84     JSR $8489       ; set current character/monster
03/8548: A6 A6        LDX $A6
03/854A: 7B           TDC 
03/854B: A8           TAY 
03/854C: B9 00 27     LDA $2700,Y
03/854F: 9D 00 20     STA $2000,X
03/8552: E8           INX 
03/8553: C8           INY 
03/8554: C0 80 00     CPY #$0080
03/8557: D0 F3        BNE $854C
03/8559: 60           RTS 

; [ clear bit ]

03/855A: 3F F6 FE 13  AND $13FEF6,X
03/855E: 60           RTS 

; [ set bit ]

03/855F: 1F FE FE 13  ORA $13FEFE,X
03/8563: 60           RTS 

; [ test bit ]

03/8564: 3F FE FE 13  AND $13FEFE,X
03/8568: 60           RTS 

; [ get pointer to timer ]

; A: timer id * 3

03/8569: 18           CLC 
03/856A: 6D 30 35     ADC $3530       ; add $2A04
03/856D: 8D 98 35     STA $3598
03/8570: AD 31 35     LDA $3531
03/8573: 69 00        ADC #$00
03/8575: 8D 99 35     STA $3599
03/8578: 60           RTS 

; [ choose a random monster ]

03/8579: A2 00 00     LDX #$0000
03/857C: A9 07        LDA #$07
03/857E: 20 79 83     JSR $8379       ; random (X..A)
03/8581: 60           RTS 

; [ choose a random character ]

03/8582: A2 00 00     LDX #$0000
03/8585: A9 04        LDA #$04
03/8587: 20 79 83     JSR $8379       ; random (X..A)
03/858A: 60           RTS 

; [ random (0..98) ]

03/858B: 7B           TDC 
03/858C: AA           TAX 
03/858D: A9 62        LDA #$62
03/858F: 20 79 83     JSR $8379       ; random (X..A)
03/8592: 60           RTS 

; [ random (0..255) ]

03/8593: 7B           TDC 
03/8594: AA           TAX 
03/8595: A9 FF        LDA #$FF
03/8597: 20 79 83     JSR $8379       ; random (X..A)
03/859A: 60           RTS 

; [ add message to graphics script ($33C2) ]

03/859B: A9 F8        LDA #$F8        ; display text
03/859D: 8D C2 33     STA $33C2
03/85A0: A9 03        LDA #$03        ; battle message
03/85A2: 8D C3 33     STA $33C3
03/85A5: 60           RTS 

; [ add message to graphics script ($33C6) ]

03/85A6: A9 F8        LDA #$F8        ; display text
03/85A8: 8D C6 33     STA $33C6
03/85AB: A9 03        LDA #$03        ; battle message
03/85AD: 8D C7 33     STA $33C7
03/85B0: 60           RTS 

; [ add message to graphics script ($33C8) ]

03/85B1: A9 F8        LDA #$F8        ; display text
03/85B3: 8D C8 33     STA $33C8
03/85B6: A9 03        LDA #$03        ; battle message
03/85B8: 8D C9 33     STA $33C9
03/85BB: 60           RTS 

; [ increment character/monster pointer ]

; X += $80

03/85BC: C2 20        REP #$20
03/85BE: 8A           TXA 
03/85BF: 18           CLC 
03/85C0: 69 80 00     ADC #$0080
03/85C3: AA           TAX 
03/85C4: 7B           TDC 
03/85C5: E2 20        SEP #$20
03/85C7: 60           RTS 

; [ set timer ]

;    A: timer id
; +$D4: timer duration

03/85C8: 20 69 85     JSR $8569       ; get pointer to timer
03/85CB: AE 98 35     LDX $3598
03/85CE: A5 D4        LDA $D4         ; timer duration
03/85D0: 9D 04 2A     STA $2A04,X
03/85D3: A5 D5        LDA $D5
03/85D5: 9D 05 2A     STA $2A05,X
03/85D8: 60           RTS 

; [ battle main ]

03/85D9: AD AC 16     LDA $16AC       ; battle speed
03/85DC: AA           TAX 
03/85DD: BF 06 FF 13  LDA $13FF06,X   ; battle speed constant
03/85E1: 1A           INC 
03/85E2: 8D 38 35     STA $3538
03/85E5: 9C E6 38     STZ $38E6
03/85E8: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/85EA: 20 85 80     JSR $8085       ; execute battle graphics
03/85ED: AD D9 38     LDA $38D9
03/85F0: 0D DA 38     ORA $38DA
03/85F3: D0 F3        BNE $85E8       ; branch if paused or wait mode
03/85F5: CE 38 35     DEC $3538
03/85F8: AD 38 35     LDA $3538
03/85FB: D0 EB        BNE $85E8
03/85FD: AD D7 38     LDA $38D7
03/8600: D0 07        BNE $8609       ; branch if first strike
03/8602: AD 81 35     LDA $3581
03/8605: 29 08        AND #$08
03/8607: F0 2F        BEQ $8638       ; branch if not back attack
03/8609: AD 81 35     LDA $3581
03/860C: 29 08        AND #$08
03/860E: F0 04        BEQ $8614       ; branch if not back attack
03/8610: A9 04        LDA #$04        ;  (back attack)
03/8612: 80 0B        BRA $861F
03/8614: AD D7 38     LDA $38D7
03/8617: 30 04        BMI $861D       ; branch if surprised
03/8619: A9 02        LDA #$02        ;  (first strike)
03/861B: 80 02        BRA $861F
03/861D: A9 03        LDA #$03        ;  (surprised)
03/861F: 8D CA 34     STA $34CA       ; add to battle message buffer
03/8622: A9 FF        LDA #$FF
03/8624: 8D CB 34     STA $34CB
03/8627: 8D C4 33     STA $33C4
03/862A: 20 9B 85     JSR $859B       ; add message to graphics script
03/862D: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/862F: 20 85 80     JSR $8085       ; execute battle graphics
03/8632: 9C D7 38     STZ $38D7       ; clear first strike and surprise
03/8635: 9C 81 35     STZ $3581       ; clear back attack
03/8638: AD 82 22     LDA $2282
03/863B: C9 63        CMP #$63
03/863D: D0 0A        BNE $8649       ; branch if not level 99 monster
03/863F: AD 2D 35     LDA $352D
03/8642: D0 05        BNE $8649       ; branch if L and R buttons are pressed
03/8644: A9 0F        LDA #$0F
03/8646: 8D D6 38     STA $38D6       ; reset run counter to 15
03/8649: 20 77 96     JSR $9677       ; decrement timers
03/864C: AD 01 36     LDA $3601
03/864F: C9 FF        CMP #$FF
03/8651: D0 06        BNE $8659       ; branch if no graphics script
03/8653: 20 5F 80     JSR $805F       ; draw current/max mp
03/8656: 20 FF A9     JSR $A9FF       ; do sap and regen
03/8659: 20 15 A0     JSR $A015       ; check if battle is over
03/865C: A5 A8        LDA $A8
03/865E: D0 3F        BNE $869F       ; branch if battle is over
03/8660: AD 01 36     LDA $3601
03/8663: C9 FF        CMP #$FF
03/8665: D0 06        BNE $866D       ; branch if no graphics script
03/8667: 20 E2 AA     JSR $AAE2       ; do forced character actions
03/866A: 20 E3 A3     JSR $A3E3       ; open/close menu
03/866D: 20 41 97     JSR $9741       ; check for pending action
03/8670: A5 D1        LDA $D1
03/8672: F0 10        BEQ $8684       ; branch if no pending action
03/8674: 20 B3 97     JSR $97B3       ; init action
03/8677: 20 87 86     JSR $8687       ; do action
03/867A: AD 2E 35     LDA $352E
03/867D: C9 02        CMP #$02
03/867F: D0 03        BNE $8684       ; branch if not an attack
03/8681: 20 6C C1     JSR $C16C       ; do retaliation
03/8684: 4C D9 85     JMP $85D9       ; next turn

; [ do action ]

03/8687: AD 2E 35     LDA $352E       ; action type
03/868A: 0A           ASL 
03/868B: AA           TAX 
03/868C: BF 21 89 03  LDA $038921,X   ; action type jump table
03/8690: 85 80        STA $80
03/8692: BF 22 89 03  LDA $038922,X
03/8696: 85 81        STA $81
03/8698: A9 03        LDA #$03
03/869A: 85 82        STA $82
03/869C: DC 80 00     JML [$0080]

; [ end battle ]

03/869F: 22 3A FF 13  JSL $13FF3A     ; validate dead character hp
03/86A3: A9 85        LDA #$85        ; sound command $85: fade out music (slow)
03/86A5: 8D F3 35     STA $35F3
03/86A8: A5 D7        LDA $D7
03/86AA: F0 05        BEQ $86B1       ; branch if menu is not open
03/86AC: A9 01        LDA #$01        ; battle graphics $01: close menu
03/86AE: 20 85 80     JSR $8085       ; execute battle graphics
03/86B1: A5 A8        LDA $A8
03/86B3: 8D 03 18     STA $1803
03/86B6: 29 60        AND #$60
03/86B8: D0 55        BNE $870F       ; branch if victory or ran away
03/86BA: A5 A8        LDA $A8
03/86BC: 29 04        AND #$04
03/86BE: F0 0E        BEQ $86CE
; fade out
03/86C0: A9 15        LDA #$15        ; battle graphics $15: 
03/86C2: 20 85 80     JSR $8085       ; execute battle graphics
03/86C5: 20 0F 88     JSR $880F       ; clear status for victory animation
03/86C8: 20 8B F1     JSR $F18B       ; restore character properties after battle
03/86CB: 4C 66 87     JMP $8766
; defeat
03/86CE: AD E5 38     LDA $38E5
03/86D1: 29 0C        AND #$0C
03/86D3: C9 0C        CMP #$0C
03/86D5: F0 05        BEQ $86DC
03/86D7: A9 8B        LDA #$8B        ; sound command $8B: fade out music
03/86D9: 8D F3 35     STA $35F3
03/86DC: A9 0C        LDA #$0C        ; battle graphics $0C: draw hp text
03/86DE: 20 85 80     JSR $8085       ; execute battle graphics
03/86E1: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/86E3: 20 85 80     JSR $8085       ; execute battle graphics
03/86E6: A9 15        LDA #$15        ; battle graphics $15: 
03/86E8: 20 85 80     JSR $8085       ; execute battle graphics
03/86EB: 20 9B 85     JSR $859B       ; add message to graphics script
03/86EE: A9 24        LDA #$24        ;  (party defeated)
03/86F0: 8D CA 34     STA $34CA
03/86F3: A9 FF        LDA #$FF
03/86F5: 8D CB 34     STA $34CB
03/86F8: 8D C4 33     STA $33C4
03/86FB: 9C 9A 35     STZ $359A
03/86FE: A9 40        LDA #$40
03/8700: 8D C2 34     STA $34C2
03/8703: AD 8B 38     LDA $388B
03/8706: D0 05        BNE $870D
03/8708: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/870A: 20 85 80     JSR $8085       ; execute battle graphics
03/870D: 80 57        BRA $8766
; ran away
03/870F: 29 40        AND #$40
03/8711: F0 15        BEQ $8728
03/8713: A9 13        LDA #$13        ; battle graphics $13: party runs away
03/8715: 20 85 80     JSR $8085       ; execute battle graphics
03/8718: 20 0F 88     JSR $880F       ; clear status for victory animation
03/871B: 20 8B F1     JSR $F18B       ; restore character properties after battle
03/871E: AD F3 38     LDA $38F3
03/8721: D0 43        BNE $8766
03/8723: 20 40 88     JSR $8840       ; drop gp from running away
03/8726: 80 3E        BRA $8766
; victory
03/8728: 20 D8 87     JSR $87D8       ; check if victory fanfare is disabled
03/872B: A5 A9        LDA $A9
03/872D: D0 09        BNE $8738
03/872F: AD E5 38     LDA $38E5
03/8732: 29 0C        AND #$0C
03/8734: C9 0C        CMP #$0C
03/8736: F0 08        BEQ $8740       ; branch if no battle music
03/8738: A9 08        LDA #$08        ; victory fanfare
03/873A: 8D BE 38     STA $38BE
03/873D: EE BD 38     INC $38BD
03/8740: 20 0F 88     JSR $880F       ; clear status for victory animation
03/8743: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/8745: 20 85 80     JSR $8085       ; execute battle graphics
03/8748: 20 03 88     JSR $8803       ; check if victory animation is disabled
03/874B: A5 A9        LDA $A9
03/874D: D0 05        BNE $8754
03/874F: A9 12        LDA #$12        ; battle graphics $12: victory animation
03/8751: 20 85 80     JSR $8085       ; execute battle graphics
03/8754: 20 8B F1     JSR $F18B       ; restore character properties after battle
03/8757: A5 A8        LDA $A8
03/8759: 29 10        AND #$10
03/875B: F0 09        BEQ $8766
03/875D: 20 72 EC     JSR $EC72       ; update party after victory
03/8760: 20 0F 88     JSR $880F       ; clear status for victory animation
03/8763: 20 8B F1     JSR $F18B       ; restore character properties after battle
03/8766: 7B           TDC 
03/8767: AA           TAX 
03/8768: CA           DEX 
03/8769: D0 FD        BNE $8768
03/876B: 64 AB        STZ $AB
03/876D: AE 00 18     LDX $1800
03/8770: E0 C0 01     CPX #$01C0
03/8773: 90 02        BCC $8777
03/8775: E6 AB        INC $AB
03/8777: A2 07 00     LDX #$0007
03/877A: BD 04 18     LDA $1804,X     ; items gained from battle
03/877D: 05 AB        ORA $AB
03/877F: 85 AB        STA $AB
03/8781: CA           DEX 
03/8782: 10 F6        BPL $877A
03/8784: E8           INX 
03/8785: CA           DEX 
03/8786: D0 FD        BNE $8785
03/8788: AD E5 38     LDA $38E5
03/878B: 29 0C        AND #$0C
03/878D: C9 0C        CMP #$0C
03/878F: F0 1A        BEQ $87AB       ; branch if no battle music
03/8791: A5 AB        LDA $AB
03/8793: D0 16        BNE $87AB       ; branch if any items were gained
03/8795: AD 00 18     LDA $1800
03/8798: C9 B7        CMP #$B7
03/879A: D0 05        BNE $87A1
03/879C: AD 01 18     LDA $1801
03/879F: D0 0A        BNE $87AB       ; branch if battle $01B7 (zeromus)
03/87A1: AD F3 35     LDA $35F3       ; sound command (either $85 or $8B)
03/87A4: 8D 00 1E     STA $1E00
03/87A7: 22 04 80 04  JSL $048004     ; execute sound command
03/87AB: A9 FF        LDA #$FF
03/87AD: 85 A9        STA $A9
03/87AF: A9 10        LDA #$10        ; screen brightness counter
03/87B1: 85 AA        STA $AA
03/87B3: E6 A9        INC $A9         ; increment mosaic counter
03/87B5: C6 AA        DEC $AA         ; decrement screen brightness
03/87B7: A5 AA        LDA $AA
03/87B9: F0 16        BEQ $87D1
03/87BB: A5 A9        LDA $A9
03/87BD: 20 7E 84     JSR $847E       ; asl3
03/87C0: 09 03        ORA #$03        ; affect bg1 and bg2
03/87C2: 8D C2 6C     STA $6CC2
03/87C5: A5 AA        LDA $AA
03/87C7: 8D C1 6C     STA $6CC1
03/87CA: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/87CC: 20 85 80     JSR $8085       ; execute battle graphics
03/87CF: 80 E2        BRA $87B3
03/87D1: A9 00        LDA #$00
03/87D3: 8F 06 21 00  STA $002106     ; clear mosaic register
03/87D7: 60           RTS 

; [ check if victory fanfare is disabled ]

03/87D8: A2 67 FE     LDX #$FE67
03/87DB: 86 AB        STX $AB
03/87DD: A9 13        LDA #$13
03/87DF: 85 AD        STA $AD
03/87E1: 4C E4 87     JMP $87E4       ; find battle id in list

; [ find battle id in list ]

03/87E4: 64 A9        STZ $A9
03/87E6: 7B           TDC 
03/87E7: A8           TAY 
03/87E8: B7 AB        LDA [$AB],Y
03/87EA: C9 FF        CMP #$FF
03/87EC: F0 14        BEQ $8802
03/87EE: CD 00 18     CMP $1800
03/87F1: D0 0B        BNE $87FE
03/87F3: C8           INY 
03/87F4: B7 AB        LDA [$AB],Y
03/87F6: CD 01 18     CMP $1801
03/87F9: D0 04        BNE $87FF
03/87FB: E6 A9        INC $A9
03/87FD: 60           RTS 
03/87FE: C8           INY 
03/87FF: C8           INY 
03/8800: 80 E6        BRA $87E8
03/8802: 60           RTS 

; [ check if victory animation is disabled ]

03/8803: A2 76 FE     LDX #$FE76
03/8806: 86 AB        STX $AB
03/8808: A9 13        LDA #$13
03/880A: 85 AD        STA $AD
03/880C: 4C E4 87     JMP $87E4       ; find battle id in list

; [ clear status for victory animation ]

03/880F: 7B           TDC 
03/8810: AA           TAX 
03/8811: A8           TAY 
03/8812: BD 03 20     LDA $2003,X
03/8815: 99 BF 38     STA $38BF,Y     ; save status 1
03/8818: 29 F8        AND #$F8        ; clear mute, darkness, and poison
03/881A: 9D 03 20     STA $2003,X
03/881D: BD 04 20     LDA $2004,X
03/8820: 99 C0 38     STA $38C0,Y     ; save status 2
03/8823: 29 40        AND #$40        ; clear all but float
03/8825: 9D 04 20     STA $2004,X
03/8828: 9E 05 20     STZ $2005,X     ; clear status 3
03/882B: BD 06 20     LDA $2006,X
03/882E: 99 C1 38     STA $38C1,Y     ; save status 4
03/8831: 9E 06 20     STZ $2006,X     ; clear status 4
03/8834: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/8837: C8           INY 
03/8838: C8           INY 
03/8839: C8           INY 
03/883A: C0 0F 00     CPY #$000F
03/883D: D0 D3        BNE $8812
03/883F: 60           RTS 

; [ drop gp from running away ]

03/8840: 20 8B 85     JSR $858B       ; random (0..98)
03/8843: C9 32        CMP #$32
03/8845: B0 03        BCS $884A
03/8847: 4C 20 89     JMP $8920
03/884A: A0 00 00     LDY #$0000
03/884D: 84 AB        STY $AB
03/884F: 8C 9C 28     STY $289C
03/8852: 8C 9E 28     STY $289E
03/8855: A4 AB        LDY $AB
03/8857: B9 88 35     LDA $3588,Y
03/885A: AA           TAX 
03/885B: 86 A9        STX $A9
03/885D: 06 A9        ASL $A9
03/885F: 26 AA        ROL $AA
03/8861: A6 A9        LDX $A9
03/8863: BF 00 A0 0E  LDA $0EA000,X
03/8867: 8D 3D 39     STA $393D
03/886A: BF 01 A0 0E  LDA $0EA001,X
03/886E: 8D 3E 39     STA $393E
03/8871: B9 F0 38     LDA $38F0,Y
03/8874: AA           TAX 
03/8875: 8E 3F 39     STX $393F
03/8878: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/887B: 18           CLC 
03/887C: AD 41 39     LDA $3941
03/887F: 6D 9C 28     ADC $289C
03/8882: 8D 9C 28     STA $289C
03/8885: AD 42 39     LDA $3942
03/8888: 6D 9D 28     ADC $289D
03/888B: 8D 9D 28     STA $289D
03/888E: AD 43 39     LDA $3943
03/8891: 6D 9E 28     ADC $289E
03/8894: 8D 9E 28     STA $289E
03/8897: E6 AB        INC $AB
03/8899: A5 AB        LDA $AB
03/889B: C9 03        CMP #$03
03/889D: D0 B6        BNE $8855
03/889F: 4E 9E 28     LSR $289E
03/88A2: 6E 9D 28     ROR $289D
03/88A5: 6E 9C 28     ROR $289C
03/88A8: 4E 9E 28     LSR $289E
03/88AB: 6E 9D 28     ROR $289D
03/88AE: 6E 9C 28     ROR $289C
03/88B1: AD 9C 28     LDA $289C
03/88B4: 0D 9D 28     ORA $289D
03/88B7: F0 67        BEQ $8920
03/88B9: AD A0 16     LDA $16A0
03/88BC: 0D A1 16     ORA $16A1
03/88BF: 0D A2 16     ORA $16A2
03/88C2: F0 5C        BEQ $8920
03/88C4: AD A0 16     LDA $16A0
03/88C7: 85 A9        STA $A9
03/88C9: AD A1 16     LDA $16A1
03/88CC: 85 AA        STA $AA
03/88CE: 38           SEC 
03/88CF: AD A0 16     LDA $16A0
03/88D2: ED 9C 28     SBC $289C
03/88D5: 8D A0 16     STA $16A0
03/88D8: AD A1 16     LDA $16A1
03/88DB: ED 9D 28     SBC $289D
03/88DE: 8D A1 16     STA $16A1
03/88E1: AD A2 16     LDA $16A2
03/88E4: ED 9E 28     SBC $289E
03/88E7: 8D A2 16     STA $16A2
03/88EA: B0 13        BCS $88FF
03/88EC: A5 A9        LDA $A9
03/88EE: 8D 9C 28     STA $289C
03/88F1: A5 AA        LDA $AA
03/88F3: 8D 9D 28     STA $289D
03/88F6: 9C A0 16     STZ $16A0
03/88F9: 9C A1 16     STZ $16A1
03/88FC: 9C A2 16     STZ $16A2
03/88FF: AD 9C 28     LDA $289C
03/8902: 8D 9A 35     STA $359A
03/8905: AD 9D 28     LDA $289D
03/8908: 8D 9B 35     STA $359B
03/890B: 9C 9C 35     STZ $359C
03/890E: A9 37        LDA #$37
03/8910: 8D CA 34     STA $34CA
03/8913: 20 9B 85     JSR $859B       ; add message to graphics script
03/8916: A9 FF        LDA #$FF
03/8918: 8D CC 34     STA $34CC
03/891B: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/891D: 20 85 80     JSR $8085       ; execute battle graphics
03/8920: 60           RTS 

; action type jump table
03/8921: A371 B3B6 AD57 A856

; --------------------------------------------------------------------------

; [ init characters and monsters ]

03/8929: AD 00 18     LDA $1800
03/892C: C9 B6        CMP #$B6
03/892E: F0 04        BEQ $8934
03/8930: C9 B7        CMP #$B7
03/8932: D0 08        BNE $893C
03/8934: AD 01 18     LDA $1801
03/8937: F0 03        BEQ $893C       ; branch if not battle $01B7 (zeromus)
03/8939: EE 81 38     INC $3881
03/893C: 20 A8 94     JSR $94A8       ; load character properties
03/893F: 20 25 96     JSR $9625
03/8942: 20 CE 95     JSR $95CE
03/8945: AD A2 29     LDA $29A2
03/8948: 8D E5 38     STA $38E5
03/894B: 29 20        AND #$20
03/894D: 8D 8B 38     STA $388B
03/8950: F0 5D        BEQ $89AF
03/8952: 7B           TDC 
03/8953: AA           TAX 
03/8954: BF 0D FE 13  LDA $13FE0D,X   ; battles with auto-battle scripts
03/8958: CD 00 18     CMP $1800
03/895B: F0 09        BEQ $8966
03/895D: E8           INX 
03/895E: E8           INX 
03/895F: E0 10 00     CPX #$0010
03/8962: D0 F0        BNE $8954
03/8964: 80 49        BRA $89AF
03/8966: 86 84        STX $84
03/8968: BF 0E FE 13  LDA $13FE0E,X
03/896C: CD 01 18     CMP $1801
03/896F: D0 3E        BNE $89AF
03/8971: 8A           TXA 
03/8972: BF 1D FE 13  LDA $13FE1D,X   ; pointers to auto-battle scripts
03/8976: 85 80        STA $80
03/8978: BF 1E FE 13  LDA $13FE1E,X
03/897C: 85 81        STA $81
03/897E: A9 13        LDA #$13
03/8980: 85 82        STA $82
03/8982: 7B           TDC 
03/8983: A8           TAY 
03/8984: AA           TAX 
03/8985: B7 80        LDA [$80],Y
03/8987: 9D 8C 38     STA $388C,X     ; load auto-battle script
03/898A: C8           INY 
03/898B: E8           INX 
03/898C: C9 FF        CMP #$FF
03/898E: D0 F5        BNE $8985
03/8990: A5 84        LDA $84
03/8992: C9 0C        CMP #$0C
03/8994: F0 04        BEQ $899A
03/8996: C9 0E        CMP #$0E
03/8998: D0 15        BNE $89AF
; has golbez script
03/899A: 7B           TDC 
03/899B: AA           TAX 
03/899C: B7 80        LDA [$80],Y
03/899E: 9D 9A 38     STA $389A,X     ; golbez' auto-battle script
03/89A1: C8           INY 
03/89A2: E8           INX 
03/89A3: C9 FF        CMP #$FF
03/89A5: D0 F5        BNE $899C
03/89A7: A9 63        LDA #$63        ; monster slots 0 and 1 base agility = 99
03/89A9: 8D 90 21     STA $2190
03/89AC: 8D 10 22     STA $2210
03/89AF: 20 CC 8E     JSR $8ECC       ; load equipment properties
03/89B2: 9C 75 39     STZ $3975
03/89B5: AD 75 39     LDA $3975
03/89B8: AA           TAX 
03/89B9: BD 40 35     LDA $3540,X
03/89BC: D0 03        BNE $89C1
03/89BE: 20 37 98     JSR $9837       ; update character stats
03/89C1: EE 75 39     INC $3975
03/89C4: AD 75 39     LDA $3975
03/89C7: C9 05        CMP #$05
03/89C9: D0 EA        BNE $89B5
03/89CB: 7B           TDC 
03/89CC: AA           TAX 
03/89CD: A8           TAY 
03/89CE: 86 A9        STX $A9
03/89D0: 84 AB        STY $AB
03/89D2: A5 A9        LDA $A9
03/89D4: 20 89 84     JSR $8489       ; set current character/monster
03/89D7: A6 A6        LDX $A6
03/89D9: BD 01 20     LDA $2001,X
03/89DC: 29 0F        AND #$0F
03/89DE: 85 B7        STA $B7
03/89E0: 0A           ASL 
03/89E1: 18           CLC 
03/89E2: 65 B7        ADC $B7
03/89E4: 85 B7        STA $B7
03/89E6: 64 B8        STZ $B8
03/89E8: 64 B5        STZ $B5
03/89EA: A6 B7        LDX $B7
03/89EC: BF DD FD 13  LDA $13FDDD,X   ; spell lists for each character
03/89F0: C9 FF        CMP #$FF
03/89F2: D0 0F        BNE $8A03
03/89F4: 18           CLC 
03/89F5: A5 AB        LDA $AB
03/89F7: 69 60        ADC #$60
03/89F9: 85 AB        STA $AB
03/89FB: A5 AC        LDA $AC
03/89FD: 69 00        ADC #$00
03/89FF: 85 AC        STA $AC
03/8A01: 80 25        BRA $8A28
03/8A03: 85 DF        STA $DF
03/8A05: A9 18        LDA #$18
03/8A07: 85 E1        STA $E1
03/8A09: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8A0C: A6 E3        LDX $E3
03/8A0E: 64 AD        STZ $AD
03/8A10: A4 AB        LDY $AB
03/8A12: BF 60 15 00  LDA $001560,X
03/8A16: 99 7B 2C     STA $2C7B,Y
03/8A19: C8           INY 
03/8A1A: C8           INY 
03/8A1B: C8           INY 
03/8A1C: C8           INY 
03/8A1D: E8           INX 
03/8A1E: E6 AD        INC $AD
03/8A20: A5 AD        LDA $AD
03/8A22: C9 18        CMP #$18
03/8A24: D0 EC        BNE $8A12
03/8A26: 84 AB        STY $AB
03/8A28: E6 B7        INC $B7
03/8A2A: E6 B5        INC $B5
03/8A2C: A5 B5        LDA $B5
03/8A2E: C9 03        CMP #$03
03/8A30: F0 03        BEQ $8A35
03/8A32: 4C EA 89     JMP $89EA
03/8A35: E6 A9        INC $A9
03/8A37: A5 A9        LDA $A9
03/8A39: C9 05        CMP #$05
03/8A3B: F0 03        BEQ $8A40
03/8A3D: 4C D2 89     JMP $89D2
03/8A40: 7B           TDC 
03/8A41: AA           TAX 
03/8A42: 86 A9        STX $A9
03/8A44: A6 A9        LDX $A9
03/8A46: BD 7B 2C     LDA $2C7B,X
03/8A49: F0 24        BEQ $8A6F
03/8A4B: AA           TAX 
03/8A4C: 86 E5        STX $E5
03/8A4E: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/8A51: 86 80        STX $80
03/8A53: A9 0F        LDA #$0F
03/8A55: 85 82        STA $82
03/8A57: A9 06        LDA #$06        ; size: 6 bytes
03/8A59: 20 5E 84     JSR $845E       ; load array item
03/8A5C: A6 A9        LDX $A9
03/8A5E: AD 9C 28     LDA $289C
03/8A61: 29 E0        AND #$E0
03/8A63: 4A           LSR 
03/8A64: 9D 7A 2C     STA $2C7A,X
03/8A67: AD A1 28     LDA $28A1
03/8A6A: 29 7F        AND #$7F
03/8A6C: 9D 7D 2C     STA $2C7D,X
03/8A6F: E8           INX 
03/8A70: E8           INX 
03/8A71: E8           INX 
03/8A72: E8           INX 
03/8A73: 86 A9        STX $A9
03/8A75: E0 A0 05     CPX #$05A0
03/8A78: D0 CA        BNE $8A44
03/8A7A: 7B           TDC 
03/8A7B: AA           TAX 
03/8A7C: A8           TAY 
03/8A7D: BD 40 14     LDA $1440,X
03/8A80: 99 1B 32     STA $321B,Y
03/8A83: BD 41 14     LDA $1441,X
03/8A86: 99 1C 32     STA $321C,Y
03/8A89: E8           INX 
03/8A8A: E8           INX 
03/8A8B: C8           INY 
03/8A8C: C8           INY 
03/8A8D: C8           INY 
03/8A8E: C8           INY 
03/8A8F: E0 60 00     CPX #$0060
03/8A92: D0 E9        BNE $8A7D
03/8A94: 7B           TDC 
03/8A95: AA           TAX 
03/8A96: 86 A9        STX $A9
03/8A98: 64 C7        STZ $C7
03/8A9A: A6 A9        LDX $A9
03/8A9C: BD 1B 32     LDA $321B,X
03/8A9F: F0 73        BEQ $8B14
03/8AA1: C9 DE        CMP #$DE
03/8AA3: B0 6F        BCS $8B14
03/8AA5: C9 B0        CMP #$B0
03/8AA7: B0 44        BCS $8AED
03/8AA9: C9 6D        CMP #$6D
03/8AAB: B0 67        BCS $8B14
03/8AAD: C9 61        CMP #$61
03/8AAF: 90 04        BCC $8AB5
03/8AB1: A9 00        LDA #$00
03/8AB3: F0 5C        BEQ $8B11
03/8AB5: AA           TAX 
03/8AB6: 86 E5        STX $E5
03/8AB8: A2 00 91     LDX #$9100      ; 0F/9100 (weapon/armor properties)
03/8ABB: 86 80        STX $80
03/8ABD: A9 0F        LDA #$0F
03/8ABF: 85 82        STA $82
03/8AC1: A9 08        LDA #$08        ; size: 8 bytes
03/8AC3: 20 5E 84     JSR $845E       ; load array item
03/8AC6: AD 9C 28     LDA $289C
03/8AC9: 20 85 84     JSR $8485       ; lsr3
03/8ACC: 29 08        AND #$08
03/8ACE: 85 C7        STA $C7
03/8AD0: AD 9F 28     LDA $289F
03/8AD3: 48           PHA 
03/8AD4: AA           TAX 
03/8AD5: 86 E5        STX $E5
03/8AD7: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/8ADA: 86 80        STX $80
03/8ADC: A9 0F        LDA #$0F
03/8ADE: 85 82        STA $82
03/8AE0: A9 06        LDA #$06        ; size: 6 bytes
03/8AE2: 20 5E 84     JSR $845E       ; load array item
03/8AE5: A6 A9        LDX $A9
03/8AE7: 68           PLA 
03/8AE8: 9D 1D 32     STA $321D,X
03/8AEB: 80 1C        BRA $8B09
03/8AED: 38           SEC 
03/8AEE: E9 B0        SBC #$B0
03/8AF0: AA           TAX 
03/8AF1: 86 E5        STX $E5
03/8AF3: A2 80 96     LDX #$9680      ; 0F/9680 (item properties)
03/8AF6: 86 80        STX $80
03/8AF8: A9 0F        LDA #$0F
03/8AFA: 85 82        STA $82
03/8AFC: A9 06        LDA #$06        ; size: 6 bytes
03/8AFE: 20 5E 84     JSR $845E       ; load array item
03/8B01: A6 A9        LDX $A9
03/8B03: AD 9F 28     LDA $289F
03/8B06: 9D 1D 32     STA $321D,X
03/8B09: AD 9C 28     LDA $289C
03/8B0C: 29 E0        AND #$E0
03/8B0E: 05 C7        ORA $C7
03/8B10: 4A           LSR 
03/8B11: 9D 1A 32     STA $321A,X
03/8B14: E8           INX 
03/8B15: E8           INX 
03/8B16: E8           INX 
03/8B17: E8           INX 
03/8B18: 86 A9        STX $A9
03/8B1A: E0 C0 00     CPX #$00C0
03/8B1D: F0 03        BEQ $8B22
03/8B1F: 4C 98 8A     JMP $8A98
03/8B22: 7B           TDC 
03/8B23: AA           TAX 
03/8B24: 86 A9        STX $A9
03/8B26: 64 C7        STZ $C7
03/8B28: A6 A9        LDX $A9
03/8B2A: BD DB 32     LDA $32DB,X
03/8B2D: F0 41        BEQ $8B70
03/8B2F: AA           TAX 
03/8B30: 86 E5        STX $E5
03/8B32: A2 00 91     LDX #$9100
03/8B35: 86 80        STX $80
03/8B37: A9 0F        LDA #$0F
03/8B39: 85 82        STA $82
03/8B3B: A9 08        LDA #$08
03/8B3D: 20 5E 84     JSR $845E       ; load array item
03/8B40: AD 9C 28     LDA $289C
03/8B43: 20 85 84     JSR $8485       ; lsr3
03/8B46: 29 08        AND #$08
03/8B48: 85 C7        STA $C7
03/8B4A: A6 A9        LDX $A9
03/8B4C: AD 9F 28     LDA $289F
03/8B4F: 9D DD 32     STA $32DD,X
03/8B52: AA           TAX 
03/8B53: 86 E5        STX $E5
03/8B55: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/8B58: 86 80        STX $80
03/8B5A: A9 0F        LDA #$0F
03/8B5C: 85 82        STA $82
03/8B5E: A9 06        LDA #$06
03/8B60: 20 5E 84     JSR $845E       ; load array item
03/8B63: A6 A9        LDX $A9
03/8B65: AD 9C 28     LDA $289C
03/8B68: 29 E0        AND #$E0
03/8B6A: 05 C7        ORA $C7
03/8B6C: 4A           LSR 
03/8B6D: 9D DA 32     STA $32DA,X
03/8B70: E8           INX 
03/8B71: E8           INX 
03/8B72: E8           INX 
03/8B73: E8           INX 
03/8B74: 86 A9        STX $A9
03/8B76: E0 28 00     CPX #$0028
03/8B79: D0 AB        BNE $8B26
03/8B7B: 7B           TDC 
03/8B7C: A8           TAY 
03/8B7D: 84 A9        STY $A9
03/8B7F: A6 A9        LDX $A9
03/8B81: BD 00 20     LDA $2000,X
03/8B84: 29 1F        AND #$1F
03/8B86: D0 01        BNE $8B89
03/8B88: 1A           INC 
03/8B89: 3A           DEC 
03/8B8A: 85 DF        STA $DF
03/8B8C: A9 05        LDA #$05
03/8B8E: 85 E1        STA $E1
03/8B90: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8B93: A9 05        LDA #$05
03/8B95: 85 AB        STA $AB
03/8B97: A6 E3        LDX $E3
03/8B99: BF 55 FD 13  LDA $13FD55,X   ; battle commands for each character
03/8B9D: 99 03 33     STA $3303,Y
03/8BA0: C9 FF        CMP #$FF
03/8BA2: D0 03        BNE $8BA7
03/8BA4: DA           PHX 
03/8BA5: 80 06        BRA $8BAD
03/8BA7: DA           PHX 
03/8BA8: AA           TAX 
03/8BA9: BF C3 FD 13  LDA $13FDC3,X   ; command targeting flags
03/8BAD: 99 02 33     STA $3302,Y
03/8BB0: FA           PLX 
03/8BB1: E8           INX 
03/8BB2: C8           INY 
03/8BB3: C8           INY 
03/8BB4: C8           INY 
03/8BB5: C8           INY 
03/8BB6: C6 AB        DEC $AB
03/8BB8: A5 AB        LDA $AB
03/8BBA: D0 DD        BNE $8B99
03/8BBC: A9 1A        LDA #$1A
03/8BBE: 99 03 33     STA $3303,Y
03/8BC1: C8           INY 
03/8BC2: C8           INY 
03/8BC3: C8           INY 
03/8BC4: C8           INY 
03/8BC5: A9 1B        LDA #$1B
03/8BC7: 99 03 33     STA $3303,Y
03/8BCA: C8           INY 
03/8BCB: C8           INY 
03/8BCC: C8           INY 
03/8BCD: C8           INY 
03/8BCE: 08           PHP 
03/8BCF: C2 20        REP #$20
03/8BD1: 18           CLC 
03/8BD2: A5 A9        LDA $A9
03/8BD4: 69 80 00     ADC #$0080
03/8BD7: 85 A9        STA $A9
03/8BD9: 7B           TDC 
03/8BDA: 28           PLP 
03/8BDB: C0 8C 00     CPY #$008C
03/8BDE: D0 9F        BNE $8B7F
03/8BE0: 7B           TDC 
03/8BE1: AA           TAX 
03/8BE2: 86 B9        STX $B9
03/8BE4: 64 BD        STZ $BD
03/8BE6: A6 B9        LDX $B9
03/8BE8: BD B5 29     LDA $29B5,X
03/8BEB: C9 FF        CMP #$FF
03/8BED: D0 0A        BNE $8BF9
03/8BEF: 8A           TXA 
03/8BF0: 18           CLC 
03/8BF1: 69 05        ADC #$05
03/8BF3: AA           TAX 
03/8BF4: FE 40 35     INC $3540,X
03/8BF7: 80 15        BRA $8C0E
03/8BF9: AA           TAX 
03/8BFA: AD 9C 29     LDA $299C
03/8BFD: 20 64 85     JSR $8564       ; test bit
03/8C00: F0 02        BEQ $8C04
03/8C02: E6 BD        INC $BD
03/8C04: BD AD 29     LDA $29AD,X
03/8C07: 85 BB        STA $BB
03/8C09: 64 BC        STZ $BC
03/8C0B: 20 CA 8F     JSR $8FCA       ; init monster properties
03/8C0E: E6 B9        INC $B9
03/8C10: A5 B9        LDA $B9
03/8C12: C9 08        CMP #$08
03/8C14: D0 CE        BNE $8BE4
03/8C16: AD A0 29     LDA $29A0
03/8C19: 29 03        AND #$03
03/8C1B: F0 49        BEQ $8C66
03/8C1D: C9 01        CMP #$01
03/8C1F: D0 11        BNE $8C32
03/8C21: 7B           TDC 
03/8C22: AA           TAX 
03/8C23: BD B5 29     LDA $29B5,X
03/8C26: C9 01        CMP #$01
03/8C28: F0 03        BEQ $8C2D
03/8C2A: E8           INX 
03/8C2B: 80 F6        BRA $8C23
03/8C2D: 20 99 8E     JSR $8E99       ; hide monster
03/8C30: 80 34        BRA $8C66
03/8C32: C9 02        CMP #$02
03/8C34: D0 16        BNE $8C4C
03/8C36: 7B           TDC 
03/8C37: AA           TAX 
03/8C38: 86 C7        STX $C7
03/8C3A: A6 C7        LDX $C7
03/8C3C: BD B5 29     LDA $29B5,X
03/8C3F: F0 07        BEQ $8C48
03/8C41: C9 FF        CMP #$FF
03/8C43: F0 21        BEQ $8C66
03/8C45: 20 99 8E     JSR $8E99       ; hide monster
03/8C48: E6 C7        INC $C7
03/8C4A: 80 EE        BRA $8C3A
03/8C4C: 7B           TDC 
03/8C4D: AA           TAX 
03/8C4E: 86 C7        STX $C7
03/8C50: A6 C7        LDX $C7
03/8C52: BD B5 29     LDA $29B5,X
03/8C55: C9 FF        CMP #$FF
03/8C57: F0 0D        BEQ $8C66
03/8C59: C9 02        CMP #$02
03/8C5B: D0 05        BNE $8C62
03/8C5D: F0 00        BEQ $8C5F
03/8C5F: 20 99 8E     JSR $8E99       ; hide monster
03/8C62: E6 C7        INC $C7
03/8C64: 80 EA        BRA $8C50
03/8C66: AD 81 35     LDA $3581
03/8C69: 29 08        AND #$08
03/8C6B: F0 08        BEQ $8C75
03/8C6D: A9 80        LDA #$80
03/8C6F: 8D D8 38     STA $38D8
03/8C72: 4C 44 8D     JMP $8D44
03/8C75: AD 82 35     LDA $3582
03/8C78: D0 F8        BNE $8C72       ; branch if a boss battle
03/8C7A: AD E5 38     LDA $38E5
03/8C7D: 29 01        AND #$01
03/8C7F: D0 F1        BNE $8C72
03/8C81: AD EF 38     LDA $38EF
03/8C84: D0 EC        BNE $8C72
03/8C86: 7B           TDC 
03/8C87: AA           TAX 
03/8C88: A8           TAY 
03/8C89: 86 A9        STX $A9
03/8C8B: 86 AB        STX $AB
03/8C8D: 86 AD        STX $AD
03/8C8F: B9 40 35     LDA $3540,Y
03/8C92: D0 10        BNE $8CA4
03/8C94: 18           CLC 
03/8C95: BD 02 20     LDA $2002,X
03/8C98: 65 A9        ADC $A9
03/8C9A: 85 A9        STA $A9
03/8C9C: A9 00        LDA #$00
03/8C9E: 65 AA        ADC $AA
03/8CA0: 85 AA        STA $AA
03/8CA2: E6 AD        INC $AD
03/8CA4: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/8CA7: C8           INY 
03/8CA8: C0 05 00     CPY #$0005
03/8CAB: D0 E2        BNE $8C8F
03/8CAD: B9 40 35     LDA $3540,Y
03/8CB0: D0 10        BNE $8CC2
03/8CB2: 18           CLC 
03/8CB3: BD 02 20     LDA $2002,X
03/8CB6: 65 AB        ADC $AB
03/8CB8: 85 AB        STA $AB
03/8CBA: A9 00        LDA #$00
03/8CBC: 65 AC        ADC $AC
03/8CBE: 85 AC        STA $AC
03/8CC0: E6 AE        INC $AE
03/8CC2: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/8CC5: C8           INY 
03/8CC6: C0 08 00     CPY #$0008
03/8CC9: D0 E2        BNE $8CAD
03/8CCB: A6 A9        LDX $A9
03/8CCD: 8E 45 39     STX $3945
03/8CD0: A5 AD        LDA $AD
03/8CD2: AA           TAX 
03/8CD3: 8E 47 39     STX $3947
03/8CD6: 20 07 84     JSR $8407       ; divide
03/8CD9: AE 49 39     LDX $3949
03/8CDC: 8A           TXA 
03/8CDD: 8D D4 38     STA $38D4
03/8CE0: 7B           TDC 
03/8CE1: A6 AB        LDX $AB
03/8CE3: 8E 45 39     STX $3945
03/8CE6: A5 AE        LDA $AE
03/8CE8: AA           TAX 
03/8CE9: 8E 47 39     STX $3947
03/8CEC: 20 07 84     JSR $8407       ; divide
03/8CEF: AE 49 39     LDX $3949
03/8CF2: 8A           TXA 
03/8CF3: 8D D5 38     STA $38D5
03/8CF6: 7B           TDC 
03/8CF7: 7B           TDC 
03/8CF8: AA           TAX 
03/8CF9: 86 A9        STX $A9
03/8CFB: E6 A9        INC $A9
03/8CFD: E6 AA        INC $AA
03/8CFF: A9 63        LDA #$63
03/8D01: 20 79 83     JSR $8379       ; random (X..A)
03/8D04: CD D4 38     CMP $38D4
03/8D07: B0 02        BCS $8D0B
03/8D09: E6 A9        INC $A9
03/8D0B: 20 8B 85     JSR $858B       ; random (0..98)
03/8D0E: CD D5 38     CMP $38D5
03/8D11: B0 02        BCS $8D15
03/8D13: E6 AA        INC $AA
03/8D15: A5 A9        LDA $A9
03/8D17: C5 AA        CMP $AA
03/8D19: F0 29        BEQ $8D44
03/8D1B: 90 08        BCC $8D25
03/8D1D: EE D7 38     INC $38D7
03/8D20: EE D8 38     INC $38D8
03/8D23: 80 1F        BRA $8D44
03/8D25: A9 80        LDA #$80
03/8D27: 8D D7 38     STA $38D7
03/8D2A: 8D D8 38     STA $38D8
03/8D2D: AD D5 38     LDA $38D5
03/8D30: 4A           LSR 
03/8D31: 85 A9        STA $A9
03/8D33: 7B           TDC 
03/8D34: AA           TAX 
03/8D35: AD D4 38     LDA $38D4
03/8D38: 20 79 83     JSR $8379       ; random (X..A)
03/8D3B: C5 A9        CMP $A9
03/8D3D: B0 05        BCS $8D44
03/8D3F: A9 08        LDA #$08
03/8D41: 8D 81 35     STA $3581
03/8D44: 7B           TDC 
03/8D45: AA           TAX 
03/8D46: A8           TAY 
03/8D47: 86 C7        STX $C7
03/8D49: B9 40 35     LDA $3540,Y
03/8D4C: D0 11        BNE $8D5F
03/8D4E: A5 C7        LDA $C7
03/8D50: D0 28        BNE $8D7A
03/8D52: BD 00 20     LDA $2000,X
03/8D55: 29 1F        AND #$1F
03/8D57: C9 01        CMP #$01
03/8D59: F0 1F        BEQ $8D7A
03/8D5B: C9 0B        CMP #$0B
03/8D5D: F0 18        BEQ $8D77
03/8D5F: C2 20        REP #$20
03/8D61: 8A           TXA 
03/8D62: 18           CLC 
03/8D63: 69 80 00     ADC #$0080
03/8D66: AA           TAX 
03/8D67: 7B           TDC 
03/8D68: E2 20        SEP #$20
03/8D6A: C8           INY 
03/8D6B: C0 05 00     CPY #$0005
03/8D6E: D0 D9        BNE $8D49
03/8D70: E6 C7        INC $C7
03/8D72: 7B           TDC 
03/8D73: AA           TAX 
03/8D74: A8           TAY 
03/8D75: 80 D2        BRA $8D49
03/8D77: 8C 5E 35     STY $355E
03/8D7A: BD 15 20     LDA $2015,X
03/8D7D: AA           TAX 
03/8D7E: 8E 3D 39     STX $393D
03/8D81: A2 32 00     LDX #$0032
03/8D84: 8E 3F 39     STX $393F
03/8D87: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/8D8A: AE 41 39     LDX $3941
03/8D8D: 86 CB        STX $CB
03/8D8F: 7B           TDC 
03/8D90: AA           TAX 
03/8D91: 86 C7        STX $C7
03/8D93: 86 C9        STX $C9
03/8D95: A6 C9        LDX $C9
03/8D97: BD 40 35     LDA $3540,X
03/8D9A: D0 31        BNE $8DCD
03/8D9C: A6 C7        LDX $C7
03/8D9E: BD 15 20     LDA $2015,X
03/8DA1: 85 DF        STA $DF
03/8DA3: A9 0A        LDA #$0A
03/8DA5: 85 E1        STA $E1
03/8DA7: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8DAA: A6 CB        LDX $CB
03/8DAC: 8E 45 39     STX $3945
03/8DAF: A6 E3        LDX $E3
03/8DB1: 8E 47 39     STX $3947
03/8DB4: 20 07 84     JSR $8407       ; divide
03/8DB7: AE 49 39     LDX $3949
03/8DBA: D0 03        BNE $8DBF
03/8DBC: EE 49 39     INC $3949
03/8DBF: A6 C7        LDX $C7
03/8DC1: AD 49 39     LDA $3949
03/8DC4: 9D 60 20     STA $2060,X
03/8DC7: AD 4A 39     LDA $394A
03/8DCA: 9D 61 20     STA $2061,X
03/8DCD: C2 20        REP #$20
03/8DCF: 18           CLC 
03/8DD0: A5 C7        LDA $C7
03/8DD2: 69 80 00     ADC #$0080
03/8DD5: 85 C7        STA $C7
03/8DD7: 7B           TDC 
03/8DD8: E2 20        SEP #$20
03/8DDA: E6 C9        INC $C9
03/8DDC: A5 C9        LDA $C9
03/8DDE: C9 0D        CMP #$0D
03/8DE0: D0 B3        BNE $8D95
03/8DE2: 7B           TDC 
03/8DE3: AA           TAX 
03/8DE4: 86 C7        STX $C7
03/8DE6: A6 C7        LDX $C7
03/8DE8: BD 40 35     LDA $3540,X
03/8DEB: D0 66        BNE $8E53
03/8DED: 8A           TXA 
03/8DEE: 85 DF        STA $DF
03/8DF0: A9 80        LDA #$80
03/8DF2: 85 E1        STA $E1
03/8DF4: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8DF7: A6 E3        LDX $E3
03/8DF9: BD 03 20     LDA $2003,X
03/8DFC: 30 55        BMI $8E53
03/8DFE: A5 C7        LDA $C7
03/8E00: C9 05        CMP #$05
03/8E02: B0 19        BCS $8E1D
03/8E04: AD 81 35     LDA $3581
03/8E07: 29 08        AND #$08
03/8E09: F0 12        BEQ $8E1D
03/8E0B: BD 01 20     LDA $2001,X
03/8E0E: 48           PHA 
03/8E0F: 29 7F        AND #$7F
03/8E11: 85 A9        STA $A9
03/8E13: 68           PLA 
03/8E14: 29 80        AND #$80
03/8E16: 49 80        EOR #$80
03/8E18: 05 A9        ORA $A9
03/8E1A: 9D 01 20     STA $2001,X
03/8E1D: 64 D6        STZ $D6
03/8E1F: A6 C7        LDX $C7
03/8E21: 8A           TXA 
03/8E22: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/8E25: AD D8 38     LDA $38D8
03/8E28: F0 24        BEQ $8E4E
03/8E2A: 30 16        BMI $8E42
03/8E2C: A5 C7        LDA $C7
03/8E2E: C9 05        CMP #$05
03/8E30: 90 16        BCC $8E48
03/8E32: 06 D4        ASL $D4
03/8E34: 26 D5        ROL $D5
03/8E36: A5 D4        LDA $D4
03/8E38: 05 D5        ORA $D5
03/8E3A: D0 12        BNE $8E4E
03/8E3C: 1A           INC 
03/8E3D: 1A           INC 
03/8E3E: 85 D4        STA $D4
03/8E40: 80 0C        BRA $8E4E
03/8E42: A5 C7        LDA $C7
03/8E44: C9 05        CMP #$05
03/8E46: 90 EA        BCC $8E32
03/8E48: A9 01        LDA #$01        ; duration: 1
03/8E4A: 85 D4        STA $D4
03/8E4C: 64 D5        STZ $D5
03/8E4E: A9 03        LDA #$03        ; action timer
03/8E50: 20 C8 85     JSR $85C8       ; set timer
03/8E53: E6 C7        INC $C7
03/8E55: A5 C7        LDA $C7
03/8E57: C9 0D        CMP #$0D
03/8E59: D0 8B        BNE $8DE6
03/8E5B: C2 20        REP #$20
03/8E5D: A9 FF FF     LDA #$FFFF
03/8E60: 85 A9        STA $A9
03/8E62: A0 0D 00     LDY #$000D
03/8E65: 7B           TDC 
03/8E66: AA           TAX 
03/8E67: BD 07 2A     LDA $2A07,X
03/8E6A: F0 06        BEQ $8E72
03/8E6C: C5 A9        CMP $A9
03/8E6E: B0 02        BCS $8E72
03/8E70: 85 A9        STA $A9
03/8E72: 8A           TXA 
03/8E73: 18           CLC 
03/8E74: 69 15 00     ADC #$0015
03/8E77: AA           TAX 
03/8E78: 88           DEY 
03/8E79: D0 EC        BNE $8E67
03/8E7B: C6 A9        DEC $A9
03/8E7D: BB           TYX 
03/8E7E: 38           SEC 
03/8E7F: BD 07 2A     LDA $2A07,X
03/8E82: F0 05        BEQ $8E89
03/8E84: E5 A9        SBC $A9
03/8E86: 9D 07 2A     STA $2A07,X
03/8E89: 8A           TXA 
03/8E8A: 18           CLC 
03/8E8B: 69 15 00     ADC #$0015
03/8E8E: AA           TAX 
03/8E8F: C8           INY 
03/8E90: C0 0D 00     CPY #$000D
03/8E93: D0 E9        BNE $8E7E
03/8E95: 7B           TDC 
03/8E96: E2 20        SEP #$20
03/8E98: 60           RTS 

; [ hide monster ]

03/8E99: 8A           TXA 
03/8E9A: 18           CLC 
03/8E9B: 69 05        ADC #$05
03/8E9D: 85 8A        STA $8A
03/8E9F: BD B5 29     LDA $29B5,X     ; save monster type
03/8EA2: 85 A9        STA $A9
03/8EA4: A9 FF        LDA #$FF
03/8EA6: 9D B5 29     STA $29B5,X     ; clear monster type
03/8EA9: A5 A9        LDA $A9
03/8EAB: AA           TAX 
03/8EAC: DE CA 29     DEC $29CA,X     ; decrement monster type count
03/8EAF: CE CD 29     DEC $29CD       ; decrement total monster count
03/8EB2: A5 8A        LDA $8A
03/8EB4: 85 DF        STA $DF
03/8EB6: A9 80        LDA #$80
03/8EB8: 85 E1        STA $E1
03/8EBA: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8EBD: A6 E3        LDX $E3
03/8EBF: A9 80        LDA #$80
03/8EC1: 9D 03 20     STA $2003,X     ; set dead status
03/8EC4: A5 8A        LDA $8A
03/8EC6: 0A           ASL 
03/8EC7: AA           TAX 
03/8EC8: 9E EB 29     STZ $29EB,X     ; disable all timers
03/8ECB: 60           RTS 

; [ load equipment properties ]

03/8ECC: A0 30 20     LDY #$2030      ; equipment in character properties
03/8ECF: 84 86        STY $86
03/8ED1: A0 80 27     LDY #$2780      ; pointer to equipment properties
03/8ED4: 84 84        STY $84
03/8ED6: 64 A9        STZ $A9
; start of character loop
03/8ED8: 7B           TDC 
03/8ED9: AA           TAX 
03/8EDA: 86 AB        STX $AB
03/8EDC: 9B           TXY 
03/8EDD: B1 86        LDA ($86),Y     ; item id
03/8EDF: D0 02        BNE $8EE3
03/8EE1: A9 60        LDA #$60        ; empty armor slot
03/8EE3: 95 AD        STA $AD,X
03/8EE5: C8           INY 
03/8EE6: E8           INX 
03/8EE7: E0 03 00     CPX #$0003      ; copy helmet, armor, and accessory
03/8EEA: D0 F1        BNE $8EDD
03/8EEC: B1 86        LDA ($86),Y
03/8EEE: 95 AD        STA $AD,X
03/8EF0: C8           INY 
03/8EF1: E8           INX 
03/8EF2: E0 07 00     CPX #$0007      ; copy left and right hand item and qty
03/8EF5: D0 F5        BNE $8EEC
03/8EF7: A5 A9        LDA $A9
03/8EF9: 20 7E 84     JSR $847E       ; asl3
03/8EFC: AA           TAX 
03/8EFD: A5 B0        LDA $B0
03/8EFF: 9D DB 32     STA $32DB,X     ; left hand item
03/8F02: A5 B1        LDA $B1
03/8F04: 9D DC 32     STA $32DC,X     ; left hand quantity
03/8F07: A5 B2        LDA $B2
03/8F09: 9D DF 32     STA $32DF,X     ; right hand item
03/8F0C: A5 B3        LDA $B3
03/8F0E: 9D E0 32     STA $32E0,X     ; right hand quantity
03/8F11: A5 B2        LDA $B2
03/8F13: 85 B1        STA $B1
03/8F15: 64 B7        STZ $B7
03/8F17: 64 B8        STZ $B8
03/8F19: A5 B0        LDA $B0
03/8F1B: F0 16        BEQ $8F33       ; branch if no left hand item
03/8F1D: C9 4D        CMP #$4D
03/8F1F: 90 12        BCC $8F33       ; branch if a weapon
03/8F21: C9 54        CMP #$54
03/8F23: B0 06        BCS $8F2B       ; branch if not a bow
03/8F25: A9 80        LDA #$80
03/8F27: 85 B7        STA $B7
03/8F29: 80 08        BRA $8F33
03/8F2B: C9 61        CMP #$61
03/8F2D: B0 04        BCS $8F33       ; branch if not arrows
03/8F2F: A9 40        LDA #$40
03/8F31: 85 B7        STA $B7
03/8F33: A5 B1        LDA $B1
03/8F35: F0 16        BEQ $8F4D       ; branch if no right hand item
03/8F37: C9 4D        CMP #$4D
03/8F39: 90 12        BCC $8F4D
03/8F3B: C9 54        CMP #$54
03/8F3D: B0 06        BCS $8F45
03/8F3F: A9 80        LDA #$80
03/8F41: 85 B8        STA $B8
03/8F43: 80 08        BRA $8F4D
03/8F45: C9 61        CMP #$61
03/8F47: B0 04        BCS $8F4D
03/8F49: A9 40        LDA #$40
03/8F4B: 85 B8        STA $B8
03/8F4D: A5 B7        LDA $B7
03/8F4F: 05 B8        ORA $B8
03/8F51: F0 08        BEQ $8F5B       ; branch if no bow or arrows
03/8F53: 49 C0        EOR #$C0
03/8F55: F0 04        BEQ $8F5B       ; branch if not both bow and arrow
03/8F57: 64 B0        STZ $B0         ; treat as unarmed
03/8F59: 64 B1        STZ $B1
; start of equipment slot loop
03/8F5B: A6 AB        LDX $AB
03/8F5D: B5 AD        LDA $AD,X       ; item id
03/8F5F: AA           TAX 
03/8F60: 86 E5        STX $E5
03/8F62: A2 00 91     LDX #$9100      ; 0F/9100 (equipment properties)
03/8F65: 86 80        STX $80
03/8F67: A9 0F        LDA #$0F
03/8F69: 85 82        STA $82
03/8F6B: A9 08        LDA #$08
03/8F6D: 20 5E 84     JSR $845E       ; load array item
03/8F70: 7B           TDC 
03/8F71: AA           TAX 
03/8F72: A8           TAY 
03/8F73: BD 9C 28     LDA $289C,X     ; copy to equipment data
03/8F76: 91 84        STA ($84),Y
03/8F78: C8           INY 
03/8F79: E8           INX 
03/8F7A: E0 08 00     CPX #$0008
03/8F7D: D0 F4        BNE $8F73
03/8F7F: AD A0 28     LDA $28A0       ; element/status effect
03/8F82: 29 7F        AND #$7F
03/8F84: 85 DF        STA $DF
03/8F86: A9 03        LDA #$03
03/8F88: 85 E1        STA $E1
03/8F8A: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/8F8D: A6 E3        LDX $E3
03/8F8F: BF 90 A5 0F  LDA $0FA590,X   ; element/status effects
03/8F93: 91 84        STA ($84),Y
03/8F95: C8           INY 
03/8F96: E8           INX 
03/8F97: C0 0B 00     CPY #$000B
03/8F9A: D0 F3        BNE $8F8F
03/8F9C: 18           CLC             ; next equipment slot
03/8F9D: A5 84        LDA $84
03/8F9F: 69 0B        ADC #$0B
03/8FA1: 85 84        STA $84
03/8FA3: A5 85        LDA $85
03/8FA5: 69 00        ADC #$00
03/8FA7: 85 85        STA $85
03/8FA9: E6 AB        INC $AB
03/8FAB: A5 AB        LDA $AB
03/8FAD: C9 05        CMP #$05
03/8FAF: D0 AA        BNE $8F5B
03/8FB1: 18           CLC             ; next character
03/8FB2: A5 86        LDA $86
03/8FB4: 69 80        ADC #$80
03/8FB6: 85 86        STA $86
03/8FB8: A5 87        LDA $87
03/8FBA: 69 00        ADC #$00
03/8FBC: 85 87        STA $87
03/8FBE: E6 A9        INC $A9
03/8FC0: A5 A9        LDA $A9
03/8FC2: C9 05        CMP #$05
03/8FC4: F0 03        BEQ $8FC9
03/8FC6: 4C D8 8E     JMP $8ED8
03/8FC9: 60           RTS 

; [ init monster properties ]

03/8FCA: A5 B9        LDA $B9
03/8FCC: 8D A0 35     STA $35A0
03/8FCF: 0A           ASL 
03/8FD0: 18           CLC 
03/8FD1: 69 0A        ADC #$0A
03/8FD3: AA           TAX 
03/8FD4: A9 40        LDA #$40        ; enable action timer
03/8FD6: 9D EB 29     STA $29EB,X
03/8FD9: C2 20        REP #$20
03/8FDB: A5 BB        LDA $BB
03/8FDD: 0A           ASL 
03/8FDE: AA           TAX 
03/8FDF: 38           SEC 
03/8FE0: BF A0 A6 0E  LDA $0EA6A0,X   ; pointers to monster properties
03/8FE4: E9 60 A8     SBC #$A860
03/8FE7: AA           TAX 
03/8FE8: 7B           TDC 
03/8FE9: E2 20        SEP #$20
03/8FEB: 7B           TDC 
03/8FEC: A8           TAY 
03/8FED: BF 60 A8 0E  LDA $0EA860,X   ; monster properties
03/8FF1: 99 9C 28     STA $289C,Y
03/8FF4: E8           INX 
03/8FF5: C8           INY 
03/8FF6: C0 14 00     CPY #$0014
03/8FF9: D0 F2        BNE $8FED
03/8FFB: 18           CLC 
03/8FFC: AD A0 35     LDA $35A0
03/8FFF: 69 05        ADC #$05
03/9001: 20 89 84     JSR $8489       ; set current character/monster
03/9004: A6 A6        LDX $A6
03/9006: A5 BD        LDA $BD
03/9008: F0 14        BEQ $901E
03/900A: A9 20        LDA #$20
03/900C: 9D 05 20     STA $2005,X
03/900F: DA           PHX 
03/9010: AD A0 35     LDA $35A0
03/9013: AA           TAX 
03/9014: BD B5 29     LDA $29B5,X
03/9017: AA           TAX 
03/9018: A9 01        LDA #$01
03/901A: 9D D0 38     STA $38D0,X
03/901D: FA           PLX 
03/901E: AD 9C 28     LDA $289C
03/9021: 9D 70 20     STA $2070,X     ; monster level and boss flag
03/9024: 10 03        BPL $9029
03/9026: EE 82 35     INC $3582       ; boss flag
03/9029: 29 7F        AND #$7F
03/902B: 9D 02 20     STA $2002,X     ; monster level
03/902E: 18           CLC 
03/902F: 69 0A        ADC #$0A
03/9031: 9D 2F 20     STA $202F,X     ; monster level + 10
03/9034: AD 9D 28     LDA $289D
03/9037: 9D 07 20     STA $2007,X
03/903A: 9D 09 20     STA $2009,X
03/903D: AD 9E 28     LDA $289E
03/9040: 9D 08 20     STA $2008,X
03/9043: 9D 0A 20     STA $200A,X
03/9046: C2 20        REP #$20
03/9048: AD 9D 28     LDA $289D
03/904B: 20 84 84     JSR $8484       ; lsr4
03/904E: 9D 0B 20     STA $200B,X
03/9051: 9D 0D 20     STA $200D,X
03/9054: 7B           TDC 
03/9055: E2 20        SEP #$20
03/9057: DA           PHX 
03/9058: AD A2 28     LDA $28A2
03/905B: 29 3F        AND #$3F
03/905D: 0A           ASL 
03/905E: AA           TAX 
03/905F: BF 21 A6 0E  LDA $0EA621,X
03/9063: 85 A9        STA $A9
03/9065: BF 20 A6 0E  LDA $0EA620,X
03/9069: AA           TAX 
03/906A: A5 A9        LDA $A9
03/906C: 20 79 83     JSR $8379       ; random (X..A)
03/906F: FA           PLX 
03/9070: 9D 15 20     STA $2015,X
03/9073: AD A2 29     LDA $29A2
03/9076: 29 20        AND #$20
03/9078: F0 07        BEQ $9081
03/907A: A9 01        LDA #$01        ; auto-battle speed modifier
03/907C: 9D 3B 20     STA $203B,X
03/907F: 80 05        BRA $9086
03/9081: A9 10        LDA #$10        ; normal speed modifier
03/9083: 9D 3B 20     STA $203B,X
03/9086: AD A4 28     LDA $28A4
03/9089: 8D A1 35     STA $35A1
03/908C: DA           PHX 
03/908D: A5 B9        LDA $B9
03/908F: AA           TAX 
03/9090: BD B5 29     LDA $29B5,X
03/9093: AA           TAX 
03/9094: A5 BB        LDA $BB
03/9096: 9D 8B 35     STA $358B,X
03/9099: 9D 88 35     STA $3588,X
03/909C: AD A3 28     LDA $28A3
03/909F: 9D 8E 35     STA $358E,X
03/90A2: FA           PLX 
03/90A3: 9D 73 20     STA $2073,X     ; monster item set and drop rate
03/90A6: AD 9F 28     LDA $289F
03/90A9: 20 89 94     JSR $9489       ; load monster attack/defense values
03/90AC: AD 1C 29     LDA $291C
03/90AF: 9D 1B 20     STA $201B,X
03/90B2: AD 1D 29     LDA $291D
03/90B5: 9D 1C 20     STA $201C,X
03/90B8: AD 1E 29     LDA $291E
03/90BB: 9D 1D 20     STA $201D,X
03/90BE: AD A0 28     LDA $28A0
03/90C1: 20 89 94     JSR $9489       ; load monster attack/defense values
03/90C4: AD 1C 29     LDA $291C
03/90C7: 9D 28 20     STA $2028,X
03/90CA: AD 1D 29     LDA $291D
03/90CD: 9D 2A 20     STA $202A,X
03/90D0: AD 1E 29     LDA $291E
03/90D3: 9D 2A 20     STA $202A,X
03/90D6: AD A1 28     LDA $28A1
03/90D9: 20 89 94     JSR $9489       ; load monster attack/defense values
03/90DC: AD 1C 29     LDA $291C
03/90DF: 9D 22 20     STA $2022,X
03/90E2: AD 1D 29     LDA $291D
03/90E5: 9D 24 20     STA $2024,X
03/90E8: AD 1E 29     LDA $291E
03/90EB: 9D 24 20     STA $2024,X
03/90EE: AD A5 28     LDA $28A5
03/90F1: D0 03        BNE $90F6
03/90F3: 4C E5 92     JMP $92E5
03/90F6: 7B           TDC 
03/90F7: A8           TAY 
03/90F8: AD A5 28     LDA $28A5
03/90FB: 29 80        AND #$80
03/90FD: F0 15        BEQ $9114
03/90FF: B9 A6 28     LDA $28A6,Y
03/9102: 9D 19 20     STA $2019,X
03/9105: C8           INY 
03/9106: B9 A6 28     LDA $28A6,Y
03/9109: 9D 1E 20     STA $201E,X
03/910C: C8           INY 
03/910D: B9 A6 28     LDA $28A6,Y
03/9110: 9D 1F 20     STA $201F,X
03/9113: C8           INY 
03/9114: AD A5 28     LDA $28A5
03/9117: 29 40        AND #$40
03/9119: F0 1C        BEQ $9137
03/911B: B9 A6 28     LDA $28A6,Y
03/911E: 10 05        BPL $9125
03/9120: 9D 26 20     STA $2026,X
03/9123: 80 03        BRA $9128
03/9125: 9D 25 20     STA $2025,X
03/9128: C8           INY 
03/9129: B9 A6 28     LDA $28A6,Y
03/912C: 9D 2B 20     STA $202B,X
03/912F: C8           INY 
03/9130: B9 A6 28     LDA $28A6,Y
03/9133: 9D 2C 20     STA $202C,X
03/9136: C8           INY 
03/9137: AD A5 28     LDA $28A5
03/913A: 29 20        AND #$20
03/913C: F0 15        BEQ $9153
03/913E: B9 A6 28     LDA $28A6,Y
03/9141: 10 03        BPL $9146
03/9143: 9D 21 20     STA $2021,X
03/9146: 9D 20 20     STA $2020,X
03/9149: C8           INY 
03/914A: 29 20        AND #$20
03/914C: F0 05        BEQ $9153
03/914E: A9 40        LDA #$40
03/9150: 9D 04 20     STA $2004,X
03/9153: AD A5 28     LDA $28A5
03/9156: 29 10        AND #$10
03/9158: F0 10        BEQ $916A
03/915A: B9 A6 28     LDA $28A6,Y
03/915D: 9D 12 20     STA $2012,X
03/9160: 9D 13 20     STA $2013,X
03/9163: 9D 17 20     STA $2017,X
03/9166: 9D 18 20     STA $2018,X
03/9169: C8           INY 
03/916A: AD A5 28     LDA $28A5
03/916D: 29 08        AND #$08
03/916F: F0 07        BEQ $9178
03/9171: B9 A6 28     LDA $28A6,Y
03/9174: 9D 40 20     STA $2040,X
03/9177: C8           INY 
03/9178: AD A5 28     LDA $28A5
03/917B: 29 04        AND #$04
03/917D: D0 03        BNE $9182
03/917F: 4C E5 92     JMP $92E5
03/9182: AD A0 35     LDA $35A0
03/9185: AA           TAX 
03/9186: FE AA 38     INC $38AA,X
03/9189: B9 A6 28     LDA $28A6,Y
03/918C: 8D A2 35     STA $35A2
03/918F: AD A0 35     LDA $35A0
03/9192: 85 DF        STA $DF
03/9194: A9 14        LDA #$14
03/9196: 85 E1        STA $E1
03/9198: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/919B: AD A2 35     LDA $35A2
03/919E: 85 E5        STA $E5
03/91A0: A0 30 E0     LDY #$E030
03/91A3: A9 0E        LDA #$0E
03/91A5: 20 43 84     JSR $8443       ; get script length
03/91A8: BB           TYX 
03/91A9: A4 E3        LDY $E3
03/91AB: 84 98        STY $98
03/91AD: 84 9C        STY $9C
03/91AF: BF 30 E0 0E  LDA $0EE030,X
03/91B3: 99 1F 53     STA $531F,Y
03/91B6: E8           INX 
03/91B7: C8           INY 
03/91B8: C9 FF        CMP #$FF
03/91BA: D0 F3        BNE $91AF
03/91BC: AD A0 35     LDA $35A0
03/91BF: 85 DF        STA $DF
03/91C1: A9 28        LDA #$28
03/91C3: 85 E1        STA $E1
03/91C5: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/91C8: A4 E3        LDY $E3
03/91CA: 84 9A        STY $9A
03/91CC: 84 9E        STY $9E
03/91CE: A6 98        LDX $98
03/91D0: BD 1F 53     LDA $531F,X
03/91D3: C9 FF        CMP #$FF
03/91D5: F0 35        BEQ $920C
03/91D7: 85 E5        STA $E5
03/91D9: A0 00 E6     LDY #$E600
03/91DC: A9 0E        LDA #$0E
03/91DE: 20 43 84     JSR $8443       ; get script length
03/91E1: BB           TYX 
03/91E2: A4 9A        LDY $9A
03/91E4: A9 04        LDA #$04
03/91E6: 85 A9        STA $A9
03/91E8: BF 00 E6 0E  LDA $0EE600,X
03/91EC: 99 BF 53     STA $53BF,Y
03/91EF: C9 FF        CMP #$FF
03/91F1: F0 01        BEQ $91F4
03/91F3: E8           INX 
03/91F4: C8           INY 
03/91F5: C6 A9        DEC $A9
03/91F7: A5 A9        LDA $A9
03/91F9: D0 ED        BNE $91E8
03/91FB: 84 9A        STY $9A
03/91FD: 18           CLC 
03/91FE: A5 98        LDA $98
03/9200: 69 02        ADC #$02
03/9202: 85 98        STA $98
03/9204: A5 99        LDA $99
03/9206: 69 00        ADC #$00
03/9208: 85 99        STA $99
03/920A: 80 C2        BRA $91CE
03/920C: AD A0 35     LDA $35A0
03/920F: 85 DF        STA $DF
03/9211: A9 A0        LDA #$A0
03/9213: 85 E1        STA $E1
03/9215: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9218: A4 E3        LDY $E3
03/921A: 84 9A        STY $9A
03/921C: A9 0A        LDA #$0A
03/921E: 85 AB        STA $AB
03/9220: A9 04        LDA #$04
03/9222: 85 A9        STA $A9
03/9224: A6 9E        LDX $9E
03/9226: BD BF 53     LDA $53BF,X
03/9229: C9 FF        CMP #$FF
03/922B: F0 20        BEQ $924D
03/922D: 85 DF        STA $DF
03/922F: A9 04        LDA #$04
03/9231: 85 E1        STA $E1
03/9233: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9236: A6 E3        LDX $E3
03/9238: A4 9A        LDY $9A
03/923A: A9 04        LDA #$04
03/923C: 85 AA        STA $AA
03/923E: BF 00 E7 0E  LDA $0EE700,X
03/9242: 99 FF 54     STA $54FF,Y
03/9245: E8           INX 
03/9246: C8           INY 
03/9247: C6 AA        DEC $AA
03/9249: A5 AA        LDA $AA
03/924B: D0 F1        BNE $923E
03/924D: 18           CLC 
03/924E: A5 9A        LDA $9A
03/9250: 69 04        ADC #$04
03/9252: 85 9A        STA $9A
03/9254: A5 9B        LDA $9B
03/9256: 69 00        ADC #$00
03/9258: 85 9B        STA $9B
03/925A: 18           CLC 
03/925B: A5 9E        LDA $9E
03/925D: 69 01        ADC #$01
03/925F: 85 9E        STA $9E
03/9261: A5 9F        LDA $9F
03/9263: 69 00        ADC #$00
03/9265: 85 9F        STA $9F
03/9267: C6 A9        DEC $A9
03/9269: A5 A9        LDA $A9
03/926B: D0 B7        BNE $9224
03/926D: C6 AB        DEC $AB
03/926F: A5 AB        LDA $AB
03/9271: D0 AD        BNE $9220
03/9273: AD A0 35     LDA $35A0
03/9276: AA           TAX 
03/9277: 8E 3D 39     STX $393D
03/927A: A2 58 02     LDX #$0258
03/927D: 8E 3F 39     STX $393F
03/9280: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/9283: AC 41 39     LDY $3941
03/9286: 84 9A        STY $9A
03/9288: A6 9C        LDX $9C
03/928A: BD 1F 53     LDA $531F,X
03/928D: C9 FF        CMP #$FF
03/928F: F0 54        BEQ $92E5
03/9291: E8           INX 
03/9292: BD 1F 53     LDA $531F,X
03/9295: 85 E5        STA $E5
03/9297: A0 00 E9     LDY #$E900
03/929A: AD EF 38     LDA $38EF
03/929D: F0 03        BEQ $92A2
03/929F: A0 C0 B6     LDY #$B6C0
03/92A2: A9 0E        LDA #$0E
03/92A4: 20 43 84     JSR $8443       ; get script length
03/92A7: AD EF 38     LDA $38EF
03/92AA: D0 12        BNE $92BE
03/92AC: BB           TYX 
03/92AD: A4 9A        LDY $9A
03/92AF: BF 00 E9 0E  LDA $0EE900,X
03/92B3: 99 FF 59     STA $59FF,Y
03/92B6: E8           INX 
03/92B7: C8           INY 
03/92B8: C9 FF        CMP #$FF
03/92BA: D0 F3        BNE $92AF
03/92BC: 80 10        BRA $92CE
03/92BE: BB           TYX 
03/92BF: A4 9A        LDY $9A
03/92C1: BF C0 B6 0E  LDA $0EB6C0,X
03/92C5: 99 FF 59     STA $59FF,Y
03/92C8: E8           INX 
03/92C9: C8           INY 
03/92CA: C9 FF        CMP #$FF
03/92CC: D0 F3        BNE $92C1
03/92CE: C2 20        REP #$20
03/92D0: 18           CLC 
03/92D1: A5 9A        LDA $9A
03/92D3: 69 3C 00     ADC #$003C
03/92D6: 85 9A        STA $9A
03/92D8: 18           CLC 
03/92D9: A5 9C        LDA $9C
03/92DB: 69 02 00     ADC #$0002
03/92DE: 85 9C        STA $9C
03/92E0: 7B           TDC 
03/92E1: E2 20        SEP #$20
03/92E3: 80 A3        BRA $9288
03/92E5: AD A0 35     LDA $35A0
03/92E8: 85 DF        STA $DF
03/92EA: A9 14        LDA #$14
03/92EC: 85 E1        STA $E1
03/92EE: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/92F1: AD A1 35     LDA $35A1
03/92F4: 85 E5        STA $E5
03/92F6: A0 30 E0     LDY #$E030
03/92F9: A9 0E        LDA #$0E
03/92FB: 20 43 84     JSR $8443       ; get script length
03/92FE: BB           TYX 
03/92FF: A4 E3        LDY $E3
03/9301: 84 98        STY $98
03/9303: 84 9C        STY $9C
03/9305: BF 30 E0 0E  LDA $0EE030,X
03/9309: 99 7F 39     STA $397F,Y
03/930C: E8           INX 
03/930D: C8           INY 
03/930E: C9 FF        CMP #$FF
03/9310: D0 F3        BNE $9305
03/9312: AD A0 35     LDA $35A0
03/9315: 85 DF        STA $DF
03/9317: A9 28        LDA #$28
03/9319: 85 E1        STA $E1
03/931B: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/931E: A4 E3        LDY $E3
03/9320: 84 9A        STY $9A
03/9322: 84 9E        STY $9E
03/9324: A6 98        LDX $98
03/9326: BD 7F 39     LDA $397F,X
03/9329: C9 FF        CMP #$FF
03/932B: F0 35        BEQ $9362
03/932D: 85 E5        STA $E5
03/932F: A0 00 E6     LDY #$E600
03/9332: A9 0E        LDA #$0E
03/9334: 20 43 84     JSR $8443       ; get script length
03/9337: BB           TYX 
03/9338: A4 9A        LDY $9A
03/933A: A9 04        LDA #$04
03/933C: 85 A9        STA $A9
03/933E: BF 00 E6 0E  LDA $0EE600,X
03/9342: 99 1F 3A     STA $3A1F,Y
03/9345: C9 FF        CMP #$FF
03/9347: F0 01        BEQ $934A
03/9349: E8           INX 
03/934A: C8           INY 
03/934B: C6 A9        DEC $A9
03/934D: A5 A9        LDA $A9
03/934F: D0 ED        BNE $933E
03/9351: 84 9A        STY $9A
03/9353: 18           CLC 
03/9354: A5 98        LDA $98
03/9356: 69 02        ADC #$02
03/9358: 85 98        STA $98
03/935A: A5 99        LDA $99
03/935C: 69 00        ADC #$00
03/935E: 85 99        STA $99
03/9360: 80 C2        BRA $9324
03/9362: AD A0 35     LDA $35A0
03/9365: 85 DF        STA $DF
03/9367: A9 A0        LDA #$A0
03/9369: 85 E1        STA $E1
03/936B: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/936E: A4 E3        LDY $E3
03/9370: 84 9A        STY $9A
03/9372: A9 0A        LDA #$0A
03/9374: 85 AB        STA $AB
03/9376: A9 04        LDA #$04
03/9378: 85 A9        STA $A9
03/937A: A6 9E        LDX $9E
03/937C: BD 1F 3A     LDA $3A1F,X
03/937F: C9 FF        CMP #$FF
03/9381: F0 20        BEQ $93A3
03/9383: 85 DF        STA $DF
03/9385: A9 04        LDA #$04
03/9387: 85 E1        STA $E1
03/9389: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/938C: A6 E3        LDX $E3
03/938E: A4 9A        LDY $9A
03/9390: A9 04        LDA #$04
03/9392: 85 AA        STA $AA
03/9394: BF 00 E7 0E  LDA $0EE700,X
03/9398: 99 5F 3B     STA $3B5F,Y
03/939B: E8           INX 
03/939C: C8           INY 
03/939D: C6 AA        DEC $AA
03/939F: A5 AA        LDA $AA
03/93A1: D0 F1        BNE $9394
03/93A3: 18           CLC 
03/93A4: A5 9A        LDA $9A
03/93A6: 69 04        ADC #$04
03/93A8: 85 9A        STA $9A
03/93AA: A5 9B        LDA $9B
03/93AC: 69 00        ADC #$00
03/93AE: 85 9B        STA $9B
03/93B0: 18           CLC 
03/93B1: A5 9E        LDA $9E
03/93B3: 69 01        ADC #$01
03/93B5: 85 9E        STA $9E
03/93B7: A5 9F        LDA $9F
03/93B9: 69 00        ADC #$00
03/93BB: 85 9F        STA $9F
03/93BD: C6 A9        DEC $A9
03/93BF: A5 A9        LDA $A9
03/93C1: D0 B7        BNE $937A
03/93C3: C6 AB        DEC $AB
03/93C5: A5 AB        LDA $AB
03/93C7: D0 AD        BNE $9376
03/93C9: AD A0 35     LDA $35A0
03/93CC: AA           TAX 
03/93CD: 8E 3D 39     STX $393D
03/93D0: A2 58 02     LDX #$0258
03/93D3: 8E 3F 39     STX $393F
03/93D6: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/93D9: AC 41 39     LDY $3941
03/93DC: 84 9A        STY $9A
03/93DE: 8C 96 28     STY $2896
03/93E1: A6 9C        LDX $9C
03/93E3: BD 7F 39     LDA $397F,X
03/93E6: C9 FF        CMP #$FF
03/93E8: F0 54        BEQ $943E
03/93EA: E8           INX 
03/93EB: BD 7F 39     LDA $397F,X
03/93EE: 85 E5        STA $E5
03/93F0: A0 00 E9     LDY #$E900
03/93F3: AD EF 38     LDA $38EF
03/93F6: F0 03        BEQ $93FB
03/93F8: A0 C0 B6     LDY #$B6C0
03/93FB: A9 0E        LDA #$0E
03/93FD: 20 43 84     JSR $8443       ; get script length
03/9400: AD EF 38     LDA $38EF
03/9403: D0 12        BNE $9417
03/9405: BB           TYX 
03/9406: A4 9A        LDY $9A
03/9408: BF 00 E9 0E  LDA $0EE900,X
03/940C: 99 5F 40     STA $405F,Y
03/940F: E8           INX 
03/9410: C8           INY 
03/9411: C9 FF        CMP #$FF
03/9413: D0 F3        BNE $9408
03/9415: 80 10        BRA $9427
03/9417: BB           TYX 
03/9418: A4 9A        LDY $9A
03/941A: BF C0 B6 0E  LDA $0EB6C0,X
03/941E: 99 5F 40     STA $405F,Y
03/9421: E8           INX 
03/9422: C8           INY 
03/9423: C9 FF        CMP #$FF
03/9425: D0 F3        BNE $941A
03/9427: C2 20        REP #$20
03/9429: 18           CLC 
03/942A: A5 9A        LDA $9A
03/942C: 69 3C 00     ADC #$003C
03/942F: 85 9A        STA $9A
03/9431: 18           CLC 
03/9432: A5 9C        LDA $9C
03/9434: 69 02 00     ADC #$0002
03/9437: 85 9C        STA $9C
03/9439: 7B           TDC 
03/943A: E2 20        SEP #$20
03/943C: 80 A3        BRA $93E1
03/943E: AD A0 35     LDA $35A0
03/9441: 85 DF        STA $DF
03/9443: A9 14        LDA #$14
03/9445: 85 E1        STA $E1
03/9447: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/944A: A6 E3        LDX $E3
03/944C: 7B           TDC 
03/944D: A8           TAY 
03/944E: 84 A9        STY $A9
03/9450: BD 7F 39     LDA $397F,X
03/9453: F0 08        BEQ $945D
03/9455: E8           INX 
03/9456: E8           INX 
03/9457: E6 A9        INC $A9
03/9459: E6 A9        INC $A9
03/945B: 80 F3        BRA $9450
03/945D: A5 A9        LDA $A9
03/945F: 4A           LSR 
03/9460: 48           PHA 
03/9461: AD A0 35     LDA $35A0
03/9464: AA           TAX 
03/9465: 68           PLA 
03/9466: 9D 04 36     STA $3604,X
03/9469: 85 DF        STA $DF
03/946B: A9 3C        LDA #$3C
03/946D: 85 E1        STA $E1
03/946F: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9472: AD A0 35     LDA $35A0
03/9475: 0A           ASL 
03/9476: AA           TAX 
03/9477: 18           CLC 
03/9478: AD 96 28     LDA $2896
03/947B: 65 E3        ADC $E3
03/947D: 9D 0C 36     STA $360C,X
03/9480: AD 97 28     LDA $2897
03/9483: 65 E4        ADC $E4
03/9485: 9D 0D 36     STA $360D,X
03/9488: 60           RTS 

; [ load monster attack/defense values ]

03/9489: DA           PHX 
03/948A: 85 DF        STA $DF
03/948C: A9 03        LDA #$03
03/948E: 85 E1        STA $E1
03/9490: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9493: A6 E3        LDX $E3
03/9495: A0 80 00     LDY #$0080
03/9498: BF 80 A3 0E  LDA $0EA380,X
03/949C: 99 9C 28     STA $289C,Y
03/949F: E8           INX 
03/94A0: C8           INY 
03/94A1: C0 83 00     CPY #$0083
03/94A4: D0 F2        BNE $9498
03/94A6: FA           PLX 
03/94A7: 60           RTS 

; [ load character properties ]

03/94A8: A2 00 20     LDX #$2000
03/94AB: 86 80        STX $80
03/94AD: 7B           TDC 
03/94AE: AA           TAX 
03/94AF: 64 A9        STZ $A9
03/94B1: 7B           TDC 
03/94B2: A8           TAY 
03/94B3: BD 00 10     LDA $1000,X
03/94B6: 91 80        STA ($80),Y
03/94B8: E8           INX 
03/94B9: C8           INY 
03/94BA: C0 40 00     CPY #$0040
03/94BD: D0 F4        BNE $94B3
03/94BF: DA           PHX 
03/94C0: 7B           TDC 
03/94C1: A8           TAY 
03/94C2: B1 80        LDA ($80),Y
03/94C4: 29 1F        AND #$1F
03/94C6: D0 18        BNE $94E0
03/94C8: A5 A9        LDA $A9
03/94CA: AA           TAX 
03/94CB: FE 40 35     INC $3540,X
03/94CE: A0 03 00     LDY #$0003
03/94D1: 7B           TDC 
03/94D2: 91 80        STA ($80),Y
03/94D4: C8           INY 
03/94D5: 91 80        STA ($80),Y
03/94D7: C8           INY 
03/94D8: 91 80        STA ($80),Y
03/94DA: C8           INY 
03/94DB: 91 80        STA ($80),Y
03/94DD: 4C 66 95     JMP $9566
03/94E0: A0 03 00     LDY #$0003
03/94E3: B1 80        LDA ($80),Y
03/94E5: 29 C0        AND #$C0
03/94E7: D0 7D        BNE $9566
03/94E9: A5 A9        LDA $A9
03/94EB: 0A           ASL 
03/94EC: AA           TAX 
03/94ED: A9 40        LDA #$40        ; enable action timer
03/94EF: 9D EB 29     STA $29EB,X
03/94F2: C2 20        REP #$20
03/94F4: A0 09 00     LDY #$0009
03/94F7: B1 80        LDA ($80),Y
03/94F9: 20 86 84     JSR $8486       ; lsr2
03/94FC: A0 07 00     LDY #$0007
03/94FF: D1 80        CMP ($80),Y
03/9501: 90 0C        BCC $950F
03/9503: A0 05 00     LDY #$0005
03/9506: B1 80        LDA ($80),Y
03/9508: 09 00 01     ORA #$0100
03/950B: 91 80        STA ($80),Y
03/950D: 80 0A        BRA $9519
03/950F: A0 05 00     LDY #$0005
03/9512: B1 80        LDA ($80),Y
03/9514: 29 FF FE     AND #$FEFF
03/9517: 91 80        STA ($80),Y
03/9519: 7B           TDC 
03/951A: E2 20        SEP #$20
03/951C: A0 3B 00     LDY #$003B
03/951F: A9 10        LDA #$10
03/9521: 91 80        STA ($80),Y
03/9523: AD A2 29     LDA $29A2
03/9526: 29 20        AND #$20
03/9528: F0 04        BEQ $952E
03/952A: A9 01        LDA #$01
03/952C: 91 80        STA ($80),Y
03/952E: A0 2D 00     LDY #$002D
03/9531: B1 80        LDA ($80),Y
03/9533: A0 41 00     LDY #$0041
03/9536: 91 80        STA ($80),Y
03/9538: A0 2E 00     LDY #$002E
03/953B: B1 80        LDA ($80),Y
03/953D: A0 42 00     LDY #$0042
03/9540: 91 80        STA ($80),Y
03/9542: A0 04 00     LDY #$0004
03/9545: B1 80        LDA ($80),Y
03/9547: 29 40        AND #$40
03/9549: 91 80        STA ($80),Y
03/954B: C8           INY 
03/954C: B1 80        LDA ($80),Y
03/954E: 29 82        AND #$82
03/9550: 91 80        STA ($80),Y
03/9552: C8           INY 
03/9553: B1 80        LDA ($80),Y
03/9555: 29 01        AND #$01
03/9557: 91 80        STA ($80),Y
03/9559: A0 02 00     LDY #$0002
03/955C: B1 80        LDA ($80),Y
03/955E: CD 83 35     CMP $3583
03/9561: B0 03        BCS $9566
03/9563: 8D 83 35     STA $3583
03/9566: FA           PLX 
03/9567: A0 07 00     LDY #$0007
03/956A: B1 80        LDA ($80),Y
03/956C: A0 08 00     LDY #$0008
03/956F: 11 80        ORA ($80),Y
03/9571: D0 09        BNE $957C
03/9573: A0 03 00     LDY #$0003
03/9576: B1 80        LDA ($80),Y
03/9578: 09 80        ORA #$80
03/957A: 91 80        STA ($80),Y
03/957C: 18           CLC 
03/957D: A5 80        LDA $80
03/957F: 69 80        ADC #$80
03/9581: 85 80        STA $80
03/9583: A5 81        LDA $81
03/9585: 69 00        ADC #$00
03/9587: 85 81        STA $81
03/9589: E6 A9        INC $A9
03/958B: A5 A9        LDA $A9
03/958D: C9 05        CMP #$05
03/958F: F0 03        BEQ $9594
03/9591: 4C B1 94     JMP $94B1
03/9594: A2 00 20     LDX #$2000
03/9597: 86 80        STX $80
03/9599: 7B           TDC 
03/959A: A8           TAY 
03/959B: AA           TAX 
03/959C: 84 A9        STY $A9
03/959E: B1 80        LDA ($80),Y
03/95A0: 29 1F        AND #$1F
03/95A2: C9 08        CMP #$08        ; palom
03/95A4: F0 0C        BEQ $95B2
03/95A6: C9 09        CMP #$09        ; porom
03/95A8: F0 08        BEQ $95B2
03/95AA: C9 13        CMP #$13        ; fusoya
03/95AC: F0 04        BEQ $95B2
03/95AE: C9 15        CMP #$15        ; golbez
03/95B0: D0 06        BNE $95B8
03/95B2: A5 A9        LDA $A9
03/95B4: 9D 39 35     STA $3539,X
03/95B7: E8           INX 
03/95B8: C2 20        REP #$20
03/95BA: 18           CLC 
03/95BB: A5 80        LDA $80
03/95BD: 69 80 00     ADC #$0080
03/95C0: 85 80        STA $80
03/95C2: 7B           TDC 
03/95C3: E2 20        SEP #$20
03/95C5: E6 A9        INC $A9
03/95C7: A5 A9        LDA $A9
03/95C9: C9 05        CMP #$05
03/95CB: D0 D1        BNE $959E
03/95CD: 60           RTS 

; [ init character rows ]

03/95CE: AD A8 16     LDA $16A8       ; row setting
03/95D1: D0 29        BNE $95FC
03/95D3: AD 01 20     LDA $2001
03/95D6: 29 7F        AND #$7F
03/95D8: 8D 01 20     STA $2001
03/95DB: AD 81 20     LDA $2081
03/95DE: 29 7F        AND #$7F
03/95E0: 8D 81 20     STA $2081
03/95E3: AD 01 21     LDA $2101
03/95E6: 29 7F        AND #$7F
03/95E8: 8D 01 21     STA $2101
03/95EB: AD 81 21     LDA $2181
03/95EE: 09 80        ORA #$80
03/95F0: 8D 81 21     STA $2181
03/95F3: AD 01 22     LDA $2201
03/95F6: 09 80        ORA #$80
03/95F8: 8D 01 22     STA $2201
03/95FB: 60           RTS 
03/95FC: AD 01 20     LDA $2001
03/95FF: 09 80        ORA #$80
03/9601: 8D 01 20     STA $2001
03/9604: AD 81 20     LDA $2081
03/9607: 09 80        ORA #$80
03/9609: 8D 81 20     STA $2081
03/960C: AD 01 21     LDA $2101
03/960F: 09 80        ORA #$80
03/9611: 8D 01 21     STA $2101
03/9614: AD 81 21     LDA $2181
03/9617: 29 7F        AND #$7F
03/9619: 8D 81 21     STA $2181
03/961C: AD 01 22     LDA $2201
03/961F: 29 7F        AND #$7F
03/9621: 8D 01 22     STA $2201
03/9624: 60           RTS 

; [ init poison timers ]

03/9625: 7B           TDC 
03/9626: AA           TAX 
03/9627: 86 CD        STX $CD
03/9629: A6 CD        LDX $CD
03/962B: BD 40 35     LDA $3540,X
03/962E: D0 3E        BNE $966E
03/9630: A6 CD        LDX $CD
03/9632: 86 DF        STX $DF
03/9634: A2 80 00     LDX #$0080
03/9637: 86 E1        STX $E1
03/9639: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/963C: A6 E3        LDX $E3
03/963E: BD 03 20     LDA $2003,X
03/9641: 29 01        AND #$01
03/9643: F0 29        BEQ $966E
03/9645: A9 06        LDA #$06
03/9647: 85 D6        STA $D6
03/9649: A5 CD        LDA $CD
03/964B: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/964E: A9 09        LDA #$09        ; poison timer
03/9650: 20 C8 85     JSR $85C8       ; set timer
03/9653: A9 40        LDA #$40
03/9655: 9D 06 2A     STA $2A06,X     ; do timer effect when timer expires
03/9658: A5 CD        LDA $CD
03/965A: 0A           ASL 
03/965B: AA           TAX 
03/965C: BD EB 29     LDA $29EB,X     ; enable poison timer
03/965F: 09 10        ORA #$10
03/9661: 9D EB 29     STA $29EB,X
03/9664: A5 D4        LDA $D4
03/9666: 9D 2A 2B     STA $2B2A,X
03/9669: A5 D5        LDA $D5
03/966B: 9D 2B 2B     STA $2B2B,X
03/966E: E6 CD        INC $CD
03/9670: A5 CD        LDA $CD
03/9672: C9 05        CMP #$05
03/9674: D0 B3        BNE $9629
03/9676: 60           RTS 

; [ decrement timers ]

03/9677: 9C EE 38     STZ $38EE       ; this has no effect
03/967A: AD EE 38     LDA $38EE
03/967D: F0 06        BEQ $9685       ; always branch
03/967F: CE EE 38     DEC $38EE
03/9682: 4C 40 97     JMP $9740
03/9685: AD AC 16     LDA $16AC       ; reset battle speed counter (no effect)
03/9688: 8D EE 38     STA $38EE
03/968B: C2 20        REP #$20
03/968D: 7B           TDC 
03/968E: AA           TAX 
03/968F: A8           TAY 
; start of character/monster loop
03/9690: AD 01 36     LDA $3601
03/9693: C9 FF FF     CMP #$FFFF
03/9696: F0 0A        BEQ $96A2
03/9698: 85 80        STA $80
03/969A: 98           TYA 
03/969B: 4A           LSR 
03/969C: C5 80        CMP $80
03/969E: F0 02        BEQ $96A2
03/96A0: 80 2C        BRA $96CE
03/96A2: B9 EA 29     LDA $29EA,Y     ; get enabled timers (in hi byte, $29EB)
03/96A5: 8D 96 28     STA $2896
; stop timer
03/96A8: 0E 96 28     ASL $2896
03/96AB: 90 29        BCC $96D6       ; branch if stop timer is disabled
03/96AD: 7B           TDC 
03/96AE: E2 20        SEP #$20
03/96B0: BD 06 2A     LDA $2A06,X
03/96B3: 29 01        AND #$01
03/96B5: C2 20        REP #$20
03/96B7: D0 1D        BNE $96D6
03/96B9: DE 04 2A     DEC $2A04,X     ; decrement stop timer
03/96BC: BD 04 2A     LDA $2A04,X
03/96BF: D0 0D        BNE $96CE
03/96C1: 7B           TDC 
03/96C2: E2 20        SEP #$20
03/96C4: BD 06 2A     LDA $2A06,X     ; stop timer expired
03/96C7: 09 01        ORA #$01
03/96C9: 9D 06 2A     STA $2A06,X
03/96CC: C2 20        REP #$20
03/96CE: 8A           TXA 
03/96CF: 18           CLC 
03/96D0: 69 15 00     ADC #$0015      ; skip all other timers
03/96D3: AA           TAX 
03/96D4: 80 5D        BRA $9733
; not stopped
03/96D6: E8           INX             ; next timer
03/96D7: E8           INX 
03/96D8: E8           INX 
03/96D9: A9 06 00     LDA #$0006      ; loop through 6 timers
03/96DC: 8D 9A 28     STA $289A
03/96DF: 0E 96 28     ASL $2896
03/96E2: 90 44        BCC $9728       ; branch if timer is disabled
03/96E4: 7B           TDC 
03/96E5: E2 20        SEP #$20
03/96E7: BD 06 2A     LDA $2A06,X
03/96EA: 29 81        AND #$81
03/96EC: C2 20        REP #$20
03/96EE: D0 38        BNE $9728       ; branch if timer already expired
03/96F0: AD 9A 28     LDA $289A
03/96F3: C9 01 00     CMP #$0001
03/96F6: D0 16        BNE $970E       ; branch if not doom timer
03/96F8: DA           PHX 
03/96F9: 98           TYA 
03/96FA: 0A           ASL 
03/96FB: AA           TAX 
03/96FC: DE A4 35     DEC $35A4,X     ; decrement extra doom counter
03/96FF: BD A4 35     LDA $35A4,X
03/9702: F0 03        BEQ $9707       ; branch if extra doom counter expired
03/9704: FA           PLX 
03/9705: 80 21        BRA $9728
03/9707: A9 02 00     LDA #$0002      ; reset to 2
03/970A: 9D A4 35     STA $35A4,X
03/970D: FA           PLX 
03/970E: BD 04 2A     LDA $2A04,X
03/9711: F0 08        BEQ $971B       ; branch if timer expired
03/9713: DE 04 2A     DEC $2A04,X     ; decrement counter
03/9716: BD 04 2A     LDA $2A04,X
03/9719: D0 0D        BNE $9728
03/971B: 7B           TDC 
03/971C: E2 20        SEP #$20
03/971E: BD 06 2A     LDA $2A06,X     ; mark timer as expired
03/9721: 09 81        ORA #$81
03/9723: 9D 06 2A     STA $2A06,X
03/9726: C2 20        REP #$20
03/9728: E8           INX             ; next timer
03/9729: E8           INX 
03/972A: E8           INX 
03/972B: CE 9A 28     DEC $289A
03/972E: AD 9A 28     LDA $289A
03/9731: D0 AC        BNE $96DF
03/9733: C8           INY             ; next character/monster
03/9734: C8           INY 
03/9735: C0 1A 00     CPY #$001A
03/9738: F0 03        BEQ $973D
03/973A: 4C 90 96     JMP $9690
03/973D: 7B           TDC 
03/973E: E2 20        SEP #$20
03/9740: 60           RTS 

; [ check for pending action ]

; the action order starts after the previous attacker id, and continues
; sequentially until all characters/monsters have been checked.

03/9741: 64 D1        STZ $D1         ; disable pending action
03/9743: 64 00        STZ $00
03/9745: AD F6 38     LDA $38F6       ; character/monster with priority for next action
03/9748: 85 A9        STA $A9
03/974A: AD 01 36     LDA $3601
03/974D: C9 FF        CMP #$FF
03/974F: F0 04        BEQ $9755
03/9751: C5 A9        CMP $A9
03/9753: D0 20        BNE $9775
03/9755: 64 AD        STZ $AD
03/9757: 64 AE        STZ $AE
03/9759: A5 A9        LDA $A9
03/975B: 0A           ASL 
03/975C: AA           TAX 
03/975D: BD EB 29     LDA $29EB,X     ; enabled timers
03/9760: 85 AB        STA $AB
03/9762: 06 AB        ASL $AB
03/9764: 90 07        BCC $976D
03/9766: 20 88 97     JSR $9788       ; check if timer expired
03/9769: A5 D1        LDA $D1
03/976B: D0 1A        BNE $9787       ; return if timer expired
03/976D: E6 AD        INC $AD         ; next timer
03/976F: A5 AD        LDA $AD
03/9771: C9 07        CMP #$07
03/9773: D0 ED        BNE $9762
03/9775: E6 A9        INC $A9         ; next character/monster
03/9777: A5 A9        LDA $A9
03/9779: C9 0D        CMP #$0D
03/977B: D0 02        BNE $977F
03/977D: 64 A9        STZ $A9
03/977F: E6 00        INC $00
03/9781: A5 00        LDA $00
03/9783: C9 0D        CMP #$0D
03/9785: D0 C3        BNE $974A
03/9787: 60           RTS 

; [ check if timer expired ]

03/9788: A5 A9        LDA $A9
03/978A: 85 D2        STA $D2
03/978C: 20 89 84     JSR $8489       ; set current character/monster
03/978F: A5 AD        LDA $AD
03/9791: 85 D3        STA $D3
03/9793: 0A           ASL 
03/9794: 18           CLC 
03/9795: 65 AD        ADC $AD
03/9797: 85 AF        STA $AF
03/9799: A5 AF        LDA $AF
03/979B: 20 69 85     JSR $8569       ; get pointer to timer
03/979E: AE 98 35     LDX $3598
03/97A1: BD 04 2A     LDA $2A04,X
03/97A4: 1D 05 2A     ORA $2A05,X
03/97A7: D0 09        BNE $97B2
03/97A9: BD 06 2A     LDA $2A06,X
03/97AC: 29 01        AND #$01
03/97AE: F0 02        BEQ $97B2
03/97B0: E6 D1        INC $D1         ; enable pending action
03/97B2: 60           RTS 

; [ init action ]

03/97B3: A5 D2        LDA $D2         ; acting character/monster
03/97B5: 8D F6 38     STA $38F6
03/97B8: 20 89 84     JSR $8489       ; set current character/monster
03/97BB: EE F6 38     INC $38F6       ; next character/monster has action priority
03/97BE: AD F6 38     LDA $38F6
03/97C1: C9 0D        CMP #$0D
03/97C3: D0 03        BNE $97C8
03/97C5: 9C F6 38     STZ $38F6
03/97C8: A5 D3        LDA $D3
03/97CA: 0A           ASL 
03/97CB: 18           CLC 
03/97CC: 65 D3        ADC $D3
03/97CE: 85 A9        STA $A9
03/97D0: A5 A9        LDA $A9
03/97D2: 20 69 85     JSR $8569       ; get pointer to timer
03/97D5: AE 98 35     LDX $3598
03/97D8: BD 06 2A     LDA $2A06,X
03/97DB: 29 7E        AND #$7E
03/97DD: D0 0E        BNE $97ED       ; branch if action or timer effect
03/97DF: A5 D2        LDA $D2
03/97E1: C9 05        CMP #$05
03/97E3: 90 04        BCC $97E9
03/97E5: A9 01        LDA #$01        ; 1: choose monster action
03/97E7: 80 0E        BRA $97F7
03/97E9: A9 00        LDA #$00        ; 2: choose character action
03/97EB: 80 0A        BRA $97F7
03/97ED: 29 08        AND #$08
03/97EF: F0 04        BEQ $97F5
03/97F1: A9 02        LDA #$02        ; 3: do attack
03/97F3: 80 02        BRA $97F7
03/97F5: A9 03        LDA #$03        ; 4: do timer effect
03/97F7: 8D 2E 35     STA $352E       ; set action type
03/97FA: 64 D1        STZ $D1
03/97FC: 60           RTS 

; [ update character equipment (external) ]

03/97FD: AD 75 39     LDA $3975
03/9800: 48           PHA 
03/9801: 20 35 82     JSR $8235
03/9804: 68           PLA 
03/9805: 8D 75 39     STA $3975
03/9808: 20 A8 94     JSR $94A8       ; load character properties
03/980B: 20 CC 8E     JSR $8ECC       ; load equipment properties
03/980E: 20 37 98     JSR $9837       ; update character stats
03/9811: 46 A7        LSR $A7
03/9813: 66 A6        ROR $A6
03/9815: A6 A6        LDX $A6
03/9817: 7B           TDC 
03/9818: A8           TAY 
03/9819: B1 80        LDA ($80),Y
03/981B: 9D 00 10     STA $1000,X
03/981E: E8           INX 
03/981F: C8           INY 
03/9820: C0 40 00     CPY #$0040
03/9823: D0 F4        BNE $9819
03/9825: A0 41 00     LDY #$0041
03/9828: B1 80        LDA ($80),Y
03/982A: A6 A6        LDX $A6
03/982C: 9D 2D 10     STA $102D,X
03/982F: C8           INY 
03/9830: E8           INX 
03/9831: B1 80        LDA ($80),Y
03/9833: 9D 2D 10     STA $102D,X
03/9836: 60           RTS 

; [ update character stats ]

03/9837: AD 75 39     LDA $3975
03/983A: 20 89 84     JSR $8489       ; set current character/monster
03/983D: 18           CLC 
03/983E: A5 A6        LDA $A6
03/9840: 69 00        ADC #$00
03/9842: 85 80        STA $80         ; +$80: pointer to character properties
03/9844: A5 A7        LDA $A7
03/9846: 69 20        ADC #$20
03/9848: 85 81        STA $81
03/984A: C2 20        REP #$20
03/984C: 18           CLC 
03/984D: AD 32 35     LDA $3532
03/9850: 69 80 27     ADC #$2780      ; +$82: pointer to equipped item data
03/9853: 85 82        STA $82
03/9855: 7B           TDC 
03/9856: E2 20        SEP #$20
03/9858: AD 2C 35     LDA $352C
03/985B: F0 26        BEQ $9883       ; branch if no magnetization
03/985D: 7B           TDC 
03/985E: A8           TAY 
03/985F: 84 A9        STY $A9
03/9861: 84 AB        STY $AB
03/9863: B1 82        LDA ($82),Y
03/9865: 10 04        BPL $986B       ; branch if item is not magnetic
03/9867: E6 A9        INC $A9
03/9869: 80 0D        BRA $9878
03/986B: 98           TYA 
03/986C: 18           CLC 
03/986D: 69 0B        ADC #$0B
03/986F: A8           TAY 
03/9870: E6 AB        INC $AB
03/9872: A5 AB        LDA $AB
03/9874: C9 05        CMP #$05
03/9876: D0 EB        BNE $9863
03/9878: A5 A9        LDA $A9
03/987A: F0 07        BEQ $9883       ; branch if no magnetic items
03/987C: A0 05 00     LDY #$0005
03/987F: A9 80        LDA #$80        ; magnetized
03/9881: 91 80        STA ($80),Y
03/9883: A0 14 00     LDY #$0014
03/9886: 7B           TDC 
03/9887: 91 80        STA ($80),Y     ; clear mod. stats
03/9889: C8           INY 
03/988A: C0 19 00     CPY #$0019
03/988D: D0 F8        BNE $9887
03/988F: 64 AF        STZ $AF
03/9891: A0 07 00     LDY #$0007
; start of item loop for stat modifiers
03/9894: B1 82        LDA ($82),Y
03/9896: 48           PHA 
03/9897: 29 F8        AND #$F8
03/9899: 85 A9        STA $A9         ; modified stats
03/989B: 68           PLA 
03/989C: 29 07        AND #$07
03/989E: 0A           ASL 
03/989F: AA           TAX 
03/98A0: BF AC FE 13  LDA $13FEAC,X   ; equipment stat modifiers
03/98A4: 85 AB        STA $AB         ; modifier if bit set
03/98A6: E8           INX 
03/98A7: BF AC FE 13  LDA $13FEAC,X
03/98AB: 85 AC        STA $AC         ; modifier if bit clear
03/98AD: 5A           PHY 
03/98AE: A0 14 00     LDY #$0014
03/98B1: 06 A9        ASL $A9
03/98B3: 90 07        BCC $98BC
03/98B5: 18           CLC 
03/98B6: B1 80        LDA ($80),Y     ; add 1st value if stat bit set
03/98B8: 65 AB        ADC $AB
03/98BA: 80 05        BRA $98C1
03/98BC: 18           CLC 
03/98BD: B1 80        LDA ($80),Y     ; add 2nd value if stat bit clear
03/98BF: 65 AC        ADC $AC
03/98C1: 91 80        STA ($80),Y
03/98C3: C8           INY 
03/98C4: C0 19 00     CPY #$0019
03/98C7: D0 E8        BNE $98B1
03/98C9: 7A           PLY             ; next item
03/98CA: 98           TYA 
03/98CB: 18           CLC 
03/98CC: 69 0B        ADC #$0B
03/98CE: A8           TAY 
03/98CF: E6 AF        INC $AF
03/98D1: A5 AF        LDA $AF
03/98D3: C9 05        CMP #$05
03/98D5: D0 BD        BNE $9894
03/98D7: A0 0F 00     LDY #$000F      ; base stat
03/98DA: 84 A9        STY $A9
03/98DC: A0 14 00     LDY #$0014      ; mod. stat
03/98DF: 84 AB        STY $AB
03/98E1: A4 A9        LDY $A9
03/98E3: 18           CLC 
03/98E4: B1 80        LDA ($80),Y     ; apply net stat modifier
03/98E6: A4 AB        LDY $AB
03/98E8: 71 80        ADC ($80),Y
03/98EA: C9 B6        CMP #$B6        ; -74
03/98EC: B0 08        BCS $98F6       ; branch if negative
03/98EE: C9 63        CMP #$63
03/98F0: 90 06        BCC $98F8
03/98F2: A9 63        LDA #$63        ; max 99
03/98F4: 80 02        BRA $98F8
03/98F6: A9 01        LDA #$01        ; min 1
03/98F8: 91 80        STA ($80),Y
03/98FA: E6 A9        INC $A9         ; next stat
03/98FC: E6 AB        INC $AB
03/98FE: A5 A9        LDA $A9
03/9900: C9 14        CMP #$14
03/9902: D0 DD        BNE $98E1
03/9904: A0 02 00     LDY #$0002
03/9907: B1 80        LDA ($80),Y     ; character level
03/9909: 8D 65 39     STA $3965
03/990C: 7B           TDC 
03/990D: AA           TAX 
03/990E: A0 14 00     LDY #$0014
03/9911: B1 80        LDA ($80),Y     ; mod. stats
03/9913: 9D 66 39     STA $3966,X
03/9916: C8           INY 
03/9917: E8           INX 
03/9918: E0 05 00     CPX #$0005
03/991B: D0 F4        BNE $9911
03/991D: 9C 6B 39     STZ $396B
03/9920: 9C 6C 39     STZ $396C
03/9923: 9C 6D 39     STZ $396D
03/9926: 9C 6E 39     STZ $396E
03/9929: 9C 6F 39     STZ $396F
03/992C: 9C 70 39     STZ $3970
03/992F: 9C 71 39     STZ $3971
03/9932: 9C 72 39     STZ $3972
03/9935: 9C 73 39     STZ $3973
03/9938: 9C 74 39     STZ $3974
03/993B: A0 25 00     LDY #$0025
03/993E: B1 82        LDA ($82),Y
03/9940: 10 0C        BPL $994E       ; branch if left hand item is not a shield
03/9942: A0 21 00     LDY #$0021
03/9945: 20 AB 9D     JSR $9DAB       ; get shield properties
03/9948: AD 6D 39     LDA $396D
03/994B: 8D 6E 39     STA $396E
03/994E: A0 30 00     LDY #$0030
03/9951: B1 82        LDA ($82),Y
03/9953: 10 06        BPL $995B       ; branch if right hand item is not a shield
03/9955: A0 2C 00     LDY #$002C
03/9958: 20 AB 9D     JSR $9DAB       ; get shield properties
03/995B: 7B           TDC 
03/995C: AA           TAX 
03/995D: 86 A9        STX $A9         ; clear $A9 and $AA
03/995F: A0 08 00     LDY #$0008
03/9962: B1 82        LDA ($82),Y     ; elemental resistance
03/9964: 95 AD        STA $AD,X
03/9966: 98           TYA 
03/9967: 18           CLC 
03/9968: 69 0B        ADC #$0B
03/996A: A8           TAY 
03/996B: E8           INX 
03/996C: E0 03 00     CPX #$0003
03/996F: D0 F1        BNE $9962
03/9971: AD 6D 39     LDA $396D       ; right hand shield
03/9974: 85 B0        STA $B0
03/9976: AD 6E 39     LDA $396E       ; left hand shield
03/9979: 85 B1        STA $B1
03/997B: 7B           TDC 
03/997C: AA           TAX 
03/997D: B5 AD        LDA $AD,X
03/997F: 30 06        BMI $9987       ; branch if immune
03/9981: 05 A9        ORA $A9
03/9983: 85 A9        STA $A9
03/9985: 80 04        BRA $998B
03/9987: 05 AA        ORA $AA
03/9989: 85 AA        STA $AA
03/998B: E8           INX 
03/998C: E0 05 00     CPX #$0005
03/998F: D0 EC        BNE $997D
03/9991: A0 25 00     LDY #$0025
03/9994: A5 A9        LDA $A9
03/9996: 91 80        STA ($80),Y     ; strong elements
03/9998: C8           INY 
03/9999: A5 AA        LDA $AA
03/999B: 91 80        STA ($80),Y     ; immune elements
03/999D: A0 05 00     LDY #$0005
03/99A0: 7B           TDC 
03/99A1: AA           TAX 
03/99A2: 64 A9        STZ $A9         ; change to STX to fix the bug below
03/99A4: B1 82        LDA ($82),Y     ; creature type
03/99A6: 05 A9        ORA $A9
03/99A8: 85 A9        STA $A9
03/99AA: 98           TYA 
03/99AB: 18           CLC 
03/99AC: 69 0B        ADC #$0B
03/99AE: A8           TAY 
03/99AF: E8           INX 
03/99B0: E0 03 00     CPX #$0003
03/99B3: D0 EF        BNE $99A4
03/99B5: A0 27 00     LDY #$0027
03/99B8: A5 A9        LDA $A9
03/99BA: 0D 74 39     ORA $3974       ; shield creature type
03/99BD: 91 80        STA ($80),Y     ; defense vs. creature types
; defense multiplier
03/99BF: A0 28 00     LDY #$0028
03/99C2: AD 65 39     LDA $3965
03/99C5: 20 84 84     JSR $8484       ; lsr4
03/99C8: 85 DF        STA $DF
03/99CA: AD 6B 39     LDA $396B       ; shield multiplier
03/99CD: 85 E1        STA $E1
03/99CF: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/99D2: AD 67 39     LDA $3967       ; agility / 8
03/99D5: 20 85 84     JSR $8485       ; lsr3
03/99D8: 18           CLC 
03/99D9: 65 E3        ADC $E3         ; add level / 16 * shield multiplier
03/99DB: 91 80        STA ($80),Y     ; set defense multiplier
; defense %
03/99DD: A0 02 00     LDY #$0002
03/99E0: 7B           TDC 
03/99E1: AA           TAX 
03/99E2: 18           CLC 
03/99E3: B1 82        LDA ($82),Y     ; defense %
03/99E5: 29 7F        AND #$7F
03/99E7: 65 AA        ADC $AA         ; *** bug *** this doesn't get initialized
03/99E9: 85 AA        STA $AA         ; retains immune elements (affects adamant armor)
03/99EB: 98           TYA 
03/99EC: 18           CLC 
03/99ED: 69 0B        ADC #$0B
03/99EF: A8           TAY 
03/99F0: E8           INX 
03/99F1: E0 03 00     CPX #$0003
03/99F4: D0 EC        BNE $99E2
03/99F6: A0 29 00     LDY #$0029
03/99F9: 18           CLC 
03/99FA: A5 AA        LDA $AA
03/99FC: 6D 6C 39     ADC $396C       ; shield defense %
03/99FF: 20 20 9E     JSR $9E20       ; max 99
03/9A02: 91 80        STA ($80),Y     ; set defense rate
; defense
03/9A04: AD 68 39     LDA $3968       ; mod. stamina / 2
03/9A07: 4A           LSR 
03/9A08: 85 A9        STA $A9
03/9A0A: 7B           TDC 
03/9A0B: AA           TAX 
03/9A0C: A8           TAY 
03/9A0D: C8           INY 
03/9A0E: 18           CLC 
03/9A0F: B1 82        LDA ($82),Y     ; defense
03/9A11: 65 A9        ADC $A9
03/9A13: 85 A9        STA $A9
03/9A15: 98           TYA 
03/9A16: 18           CLC 
03/9A17: 69 0B        ADC #$0B
03/9A19: A8           TAY 
03/9A1A: E8           INX 
03/9A1B: E0 03 00     CPX #$0003
03/9A1E: D0 EE        BNE $9A0E
03/9A20: A0 2A 00     LDY #$002A
03/9A23: 18           CLC 
03/9A24: A5 A9        LDA $A9
03/9A26: 6D 6F 39     ADC $396F       ; add defense from shields
03/9A29: 20 27 9E     JSR $9E27       ; max 255
03/9A2C: 91 80        STA ($80),Y     ; set defense
; status immunity
03/9A2E: 7B           TDC 
03/9A2F: AA           TAX 
03/9A30: 86 A9        STX $A9
03/9A32: A0 09 00     LDY #$0009
03/9A35: B1 82        LDA ($82),Y     ; status 1
03/9A37: 05 A9        ORA $A9
03/9A39: 85 A9        STA $A9
03/9A3B: C8           INY 
03/9A3C: B1 82        LDA ($82),Y     ; status 2
03/9A3E: 05 AA        ORA $AA
03/9A40: 85 AA        STA $AA
03/9A42: 98           TYA 
03/9A43: 18           CLC 
03/9A44: 69 0A        ADC #$0A
03/9A46: A8           TAY 
03/9A47: E8           INX 
03/9A48: E0 03 00     CPX #$0003
03/9A4B: D0 E8        BNE $9A35
; elemental defense
03/9A4D: A0 2B 00     LDY #$002B
03/9A50: A5 A9        LDA $A9
03/9A52: 0D 70 39     ORA $3970       ; shield status 1
03/9A55: 91 80        STA ($80),Y     ; set status 1 immunity
03/9A57: C8           INY 
03/9A58: A5 AA        LDA $AA
03/9A5A: 0D 71 39     ORA $3971       ; shield status 1
03/9A5D: 91 80        STA ($80),Y     ; set status 2 immunity
03/9A5F: A0 25 00     LDY #$0025
03/9A62: B1 80        LDA ($80),Y     ; strong elements
03/9A64: 85 A9        STA $A9
03/9A66: 20 9E 9D     JSR $9D9E       ; get opposing elements
03/9A69: A0 20 00     LDY #$0020
03/9A6C: 91 80        STA ($80),Y     ; weak elements
03/9A6E: A0 26 00     LDY #$0026
03/9A71: B1 80        LDA ($80),Y     ; immune elements
03/9A73: 85 A9        STA $A9
03/9A75: 20 9E 9D     JSR $9D9E       ; get opposing elements
03/9A78: F0 07        BEQ $9A81       ; branch if no opposing elements
03/9A7A: A0 21 00     LDY #$0021
03/9A7D: 09 80        ORA #$80        ; set very weak flag
03/9A7F: 91 80        STA ($80),Y     ; very weak elements
; mag. def multiplier
03/9A81: A0 22 00     LDY #$0022
03/9A84: 18           CLC 
03/9A85: AD 69 39     LDA $3969       ; intellect
03/9A88: 6D 6A 39     ADC $396A       ; spirit
03/9A8B: 85 AA        STA $AA
03/9A8D: 20 83 84     JSR $8483       ; lsr5
03/9A90: 85 A9        STA $A9
03/9A92: AD 67 39     LDA $3967       ; agility / 32
03/9A95: 20 83 84     JSR $8483       ; lsr5
03/9A98: 18           CLC 
03/9A99: 65 A9        ADC $A9         ; add (int + spirit) / 32
03/9A9B: 91 80        STA ($80),Y     ; set mag. def multiplier
; mag. def %
03/9A9D: A5 AA        LDA $AA
03/9A9F: 20 85 84     JSR $8485       ; lsr3
03/9AA2: 85 A9        STA $A9         ; (int + spirit) / 8
03/9AA4: 7B           TDC 
03/9AA5: A8           TAY 
03/9AA6: AA           TAX 
03/9AA7: 18           CLC 
03/9AA8: B1 82        LDA ($82),Y     ; armor mag. def %
03/9AAA: 29 7F        AND #$7F
03/9AAC: 65 A9        ADC $A9
03/9AAE: 85 A9        STA $A9
03/9AB0: 98           TYA 
03/9AB1: 18           CLC 
03/9AB2: 69 0B        ADC #$0B
03/9AB4: A8           TAY 
03/9AB5: E8           INX 
03/9AB6: E0 03 00     CPX #$0003
03/9AB9: D0 EC        BNE $9AA7
03/9ABB: A0 23 00     LDY #$0023
03/9ABE: 18           CLC 
03/9ABF: A5 A9        LDA $A9
03/9AC1: 6D 72 39     ADC $3972       ; add shield mag. def %
03/9AC4: 20 20 9E     JSR $9E20       ; max 99
03/9AC7: 91 80        STA ($80),Y
; mag. def base
03/9AC9: A0 03 00     LDY #$0003
03/9ACC: 7B           TDC 
03/9ACD: AA           TAX 
03/9ACE: 86 A9        STX $A9
03/9AD0: 18           CLC 
03/9AD1: B1 82        LDA ($82),Y     ; armor mag. def base
03/9AD3: 65 A9        ADC $A9
03/9AD5: 85 A9        STA $A9
03/9AD7: 98           TYA 
03/9AD8: 18           CLC 
03/9AD9: 69 0B        ADC #$0B
03/9ADB: A8           TAY 
03/9ADC: E8           INX 
03/9ADD: E0 03 00     CPX #$0003
03/9AE0: D0 EE        BNE $9AD0
03/9AE2: A0 24 00     LDY #$0024
03/9AE5: 18           CLC 
03/9AE6: A5 A9        LDA $A9
03/9AE8: 6D 73 39     ADC $3973       ; add shield mag. def base
03/9AEB: 20 27 9E     JSR $9E27       ; max 255
03/9AEE: 91 80        STA ($80),Y
03/9AF0: A2 15 00     LDX #$0015
03/9AF3: 9E 9C 28     STZ $289C,X     ; clear buffer
03/9AF6: CA           DEX 
03/9AF7: 10 FA        BPL $9AF3
03/9AF9: 9C 77 39     STZ $3977
03/9AFC: A0 01 00     LDY #$0001
03/9AFF: B1 80        LDA ($80),Y     ; character id
03/9B01: 29 0F        AND #$0F
03/9B03: C9 06        CMP #$06
03/9B05: D0 03        BNE $9B0A       ; branch if not yang
03/9B07: EE 77 39     INC $3977
03/9B0A: A0 33 00     LDY #$0033
03/9B0D: B1 80        LDA ($80),Y
03/9B0F: F0 20        BEQ $9B31       ; branch if no left hand item
03/9B11: A0 25 00     LDY #$0025
03/9B14: B1 82        LDA ($82),Y
03/9B16: 30 19        BMI $9B31       ; branch if shield in left hand
03/9B18: AD 77 39     LDA $3977
03/9B1B: 09 80        ORA #$80
03/9B1D: 8D 77 39     STA $3977
03/9B20: A0 21 00     LDY #$0021
03/9B23: 7B           TDC 
03/9B24: AA           TAX 
03/9B25: B1 82        LDA ($82),Y
03/9B27: 9D 9C 28     STA $289C,X     ; copy left hand weapon to buffer
03/9B2A: C8           INY 
03/9B2B: E8           INX 
03/9B2C: E0 0B 00     CPX #$000B
03/9B2F: D0 F4        BNE $9B25
03/9B31: A0 35 00     LDY #$0035
03/9B34: B1 80        LDA ($80),Y
03/9B36: F0 21        BEQ $9B59       ; branch if no right hand item
03/9B38: A0 30 00     LDY #$0030
03/9B3B: B1 82        LDA ($82),Y
03/9B3D: 30 1A        BMI $9B59       ; branch if shield in right hand
03/9B3F: AD 77 39     LDA $3977
03/9B42: 09 40        ORA #$40
03/9B44: 8D 77 39     STA $3977
03/9B47: A0 2C 00     LDY #$002C
03/9B4A: A2 0B 00     LDX #$000B
03/9B4D: B1 82        LDA ($82),Y
03/9B4F: 9D 9C 28     STA $289C,X     ; copy right hand weapon to buffer
03/9B52: C8           INY 
03/9B53: E8           INX 
03/9B54: E0 16 00     CPX #$0016
03/9B57: D0 F4        BNE $9B4D
03/9B59: AD 77 39     LDA $3977
03/9B5C: 29 C0        AND #$C0
03/9B5E: F0 09        BEQ $9B69       ; branch if no weapons equipped
03/9B60: 49 C0        EOR #$C0
03/9B62: D0 55        BNE $9BB9       ; branch if one weapon equipped
03/9B64: AD A2 28     LDA $28A2
03/9B67: 29 C0        AND #$C0
03/9B69: F0 4C        BEQ $9BB7       ; branch if no bow or arrow in left hand
; has bow and arrow
03/9B6B: A9 80        LDA #$80
03/9B6D: 8D 78 39     STA $3978       ; bow in left hand
03/9B70: AD A2 28     LDA $28A2
03/9B73: 29 80        AND #$80
03/9B75: D0 36        BNE $9BAD       ; branch if bow in left hand
03/9B77: A9 40        LDA #$40
03/9B79: 8D 78 39     STA $3978
03/9B7C: 7B           TDC 
03/9B7D: AA           TAX 
03/9B7E: A0 16 00     LDY #$0016
03/9B81: BD 9C 28     LDA $289C,X     ; swap left and right hand
03/9B84: 99 9C 28     STA $289C,Y
03/9B87: E8           INX 
03/9B88: C8           INY 
03/9B89: E0 0B 00     CPX #$000B
03/9B8C: D0 F3        BNE $9B81
03/9B8E: 7B           TDC 
03/9B8F: A8           TAY 
03/9B90: BD 9C 28     LDA $289C,X
03/9B93: 99 9C 28     STA $289C,Y
03/9B96: E8           INX 
03/9B97: C8           INY 
03/9B98: E0 16 00     CPX #$0016
03/9B9B: D0 F3        BNE $9B90
03/9B9D: A0 0B 00     LDY #$000B
03/9BA0: BD 9C 28     LDA $289C,X
03/9BA3: 99 9C 28     STA $289C,Y
03/9BA6: E8           INX 
03/9BA7: C8           INY 
03/9BA8: C0 16 00     CPY #$0016
03/9BAB: D0 F3        BNE $9BA0
03/9BAD: AD 77 39     LDA $3977
03/9BB0: 29 3F        AND #$3F
03/9BB2: 09 A0        ORA #$A0
03/9BB4: 8D 77 39     STA $3977
03/9BB7: 80 2B        BRA $9BE4
; one weapon
03/9BB9: AD 77 39     LDA $3977
03/9BBC: 30 26        BMI $9BE4       ; branch if left hand has a weapon
03/9BBE: A2 0B 00     LDX #$000B
03/9BC1: 7B           TDC 
03/9BC2: A8           TAY 
03/9BC3: BD 9C 28     LDA $289C,X     ; copy right hand to left hand
03/9BC6: 99 9C 28     STA $289C,Y
03/9BC9: E8           INX 
03/9BCA: C8           INY 
03/9BCB: C0 0B 00     CPY #$000B
03/9BCE: D0 F3        BNE $9BC3
03/9BD0: BB           TYX 
03/9BD1: 9E 9C 28     STZ $289C,X     ; clear right hand
03/9BD4: E8           INX 
03/9BD5: E0 16 00     CPX #$0016
03/9BD8: D0 F7        BNE $9BD1
03/9BDA: AD 77 39     LDA $3977       ; treat right hand weapon as left hand
03/9BDD: 29 3F        AND #$3F
03/9BDF: 09 80        ORA #$80
03/9BE1: 8D 77 39     STA $3977
; weapon element
03/9BE4: 7B           TDC 
03/9BE5: AA           TAX 
03/9BE6: 86 A9        STX $A9
03/9BE8: AD A0 28     LDA $28A0
03/9BEB: 30 05        BMI $9BF2       ; branch if shield in left hand
03/9BED: AD A4 28     LDA $28A4       ; left hand weapon element
03/9BF0: 85 A9        STA $A9
03/9BF2: AD AB 28     LDA $28AB
03/9BF5: 30 05        BMI $9BFC       ; branch if shield in right hand
03/9BF7: AD AF 28     LDA $28AF       ; right hand weapon element
03/9BFA: 85 AA        STA $AA
03/9BFC: A5 A9        LDA $A9
03/9BFE: 05 AA        ORA $AA
03/9C00: A0 19 00     LDY #$0019
03/9C03: 91 80        STA ($80),Y     ; set attack element
; weapon creature type bonus
03/9C05: 7B           TDC 
03/9C06: AA           TAX 
03/9C07: 86 A9        STX $A9
03/9C09: AD A0 28     LDA $28A0
03/9C0C: 30 05        BMI $9C13       ; branch if shield in left hand
03/9C0E: AD A1 28     LDA $28A1       ; left hand creature type
03/9C11: 85 A9        STA $A9
03/9C13: AD AB 28     LDA $28AB
03/9C16: 30 05        BMI $9C1D       ; branch if shield in right hand
03/9C18: AD AC 28     LDA $28AC       ; right hand creature type
03/9C1B: 85 AA        STA $AA
03/9C1D: A5 A9        LDA $A9
03/9C1F: 05 AA        ORA $AA
; attack multiplier
03/9C21: A0 1A 00     LDY #$001A
03/9C24: 91 80        STA ($80),Y     ; set creature type attack bonus
03/9C26: AD 66 39     LDA $3966       ; strength / 8
03/9C29: 20 85 84     JSR $8485       ; lsr3
03/9C2C: 85 A9        STA $A9
03/9C2E: AD 67 39     LDA $3967       ; agility / 16
03/9C31: 20 84 84     JSR $8484       ; lsr4
03/9C34: 18           CLC 
03/9C35: 65 A9        ADC $A9
03/9C37: 1A           INC 
03/9C38: A0 1B 00     LDY #$001B
03/9C3B: 91 80        STA ($80),Y     ; attack multiplier
; attack %
03/9C3D: AD 65 39     LDA $3965       ; level / 4
03/9C40: 20 86 84     JSR $8486       ; lsr2
03/9C43: 85 A9        STA $A9
03/9C45: AD 77 39     LDA $3977
03/9C48: 29 C0        AND #$C0
03/9C4A: F0 21        BEQ $9C6D       ; branch if unarmed
03/9C4C: 49 C0        EOR #$C0
03/9C4E: D0 26        BNE $9C76       ; branch if one weapon
; dual-wield
03/9C50: 18           CLC 
03/9C51: AD 9E 28     LDA $289E       ; left hand weapon attack %
03/9C54: 29 7F        AND #$7F
03/9C56: 65 A9        ADC $A9
03/9C58: 85 AA        STA $AA
03/9C5A: 18           CLC 
03/9C5B: AD A9 28     LDA $28A9       ; right hand weapon attack %
03/9C5E: 29 7F        AND #$7F
03/9C60: 65 A9        ADC $A9
03/9C62: 65 AA        ADC $AA
03/9C64: 4A           LSR 
03/9C65: C9 63        CMP #$63        ; max 99
03/9C67: 90 18        BCC $9C81
03/9C69: A9 63        LDA #$63
03/9C6B: 80 14        BRA $9C81
; unarmed
03/9C6D: 18           CLC 
03/9C6E: AF 02 91 0F  LDA $0F9102     ; unarmed attack % + level / 4
03/9C72: 65 A9        ADC $A9
03/9C74: 80 08        BRA $9C7E
; single weapon
03/9C76: 18           CLC 
03/9C77: AD 9E 28     LDA $289E       ; left hand weapon attack %
03/9C7A: 29 7F        AND #$7F
03/9C7C: 65 A9        ADC $A9
03/9C7E: 20 20 9E     JSR $9E20       ; max 99
03/9C81: A0 1C 00     LDY #$001C
03/9C84: 91 80        STA ($80),Y     ; set attack %
; attack power
03/9C86: AD 66 39     LDA $3966       ; strength / 4
03/9C89: 20 86 84     JSR $8486       ; lsr2
03/9C8C: 85 AA        STA $AA
03/9C8E: AD 77 39     LDA $3977
03/9C91: 29 01        AND #$01
03/9C93: F0 0B        BEQ $9CA0       ; branch if not yang
; yang (attack = strength / 4 + level * 2 + 2)
03/9C95: AD 65 39     LDA $3965       ; level * 2
03/9C98: 0A           ASL 
03/9C99: 18           CLC 
03/9C9A: 65 AA        ADC $AA
03/9C9C: 69 02        ADC #$02
03/9C9E: 80 66        BRA $9D06
; not yang
03/9CA0: AD 77 39     LDA $3977
03/9CA3: 29 C0        AND #$C0
03/9CA5: F0 57        BEQ $9CFE       ; branch if unarmed
03/9CA7: 49 C0        EOR #$C0
03/9CA9: D0 17        BNE $9CC2       ; branch if single weapon
; dual-wield
03/9CAB: 18           CLC 
03/9CAC: AD 9D 28     LDA $289D       ; left hand weapon attack
03/9CAF: 65 A9        ADC $A9         ; add level / 4
03/9CB1: 65 AA        ADC $AA         ; add strength / 4
03/9CB3: 85 AB        STA $AB
03/9CB5: 18           CLC 
03/9CB6: AD A8 28     LDA $28A8       ; right hand weapon attack
03/9CB9: 65 A9        ADC $A9         ; add level / 4
03/9CBB: 65 AA        ADC $AA         ; add strength / 4
03/9CBD: 18           CLC 
03/9CBE: 65 AB        ADC $AB
03/9CC0: 80 44        BRA $9D06
; single weapon
03/9CC2: AD 77 39     LDA $3977
03/9CC5: 29 20        AND #$20
03/9CC7: F0 35        BEQ $9CFE       ; branch if bow with no arrows
03/9CC9: AD 9D 28     LDA $289D       ; weapon attack (bow)
03/9CCC: 4A           LSR 
03/9CCD: 18           CLC 
03/9CCE: 6D A8 28     ADC $28A8       ; arrow attack
03/9CD1: 65 AA        ADC $AA         ; add strength / 4
03/9CD3: 85 BF        STA $BF
03/9CD5: A0 00 00     LDY #$0000
03/9CD8: B1 80        LDA ($80),Y     ; character handedness
03/9CDA: 29 C0        AND #$C0
03/9CDC: 2D 78 39     AND $3978
03/9CDF: F0 19        BEQ $9CFA       ; branch if bow is in main hand
03/9CE1: A5 BF        LDA $BF
03/9CE3: AA           TAX 
03/9CE4: 8E 45 39     STX $3945
03/9CE7: A2 05 00     LDX #$0005      ; 20% attack penalty if bow in off-hand
03/9CEA: 8E 47 39     STX $3947
03/9CED: 20 07 84     JSR $8407       ; divide
03/9CF0: 38           SEC 
03/9CF1: A5 BF        LDA $BF
03/9CF3: ED 49 39     SBC $3949
03/9CF6: 85 BF        STA $BF
03/9CF8: 80 0F        BRA $9D09
03/9CFA: A5 BF        LDA $BF
03/9CFC: 80 0B        BRA $9D09
; unarmed
03/9CFE: 18           CLC 
03/9CFF: AD 9D 28     LDA $289D
03/9D02: 65 A9        ADC $A9
03/9D04: 65 AA        ADC $AA
03/9D06: 20 27 9E     JSR $9E27       ; max 255
03/9D09: A0 1D 00     LDY #$001D
03/9D0C: 91 80        STA ($80),Y     ; set attack
; attack status
03/9D0E: AD A5 28     LDA $28A5
03/9D11: 0D B0 28     ORA $28B0
03/9D14: A0 1E 00     LDY #$001E
03/9D17: 91 80        STA ($80),Y
03/9D19: AD A6 28     LDA $28A6
03/9D1C: 0D B1 28     ORA $28B1
03/9D1F: C8           INY 
03/9D20: 91 80        STA ($80),Y
03/9D22: A0 41 00     LDY #$0041
03/9D25: B1 80        LDA ($80),Y     ; crit rate
03/9D27: 85 A9        STA $A9
03/9D29: C8           INY 
03/9D2A: B1 80        LDA ($80),Y     ; crit bonus
03/9D2C: 85 AA        STA $AA
03/9D2E: AD 77 39     LDA $3977
03/9D31: 29 C0        AND #$C0
03/9D33: F0 51        BEQ $9D86       ; branch if unarmed
03/9D35: 49 C0        EOR #$C0
03/9D37: F0 4D        BEQ $9D86       ; branch if single weapon
03/9D39: AD 77 39     LDA $3977
03/9D3C: 29 20        AND #$20
03/9D3E: F0 22        BEQ $9D62       ; branch if no bow
; bow and arrow
03/9D40: A5 A9        LDA $A9
03/9D42: C9 21        CMP #$21
03/9D44: 90 02        BCC $9D48
03/9D46: A9 21        LDA #$21
03/9D48: 85 DF        STA $DF
03/9D4A: A9 03        LDA #$03        ; crit rate * 3
03/9D4C: 85 E1        STA $E1
03/9D4E: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9D51: A5 E3        LDA $E3
03/9D53: 85 A9        STA $A9
03/9D55: 18           CLC 
03/9D56: A5 AA        LDA $AA
03/9D58: 6D A8 28     ADC $28A8       ; add arrow attack to crit bonus
03/9D5B: 20 27 9E     JSR $9E27       ; max 255
03/9D5E: 85 AA        STA $AA
03/9D60: 80 18        BRA $9D7A
; dual-wield
03/9D62: 06 A9        ASL $A9         ; 2x crit rate
03/9D64: 90 04        BCC $9D6A
03/9D66: A9 63        LDA #$63        ; max 99
03/9D68: 80 02        BRA $9D6C
03/9D6A: A5 A9        LDA $A9
03/9D6C: 85 A9        STA $A9
03/9D6E: AD 9D 28     LDA $289D       ; add left hand attack / 2 to crit bonus
03/9D71: 4A           LSR 
03/9D72: 18           CLC 
03/9D73: 65 AA        ADC $AA
03/9D75: 20 27 9E     JSR $9E27       ; max 255
03/9D78: 85 AA        STA $AA
03/9D7A: A0 2D 00     LDY #$002D
03/9D7D: A5 A9        LDA $A9
03/9D7F: 91 80        STA ($80),Y     ; set crit rate
03/9D81: C8           INY 
03/9D82: A5 AA        LDA $AA
03/9D84: 91 80        STA ($80),Y     ; set crit bonus
03/9D86: AD 77 39     LDA $3977
03/9D89: 29 20        AND #$20
03/9D8B: D0 07        BNE $9D94       ; branch if bow and arrow
03/9D8D: AD 9C 28     LDA $289C
03/9D90: 29 20        AND #$20
03/9D92: F0 09        BEQ $9D9D       ; branch if weapon has back row penalty
03/9D94: A0 01 00     LDY #$0001
03/9D97: B1 80        LDA ($80),Y     ; no back row penalty
03/9D99: 09 20        ORA #$20
03/9D9B: 91 80        STA ($80),Y
03/9D9D: 60           RTS 

; [ get opposing elements ]

; *** bug *** adamant armor makes a character very weak to fire and ice

03/9D9E: 29 12        AND #$12        ; mask holy and ice
03/9DA0: 4A           LSR             ; shift to darkness and fire
03/9DA1: 85 AA        STA $AA
03/9DA3: A5 A9        LDA $A9
03/9DA5: 29 09        AND #$09        ; mask darkness and fire
03/9DA7: 0A           ASL             ; shift to holy and ice
03/9DA8: 05 AA        ORA $AA
03/9DAA: 60           RTS 

; [ get shield properties ]

03/9DAB: EE 6B 39     INC $396B       ; increment shield multiplier
03/9DAE: 18           CLC 
03/9DAF: B1 82        LDA ($82),Y     ; mag. def %
03/9DB1: 29 7F        AND #$7F
03/9DB3: 6D 72 39     ADC $3972
03/9DB6: 8D 72 39     STA $3972
03/9DB9: C8           INY 
03/9DBA: 18           CLC 
03/9DBB: B1 82        LDA ($82),Y     ; defense
03/9DBD: 6D 6F 39     ADC $396F
03/9DC0: 8D 6F 39     STA $396F
03/9DC3: C8           INY 
03/9DC4: 18           CLC 
03/9DC5: B1 82        LDA ($82),Y     ; defense %
03/9DC7: 29 7F        AND #$7F
03/9DC9: 6D 6C 39     ADC $396C
03/9DCC: 8D 6C 39     STA $396C
03/9DCF: C8           INY 
03/9DD0: 18           CLC 
03/9DD1: B1 82        LDA ($82),Y     ; mag. def
03/9DD3: 6D 73 39     ADC $3973
03/9DD6: 8D 73 39     STA $3973
03/9DD9: C8           INY 
03/9DDA: C8           INY 
03/9DDB: B1 82        LDA ($82),Y     ; creature type
03/9DDD: 0D 74 39     ORA $3974
03/9DE0: 8D 74 39     STA $3974
03/9DE3: C8           INY 
03/9DE4: C8           INY 
03/9DE5: C8           INY 
03/9DE6: B1 82        LDA ($82),Y     ; element
03/9DE8: 8D 6D 39     STA $396D
03/9DEB: C8           INY 
03/9DEC: B1 82        LDA ($82),Y     ; status 1
03/9DEE: 0D 70 39     ORA $3970
03/9DF1: 8D 70 39     STA $3970
03/9DF4: C8           INY 
03/9DF5: B1 82        LDA ($82),Y     ; status 2
03/9DF7: 0D 71 39     ORA $3971
03/9DFA: 8D 71 39     STA $3971
03/9DFD: 60           RTS 

; [ copy equipped item data to character properties ]

03/9DFE: AD 75 39     LDA $3975       ; current character slot
03/9E01: 20 7E 84     JSR $847E       ; asl3
03/9E04: A8           TAY 
03/9E05: A6 A6        LDX $A6
03/9E07: B9 DB 32     LDA $32DB,Y     ; left hand item
03/9E0A: 9D 33 20     STA $2033,X
03/9E0D: B9 DC 32     LDA $32DC,Y     ; left hand quantity
03/9E10: 9D 34 20     STA $2034,X
03/9E13: B9 DF 32     LDA $32DF,Y     ; right hand item
03/9E16: 9D 35 20     STA $2035,X
03/9E19: B9 E0 32     LDA $32E0,Y     ; right hand quantity
03/9E1C: 9D 36 20     STA $2036,X
03/9E1F: 60           RTS 

; [ max 99 ]

03/9E20: C9 63        CMP #$63
03/9E22: 90 02        BCC $9E26
03/9E24: A9 63        LDA #$63
03/9E26: 60           RTS 

; [ max 255 ]

03/9E27: 90 02        BCC $9E2B
03/9E29: A9 FF        LDA #$FF
03/9E2B: 60           RTS 

; [ calculate timer duration ]

03/9E2C: 9C 58 35     STZ $3558
03/9E2F: C9 05        CMP #$05
03/9E31: 90 03        BCC $9E36
03/9E33: EE 58 35     INC $3558
03/9E36: 20 89 84     JSR $8489       ; set current character/monster
03/9E39: A6 A6        LDX $A6
03/9E3B: BD 60 20     LDA $2060,X     ; base timer duration
03/9E3E: 85 A9        STA $A9
03/9E40: BD 61 20     LDA $2061,X
03/9E43: 85 AA        STA $AA
03/9E45: BD 3B 20     LDA $203B,X     ; speed modifier
03/9E48: A8           TAY 
03/9E49: 8C 79 39     STY $3979
03/9E4C: DA           PHX 
03/9E4D: A5 D6        LDA $D6         ; timer duration function
03/9E4F: 0A           ASL 
03/9E50: AA           TAX 
03/9E51: BF FB 9F 03  LDA $039FFB,X
03/9E55: 85 80        STA $80
03/9E57: BF FC 9F 03  LDA $039FFC,X
03/9E5B: 85 81        STA $81
03/9E5D: A9 03        LDA #$03
03/9E5F: 85 82        STA $82
03/9E61: FA           PLX 
03/9E62: DC 80 00     JML [$0080]

; timer duration $00: action
03/9E65: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9E68: A4 AB        LDY $AB
03/9E6A: D0 02        BNE $9E6E
03/9E6C: E6 AB        INC $AB         ; min 1
03/9E6E: 4C CF 9F     JMP $9FCF
; timer duration $01/$02: immediate
03/9E71: AD 58 35     LDA $3558
03/9E74: D0 04        BNE $9E7A
03/9E76: 7B           TDC 
03/9E77: AA           TAX 
03/9E78: 80 03        BRA $9E7D
03/9E7A: A2 01 00     LDX #$0001
03/9E7D: 86 A9        STX $A9
03/9E7F: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9E82: 4C CF 9F     JMP $9FCF
; timer duration $0B: item
03/9E85: AD 7B 39     LDA $397B
03/9E88: 85 DF        STA $DF
03/9E8A: A9 06        LDA #$06
03/9E8C: 85 E1        STA $E1
03/9E8E: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9E91: A6 E3        LDX $E3
03/9E93: BF 80 96 0F  LDA $0F9680,X   ; item action delay (all are zero in vanilla)
03/9E97: 80 12        BRA $9EAB
; timer duration $03: magic
03/9E99: AD 7B 39     LDA $397B
03/9E9C: 85 DF        STA $DF
03/9E9E: A9 06        LDA #$06
03/9EA0: 85 E1        STA $E1
03/9EA2: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9EA5: A6 E3        LDX $E3
03/9EA7: BF A0 97 0F  LDA $0F97A0,X   ; magic action delay
03/9EAB: 29 1F        AND #$1F
03/9EAD: AA           TAX 
03/9EAE: 86 A9        STX $A9
03/9EB0: 06 A9        ASL $A9         ; multiply by 2
03/9EB2: 26 AA        ROL $AA
03/9EB4: AD 8B 38     LDA $388B
03/9EB7: F0 04        BEQ $9EBD       ; branch if not auto-battle
03/9EB9: 7B           TDC 
03/9EBA: AA           TAX 
03/9EBB: 86 A9        STX $A9
03/9EBD: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9EC0: 4C CF 9F     JMP $9FCF
; timer duration $04/$05: sleep/paralyze
03/9EC3: AD 58 35     LDA $3558
03/9EC6: F0 05        BEQ $9ECD       ; branch if a character
03/9EC8: BD 2F 20     LDA $202F,X     ; monster level + 10
03/9ECB: 80 03        BRA $9ED0
03/9ECD: BD 18 20     LDA $2018,X     ; mod. spirit
03/9ED0: 85 AD        STA $AD
03/9ED2: 06 AD        ASL $AD
03/9ED4: 06 AD        ASL $AD
03/9ED6: 38           SEC 
03/9ED7: A9 2C        LDA #$2C        ; 300 - 4 * (mod. spirit)
03/9ED9: E5 AD        SBC $AD
03/9EDB: 85 A9        STA $A9
03/9EDD: A9 01        LDA #$01
03/9EDF: E9 00        SBC #$00
03/9EE1: 85 AA        STA $AA
03/9EE3: B0 05        BCS $9EEA
03/9EE5: A2 01 00     LDX #$0001      ; min 1
03/9EE8: 86 A9        STX $A9
03/9EEA: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9EED: A6 AB        LDX $AB
03/9EEF: 8E 45 39     STX $3945
03/9EF2: A2 06 00     LDX #$0006      ; divide by 6
03/9EF5: 8E 47 39     STX $3947
03/9EF8: 20 07 84     JSR $8407       ; divide
03/9EFB: AE 49 39     LDX $3949
03/9EFE: 86 AB        STX $AB
03/9F00: 4C CF 9F     JMP $9FCF
; timer duration $06/$07:  poison/petrify
03/9F03: AD 58 35     LDA $3558
03/9F06: F0 05        BEQ $9F0D
03/9F08: BD 2F 20     LDA $202F,X
03/9F0B: 80 03        BRA $9F10
03/9F0D: BD 16 20     LDA $2016,X
03/9F10: 18           CLC 
03/9F11: 69 14        ADC #$14
03/9F13: AA           TAX 
03/9F14: 86 A9        STX $A9
03/9F16: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9F19: 4C CF 9F     JMP $9FCF
; timer duration $08: reflect
03/9F1C: AD 7B 39     LDA $397B
03/9F1F: 85 AD        STA $AD
03/9F21: 64 AE        STZ $AE
03/9F23: 06 AD        ASL $AD
03/9F25: 26 AE        ROL $AE
03/9F27: 18           CLC 
03/9F28: A5 AD        LDA $AD
03/9F2A: 69 1E        ADC #$1E
03/9F2C: 85 A9        STA $A9
03/9F2E: A5 AE        LDA $AE
03/9F30: 69 00        ADC #$00
03/9F32: 85 AA        STA $AA
03/9F34: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9F37: 4C CF 9F     JMP $9FCF
; timer duration $09: sap
03/9F3A: AD 58 35     LDA $3558
03/9F3D: F0 0B        BEQ $9F4A
03/9F3F: BD 2F 20     LDA $202F,X
03/9F42: 85 AD        STA $AD
03/9F44: A9 04        LDA #$04
03/9F46: 85 AE        STA $AE
03/9F48: 80 0D        BRA $9F57
03/9F4A: 18           CLC 
03/9F4B: BD 17 20     LDA $2017,X
03/9F4E: 7D 18 20     ADC $2018,X
03/9F51: 85 AD        STA $AD
03/9F53: A9 02        LDA #$02
03/9F55: 85 AE        STA $AE
03/9F57: A5 AD        LDA $AD
03/9F59: 85 DF        STA $DF
03/9F5B: A5 AE        LDA $AE
03/9F5D: 85 E2        STA $E2
03/9F5F: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9F62: 18           CLC 
03/9F63: A5 E3        LDA $E3
03/9F65: 69 1E        ADC #$1E
03/9F67: 85 A9        STA $A9
03/9F69: A5 E4        LDA $E4
03/9F6B: 69 00        ADC #$00
03/9F6D: 85 AA        STA $AA
03/9F6F: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9F72: 4C CF 9F     JMP $9FCF
; timer duration $0A: stop
03/9F75: AD 7B 39     LDA $397B
03/9F78: 85 DF        STA $DF
03/9F7A: A9 03        LDA #$03
03/9F7C: 85 E1        STA $E1
03/9F7E: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/9F81: A6 E3        LDX $E3
03/9F83: 86 A9        STX $A9
03/9F85: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9F88: 4C CF 9F     JMP $9FCF
; timer duration $0C: action delay
03/9F8B: AD 7B 39     LDA $397B       ; battle command id
03/9F8E: C9 06        CMP #$06
03/9F90: D0 05        BNE $9F97       ; branch if not jump 1
03/9F92: A2 04 00     LDX #$0004
03/9F95: 80 33        BRA $9FCA
03/9F97: AA           TAX 
03/9F98: BF 89 FE 13  LDA $13FE89,X   ; action delay for each command
03/9F9C: D0 03        BNE $9FA1
03/9F9E: 4C 71 9E     JMP $9E71
03/9FA1: 10 15        BPL $9FB8
; msb set: delay is multiple of a turn
03/9FA3: 29 7F        AND #$7F
03/9FA5: AA           TAX 
03/9FA6: 8E 3F 39     STX $393F
03/9FA9: A6 A9        LDX $A9
03/9FAB: 8E 3D 39     STX $393D
03/9FAE: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/9FB1: AE 41 39     LDX $3941
03/9FB4: 86 A9        STX $A9
03/9FB6: 80 14        BRA $9FCC
; msb clear: delay is fraction of a turn
03/9FB8: AA           TAX 
03/9FB9: 8E 47 39     STX $3947
03/9FBC: A6 A9        LDX $A9
03/9FBE: 8E 45 39     STX $3945
03/9FC1: 20 07 84     JSR $8407       ; divide
03/9FC4: AE 49 39     LDX $3949
03/9FC7: D0 01        BNE $9FCA
03/9FC9: E8           INX 
03/9FCA: 86 A9        STX $A9
03/9FCC: 20 D8 9F     JSR $9FD8       ; apply speed modifier
03/9FCF: A4 AB        LDY $AB
03/9FD1: 10 02        BPL $9FD5       ; min zero
03/9FD3: 7B           TDC 
03/9FD4: A8           TAY 
03/9FD5: 84 D4        STY $D4
03/9FD7: 60           RTS 

; [ apply speed multiplier ]

03/9FD8: A6 A9        LDX $A9         ; base duration
03/9FDA: 8E 3D 39     STX $393D
03/9FDD: AE 79 39     LDX $3979       ; multiplier
03/9FE0: 8E 3F 39     STX $393F
03/9FE3: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/9FE6: AE 41 39     LDX $3941
03/9FE9: 8E 45 39     STX $3945
03/9FEC: A2 10 00     LDX #$0010
03/9FEF: 8E 47 39     STX $3947
03/9FF2: 20 07 84     JSR $8407       ; divide
03/9FF5: AE 49 39     LDX $3949
03/9FF8: 86 AB        STX $AB         ; mod. duration
03/9FFA: 60           RTS 

; timer duration jump table
03/9FFB: 9E65 9E71 9E71 9E99 9EC3 9EC3 9F03 9F03
03/A00B: 9F1C 9F3A 9F75 9E85 9F8B

; [ check if battle is over ]

03/A015: AD A8 00     LDA $00A8
03/A018: D0 63        BNE $A07D
03/A01A: A2 04 00     LDX #$0004
03/A01D: 86 A9        STX $A9
03/A01F: A6 A9        LDX $A9
03/A021: BD 40 35     LDA $3540,X
03/A024: D0 13        BNE $A039
03/A026: A5 A9        LDA $A9
03/A028: 20 89 84     JSR $8489       ; set current character/monster
03/A02B: A6 A6        LDX $A6
03/A02D: BD 03 20     LDA $2003,X
03/A030: 29 C0        AND #$C0
03/A032: D0 05        BNE $A039
03/A034: BD 05 20     LDA $2005,X
03/A037: 10 18        BPL $A051
03/A039: C6 A9        DEC $A9
03/A03B: A5 A9        LDA $A9
03/A03D: 10 E0        BPL $A01F
03/A03F: AD E5 38     LDA $38E5
03/A042: 29 02        AND #$02
03/A044: F0 04        BEQ $A04A
03/A046: A9 08        LDA #$08
03/A048: 80 02        BRA $A04C
03/A04A: A9 80        LDA #$80
03/A04C: 85 A8        STA $A8
03/A04E: 4C F6 A0     JMP $A0F6
03/A051: AD CD 29     LDA $29CD
03/A054: D0 28        BNE $A07E       ; branch if any monsters remain
; no monsters remaining
03/A056: A9 30        LDA #$30
03/A058: 85 A8        STA $A8
03/A05A: 7B           TDC 
03/A05B: AA           TAX 
03/A05C: BF 00 FD 13  LDA $13FD00,X   ; battles with no party update
03/A060: C9 FF        CMP #$FF
03/A062: F0 19        BEQ $A07D
03/A064: CD 00 18     CMP $1800
03/A067: D0 10        BNE $A079
03/A069: BF 01 FD 13  LDA $13FD01,X
03/A06D: CD 01 18     CMP $1801
03/A070: D0 07        BNE $A079
03/A072: A5 A8        LDA $A8         ; disable party update after battle
03/A074: 29 EF        AND #$EF
03/A076: 85 A8        STA $A8
03/A078: 60           RTS 
03/A079: E8           INX 
03/A07A: E8           INX 
03/A07B: 80 DF        BRA $A05C
03/A07D: 60           RTS 
; monsters remaining
03/A07E: AD 8B 38     LDA $388B
03/A081: D0 73        BNE $A0F6       ; return if auto-battle
03/A083: AD D3 38     LDA $38D3
03/A086: D0 05        BNE $A08D       ; return if used escape
03/A088: AD 2D 35     LDA $352D
03/A08B: F0 69        BEQ $A0F6       ; return if L and R buttons are not pressed
03/A08D: AD D6 38     LDA $38D6
03/A090: C9 FF        CMP #$FF
03/A092: F0 62        BEQ $A0F6
03/A094: AD D6 38     LDA $38D6
03/A097: F0 0A        BEQ $A0A3
03/A099: AD F3 38     LDA $38F3
03/A09C: D0 05        BNE $A0A3       ; branch if used escape ???
03/A09E: CE D6 38     DEC $38D6
03/A0A1: 80 53        BRA $A0F6
03/A0A3: AD E5 38     LDA $38E5
03/A0A6: 29 01        AND #$01
03/A0A8: D0 34        BNE $A0DE       ; branch if can't run
03/A0AA: 7B           TDC 
03/A0AB: AA           TAX 
03/A0AC: 86 A9        STX $A9
03/A0AE: A6 A9        LDX $A9
03/A0B0: BD 40 35     LDA $3540,X     ; branch if character slot is empty
03/A0B3: D0 21        BNE $A0D6
03/A0B5: A5 A9        LDA $A9
03/A0B7: 20 89 84     JSR $8489       ; set current character/monster
03/A0BA: A6 A6        LDX $A6
03/A0BC: BD 03 20     LDA $2003,X
03/A0BF: 29 C0        AND #$C0
03/A0C1: D0 13        BNE $A0D6       ; branch if character is dead or stone
03/A0C3: BD 04 20     LDA $2004,X
03/A0C6: 29 30        AND #$30
03/A0C8: D0 0C        BNE $A0D6       ; branch if paralyzed or asleep
03/A0CA: BD 05 20     LDA $2005,X
03/A0CD: 29 C2        AND #$C2
03/A0CF: D0 05        BNE $A0D6       ; branch if magnetized, stopped, or jumping
03/A0D1: A9 40        LDA #$40
03/A0D3: 85 A8        STA $A8         ; ran away
03/A0D5: 60           RTS 
03/A0D6: E6 A9        INC $A9
03/A0D8: A5 A9        LDA $A9
03/A0DA: C9 05        CMP #$05
03/A0DC: D0 D0        BNE $A0AE
03/A0DE: 9C 2D 35     STZ $352D
03/A0E1: 20 9B 85     JSR $859B       ; add message to graphics script
03/A0E4: A9 FF        LDA #$FF
03/A0E6: 8D C4 33     STA $33C4
03/A0E9: A9 22        LDA #$22
03/A0EB: 8D CA 34     STA $34CA
03/A0EE: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/A0F0: 20 85 80     JSR $8085       ; execute battle graphics
03/A0F3: 20 FD B2     JSR $B2FD       ; init graphics script
03/A0F6: 60           RTS 

; [ update enabled inventory items ]

03/A0F7: 64 A9        STZ $A9
03/A0F9: 64 AA        STZ $AA
03/A0FB: AD 22 18     LDA $1822
03/A0FE: 20 89 84     JSR $8489       ; set current character/monster
03/A101: A6 A6        LDX $A6
03/A103: BD 01 20     LDA $2001,X     ; character graphics id
03/A106: 29 0F        AND #$0F
03/A108: A8           TAY 
03/A109: C8           INY 
03/A10A: 38           SEC 
03/A10B: 26 A9        ROL $A9         ; set flag for character graphics id in +$A9
03/A10D: 26 AA        ROL $AA
03/A10F: 88           DEY 
03/A110: D0 F9        BNE $A10B
03/A112: 7B           TDC 
03/A113: AA           TAX 
03/A114: 86 AF        STX $AF
; start of item loop
03/A116: A6 AF        LDX $AF
03/A118: BD 1B 32     LDA $321B,X     ; inventory item id
03/A11B: F0 2F        BEQ $A14C       ; branch if empty
03/A11D: C9 C8        CMP #$C8
03/A11F: D0 0D        BNE $A12E       ; branch if not crystal
03/A121: A6 A6        LDX $A6
03/A123: BD 00 20     LDA $2000,X
03/A126: 29 1F        AND #$1F
03/A128: C9 0B        CMP #$0B
03/A12A: D0 0A        BNE $A136       ; branch if not paladin cecil
03/A12C: F0 14        BEQ $A142
03/A12E: 20 58 A1     JSR $A158       ; check if character can use item
03/A131: AD 3D 35     LDA $353D
03/A134: F0 0C        BEQ $A142       ; branch if character can use item
03/A136: A6 AF        LDX $AF
03/A138: BD 1A 32     LDA $321A,X     ; disable item
03/A13B: 09 80        ORA #$80
03/A13D: 9D 1A 32     STA $321A,X
03/A140: 80 0A        BRA $A14C
03/A142: A6 AF        LDX $AF
03/A144: BD 1A 32     LDA $321A,X     ; enable item
03/A147: 29 7F        AND #$7F
03/A149: 9D 1A 32     STA $321A,X
03/A14C: 18           CLC             ; next item
03/A14D: A5 AF        LDA $AF
03/A14F: 69 04        ADC #$04
03/A151: 85 AF        STA $AF
03/A153: C9 C0        CMP #$C0
03/A155: D0 BF        BNE $A116
03/A157: 60           RTS 

; [ check if character can use item ]

03/A158: 9C 3D 35     STZ $353D
03/A15B: C9 6D        CMP #$6D
03/A15D: 90 0A        BCC $A169
03/A15F: C9 DE        CMP #$DE
03/A161: B0 34        BCS $A197
03/A163: C9 B0        CMP #$B0
03/A165: 90 30        BCC $A197
03/A167: B0 31        BCS $A19A
03/A169: AA           TAX 
03/A16A: 86 E5        STX $E5
03/A16C: A2 00 91     LDX #$9100
03/A16F: 86 80        STX $80
03/A171: A9 0F        LDA #$0F
03/A173: 85 82        STA $82
03/A175: A9 08        LDA #$08
03/A177: 20 5E 84     JSR $845E       ; load array item
03/A17A: AD A2 28     LDA $28A2
03/A17D: 29 1F        AND #$1F
03/A17F: 0A           ASL 
03/A180: AA           TAX 
03/A181: BF 50 A5 0F  LDA $0FA550,X   ; item equipability
03/A185: 85 AB        STA $AB
03/A187: BF 51 A5 0F  LDA $0FA551,X
03/A18B: 85 AC        STA $AC
03/A18D: C2 20        REP #$20
03/A18F: A5 AB        LDA $AB
03/A191: 25 A9        AND $A9
03/A193: E2 20        SEP #$20
03/A195: D0 03        BNE $A19A       ; branch if character can use item
03/A197: EE 3D 35     INC $353D
03/A19A: C2 20        REP #$20
03/A19C: 7B           TDC 
03/A19D: E2 20        SEP #$20
03/A19F: 60           RTS 

; [ update enabled commands and spells ]

03/A1A0: 64 A9        STZ $A9         ; is mute
03/A1A2: 64 AA        STZ $AA
03/A1A4: 64 AB        STZ $AB         ; is toad
03/A1A6: 64 AC        STZ $AC         ; is pig
03/A1A8: A6 A6        LDX $A6
03/A1AA: BD 03 20     LDA $2003,X
03/A1AD: 29 04        AND #$04
03/A1AF: F0 04        BEQ $A1B5       ; branch if not mute
03/A1B1: A9 80        LDA #$80
03/A1B3: 85 A9        STA $A9
03/A1B5: BD 03 20     LDA $2003,X
03/A1B8: 29 20        AND #$20
03/A1BA: F0 04        BEQ $A1C0       ; branch if not toad
03/A1BC: A9 80        LDA #$80
03/A1BE: 85 AB        STA $AB
03/A1C0: BD 03 20     LDA $2003,X
03/A1C3: 29 08        AND #$08
03/A1C5: F0 04        BEQ $A1CB       ; branch if not pig
03/A1C7: A9 80        LDA #$80
03/A1C9: 85 AC        STA $AC
03/A1CB: BD 0B 20     LDA $200B,X     ; $AD: current mp (max 255)
03/A1CE: 85 AD        STA $AD
03/A1D0: BD 0C 20     LDA $200C,X
03/A1D3: F0 04        BEQ $A1D9
03/A1D5: A9 FF        LDA #$FF
03/A1D7: 85 AD        STA $AD
03/A1D9: A6 A6        LDX $A6
03/A1DB: BD 06 20     LDA $2006,X
03/A1DE: 30 17        BMI $A1F7       ; branch if hiding
03/A1E0: A0 05 00     LDY #$0005
03/A1E3: AE 34 35     LDX $3534
03/A1E6: BD 03 33     LDA $3303,X     ; battle command id
03/A1E9: C9 FF        CMP #$FF
03/A1EB: F0 03        BEQ $A1F0       ; branch if no command
03/A1ED: 20 7E A2     JSR $A27E       ; check if battle command is enabled
03/A1F0: E8           INX 
03/A1F1: E8           INX 
03/A1F2: E8           INX 
03/A1F3: E8           INX 
03/A1F4: 88           DEY 
03/A1F5: D0 EF        BNE $A1E6
03/A1F7: A5 AA        LDA $AA
03/A1F9: F0 0A        BEQ $A205       ; branch if no commands changed
03/A1FB: AD 22 18     LDA $1822
03/A1FE: 85 00        STA $00
03/A200: A9 09        LDA #$09        ; battle graphics $09: draw battle command list
03/A202: 20 85 80     JSR $8085       ; execute battle graphics
03/A205: AE 36 35     LDX $3536
03/A208: 86 AF        STX $AF
03/A20A: 7B           TDC 
03/A20B: AA           TAX 
03/A20C: 86 B1        STX $B1
; start of spell loop
03/A20E: A6 AF        LDX $AF
03/A210: BD 7B 2C     LDA $2C7B,X     ; spell id
03/A213: F0 4B        BEQ $A260
03/A215: BD 7A 2C     LDA $2C7A,X
03/A218: 29 7F        AND #$7F
03/A21A: 05 A9        ORA $A9
03/A21C: 05 AB        ORA $AB
03/A21E: 05 AC        ORA $AC
03/A220: 9D 7A 2C     STA $2C7A,X
03/A223: A5 A9        LDA $A9
03/A225: D0 28        BNE $A24F       ; branch if mute
03/A227: A5 AB        LDA $AB
03/A229: 10 11        BPL $A23C       ; branch if no toad status
03/A22B: BD 7B 2C     LDA $2C7B,X
03/A22E: C9 19        CMP #$19
03/A230: D0 1D        BNE $A24F
03/A232: BD 7A 2C     LDA $2C7A,X
03/A235: 29 7F        AND #$7F
03/A237: 9D 7A 2C     STA $2C7A,X
03/A23A: 80 13        BRA $A24F
03/A23C: A5 AC        LDA $AC
03/A23E: 10 0F        BPL $A24F       ; branch if no pig status
03/A240: BD 7B 2C     LDA $2C7B,X
03/A243: C9 1A        CMP #$1A
03/A245: D0 08        BNE $A24F
03/A247: BD 7A 2C     LDA $2C7A,X
03/A24A: 29 7F        AND #$7F
03/A24C: 9D 7A 2C     STA $2C7A,X
03/A24F: BD 7D 2C     LDA $2C7D,X
03/A252: C5 AD        CMP $AD
03/A254: F0 0A        BEQ $A260
03/A256: 90 08        BCC $A260
03/A258: BD 7A 2C     LDA $2C7A,X
03/A25B: 09 80        ORA #$80
03/A25D: 9D 7A 2C     STA $2C7A,X
03/A260: A6 AF        LDX $AF
03/A262: E8           INX 
03/A263: E8           INX 
03/A264: E8           INX 
03/A265: E8           INX 
03/A266: 86 AF        STX $AF
03/A268: E6 B1        INC $B1
03/A26A: A5 B1        LDA $B1
03/A26C: C9 48        CMP #$48
03/A26E: F0 03        BEQ $A273
03/A270: 4C 0E A2     JMP $A20E
03/A273: AD 22 18     LDA $1822
03/A276: 85 00        STA $00
03/A278: A9 0E        LDA #$0E        ; battle graphics $0E: draw spell list
03/A27A: 20 85 80     JSR $8085       ; execute battle graphics
03/A27D: 60           RTS 

; [ check if battle command is enabled ]

03/A27E: 64 B5        STZ $B5
03/A280: DA           PHX 
03/A281: BD 03 33     LDA $3303,X     ; command id
03/A284: C9 05        CMP #$05
03/A286: F0 0C        BEQ $A294
03/A288: C9 08        CMP #$08
03/A28A: F0 08        BEQ $A294
03/A28C: C9 0C        CMP #$0C
03/A28E: F0 04        BEQ $A294
03/A290: C9 10        CMP #$10
03/A292: D0 07        BNE $A29B
; dark wave, sing, aim, twin
03/A294: 20 D9 A2     JSR $A2D9       ; check command requirements
03/A297: A5 B3        LDA $B3
03/A299: D0 23        BNE $A2BE
03/A29B: FA           PLX 
03/A29C: DA           PHX 
03/A29D: BD 03 33     LDA $3303,X
03/A2A0: 0A           ASL 
03/A2A1: AA           TAX 
03/A2A2: BF 19 FD 13  LDA $13FD19,X   ; status 1 and 2 that disable each command
03/A2A6: 85 B3        STA $B3
03/A2A8: BF 1A FD 13  LDA $13FD1A,X
03/A2AC: 85 B4        STA $B4
03/A2AE: A6 A6        LDX $A6
03/A2B0: BD 03 20     LDA $2003,X
03/A2B3: 25 B3        AND $B3
03/A2B5: D0 07        BNE $A2BE
03/A2B7: BD 04 20     LDA $2004,X
03/A2BA: 25 B4        AND $B4
03/A2BC: F0 04        BEQ $A2C2
03/A2BE: A9 80        LDA #$80
03/A2C0: 85 B5        STA $B5
03/A2C2: FA           PLX 
03/A2C3: BD 02 33     LDA $3302,X     ; set disabled bit
03/A2C6: 48           PHA 
03/A2C7: 29 7F        AND #$7F
03/A2C9: 05 B5        ORA $B5
03/A2CB: 9D 02 33     STA $3302,X
03/A2CE: 68           PLA 
03/A2CF: DD 02 33     CMP $3302,X
03/A2D2: F0 04        BEQ $A2D8
03/A2D4: A9 01        LDA #$01        ; enabled/disabled flag changed
03/A2D6: 85 AA        STA $AA
03/A2D8: 60           RTS 

; [ check command requirements ]

03/A2D9: A6 A6        LDX $A6
03/A2DB: 64 B3        STZ $B3
03/A2DD: C9 08        CMP #$08
03/A2DF: F0 1E        BEQ $A2FF
03/A2E1: C9 0C        CMP #$0C
03/A2E3: F0 36        BEQ $A31B
03/A2E5: C9 10        CMP #$10
03/A2E7: F0 46        BEQ $A32F
; dark wave (must have a weapon equipped)
03/A2E9: BD 33 20     LDA $2033,X
03/A2EC: F0 07        BEQ $A2F5
03/A2EE: C9 61        CMP #$61
03/A2F0: B0 03        BCS $A2F5
03/A2F2: 4C 70 A3     JMP $A370
03/A2F5: BD 35 20     LDA $2035,X
03/A2F8: F0 74        BEQ $A36E
03/A2FA: C9 61        CMP #$61
03/A2FC: B0 70        BCS $A36E
03/A2FE: 60           RTS 
; sing (must have a harp equipped)
03/A2FF: BD 33 20     LDA $2033,X
03/A302: F0 09        BEQ $A30D
03/A304: C9 44        CMP #$44
03/A306: 90 66        BCC $A36E
03/A308: C9 4D        CMP #$4D
03/A30A: B0 62        BCS $A36E
03/A30C: 60           RTS 
03/A30D: BD 35 20     LDA $2035,X
03/A310: F0 5C        BEQ $A36E
03/A312: C9 44        CMP #$44
03/A314: 90 58        BCC $A36E
03/A316: C9 4D        CMP #$4D
03/A318: B0 54        BCS $A36E
03/A31A: 60           RTS 
; aim (must have a bow equipped)
03/A31B: BD 33 20     LDA $2033,X
03/A31E: F0 4E        BEQ $A36E
03/A320: C9 4D        CMP #$4D
03/A322: 90 4A        BCC $A36E
03/A324: C9 61        CMP #$61
03/A326: B0 46        BCS $A36E
03/A328: BD 35 20     LDA $2035,X
03/A32B: F0 41        BEQ $A36E
03/A32D: D0 41        BNE $A370
; twin (other twin must be available)
03/A32F: DA           PHX 
03/A330: AE 36 35     LDX $3536
03/A333: DA           PHX 
03/A334: A6 A6        LDX $A6
03/A336: BD 03 20     LDA $2003,X
03/A339: 29 3C        AND #$3C
03/A33B: D0 2A        BNE $A367
03/A33D: A2 01 00     LDX #$0001
03/A340: A5 D0        LDA $D0
03/A342: CD 39 35     CMP $3539
03/A345: F0 01        BEQ $A348
03/A347: CA           DEX 
03/A348: BD 39 35     LDA $3539,X
03/A34B: 20 89 84     JSR $8489       ; set current character/monster
03/A34E: A6 A6        LDX $A6
03/A350: BD 03 20     LDA $2003,X
03/A353: 29 FC        AND #$FC
03/A355: D0 10        BNE $A367
03/A357: BD 04 20     LDA $2004,X
03/A35A: 29 3C        AND #$3C
03/A35C: D0 09        BNE $A367
03/A35E: BD 05 20     LDA $2005,X
03/A361: 29 40        AND #$40
03/A363: D0 02        BNE $A367
03/A365: C6 B3        DEC $B3
03/A367: FA           PLX 
03/A368: 8E 36 35     STX $3536
03/A36B: FA           PLX 
03/A36C: 86 A6        STX $A6
03/A36E: E6 B3        INC $B3
03/A370: 60           RTS 

; [ action type 0: choose character action ]

03/A371: AD 00 18     LDA $1800
03/A374: C9 B7        CMP #$B7
03/A376: D0 0A        BNE $A382
03/A378: AD 01 18     LDA $1801
03/A37B: F0 05        BEQ $A382       ; branch if not battle $01B7 (zeromus)
03/A37D: AD F7 38     LDA $38F7
03/A380: F0 60        BEQ $A3E2
03/A382: AD F3 38     LDA $38F3
03/A385: D0 0F        BNE $A396
03/A387: AD 82 22     LDA $2282
03/A38A: C9 63        CMP #$63
03/A38C: F0 0B        BEQ $A399
03/A38E: C9 62        CMP #$62
03/A390: F0 07        BEQ $A399
03/A392: C9 61        CMP #$61
03/A394: F0 03        BEQ $A399
03/A396: 9C D6 38     STZ $38D6
03/A399: 7B           TDC 
03/A39A: AA           TAX 
03/A39B: BD 29 39     LDA $3929,X
03/A39E: C5 D2        CMP $D2
03/A3A0: F0 40        BEQ $A3E2
03/A3A2: E8           INX 
03/A3A3: E0 05 00     CPX #$0005
03/A3A6: D0 F3        BNE $A39B
03/A3A8: A5 D0        LDA $D0
03/A3AA: 85 8C        STA $8C
03/A3AC: A5 D2        LDA $D2
03/A3AE: 20 89 84     JSR $8489       ; set current character/monster
03/A3B1: A9 03        LDA #$03
03/A3B3: 20 69 85     JSR $8569       ; get pointer to timer
03/A3B6: AE 98 35     LDX $3598
03/A3B9: BD 06 2A     LDA $2A06,X
03/A3BC: 29 FE        AND #$FE
03/A3BE: 9D 06 2A     STA $2A06,X
03/A3C1: A5 D2        LDA $D2
03/A3C3: 85 D0        STA $D0
03/A3C5: 20 8D A5     JSR $A58D       ; validate selected character
03/A3C8: A5 D0        LDA $D0
03/A3CA: 85 AA        STA $AA
03/A3CC: A5 8C        LDA $8C
03/A3CE: 85 D0        STA $D0
03/A3D0: A5 AA        LDA $AA
03/A3D2: C9 FF        CMP #$FF
03/A3D4: F0 0C        BEQ $A3E2
03/A3D6: AD 2F 39     LDA $392F
03/A3D9: AA           TAX 
03/A3DA: A5 D2        LDA $D2
03/A3DC: 9D 29 39     STA $3929,X
03/A3DF: EE 2F 39     INC $392F
03/A3E2: 60           RTS 

; [ open/close menu ]

03/A3E3: A5 D7        LDA $D7
03/A3E5: F0 52        BEQ $A439       ; branch if menu is not open
; check if menu needs to close
03/A3E7: A5 D0        LDA $D0
03/A3E9: C9 FF        CMP #$FF
03/A3EB: F0 4B        BEQ $A438       ; return if no selected character
03/A3ED: 20 8D A5     JSR $A58D       ; validate selected character
03/A3F0: A5 D0        LDA $D0
03/A3F2: C9 FF        CMP #$FF
03/A3F4: F0 39        BEQ $A42F       ; close menu if character was invalid
03/A3F6: A6 A6        LDX $A6
03/A3F8: BD 00 20     LDA $2000,X
03/A3FB: 29 1F        AND #$1F
03/A3FD: C9 05        CMP #$05
03/A3FF: D0 14        BNE $A415       ; branch if not edward
03/A401: AD 82 35     LDA $3582
03/A404: D0 0F        BNE $A415       ; branch if a boss battle
03/A406: AD DB 38     LDA $38DB       ; number of character targets
03/A409: 3A           DEC 
03/A40A: F0 09        BEQ $A415       ; branch if edward is alone
03/A40C: BD 06 20     LDA $2006,X
03/A40F: 30 04        BMI $A415       ; branch if hiding
03/A411: 29 01        AND #$01
03/A413: D0 1A        BNE $A42F       ; branch if critical
03/A415: 20 A0 A1     JSR $A1A0       ; update enabled commands and spells
03/A418: A5 D0        LDA $D0
03/A41A: 20 7E 84     JSR $847E       ; asl3
03/A41D: AA           TAX 
03/A41E: BD DB 32     LDA $32DB,X     ; left hand item id
03/A421: C9 4C        CMP #$4C
03/A423: F0 07        BEQ $A42C       ; branch if avenger sword
03/A425: BD DF 32     LDA $32DF,X     ; right hand item id
03/A428: C9 4C        CMP #$4C
03/A42A: D0 0C        BNE $A438       ; return if not avenger sword
03/A42C: 20 C8 A4     JSR $A4C8       ; set berserk status
03/A42F: A9 FF        LDA #$FF
03/A431: 85 D0        STA $D0
03/A433: A9 01        LDA #$01        ; battle graphics $01: close menu
03/A435: 20 85 80     JSR $8085       ; execute battle graphics
03/A438: 60           RTS 
; do selected command
03/A439: A5 D0        LDA $D0
03/A43B: C9 FF        CMP #$FF
03/A43D: F0 24        BEQ $A463       ; branch if no selected character
03/A43F: 20 8D A5     JSR $A58D       ; validate selected character
03/A442: A5 D0        LDA $D0
03/A444: C9 FF        CMP #$FF
03/A446: F0 1A        BEQ $A462       ; branch if character was invalid
03/A448: AD 8B 38     LDA $388B
03/A44B: F0 03        BEQ $A450       ; branch if no auto-battle
03/A44D: 20 D9 A4     JSR $A4D9       ; get auto-battle command
03/A450: A2 05 00     LDX #$0005
03/A453: B5 D7        LDA $D7,X
03/A455: 9D 37 39     STA $3937,X     ; copy to character action buffer
03/A458: CA           DEX 
03/A459: 10 F8        BPL $A453
03/A45B: 20 B2 A5     JSR $A5B2       ; validate selected command
03/A45E: A9 FF        LDA #$FF
03/A460: 85 D0        STA $D0         ; deselect character
03/A462: 60           RTS 
; check if menu needs to open
03/A463: AD 2D 35     LDA $352D
03/A466: D0 5F        BNE $A4C7       ; return if holding L and R
03/A468: AD 29 39     LDA $3929
03/A46B: C9 FF        CMP #$FF
03/A46D: F0 58        BEQ $A4C7       ; return if battle menu queue is empty
03/A46F: 48           PHA 
03/A470: 7B           TDC 
03/A471: AA           TAX 
03/A472: BD 2A 39     LDA $392A,X     ; shift battle menu queue
03/A475: 9D 29 39     STA $3929,X
03/A478: E8           INX 
03/A479: E0 05 00     CPX #$0005
03/A47C: D0 F4        BNE $A472
03/A47E: CE 2F 39     DEC $392F       ; decrement battle menu queue size
03/A481: 68           PLA 
03/A482: 8D 22 18     STA $1822       ; set selected character for menu
03/A485: 85 D0        STA $D0
03/A487: 20 1B A8     JSR $A81B       ; validate equipped arrows
03/A48A: 20 8D A5     JSR $A58D       ; validate selected character
03/A48D: A5 D0        LDA $D0
03/A48F: C9 FF        CMP #$FF
03/A491: F0 34        BEQ $A4C7       ; return if character is invalid
03/A493: 20 F7 A0     JSR $A0F7       ; update enabled inventory items
03/A496: 20 A0 A1     JSR $A1A0       ; update enabled commands and spells
03/A499: A6 A6        LDX $A6
03/A49B: BD 05 20     LDA $2005,X     ; clear defend status
03/A49E: 29 EF        AND #$EF
03/A4A0: 9D 05 20     STA $2005,X
03/A4A3: AD 7B 35     LDA $357B
03/A4A6: C5 D0        CMP $D0
03/A4A8: F0 1D        BEQ $A4C7       ; return if this is the other twin
03/A4AA: BD 33 20     LDA $2033,X     ; left hand item
03/A4AD: C9 4C        CMP #$4C
03/A4AF: F0 07        BEQ $A4B8       ; branch if avenger sword
03/A4B1: BD 35 20     LDA $2035,X     ; right hand item
03/A4B4: C9 4C        CMP #$4C
03/A4B6: D0 03        BNE $A4BB       ; branch if not avenger sword
03/A4B8: 4C C8 A4     JMP $A4C8       ; set berserk status
03/A4BB: AD 8B 38     LDA $388B
03/A4BE: F0 03        BEQ $A4C3       ; branch if not auto-battle
03/A4C0: 64 D7        STZ $D7         ; menu is closed
03/A4C2: 60           RTS 
03/A4C3: 7B           TDC             ; battle graphics $00: open menu
03/A4C4: 20 85 80     JSR $8085       ; execute battle graphics
03/A4C7: 60           RTS 

; [ set berserk status (avenger sword) ]

03/A4C8: A6 A6        LDX $A6
03/A4CA: BD 04 20     LDA $2004,X
03/A4CD: 09 04        ORA #$04
03/A4CF: 9D 04 20     STA $2004,X
03/A4D2: A5 D0        LDA $D0
03/A4D4: AA           TAX 
03/A4D5: 9E 60 35     STZ $3560,X
03/A4D8: 60           RTS 

; [ get auto-battle command ]

03/A4D9: AD E8 38     LDA $38E8
03/A4DC: D0 FB        BNE $A4D9
03/A4DE: 64 DB        STZ $DB
03/A4E0: 64 D9        STZ $D9
03/A4E2: A5 D0        LDA $D0
03/A4E4: 8D E9 38     STA $38E9
03/A4E7: 20 89 84     JSR $8489       ; set current character/monster
03/A4EA: A6 A6        LDX $A6
03/A4EC: BD 00 20     LDA $2000,X
03/A4EF: 29 1F        AND #$1F
03/A4F1: C9 15        CMP #$15
03/A4F3: D0 1D        BNE $A512       ; branch if not golbez
03/A4F5: AD A9 38     LDA $38A9       ; golbez' auto-battle script pointer
03/A4F8: 0A           ASL 
03/A4F9: AA           TAX 
03/A4FA: BD 9A 38     LDA $389A,X     ; golbez' auto-battle script
03/A4FD: C9 FF        CMP #$FF
03/A4FF: F0 0C        BEQ $A50D
03/A501: 85 A9        STA $A9
03/A503: BD 9B 38     LDA $389B,X     ; attack id
03/A506: 85 AA        STA $AA
03/A508: EE A9 38     INC $38A9
03/A50B: 80 22        BRA $A52F
03/A50D: 9C A9 38     STZ $38A9
03/A510: 80 E3        BRA $A4F5
03/A512: AD A8 38     LDA $38A8       ; auto-battle script pointer
03/A515: 0A           ASL 
03/A516: AA           TAX 
03/A517: BD 8C 38     LDA $388C,X     ; auto-battle script
03/A51A: C9 FF        CMP #$FF
03/A51C: F0 0C        BEQ $A52A
03/A51E: 85 A9        STA $A9
03/A520: BD 8D 38     LDA $388D,X     ; attack id
03/A523: 85 AA        STA $AA
03/A525: EE A8 38     INC $38A8
03/A528: 80 05        BRA $A52F
03/A52A: 9C A8 38     STZ $38A8
03/A52D: 80 E3        BRA $A512
03/A52F: A5 A9        LDA $A9
03/A531: C9 C0        CMP #$C0
03/A533: 90 31        BCC $A566
; use command
03/A535: 38           SEC 
03/A536: E9 C0        SBC #$C0
03/A538: 85 DC        STA $DC
03/A53A: 8D EA 38     STA $38EA
03/A53D: A5 A9        LDA $A9
03/A53F: C9 CE        CMP #$CE
03/A541: D0 06        BNE $A549       ; branch if not kick
03/A543: A9 FF        LDA #$FF
03/A545: 85 DA        STA $DA         ; target all monsters
03/A547: 80 17        BRA $A560
03/A549: 20 79 85     JSR $8579       ; choose a random monster
03/A54C: 85 A9        STA $A9
03/A54E: 18           CLC 
03/A54F: 69 05        ADC #$05
03/A551: AA           TAX 
03/A552: BD 40 35     LDA $3540,X
03/A555: D0 F2        BNE $A549
03/A557: A5 A9        LDA $A9
03/A559: AA           TAX 
03/A55A: 7B           TDC 
03/A55B: 20 5F 85     JSR $855F       ; set bit
03/A55E: 85 DA        STA $DA
03/A560: A9 80        LDA #$80
03/A562: 85 D8        STA $D8
03/A564: 80 23        BRA $A589
; use magic
03/A566: C9 01        CMP #$01
03/A568: F0 13        BEQ $A57D
03/A56A: A9 02        LDA #$02
03/A56C: 8D EA 38     STA $38EA
03/A56F: A5 AA        LDA $AA
03/A571: 85 DC        STA $DC
03/A573: A9 20        LDA #$20
03/A575: 85 D8        STA $D8
03/A577: A9 FF        LDA #$FF
03/A579: 85 DA        STA $DA
03/A57B: 80 0C        BRA $A589
; use item
03/A57D: A5 AA        LDA $AA
03/A57F: 85 DC        STA $DC
03/A581: A9 40        LDA #$40
03/A583: 85 D8        STA $D8
03/A585: A9 FF        LDA #$FF
03/A587: 85 DA        STA $DA
03/A589: EE E8 38     INC $38E8
03/A58C: 60           RTS 

; [ validate selected character ]

03/A58D: A5 D0        LDA $D0
03/A58F: C9 FF        CMP #$FF
03/A591: F0 1A        BEQ $A5AD
03/A593: 20 89 84     JSR $8489       ; set current character/monster
03/A596: A6 A6        LDX $A6
03/A598: BD 03 20     LDA $2003,X
03/A59B: 29 C0        AND #$C0
03/A59D: D0 0E        BNE $A5AD       ; branch if dead or stone
03/A59F: BD 04 20     LDA $2004,X
03/A5A2: 29 3C        AND #$3C
03/A5A4: D0 07        BNE $A5AD       ; paralyze, sleep, charm, berserk
03/A5A6: BD 05 20     LDA $2005,X
03/A5A9: 29 C6        AND #$C6
03/A5AB: F0 04        BEQ $A5B1       ; magnetized, stopped, twin, jump
03/A5AD: A9 FF        LDA #$FF
03/A5AF: 85 D0        STA $D0
03/A5B1: 60           RTS 

; [ validate selected command ]

03/A5B2: A5 D0        LDA $D0
03/A5B4: 8D 75 39     STA $3975
03/A5B7: 20 89 84     JSR $8489       ; set current character/monster
03/A5BA: AD 2B 35     LDA $352B
03/A5BD: F0 0C        BEQ $A5CB
03/A5BF: 20 FE 9D     JSR $9DFE       ; copy equipped item data to character properties
03/A5C2: 20 CC 8E     JSR $8ECC       ; load equipment properties
03/A5C5: 20 37 98     JSR $9837       ; update character stats
03/A5C8: 9C 2B 35     STZ $352B
03/A5CB: AD 3A 39     LDA $393A
03/A5CE: 0D 3B 39     ORA $393B
03/A5D1: D0 0A        BNE $A5DD       ; branch if there is at least one target
03/A5D3: A5 D0        LDA $D0
03/A5D5: AA           TAX 
03/A5D6: 7B           TDC 
03/A5D7: 20 5F 85     JSR $855F       ; set bit
03/A5DA: 8D 3B 39     STA $393B       ; target self
03/A5DD: A6 A6        LDX $A6
03/A5DF: 9E 52 20     STZ $2052,X     ; clear spell/item being used
03/A5E2: AD 38 39     LDA $3938
03/A5E5: 9D 50 20     STA $2050,X
03/A5E8: 10 44        BPL $A62E       ; branch if using an item or magic
; command
03/A5EA: A2 1C 00     LDX #$001C      ; 28 bytes each
03/A5ED: 86 AB        STX $AB
03/A5EF: A2 02 33     LDX #$3302      ; character battle commands
03/A5F2: 86 AD        STX $AD
03/A5F4: 20 78 A7     JSR $A778       ; get pointer to selected command/magic/item data
03/A5F7: AD 8B 38     LDA $388B
03/A5FA: F0 04        BEQ $A600
03/A5FC: A5 DC        LDA $DC
03/A5FE: 80 05        BRA $A605
03/A600: A0 01 00     LDY #$0001
03/A603: B1 80        LDA ($80),Y     ; $3303 (battle command id)
03/A605: 8D 7B 39     STA $397B
03/A608: 48           PHA 
03/A609: C9 10        CMP #$10
03/A60B: D0 13        BNE $A620
03/A60D: A2 01 00     LDX #$0001
03/A610: A5 D0        LDA $D0
03/A612: CD 39 35     CMP $3539
03/A615: F0 01        BEQ $A618
03/A617: CA           DEX 
03/A618: BD 39 35     LDA $3539,X
03/A61B: 8D 7B 35     STA $357B
03/A61E: 80 07        BRA $A627
03/A620: C9 0A        CMP #$0A
03/A622: D0 03        BNE $A627       ; branch if not salve
03/A624: 20 D6 A7     JSR $A7D6       ; use potion (salve)
03/A627: A9 0C        LDA #$0C        ; battle command delay
03/A629: 85 D6        STA $D6
03/A62B: 68           PLA 
03/A62C: 80 71        BRA $A69F
; item
03/A62E: 29 40        AND #$40
03/A630: F0 6F        BEQ $A6A1       ; branch if not using an item
03/A632: 7B           TDC 
03/A633: AA           TAX 
03/A634: 86 AB        STX $AB
03/A636: A2 1A 32     LDX #$321A      ; inventory
03/A639: 86 AD        STX $AD
03/A63B: 20 78 A7     JSR $A778       ; get pointer to selected command/magic/item data
03/A63E: A6 A6        LDX $A6
03/A640: BD 50 20     LDA $2050,X
03/A643: 29 08        AND #$08
03/A645: F0 1A        BEQ $A661
03/A647: A9 02        LDA #$02
03/A649: 85 D6        STA $D6
03/A64B: A0 01 00     LDY #$0001
03/A64E: B1 80        LDA ($80),Y
03/A650: 9D 52 20     STA $2052,X
03/A653: C8           INY 
03/A654: B1 80        LDA ($80),Y
03/A656: 3A           DEC 
03/A657: 91 80        STA ($80),Y
03/A659: 20 C1 A7     JSR $A7C1       ; redraw inventory item text
03/A65C: A9 16        LDA #$16
03/A65E: 4C F0 A6     JMP $A6F0
03/A661: AD 8B 38     LDA $388B
03/A664: F0 04        BEQ $A66A
03/A666: A5 DC        LDA $DC
03/A668: 80 05        BRA $A66F
03/A66A: A0 01 00     LDY #$0001
03/A66D: B1 80        LDA ($80),Y
03/A66F: C9 B0        CMP #$B0
03/A671: B0 09        BCS $A67C
03/A673: 9D 52 20     STA $2052,X
03/A676: A9 02        LDA #$02
03/A678: 85 D6        STA $D6
03/A67A: 80 21        BRA $A69D
03/A67C: 9D 52 20     STA $2052,X
03/A67F: 8D 7B 39     STA $397B
03/A682: A9 0B        LDA #$0B
03/A684: 85 D6        STA $D6
03/A686: AD 8B 38     LDA $388B
03/A689: D0 12        BNE $A69D
03/A68B: AD 7B 39     LDA $397B
03/A68E: C9 C8        CMP #$C8
03/A690: F0 0B        BEQ $A69D
03/A692: A0 02 00     LDY #$0002
03/A695: B1 80        LDA ($80),Y     ; decrement item quantity
03/A697: 3A           DEC 
03/A698: 91 80        STA ($80),Y
03/A69A: 20 C1 A7     JSR $A7C1       ; redraw inventory item text
03/A69D: A9 01        LDA #$01
03/A69F: 80 4F        BRA $A6F0
; magic
03/A6A1: AD 38 39     LDA $3938
03/A6A4: 29 20        AND #$20
03/A6A6: F0 2B        BEQ $A6D3
03/A6A8: A9 03        LDA #$03
03/A6AA: 85 D6        STA $D6
03/A6AC: A2 20 01     LDX #$0120
03/A6AF: 86 AB        STX $AB
03/A6B1: A2 7A 2C     LDX #$2C7A      ; spell lists
03/A6B4: 86 AD        STX $AD
03/A6B6: 20 78 A7     JSR $A778       ; get pointer to selected command/magic/item data
03/A6B9: A6 A6        LDX $A6
03/A6BB: AD 8B 38     LDA $388B
03/A6BE: F0 04        BEQ $A6C4
03/A6C0: A5 DC        LDA $DC
03/A6C2: 80 05        BRA $A6C9
03/A6C4: A0 01 00     LDY #$0001
03/A6C7: B1 80        LDA ($80),Y
03/A6C9: 8D 7B 39     STA $397B
03/A6CC: 9D 52 20     STA $2052,X
03/A6CF: A9 02        LDA #$02
03/A6D1: 80 1D        BRA $A6F0
; item spellcast
03/A6D3: A9 02        LDA #$02
03/A6D5: 85 D6        STA $D6
03/A6D7: A2 08 00     LDX #$0008      ; monsters only
03/A6DA: 86 AB        STX $AB
03/A6DC: A2 DA 32     LDX #$32DA      ; equipped items
03/A6DF: 86 AD        STX $AD
03/A6E1: 20 78 A7     JSR $A778       ; get pointer to selected command/magic/item data
03/A6E4: A6 A6        LDX $A6
03/A6E6: A0 01 00     LDY #$0001
03/A6E9: B1 80        LDA ($80),Y
03/A6EB: 9D 52 20     STA $2052,X
03/A6EE: A9 01        LDA #$01
03/A6F0: A6 A6        LDX $A6
03/A6F2: 9D 51 20     STA $2051,X
03/A6F5: 20 14 A7     JSR $A714       ; validate selected targets
03/A6F8: AD 3A 39     LDA $393A       ; set targets
03/A6FB: 9D 53 20     STA $2053,X
03/A6FE: AD 3B 39     LDA $393B
03/A701: 9D 54 20     STA $2054,X
03/A704: A5 D0        LDA $D0
03/A706: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/A709: A9 03        LDA #$03        ; action timer
03/A70B: 20 C8 85     JSR $85C8       ; set timer
03/A70E: A9 08        LDA #$08
03/A710: 9D 06 2A     STA $2A06,X     ; do command when timer expires
03/A713: 60           RTS 

; [ validate selected targets ]

03/A714: DA           PHX 
03/A715: AD 3B 39     LDA $393B
03/A718: 0D 3A 39     ORA $393A
03/A71B: 20 0C 85     JSR $850C       ; count bits
03/A71E: CA           DEX 
03/A71F: F0 2A        BEQ $A74B       ; return if there is only one target
03/A721: 7B           TDC 
03/A722: A8           TAY 
03/A723: AD 3B 39     LDA $393B       ; character targets
03/A726: 85 A9        STA $A9
03/A728: 85 AD        STA $AD
03/A72A: A2 05 00     LDX #$0005      ; characters only
03/A72D: 86 AB        STX $AB
03/A72F: 20 4D A7     JSR $A74D       ; clear invalid targets
03/A732: A5 AD        LDA $AD
03/A734: 8D 3B 39     STA $393B
03/A737: AD 3A 39     LDA $393A       ; monster targets
03/A73A: 85 A9        STA $A9
03/A73C: 85 AD        STA $AD
03/A73E: A2 0D 00     LDX #$000D      ; characters and monsters
03/A741: 86 AB        STX $AB
03/A743: 20 4D A7     JSR $A74D       ; clear invalid targets
03/A746: A5 AD        LDA $AD
03/A748: 8D 3A 39     STA $393A
03/A74B: FA           PLX 
03/A74C: 60           RTS 

; [ clear invalid targets ]

;  $A9: targets to check
;  $AA: current target id
;  $AB: number of targets to check
;  $AD: validated targets

03/A74D: 64 AA        STZ $AA
03/A74F: 06 A9        ASL $A9
03/A751: 90 11        BCC $A764       ; branch if not a target
03/A753: B9 03 20     LDA $2003,Y
03/A756: 29 C0        AND #$C0
03/A758: F0 0A        BEQ $A764       ; branch if dead or stone
03/A75A: A5 AA        LDA $AA
03/A75C: AA           TAX 
03/A75D: A5 AD        LDA $AD
03/A75F: 20 5A 85     JSR $855A       ; clear bit
03/A762: 85 AD        STA $AD
03/A764: C2 20        REP #$20
03/A766: 98           TYA 
03/A767: 18           CLC 
03/A768: 69 80 00     ADC #$0080
03/A76B: A8           TAY 
03/A76C: 7B           TDC 
03/A76D: E2 20        SEP #$20
03/A76F: E6 AA        INC $AA
03/A771: A5 AA        LDA $AA
03/A773: C5 AB        CMP $AB
03/A775: D0 D8        BNE $A74F
03/A777: 60           RTS 

; [ get pointer to selected command/magic/item data ]

; +$AB: array item size
; +$AD: pointer to array (ram)

03/A778: A5 D0        LDA $D0         ; character id
03/A77A: AA           TAX 
03/A77B: 8E 3D 39     STX $393D
03/A77E: A6 AB        LDX $AB
03/A780: 8E 3F 39     STX $393F
03/A783: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/A786: AE 41 39     LDX $3941
03/A789: 8E 56 39     STX $3956
03/A78C: A6 AD        LDX $AD
03/A78E: 8E 58 39     STX $3958
03/A791: 20 E3 84     JSR $84E3       ; add (16-bit)
03/A794: AD 39 39     LDA $3939       ; selected slot
03/A797: 85 DF        STA $DF
03/A799: A9 04        LDA #$04        ; 4 bytes each
03/A79B: 85 E1        STA $E1
03/A79D: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/A7A0: A6 E3        LDX $E3
03/A7A2: 8E 56 39     STX $3956
03/A7A5: AE 5A 39     LDX $395A
03/A7A8: 8E 58 39     STX $3958
03/A7AB: 20 E3 84     JSR $84E3       ; add (16-bit)
03/A7AE: A6 A6        LDX $A6
03/A7B0: AD 5A 39     LDA $395A
03/A7B3: 9D 55 20     STA $2055,X
03/A7B6: 85 80        STA $80
03/A7B8: AD 5B 39     LDA $395B
03/A7BB: 9D 56 20     STA $2056,X
03/A7BE: 85 81        STA $81
03/A7C0: 60           RTS 

; [ redraw inventory item text ]

03/A7C1: D0 09        BNE $A7CC
03/A7C3: 88           DEY 
03/A7C4: 7B           TDC 
03/A7C5: 91 80        STA ($80),Y     ; remove item from inventory
03/A7C7: 88           DEY 
03/A7C8: A9 80        LDA #$80
03/A7CA: 91 80        STA ($80),Y
03/A7CC: AD 39 39     LDA $3939
03/A7CF: 85 01        STA $01
03/A7D1: A9 06        LDA #$06        ; battle graphics $06: draw inventory item text
03/A7D3: 4C 85 80     JMP $8085       ; execute battle graphics

; [ use potion (salve) ]

03/A7D6: 7B           TDC 
03/A7D7: AA           TAX 
03/A7D8: A8           TAY 
03/A7D9: BD 1B 32     LDA $321B,X     ; item id
03/A7DC: C9 CE        CMP #$CE
03/A7DE: F0 0B        BEQ $A7EB       ; branch if potion
03/A7E0: C8           INY 
03/A7E1: E8           INX 
03/A7E2: E8           INX 
03/A7E3: E8           INX 
03/A7E4: E8           INX 
03/A7E5: E0 C0 00     CPX #$00C0
03/A7E8: D0 EF        BNE $A7D9
03/A7EA: 60           RTS 
03/A7EB: BD 1C 32     LDA $321C,X
03/A7EE: C9 01        CMP #$01
03/A7F0: 90 28        BCC $A81A       ; return if quantity is zero
03/A7F2: 38           SEC 
03/A7F3: BD 1C 32     LDA $321C,X
03/A7F6: 48           PHA 
03/A7F7: DA           PHX 
03/A7F8: E9 01        SBC #$01
03/A7FA: 9D 1C 32     STA $321C,X
03/A7FD: D0 0E        BNE $A80D
03/A7FF: 9E 1C 32     STZ $321C,X     ; quantity reached zero
03/A802: 9E 1B 32     STZ $321B,X
03/A805: BD 1A 32     LDA $321A,X
03/A808: 09 80        ORA #$80
03/A80A: 9D 1A 32     STA $321A,X
03/A80D: 98           TYA 
03/A80E: 85 01        STA $01
03/A810: A9 06        LDA #$06        ; battle graphics $06: draw inventory item text
03/A812: 20 85 80     JSR $8085       ; execute battle graphics
03/A815: FA           PLX 
03/A816: 68           PLA 
03/A817: 9D 1C 32     STA $321C,X
03/A81A: 60           RTS 

; [ validate equipped arrows ]

; if character ran out of arrows, remove them

03/A81B: AD 22 18     LDA $1822
03/A81E: A8           TAY 
03/A81F: B9 DC 38     LDA $38DC,Y
03/A822: F0 31        BEQ $A855       ; branch if didn't run out of arrows
03/A824: AD 22 18     LDA $1822
03/A827: 8D 75 39     STA $3975
03/A82A: 20 7E 84     JSR $847E       ; asl3
03/A82D: AA           TAX 
03/A82E: B9 DC 38     LDA $38DC,Y
03/A831: 10 04        BPL $A837       ; branch if arrows were not in right hand
03/A833: E8           INX 
03/A834: E8           INX 
03/A835: E8           INX 
03/A836: E8           INX 
03/A837: 7B           TDC 
03/A838: 99 DC 38     STA $38DC,Y     ; clear arrow update flag
03/A83B: 9E DB 32     STZ $32DB,X     ; remove arrows from character
03/A83E: 9E DC 32     STZ $32DC,X
03/A841: A9 80        LDA #$80
03/A843: 9D DA 32     STA $32DA,X     ; equipped item flags
03/A846: AD 75 39     LDA $3975
03/A849: 20 89 84     JSR $8489       ; set current character/monster
03/A84C: 20 FE 9D     JSR $9DFE       ; copy equipped item data to character properties
03/A84F: 20 CC 8E     JSR $8ECC       ; load equipment properties
03/A852: 20 37 98     JSR $9837       ; update character stats
03/A855: 60           RTS 

; [ action type 3: do timer effect ]

03/A856: 20 FD B2     JSR $B2FD       ; init graphics script
03/A859: A5 D2        LDA $D2         ; attacker id
03/A85B: 20 89 84     JSR $8489       ; set current character/monster
03/A85E: A5 D3        LDA $D3         ; timer id
03/A860: 85 AB        STA $AB         ; multiply by 3
03/A862: 0A           ASL 
03/A863: 18           CLC 
03/A864: 65 AB        ADC $AB
03/A866: 20 69 85     JSR $8569       ; get pointer to timer
03/A869: AE 98 35     LDX $3598
03/A86C: 8E 55 35     STX $3555       ; set pointer to expired timer
03/A86F: A5 D3        LDA $D3
03/A871: 0A           ASL 
03/A872: AA           TAX 
03/A873: BF 49 AD 03  LDA $03AD49,X   ; expired timer jump table
03/A877: 85 80        STA $80
03/A879: BF 4A AD 03  LDA $03AD4A,X
03/A87D: 85 81        STA $81
03/A87F: A9 03        LDA #$03
03/A881: 85 82        STA $82
03/A883: DC 80 00     JML [$0080]
03/A886: 60           RTS 

; 0: stop timer
03/A887: A6 A6        LDX $A6
03/A889: BD 05 20     LDA $2005,X     ; clear stop status
03/A88C: 29 BF        AND #$BF
03/A88E: 9D 05 20     STA $2005,X
03/A891: AE 30 35     LDX $3530
03/A894: 9E 06 2A     STZ $2A06,X     ; clear stop timer flags
03/A897: A9 03        LDA #$03
03/A899: 20 69 85     JSR $8569       ; get pointer to timer
03/A89C: AE 98 35     LDX $3598
03/A89F: BD 06 2A     LDA $2A06,X
03/A8A2: 10 0B        BPL $A8AF       ; branch if action timer is not expired
03/A8A4: 9E 06 2A     STZ $2A06,X
03/A8A7: A9 01        LDA #$01
03/A8A9: 9D 04 2A     STA $2A04,X     ; set action timer duration to 1
03/A8AC: 9E 05 2A     STZ $2A05,X
03/A8AF: A5 D2        LDA $D2         ; current character/monster id
03/A8B1: 0A           ASL 
03/A8B2: AA           TAX 
03/A8B3: BD EB 29     LDA $29EB,X     ; disable stop timer
03/A8B6: 29 7F        AND #$7F
03/A8B8: 9D EB 29     STA $29EB,X
03/A8BB: 60           RTS 
; 1: action timer (sleep/paralyze wore off)
03/A8BC: A6 A6        LDX $A6
03/A8BE: BD 04 20     LDA $2004,X     ; clear paralyze and sleep status
03/A8C1: 29 CF        AND #$CF
03/A8C3: 9D 04 20     STA $2004,X
03/A8C6: 64 D6        STZ $D6
03/A8C8: A5 D2        LDA $D2
03/A8CA: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/A8CD: A9 03        LDA #$03        ; action timer
03/A8CF: 20 C8 85     JSR $85C8       ; set timer
03/A8D2: 9E 06 2A     STZ $2A06,X     ; start timer
03/A8D5: 60           RTS 
; 2: sap timer
03/A8D6: A6 A6        LDX $A6
03/A8D8: BD 06 20     LDA $2006,X     ; remove sap status
03/A8DB: 29 BF        AND #$BF
03/A8DD: 9D 06 20     STA $2006,X
03/A8E0: A5 D2        LDA $D2
03/A8E2: 0A           ASL 
03/A8E3: AA           TAX 
03/A8E4: BD EB 29     LDA $29EB,X     ; disable sap timer
03/A8E7: 29 DF        AND #$DF
03/A8E9: 9D EB 29     STA $29EB,X
03/A8EC: 60           RTS 
; 3: poison timer
03/A8ED: A6 A6        LDX $A6
03/A8EF: BD 05 20     LDA $2005,X
03/A8F2: 29 02        AND #$02
03/A8F4: D0 71        BNE $A967       ; return if jumping
03/A8F6: BD 06 20     LDA $2006,X
03/A8F9: 30 6C        BMI $A967       ; return if hiding
03/A8FB: A5 D2        LDA $D2
03/A8FD: 0A           ASL 
03/A8FE: AA           TAX 
03/A8FF: BD 2A 2B     LDA $2B2A,X
03/A902: 85 A9        STA $A9
03/A904: BD 2B 2B     LDA $2B2B,X
03/A907: 85 AA        STA $AA
03/A909: AE 55 35     LDX $3555
03/A90C: A5 A9        LDA $A9
03/A90E: 9D 04 2A     STA $2A04,X
03/A911: A5 AA        LDA $AA
03/A913: 9D 05 2A     STA $2A05,X
03/A916: A9 40        LDA #$40
03/A918: 9D 06 2A     STA $2A06,X
03/A91B: C2 20        REP #$20
03/A91D: A6 A6        LDX $A6
03/A91F: BD 09 20     LDA $2009,X
03/A922: 20 85 84     JSR $8485       ; lsr3
03/A925: 85 A9        STA $A9
03/A927: A5 A9        LDA $A9
03/A929: D0 02        BNE $A92D
03/A92B: E6 A9        INC $A9
03/A92D: 7B           TDC 
03/A92E: E2 20        SEP #$20
03/A930: A5 D2        LDA $D2
03/A932: 0A           ASL 
03/A933: AA           TAX 
03/A934: A5 A9        LDA $A9
03/A936: 9D D4 34     STA $34D4,X
03/A939: A5 AA        LDA $AA
03/A93B: 9D D5 34     STA $34D5,X
03/A93E: 20 6E CA     JSR $CA6E       ; update hp after damage
03/A941: A9 F8        LDA #$F8        ; display text
03/A943: 8D C2 33     STA $33C2
03/A946: A9 03        LDA #$03        ; battle message
03/A948: 8D C3 33     STA $33C3
03/A94B: A9 35        LDA #$35
03/A94D: 8D CA 34     STA $34CA
03/A950: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/A952: 20 85 80     JSR $8085       ; execute battle graphics
03/A955: 20 A0 B1     JSR $B1A0       ; update dead targets
03/A958: A9 11        LDA #$11        ; battle graphics $11: display damage numerals
03/A95A: 20 85 80     JSR $8085       ; execute battle graphics
03/A95D: A9 0C        LDA #$0C        ; battle graphics $0C: draw hp text
03/A95F: 20 85 80     JSR $8085       ; execute battle graphics
03/A962: A9 10        LDA #$10        ; battle graphics $10: 
03/A964: 20 85 80     JSR $8085       ; execute battle graphics
03/A967: 60           RTS 
; 4: petrify timer
03/A968: A6 A6        LDX $A6
03/A96A: BD 05 20     LDA $2005,X
03/A96D: 29 02        AND #$02
03/A96F: D0 56        BNE $A9C7
03/A971: BD 06 20     LDA $2006,X
03/A974: 30 51        BMI $A9C7
03/A976: BD 04 20     LDA $2004,X
03/A979: 29 03        AND #$03
03/A97B: 1A           INC 
03/A97C: 85 A9        STA $A9
03/A97E: C9 04        CMP #$04
03/A980: D0 1D        BNE $A99F
03/A982: BD 04 20     LDA $2004,X
03/A985: 29 FC        AND #$FC
03/A987: 9D 04 20     STA $2004,X
03/A98A: BD 03 20     LDA $2003,X
03/A98D: 09 40        ORA #$40
03/A98F: 9D 03 20     STA $2003,X
03/A992: A5 D2        LDA $D2
03/A994: 0A           ASL 
03/A995: AA           TAX 
03/A996: AD EB 29     LDA $29EB       ; disable petrify timer
03/A999: 29 F7        AND #$F7
03/A99B: 8D EB 29     STA $29EB
03/A99E: 60           RTS 
03/A99F: BD 04 20     LDA $2004,X
03/A9A2: 05 A9        ORA $A9
03/A9A4: 9D 04 20     STA $2004,X
03/A9A7: A5 D2        LDA $D2
03/A9A9: 0A           ASL 
03/A9AA: AA           TAX 
03/A9AB: BD 44 2B     LDA $2B44,X
03/A9AE: 85 A9        STA $A9
03/A9B0: BD 45 2B     LDA $2B45,X
03/A9B3: 85 AA        STA $AA
03/A9B5: AE 55 35     LDX $3555
03/A9B8: A5 A9        LDA $A9
03/A9BA: 9D 04 2A     STA $2A04,X
03/A9BD: A5 AA        LDA $AA
03/A9BF: 9D 05 2A     STA $2A05,X
03/A9C2: A9 40        LDA #$40
03/A9C4: 9D 06 2A     STA $2A06,X
03/A9C7: 60           RTS 
; 5: reflect timer
03/A9C8: A6 A6        LDX $A6
03/A9CA: BD 06 20     LDA $2006,X
03/A9CD: 29 DF        AND #$DF
03/A9CF: 9D 06 20     STA $2006,X
03/A9D2: A5 D2        LDA $D2
03/A9D4: 0A           ASL 
03/A9D5: AA           TAX 
03/A9D6: BD EB 29     LDA $29EB,X     ; disable reflect timer
03/A9D9: 29 FB        AND #$FB
03/A9DB: 9D EB 29     STA $29EB,X
03/A9DE: 60           RTS 
; 6: doom timer
03/A9DF: A6 A6        LDX $A6
03/A9E1: BD 05 20     LDA $2005,X
03/A9E4: 29 02        AND #$02
03/A9E6: D0 16        BNE $A9FE
03/A9E8: BD 06 20     LDA $2006,X
03/A9EB: 30 11        BMI $A9FE
03/A9ED: A6 A6        LDX $A6
03/A9EF: BD 03 20     LDA $2003,X
03/A9F2: 09 80        ORA #$80
03/A9F4: 9D 03 20     STA $2003,X
03/A9F7: A5 D2        LDA $D2
03/A9F9: 0A           ASL 
03/A9FA: AA           TAX 
03/A9FB: 9E EB 29     STZ $29EB,X     ; disable all timers
03/A9FE: 60           RTS 

; [ do sap and regen ]

03/A9FF: EE 57 35     INC $3557
03/AA02: AD 57 35     LDA $3557
03/AA05: C9 01        CMP #$01
03/AA07: D0 7C        BNE $AA85
03/AA09: 9C 57 35     STZ $3557
03/AA0C: 20 FD B2     JSR $B2FD       ; init graphics script
03/AA0F: A9 00        LDA #$00
03/AA11: 85 8A        STA $8A
; start of character/monster loop
03/AA13: A5 8A        LDA $8A
03/AA15: AA           TAX 
03/AA16: BD 40 35     LDA $3540,X
03/AA19: D0 31        BNE $AA4C       ; branch if not present
03/AA1B: A5 8A        LDA $8A
03/AA1D: 0A           ASL 
03/AA1E: AA           TAX 
03/AA1F: BD EB 29     LDA $29EB,X
03/AA22: 29 20        AND #$20
03/AA24: F0 26        BEQ $AA4C       ; branch if sap timer is disabled
03/AA26: A5 8A        LDA $8A
03/AA28: 20 89 84     JSR $8489       ; set current character/monster
03/AA2B: A6 A6        LDX $A6
03/AA2D: BD 03 20     LDA $2003,X
03/AA30: 29 C0        AND #$C0
03/AA32: D0 18        BNE $AA4C       ; branch if dead or stone
03/AA34: BD 05 20     LDA $2005,X
03/AA37: 29 42        AND #$42
03/AA39: D0 11        BNE $AA4C       ; branch if stopped or jumping
03/AA3B: BD 06 20     LDA $2006,X
03/AA3E: 30 0C        BMI $AA4C       ; branch if hiding
03/AA40: A5 8A        LDA $8A
03/AA42: 0A           ASL 
03/AA43: AA           TAX 
03/AA44: A9 02        LDA #$02
03/AA46: 9D D4 34     STA $34D4,X     ; 2 damage
03/AA49: 9E D5 34     STZ $34D5,X
03/AA4C: E6 8A        INC $8A         ; next character/monster
03/AA4E: A5 8A        LDA $8A
03/AA50: C9 0D        CMP #$0D
03/AA52: D0 BF        BNE $AA13
03/AA54: 9C 07 39     STZ $3907
03/AA57: 20 6E CA     JSR $CA6E       ; update hp after damage
03/AA5A: A9 FF        LDA #$FF
03/AA5C: 8D C2 33     STA $33C2
03/AA5F: AD 07 39     LDA $3907
03/AA62: F0 21        BEQ $AA85       ; branch if character/monster didn't die
03/AA64: A9 F8        LDA #$F8        ; display text
03/AA66: 8D C2 33     STA $33C2
03/AA69: A9 03        LDA #$03        ; battle message
03/AA6B: 8D C3 33     STA $33C3
03/AA6E: A9 38        LDA #$38        ;  (hp ran out)
03/AA70: 8D CA 34     STA $34CA
03/AA73: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/AA75: 20 85 80     JSR $8085       ; execute battle graphics
03/AA78: 20 A0 B1     JSR $B1A0       ; update dead targets
03/AA7B: A9 10        LDA #$10        ; battle graphics $10: 
03/AA7D: 20 85 80     JSR $8085       ; execute battle graphics
03/AA80: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/AA82: 20 85 80     JSR $8085       ; execute battle graphics
03/AA85: 20 FD B2     JSR $B2FD       ; init graphics script
03/AA88: 22 B4 FF 13  JSL $13FFB4     ; disable regen based on fusoya's status
03/AA8C: AD 7C 35     LDA $357C
03/AA8F: C9 FF        CMP #$FF
03/AA91: F0 45        BEQ $AAD8       ; branch if regen is disabled
03/AA93: EE 7C 35     INC $357C       ; increment regen counter
03/AA96: C9 05        CMP #$05
03/AA98: D0 3E        BNE $AAD8       ; do hp gain every 5 turns
03/AA9A: 9C 7C 35     STZ $357C
03/AA9D: 20 FD B2     JSR $B2FD       ; init graphics script
03/AAA0: 7B           TDC 
03/AAA1: AA           TAX 
03/AAA2: 9B           TXY 
03/AAA3: AD 40 35     LDA $3540
03/AAA6: D0 19        BNE $AAC1
03/AAA8: BD 03 20     LDA $2003,X
03/AAAB: 29 C0        AND #$C0
03/AAAD: D0 12        BNE $AAC1
03/AAAF: DA           PHX 
03/AAB0: 5A           PHY 
03/AAB1: 98           TYA 
03/AAB2: 0A           ASL 
03/AAB3: AA           TAX 
03/AAB4: AD 7D 35     LDA $357D       ; regen hp amount
03/AAB7: 9D D4 34     STA $34D4,X
03/AABA: A9 80        LDA #$80
03/AABC: 9D D5 34     STA $34D5,X
03/AABF: 7A           PLY 
03/AAC0: FA           PLX 
03/AAC1: C2 20        REP #$20
03/AAC3: 8A           TXA 
03/AAC4: 18           CLC 
03/AAC5: 69 80 00     ADC #$0080
03/AAC8: AA           TAX 
03/AAC9: 7B           TDC 
03/AACA: E2 20        SEP #$20
03/AACC: C8           INY 
03/AACD: C0 05 00     CPY #$0005
03/AAD0: D0 D1        BNE $AAA3
03/AAD2: 20 6E CA     JSR $CA6E       ; update hp after damage
03/AAD5: 20 A0 B1     JSR $B1A0       ; update dead targets
03/AAD8: A9 11        LDA #$11        ; battle graphics $11: display damage numerals
03/AADA: 20 85 80     JSR $8085       ; execute battle graphics
03/AADD: A9 0C        LDA #$0C        ; battle graphics $0C: draw hp text
03/AADF: 4C 85 80     JMP $8085       ; execute battle graphics

; [ do forced character actions ]

03/AAE2: 7B           TDC 
03/AAE3: AA           TAX 
03/AAE4: 86 8E        STX $8E
; start of character loop
03/AAE6: A6 8E        LDX $8E
03/AAE8: BD 40 35     LDA $3540,X
03/AAEB: D0 05        BNE $AAF2       ; branch if not present
03/AAED: BD 60 35     LDA $3560,X
03/AAF0: F0 03        BEQ $AAF5
03/AAF2: 4C 91 AB     JMP $AB91
03/AAF5: 8A           TXA 
03/AAF6: 20 89 84     JSR $8489       ; set current character/monster
03/AAF9: A6 A6        LDX $A6
03/AAFB: BD 03 20     LDA $2003,X
03/AAFE: 29 C0        AND #$C0
03/AB00: D0 05        BNE $AB07       ; branch if dead or stone
03/AB02: BD 04 20     LDA $2004,X
03/AB05: 29 30        AND #$30
03/AB07: D0 07        BNE $AB10       ; branch if paralyzed or asleep
03/AB09: BD 05 20     LDA $2005,X
03/AB0C: 29 40        AND #$40
03/AB0E: F0 03        BEQ $AB13       ; branch if not stopped
03/AB10: 4C 91 AB     JMP $AB91
03/AB13: BD 04 20     LDA $2004,X
03/AB16: 29 0C        AND #$0C
03/AB18: F0 20        BEQ $AB3A       ; branch if not charmed or berserk
03/AB1A: BD 05 20     LDA $2005,X     ; clear twin status
03/AB1D: 29 FB        AND #$FB
03/AB1F: 9D 05 20     STA $2005,X
03/AB22: BD 04 20     LDA $2004,X
03/AB25: 29 04        AND #$04
03/AB27: F0 05        BEQ $AB2E       ; branch if not berserk
03/AB29: 20 8C AC     JSR $AC8C       ; choose berserk attack
03/AB2C: 80 4D        BRA $AB7B
03/AB2E: BD 04 20     LDA $2004,X
03/AB31: 29 08        AND #$08
03/AB33: F0 05        BEQ $AB3A       ; branch if not charmed
03/AB35: 20 9D AB     JSR $AB9D       ; choose charmed attack
03/AB38: 80 41        BRA $AB7B
03/AB3A: BD 06 20     LDA $2006,X
03/AB3D: 29 01        AND #$01
03/AB3F: F0 50        BEQ $AB91       ; branch if not critical
03/AB41: BD 00 20     LDA $2000,X
03/AB44: 29 1F        AND #$1F
03/AB46: C9 05        CMP #$05
03/AB48: D0 47        BNE $AB91       ; branch if not edward
03/AB4A: AD 82 35     LDA $3582
03/AB4D: D0 42        BNE $AB91       ; branch if a boss battle
03/AB4F: A9 03        LDA #$03
03/AB51: 20 69 85     JSR $8569       ; get pointer to timer
03/AB54: AE 98 35     LDX $3598
03/AB57: BD 06 2A     LDA $2A06,X
03/AB5A: 29 08        AND #$08
03/AB5C: D0 33        BNE $AB91       ; branch if command is already pending
03/AB5E: A6 A6        LDX $A6
03/AB60: BD 06 20     LDA $2006,X
03/AB63: 10 0B        BPL $AB70       ; branch if not hiding
03/AB65: 20 23 AD     JSR $AD23       ; count character targets
03/AB68: 3A           DEC 
03/AB69: D0 26        BNE $AB91       ; branch if not alone
03/AB6B: 20 02 AD     JSR $AD02       ; force edward to appear
03/AB6E: 80 12        BRA $AB82
03/AB70: 20 23 AD     JSR $AD23       ; count character targets
03/AB73: 3A           DEC 
03/AB74: F0 1B        BEQ $AB91       ; branch if alone
03/AB76: 20 F9 AC     JSR $ACF9       ; force edward to hide
03/AB79: 80 07        BRA $AB82
03/AB7B: 64 D6        STZ $D6
03/AB7D: A5 8E        LDA $8E
03/AB7F: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/AB82: A9 03        LDA #$03        ; action timer
03/AB84: 20 C8 85     JSR $85C8       ; set timer
03/AB87: A9 08        LDA #$08
03/AB89: 9D 06 2A     STA $2A06,X     ; do command when timer expires
03/AB8C: A6 8E        LDX $8E
03/AB8E: FE 60 35     INC $3560,X
03/AB91: E6 8E        INC $8E         ; next character
03/AB93: A5 8E        LDA $8E
03/AB95: C9 05        CMP #$05
03/AB97: F0 03        BEQ $AB9C
03/AB99: 4C E6 AA     JMP $AAE6
03/AB9C: 60           RTS 

; [ choose charmed attack ]

03/AB9D: A6 A6        LDX $A6
03/AB9F: 9E 53 20     STZ $2053,X
03/ABA2: 9E 54 20     STZ $2054,X
03/ABA5: 20 8B 85     JSR $858B       ; random (0..98)
03/ABA8: C9 46        CMP #$46
03/ABAA: B0 24        BCS $ABD0       ; 70% chance
; 30% chance to use a random spell
03/ABAC: AE 34 35     LDX $3534       ; pointer to battle commands
03/ABAF: A0 05 00     LDY #$0005
03/ABB2: BD 03 33     LDA $3303,X
03/ABB5: C9 02        CMP #$02
03/ABB7: F0 0D        BEQ $ABC6       ; branch if white magic
03/ABB9: C9 03        CMP #$03
03/ABBB: F0 09        BEQ $ABC6       ; branch if black magic
03/ABBD: E8           INX 
03/ABBE: E8           INX 
03/ABBF: E8           INX 
03/ABC0: E8           INX 
03/ABC1: 88           DEY 
03/ABC2: D0 EE        BNE $ABB2
03/ABC4: 80 0A        BRA $ABD0
03/ABC6: 64 90        STZ $90
03/ABC8: 20 ED AB     JSR $ABED       ; choose charmed spell
03/ABCB: A5 90        LDA $90
03/ABCD: D0 01        BNE $ABD0
03/ABCF: 60           RTS 
; 70% chance to attack a random character
03/ABD0: A6 A6        LDX $A6
03/ABD2: A9 80        LDA #$80
03/ABD4: 9D 50 20     STA $2050,X
03/ABD7: 9E 51 20     STZ $2051,X     ; use fight command
03/ABDA: 20 82 85     JSR $8582       ; choose a random character
03/ABDD: AA           TAX 
03/ABDE: BD 40 35     LDA $3540,X
03/ABE1: D0 F7        BNE $ABDA       ; branch if not present
03/ABE3: 7B           TDC 
03/ABE4: 20 5F 85     JSR $855F       ; set bit
03/ABE7: A6 A6        LDX $A6
03/ABE9: 9D 54 20     STA $2054,X
03/ABEC: 60           RTS 

; [ choose charmed spell ]

03/ABED: AE 36 35     LDX $3536       ; pointer to spell list
03/ABF0: 86 A9        STX $A9
03/ABF2: A0 30 00     LDY #$0030
03/ABF5: BD 7A 2C     LDA $2C7A,X
03/ABF8: 10 0C        BPL $AC06       ; branch if at least one spell is enabled
03/ABFA: E8           INX 
03/ABFB: E8           INX 
03/ABFC: E8           INX 
03/ABFD: E8           INX 
03/ABFE: 88           DEY 
03/ABFF: D0 F4        BNE $ABF5
03/AC01: E6 90        INC $90
03/AC03: 4C 8B AC     JMP $AC8B
03/AC06: 7B           TDC 
03/AC07: AA           TAX 
03/AC08: A9 2F        LDA #$2F
03/AC0A: 20 79 83     JSR $8379       ; random (X..A)
03/AC0D: AA           TAX 
03/AC0E: 8E 3D 39     STX $393D       ; multiply by 4
03/AC11: A2 04 00     LDX #$0004
03/AC14: 8E 3F 39     STX $393F
03/AC17: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/AC1A: 18           CLC 
03/AC1B: A5 A9        LDA $A9
03/AC1D: 6D 41 39     ADC $3941
03/AC20: 85 AB        STA $AB
03/AC22: A5 AA        LDA $AA
03/AC24: 6D 42 39     ADC $3942
03/AC27: 85 AC        STA $AC
03/AC29: A6 AB        LDX $AB
03/AC2B: BD 7A 2C     LDA $2C7A,X
03/AC2E: 85 AD        STA $AD
03/AC30: 30 D4        BMI $AC06       ; branch if spell is disabled
03/AC32: BD 7B 2C     LDA $2C7B,X     ; spell id
03/AC35: A6 A6        LDX $A6
03/AC37: 9D 52 20     STA $2052,X
03/AC3A: A9 20        LDA #$20
03/AC3C: 9D 50 20     STA $2050,X
03/AC3F: A9 02        LDA #$02        ; battle command
03/AC41: 9D 51 20     STA $2051,X
03/AC44: A5 AD        LDA $AD
03/AC46: 29 40        AND #$40
03/AC48: D0 25        BNE $AC6F       ; branch if targets enemy by default
03/AC4A: A5 AD        LDA $AD
03/AC4C: 29 10        AND #$10
03/AC4E: F0 17        BEQ $AC67       ; branch if target all by default
03/AC50: 20 79 85     JSR $8579       ; choose a random monster
03/AC53: 85 AB        STA $AB
03/AC55: 18           CLC 
03/AC56: 69 05        ADC #$05
03/AC58: AA           TAX 
03/AC59: BD 40 35     LDA $3540,X
03/AC5C: D0 F2        BNE $AC50       ; branch if target is not present
03/AC5E: A5 AB        LDA $AB
03/AC60: AA           TAX 
03/AC61: 7B           TDC 
03/AC62: 20 5F 85     JSR $855F       ; set bit
03/AC65: 80 02        BRA $AC69
03/AC67: A9 FF        LDA #$FF
03/AC69: A6 A6        LDX $A6
03/AC6B: 9D 53 20     STA $2053,X     ; set targetted monsters
03/AC6E: 60           RTS 
03/AC6F: A5 AD        LDA $AD
03/AC71: 29 10        AND #$10
03/AC73: F0 0F        BEQ $AC84       ; branch if target all by default
03/AC75: 20 82 85     JSR $8582       ; choose a random character
03/AC78: AA           TAX 
03/AC79: BD 40 35     LDA $3540,X     ; branch if target is not present
03/AC7C: D0 F7        BNE $AC75
03/AC7E: 7B           TDC 
03/AC7F: 20 5F 85     JSR $855F       ; set bit
03/AC82: 80 02        BRA $AC86
03/AC84: A9 F8        LDA #$F8
03/AC86: A6 A6        LDX $A6
03/AC88: 9D 54 20     STA $2054,X
03/AC8B: 60           RTS 

; [ choose berserk attack ]

03/AC8C: A6 A6        LDX $A6
03/AC8E: A9 80        LDA #$80
03/AC90: 9D 50 20     STA $2050,X
03/AC93: 9E 51 20     STZ $2051,X
03/AC96: 9E 54 20     STZ $2054,X
03/AC99: 9E 53 20     STZ $2053,X
03/AC9C: BD 04 20     LDA $2004,X
03/AC9F: 29 08        AND #$08
03/ACA1: F0 3B        BEQ $ACDE
03/ACA3: A2 00 00     LDX #$0000
03/ACA6: A9 04        LDA #$04
03/ACA8: 20 79 83     JSR $8379       ; random (X..A)
03/ACAB: 85 A9        STA $A9
03/ACAD: 85 DF        STA $DF
03/ACAF: AA           TAX 
03/ACB0: BD 40 35     LDA $3540,X
03/ACB3: D0 EE        BNE $ACA3
03/ACB5: A9 80        LDA #$80
03/ACB7: 85 AB        STA $AB
03/ACB9: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/ACBC: A6 E3        LDX $E3
03/ACBE: BD 03 20     LDA $2003,X
03/ACC1: 29 C0        AND #$C0
03/ACC3: D0 DE        BNE $ACA3
03/ACC5: BD 05 20     LDA $2005,X
03/ACC8: 29 82        AND #$82
03/ACCA: D0 D7        BNE $ACA3
03/ACCC: BD 06 20     LDA $2006,X
03/ACCF: 30 D2        BMI $ACA3
03/ACD1: A5 A9        LDA $A9
03/ACD3: AA           TAX 
03/ACD4: 7B           TDC 
03/ACD5: 20 5F 85     JSR $855F       ; set bit
03/ACD8: A6 A6        LDX $A6
03/ACDA: 9D 54 20     STA $2054,X
03/ACDD: 60           RTS 
03/ACDE: 20 79 85     JSR $8579       ; choose a random monster
03/ACE1: 85 A9        STA $A9
03/ACE3: 18           CLC 
03/ACE4: 69 05        ADC #$05
03/ACE6: AA           TAX 
03/ACE7: BD 40 35     LDA $3540,X
03/ACEA: D0 F2        BNE $ACDE
03/ACEC: A5 A9        LDA $A9
03/ACEE: AA           TAX 
03/ACEF: 7B           TDC 
03/ACF0: 20 5F 85     JSR $855F       ; set bit
03/ACF3: A6 A6        LDX $A6
03/ACF5: 9D 53 20     STA $2053,X
03/ACF8: 60           RTS 

; [ force edward to hide/appear ]

; hide
03/ACF9: A6 A6        LDX $A6
03/ACFB: A9 09        LDA #$09        ; use hide command
03/ACFD: 9D 51 20     STA $2051,X
03/AD00: 80 07        BRA $AD09
; appear
03/AD02: A6 A6        LDX $A6
03/AD04: A9 1C        LDA #$1C        ; use appear command
03/AD06: 9D 51 20     STA $2051,X
03/AD09: A9 80        LDA #$80
03/AD0B: 9D 50 20     STA $2050,X
03/AD0E: 9E 53 20     STZ $2053,X     ; no monster targets
03/AD11: A5 8E        LDA $8E
03/AD13: AA           TAX 
03/AD14: 7B           TDC 
03/AD15: 20 5F 85     JSR $855F       ; set bit
03/AD18: A6 A6        LDX $A6
03/AD1A: 9D 54 20     STA $2054,X     ; character target
03/AD1D: A2 01 00     LDX #$0001
03/AD20: 86 D4        STX $D4         ; timer duration: 1
03/AD22: 60           RTS 

; [ count character targets ]

03/AD23: DA           PHX 
03/AD24: 5A           PHY 
03/AD25: 7B           TDC 
03/AD26: AA           TAX 
03/AD27: 9B           TXY 
03/AD28: 86 A9        STX $A9
03/AD2A: B9 40 35     LDA $3540,Y
03/AD2D: D0 09        BNE $AD38       ; branch if not present
03/AD2F: BD 03 20     LDA $2003,X
03/AD32: 29 C0        AND #$C0
03/AD34: D0 02        BNE $AD38       ; branch if dead or stone
03/AD36: E6 A9        INC $A9         ; increment number of character targets
03/AD38: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/AD3B: C8           INY 
03/AD3C: C0 05 00     CPY #$0005
03/AD3F: D0 E9        BNE $AD2A
03/AD41: 7A           PLY 
03/AD42: FA           PLX 
03/AD43: A5 A9        LDA $A9
03/AD45: 8D DB 38     STA $38DB       ; number of character targets
03/AD48: 60           RTS 

; expired timer jump table
03/AD49: A887 A8BC A8D6 A8ED A968 A9C8 A9DF

; --------------------------------------------------------------------------

; [ action type 2: do attack ]

03/AD57: A9 14        LDA #$14        ; battle graphics $14: update monster rows
03/AD59: 20 85 80     JSR $8085       ; execute battle graphics
03/AD5C: A2 80 02     LDX #$0280
03/AD5F: 7B           TDC 
03/AD60: A8           TAY 
03/AD61: BD 01 20     LDA $2001,X
03/AD64: 29 7F        AND #$7F
03/AD66: 19 EB 35     ORA $35EB,Y     ; set monster rows
03/AD69: 9D 01 20     STA $2001,X
03/AD6C: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/AD6F: C8           INY 
03/AD70: C0 08 00     CPY #$0008
03/AD73: D0 EC        BNE $AD61
03/AD75: 9C 0A 39     STZ $390A
03/AD78: 9C E7 38     STZ $38E7
03/AD7B: 9C 07 39     STZ $3907
03/AD7E: 9C 5B 35     STZ $355B
03/AD81: 9C 5C 35     STZ $355C
03/AD84: 9C 53 35     STZ $3553
03/AD87: 9C 5D 35     STZ $355D
03/AD8A: 9C 2A 35     STZ $352A
03/AD8D: 9C 84 35     STZ $3584
03/AD90: 9C E2 38     STZ $38E2
03/AD93: 9C EB 38     STZ $38EB
03/AD96: 9C ED 38     STZ $38ED
03/AD99: A9 04        LDA #$04
03/AD9B: 8D 78 2C     STA $2C78       ; seems to be unused
03/AD9E: 9C 79 2C     STZ $2C79
03/ADA1: A5 D2        LDA $D2
03/ADA3: 20 89 84     JSR $8489       ; set current character/monster
03/ADA6: 20 FD B2     JSR $B2FD       ; init graphics script
03/ADA9: A5 D2        LDA $D2
03/ADAB: C9 05        CMP #$05
03/ADAD: 90 26        BCC $ADD5       ; branch if attacker is a character
03/ADAF: 38           SEC 
03/ADB0: A5 D2        LDA $D2
03/ADB2: E9 05        SBC #$05
03/ADB4: 85 DF        STA $DF
03/ADB6: A9 3C        LDA #$3C        ; monster id * 60
03/ADB8: 85 E1        STA $E1
03/ADBA: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/ADBD: 7B           TDC 
03/ADBE: A8           TAY 
03/ADBF: A6 E3        LDX $E3
03/ADC1: BD 59 36     LDA $3659,X     ; copy graphics script from buffer
03/ADC4: 99 C2 33     STA $33C2,Y
03/ADC7: E8           INX 
03/ADC8: C8           INY 
03/ADC9: C0 3C 00     CPY #$003C
03/ADCC: D0 F3        BNE $ADC1
03/ADCE: A5 D2        LDA $D2
03/ADD0: 38           SEC 
03/ADD1: E9 05        SBC #$05
03/ADD3: 09 80        ORA #$80
03/ADD5: 85 CD        STA $CD         ; set attacker id
03/ADD7: 48           PHA 
03/ADD8: 48           PHA 
03/ADD9: 29 7F        AND #$7F
03/ADDB: 8D C3 34     STA $34C3
03/ADDE: 68           PLA 
03/ADDF: 29 80        AND #$80
03/ADE1: 8D C2 34     STA $34C2
03/ADE4: 68           PLA 
03/ADE5: 20 63 B1     JSR $B163       ; get pointer to character/monster properties
03/ADE8: A0 7F 00     LDY #$007F
03/ADEB: B1 80        LDA ($80),Y
03/ADED: 99 80 26     STA $2680,Y     ; copy attacker properties to buffer
03/ADF0: 88           DEY 
03/ADF1: 10 F8        BPL $ADEB
03/ADF3: 7B           TDC 
03/ADF4: AA           TAX 
03/ADF5: BD 40 35     LDA $3540,X     ; copy "target not present" flags to buffer
03/ADF8: 9D 9C 28     STA $289C,X
03/ADFB: E8           INX 
03/ADFC: E0 0D 00     CPX #$000D
03/ADFF: D0 F4        BNE $ADF5
03/AE01: A6 A6        LDX $A6
03/AE03: BD 53 20     LDA $2053,X     ; get all targets
03/AE06: 1D 54 20     ORA $2054,X
03/AE09: 85 8A        STA $8A
03/AE0B: D0 25        BNE $AE32       ; branch if there are any targets
03/AE0D: A9 21        LDA #$21
03/AE0F: 9D 51 20     STA $2051,X     ; do nothing
03/AE12: A5 CD        LDA $CD
03/AE14: 85 CE        STA $CE         ; self-target
03/AE16: 10 4B        BPL $AE63       ; branch if a character
03/AE18: 20 48 B3     JSR $B348
03/AE1B: A5 A9        LDA $A9
03/AE1D: D0 0F        BNE $AE2E
03/AE1F: A6 A6        LDX $A6
03/AE21: A9 E1        LDA #$E1
03/AE23: 9D 51 20     STA $2051,X
03/AE26: 8D C2 33     STA $33C2
03/AE29: A9 FF        LDA #$FF
03/AE2B: 8D C3 33     STA $33C3
03/AE2E: A5 CD        LDA $CD
03/AE30: 80 31        BRA $AE63
03/AE32: A2 00 00     LDX #$0000
03/AE35: 0A           ASL 
03/AE36: B0 03        BCS $AE3B       ; branch if target found
03/AE38: E8           INX 
03/AE39: D0 FA        BNE $AE35
03/AE3B: 8A           TXA 
03/AE3C: 85 CE        STA $CE         ; set target id
03/AE3E: A6 A6        LDX $A6
03/AE40: BD 53 20     LDA $2053,X
03/AE43: F0 13        BEQ $AE58       ; branch if targeting characters
; monster targets
03/AE45: A9 80        LDA #$80
03/AE47: 8D C4 34     STA $34C4
03/AE4A: BD 53 20     LDA $2053,X
03/AE4D: 20 8E B1     JSR $B18E       ; set targets
03/AE50: A5 CE        LDA $CE
03/AE52: 09 80        ORA #$80
03/AE54: 85 CE        STA $CE
03/AE56: 80 0B        BRA $AE63
; character targets
03/AE58: 9C C4 34     STZ $34C4
03/AE5B: BD 54 20     LDA $2054,X
03/AE5E: 20 8E B1     JSR $B18E       ; set targets
03/AE61: A5 CE        LDA $CE
03/AE63: 20 63 B1     JSR $B163       ; get pointer to character/monster properties
03/AE66: A0 7F 00     LDY #$007F
03/AE69: B1 80        LDA ($80),Y
03/AE6B: 99 00 27     STA $2700,Y     ; copy target properties to buffer
03/AE6E: 88           DEY 
03/AE6F: 10 F8        BPL $AE69
03/AE71: AD D2 26     LDA $26D2
03/AE74: C9 BA        CMP #$BA
03/AE76: D0 06        BNE $AE7E
03/AE78: EE E7 38     INC $38E7
03/AE7B: 4C 6F AF     JMP $AF6F
03/AE7E: A5 8A        LDA $8A
03/AE80: 20 0C 85     JSR $850C       ; count bits
03/AE83: CA           DEX 
03/AE84: F0 03        BEQ $AE89       ; branch if single target
03/AE86: 4C EB AF     JMP $AFEB
03/AE89: A5 CD        LDA $CD
03/AE8B: 30 0F        BMI $AE9C       ; branch if monster attacker
; character attacker
03/AE8D: AD D1 26     LDA $26D1       ; battle command id
03/AE90: 85 A9        STA $A9
03/AE92: A5 CE        LDA $CE
03/AE94: 30 0E        BMI $AEA4       ; branch if monster target
03/AE96: A5 A9        LDA $A9
03/AE98: D0 3D        BNE $AED7
03/AE9A: 80 08        BRA $AEA4
; monster attacker
03/AE9C: 38           SEC 
03/AE9D: AD D1 26     LDA $26D1
03/AEA0: E9 C0        SBC #$C0
03/AEA2: 85 A9        STA $A9
03/AEA4: AD 03 27     LDA $2703
03/AEA7: 29 80        AND #$80
03/AEA9: F0 32        BEQ $AEDD       ; branch if target is not dead
03/AEAB: A5 A9        LDA $A9
03/AEAD: F0 63        BEQ $AF12
03/AEAF: C9 03        CMP #$03
03/AEB1: B0 5F        BCS $AF12       ; branch if not item or magic
03/AEB3: C9 02        CMP #$02
03/AEB5: D0 19        BNE $AED0
; magic
03/AEB7: AD D2 26     LDA $26D2       ; magic id
03/AEBA: C9 13        CMP #$13        ; raise (life)
03/AEBC: F0 19        BEQ $AED7
03/AEBE: C9 14        CMP #$14        ; arise (life2)
03/AEC0: F0 15        BEQ $AED7
03/AEC2: C9 AB        CMP #$AB        ; restore (recover)
03/AEC4: F0 11        BEQ $AED7
03/AEC6: C9 AC        CMP #$AC        ; reraise (remedy)
03/AEC8: F0 0D        BEQ $AED7
03/AECA: C9 8F        CMP #$8F        ; return to darkness (vanish)
03/AECC: F0 09        BEQ $AED7
03/AECE: 80 42        BRA $AF12
; item
03/AED0: AD D2 26     LDA $26D2       ; item id
03/AED3: C9 D4        CMP #$D4
03/AED5: D0 3B        BNE $AF12       ; branch if not phoenix tail
03/AED7: EE E7 38     INC $38E7
03/AEDA: 4C 6F AF     JMP $AF6F
03/AEDD: AD 03 27     LDA $2703
03/AEE0: 29 40        AND #$40
03/AEE2: F0 22        BEQ $AF06       ; branch if target is not stone
03/AEE4: A5 A9        LDA $A9
03/AEE6: F0 2A        BEQ $AF12
03/AEE8: C9 03        CMP #$03
03/AEEA: B0 26        BCS $AF12
03/AEEC: C9 02        CMP #$02
03/AEEE: D0 09        BNE $AEF9
03/AEF0: AD D2 26     LDA $26D2
03/AEF3: C9 12        CMP #$12
03/AEF5: F0 78        BEQ $AF6F
03/AEF7: 80 19        BRA $AF12
03/AEF9: AD D2 26     LDA $26D2
03/AEFC: C9 D5        CMP #$D5
03/AEFE: F0 6F        BEQ $AF6F
03/AF00: C9 DD        CMP #$DD
03/AF02: F0 6B        BEQ $AF6F
03/AF04: 80 0C        BRA $AF12
03/AF06: AD 05 27     LDA $2705
03/AF09: 29 02        AND #$02
03/AF0B: D0 05        BNE $AF12       ; branch if target is jumping
03/AF0D: AD 06 27     LDA $2706
03/AF10: 10 5D        BPL $AF6F       ; branch if target is not hiding
; invalid target
03/AF12: A5 CE        LDA $CE
03/AF14: 10 10        BPL $AF26
; monster target
03/AF16: A2 05 00     LDX #$0005
03/AF19: BD 9C 28     LDA $289C,X
03/AF1C: F0 41        BEQ $AF5F       ; branch if at least one monster present
03/AF1E: E8           INX 
03/AF1F: E0 0D 00     CPX #$000D
03/AF22: D0 F5        BNE $AF19
03/AF24: 80 0D        BRA $AF33
; character target
03/AF26: 7B           TDC 
03/AF27: AA           TAX 
03/AF28: BD 9C 28     LDA $289C,X
03/AF2B: F0 32        BEQ $AF5F       ; branch if at least one character present
03/AF2D: E8           INX 
03/AF2E: E0 05 00     CPX #$0005
03/AF31: D0 F5        BNE $AF28
; no targets present
03/AF33: A6 A6        LDX $A6
03/AF35: E0 80 02     CPX #$0280
03/AF38: 90 14        BCC $AF4E
; monster attacker
03/AF3A: 20 48 B3     JSR $B348
03/AF3D: A5 A9        LDA $A9
03/AF3F: F0 09        BEQ $AF4A
03/AF41: A6 A6        LDX $A6
03/AF43: A9 E1        LDA #$E1
03/AF45: 9D 51 20     STA $2051,X     ; do nothing
03/AF48: 80 25        BRA $AF6F
03/AF4A: A9 E1        LDA #$E1
03/AF4C: 80 02        BRA $AF50
; character attacker
03/AF4E: A9 21        LDA #$21
03/AF50: A6 A6        LDX $A6
03/AF52: 9D 51 20     STA $2051,X     ; do nothing
03/AF55: 8D C2 33     STA $33C2
03/AF58: A9 FF        LDA #$FF
03/AF5A: 8D C3 33     STA $33C3
03/AF5D: 80 10        BRA $AF6F
03/AF5F: 20 9E B0     JSR $B09E       ; retarget
03/AF62: 48           PHA 
03/AF63: A5 8B        LDA $8B
03/AF65: AA           TAX 
03/AF66: A9 01        LDA #$01
03/AF68: 9D 9C 28     STA $289C,X
03/AF6B: 68           PLA 
03/AF6C: 4C 32 AE     JMP $AE32
; valid target
03/AF6F: A5 CE        LDA $CE
03/AF71: 30 78        BMI $AFEB       ; branch if monster target
03/AF73: AD 06 27     LDA $2706
03/AF76: 29 02        AND #$02
03/AF78: D0 07        BNE $AF81       ; branch if target is using cover
03/AF7A: AD 06 27     LDA $2706
03/AF7D: 29 01        AND #$01
03/AF7F: F0 6A        BEQ $AFEB       ; branch if target is not critical
03/AF81: AD D1 26     LDA $26D1
03/AF84: C9 C0        CMP #$C0
03/AF86: D0 63        BNE $AFEB       ; branch if not fight
03/AF88: AD 5E 35     LDA $355E
03/AF8B: 30 5E        BMI $AFEB       ; branch if paladin cecil is not present
03/AF8D: A5 CD        LDA $CD
03/AF8F: C5 CE        CMP $CE
03/AF91: F0 58        BEQ $AFEB       ; branch if self-target
03/AF93: CD 5E 35     CMP $355E
03/AF96: F0 53        BEQ $AFEB       ; branch if paladin cecil is attacker
03/AF98: AD 5E 35     LDA $355E
03/AF9B: C5 CE        CMP $CE
03/AF9D: F0 4C        BEQ $AFEB       ; branch if paladin cecil is target
03/AF9F: AD 5E 35     LDA $355E
03/AFA2: 20 89 84     JSR $8489       ; set current character/monster
03/AFA5: A6 A6        LDX $A6
03/AFA7: BD 03 20     LDA $2003,X
03/AFAA: 29 C0        AND #$C0
03/AFAC: D0 38        BNE $AFE6       ; branch if paladin cecil is dead or stone
03/AFAE: BD 04 20     LDA $2004,X
03/AFB1: 29 3C        AND #$3C
03/AFB3: D0 31        BNE $AFE6       ; paralyze, sleep, charm, berserk
03/AFB5: BD 05 20     LDA $2005,X
03/AFB8: 29 50        AND #$50
03/AFBA: D0 2A        BNE $AFE6       ; stop or defend ???
03/AFBC: BD 06 20     LDA $2006,X
03/AFBF: 29 01        AND #$01
03/AFC1: D0 23        BNE $AFE6       ; critical
03/AFC3: AD C5 34     LDA $34C5
03/AFC6: 8D C6 34     STA $34C6       ; targets being covered
03/AFC9: AE 5E 35     LDX $355E
03/AFCC: 8A           TXA 
03/AFCD: 85 CE        STA $CE         ; change target to paladin cecil
03/AFCF: 7B           TDC 
03/AFD0: 20 5F 85     JSR $855F       ; set bit
03/AFD3: 8D C5 34     STA $34C5
03/AFD6: A5 CE        LDA $CE
03/AFD8: 20 63 B1     JSR $B163       ; get pointer to character/monster properties
03/AFDB: A0 7F 00     LDY #$007F
03/AFDE: B1 80        LDA ($80),Y
03/AFE0: 99 00 27     STA $2700,Y     ; copy target properties to buffer
03/AFE3: 88           DEY 
03/AFE4: 10 F8        BPL $AFDE
03/AFE6: A5 D2        LDA $D2
03/AFE8: 20 89 84     JSR $8489       ; set current character/monster
03/AFEB: A5 CD        LDA $CD
03/AFED: 10 05        BPL $AFF4       ; branch if character attacker
03/AFEF: 29 7F        AND #$7F
03/AFF1: 18           CLC 
03/AFF2: 69 05        ADC #$05
03/AFF4: AA           TAX 
03/AFF5: 9E 60 35     STZ $3560,X
03/AFF8: A5 D2        LDA $D2
03/AFFA: 20 89 84     JSR $8489       ; set current character/monster
03/AFFD: A6 A6        LDX $A6
03/AFFF: BD 03 20     LDA $2003,X
03/B002: 29 C0        AND #$C0
03/B004: D0 07        BNE $B00D       ; branch if dead or stone
03/B006: BD 04 20     LDA $2004,X
03/B009: 29 30        AND #$30
03/B00B: F0 0F        BEQ $B01C       ; branch if not paralyzed or asleep
03/B00D: A5 D2        LDA $D2
03/B00F: C9 05        CMP #$05
03/B011: 90 04        BCC $B017       ; branch if a character
03/B013: A9 E1        LDA #$E1
03/B015: 80 02        BRA $B019
03/B017: A9 21        LDA #$21
03/B019: 9D 51 20     STA $2051,X     ; do nothing
03/B01C: 20 FF B0     JSR $B0FF       ; execute battle command
03/B01F: 7B           TDC 
03/B020: AD B3 38     LDA $38B3
03/B023: D0 1D        BNE $B042
03/B025: AD CD 00     LDA $00CD
03/B028: 10 18        BPL $B042       ; branch if character attacker
03/B02A: 7B           TDC 
03/B02B: AA           TAX 
03/B02C: BD C2 33     LDA $33C2,X
03/B02F: C9 FF        CMP #$FF
03/B031: F0 0F        BEQ $B042       ; find end of graphics script
03/B033: C9 FC        CMP #$FC
03/B035: F0 03        BEQ $B03A
03/B037: E8           INX 
03/B038: 80 F2        BRA $B02C
03/B03A: A9 FF        LDA #$FF
03/B03C: 8D 01 36     STA $3601
03/B03F: 8D 02 36     STA $3602
03/B042: AD E4 38     LDA $38E4
03/B045: D0 03        BNE $B04A       ; branch if monster death is delayed
03/B047: 20 88 B2     JSR $B288       ; add attack to retaliation stack
03/B04A: 20 A0 B1     JSR $B1A0       ; update dead targets
03/B04D: 9C E4 38     STZ $38E4
03/B050: 7B           TDC 
03/B051: AA           TAX 
03/B052: BD C2 33     LDA $33C2,X     ; copy graphics script to buffer
03/B055: 9D 9C 28     STA $289C,X
03/B058: C9 FF        CMP #$FF
03/B05A: F0 03        BEQ $B05F
03/B05C: E8           INX 
03/B05D: 80 F3        BRA $B052
03/B05F: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/B061: 20 85 80     JSR $8085       ; execute battle graphics
03/B064: A9 0C        LDA #$0C        ; battle graphics $0C: draw hp text
03/B066: 20 85 80     JSR $8085       ; execute battle graphics
03/B069: A9 0B        LDA #$0B        ; battle graphics $0B: draw monster names
03/B06B: 20 85 80     JSR $8085       ; execute battle graphics
03/B06E: AD 0A 39     LDA $390A
03/B071: D0 2A        BNE $B09D       ; return if no retaliation ???
03/B073: 64 D6        STZ $D6
03/B075: A5 CD        LDA $CD         ; timer duration 0 (atb)
03/B077: 10 05        BPL $B07E
03/B079: 29 7F        AND #$7F
03/B07B: 18           CLC 
03/B07C: 69 05        ADC #$05
03/B07E: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/B081: AE 30 35     LDX $3530
03/B084: BD 09 2A     LDA $2A09,X     ; restart timer
03/B087: 29 76        AND #$76
03/B089: 9D 09 2A     STA $2A09,X
03/B08C: A6 A6        LDX $A6
03/B08E: BD 04 20     LDA $2004,X
03/B091: 29 30        AND #$30
03/B093: D0 08        BNE $B09D       ; branch if paralyzed or asleep
03/B095: A9 03        LDA #$03        ; action timer
03/B097: 20 C8 85     JSR $85C8       ; set timer
03/B09A: 9E 06 2A     STZ $2A06,X     ; start timer
03/B09D: 60           RTS 

; [ retarget ]

03/B09E: A2 04 00     LDX #$0004
03/B0A1: A5 CE        LDA $CE
03/B0A3: 10 03        BPL $B0A8       ; branch if character target
03/B0A5: A2 07 00     LDX #$0007
03/B0A8: 8A           TXA 
03/B0A9: A2 00 00     LDX #$0000
03/B0AC: 20 79 83     JSR $8379       ; random (X..A)
03/B0AF: 85 AA        STA $AA         ; $AA = random target slot
03/B0B1: 85 8B        STA $8B
03/B0B3: A5 CE        LDA $CE
03/B0B5: 10 07        BPL $B0BE       ; branch if character target
03/B0B7: 18           CLC 
03/B0B8: A5 8B        LDA $8B
03/B0BA: 69 05        ADC #$05
03/B0BC: 85 8B        STA $8B
03/B0BE: A5 8B        LDA $8B
03/B0C0: AA           TAX 
03/B0C1: BD 40 35     LDA $3540,X
03/B0C4: D0 D8        BNE $B09E       ; branch if not present
03/B0C6: A5 CE        LDA $CE
03/B0C8: 10 12        BPL $B0DC       ; branch if character target
03/B0CA: A5 8B        LDA $8B
03/B0CC: 85 DF        STA $DF
03/B0CE: A9 80        LDA #$80
03/B0D0: 85 E1        STA $E1
03/B0D2: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/B0D5: A6 E3        LDX $E3
03/B0D7: BD 01 20     LDA $2001,X
03/B0DA: 30 C2        BMI $B09E       ; branch if dead
03/B0DC: A5 AA        LDA $AA
03/B0DE: AA           TAX 
03/B0DF: 7B           TDC 
03/B0E0: 20 5F 85     JSR $855F       ; set bit
03/B0E3: 48           PHA 
03/B0E4: A5 D2        LDA $D2
03/B0E6: 20 89 84     JSR $8489       ; set current character/monster
03/B0E9: A6 A6        LDX $A6
03/B0EB: A5 CE        LDA $CE
03/B0ED: 30 08        BMI $B0F7
03/B0EF: 68           PLA 
03/B0F0: 9D 54 20     STA $2054,X
03/B0F3: 8D D4 26     STA $26D4
03/B0F6: 60           RTS 
03/B0F7: 68           PLA 
03/B0F8: 9D 53 20     STA $2053,X
03/B0FB: 8D D3 26     STA $26D3
03/B0FE: 60           RTS 

; [ execute battle command ]

03/B0FF: A5 D2        LDA $D2
03/B101: C9 05        CMP #$05
03/B103: 90 17        BCC $B11C       ; branch if a character
; monster
03/B105: A6 A6        LDX $A6
03/B107: BD 51 20     LDA $2051,X
03/B10A: C9 C0        CMP #$C0
03/B10C: 90 04        BCC $B112
03/B10E: C9 E1        CMP #$E1
03/B110: 90 02        BCC $B114
03/B112: A9 E1        LDA #$E1
03/B114: 8D FF 35     STA $35FF       ; treat as "do nothing" for retaliations
03/B117: 38           SEC 
03/B118: E9 C0        SBC #$C0
03/B11A: 80 32        BRA $B14E
; character
03/B11C: A9 F8        LDA #$F8        ; display text
03/B11E: 8D C2 33     STA $33C2
03/B121: A9 02        LDA #$02        ; attack name
03/B123: 8D C3 33     STA $33C3
03/B126: A6 A6        LDX $A6
03/B128: BD 51 20     LDA $2051,X     ; battle command used
03/B12B: C9 02        CMP #$02
03/B12D: F0 08        BEQ $B137
03/B12F: C9 07        CMP #$07
03/B131: F0 04        BEQ $B137
03/B133: C9 20        CMP #$20
03/B135: D0 03        BNE $B13A
03/B137: EE 5D 35     INC $355D       ; consume mp if magic, recall, or twin
03/B13A: 48           PHA 
03/B13B: 18           CLC 
03/B13C: 69 C0        ADC #$C0
03/B13E: 8D C4 33     STA $33C4       ; add to graphics script
03/B141: C9 C1        CMP #$C1
03/B143: D0 02        BNE $B147       ; branch if not using an item
03/B145: A9 C2        LDA #$C2        ; treat item as magic for retaliations
03/B147: 8D FF 35     STA $35FF
03/B14A: 9C C5 33     STZ $33C5
03/B14D: 68           PLA 
03/B14E: 0A           ASL 
03/B14F: AA           TAX 
03/B150: BF 6C B3 03  LDA $03B36C,X   ; battle command jump table
03/B154: 85 80        STA $80
03/B156: BF 6D B3 03  LDA $03B36D,X
03/B15A: 85 81        STA $81
03/B15C: A9 03        LDA #$03
03/B15E: 85 82        STA $82
03/B160: DC 80 00     JML [$0080]

; [ get pointer to character/monster properties ]

03/B163: 48           PHA 
03/B164: 29 7F        AND #$7F
03/B166: 85 DF        STA $DF
03/B168: A9 80        LDA #$80
03/B16A: 85 E1        STA $E1
03/B16C: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/B16F: 68           PLA 
03/B170: 30 0E        BMI $B180       ; branch if a monster
03/B172: 18           CLC 
03/B173: A5 E3        LDA $E3
03/B175: 69 00        ADC #$00
03/B177: 85 80        STA $80
03/B179: A5 E4        LDA $E4
03/B17B: 69 20        ADC #$20
03/B17D: 85 81        STA $81
03/B17F: 60           RTS 
03/B180: 18           CLC 
03/B181: A5 E3        LDA $E3
03/B183: 69 80        ADC #$80
03/B185: 85 80        STA $80
03/B187: A5 E4        LDA $E4
03/B189: 69 22        ADC #$22
03/B18B: 85 81        STA $81
03/B18D: 60           RTS 

; [ set targets ]

03/B18E: 8D C5 34     STA $34C5
03/B191: 20 0C 85     JSR $850C       ; count bits
03/B194: CA           DEX 
03/B195: F0 08        BEQ $B19F       ; branch if single target
03/B197: AD C4 34     LDA $34C4       ; multi-target
03/B19A: 09 40        ORA #$40
03/B19C: 8D C4 34     STA $34C4
03/B19F: 60           RTS 

; [ update dead targets ]

03/B1A0: 7B           TDC 
03/B1A1: AA           TAX 
03/B1A2: 86 A9        STX $A9
; start of loop
03/B1A4: A5 A9        LDA $A9
03/B1A6: 20 89 84     JSR $8489       ; set current character/monster
03/B1A9: A6 A6        LDX $A6
03/B1AB: A5 A9        LDA $A9
03/B1AD: 20 7F 84     JSR $847F       ; asl2
03/B1B0: A8           TAY 
03/B1B1: B9 8E 33     LDA $338E,Y     ; apply pending status 1
03/B1B4: 1D 03 20     ORA $2003,X
03/B1B7: 9D 03 20     STA $2003,X
03/B1BA: 29 C0        AND #$C0
03/B1BC: F0 76        BEQ $B234       ; branch if not dead or stone
03/B1BE: 29 80        AND #$80
03/B1C0: F0 06        BEQ $B1C8       ; branch if not dead
03/B1C2: 9E 07 20     STZ $2007,X     ; set hp to zero
03/B1C5: 9E 08 20     STZ $2008,X
03/B1C8: DA           PHX 
03/B1C9: A5 A9        LDA $A9
03/B1CB: 0A           ASL 
03/B1CC: AA           TAX 
03/B1CD: 7B           TDC 
03/B1CE: 9D EB 29     STA $29EB,X     ; disable all timers
03/B1D1: A5 A9        LDA $A9
03/B1D3: C9 05        CMP #$05
03/B1D5: 90 4F        BCC $B226       ; branch if a character
03/B1D7: 38           SEC 
03/B1D8: E9 05        SBC #$05
03/B1DA: AA           TAX 
03/B1DB: BD BD 29     LDA $29BD,X
03/B1DE: 85 AA        STA $AA
03/B1E0: BD B5 29     LDA $29B5,X
03/B1E3: 30 34        BMI $B219
03/B1E5: A9 FF        LDA #$FF
03/B1E7: 9D B5 29     STA $29B5,X
03/B1EA: A5 AA        LDA $AA
03/B1EC: AA           TAX 
03/B1ED: BD CA 29     LDA $29CA,X     ; decrement monster type count
03/B1F0: F0 03        BEQ $B1F5
03/B1F2: DE CA 29     DEC $29CA,X
03/B1F5: FA           PLX 
03/B1F6: DA           PHX 
03/B1F7: BD 51 20     LDA $2051,X
03/B1FA: C9 E4        CMP #$E4
03/B1FC: F0 0B        BEQ $B209       ; branch if summon was used
03/B1FE: AD 82 38     LDA $3882
03/B201: D0 06        BNE $B209
03/B203: A5 AA        LDA $AA
03/B205: AA           TAX 
03/B206: FE 85 35     INC $3585,X
03/B209: A5 AA        LDA $AA
03/B20B: AA           TAX 
03/B20C: BD CA 29     LDA $29CA,X
03/B20F: D0 08        BNE $B219       ; branch if not the last monster of this type
03/B211: A5 AA        LDA $AA
03/B213: AA           TAX 
03/B214: A9 FF        LDA #$FF
03/B216: 9D AD 29     STA $29AD,X     ; clear monster type
03/B219: 18           CLC 
03/B21A: AD CA 29     LDA $29CA       ; update total monster count
03/B21D: 6D CB 29     ADC $29CB
03/B220: 6D CC 29     ADC $29CC
03/B223: 8D CD 29     STA $29CD
03/B226: FA           PLX 
03/B227: BD 03 20     LDA $2003,X
03/B22A: 29 80        AND #$80
03/B22C: F0 06        BEQ $B234
03/B22E: 9E 07 20     STZ $2007,X     ; set hp to zero
03/B231: 9E 08 20     STZ $2008,X
03/B234: C8           INY 
03/B235: B9 8E 33     LDA $338E,Y     ; apply pending status 2
03/B238: 1D 04 20     ORA $2004,X
03/B23B: 9D 04 20     STA $2004,X
03/B23E: C8           INY 
03/B23F: B9 8E 33     LDA $338E,Y     ; apply pending status 3
03/B242: 1D 05 20     ORA $2005,X
03/B245: 9D 05 20     STA $2005,X
03/B248: C8           INY 
03/B249: B9 8E 33     LDA $338E,Y     ; apply pending status 4
03/B24C: 1D 06 20     ORA $2006,X
03/B24F: 9D 06 20     STA $2006,X
03/B252: BD 03 20     LDA $2003,X
03/B255: 29 C0        AND #$C0
03/B257: F0 20        BEQ $B279       ; branch if not dead or stone
03/B259: BD 03 20     LDA $2003,X     ; clear poison status
03/B25C: 29 FE        AND #$FE
03/B25E: 9D 03 20     STA $2003,X
03/B261: BD 04 20     LDA $2004,X     ; clear all but curse and float
03/B264: 29 C0        AND #$C0
03/B266: 9D 04 20     STA $2004,X
03/B269: BD 05 20     LDA $2005,X     ; clear stop, defend, focus, twin, doom
03/B26C: 29 A2        AND #$A2
03/B26E: 9D 05 20     STA $2005,X
03/B271: BD 06 20     LDA $2006,X     ; clear all but hide
03/B274: 29 80        AND #$80
03/B276: 9D 06 20     STA $2006,X
03/B279: E6 A9        INC $A9         ; next character/monster
03/B27B: A5 A9        LDA $A9
03/B27D: C9 0D        CMP #$0D
03/B27F: F0 03        BEQ $B284
03/B281: 4C A4 B1     JMP $B1A4
03/B284: 9C 82 38     STZ $3882
03/B287: 60           RTS 

; [ add attack to retaliation stack ]

03/B288: AD C4 34     LDA $34C4
03/B28B: 10 49        BPL $B2D6       ; return if character target
03/B28D: AD C5 34     LDA $34C5       ; targets mask
03/B290: 85 A9        STA $A9
03/B292: 7B           TDC 
03/B293: AA           TAX 
; start of monster loop
03/B294: 06 A9        ASL $A9
03/B296: 90 38        BCC $B2D0       ; branch if monster wasn't a target
03/B298: 8A           TXA 
03/B299: 20 7C 84     JSR $847C       ; asl5
03/B29C: A8           TAY 
03/B29D: 84 AB        STY $AB         ; pointer to retaliation stack
03/B29F: BD F7 35     LDA $35F7,X     ; retaliation stack size
03/B2A2: 1A           INC 
03/B2A3: C9 04        CMP #$04
03/B2A5: D0 07        BNE $B2AE
03/B2A7: DA           PHX 
03/B2A8: 20 D7 B2     JSR $B2D7       ; shift retaliation stack
03/B2AB: FA           PLX 
03/B2AC: A9 03        LDA #$03
03/B2AE: 9D F7 35     STA $35F7,X
03/B2B1: 20 7F 84     JSR $847F       ; asl2
03/B2B4: 18           CLC 
03/B2B5: 65 AB        ADC $AB
03/B2B7: A8           TAY 
03/B2B8: A5 CD        LDA $CD
03/B2BA: 99 78 2B     STA $2B78,Y     ; set previous attacker
03/B2BD: AD FF 35     LDA $35FF
03/B2C0: 99 79 2B     STA $2B79,Y     ; set previous command
03/B2C3: 7B           TDC 
03/B2C4: 99 7A 2B     STA $2B7A,Y
03/B2C7: AD 00 36     LDA $3600
03/B2CA: 99 7B 2B     STA $2B7B,Y     ; previous element
03/B2CD: 9C 00 36     STZ $3600
03/B2D0: E8           INX             ; next monster
03/B2D1: E0 08 00     CPX #$0008
03/B2D4: D0 BE        BNE $B294
03/B2D6: 60           RTS 

; [ shift retaliation stack ]

03/B2D7: DA           PHX 
03/B2D8: 7B           TDC 
03/B2D9: A8           TAY 
03/B2DA: A6 AB        LDX $AB
03/B2DC: BD 78 2B     LDA $2B78,X     ; copy retaliation stack to buffer
03/B2DF: 99 9C 28     STA $289C,Y
03/B2E2: E8           INX 
03/B2E3: C8           INY 
03/B2E4: C0 20 00     CPY #$0020
03/B2E7: D0 F3        BNE $B2DC
03/B2E9: A0 04 00     LDY #$0004
03/B2EC: A6 AB        LDX $AB
03/B2EE: B9 9C 28     LDA $289C,Y     ; shift out the least recent attack
03/B2F1: 9D 78 2B     STA $2B78,X
03/B2F4: E8           INX 
03/B2F5: C8           INY 
03/B2F6: C0 24 00     CPY #$0024
03/B2F9: D0 F3        BNE $B2EE
03/B2FB: FA           PLX 
03/B2FC: 60           RTS 

; [ init graphics script ]

03/B2FD: A9 FF        LDA #$FF
03/B2FF: A2 FF 00     LDX #$00FF
03/B302: 9D C2 33     STA $33C2,X
03/B305: CA           DEX 
03/B306: 10 FA        BPL $B302
03/B308: A2 11 00     LDX #$0011
03/B30B: 9E C2 34     STZ $34C2,X
03/B30E: CA           DEX 
03/B30F: 10 FA        BPL $B30B
03/B311: 9C 28 35     STZ $3528
03/B314: 9C 29 35     STZ $3529
03/B317: 9C 2A 35     STZ $352A
03/B31A: A2 33 00     LDX #$0033
03/B31D: 9E 8E 33     STZ $338E,X
03/B320: CA           DEX 
03/B321: 10 FA        BPL $B31D
03/B323: A9 FF        LDA #$FF
03/B325: A2 09 00     LDX #$0009
03/B328: 9D CA 34     STA $34CA,X
03/B32B: CA           DEX 
03/B32C: 10 FA        BPL $B328
03/B32E: AD 01 36     LDA $3601
03/B331: C9 FF        CMP #$FF
03/B333: D0 09        BNE $B33E
03/B335: A2 4D 00     LDX #$004D
03/B338: 9E D4 34     STZ $34D4,X
03/B33B: CA           DEX 
03/B33C: 10 FA        BPL $B338
03/B33E: 60           RTS 

; [ battle command $21: do nothing ]

03/B33F: AD C2 34     LDA $34C2
03/B342: 09 40        ORA #$40
03/B344: 8D C2 34     STA $34C2
03/B347: 60           RTS 

; [  ]

03/B348: 7B           TDC 
03/B349: AA           TAX 
03/B34A: 86 A9        STX $A9
03/B34C: BD C2 33     LDA $33C2,X
03/B34F: C9 FF        CMP #$FF
03/B351: F0 18        BEQ $B36B
03/B353: C9 FC        CMP #$FC
03/B355: F0 03        BEQ $B35A
03/B357: E8           INX 
03/B358: 80 F2        BRA $B34C
03/B35A: E6 A9        INC $A9
03/B35C: A9 E1        LDA #$E1
03/B35E: 8D C2 33     STA $33C2
03/B361: A9 FC        LDA #$FC
03/B363: 8D C3 33     STA $33C3
03/B366: A9 FF        LDA #$FF
03/B368: 8D C4 33     STA $33C4
03/B36B: 60           RTS 

; battle command jump table
03/B36C: C489 EBA2 CC36 0000 0000 E9EC E957 EA1D  ; $00
03/B37C: E903 E879 E2DF E855 E839 E7F3 E6B7 E699
03/B38C: E441 EAC6 EAE9 E612 E156 0000 E34F E1CF  ; $10
03/B39C: 0000 E3FD E3D4 E9E1 E8BE E656 E9A5 E826
03/B3AC: E4E6 B33F E43B 0000 E1B5                 ; $20

; --------------------------------------------------------------------------

; [ action type 1: choose monster action ]

03/B3B6: 20 F2 BB     JSR $BBF2       ; init monster graphics script
03/B3B9: 20 12 BC     JSR $BC12       ; clear graphics script buffer
03/B3BC: 38           SEC 
03/B3BD: A5 D2        LDA $D2
03/B3BF: E9 05        SBC #$05
03/B3C1: 8D 1C 36     STA $361C
03/B3C4: AD 77 38     LDA $3877
03/B3C7: F0 0D        BEQ $B3D6
03/B3C9: A5 D2        LDA $D2
03/B3CB: CD 01 36     CMP $3601
03/B3CE: F0 03        BEQ $B3D3
03/B3D0: 4C 8C B6     JMP $B68C
03/B3D3: 4C 17 B5     JMP $B517
03/B3D6: 20 FD B2     JSR $B2FD       ; init graphics script
03/B3D9: A6 A6        LDX $A6
03/B3DB: 9E 50 20     STZ $2050,X
03/B3DE: 9E 52 20     STZ $2052,X
03/B3E1: 9E 55 20     STZ $2055,X
03/B3E4: 9E 56 20     STZ $2056,X
03/B3E7: 9E 53 20     STZ $2053,X
03/B3EA: 9E 54 20     STZ $2054,X
03/B3ED: A9 E1        LDA #$E1
03/B3EF: 9D 51 20     STA $2051,X
03/B3F2: BD 04 20     LDA $2004,X
03/B3F5: 29 0C        AND #$0C
03/B3F7: D0 29        BNE $B422
03/B3F9: BD 70 20     LDA $2070,X
03/B3FC: 30 24        BMI $B422       ; branch if a boss
03/B3FE: AD 83 35     LDA $3583
03/B401: DD 2F 20     CMP $202F,X
03/B404: 90 1C        BCC $B422
03/B406: 20 93 85     JSR $8593       ; random (0..255)
03/B409: A6 A6        LDX $A6
03/B40B: DD 29 20     CMP $2029,X
03/B40E: B0 12        BCS $B422
03/B410: AD E5 38     LDA $38E5
03/B413: 29 01        AND #$01
03/B415: D0 0B        BNE $B422
03/B417: A9 E4        LDA #$E4
03/B419: 9D 51 20     STA $2051,X
03/B41C: 20 DE BB     JSR $BBDE
03/B41F: 4C 8C B6     JMP $B68C
03/B422: A6 A6        LDX $A6
03/B424: BD 04 20     LDA $2004,X
03/B427: 29 04        AND #$04
03/B429: F0 21        BEQ $B44C
03/B42B: A9 05        LDA #$05
03/B42D: 85 AB        STA $AB
03/B42F: A6 A6        LDX $A6
03/B431: 9E 51 20     STZ $2051,X
03/B434: 20 31 BC     JSR $BC31
03/B437: BD 51 20     LDA $2051,X
03/B43A: C9 E1        CMP #$E1
03/B43C: F0 08        BEQ $B446
03/B43E: A9 C0        LDA #$C0
03/B440: 9D 51 20     STA $2051,X
03/B443: 8D 39 38     STA $3839
03/B446: 20 DE BB     JSR $BBDE
03/B449: 4C 8C B6     JMP $B68C
03/B44C: 9C BE 35     STZ $35BE
03/B44F: AD 1C 36     LDA $361C
03/B452: 85 DF        STA $DF
03/B454: A9 14        LDA #$14
03/B456: 85 E1        STA $E1
03/B458: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/B45B: A6 E3        LDX $E3
03/B45D: 8E C3 35     STX $35C3
03/B460: 8E C5 35     STX $35C5
03/B463: AD 1C 36     LDA $361C
03/B466: AA           TAX 
03/B467: 8E 3D 39     STX $393D
03/B46A: A2 58 02     LDX #$0258
03/B46D: 8E 3F 39     STX $393F
03/B470: 20 B9 83     JSR $83B9
03/B473: AE 41 39     LDX $3941
03/B476: 8E BF 35     STX $35BF
03/B479: 8E C1 35     STX $35C1
03/B47C: AD 1C 36     LDA $361C
03/B47F: 85 DF        STA $DF
03/B481: A9 28        LDA #$28
03/B483: 85 E1        STA $E1
03/B485: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/B488: A6 E3        LDX $E3
03/B48A: 8E C8 35     STX $35C8
03/B48D: AD 1C 36     LDA $361C
03/B490: AA           TAX 
03/B491: 8E 3D 39     STX $393D
03/B494: A2 A0 00     LDX #$00A0
03/B497: 8E 3F 39     STX $393F
03/B49A: 20 B9 83     JSR $83B9
03/B49D: AE 41 39     LDX $3941
03/B4A0: 8E CC 35     STX $35CC
03/B4A3: AD BE 35     LDA $35BE
03/B4A6: 20 7F 84     JSR $847F       ; asl2
03/B4A9: 18           CLC 
03/B4AA: 6D C8 35     ADC $35C8
03/B4AD: 8D CA 35     STA $35CA
03/B4B0: AD C9 35     LDA $35C9
03/B4B3: 69 00        ADC #$00
03/B4B5: 8D CB 35     STA $35CB
03/B4B8: AD BE 35     LDA $35BE
03/B4BB: AA           TAX 
03/B4BC: C2 20        REP #$20
03/B4BE: 8A           TXA 
03/B4BF: 20 7D 84     JSR $847D       ; asl4
03/B4C2: 18           CLC 
03/B4C3: 6D CC 35     ADC $35CC
03/B4C6: 8D CE 35     STA $35CE
03/B4C9: 7B           TDC 
03/B4CA: E2 20        SEP #$20
03/B4CC: AE C5 35     LDX $35C5
03/B4CF: BD 7F 39     LDA $397F,X
03/B4D2: F0 43        BEQ $B517
03/B4D4: 9C C7 35     STZ $35C7
03/B4D7: AE CA 35     LDX $35CA
03/B4DA: BD 1F 3A     LDA $3A1F,X
03/B4DD: C9 FF        CMP #$FF
03/B4DF: F0 36        BEQ $B517
03/B4E1: 7B           TDC 
03/B4E2: A8           TAY 
03/B4E3: AE CE 35     LDX $35CE
03/B4E6: BD 5F 3B     LDA $3B5F,X
03/B4E9: 99 9C 28     STA $289C,Y
03/B4EC: E8           INX 
03/B4ED: C8           INY 
03/B4EE: C0 04 00     CPY #$0004
03/B4F1: D0 F3        BNE $B4E6
03/B4F3: 8E CE 35     STX $35CE
03/B4F6: 20 CE BC     JSR $BCCE       ; check monster condition
03/B4F9: A5 DE        LDA $DE
03/B4FB: F0 0F        BEQ $B50C
03/B4FD: EE CA 35     INC $35CA
03/B500: EE C7 35     INC $35C7
03/B503: AD C7 35     LDA $35C7
03/B506: C9 04        CMP #$04
03/B508: D0 CD        BNE $B4D7
03/B50A: F0 0B        BEQ $B517
03/B50C: EE C5 35     INC $35C5
03/B50F: EE C5 35     INC $35C5
03/B512: EE BE 35     INC $35BE
03/B515: 80 8C        BRA $B4A3
03/B517: AD 1C 36     LDA $361C
03/B51A: AA           TAX 
03/B51B: AD BE 35     LDA $35BE
03/B51E: DD 04 36     CMP $3604,X
03/B521: F0 09        BEQ $B52C
03/B523: 9D 04 36     STA $3604,X
03/B526: 20 4C B7     JSR $B74C       ; get pointer to monster script
03/B529: 9C 77 38     STZ $3877
03/B52C: AD 77 38     LDA $3877
03/B52F: D0 51        BNE $B582
03/B531: 7B           TDC 
03/B532: AA           TAX 
03/B533: 8E 75 38     STX $3875
03/B536: AD 1C 36     LDA $361C
03/B539: 0A           ASL 
03/B53A: AA           TAX 
03/B53B: BD 0C 36     LDA $360C,X
03/B53E: 8D C1 35     STA $35C1
03/B541: BD 0D 36     LDA $360D,X
03/B544: 8D C2 35     STA $35C2
03/B547: AE C1 35     LDX $35C1
03/B54A: 7B           TDC 
03/B54B: A8           TAY 
03/B54C: BD 5F 40     LDA $405F,X
03/B54F: C9 FF        CMP #$FF
03/B551: D0 07        BNE $B55A
03/B553: A9 E1        LDA #$E1
03/B555: 99 1D 36     STA $361D,Y
03/B558: 80 12        BRA $B56C
03/B55A: BD 5F 40     LDA $405F,X
03/B55D: E8           INX 
03/B55E: 99 1D 36     STA $361D,Y
03/B561: C9 FE        CMP #$FE
03/B563: F0 0C        BEQ $B571
03/B565: C9 FF        CMP #$FF
03/B567: F0 03        BEQ $B56C
03/B569: C8           INY 
03/B56A: 80 EE        BRA $B55A
03/B56C: 20 4C B7     JSR $B74C       ; get pointer to monster script
03/B56F: 80 11        BRA $B582
03/B571: 86 A9        STX $A9
03/B573: AD 1C 36     LDA $361C
03/B576: 0A           ASL 
03/B577: AA           TAX 
03/B578: A5 A9        LDA $A9
03/B57A: 9D 0C 36     STA $360C,X
03/B57D: A5 AA        LDA $AA
03/B57F: 9D 0D 36     STA $360D,X
03/B582: 7B           TDC 
03/B583: A8           TAY 
03/B584: AE 75 38     LDX $3875
03/B587: BD 1D 36     LDA $361D,X
03/B58A: C9 C0        CMP #$C0
03/B58C: B0 13        BCS $B5A1
03/B58E: 99 3A 38     STA $383A,Y
03/B591: DA           PHX 
03/B592: A6 A6        LDX $A6
03/B594: 9D 52 20     STA $2052,X
03/B597: FA           PLX 
03/B598: A9 C2        LDA #$C2
03/B59A: 99 39 38     STA $3839,Y
03/B59D: C8           INY 
03/B59E: E8           INX 
03/B59F: 80 26        BRA $B5C7
03/B5A1: 99 39 38     STA $3839,Y
03/B5A4: E8           INX 
03/B5A5: C9 FA        CMP #$FA
03/B5A7: B0 0E        BCS $B5B7
03/B5A9: C9 E8        CMP #$E8
03/B5AB: 90 1A        BCC $B5C7
; get command parameter ($E8-$F9)
03/B5AD: C8           INY 
03/B5AE: BD 1D 36     LDA $361D,X
03/B5B1: 99 39 38     STA $3839,Y
03/B5B4: E8           INX 
03/B5B5: 80 10        BRA $B5C7
03/B5B7: C9 FB        CMP #$FB
03/B5B9: F0 12        BEQ $B5CD
03/B5BB: C9 FC        CMP #$FC
03/B5BD: F0 0E        BEQ $B5CD
03/B5BF: C9 FE        CMP #$FE
03/B5C1: F0 07        BEQ $B5CA
03/B5C3: C9 FF        CMP #$FF
03/B5C5: F0 03        BEQ $B5CA
03/B5C7: C8           INY 
03/B5C8: 80 BD        BRA $B587
03/B5CA: 9C 77 38     STZ $3877
03/B5CD: 8E 75 38     STX $3875
03/B5D0: 7B           TDC 
03/B5D1: AA           TAX 
03/B5D2: 86 CB        STX $CB
03/B5D4: A6 CB        LDX $CB
03/B5D6: BD 39 38     LDA $3839,X
03/B5D9: C9 FD        CMP #$FD
03/B5DB: F0 10        BEQ $B5ED
03/B5DD: C9 FC        CMP #$FC
03/B5DF: F0 25        BEQ $B606
03/B5E1: C9 FB        CMP #$FB
03/B5E3: F0 3A        BEQ $B61F
03/B5E5: C9 E8        CMP #$E8
03/B5E7: 90 2A        BCC $B613
03/B5E9: E8           INX 
03/B5EA: E8           INX 
03/B5EB: 80 E9        BRA $B5D6
03/B5ED: EE 77 38     INC $3877
03/B5F0: A5 D2        LDA $D2
03/B5F2: 8D 01 36     STA $3601
03/B5F5: 9C 02 36     STZ $3602
03/B5F8: A6 A6        LDX $A6
03/B5FA: BD 60 20     LDA $2060,X
03/B5FD: 8D 78 38     STA $3878
03/B600: 7B           TDC 
03/B601: 9D 60 20     STA $2060,X
03/B604: 80 19        BRA $B61F
03/B606: CE 77 38     DEC $3877
03/B609: A6 A6        LDX $A6
03/B60B: AD 78 38     LDA $3878
03/B60E: 9D 60 20     STA $2060,X
03/B611: 80 0C        BRA $B61F
03/B613: E8           INX 
03/B614: BD 39 38     LDA $3839,X
03/B617: C9 FC        CMP #$FC
03/B619: F0 EB        BEQ $B606
03/B61B: C9 FF        CMP #$FF
03/B61D: D0 F4        BNE $B613
03/B61F: 7B           TDC 
03/B620: AA           TAX 
03/B621: BD 39 38     LDA $3839,X
03/B624: C9 FA        CMP #$FA
03/B626: B0 05        BCS $B62D
03/B628: C9 E8        CMP #$E8
03/B62A: 90 04        BCC $B630
03/B62C: E8           INX 
03/B62D: E8           INX 
03/B62E: 80 F1        BRA $B621
03/B630: A6 A6        LDX $A6
03/B632: 9D 51 20     STA $2051,X
03/B635: 7B           TDC 
03/B636: AA           TAX 
03/B637: 86 80        STX $80
03/B639: A6 80        LDX $80
03/B63B: BD 39 38     LDA $3839,X
03/B63E: C9 FF        CMP #$FF
03/B640: F0 3D        BEQ $B67F
03/B642: C9 F9        CMP #$F9
03/B644: F0 2A        BEQ $B670
03/B646: C9 E8        CMP #$E8
03/B648: 90 31        BCC $B67B
03/B64A: C9 FB        CMP #$FB
03/B64C: B0 2D        BCS $B67B
03/B64E: C9 F0        CMP #$F0
03/B650: B0 0D        BCS $B65F
; $E8-$EF: change monster stat
03/B652: 48           PHA 
03/B653: E8           INX 
03/B654: BD 39 38     LDA $3839,X
03/B657: 85 A9        STA $A9
03/B659: 68           PLA 
03/B65A: 20 6F B7     JSR $B76F       ; change monster stat
03/B65D: 80 1A        BRA $B679
; $F4-$F7: change battle variable
03/B65F: C9 F4        CMP #$F4
03/B661: 90 16        BCC $B679
03/B663: 48           PHA 
03/B664: E8           INX 
03/B665: BD 39 38     LDA $3839,X
03/B668: 85 A9        STA $A9
03/B66A: 68           PLA 
03/B66B: 20 77 B8     JSR $B877       ; change battle variable
03/B66E: 80 09        BRA $B679
; $F9: choose target
03/B670: E8           INX 
03/B671: BD 39 38     LDA $3839,X
03/B674: 85 A9        STA $A9
03/B676: 20 A1 B8     JSR $B8A1       ; choose monster target
03/B679: E6 80        INC $80
03/B67B: E6 80        INC $80
03/B67D: 80 BA        BRA $B639
; $FF: end of script
03/B67F: 20 8F B6     JSR $B68F       ; set monster pending action
03/B682: 20 DE BB     JSR $BBDE       ; init monster action delay
03/B685: AD 1C 36     LDA $361C
03/B688: AA           TAX 
03/B689: 9E 79 38     STZ $3879,X
03/B68C: 4C 1E BC     JMP $BC1E       ; copy monster graphic script from buffer

; [ set monster pending action ]

03/B68F: AD 1C 36     LDA $361C
03/B692: AA           TAX 
03/B693: BD 83 38     LDA $3883,X
03/B696: F0 0E        BEQ $B6A6
03/B698: 9E 83 38     STZ $3883,X
03/B69B: A6 A6        LDX $A6
03/B69D: 9D 54 20     STA $2054,X
03/B6A0: 9E 53 20     STZ $2053,X
03/B6A3: 4C 4B B7     JMP $B74B
03/B6A6: AD 1C 36     LDA $361C
03/B6A9: AA           TAX 
03/B6AA: BD 79 38     LDA $3879,X
03/B6AD: F0 03        BEQ $B6B2
03/B6AF: 4C 4B B7     JMP $B74B
03/B6B2: A6 A6        LDX $A6
03/B6B4: BD 51 20     LDA $2051,X
03/B6B7: C9 C2        CMP #$C2
03/B6B9: F0 03        BEQ $B6BE
03/B6BB: 4C 44 B7     JMP $B744
03/B6BE: BD 52 20     LDA $2052,X
03/B6C1: C9 31        CMP #$31
03/B6C3: B0 1D        BCS $B6E2
03/B6C5: AA           TAX 
03/B6C6: 86 E5        STX $E5
03/B6C8: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/B6CB: 86 80        STX $80
03/B6CD: A9 0F        LDA #$0F
03/B6CF: 85 82        STA $82
03/B6D1: A9 06        LDA #$06
03/B6D3: 20 5E 84     JSR $845E       ; load array item
03/B6D6: AD 9C 28     LDA $289C
03/B6D9: 10 03        BPL $B6DE
03/B6DB: 4C 44 B7     JMP $B744
03/B6DE: A9 08        LDA #$08
03/B6E0: 80 64        BRA $B746
03/B6E2: C9 5F        CMP #$5F
03/B6E4: B0 30        BCS $B716
03/B6E6: 38           SEC 
03/B6E7: E9 30        SBC #$30
03/B6E9: A6 A6        LDX $A6
03/B6EB: 9D 52 20     STA $2052,X
03/B6EE: AA           TAX 
03/B6EF: 86 E5        STX $E5
03/B6F1: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/B6F4: 86 80        STX $80
03/B6F6: A9 0F        LDA #$0F
03/B6F8: 85 82        STA $82
03/B6FA: A9 06        LDA #$06
03/B6FC: 20 5E 84     JSR $845E       ; load array item
03/B6FF: A6 A6        LDX $A6
03/B701: AD 9C 28     LDA $289C
03/B704: 30 07        BMI $B70D
03/B706: A9 FF        LDA #$FF
03/B708: 9D 53 20     STA $2053,X
03/B70B: 80 3E        BRA $B74B
03/B70D: A9 F8        LDA #$F8
03/B70F: A6 A6        LDX $A6
03/B711: 9D 54 20     STA $2054,X
03/B714: 80 35        BRA $B74B
03/B716: AA           TAX 
03/B717: 86 E5        STX $E5
03/B719: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/B71C: 86 80        STX $80
03/B71E: A9 0F        LDA #$0F
03/B720: 85 82        STA $82
03/B722: A9 06        LDA #$06
03/B724: 20 5E 84     JSR $845E       ; load array item
03/B727: AD 9C 28     LDA $289C
03/B72A: 29 E0        AND #$E0
03/B72C: D0 0F        BNE $B73D
03/B72E: AD 1C 36     LDA $361C
03/B731: AA           TAX 
03/B732: 7B           TDC 
03/B733: 20 5F 85     JSR $855F       ; set bit
03/B736: A6 A6        LDX $A6
03/B738: 9D 53 20     STA $2053,X
03/B73B: 80 0E        BRA $B74B
03/B73D: 29 40        AND #$40
03/B73F: D0 BE        BNE $B6FF
03/B741: 4C D6 B6     JMP $B6D6
03/B744: A9 05        LDA #$05
03/B746: 85 AB        STA $AB
03/B748: 20 31 BC     JSR $BC31
03/B74B: 60           RTS 

; [ get pointer to monster script ]

03/B74C: AD BE 35     LDA $35BE       ; monster script id
03/B74F: 85 DF        STA $DF
03/B751: A9 3C        LDA #$3C
03/B753: 85 E1        STA $E1
03/B755: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/B758: AD 1C 36     LDA $361C
03/B75B: 0A           ASL 
03/B75C: AA           TAX 
03/B75D: 18           CLC 
03/B75E: AD BF 35     LDA $35BF
03/B761: 65 E3        ADC $E3
03/B763: 9D 0C 36     STA $360C,X
03/B766: AD C0 35     LDA $35C0
03/B769: 65 E4        ADC $E4
03/B76B: 9D 0D 36     STA $360D,X
03/B76E: 60           RTS 

; [ change monster stat ]

03/B76F: A6 A6        LDX $A6
; $E8: creature type
03/B771: C9 E8        CMP #$E8
03/B773: D0 08        BNE $B77D
03/B775: A5 A9        LDA $A9
03/B777: 9D 40 20     STA $2040,X
03/B77A: 4C FE B7     JMP $B7FE
; $E9: attack
03/B77D: C9 E9        CMP #$E9
03/B77F: D0 18        BNE $B799
03/B781: A5 A9        LDA $A9
03/B783: 20 89 94     JSR $9489       ; load monster attack/defense values
03/B786: AD 1C 29     LDA $291C
03/B789: 9D 1B 20     STA $201B,X
03/B78C: AD 1D 29     LDA $291D
03/B78F: 9D 1C 20     STA $201C,X
03/B792: AD 1E 29     LDA $291E
03/B795: 9D 1D 20     STA $201D,X
03/B798: 60           RTS 
; $EA: defense
03/B799: C9 EA        CMP #$EA
03/B79B: D0 18        BNE $B7B5
03/B79D: A5 A9        LDA $A9
03/B79F: 20 89 94     JSR $9489       ; load monster attack/defense values
03/B7A2: AD 1C 29     LDA $291C
03/B7A5: 9D 28 20     STA $2028,X
03/B7A8: AD 1D 29     LDA $291D
03/B7AB: 9D 29 20     STA $2029,X
03/B7AE: AD 1E 29     LDA $291E
03/B7B1: 9D 2A 20     STA $202A,X
03/B7B4: 60           RTS 
; $EB: mag.def
03/B7B5: C9 EB        CMP #$EB
03/B7B7: D0 18        BNE $B7D1
03/B7B9: A5 A9        LDA $A9
03/B7BB: 20 89 94     JSR $9489       ; load monster attack/defense values
03/B7BE: AD 1C 29     LDA $291C
03/B7C1: 9D 22 20     STA $2022,X
03/B7C4: AD 1D 29     LDA $291D
03/B7C7: 9D 24 20     STA $2024,X
03/B7CA: AD 1E 29     LDA $291E
03/B7CD: 9D 24 20     STA $2024,X
03/B7D0: 60           RTS 
; $EC: speed modifier
03/B7D1: C9 EC        CMP #$EC
03/B7D3: D0 03        BNE $B7D8
03/B7D5: 4C FF B7     JMP $B7FF       ; apply speed modifier
; $ED: strong/immune elements
03/B7D8: C9 ED        CMP #$ED
03/B7DA: D0 0E        BNE $B7EA
03/B7DC: A5 A9        LDA $A9
03/B7DE: 9D 25 20     STA $2025,X
03/B7E1: 10 1B        BPL $B7FE       ; branch if not nullified
03/B7E3: 9D 26 20     STA $2026,X
03/B7E6: 9E 25 20     STZ $2025,X
03/B7E9: 60           RTS 
; $EE: intellect
03/B7EA: C9 EE        CMP #$EE
03/B7EC: D0 06        BNE $B7F4
03/B7EE: A5 A9        LDA $A9
03/B7F0: 9D 17 20     STA $2017,X
03/B7F3: 60           RTS 
; weak/very elements elements
03/B7F4: A5 A9        LDA $A9
03/B7F6: 10 03        BPL $B7FB       ; branch if not very weak
03/B7F8: 9D 21 20     STA $2021,X
03/B7FB: 9D 20 20     STA $2020,X
03/B7FE: 60           RTS 

; [ apply speed modifier ]

03/B7FF: DA           PHX 
03/B800: A5 A9        LDA $A9
03/B802: 8D 3D 39     STA $393D
03/B805: 9C 3E 39     STZ $393E
03/B808: BD 60 20     LDA $2060,X     ; multiply by base timer duration
03/B80B: 8D 3F 39     STA $393F
03/B80E: BD 61 20     LDA $2061,X
03/B811: 8D 40 39     STA $3940
03/B814: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/B817: AE 41 39     LDX $3941
03/B81A: 8E 3D 39     STX $393D
03/B81D: A2 64 00     LDX #$0064      ; multiply by 100
03/B820: 8E 3F 39     STX $393F
03/B823: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/B826: AE 41 39     LDX $3941
03/B829: 8E 45 39     STX $3945
03/B82C: A2 E8 03     LDX #$03E8      ; divide by 1000
03/B82F: 8E 47 39     STX $3947
03/B832: 20 07 84     JSR $8407       ; divide
03/B835: AD 49 39     LDA $3949
03/B838: 0D 4A 39     ORA $394A
03/B83B: D0 03        BNE $B840
03/B83D: EE 49 39     INC $3949       ; min 1
03/B840: FA           PLX 
03/B841: A5 A9        LDA $A9
03/B843: 30 14        BMI $B859       ; branch if negative speed
03/B845: 18           CLC 
03/B846: BD 60 20     LDA $2060,X     ; add to base timer duration
03/B849: 6D 49 39     ADC $3949
03/B84C: 9D 60 20     STA $2060,X
03/B84F: BD 61 20     LDA $2061,X
03/B852: 6D 4A 39     ADC $394A
03/B855: 9D 61 20     STA $2061,X
03/B858: 60           RTS 
03/B859: 38           SEC 
03/B85A: BD 60 20     LDA $2060,X
03/B85D: ED 49 39     SBC $3949
03/B860: 9D 60 20     STA $2060,X
03/B863: BD 61 20     LDA $2061,X
03/B866: ED 4A 39     SBC $394A
03/B869: 9D 61 20     STA $2061,X
03/B86C: B0 08        BCS $B876
03/B86E: A9 01        LDA #$01
03/B870: 9D 60 20     STA $2060,X
03/B873: 9E 61 20     STZ $2061,X
03/B876: 60           RTS 

; [ change battle variable ]

; $A9: aavvvvvv
;        a: 0 = add, 1 = subtract, 2/3 = set
;        v: value

03/B877: 38           SEC 
03/B878: E9 F4        SBC #$F4
03/B87A: A8           TAY 
03/B87B: A5 A9        LDA $A9
03/B87D: 48           PHA 
03/B87E: 29 3F        AND #$3F
03/B880: 85 A9        STA $A9
03/B882: 68           PLA 
; add
03/B883: 29 C0        AND #$C0
03/B885: D0 08        BNE $B88F
03/B887: 18           CLC 
03/B888: A5 A9        LDA $A9
03/B88A: 79 F3 35     ADC $35F3,Y
03/B88D: 80 0E        BRA $B89D
; subtract
03/B88F: 29 80        AND #$80
03/B891: D0 08        BNE $B89B
03/B893: 38           SEC 
03/B894: B9 F3 35     LDA $35F3,Y
03/B897: E5 A9        SBC $A9
03/B899: 80 02        BRA $B89D
; set
03/B89B: A5 A9        LDA $A9
03/B89D: 99 F3 35     STA $35F3,Y
03/B8A0: 60           RTS 

; [ choose monster target ]

03/B8A1: 86 88        STX $88
03/B8A3: AD 1C 36     LDA $361C
03/B8A6: AA           TAX 
03/B8A7: FE 79 38     INC $3879,X
03/B8AA: A6 A6        LDX $A6
03/B8AC: 9E 53 20     STZ $2053,X
03/B8AF: 9E 54 20     STZ $2054,X
03/B8B2: A5 A9        LDA $A9
03/B8B4: C9 16        CMP #$16
03/B8B6: 90 18        BCC $B8D0
03/B8B8: 38           SEC 
03/B8B9: E9 16        SBC #$16
03/B8BB: 0A           ASL 
03/B8BC: AA           TAX 
03/B8BD: BF B6 BB 03  LDA $03BBB6,X   ; monster target jump table
03/B8C1: 85 A9        STA $A9
03/B8C3: BF B7 BB 03  LDA $03BBB7,X
03/B8C7: 85 AA        STA $AA
03/B8C9: A9 03        LDA #$03
03/B8CB: 85 AB        STA $AB
03/B8CD: DC A9 00     JML [$00A9]
; monster target $00-$15: character id
03/B8D0: 7B           TDC 
03/B8D1: AA           TAX 
03/B8D2: A8           TAY 
03/B8D3: B9 40 35     LDA $3540,Y
03/B8D6: D0 1C        BNE $B8F4       ; branch if not present
03/B8D8: BD 00 20     LDA $2000,X
03/B8DB: 29 1F        AND #$1F
03/B8DD: C5 A9        CMP $A9
03/B8DF: D0 13        BNE $B8F4       ; branch if not the right character
03/B8E1: BD 03 20     LDA $2003,X
03/B8E4: 29 C0        AND #$C0
03/B8E6: D0 15        BNE $B8FD       ; branch if dead or stone
03/B8E8: BD 05 20     LDA $2005,X
03/B8EB: 29 82        AND #$82
03/B8ED: D0 0E        BNE $B8FD       ; branch if magnetized or jumping
03/B8EF: BD 06 20     LDA $2006,X
03/B8F2: 10 0C        BPL $B900       ; branch if not hiding
03/B8F4: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/B8F7: C8           INY 
03/B8F8: C0 05 00     CPY #$0005
03/B8FB: D0 D6        BNE $B8D3
03/B8FD: 4C 79 BB     JMP $BB79
03/B900: A6 A6        LDX $A6
03/B902: 38           SEC 
03/B903: 7E 54 20     ROR $2054,X     ; set target
03/B906: 88           DEY 
03/B907: 10 FA        BPL $B903
03/B909: 60           RTS 
; monster target $16: self
03/B90A: AD 1C 36     LDA $361C
03/B90D: A8           TAY 
03/B90E: A6 A6        LDX $A6
03/B910: 38           SEC 
03/B911: 7E 53 20     ROR $2053,X
03/B914: 88           DEY 
03/B915: 10 FA        BPL $B911
03/B917: 60           RTS 
; monster target $17: all monsters
03/B918: A6 A6        LDX $A6
03/B91A: A9 FF        LDA #$FF
03/B91C: 9D 53 20     STA $2053,X
03/B91F: 60           RTS 
; monster target $18: all monsters (not self)
03/B920: AD CD 29     LDA $29CD
03/B923: 3A           DEC 
03/B924: D0 03        BNE $B929
03/B926: 4C 79 BB     JMP $BB79
03/B929: AD 1C 36     LDA $361C
03/B92C: AA           TAX 
03/B92D: A9 FF        LDA #$FF
03/B92F: 20 5A 85     JSR $855A       ; clear bit
03/B932: A6 A6        LDX $A6
03/B934: 9D 53 20     STA $2053,X
03/B937: 60           RTS 
; monster target $19: all monster type 1
03/B938: A9 00        LDA #$00
03/B93A: 4C 3D B9     JMP $B93D
03/B93D: 85 A9        STA $A9
03/B93F: 7B           TDC 
03/B940: AA           TAX 
03/B941: 86 AB        STX $AB
03/B943: BD B5 29     LDA $29B5,X
03/B946: C5 A9        CMP $A9
03/B948: D0 07        BNE $B951
03/B94A: A5 AB        LDA $AB
03/B94C: 20 5F 85     JSR $855F       ; set bit
03/B94F: 85 AB        STA $AB
03/B951: E8           INX 
03/B952: E0 08 00     CPX #$0008
03/B955: D0 EC        BNE $B943
03/B957: A6 A6        LDX $A6
03/B959: A5 AB        LDA $AB
03/B95B: D0 03        BNE $B960
03/B95D: 4C 79 BB     JMP $BB79
03/B960: 9D 53 20     STA $2053,X
03/B963: 60           RTS 
; monster target $1A: all monster type 2
03/B964: A9 01        LDA #$01
03/B966: 4C 3D B9     JMP $B93D
; monster target $1B: all monster type 3
03/B969: A9 02        LDA #$02
03/B96B: 4C 3D B9     JMP $B93D
; monster target $1C: all front row characters
03/B96E: 20 7E B9     JSR $B97E       ; get front row characters
03/B971: A6 A6        LDX $A6
03/B973: A5 AB        LDA $AB
03/B975: D0 03        BNE $B97A
03/B977: 4C 79 BB     JMP $BB79
03/B97A: 9D 54 20     STA $2054,X
03/B97D: 60           RTS 

; [ get front row characters ]

; $AB: front row characters mask (out)

03/B97E: 7B           TDC 
03/B97F: AA           TAX 
03/B980: A8           TAY 
03/B981: 86 AB        STX $AB
03/B983: BD 40 35     LDA $3540,X
03/B986: D0 1F        BNE $B9A7       ; branch if not present
03/B988: B9 03 20     LDA $2003,Y
03/B98B: 29 C0        AND #$C0
03/B98D: D0 18        BNE $B9A7       ; branch if dead or stone
03/B98F: B9 05 20     LDA $2005,Y
03/B992: 29 82        AND #$82
03/B994: D0 11        BNE $B9A7       ; branch if magnetized or jumping
03/B996: B9 06 20     LDA $2006,Y
03/B999: 30 0C        BMI $B9A7       ; branch if hiding
03/B99B: B9 01 20     LDA $2001,Y
03/B99E: 30 07        BMI $B9A7       ; branch if back row
03/B9A0: A5 AB        LDA $AB
03/B9A2: 20 5F 85     JSR $855F       ; set bit
03/B9A5: 85 AB        STA $AB
03/B9A7: C2 20        REP #$20
03/B9A9: 98           TYA 
03/B9AA: 18           CLC 
03/B9AB: 69 80 00     ADC #$0080
03/B9AE: A8           TAY 
03/B9AF: 7B           TDC 
03/B9B0: E2 20        SEP #$20
03/B9B2: E8           INX 
03/B9B3: E0 05 00     CPX #$0005
03/B9B6: D0 CB        BNE $B983
03/B9B8: 60           RTS 

; monster target $1D: all back row characters
03/B9B9: 20 C9 B9     JSR $B9C9       ; get back row characters
03/B9BC: A6 A6        LDX $A6
03/B9BE: A5 AB        LDA $AB
03/B9C0: D0 03        BNE $B9C5
03/B9C2: 4C 79 BB     JMP $BB79
03/B9C5: 9D 54 20     STA $2054,X
03/B9C8: 60           RTS 

; [ get back row characters ]

03/B9C9: 7B           TDC 
03/B9CA: AA           TAX 
03/B9CB: A8           TAY 
03/B9CC: 86 AB        STX $AB
03/B9CE: BD 40 35     LDA $3540,X
03/B9D1: D0 1F        BNE $B9F2
03/B9D3: B9 03 20     LDA $2003,Y
03/B9D6: 29 C0        AND #$C0
03/B9D8: D0 18        BNE $B9F2
03/B9DA: B9 05 20     LDA $2005,Y
03/B9DD: 29 82        AND #$82
03/B9DF: D0 11        BNE $B9F2
03/B9E1: B9 06 20     LDA $2006,Y
03/B9E4: 30 0C        BMI $B9F2
03/B9E6: B9 01 20     LDA $2001,Y
03/B9E9: 10 07        BPL $B9F2
03/B9EB: A5 AB        LDA $AB
03/B9ED: 20 5F 85     JSR $855F       ; set bit
03/B9F0: 85 AB        STA $AB
03/B9F2: C2 20        REP #$20
03/B9F4: 98           TYA 
03/B9F5: 18           CLC 
03/B9F6: 69 80 00     ADC #$0080
03/B9F9: A8           TAY 
03/B9FA: 7B           TDC 
03/B9FB: E2 20        SEP #$20
03/B9FD: E8           INX 
03/B9FE: E0 05 00     CPX #$0005
03/BA01: D0 CB        BNE $B9CE
03/BA03: 60           RTS 

; monster target $1E: paralyzed monster
03/BA04: A9 20        LDA #$20
03/BA06: 85 AD        STA $AD
03/BA08: 64 AE        STZ $AE
03/BA0A: 64 AF        STZ $AF
03/BA0C: 64 B0        STZ $B0
03/BA0E: 4C 11 BA     JMP $BA11

; [ get monster with status ]

03/BA11: A0 80 02     LDY #$0280
03/BA14: 7B           TDC 
03/BA15: AA           TAX 
03/BA16: 86 AB        STX $AB
03/BA18: 86 A9        STX $A9
03/BA1A: 18           CLC 
03/BA1B: A5 A9        LDA $A9
03/BA1D: 69 05        ADC #$05
03/BA1F: AA           TAX 
03/BA20: BD 40 35     LDA $3540,X
03/BA23: D0 22        BNE $BA47       ; branch if not present
03/BA25: B9 03 20     LDA $2003,Y
03/BA28: 25 AF        AND $AF
03/BA2A: D0 0E        BNE $BA3A       ; branch if status 1 matches
03/BA2C: B9 04 20     LDA $2004,Y
03/BA2F: 25 AD        AND $AD
03/BA31: D0 07        BNE $BA3A       ; branch if status 2 matches
03/BA33: B9 06 20     LDA $2006,Y
03/BA36: 25 AE        AND $AE
03/BA38: F0 0D        BEQ $BA47       ; branch if status 3 doesn't match
03/BA3A: A6 A9        LDX $A9
03/BA3C: A5 AB        LDA $AB
03/BA3E: 20 5F 85     JSR $855F       ; set bit
03/BA41: 85 AB        STA $AB
03/BA43: A5 B0        LDA $B0
03/BA45: F0 13        BEQ $BA5A
03/BA47: C2 20        REP #$20        ; next monster
03/BA49: 98           TYA 
03/BA4A: 18           CLC 
03/BA4B: 69 80 00     ADC #$0080
03/BA4E: A8           TAY 
03/BA4F: 7B           TDC 
03/BA50: E2 20        SEP #$20
03/BA52: E6 A9        INC $A9
03/BA54: A5 A9        LDA $A9
03/BA56: C9 08        CMP #$08
03/BA58: D0 C0        BNE $BA1A
03/BA5A: A6 A6        LDX $A6
03/BA5C: A5 AB        LDA $AB
03/BA5E: D0 03        BNE $BA63
03/BA60: 4C 79 BB     JMP $BB79
03/BA63: 9D 53 20     STA $2053,X
03/BA66: 60           RTS 

; monster target $1F: sleeping monster
03/BA67: A9 10        LDA #$10
03/BA69: 85 AD        STA $AD
03/BA6B: 64 AE        STZ $AE
03/BA6D: 64 AF        STZ $AF
03/BA6F: 64 B0        STZ $B0
03/BA71: 4C 11 BA     JMP $BA11
; monster target $20: charmed monster
03/BA74: A9 08        LDA #$08
03/BA76: 85 AD        STA $AD
03/BA78: 64 AE        STZ $AE
03/BA7A: 64 AF        STZ $AF
03/BA7C: 64 B0        STZ $B0
03/BA7E: 4C 11 BA     JMP $BA11
; monster target $21: critical monster
03/BA81: 64 AD        STZ $AD
03/BA83: A9 01        LDA #$01
03/BA85: 85 AE        STA $AE
03/BA87: 64 AF        STZ $AF
03/BA89: 64 B0        STZ $B0
03/BA8B: 4C 11 BA     JMP $BA11
; monster target $22: random character or monster
03/BA8E: A9 0C        LDA #$0C
03/BA90: 85 B0        STA $B0
03/BA92: A9 00        LDA #$00
03/BA94: 85 AF        STA $AF
03/BA96: 3A           DEC 
03/BA97: 85 AD        STA $AD
03/BA99: 4C 9C BA     JMP $BA9C

; [  ]

03/BA9C: A5 AF        LDA $AF
03/BA9E: AA           TAX 
03/BA9F: A5 B0        LDA $B0
03/BAA1: 20 79 83     JSR $8379       ; random (X..A)
03/BAA4: C5 AD        CMP $AD
03/BAA6: F0 F4        BEQ $BA9C
03/BAA8: 85 A9        STA $A9
03/BAAA: AA           TAX 
03/BAAB: BD 40 35     LDA $3540,X
03/BAAE: D0 EC        BNE $BA9C
03/BAB0: 8A           TXA 
03/BAB1: 85 DF        STA $DF
03/BAB3: A9 80        LDA #$80
03/BAB5: 85 E1        STA $E1
03/BAB7: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/BABA: A6 E3        LDX $E3
03/BABC: BD 03 20     LDA $2003,X
03/BABF: 29 C0        AND #$C0
03/BAC1: D0 D9        BNE $BA9C
03/BAC3: BD 05 20     LDA $2005,X
03/BAC6: 29 82        AND #$82
03/BAC8: D0 D2        BNE $BA9C
03/BACA: BD 06 20     LDA $2006,X
03/BACD: 30 CD        BMI $BA9C
03/BACF: A5 A9        LDA $A9
03/BAD1: C9 05        CMP #$05
03/BAD3: B0 0C        BCS $BAE1
03/BAD5: AA           TAX 
03/BAD6: 7B           TDC 
03/BAD7: 20 5F 85     JSR $855F       ; set bit
03/BADA: A6 A6        LDX $A6
03/BADC: 9D 54 20     STA $2054,X
03/BADF: 80 0D        BRA $BAEE
03/BAE1: 38           SEC 
03/BAE2: E9 05        SBC #$05
03/BAE4: AA           TAX 
03/BAE5: 7B           TDC 
03/BAE6: 20 5F 85     JSR $855F       ; set bit
03/BAE9: A6 A6        LDX $A6
03/BAEB: 9D 53 20     STA $2053,X
03/BAEE: 60           RTS 

; monster target $23: random character or monster (not self)
03/BAEF: A9 00        LDA #$00
03/BAF1: 85 AF        STA $AF
03/BAF3: A9 0C        LDA #$0C
03/BAF5: 85 B0        STA $B0
03/BAF7: A5 D2        LDA $D2
03/BAF9: 85 AD        STA $AD
03/BAFB: 4C 9C BA     JMP $BA9C
; monster target $24: random monster
03/BAFE: A9 05        LDA #$05
03/BB00: 85 AF        STA $AF
03/BB02: A9 0C        LDA #$0C
03/BB04: 85 B0        STA $B0
03/BB06: A9 FF        LDA #$FF
03/BB08: 85 AD        STA $AD
03/BB0A: 4C 9C BA     JMP $BA9C
; monster target $25: random monster (not self)
03/BB0D: AD CD 29     LDA $29CD
03/BB10: 3A           DEC 
03/BB11: D0 03        BNE $BB16
03/BB13: 4C 79 BB     JMP $BB79
03/BB16: A9 05        LDA #$05
03/BB18: 85 AF        STA $AF
03/BB1A: A9 0C        LDA #$0C
03/BB1C: 85 B0        STA $B0
03/BB1E: A5 D2        LDA $D2
03/BB20: 85 AD        STA $AD
03/BB22: 4C 9C BA     JMP $BA9C
; monster target $26: random front row character
03/BB25: 20 7E B9     JSR $B97E       ; get front row characters
03/BB28: A5 AB        LDA $AB
03/BB2A: D0 03        BNE $BB2F
03/BB2C: 4C 79 BB     JMP $BB79
03/BB2F: 20 82 85     JSR $8582       ; choose a random character
03/BB32: AA           TAX 
03/BB33: A5 AB        LDA $AB
03/BB35: 20 64 85     JSR $8564       ; test bit
03/BB38: F0 F5        BEQ $BB2F
03/BB3A: 7B           TDC 
03/BB3B: 20 5F 85     JSR $855F       ; set bit
03/BB3E: A6 A6        LDX $A6
03/BB40: 9D 54 20     STA $2054,X
03/BB43: 60           RTS 
; monster target $27: random back row character
03/BB44: 20 C9 B9     JSR $B9C9       ; get back row characters
03/BB47: A5 AB        LDA $AB
03/BB49: D0 03        BNE $BB4E
03/BB4B: 4C 79 BB     JMP $BB79
03/BB4E: 20 82 85     JSR $8582       ; choose a random character
03/BB51: AA           TAX 
03/BB52: A5 AB        LDA $AB
03/BB54: 20 64 85     JSR $8564       ; test bit
03/BB57: F0 F5        BEQ $BB4E
03/BB59: 7B           TDC 
03/BB5A: 20 5F 85     JSR $855F       ; set bit
03/BB5D: A6 A6        LDX $A6
03/BB5F: 9D 54 20     STA $2054,X
03/BB62: 60           RTS 
; monster target $28: all characters
03/BB63: A6 A6        LDX $A6
03/BB65: A9 F8        LDA #$F8
03/BB67: 9D 54 20     STA $2054,X
03/BB6A: 60           RTS 
; monster target $29: all dead monsters
03/BB6B: 64 AD        STZ $AD
03/BB6D: 64 AE        STZ $AE
03/BB6F: A9 80        LDA #$80
03/BB71: 85 AF        STA $AF
03/BB73: 85 B0        STA $B0
03/BB75: 4C 11 BA     JMP $BA11
; unused
03/BB78: 60           RTS 

; [  ]

03/BB79: AD B3 38     LDA $38B3
03/BB7C: F0 19        BEQ $BB97
03/BB7E: 20 31 C4     JSR $C431
03/BB81: A5 A9        LDA $A9
03/BB83: D0 29        BNE $BBAE
03/BB85: AE BB 38     LDX $38BB
03/BB88: A9 E1        LDA #$E1        ; do nothing
03/BB8A: 9D 59 36     STA $3659,X
03/BB8D: 7B           TDC 
03/BB8E: 9D 5A 36     STA $365A,X
03/BB91: 3A           DEC 
03/BB92: 9D 5B 36     STA $365B,X
03/BB95: 80 17        BRA $BBAE
03/BB97: A6 88        LDX $88
03/BB99: E8           INX 
03/BB9A: 20 5E C4     JSR $C45E
03/BB9D: A5 A9        LDA $A9
03/BB9F: D0 0D        BNE $BBAE
03/BBA1: A9 E1        LDA #$E1        ; do nothing
03/BBA3: 9D 39 38     STA $3839,X
03/BBA6: 7B           TDC 
03/BBA7: 9D 3A 38     STA $383A,X
03/BBAA: 3A           DEC 
03/BBAB: 9D 3B 38     STA $383B,X
03/BBAE: A9 E1        LDA #$E1        ; do nothing
03/BBB0: A6 A6        LDX $A6
03/BBB2: 9D 51 20     STA $2051,X
03/BBB5: 60           RTS 

; monster target jump table
03/BBB6: B90A B918 B920 B938 B964 B969 B96E B9B9
03/BBC6: BA04 BA67 BA74 BA81 BA8E BAEF BAFE BB0D
03/BBD6: BB25 BB44 BB63 BB6B

; [ init monster action delay ]

03/BBDE: A9 02        LDA #$02        ; immediate
03/BBE0: 85 D6        STA $D6
03/BBE2: A5 D2        LDA $D2
03/BBE4: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/BBE7: A9 03        LDA #$03        ; action timer
03/BBE9: 20 C8 85     JSR $85C8       ; set timer
03/BBEC: A9 08        LDA #$08
03/BBEE: 9D 06 2A     STA $2A06,X     ; use battle command when timer expires
03/BBF1: 60           RTS 

; [ init monster graphics script ]

03/BBF2: 38           SEC 
03/BBF3: A5 D2        LDA $D2
03/BBF5: E9 05        SBC #$05
03/BBF7: 85 DF        STA $DF
03/BBF9: A9 3C        LDA #$3C
03/BBFB: 85 E1        STA $E1
03/BBFD: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/BC00: A0 3C 00     LDY #$003C
03/BC03: A6 E3        LDX $E3
03/BC05: 8E BB 38     STX $38BB
03/BC08: A9 FF        LDA #$FF
03/BC0A: 9D 59 36     STA $3659,X
03/BC0D: E8           INX 
03/BC0E: 88           DEY 
03/BC0F: D0 F9        BNE $BC0A
03/BC11: 60           RTS 

; [ clear graphics script buffer ]

03/BC12: A2 3B 00     LDX #$003B
03/BC15: A9 FF        LDA #$FF
03/BC17: 9D 39 38     STA $3839,X
03/BC1A: CA           DEX 
03/BC1B: 10 FA        BPL $BC17
03/BC1D: 60           RTS 

; [ copy monster graphic script from buffer ]

03/BC1E: AE BB 38     LDX $38BB
03/BC21: 7B           TDC 
03/BC22: A8           TAY 
03/BC23: B9 39 38     LDA $3839,Y
03/BC26: 9D 59 36     STA $3659,X
03/BC29: E8           INX 
03/BC2A: C8           INY 
03/BC2B: C0 3C 00     CPY #$003C
03/BC2E: D0 F3        BNE $BC23
03/BC30: 60           RTS 

; [  ]

03/BC31: A5 AB        LDA $AB
03/BC33: C9 08        CMP #$08
03/BC35: F0 4C        BEQ $BC83
03/BC37: 7B           TDC 
03/BC38: AA           TAX 
03/BC39: A8           TAY 
03/BC3A: 86 A9        STX $A9
03/BC3C: B9 40 35     LDA $3540,Y
03/BC3F: D0 17        BNE $BC58
03/BC41: BD 03 20     LDA $2003,X
03/BC44: 29 C0        AND #$C0
03/BC46: D0 10        BNE $BC58
03/BC48: BD 05 20     LDA $2005,X
03/BC4B: 29 82        AND #$82
03/BC4D: D0 09        BNE $BC58
03/BC4F: BD 06 20     LDA $2006,X
03/BC52: 30 04        BMI $BC58
03/BC54: E6 A9        INC $A9
03/BC56: 80 09        BRA $BC61
03/BC58: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/BC5B: C8           INY 
03/BC5C: C0 05 00     CPY #$0005
03/BC5F: D0 DB        BNE $BC3C
03/BC61: A5 A9        LDA $A9
03/BC63: D0 1E        BNE $BC83
03/BC65: 7B           TDC 
03/BC66: AA           TAX 
03/BC67: 20 5E C4     JSR $C45E
03/BC6A: A5 A9        LDA $A9
03/BC6C: D0 14        BNE $BC82
03/BC6E: A9 E1        LDA #$E1
03/BC70: 8D 39 38     STA $3839
03/BC73: 7B           TDC 
03/BC74: 8D 3A 38     STA $383A
03/BC77: 3A           DEC 
03/BC78: 8D 3B 38     STA $383B
03/BC7B: A9 E1        LDA #$E1
03/BC7D: A6 A6        LDX $A6
03/BC7F: 9D 51 20     STA $2051,X
03/BC82: 60           RTS 
03/BC83: 64 AD        STZ $AD
03/BC85: A5 AB        LDA $AB
03/BC87: C9 08        CMP #$08
03/BC89: D0 02        BNE $BC8D
03/BC8B: E6 AD        INC $AD
03/BC8D: A2 01 00     LDX #$0001
03/BC90: A5 AB        LDA $AB
03/BC92: 20 79 83     JSR $8379       ; random (X..A)
03/BC95: 3A           DEC 
03/BC96: 85 A9        STA $A9
03/BC98: A5 AD        LDA $AD
03/BC9A: F0 07        BEQ $BCA3
03/BC9C: 18           CLC 
03/BC9D: A5 A9        LDA $A9
03/BC9F: 69 05        ADC #$05
03/BCA1: 80 02        BRA $BCA5
03/BCA3: A5 A9        LDA $A9
03/BCA5: 0A           ASL 
03/BCA6: A8           TAY 
03/BCA7: B9 EB 29     LDA $29EB,Y
03/BCAA: F0 E1        BEQ $BC8D
03/BCAC: A5 A9        LDA $A9
03/BCAE: A8           TAY 
03/BCAF: C8           INY 
03/BCB0: A6 A6        LDX $A6
03/BCB2: 9E 54 20     STZ $2054,X
03/BCB5: 9E 53 20     STZ $2053,X
03/BCB8: A5 AB        LDA $AB
03/BCBA: C9 08        CMP #$08
03/BCBC: F0 08        BEQ $BCC6
03/BCBE: 38           SEC 
03/BCBF: 7E 54 20     ROR $2054,X
03/BCC2: 88           DEY 
03/BCC3: D0 FA        BNE $BCBF
03/BCC5: 60           RTS 
03/BCC6: 38           SEC 
03/BCC7: 7E 53 20     ROR $2053,X
03/BCCA: 88           DEY 
03/BCCB: D0 FA        BNE $BCC7
03/BCCD: 60           RTS 

; [ check monster condition ]

03/BCCE: 64 DE        STZ $DE
03/BCD0: AD 9C 28     LDA $289C
03/BCD3: 0A           ASL 
03/BCD4: AA           TAX 
03/BCD5: BF F4 C0 03  LDA $03C0F4,X   ; monster condition jump table
03/BCD9: 85 80        STA $80
03/BCDB: BF F5 C0 03  LDA $03C0F5,X
03/BCDF: 85 81        STA $81
03/BCE1: A9 03        LDA #$03
03/BCE3: 85 82        STA $82
03/BCE5: DC 80 00     JML [$0080]

; monster condition $00: target status
03/BCE8: 20 0F BF     JSR $BF0F       ; get monster condition target
03/BCEB: A5 DD        LDA $DD
03/BCED: F0 4D        BEQ $BD3C
03/BCEF: 18           CLC 
03/BCF0: A9 03        LDA #$03
03/BCF2: 6D 9E 28     ADC $289E
03/BCF5: 85 80        STA $80
03/BCF7: A9 20        LDA #$20
03/BCF9: 69 00        ADC #$00
03/BCFB: 85 81        STA $81
03/BCFD: 7B           TDC 
03/BCFE: AA           TAX 
03/BCFF: BD D0 35     LDA $35D0,X
03/BD02: 85 A9        STA $A9
03/BD04: BD D1 35     LDA $35D1,X
03/BD07: 85 AA        STA $AA
03/BD09: A4 A9        LDY $A9
03/BD0B: C0 FF FF     CPY #$FFFF
03/BD0E: F0 18        BEQ $BD28
03/BD10: B2 80        LDA ($80)
03/BD12: 2D 9F 28     AND $289F
03/BD15: D0 08        BNE $BD1F
03/BD17: AD 9D 28     LDA $289D
03/BD1A: 10 0C        BPL $BD28
03/BD1C: 64 DE        STZ $DE
03/BD1E: 60           RTS 
03/BD1F: A9 01        LDA #$01
03/BD21: 85 DE        STA $DE
03/BD23: AD 9D 28     LDA $289D
03/BD26: 10 14        BPL $BD3C
03/BD28: C2 20        REP #$20
03/BD2A: 18           CLC 
03/BD2B: A5 80        LDA $80
03/BD2D: 69 80 00     ADC #$0080
03/BD30: 85 80        STA $80
03/BD32: 7B           TDC 
03/BD33: E2 20        SEP #$20
03/BD35: E8           INX 
03/BD36: E8           INX 
03/BD37: E0 1A 00     CPX #$001A
03/BD3A: D0 C3        BNE $BCFF
03/BD3C: 60           RTS 
; monster condition $01: target hp
03/BD3D: 20 0F BF     JSR $BF0F       ; get monster condition target
03/BD40: A5 DD        LDA $DD
03/BD42: F0 64        BEQ $BDA8
03/BD44: AD 9F 28     LDA $289F
03/BD47: 0A           ASL 
03/BD48: AA           TAX 
03/BD49: BF 00 E0 0E  LDA $0EE000,X
03/BD4D: 85 AD        STA $AD
03/BD4F: BF 01 E0 0E  LDA $0EE001,X
03/BD53: 85 AE        STA $AE
03/BD55: 7B           TDC 
03/BD56: AA           TAX 
03/BD57: 86 A9        STX $A9
03/BD59: A5 A9        LDA $A9
03/BD5B: 0A           ASL 
03/BD5C: A8           TAY 
03/BD5D: B9 D0 35     LDA $35D0,Y
03/BD60: 85 AB        STA $AB
03/BD62: B9 D1 35     LDA $35D1,Y
03/BD65: 85 AC        STA $AC
03/BD67: A4 AB        LDY $AB
03/BD69: C0 FF FF     CPY #$FFFF
03/BD6C: F0 2F        BEQ $BD9D
03/BD6E: C2 20        REP #$20
03/BD70: A5 AD        LDA $AD
03/BD72: C9 FF FF     CMP #$FFFF
03/BD75: D0 0A        BNE $BD81
03/BD77: BD 07 20     LDA $2007,X
03/BD7A: DD 09 20     CMP $2009,X
03/BD7D: D0 14        BNE $BD93
03/BD7F: F0 07        BEQ $BD88
03/BD81: A5 AD        LDA $AD
03/BD83: DD 07 20     CMP $2007,X
03/BD86: B0 0B        BCS $BD93
03/BD88: 7B           TDC 
03/BD89: E2 20        SEP #$20
03/BD8B: AD 9D 28     LDA $289D
03/BD8E: 10 0D        BPL $BD9D
03/BD90: 64 DE        STZ $DE
03/BD92: 60           RTS 
03/BD93: 7B           TDC 
03/BD94: E2 20        SEP #$20
03/BD96: E6 DE        INC $DE
03/BD98: AD 9D 28     LDA $289D
03/BD9B: 10 0B        BPL $BDA8
03/BD9D: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/BDA0: E6 A9        INC $A9
03/BDA2: A5 A9        LDA $A9
03/BDA4: C9 0D        CMP #$0D
03/BDA6: D0 B1        BNE $BD59
03/BDA8: 60           RTS 
; monster condition $02: battle variable
03/BDA9: AD 9E 28     LDA $289E
03/BDAC: AA           TAX 
03/BDAD: BD F3 35     LDA $35F3,X
03/BDB0: CD 9F 28     CMP $289F
03/BDB3: D0 02        BNE $BDB7
03/BDB5: E6 DE        INC $DE
03/BDB7: 60           RTS 
; monster condition $03: target valid
03/BDB8: 20 0F BF     JSR $BF0F       ; get monster condition target
03/BDBB: AD 9E 28     LDA $289E
03/BDBE: D0 06        BNE $BDC6
03/BDC0: A5 DD        LDA $DD
03/BDC2: D0 29        BNE $BDED
03/BDC4: F0 29        BEQ $BDEF
03/BDC6: AD 9E 28     LDA $289E
03/BDC9: 3A           DEC 
03/BDCA: D0 06        BNE $BDD2
03/BDCC: A5 DD        LDA $DD
03/BDCE: F0 1D        BEQ $BDED
03/BDD0: D0 1D        BNE $BDEF
03/BDD2: A5 DD        LDA $DD
03/BDD4: F0 19        BEQ $BDEF
03/BDD6: 7B           TDC 
03/BDD7: AA           TAX 
03/BDD8: 86 A9        STX $A9
03/BDDA: BD EB 29     LDA $29EB,X
03/BDDD: F0 02        BEQ $BDE1
03/BDDF: E6 A9        INC $A9
03/BDE1: E8           INX 
03/BDE2: E8           INX 
03/BDE3: E0 0A 00     CPX #$000A
03/BDE6: D0 F2        BNE $BDDA
03/BDE8: A5 A9        LDA $A9
03/BDEA: 3A           DEC 
03/BDEB: D0 02        BNE $BDEF
03/BDED: E6 DE        INC $DE
03/BDEF: 60           RTS 
; monster condition $04: monster type
03/BDF0: 7B           TDC 
03/BDF1: AA           TAX 
03/BDF2: 86 A9        STX $A9
03/BDF4: AD 9F 28     LDA $289F
03/BDF7: DD AD 29     CMP $29AD,X
03/BDFA: F0 0A        BEQ $BE06
03/BDFC: E8           INX 
03/BDFD: E0 03 00     CPX #$0003
03/BE00: D0 F2        BNE $BDF4
03/BE02: E6 A9        INC $A9
03/BE04: 80 0E        BRA $BE14
03/BE06: BD CA 29     LDA $29CA,X
03/BE09: F0 F7        BEQ $BE02
03/BE0B: CD CD 29     CMP $29CD
03/BE0E: D0 04        BNE $BE14
03/BE10: E6 A9        INC $A9
03/BE12: E6 A9        INC $A9
03/BE14: AD 9E 28     LDA $289E
03/BE17: C5 A9        CMP $A9
03/BE19: D0 02        BNE $BE1D
03/BE1B: E6 DE        INC $DE
03/BE1D: 60           RTS 
; monster condition $05: battle id
03/BE1E: AD 9E 28     LDA $289E
03/BE21: CD 01 18     CMP $1801
03/BE24: D0 0A        BNE $BE30
03/BE26: AD 9F 28     LDA $289F
03/BE29: CD 00 18     CMP $1800
03/BE2C: D0 02        BNE $BE30
03/BE2E: E6 DE        INC $DE
03/BE30: 60           RTS 
; monster condition $06: only monster type remaining
03/BE31: 38           SEC 
03/BE32: A5 D2        LDA $D2
03/BE34: E9 05        SBC #$05
03/BE36: AA           TAX 
03/BE37: BD B5 29     LDA $29B5,X
03/BE3A: AA           TAX 
03/BE3B: BD CA 29     LDA $29CA,X
03/BE3E: CD CD 29     CMP $29CD
03/BE41: D0 02        BNE $BE45
03/BE43: E6 DE        INC $DE
03/BE45: 60           RTS 
; monster condition $07: attacked by character/monster slot
03/BE46: 38           SEC 
03/BE47: A5 D2        LDA $D2
03/BE49: E9 05        SBC #$05
03/BE4B: AA           TAX 
03/BE4C: 20 7C 84     JSR $847C       ; asl5
03/BE4F: 85 A9        STA $A9
03/BE51: BD F7 35     LDA $35F7,X     ; retaliation stack size
03/BE54: C9 FF        CMP #$FF
03/BE56: F0 47        BEQ $BE9F       ; branch if retaliation stack is empty
03/BE58: 20 7F 84     JSR $847F       ; asl2
03/BE5B: 18           CLC 
03/BE5C: 65 A9        ADC $A9
03/BE5E: AA           TAX 
03/BE5F: 7B           TDC 
03/BE60: A8           TAY 
03/BE61: BD 78 2B     LDA $2B78,X     ; copy previous attack data to buffer
03/BE64: 99 1C 29     STA $291C,Y
03/BE67: E8           INX 
03/BE68: C8           INY 
03/BE69: C0 04 00     CPY #$0004
03/BE6C: D0 F3        BNE $BE61
03/BE6E: 20 0F BF     JSR $BF0F       ; get monster condition target
03/BE71: A5 DD        LDA $DD
03/BE73: F0 2A        BEQ $BE9F
03/BE75: AD 1C 29     LDA $291C       ; previous attacker
03/BE78: 10 05        BPL $BE7F       ; branch if character attacker
03/BE7A: 29 7F        AND #$7F
03/BE7C: 18           CLC 
03/BE7D: 69 05        ADC #$05
03/BE7F: 0A           ASL 
03/BE80: AA           TAX 
03/BE81: BD D0 35     LDA $35D0,X
03/BE84: 3D D1 35     AND $35D1,X
03/BE87: C9 FF        CMP #$FF
03/BE89: F0 14        BEQ $BE9F
03/BE8B: AD 9E 28     LDA $289E
03/BE8E: CD 1D 29     CMP $291D
03/BE91: D0 0C        BNE $BE9F       ; branch if command doesn't match
03/BE93: AD 9F 28     LDA $289F
03/BE96: F0 05        BEQ $BE9D       ; branch if element doesn't matter
03/BE98: 2D 1F 29     AND $291F
03/BE9B: F0 02        BEQ $BE9F       ; branch if element doesn't match
03/BE9D: E6 DE        INC $DE
03/BE9F: 60           RTS 
; monster condition $08: attacked with command
03/BEA0: 38           SEC 
03/BEA1: A5 D2        LDA $D2
03/BEA3: E9 05        SBC #$05
03/BEA5: 20 7C 84     JSR $847C       ; asl5
03/BEA8: AA           TAX 
03/BEA9: 7B           TDC 
03/BEAA: A8           TAY 
03/BEAB: BD 78 2B     LDA $2B78,X     ; copy previous attack data to buffer
03/BEAE: 99 1C 29     STA $291C,Y
03/BEB1: E8           INX 
03/BEB2: C8           INY 
03/BEB3: C0 20 00     CPY #$0020
03/BEB6: D0 F3        BNE $BEAB
03/BEB8: 7B           TDC 
03/BEB9: AA           TAX 
03/BEBA: AD 9E 28     LDA $289E
03/BEBD: DD 1D 29     CMP $291D,X
03/BEC0: F0 0A        BEQ $BECC       ; branch if command matches
03/BEC2: E8           INX 
03/BEC3: E8           INX 
03/BEC4: E8           INX 
03/BEC5: E8           INX 
03/BEC6: E0 20 00     CPX #$0020
03/BEC9: D0 EF        BNE $BEBA
03/BECB: 60           RTS 
03/BECC: 7B           TDC 
03/BECD: AD 9F 28     LDA $289F
03/BED0: F0 0F        BEQ $BEE1       ; branch if element doesn't matter
03/BED2: 3D 1F 29     AND $291F,X
03/BED5: D0 0A        BNE $BEE1       ; branch if element matches
03/BED7: E8           INX 
03/BED8: E8           INX 
03/BED9: E8           INX 
03/BEDA: E8           INX 
03/BEDB: E0 20 00     CPX #$0020
03/BEDE: D0 ED        BNE $BECD
03/BEE0: 60           RTS 
03/BEE1: E6 DE        INC $DE
03/BEE3: 60           RTS 
; monster condition $09: party used escape
03/BEE4: AD D3 38     LDA $38D3
03/BEE7: F0 02        BEQ $BEEB
03/BEE9: E6 DE        INC $DE
03/BEEB: 60           RTS 
; monster condition $0A: took damage
03/BEEC: 38           SEC 
03/BEED: A5 D2        LDA $D2
03/BEEF: E9 05        SBC #$05
03/BEF1: 0A           ASL 
03/BEF2: AA           TAX 
03/BEF3: BD D4 34     LDA $34D4,X     ; damage taken
03/BEF6: 1D D5 34     ORA $34D5,X
03/BEF9: F0 09        BEQ $BF04
03/BEFB: BD D5 34     LDA $34D5,X
03/BEFE: 29 C0        AND #$C0
03/BF00: D0 02        BNE $BF04       ; branch if mp damage or hp restored
03/BF02: E6 DE        INC $DE
03/BF04: 60           RTS 
; monster condition $0B: alone
03/BF05: AD CD 29     LDA $29CD       ; check if only 1 monster remains
03/BF08: C9 01        CMP #$01
03/BF0A: D0 02        BNE $BF0E
03/BF0C: E6 DE        INC $DE
03/BF0E: 60           RTS 

; [ get monster condition target ]

03/BF0F: 64 DD        STZ $DD
03/BF11: A2 19 00     LDX #$0019
03/BF14: A9 FF        LDA #$FF
03/BF16: 9D D0 35     STA $35D0,X
03/BF19: CA           DEX 
03/BF1A: 10 FA        BPL $BF16
03/BF1C: AD 9D 28     LDA $289D
03/BF1F: 29 7F        AND #$7F
03/BF21: 0A           ASL 
03/BF22: AA           TAX 
03/BF23: BF 0C C1 03  LDA $03C10C,X   ; monster condition target jump table
03/BF27: 85 80        STA $80
03/BF29: BF 0D C1 03  LDA $03C10D,X
03/BF2D: 85 81        STA $81
03/BF2F: A9 03        LDA #$03
03/BF31: 85 82        STA $82
03/BF33: DC 80 00     JML [$0080]

; $00-$15: specific character id
03/BF36: AD 9D 28     LDA $289D
03/BF39: 85 AB        STA $AB
03/BF3B: 7B           TDC 
03/BF3C: AA           TAX 
03/BF3D: 86 A9        STX $A9
03/BF3F: A5 A9        LDA $A9
03/BF41: A8           TAY 
03/BF42: B9 40 35     LDA $3540,Y
03/BF45: D0 26        BNE $BF6D
03/BF47: BD 00 20     LDA $2000,X
03/BF4A: 29 1F        AND #$1F
03/BF4C: C5 AB        CMP $AB
03/BF4E: D0 1D        BNE $BF6D
03/BF50: 20 DA C0     JSR $C0DA       ; validate target
03/BF53: AD EA 35     LDA $35EA
03/BF56: D0 15        BNE $BF6D
03/BF58: 8E AB 00     STX $00AB
03/BF5B: A5 A9        LDA $A9
03/BF5D: 0A           ASL 
03/BF5E: AA           TAX 
03/BF5F: A5 AB        LDA $AB
03/BF61: 9D D0 35     STA $35D0,X
03/BF64: A5 AC        LDA $AC
03/BF66: 9D D1 35     STA $35D1,X
03/BF69: E6 DD        INC $DD
03/BF6B: 80 0B        BRA $BF78
03/BF6D: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/BF70: E6 A9        INC $A9
03/BF72: A5 A9        LDA $A9
03/BF74: C9 05        CMP #$05
03/BF76: D0 C7        BNE $BF3F
03/BF78: 60           RTS 
; $16: monster of same type
03/BF79: 38           SEC 
03/BF7A: A5 D2        LDA $D2
03/BF7C: E9 05        SBC #$05
03/BF7E: AA           TAX 
03/BF7F: BD B5 29     LDA $29B5,X
03/BF82: 85 AB        STA $AB
03/BF84: A2 05 00     LDX #$0005
03/BF87: 86 A9        STX $A9
03/BF89: 7B           TDC 
03/BF8A: AA           TAX 
03/BF8B: 38           SEC 
03/BF8C: A5 A9        LDA $A9
03/BF8E: E9 05        SBC #$05
03/BF90: A8           TAY 
03/BF91: B9 B5 29     LDA $29B5,Y
03/BF94: C5 AB        CMP $AB
03/BF96: D0 0E        BNE $BFA6
03/BF98: A5 A9        LDA $A9
03/BF9A: 0A           ASL 
03/BF9B: A8           TAY 
03/BF9C: C2 20        REP #$20
03/BF9E: 7B           TDC 
03/BF9F: 99 D0 35     STA $35D0,Y
03/BFA2: E2 20        SEP #$20
03/BFA4: E6 DD        INC $DD
03/BFA6: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/BFA9: E6 A9        INC $A9
03/BFAB: A5 A9        LDA $A9
03/BFAD: C9 0D        CMP #$0D
03/BFAF: D0 DA        BNE $BF8B
03/BFB1: 60           RTS 
; $17: self
03/BFB2: A5 D2        LDA $D2
03/BFB4: 0A           ASL 
03/BFB5: A8           TAY 
03/BFB6: A5 A6        LDA $A6
03/BFB8: 99 D0 35     STA $35D0,Y
03/BFBB: A5 A7        LDA $A7
03/BFBD: 99 D1 35     STA $35D1,Y
03/BFC0: E6 DD        INC $DD
03/BFC2: 60           RTS 
; $18/$19/$2E: character
03/BFC3: 64 A9        STZ $A9
03/BFC5: A9 05        LDA #$05
03/BFC7: 85 AB        STA $AB
03/BFC9: 7B           TDC 
03/BFCA: AA           TAX 
03/BFCB: A5 A9        LDA $A9
03/BFCD: A8           TAY 
03/BFCE: B9 40 35     LDA $3540,Y
03/BFD1: D0 17        BNE $BFEA
03/BFD3: 20 DA C0     JSR $C0DA       ; validate target
03/BFD6: AD EA 35     LDA $35EA
03/BFD9: D0 0F        BNE $BFEA
03/BFDB: A5 A9        LDA $A9
03/BFDD: 0A           ASL 
03/BFDE: A8           TAY 
03/BFDF: C2 20        REP #$20
03/BFE1: 8A           TXA 
03/BFE2: 99 D0 35     STA $35D0,Y
03/BFE5: 7B           TDC 
03/BFE6: E2 20        SEP #$20
03/BFE8: E6 DD        INC $DD
03/BFEA: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/BFED: E6 A9        INC $A9
03/BFEF: A5 A9        LDA $A9
03/BFF1: C5 AB        CMP $AB
03/BFF3: D0 D6        BNE $BFCB
03/BFF5: 60           RTS 
; $1A/$25: type 1 monster
03/BFF6: 64 AB        STZ $AB
03/BFF8: 4C FB BF     JMP $BFFB
03/BFFB: 7B           TDC 
03/BFFC: A8           TAY 
03/BFFD: 84 A9        STY $A9
03/BFFF: A2 80 02     LDX #$0280
03/C002: A4 A9        LDY $A9
03/C004: B9 B5 29     LDA $29B5,Y
03/C007: C5 AB        CMP $AB
03/C009: D0 24        BNE $C02F
03/C00B: 18           CLC 
03/C00C: A5 A9        LDA $A9
03/C00E: 69 05        ADC #$05
03/C010: 85 AC        STA $AC
03/C012: A8           TAY 
03/C013: B9 40 35     LDA $3540,Y
03/C016: D0 17        BNE $C02F
03/C018: 20 DA C0     JSR $C0DA       ; validate target
03/C01B: AD EA 35     LDA $35EA
03/C01E: D0 0F        BNE $C02F
03/C020: A5 AC        LDA $AC
03/C022: 0A           ASL 
03/C023: A8           TAY 
03/C024: C2 20        REP #$20
03/C026: 8A           TXA 
03/C027: 99 D0 35     STA $35D0,Y
03/C02A: 7B           TDC 
03/C02B: E2 20        SEP #$20
03/C02D: E6 DD        INC $DD
03/C02F: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/C032: E6 A9        INC $A9
03/C034: A5 A9        LDA $A9
03/C036: C9 08        CMP #$08
03/C038: D0 C8        BNE $C002
03/C03A: 60           RTS 
; $1B: type 2 monster
03/C03B: A9 01        LDA #$01
03/C03D: 85 AB        STA $AB
03/C03F: 4C FB BF     JMP $BFFB
; $1C: type 3 monster
03/C042: A9 02        LDA #$02
03/C044: 85 AB        STA $AB
03/C046: 4C FB BF     JMP $BFFB
; $1D: any target
03/C049: 20 C3 BF     JSR $BFC3
03/C04C: 4C 61 C0     JMP $C061
; $1E: any target (not self)
03/C04F: 20 49 C0     JSR $C049
03/C052: A5 D2        LDA $D2
03/C054: 0A           ASL 
03/C055: AA           TAX 
03/C056: A9 FF        LDA #$FF
03/C058: 9D D0 35     STA $35D0,X
03/C05B: 9D D1 35     STA $35D1,X
03/C05E: C6 DD        DEC $DD
03/C060: 60           RTS 
; $1F/$24/$2F: monster
03/C061: A9 05        LDA #$05
03/C063: 85 A9        STA $A9
03/C065: A9 0D        LDA #$0D
03/C067: 85 AB        STA $AB
03/C069: 4C C9 BF     JMP $BFC9
; $20/$23: monster (not self)
03/C06C: 20 61 C0     JSR $C061
03/C06F: 4C 52 C0     JMP $C052
; $21/$2B: front row character
03/C072: 7B           TDC 
03/C073: AA           TAX 
03/C074: 86 A9        STX $A9
03/C076: A5 A9        LDA $A9
03/C078: A8           TAY 
03/C079: B9 40 35     LDA $3540,Y
03/C07C: D0 1C        BNE $C09A
03/C07E: 20 DA C0     JSR $C0DA       ; validate target
03/C081: AD EA 35     LDA $35EA
03/C084: D0 14        BNE $C09A
03/C086: BD 01 20     LDA $2001,X
03/C089: 30 0F        BMI $C09A
03/C08B: A5 A9        LDA $A9
03/C08D: 0A           ASL 
03/C08E: A8           TAY 
03/C08F: C2 20        REP #$20
03/C091: 8A           TXA 
03/C092: 99 D0 35     STA $35D0,Y
03/C095: 7B           TDC 
03/C096: E2 20        SEP #$20
03/C098: E6 DD        INC $DD
03/C09A: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/C09D: E6 A9        INC $A9
03/C09F: A5 A9        LDA $A9
03/C0A1: C9 05        CMP #$05
03/C0A3: D0 D1        BNE $C076
03/C0A5: 60           RTS 
; $22/$29: back row character
03/C0A6: 7B           TDC 
03/C0A7: AA           TAX 
03/C0A8: 86 A9        STX $A9
03/C0AA: A5 A9        LDA $A9
03/C0AC: A8           TAY 
03/C0AD: B9 40 35     LDA $3540,Y
03/C0B0: D0 1C        BNE $C0CE
03/C0B2: 20 DA C0     JSR $C0DA       ; validate target
03/C0B5: AD EA 35     LDA $35EA
03/C0B8: D0 14        BNE $C0CE
03/C0BA: BD 01 20     LDA $2001,X
03/C0BD: 10 0F        BPL $C0CE
03/C0BF: A5 A9        LDA $A9
03/C0C1: 0A           ASL 
03/C0C2: A8           TAY 
03/C0C3: C2 20        REP #$20
03/C0C5: 8A           TXA 
03/C0C6: 99 D0 35     STA $35D0,Y
03/C0C9: 7B           TDC 
03/C0CA: E2 20        SEP #$20
03/C0CC: E6 DD        INC $DD
03/C0CE: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/C0D1: E6 A9        INC $A9
03/C0D3: A5 A9        LDA $A9
03/C0D5: C9 05        CMP #$05
03/C0D7: D0 D1        BNE $C0AA
03/C0D9: 60           RTS 
; $2A-$2D: validate target
03/C0DA: 9C EA 35     STZ $35EA
03/C0DD: BD 03 20     LDA $2003,X
03/C0E0: 29 C0        AND #$C0
03/C0E2: D0 0C        BNE $C0F0
03/C0E4: BD 05 20     LDA $2005,X
03/C0E7: 29 82        AND #$82
03/C0E9: D0 05        BNE $C0F0
03/C0EB: BD 06 20     LDA $2006,X
03/C0EE: 10 03        BPL $C0F3
03/C0F0: EE EA 35     INC $35EA
03/C0F3: 60           RTS 

; monster condition jump table
03/C0F4: BCE8 BD3D BDA9 BDB8 BDF0 BE1E BE31 BE46
03/C104: BEA0 BEE4 BEEC BF05

; monster condition target jump table
03/C10C: BF36 BF36 BF36 BF36 BF36 BF36 BF36 BF36  ; $00
03/C11C: BF36 BF36 BF36 BF36 BF36 BF36 BF36 BF36
03/C12C: BF36 BF36 BF36 BF36 BF36 BF36 BF79 BFB2  ; $10
03/C13C: BFC3 BFC3 BFF6 C03B C042 C049 C04F C061
03/C14C: C06C C072 C0A6 C06C C061BFF6 C03B C042  ; $20
03/C15C: C072 C0A6 C0DA C0DA C0DA C0DA BFC3 C061

; [ do retaliation ]

03/C16C: AD C4 34     LDA $34C4
03/C16F: 30 01        BMI $C172
03/C171: 60           RTS 
03/C172: A9 02        LDA #$02        ; battle graphics $02: wait one frame
03/C174: 20 85 80     JSR $8085       ; execute battle graphics
03/C177: AD C5 34     LDA $34C5
03/C17A: 8D B2 38     STA $38B2
03/C17D: AD 77 38     LDA $3877
03/C180: D0 05        BNE $C187
03/C182: AD B2 38     LDA $38B2
03/C185: D0 03        BNE $C18A
03/C187: 4C 01 C4     JMP $C401
03/C18A: 20 08 C4     JSR $C408       ; find valid character target
03/C18D: A5 A9        LDA $A9
03/C18F: D0 F6        BNE $C187
03/C191: A9 01        LDA #$01
03/C193: 8D 0A 39     STA $390A
03/C196: 8D B3 38     STA $38B3
03/C199: A2 05 00     LDX #$0005
03/C19C: AD B2 38     LDA $38B2
03/C19F: 0A           ASL 
03/C1A0: B0 03        BCS $C1A5
03/C1A2: E8           INX 
03/C1A3: 80 FA        BRA $C19F
03/C1A5: 8A           TXA 
03/C1A6: 85 D2        STA $D2
03/C1A8: 38           SEC 
03/C1A9: E9 05        SBC #$05
03/C1AB: AA           TAX 
03/C1AC: AD B2 38     LDA $38B2
03/C1AF: 20 5A 85     JSR $855A       ; clear bit
03/C1B2: 8D B2 38     STA $38B2
03/C1B5: BD AA 38     LDA $38AA,X
03/C1B8: F0 1E        BEQ $C1D8
03/C1BA: A5 D2        LDA $D2
03/C1BC: 20 89 84     JSR $8489       ; set current character/monster
03/C1BF: 7B           TDC 
03/C1C0: A8           TAY 
03/C1C1: A6 A6        LDX $A6
03/C1C3: BD 03 20     LDA $2003,X
03/C1C6: 29 C0        AND #$C0
03/C1C8: D0 0E        BNE $C1D8
03/C1CA: BD 04 20     LDA $2004,X
03/C1CD: 29 3C        AND #$3C
03/C1CF: D0 07        BNE $C1D8
03/C1D1: BD 05 20     LDA $2005,X
03/C1D4: 29 40        AND #$40
03/C1D6: F0 08        BEQ $C1E0
03/C1D8: 9C 0A 39     STZ $390A
03/C1DB: 9C B3 38     STZ $38B3
03/C1DE: 80 9D        BRA $C17D
03/C1E0: BD 50 20     LDA $2050,X
03/C1E3: 99 B4 38     STA $38B4,Y
03/C1E6: E8           INX 
03/C1E7: C8           INY 
03/C1E8: C0 07 00     CPY #$0007
03/C1EB: D0 F3        BNE $C1E0
03/C1ED: 7B           TDC 
03/C1EE: A8           TAY 
03/C1EF: A6 A6        LDX $A6
03/C1F1: 9E 50 20     STZ $2050,X
03/C1F4: E8           INX 
03/C1F5: C8           INY 
03/C1F6: C0 07 00     CPY #$0007
03/C1F9: D0 F6        BNE $C1F1
03/C1FB: 38           SEC 
03/C1FC: A5 D2        LDA $D2
03/C1FE: E9 05        SBC #$05
03/C200: 8D 1C 36     STA $361C
03/C203: 85 DF        STA $DF
03/C205: A9 3C        LDA #$3C
03/C207: 85 E1        STA $E1
03/C209: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/C20C: A6 E3        LDX $E3
03/C20E: 7B           TDC 
03/C20F: A8           TAY 
03/C210: BD 59 36     LDA $3659,X
03/C213: 99 39 38     STA $3839,Y
03/C216: E8           INX 
03/C217: C8           INY 
03/C218: C0 3C 00     CPY #$003C
03/C21B: D0 F3        BNE $C210
03/C21D: 20 F2 BB     JSR $BBF2
03/C220: 9C BE 35     STZ $35BE
03/C223: AD 1C 36     LDA $361C
03/C226: 85 DF        STA $DF
03/C228: A9 14        LDA #$14
03/C22A: 85 E1        STA $E1
03/C22C: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/C22F: A6 E3        LDX $E3
03/C231: 8E C3 35     STX $35C3
03/C234: 8E C5 35     STX $35C5
03/C237: AD 1C 36     LDA $361C
03/C23A: AA           TAX 
03/C23B: 8E 3D 39     STX $393D
03/C23E: A2 58 02     LDX #$0258
03/C241: 8E 3F 39     STX $393F
03/C244: 20 B9 83     JSR $83B9
03/C247: AE 41 39     LDX $3941
03/C24A: 8E BF 35     STX $35BF
03/C24D: 8E C1 35     STX $35C1
03/C250: AD 1C 36     LDA $361C
03/C253: 85 DF        STA $DF
03/C255: A9 28        LDA #$28
03/C257: 85 E1        STA $E1
03/C259: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/C25C: A6 E3        LDX $E3
03/C25E: 8E C8 35     STX $35C8
03/C261: AD 1C 36     LDA $361C
03/C264: AA           TAX 
03/C265: 8E 3D 39     STX $393D
03/C268: A2 A0 00     LDX #$00A0
03/C26B: 8E 3F 39     STX $393F
03/C26E: 20 B9 83     JSR $83B9
03/C271: AE 41 39     LDX $3941
03/C274: 8E CC 35     STX $35CC
03/C277: AD BE 35     LDA $35BE
03/C27A: 20 7F 84     JSR $847F       ; asl2
03/C27D: 18           CLC 
03/C27E: 6D C8 35     ADC $35C8
03/C281: 8D CA 35     STA $35CA
03/C284: AD C9 35     LDA $35C9
03/C287: 69 00        ADC #$00
03/C289: 8D CB 35     STA $35CB
03/C28C: AD BE 35     LDA $35BE
03/C28F: AA           TAX 
03/C290: C2 20        REP #$20
03/C292: 8A           TXA 
03/C293: 20 7D 84     JSR $847D       ; asl4
03/C296: 18           CLC 
03/C297: 6D CC 35     ADC $35CC
03/C29A: 8D CE 35     STA $35CE
03/C29D: 7B           TDC 
03/C29E: E2 20        SEP #$20
03/C2A0: AE C5 35     LDX $35C5
03/C2A3: BD 1F 53     LDA $531F,X
03/C2A6: C9 FF        CMP #$FF
03/C2A8: F0 46        BEQ $C2F0
03/C2AA: 9C C7 35     STZ $35C7
03/C2AD: AE CA 35     LDX $35CA
03/C2B0: BD BF 53     LDA $53BF,X
03/C2B3: C9 FF        CMP #$FF
03/C2B5: F0 29        BEQ $C2E0
03/C2B7: 7B           TDC 
03/C2B8: A8           TAY 
03/C2B9: AE CE 35     LDX $35CE
03/C2BC: BD FF 54     LDA $54FF,X
03/C2BF: 99 9C 28     STA $289C,Y
03/C2C2: E8           INX 
03/C2C3: C8           INY 
03/C2C4: C0 04 00     CPY #$0004
03/C2C7: D0 F3        BNE $C2BC
03/C2C9: 8E CE 35     STX $35CE
03/C2CC: 20 CE BC     JSR $BCCE       ; check monster condition
03/C2CF: A5 DE        LDA $DE
03/C2D1: F0 12        BEQ $C2E5
03/C2D3: EE CA 35     INC $35CA
03/C2D6: EE C7 35     INC $35C7
03/C2D9: AD C7 35     LDA $35C7
03/C2DC: C9 04        CMP #$04
03/C2DE: D0 CD        BNE $C2AD
03/C2E0: EE BE 35     INC $35BE
03/C2E3: 80 0B        BRA $C2F0
03/C2E5: EE C5 35     INC $35C5
03/C2E8: EE C5 35     INC $35C5
03/C2EB: EE BE 35     INC $35BE
03/C2EE: 80 87        BRA $C277
03/C2F0: A5 DE        LDA $DE
03/C2F2: F0 09        BEQ $C2FD
03/C2F4: AD BE 35     LDA $35BE
03/C2F7: 3A           DEC 
03/C2F8: 8D BE 35     STA $35BE
03/C2FB: 80 03        BRA $C300
03/C2FD: 4C D6 C3     JMP $C3D6
03/C300: AD 1C 36     LDA $361C
03/C303: AA           TAX 
03/C304: 8E 3D 39     STX $393D
03/C307: A2 58 02     LDX #$0258
03/C30A: 8E 3F 39     STX $393F
03/C30D: 20 B9 83     JSR $83B9
03/C310: AD BE 35     LDA $35BE
03/C313: 85 DF        STA $DF
03/C315: A9 3C        LDA #$3C
03/C317: 85 E1        STA $E1
03/C319: 20 E0 83     JSR $83E0
03/C31C: 18           CLC 
03/C31D: AD 41 39     LDA $3941
03/C320: 65 E3        ADC $E3
03/C322: 85 E3        STA $E3
03/C324: AD 42 39     LDA $3942
03/C327: 65 E4        ADC $E4
03/C329: 85 E4        STA $E4
03/C32B: A6 E3        LDX $E3
03/C32D: 7B           TDC 
03/C32E: A8           TAY 
03/C32F: BF FF 59 7E  LDA $7E59FF,X
03/C333: 99 9C 28     STA $289C,Y
03/C336: C9 FF        CMP #$FF
03/C338: F0 04        BEQ $C33E
03/C33A: E8           INX 
03/C33B: C8           INY 
03/C33C: 80 F1        BRA $C32F
03/C33E: 7B           TDC 
03/C33F: AA           TAX 
03/C340: AC BB 38     LDY $38BB
03/C343: BD 9C 28     LDA $289C,X
03/C346: 99 59 36     STA $3659,Y
03/C349: C9 FF        CMP #$FF
03/C34B: F0 31        BEQ $C37E
03/C34D: C9 C0        CMP #$C0
03/C34F: B0 10        BCS $C361
03/C351: 99 5A 36     STA $365A,Y
03/C354: DA           PHX 
03/C355: A6 A6        LDX $A6
03/C357: 9D 52 20     STA $2052,X
03/C35A: FA           PLX 
03/C35B: A9 C2        LDA #$C2
03/C35D: 99 59 36     STA $3659,Y
03/C360: C8           INY 
03/C361: C9 E8        CMP #$E8
03/C363: 90 0E        BCC $C373
03/C365: C9 FA        CMP #$FA
03/C367: B0 11        BCS $C37A
03/C369: E8           INX 
03/C36A: C8           INY 
03/C36B: BD 9C 28     LDA $289C,X
03/C36E: 99 59 36     STA $3659,Y
03/C371: 80 07        BRA $C37A
03/C373: DA           PHX 
03/C374: A6 A6        LDX $A6
03/C376: 9D 51 20     STA $2051,X
03/C379: FA           PLX 
03/C37A: E8           INX 
03/C37B: C8           INY 
03/C37C: 80 C5        BRA $C343
03/C37E: AE BB 38     LDX $38BB
03/C381: BD 59 36     LDA $3659,X
03/C384: C9 FF        CMP #$FF
03/C386: F0 41        BEQ $C3C9
03/C388: C9 F9        CMP #$F9
03/C38A: F0 2E        BEQ $C3BA
03/C38C: C9 E8        CMP #$E8
03/C38E: 90 36        BCC $C3C6
03/C390: C9 F0        CMP #$F0
03/C392: 90 17        BCC $C3AB
03/C394: C9 F4        CMP #$F4
03/C396: 90 2D        BCC $C3C5
03/C398: C9 F8        CMP #$F8
03/C39A: B0 2A        BCS $C3C6
03/C39C: DA           PHX 
03/C39D: 48           PHA 
03/C39E: E8           INX 
03/C39F: BD 59 36     LDA $3659,X
03/C3A2: 85 A9        STA $A9
03/C3A4: 68           PLA 
03/C3A5: 20 77 B8     JSR $B877       ; change battle variable
03/C3A8: FA           PLX 
03/C3A9: 80 1A        BRA $C3C5
03/C3AB: DA           PHX 
03/C3AC: 48           PHA 
03/C3AD: E8           INX 
03/C3AE: BD 59 36     LDA $3659,X
03/C3B1: 85 A9        STA $A9
03/C3B3: 68           PLA 
03/C3B4: 20 6F B7     JSR $B76F
03/C3B7: FA           PLX 
03/C3B8: 80 0B        BRA $C3C5
03/C3BA: DA           PHX 
03/C3BB: E8           INX 
03/C3BC: BD 59 36     LDA $3659,X
03/C3BF: 85 A9        STA $A9
03/C3C1: 20 A1 B8     JSR $B8A1       ; choose monster target
03/C3C4: FA           PLX 
03/C3C5: E8           INX 
03/C3C6: E8           INX 
03/C3C7: 80 B8        BRA $C381
03/C3C9: 20 8F B6     JSR $B68F
03/C3CC: AD 1C 36     LDA $361C
03/C3CF: AA           TAX 
03/C3D0: 9E 79 38     STZ $3879,X
03/C3D3: 20 78 AD     JSR $AD78
03/C3D6: A5 D2        LDA $D2
03/C3D8: 20 89 84     JSR $8489       ; set current character/monster
03/C3DB: 7B           TDC 
03/C3DC: A8           TAY 
03/C3DD: A6 A6        LDX $A6
03/C3DF: B9 B4 38     LDA $38B4,Y
03/C3E2: 9D 50 20     STA $2050,X
03/C3E5: E8           INX 
03/C3E6: C8           INY 
03/C3E7: C0 07 00     CPY #$0007
03/C3EA: D0 F3        BNE $C3DF
03/C3EC: AE BB 38     LDX $38BB
03/C3EF: 7B           TDC 
03/C3F0: A8           TAY 
03/C3F1: B9 39 38     LDA $3839,Y
03/C3F4: 9D 59 36     STA $3659,X
03/C3F7: E8           INX 
03/C3F8: C8           INY 
03/C3F9: C0 3C 00     CPY #$003C
03/C3FC: D0 F3        BNE $C3F1
03/C3FE: 4C 7D C1     JMP $C17D
03/C401: 9C 0A 39     STZ $390A
03/C404: 9C B3 38     STZ $38B3
03/C407: 60           RTS 

; [ find valid character target ]

; $A9: set to 1 if no valid targets found

03/C408: 7B           TDC 
03/C409: AA           TAX 
03/C40A: A8           TAY 
03/C40B: 84 A9        STY $A9
03/C40D: B9 40 35     LDA $3540,Y
03/C410: D0 13        BNE $C425       ; branch if not present
03/C412: BD 03 20     LDA $2003,X
03/C415: 29 C0        AND #$C0
03/C417: D0 0C        BNE $C425       ; branch if dead
03/C419: BD 05 20     LDA $2005,X
03/C41C: 29 82        AND #$82
03/C41E: D0 05        BNE $C425       ; branch if magnetized or jumping
03/C420: BD 06 20     LDA $2006,X
03/C423: 10 0B        BPL $C430       ; branch if not hiding
03/C425: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/C428: C8           INY 
03/C429: C0 05 00     CPY #$0005
03/C42C: D0 DF        BNE $C40D
03/C42E: E6 A9        INC $A9
03/C430: 60           RTS 

; [  ]

03/C431: 7B           TDC 
03/C432: A8           TAY 
03/C433: 84 A9        STY $A9
03/C435: AE BB 38     LDX $38BB
03/C438: BD 59 36     LDA $3659,X
03/C43B: C9 FF        CMP #$FF
03/C43D: F0 1E        BEQ $C45D
03/C43F: C9 FC        CMP #$FC
03/C441: F0 03        BEQ $C446
03/C443: E8           INX 
03/C444: 80 F2        BRA $C438
03/C446: E6 A9        INC $A9
03/C448: AE BB 38     LDX $38BB
03/C44B: A9 E1        LDA #$E1
03/C44D: 9D 59 36     STA $3659,X
03/C450: 7B           TDC 
03/C451: 9D 5A 36     STA $365A,X
03/C454: 3A           DEC 
03/C455: 9D 5B 36     STA $365B,X
03/C458: A9 FC        LDA #$FC
03/C45A: 9D 5B 36     STA $365B,X
03/C45D: 60           RTS 

; [  ]

03/C45E: 7B           TDC 
03/C45F: A8           TAY 
03/C460: 84 A9        STY $A9
03/C462: DA           PHX 
03/C463: BD 39 38     LDA $3839,X
03/C466: C9 FF        CMP #$FF
03/C468: F0 1D        BEQ $C487
03/C46A: C9 FC        CMP #$FC
03/C46C: F0 03        BEQ $C471
03/C46E: E8           INX 
03/C46F: 80 F2        BRA $C463
03/C471: E6 A9        INC $A9
03/C473: FA           PLX 
03/C474: A9 E1        LDA #$E1
03/C476: 9D 59 36     STA $3659,X
03/C479: 7B           TDC 
03/C47A: 9D 5A 36     STA $365A,X
03/C47D: 3A           DEC 
03/C47E: 9D 5C 36     STA $365C,X
03/C481: A9 FC        LDA #$FC
03/C483: 9D 5B 36     STA $365B,X
03/C486: 60           RTS 
03/C487: FA           PLX 
03/C488: 60           RTS 

; --------------------------------------------------------------------------

; [ battle command $00: fight ]

03/C489: 9C C7 34     STZ $34C7       ; clear attack graphics flags
03/C48C: 9C E1 38     STZ $38E1
03/C48F: 7B           TDC 
03/C490: AA           TAX 
03/C491: 8E 96 28     STX $2896       ; clear action script pointer
03/C494: A5 CD        LDA $CD
03/C496: 30 0F        BMI $C4A7       ; branch if monster attacker
; character attacker
03/C498: A9 F8        LDA #$F8        ; display text
03/C49A: 8D C6 33     STA $33C6
03/C49D: A9 04        LDA #$04        ; damage numerals
03/C49F: 8D C7 33     STA $33C7
03/C4A2: 20 14 C9     JSR $C914       ; decrement arrow quantity
03/C4A5: 80 54        BRA $C4FB
; monster attacker
03/C4A7: AD 01 36     LDA $3601
03/C4AA: C9 FF        CMP #$FF
03/C4AC: F0 10        BEQ $C4BE
03/C4AE: 7B           TDC 
03/C4AF: AA           TAX 
03/C4B0: BD C2 33     LDA $33C2,X
03/C4B3: C9 FC        CMP #$FC
03/C4B5: F0 07        BEQ $C4BE
03/C4B7: C9 FF        CMP #$FF
03/C4B9: F0 40        BEQ $C4FB
03/C4BB: E8           INX 
03/C4BC: 80 F2        BRA $C4B0
03/C4BE: 7B           TDC 
03/C4BF: AA           TAX 
03/C4C0: A8           TAY 
03/C4C1: BD C2 33     LDA $33C2,X
03/C4C4: 99 9C 28     STA $289C,Y
03/C4C7: C9 FF        CMP #$FF
03/C4C9: F0 04        BEQ $C4CF
03/C4CB: E8           INX 
03/C4CC: C8           INY 
03/C4CD: 80 F2        BRA $C4C1
03/C4CF: 7B           TDC 
03/C4D0: AA           TAX 
03/C4D1: A8           TAY 
03/C4D2: BD 9C 28     LDA $289C,X
03/C4D5: 99 C2 33     STA $33C2,Y
03/C4D8: C9 FF        CMP #$FF
03/C4DA: F0 1F        BEQ $C4FB
03/C4DC: C9 C0        CMP #$C0        ; insert damage numeral display after attack
03/C4DE: F0 08        BEQ $C4E8
03/C4E0: C9 C6        CMP #$C6
03/C4E2: F0 04        BEQ $C4E8
03/C4E4: C9 DE        CMP #$DE
03/C4E6: D0 0F        BNE $C4F7
03/C4E8: C8           INY 
03/C4E9: 8C 96 28     STY $2896
03/C4EC: A9 F8        LDA #$F8        ; display text
03/C4EE: 99 C2 33     STA $33C2,Y
03/C4F1: C8           INY 
03/C4F2: A9 04        LDA #$04        ; damage numerals
03/C4F4: 99 C2 33     STA $33C2,Y
03/C4F7: E8           INX 
03/C4F8: C8           INY 
03/C4F9: 80 D7        BRA $C4D2
03/C4FB: 64 C7        STZ $C7
03/C4FD: 9C FC 38     STZ $38FC
03/C500: AD 9C 26     LDA $269C       ; hit rate
03/C503: 8D F8 38     STA $38F8
03/C506: AD 83 26     LDA $2683
03/C509: 29 02        AND #$02
03/C50B: F0 03        BEQ $C510       ; branch if not blind
03/C50D: 4E F8 38     LSR $38F8       ; halve hit rate
03/C510: AD 81 26     LDA $2681
03/C513: 10 11        BPL $C526       ; branch if in front row
03/C515: AD 81 26     LDA $2681
03/C518: 29 20        AND #$20
03/C51A: D0 0A        BNE $C526       ; branch if no back row penalty
03/C51C: AD 85 26     LDA $2685
03/C51F: 29 02        AND #$02
03/C521: D0 03        BNE $C526       ; branch if jumping
03/C523: 4E F8 38     LSR $38F8       ; halve hit rate
03/C526: A5 CD        LDA $CD
03/C528: 29 7F        AND #$7F
03/C52A: D0 19        BNE $C545       ; branch if attacker not in 1st slot
03/C52C: AD F8 38     LDA $38F8
03/C52F: 85 DF        STA $DF
03/C531: A9 05        LDA #$05        ; hit rate +25%
03/C533: 85 E1        STA $E1
03/C535: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/C538: 46 E4        LSR $E4
03/C53A: 66 E3        ROR $E3
03/C53C: 46 E4        LSR $E4
03/C53E: 66 E3        ROR $E3
03/C540: A5 E3        LDA $E3
03/C542: 8D F8 38     STA $38F8
03/C545: AD 01 27     LDA $2701
03/C548: 10 11        BPL $C55B       ; branch if in front row
03/C54A: AD 81 26     LDA $2681
03/C54D: 29 20        AND #$20
03/C54F: D0 0A        BNE $C55B
03/C551: AD 85 26     LDA $2685
03/C554: 29 02        AND #$02
03/C556: D0 03        BNE $C55B
03/C558: 4E F8 38     LSR $38F8       ; halve hit rate
03/C55B: AD F8 38     LDA $38F8
03/C55E: 8D FA 38     STA $38FA       ; set attack rate
03/C561: AD 9B 26     LDA $269B       ; attack multiplier
03/C564: 8D FB 38     STA $38FB
03/C567: 20 87 C9     JSR $C987       ; get number of hits
03/C56A: AD FD 38     LDA $38FD
03/C56D: 8D F8 38     STA $38F8       ; set number of hits
03/C570: A5 CE        LDA $CE
03/C572: 10 05        BPL $C579
03/C574: 29 7F        AND #$7F
03/C576: 18           CLC 
03/C577: 69 05        ADC #$05
03/C579: 20 89 84     JSR $8489       ; set current character/monster
03/C57C: AD 06 27     LDA $2706
03/C57F: 29 10        AND #$10
03/C581: D0 18        BNE $C59B       ; branch if target has barrier status
03/C583: AD 06 27     LDA $2706
03/C586: 29 0C        AND #$0C
03/C588: F0 15        BEQ $C59F       ; branch if target doesn't have image status
; image
03/C58A: 4A           LSR 
03/C58B: 29 04        AND #$04        ; remove 1 image charge
03/C58D: 85 A9        STA $A9
03/C58F: A6 A6        LDX $A6
03/C591: BD 06 20     LDA $2006,X
03/C594: 29 F3        AND #$F3
03/C596: 05 A9        ORA $A9
03/C598: 9D 06 20     STA $2006,X
; barrier
03/C59B: A9 FF        LDA #$FF        ; 255 hits defended
03/C59D: 80 4B        BRA $C5EA
03/C59F: AD 29 27     LDA $2729       ; defense rate
03/C5A2: 8D F9 38     STA $38F9
03/C5A5: AD 03 27     LDA $2703
03/C5A8: 29 02        AND #$02
03/C5AA: F0 03        BEQ $C5AF       ; branch if target is not blind
03/C5AC: 4E F9 38     LSR $38F9       ; halve defense rate
03/C5AF: A5 CE        LDA $CE
03/C5B1: 29 7F        AND #$7F
03/C5B3: D0 19        BNE $C5CE       ; branch if target not in 1st slot
03/C5B5: AD F9 38     LDA $38F9
03/C5B8: 85 DF        STA $DF
03/C5BA: A9 05        LDA #$05        ; defense rate +25%
03/C5BC: 85 E1        STA $E1
03/C5BE: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/C5C1: 46 E4        LSR $E4
03/C5C3: 66 E3        ROR $E3
03/C5C5: 46 E4        LSR $E4
03/C5C7: 66 E3        ROR $E3
03/C5C9: A5 E3        LDA $E3
03/C5CB: 8D F9 38     STA $38F9
03/C5CE: AD F9 38     LDA $38F9
03/C5D1: 8D FA 38     STA $38FA
03/C5D4: AD 28 27     LDA $2728       ; defense multiplier
03/C5D7: 8D FB 38     STA $38FB
03/C5DA: AD 03 27     LDA $2703
03/C5DD: 29 30        AND #$30
03/C5DF: F0 03        BEQ $C5E4       ; branch if target is not toad or mini
03/C5E1: 9C FB 38     STZ $38FB       ; zero defense multiplier
03/C5E4: 20 87 C9     JSR $C987       ; get number of hits
03/C5E7: AD FD 38     LDA $38FD
03/C5EA: 8D F9 38     STA $38F9       ; set number of hits defended
03/C5ED: 38           SEC 
03/C5EE: AD F8 38     LDA $38F8
03/C5F1: ED F9 38     SBC $38F9       ; subtract from number of hits
03/C5F4: 8D C8 34     STA $34C8
03/C5F7: 8D FC 38     STA $38FC
03/C5FA: F0 02        BEQ $C5FE
03/C5FC: B0 25        BCS $C623
; zero net hits
03/C5FE: 7B           TDC 
03/C5FF: 8D FC 38     STA $38FC       ; zero hits
03/C602: 1A           INC 
03/C603: 8D C8 34     STA $34C8       ; 1 hit ???
03/C606: A5 CE        LDA $CE
03/C608: 85 A9        STA $A9
03/C60A: 10 05        BPL $C611       ; branch if target is a character
03/C60C: 29 7F        AND #$7F
03/C60E: 18           CLC 
03/C60F: 69 05        ADC #$05
03/C611: 0A           ASL 
03/C612: AA           TAX 
03/C613: BD D4 34     LDA $34D4,X
03/C616: 1D D5 34     ORA $34D5,X
03/C619: D0 05        BNE $C620       ; branch if target already took damage
03/C61B: A9 40        LDA #$40
03/C61D: 9D D5 34     STA $34D5,X     ; set miss flag
03/C620: 4C FB C7     JMP $C7FB
; nonzero net hits
03/C623: A5 CE        LDA $CE
03/C625: 10 05        BPL $C62C       ; branch if target is a character
03/C627: AD 81 38     LDA $3881
03/C62A: D0 D2        BNE $C5FE       ; branch if monsters are invincible ???
03/C62C: AD C7 34     LDA $34C7
03/C62F: 09 80        ORA #$80
03/C631: 8D C7 34     STA $34C7
03/C634: A6 A6        LDX $A6
03/C636: BD 04 20     LDA $2004,X
03/C639: 85 A9        STA $A9
03/C63B: 29 F7        AND #$F7        ; clear charm status
03/C63D: 9D 04 20     STA $2004,X
03/C640: A9 02        LDA #$02        ; set damage multipliers to 1x
03/C642: 8D FE 38     STA $38FE
03/C645: 8D FF 38     STA $38FF
; get elemental multiplier
03/C648: AD 99 26     LDA $2699       ; attack element
03/C64B: 8D 00 36     STA $3600
03/C64E: 2D 21 27     AND $2721
03/C651: F0 07        BEQ $C65A       ; branch if not very weak
03/C653: A9 08        LDA #$08        ; 4x elemental damage multiplier
03/C655: 8D FE 38     STA $38FE
03/C658: 80 2B        BRA $C685
03/C65A: AD 99 26     LDA $2699
03/C65D: 2D 20 27     AND $2720       ; branch if not weak
03/C660: F0 07        BEQ $C669
03/C662: A9 04        LDA #$04        ; 2x elemental damage multiplier
03/C664: 8D FE 38     STA $38FE
03/C667: 80 1C        BRA $C685
03/C669: AD 99 26     LDA $2699
03/C66C: 2D 26 27     AND $2726       ; branch if not immune
03/C66F: F0 07        BEQ $C678
03/C671: A9 00        LDA #$00        ; 0x elemental damage multiplier
03/C673: 8D FE 38     STA $38FE
03/C676: 80 0D        BRA $C685
03/C678: AD 99 26     LDA $2699
03/C67B: 2D 25 27     AND $2725       ; branch if not strong
03/C67E: F0 05        BEQ $C685
03/C680: A9 01        LDA #$01        ; 1/2x elemental damage multiplier
03/C682: 8D FE 38     STA $38FE
; get creature type multiplier
03/C685: A5 CD        LDA $CD
03/C687: 30 13        BMI $C69C       ; branch if attacker is a monster
03/C689: A5 CE        LDA $CE
03/C68B: 10 20        BPL $C6AD       ; branch if target is a character
; character vs. monster
03/C68D: AD 9A 26     LDA $269A       ; attack strong vs. creature type
03/C690: 2D 40 27     AND $2740       ; creature type
03/C693: F0 18        BEQ $C6AD
03/C695: A9 08        LDA #$08        ; 4x creature type multiplier
03/C697: 8D FF 38     STA $38FF
03/C69A: 80 11        BRA $C6AD
03/C69C: A5 CE        LDA $CE
03/C69E: 30 0D        BMI $C6AD       ; branch if target is a monster
; monster vs. character
03/C6A0: AD C0 26     LDA $26C0
03/C6A3: 2D 27 27     AND $2727       ; defense strong vs. creature type
03/C6A6: F0 05        BEQ $C6AD
03/C6A8: A9 01        LDA #$01        ; 1/2x creature type multiplier
03/C6AA: 8D FF 38     STA $38FF
03/C6AD: 9C 00 39     STZ $3900       ; clear crit flag
03/C6B0: AD 9D 26     LDA $269D       ; attacker's attack power
03/C6B3: AA           TAX 
03/C6B4: 8E 02 39     STX $3902
03/C6B7: AD 84 26     LDA $2684
03/C6BA: 29 04        AND #$04
03/C6BC: F0 19        BEQ $C6D7       ; branch if not berserk
03/C6BE: 86 A9        STX $A9
03/C6C0: 46 AA        LSR $AA
03/C6C2: 66 A9        ROR $A9         ; attack power +50%
03/C6C4: 18           CLC 
03/C6C5: AD 02 39     LDA $3902
03/C6C8: 65 A9        ADC $A9
03/C6CA: 8D 02 39     STA $3902
03/C6CD: AD 03 39     LDA $3903
03/C6D0: 65 AA        ADC $AA
03/C6D2: 8D 03 39     STA $3903
03/C6D5: 80 0D        BRA $C6E4
03/C6D7: AD 85 26     LDA $2685
03/C6DA: 29 0A        AND #$0A
03/C6DC: F0 06        BEQ $C6E4       ; branch if not using jump or focus
03/C6DE: 0E 02 39     ASL $3902
03/C6E1: 2E 03 39     ROL $3903       ; attack power +100%
03/C6E4: AD 84 26     LDA $2684
03/C6E7: 29 80        AND #$80
03/C6E9: F0 06        BEQ $C6F1       ; branch if cursed
03/C6EB: 4E 03 39     LSR $3903
03/C6EE: 6E 02 39     ROR $3902       ; attack power -50%
03/C6F1: AD 2A 27     LDA $272A       ; target's defense
03/C6F4: AA           TAX 
03/C6F5: 8E 04 39     STX $3904
03/C6F8: AD 01 27     LDA $2701
03/C6FB: 10 06        BPL $C703       ; branch if not in back row
03/C6FD: 0E 04 39     ASL $3904
03/C700: 2E 05 39     ROL $3905       ; defense +100%
03/C703: AD 04 27     LDA $2704
03/C706: 29 80        AND #$80
03/C708: F0 06        BEQ $C710       ; branch if not cursed
03/C70A: 4E 05 39     LSR $3905       ; defense -100%
03/C70D: 6E 04 39     ROR $3904
03/C710: 20 8B 85     JSR $858B       ; random (0..98)
03/C713: CD AD 26     CMP $26AD       ; compare to crit rate
03/C716: B0 0B        BCS $C723
03/C718: EE 00 39     INC $3900       ; set crit flag for damage
03/C71B: A9 04        LDA #$04
03/C71D: 0D C7 34     ORA $34C7       ; set crit flag for graphics
03/C720: 8D C7 34     STA $34C7
03/C723: AD 05 27     LDA $2705
03/C726: 29 10        AND #$10
03/C728: F0 06        BEQ $C730       ; branch if not using defend command
03/C72A: 0E 04 39     ASL $3904       ; defense +100%
03/C72D: 2E 05 39     ROL $3905
03/C730: AD 05 27     LDA $2705
03/C733: 29 08        AND #$08
03/C735: F0 06        BEQ $C73D       ; branch if not using focus
03/C737: 4E 05 39     LSR $3905       ; defense -100%
03/C73A: 6E 04 39     ROR $3904
03/C73D: AD 83 26     LDA $2683
03/C740: 29 30        AND #$30
03/C742: F0 09        BEQ $C74D       ; branch if attacker is not toad or mini
03/C744: A2 01 00     LDX #$0001
03/C747: 8E 02 39     STX $3902       ; set attack power to 1
03/C74A: 9C 00 39     STZ $3900       ; clear crit flag
03/C74D: AD 03 27     LDA $2703
03/C750: 29 30        AND #$30
03/C752: F0 0B        BEQ $C75F       ; branch if target is not toad or mini
03/C754: 0E 02 39     ASL $3902
03/C757: 2E 03 39     ROL $3903       ; attack power +100%
03/C75A: 7B           TDC 
03/C75B: AA           TAX 
03/C75C: 8E 04 39     STX $3904       ; set defense to zero
03/C75F: A9 01        LDA #$01
03/C761: 8D 06 39     STA $3906       ; single target (don't divide damage)
03/C764: AD AE 26     LDA $26AE       ; set crit bonus
03/C767: 8D 01 39     STA $3901
03/C76A: 20 9F C9     JSR $C99F       ; calculate damage
03/C76D: AD 99 26     LDA $2699
03/C770: 29 40        AND #$40
03/C772: D0 3C        BNE $C7B0       ; branch if attack has drain element
; no drain
03/C774: A5 CE        LDA $CE
03/C776: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/C779: BD D4 34     LDA $34D4,X
03/C77C: 1D D5 34     ORA $34D5,X
03/C77F: F0 23        BEQ $C7A4       ; branch if current damage is zero
03/C781: BD D5 34     LDA $34D5,X
03/C784: 48           PHA 
03/C785: 29 80        AND #$80        ; save msb
03/C787: 85 A9        STA $A9
03/C789: 68           PLA 
03/C78A: 29 3F        AND #$3F
03/C78C: 9D D5 34     STA $34D5,X     ; add to damage buffer
03/C78F: 18           CLC 
03/C790: BD D4 34     LDA $34D4,X
03/C793: 65 A4        ADC $A4
03/C795: 9D D4 34     STA $34D4,X
03/C798: BD D5 34     LDA $34D5,X
03/C79B: 65 A5        ADC $A5
03/C79D: 05 A9        ORA $A9         ; restore msb
03/C79F: 9D D5 34     STA $34D5,X
03/C7A2: 80 0A        BRA $C7AE
03/C7A4: A5 A4        LDA $A4
03/C7A6: 9D D4 34     STA $34D4,X     ; set damage
03/C7A9: A5 A5        LDA $A5
03/C7AB: 9D D5 34     STA $34D5,X
03/C7AE: 80 4B        BRA $C7FB
; drain
03/C7B0: A5 CE        LDA $CE
03/C7B2: F0 27        BEQ $C7DB       ; branch if character slot 1 (should be BPL ???)
03/C7B4: AD 40 27     LDA $2740
03/C7B7: 10 22        BPL $C7DB       ; branch if not undead
; undead target
03/C7B9: A5 CE        LDA $CE
03/C7BB: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/C7BE: A5 A4        LDA $A4
03/C7C0: 9D D4 34     STA $34D4,X
03/C7C3: A5 A5        LDA $A5
03/C7C5: 09 80        ORA #$80        ; restore target hp
03/C7C7: 9D D5 34     STA $34D5,X
03/C7CA: A5 CD        LDA $CD
03/C7CC: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/C7CF: A5 A4        LDA $A4
03/C7D1: 9D D4 34     STA $34D4,X     ; damage attacker
03/C7D4: A5 A5        LDA $A5
03/C7D6: 9D D5 34     STA $34D5,X
03/C7D9: 80 20        BRA $C7FB
; not undead target
03/C7DB: A5 CD        LDA $CD
03/C7DD: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/C7E0: A5 A4        LDA $A4
03/C7E2: 9D D4 34     STA $34D4,X
03/C7E5: A5 A5        LDA $A5
03/C7E7: 09 80        ORA #$80        ; restore attacker hp
03/C7E9: 9D D5 34     STA $34D5,X
03/C7EC: A5 CE        LDA $CE
03/C7EE: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/C7F1: A5 A4        LDA $A4
03/C7F3: 9D D4 34     STA $34D4,X     ; damage target
03/C7F6: A5 A5        LDA $A5
03/C7F8: 9D D5 34     STA $34D5,X
03/C7FB: A5 CD        LDA $CD
03/C7FD: 10 0A        BPL $C809       ; branch if character attacker
03/C7FF: AE 96 28     LDX $2896
03/C802: BD C2 33     LDA $33C2,X
03/C805: C9 F8        CMP #$F8
03/C807: D0 03        BNE $C80C       ; branch if no battle message ???
03/C809: 20 6E CA     JSR $CA6E       ; update hp after damage
03/C80C: AD 07 39     LDA $3907
03/C80F: D0 05        BNE $C816       ; branch if target died
03/C811: AD FC 38     LDA $38FC
03/C814: D0 03        BNE $C819       ; branch if one or more hits
03/C816: 4C 00 C9     JMP $C900       ; skip status effects
03/C819: AD 9E 26     LDA $269E
03/C81C: 0D 9F 26     ORA $269F
03/C81F: F0 F5        BEQ $C816       ; branch if no status inflicted
03/C821: AD 9E 26     LDA $269E
03/C824: 2D 2B 27     AND $272B
03/C827: D0 ED        BNE $C816       ; branch if target is immune to status 1
03/C829: AD 9F 26     LDA $269F
03/C82C: 2D 2C 27     AND $272C
03/C82F: D0 E5        BNE $C816       ; branch if target is immune to status 2
03/C831: 38           SEC 
03/C832: AD 9C 26     LDA $269C       ; hit rate - defense rate
03/C835: ED 29 27     SBC $2729
03/C838: F0 DC        BEQ $C816
03/C83A: 90 DA        BCC $C816       ; branch if less than 1
03/C83C: 8D FA 38     STA $38FA
03/C83F: AD FC 38     LDA $38FC       ; number of hits from attack
03/C842: 8D FB 38     STA $38FB
03/C845: 20 87 C9     JSR $C987       ; get number of hits
03/C848: AD FD 38     LDA $38FD
03/C84B: F0 C9        BEQ $C816       ; branch if no hits for status
03/C84D: AD 70 27     LDA $2770
03/C850: 30 C4        BMI $C816       ; branch if a boss
03/C852: AD 9E 26     LDA $269E
03/C855: 8D 08 39     STA $3908       ; set status 1 inflicted
03/C858: 85 AA        STA $AA
03/C85A: 2D 03 27     AND $2703
03/C85D: D0 B7        BNE $C816       ; branch if target already had that status
03/C85F: AD 9F 26     LDA $269F
03/C862: 8D 09 39     STA $3909       ; set status 2 inflicted
03/C865: 85 A9        STA $A9
03/C867: 2D 04 27     AND $2704
03/C86A: D0 21        BNE $C88D       ; branch if target already had that status
03/C86C: A5 CE        LDA $CE
03/C86E: 10 05        BPL $C875       ; branch if target is a character
03/C870: 29 7F        AND #$7F
03/C872: 18           CLC 
03/C873: 69 05        ADC #$05
03/C875: 85 CF        STA $CF
03/C877: 20 7F 84     JSR $847F       ; asl2
03/C87A: AA           TAX 
03/C87B: 86 C7        STX $C7
03/C87D: A5 CF        LDA $CF
03/C87F: 20 89 84     JSR $8489       ; set current character/monster
03/C882: A9 03        LDA #$03        ; action timer
03/C884: 20 69 85     JSR $8569       ; get pointer to timer
03/C887: AE 98 35     LDX $3598
03/C88A: BD 06 2A     LDA $2A06,X
03/C88D: D0 71        BNE $C900       ; branch if not waiting for turn
03/C88F: AD 83 26     LDA $2683
03/C892: 29 30        AND #$30
03/C894: D0 F7        BNE $C88D       ; branch if toad or mini
03/C896: C2 20        REP #$20
03/C898: 7B           TDC 
03/C899: AA           TAX 
03/C89A: 9B           TXY 
03/C89B: 06 A9        ASL $A9
03/C89D: 90 0C        BCC $C8AB       ; find first status inflicted
03/C89F: E2 20        SEP #$20
03/C8A1: 8A           TXA 
03/C8A2: 18           CLC 
03/C8A3: 69 25        ADC #$25        ; status inflicted messages
03/C8A5: 99 CA 34     STA $34CA,Y     ; add to battle message buffer
03/C8A8: C8           INY 
03/C8A9: C2 20        REP #$20
03/C8AB: E8           INX 
03/C8AC: E0 10 00     CPX #$0010
03/C8AF: D0 EA        BNE $C89B
03/C8B1: 7B           TDC 
03/C8B2: E2 20        SEP #$20
03/C8B4: 20 3A CB     JSR $CB3A       ; apply attack status
03/C8B7: AD 08 39     LDA $3908
03/C8BA: 0D 09 39     ORA $3909
03/C8BD: D0 02        BNE $C8C1       ; branch if any status was inflicted
03/C8BF: 80 3F        BRA $C900
03/C8C1: A5 CD        LDA $CD
03/C8C3: 30 05        BMI $C8CA       ; branch if monster attacker
03/C8C5: 20 B1 85     JSR $85B1       ; add message to graphics script
03/C8C8: 80 36        BRA $C900
03/C8CA: 7B           TDC 
03/C8CB: AA           TAX 
03/C8CC: BD C2 33     LDA $33C2,X     ; copy graphics script to data buffer
03/C8CF: 9D 9C 28     STA $289C,X
03/C8D2: E8           INX 
03/C8D3: C9 FF        CMP #$FF
03/C8D5: D0 F5        BNE $C8CC
03/C8D7: 7B           TDC 
03/C8D8: AA           TAX 
03/C8D9: A8           TAY 
03/C8DA: BD 9C 28     LDA $289C,X
03/C8DD: 99 C2 33     STA $33C2,Y
03/C8E0: C9 FF        CMP #$FF
03/C8E2: F0 1C        BEQ $C900
03/C8E4: C9 C0        CMP #$C0        ; insert message display after attack
03/C8E6: F0 08        BEQ $C8F0
03/C8E8: C9 C6        CMP #$C6
03/C8EA: F0 04        BEQ $C8F0
03/C8EC: C9 DE        CMP #$DE
03/C8EE: D0 0C        BNE $C8FC
03/C8F0: C8           INY 
03/C8F1: A9 F8        LDA #$F8        ; display text
03/C8F3: 99 C2 33     STA $33C2,Y
03/C8F6: C8           INY 
03/C8F7: A9 03        LDA #$03        ; battle message
03/C8F9: 99 C2 33     STA $33C2,Y
03/C8FC: E8           INX 
03/C8FD: C8           INY 
03/C8FE: 80 DA        BRA $C8DA
03/C900: AD E1 38     LDA $38E1
03/C903: F0 0E        BEQ $C913       ; return if no arrow quantity update needed
03/C905: A5 CD        LDA $CD         ; attacker id
03/C907: 85 00        STA $00
03/C909: AD E3 38     LDA $38E3       ; arrow hand
03/C90C: 85 01        STA $01
03/C90E: A9 08        LDA #$08        ; battle graphics $08: update arrow quantity
03/C910: 20 85 80     JSR $8085       ; execute battle graphics
03/C913: 60           RTS 

; [ decrement arrow quantity ]

03/C914: AD 83 26     LDA $2683
03/C917: 29 30        AND #$30
03/C919: D0 6B        BNE $C986       ; return if toad or mini
03/C91B: A5 CD        LDA $CD
03/C91D: 20 89 84     JSR $8489       ; set current character/monster
03/C920: 18           CLC 
03/C921: AD 32 35     LDA $3532       ; pointer to equipped item data
03/C924: 69 21        ADC #$21        ; skip defensive items
03/C926: 85 A9        STA $A9
03/C928: AD 33 35     LDA $3533
03/C92B: 69 00        ADC #$00
03/C92D: 85 AA        STA $AA
03/C92F: 7B           TDC 
03/C930: A8           TAY 
03/C931: 84 AB        STY $AB
03/C933: 8D E3 38     STA $38E3
03/C936: A6 A9        LDX $A9
03/C938: BD 86 27     LDA $2786,X     ; left hand item equipability
03/C93B: 29 40        AND #$40
03/C93D: F0 03        BEQ $C942       ; branch if not an arrow
03/C93F: C8           INY 
03/C940: 80 10        BRA $C952
03/C942: BD 91 27     LDA $2791,X     ; right hand item equipability
03/C945: 29 40        AND #$40
03/C947: F0 09        BEQ $C952       ; branch if not an arrow
03/C949: A9 80        LDA #$80
03/C94B: 85 AB        STA $AB
03/C94D: EE E3 38     INC $38E3
03/C950: C8           INY 
03/C951: C8           INY 
03/C952: A5 CD        LDA $CD
03/C954: 20 7E 84     JSR $847E       ; asl3
03/C957: AA           TAX 
03/C958: 98           TYA 
03/C959: F0 2B        BEQ $C986       ; branch if no arrows equipped
03/C95B: 88           DEY 
03/C95C: F0 04        BEQ $C962
03/C95E: E8           INX 
03/C95F: E8           INX 
03/C960: E8           INX 
03/C961: E8           INX 
03/C962: 38           SEC 
03/C963: BD DC 32     LDA $32DC,X     ; decrement item quantity
03/C966: E9 01        SBC #$01
03/C968: D0 0E        BNE $C978
; ran out of arrows
03/C96A: A5 CD        LDA $CD
03/C96C: AA           TAX 
03/C96D: BD DC 38     LDA $38DC,X     ; set flag to validate equipped arrows
03/C970: 1A           INC 
03/C971: 05 AB        ORA $AB
03/C973: 9D DC 38     STA $38DC,X
03/C976: 80 03        BRA $C97B
; didn't run out of arrows
03/C978: 9D DC 32     STA $32DC,X
03/C97B: EE E1 38     INC $38E1
03/C97E: A5 CD        LDA $CD
03/C980: 8D 75 39     STA $3975
03/C983: 20 FE 9D     JSR $9DFE       ; copy equipped item data to character properties
03/C986: 60           RTS 

; --------------------------------------------------------------------------

; [ get number of hits ]

03/C987: 9C FD 38     STZ $38FD       ; clear number of hits
03/C98A: AD FB 38     LDA $38FB
03/C98D: F0 0F        BEQ $C99E       ; return if no base hits
03/C98F: A8           TAY 
03/C990: 20 8B 85     JSR $858B       ; random (0..98)
03/C993: CD FA 38     CMP $38FA       ; check vs. hit rate
03/C996: B0 03        BCS $C99B
03/C998: EE FD 38     INC $38FD       ; increment number of hits
03/C99B: 88           DEY 
03/C99C: D0 F2        BNE $C990
03/C99E: 60           RTS 

; [ calculate damage ]

03/C99F: AE 02 39     LDX $3902       ; base attack
03/C9A2: 8E 56 39     STX $3956
03/C9A5: 8E 58 39     STX $3958
03/C9A8: 4E 57 39     LSR $3957
03/C9AB: 6E 56 39     ROR $3956
03/C9AE: AD 57 39     LDA $3957
03/C9B1: F0 06        BEQ $C9B9
03/C9B3: A2 FF 00     LDX #$00FF
03/C9B6: 8E 56 39     STX $3956
03/C9B9: 7B           TDC 
03/C9BA: AA           TAX 
03/C9BB: AD 56 39     LDA $3956
03/C9BE: 20 79 83     JSR $8379       ; random (X..A)
03/C9C1: AA           TAX 
03/C9C2: 8E 56 39     STX $3956
03/C9C5: 20 E3 84     JSR $84E3       ; add (16-bit)
03/C9C8: AE 5A 39     LDX $395A
03/C9CB: 86 A4        STX $A4
03/C9CD: AD FE 38     LDA $38FE       ; elemental multiplier
03/C9D0: 20 41 CA     JSR $CA41       ; apply damage multiplier
03/C9D3: AD FF 38     LDA $38FF       ; creature type multiplier
03/C9D6: 20 41 CA     JSR $CA41       ; apply damage multiplier
03/C9D9: AD 00 39     LDA $3900
03/C9DC: F0 0E        BEQ $C9EC       ; branch if not a crit
03/C9DE: 18           CLC 
03/C9DF: A5 A4        LDA $A4
03/C9E1: 6D 01 39     ADC $3901       ; add crit bonus
03/C9E4: 85 A4        STA $A4
03/C9E6: A5 A5        LDA $A5
03/C9E8: 69 00        ADC #$00
03/C9EA: 85 A5        STA $A5
03/C9EC: 38           SEC 
03/C9ED: A5 A4        LDA $A4
03/C9EF: ED 04 39     SBC $3904
03/C9F2: 85 A4        STA $A4
03/C9F4: A5 A5        LDA $A5
03/C9F6: ED 05 39     SBC $3905
03/C9F9: 85 A5        STA $A5
03/C9FB: B0 04        BCS $CA01
03/C9FD: 7B           TDC 
03/C9FE: AA           TAX 
03/C9FF: 86 A4        STX $A4
03/CA01: A6 A4        LDX $A4
03/CA03: 8E 3D 39     STX $393D
03/CA06: AD FC 38     LDA $38FC
03/CA09: AA           TAX 
03/CA0A: 8E 3F 39     STX $393F
03/CA0D: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/CA10: AE 43 39     LDX $3943
03/CA13: F0 06        BEQ $CA1B
03/CA15: A2 FF FF     LDX #$FFFF
03/CA18: 8E 41 39     STX $3941
03/CA1B: AE 41 39     LDX $3941
03/CA1E: 8E 45 39     STX $3945
03/CA21: AD 06 39     LDA $3906
03/CA24: AA           TAX 
03/CA25: 8E 47 39     STX $3947
03/CA28: 20 07 84     JSR $8407       ; divide
03/CA2B: AE 49 39     LDX $3949
03/CA2E: 86 A4        STX $A4
03/CA30: E0 0F 27     CPX #$270F
03/CA33: 90 05        BCC $CA3A
03/CA35: A2 0F 27     LDX #$270F
03/CA38: 86 A4        STX $A4
03/CA3A: A6 A4        LDX $A4
03/CA3C: D0 02        BNE $CA40
03/CA3E: E6 A4        INC $A4
03/CA40: 60           RTS 

; [ apply damage multiplier ]

03/CA41: D0 05        BNE $CA48
03/CA43: 64 A4        STZ $A4
03/CA45: 64 A5        STZ $A5
03/CA47: 60           RTS 
03/CA48: 4A           LSR 
03/CA49: D0 05        BNE $CA50
03/CA4B: 46 A5        LSR $A5
03/CA4D: 66 A4        ROR $A4
03/CA4F: 60           RTS 
03/CA50: AA           TAX 
03/CA51: 8E 3D 39     STX $393D
03/CA54: A6 A4        LDX $A4
03/CA56: 8E 3F 39     STX $393F
03/CA59: 20 B9 83     JSR $83B9       ; multiply (16-bit)
03/CA5C: AE 41 39     LDX $3941
03/CA5F: 86 A4        STX $A4
03/CA61: 60           RTS 

; [ get pointer to damage buffer ]

03/CA62: 85 A9        STA $A9
03/CA64: 10 05        BPL $CA6B       ; branch if a character
03/CA66: 29 7F        AND #$7F
03/CA68: 18           CLC 
03/CA69: 69 05        ADC #$05
03/CA6B: 0A           ASL 
03/CA6C: AA           TAX 
03/CA6D: 60           RTS 

; [ update hp after damage ]

03/CA6E: C2 20        REP #$20
03/CA70: 7B           TDC 
03/CA71: AA           TAX 
03/CA72: 86 A9        STX $A9
03/CA74: A8           TAY 
; start of loop
03/CA75: 98           TYA 
03/CA76: 4A           LSR 
03/CA77: AA           TAX 
03/CA78: BD 40 35     LDA $3540,X
03/CA7B: 29 FF 00     AND #$00FF
03/CA7E: F0 03        BEQ $CA83       ; branch if target is present
03/CA80: 4C 22 CB     JMP $CB22
03/CA83: A6 A9        LDX $A9
03/CA85: B9 D4 34     LDA $34D4,Y
03/CA88: 29 00 40     AND #$4000
03/CA8B: F0 11        BEQ $CA9E       ; branch if attack didn't miss
03/CA8D: AD 5B 35     LDA $355B
03/CA90: F0 0C        BEQ $CA9E       ; branch if attack can show zero damage
03/CA92: B9 D4 34     LDA $34D4,Y
03/CA95: 29 FF BF     AND #$BFFF      ; clear miss flag
03/CA98: 99 D4 34     STA $34D4,Y
03/CA9B: 4C 22 CB     JMP $CB22
03/CA9E: B9 D4 34     LDA $34D4,Y
03/CAA1: 10 11        BPL $CAB4       ; branch if attack did damage
; restore hp
03/CAA3: 18           CLC 
03/CAA4: B9 D4 34     LDA $34D4,Y
03/CAA7: 29 FF 3F     AND #$3FFF
03/CAAA: 7D 07 20     ADC $2007,X     ; add to target hp
03/CAAD: 90 37        BCC $CAE6
03/CAAF: A9 FF FF     LDA #$FFFF      ; max $FFFF
03/CAB2: 80 32        BRA $CAE6
; damage hp
03/CAB4: B9 D4 34     LDA $34D4,Y
03/CAB7: 29 FF BF     AND #$BFFF      ; clear miss flag
03/CABA: 8D 98 28     STA $2898
03/CABD: 38           SEC 
03/CABE: BD 07 20     LDA $2007,X
03/CAC1: F0 0E        BEQ $CAD1
03/CAC3: ED 98 28     SBC $2898       ; subtract from target hp
03/CAC6: F0 02        BEQ $CACA
03/CAC8: B0 1C        BCS $CAE6
; hp reached zero
03/CACA: E2 20        SEP #$20
03/CACC: EE 07 39     INC $3907       ; increment number of targets that died
03/CACF: C2 20        REP #$20
03/CAD1: 98           TYA 
03/CAD2: 0A           ASL 
03/CAD3: AA           TAX 
03/CAD4: 7B           TDC 
03/CAD5: E2 20        SEP #$20
03/CAD7: BD 8E 33     LDA $338E,X     ; set dead status
03/CADA: 29 FE        AND #$FE
03/CADC: 09 80        ORA #$80
03/CADE: 9D 8E 33     STA $338E,X
03/CAE1: C2 20        REP #$20
03/CAE3: 7B           TDC 
03/CAE4: A6 A9        LDX $A9
03/CAE6: 9D 07 20     STA $2007,X     ; cap at max hp
03/CAE9: DD 09 20     CMP $2009,X
03/CAEC: 90 08        BCC $CAF6
03/CAEE: BD 09 20     LDA $2009,X
03/CAF1: 9D 07 20     STA $2007,X
03/CAF4: 80 1D        BRA $CB13
03/CAF6: BD 09 20     LDA $2009,X
03/CAF9: 20 86 84     JSR $8486       ; lsr2
03/CAFC: DD 07 20     CMP $2007,X
03/CAFF: 90 12        BCC $CB13       ; branch if not at critical hp
03/CB01: 98           TYA 
03/CB02: 0A           ASL 
03/CB03: AA           TAX 
03/CB04: 7B           TDC 
03/CB05: E2 20        SEP #$20
03/CB07: BD 91 33     LDA $3391,X     ; set critical status
03/CB0A: 09 01        ORA #$01
03/CB0C: 9D 91 33     STA $3391,X
03/CB0F: C2 20        REP #$20
03/CB11: 80 0F        BRA $CB22
03/CB13: 7B           TDC 
03/CB14: E2 20        SEP #$20
03/CB16: A6 A9        LDX $A9
03/CB18: BD 06 20     LDA $2006,X     ; clear critical status
03/CB1B: 29 FE        AND #$FE
03/CB1D: 9D 06 20     STA $2006,X
03/CB20: C2 20        REP #$20
03/CB22: A6 A9        LDX $A9         ; next target
03/CB24: 8A           TXA 
03/CB25: 18           CLC 
03/CB26: 69 80 00     ADC #$0080
03/CB29: AA           TAX 
03/CB2A: 86 A9        STX $A9
03/CB2C: C8           INY 
03/CB2D: C8           INY 
03/CB2E: C0 1A 00     CPY #$001A
03/CB31: F0 03        BEQ $CB36
03/CB33: 4C 75 CA     JMP $CA75
03/CB36: 7B           TDC 
03/CB37: E2 20        SEP #$20
03/CB39: 60           RTS 

; [ apply attack status ]

03/CB3A: AD 08 39     LDA $3908
03/CB3D: 10 0E        BPL $CB4D
03/CB3F: AD 40 27     LDA $2740
03/CB42: 29 82        AND #$82
03/CB44: F0 07        BEQ $CB4D
03/CB46: 9C 08 39     STZ $3908
03/CB49: 9C 09 39     STZ $3909
03/CB4C: 60           RTS 
03/CB4D: C2 20        REP #$20
03/CB4F: AD 03 27     LDA $2703
03/CB52: 29 FF BF     AND #$BFFF
03/CB55: CD 08 39     CMP $3908
03/CB58: 90 06        BCC $CB60
03/CB5A: 9C 08 39     STZ $3908
03/CB5D: 4C 32 CC     JMP $CC32
03/CB60: A6 C7        LDX $C7
03/CB62: AD 03 27     LDA $2703
03/CB65: 0D 08 39     ORA $3908
03/CB68: 9D 8E 33     STA $338E,X
03/CB6B: AD 08 39     LDA $3908
03/CB6E: 29 01 3B     AND #$3B01
03/CB71: D0 03        BNE $CB76
03/CB73: 4C 32 CC     JMP $CC32
03/CB76: 7B           TDC 
03/CB77: E2 20        SEP #$20
03/CB79: AD 08 39     LDA $3908
03/CB7C: 29 01        AND #$01
03/CB7E: F0 29        BEQ $CBA9
03/CB80: A9 06        LDA #$06
03/CB82: 85 D6        STA $D6
03/CB84: A5 CF        LDA $CF
03/CB86: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/CB89: A9 09        LDA #$09        ; poison timer
03/CB8B: 20 C8 85     JSR $85C8       ; set timer
03/CB8E: A9 40        LDA #$40
03/CB90: 9D 06 2A     STA $2A06,X
03/CB93: A5 CF        LDA $CF
03/CB95: 0A           ASL 
03/CB96: AA           TAX 
03/CB97: BD EB 29     LDA $29EB,X     ; enable poison timer
03/CB9A: 09 10        ORA #$10
03/CB9C: 9D EB 29     STA $29EB,X
03/CB9F: A5 D4        LDA $D4
03/CBA1: 9D 2A 2B     STA $2B2A,X
03/CBA4: A5 D5        LDA $D5
03/CBA6: 9D 2B 2B     STA $2B2B,X
03/CBA9: AD 09 39     LDA $3909
03/CBAC: 29 30        AND #$30
03/CBAE: F0 14        BEQ $CBC4
03/CBB0: A9 04        LDA #$04
03/CBB2: 85 D6        STA $D6
03/CBB4: A5 CF        LDA $CF
03/CBB6: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/CBB9: A9 03        LDA #$03        ; action timer
03/CBBB: 20 C8 85     JSR $85C8       ; set timer
03/CBBE: A9 40        LDA #$40
03/CBC0: 9D 06 2A     STA $2A06,X
03/CBC3: 60           RTS 
03/CBC4: AD 09 39     LDA $3909
03/CBC7: 29 03        AND #$03
03/CBC9: F0 66        BEQ $CC31
03/CBCB: A6 C7        LDX $C7
03/CBCD: AD 04 27     LDA $2704
03/CBD0: 29 FC        AND #$FC
03/CBD2: 85 A9        STA $A9
03/CBD4: AD 04 27     LDA $2704
03/CBD7: 29 03        AND #$03
03/CBD9: F0 2C        BEQ $CC07
03/CBDB: 18           CLC 
03/CBDC: 6D 9F 26     ADC $269F
03/CBDF: 85 AA        STA $AA
03/CBE1: 29 04        AND #$04
03/CBE3: F0 1A        BEQ $CBFF
03/CBE5: A5 A9        LDA $A9
03/CBE7: 9D 8F 33     STA $338F,X
03/CBEA: AD 03 27     LDA $2703
03/CBED: 09 40        ORA #$40
03/CBEF: 9D 8E 33     STA $338E,X
03/CBF2: A5 CF        LDA $CF
03/CBF4: 0A           ASL 
03/CBF5: AA           TAX 
03/CBF6: BD EB 29     LDA $29EB,X     ; disable petrify timer
03/CBF9: 29 F7        AND #$F7
03/CBFB: 9D EB 29     STA $29EB,X
03/CBFE: 60           RTS 
03/CBFF: A5 A9        LDA $A9
03/CC01: 05 AA        ORA $AA
03/CC03: 9D 8F 33     STA $338F,X
03/CC06: 60           RTS 
03/CC07: A9 04        LDA #$04
03/CC09: 85 D6        STA $D6
03/CC0B: A5 CF        LDA $CF
03/CC0D: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/CC10: A9 0C        LDA #$0C        ; petrify timer
03/CC12: 20 C8 85     JSR $85C8       ; set timer
03/CC15: A9 40        LDA #$40
03/CC17: 9D 06 2A     STA $2A06,X
03/CC1A: A5 CF        LDA $CF
03/CC1C: 0A           ASL 
03/CC1D: AA           TAX 
03/CC1E: BD EB 29     LDA $29EB,X     ; enable petrify timer
03/CC21: 09 08        ORA #$08
03/CC23: 9D EB 29     STA $29EB,X
03/CC26: A5 D4        LDA $D4
03/CC28: 9D 44 2B     STA $2B44,X
03/CC2B: A5 D5        LDA $D5
03/CC2D: 9D 45 2B     STA $2B45,X
03/CC30: 60           RTS 
03/CC31: 60           RTS 
03/CC32: 7B           TDC 
03/CC33: E2 20        SEP #$20
03/CC35: 60           RTS 

; --------------------------------------------------------------------------

; [ battle command $02: magic ]

03/CC36: 7B           TDC 
03/CC37: AA           TAX 
03/CC38: 8E 96 28     STX $2896       ; clear action script pointer
03/CC3B: A5 CD        LDA $CD
03/CC3D: 30 03        BMI $CC42       ; branch if monster attacker
03/CC3F: 4C 10 CD     JMP $CD10
; monster attacker
03/CC42: 7B           TDC 
03/CC43: AA           TAX 
03/CC44: 9B           TXY 
03/CC45: BD C2 33     LDA $33C2,X
03/CC48: 99 9C 28     STA $289C,Y
03/CC4B: C9 FF        CMP #$FF
03/CC4D: F0 04        BEQ $CC53
03/CC4F: E8           INX 
03/CC50: C8           INY 
03/CC51: 80 F2        BRA $CC45
03/CC53: 7B           TDC 
03/CC54: AA           TAX 
03/CC55: 9B           TXY 
03/CC56: BD 9C 28     LDA $289C,X
03/CC59: 99 C2 33     STA $33C2,Y
03/CC5C: C9 FF        CMP #$FF
03/CC5E: F0 3A        BEQ $CC9A
03/CC60: C9 FA        CMP #$FA
03/CC62: B0 32        BCS $CC96
03/CC64: C9 E8        CMP #$E8
03/CC66: B0 06        BCS $CC6E
03/CC68: C9 C0        CMP #$C0        ; insert message display before attack
03/CC6A: 90 0C        BCC $CC78
03/CC6C: 80 28        BRA $CC96
03/CC6E: E8           INX 
03/CC6F: C8           INY 
03/CC70: BD 9C 28     LDA $289C,X
03/CC73: 99 C2 33     STA $33C2,Y
03/CC76: 80 1E        BRA $CC96
03/CC78: 48           PHA 
03/CC79: A9 F8        LDA #$F8        ; display text
03/CC7B: 99 C2 33     STA $33C2,Y
03/CC7E: A9 02        LDA #$02        ; attack name
03/CC80: 99 C3 33     STA $33C3,Y
03/CC83: 68           PLA 
03/CC84: C9 31        CMP #$31
03/CC86: 90 09        BCC $CC91
03/CC88: C9 5F        CMP #$5F
03/CC8A: B0 05        BCS $CC91
03/CC8C: 38           SEC 
03/CC8D: E9 30        SBC #$30
03/CC8F: 80 00        BRA $CC91
03/CC91: 99 C4 33     STA $33C4,Y
03/CC94: C8           INY 
03/CC95: C8           INY 
03/CC96: E8           INX 
03/CC97: C8           INY 
03/CC98: 80 BC        BRA $CC56
03/CC9A: AD 01 36     LDA $3601
03/CC9D: C9 FF        CMP #$FF
03/CC9F: F0 10        BEQ $CCB1
03/CCA1: 7B           TDC 
03/CCA2: AA           TAX 
03/CCA3: BD C2 33     LDA $33C2,X
03/CCA6: C9 FC        CMP #$FC
03/CCA8: F0 07        BEQ $CCB1
03/CCAA: C9 FF        CMP #$FF
03/CCAC: F0 4C        BEQ $CCFA
03/CCAE: E8           INX 
03/CCAF: 80 F2        BRA $CCA3
03/CCB1: 7B           TDC 
03/CCB2: AA           TAX 
03/CCB3: 9B           TXY 
03/CCB4: BD C2 33     LDA $33C2,X
03/CCB7: 99 9C 28     STA $289C,Y
03/CCBA: C9 FF        CMP #$FF
03/CCBC: F0 04        BEQ $CCC2
03/CCBE: E8           INX 
03/CCBF: C8           INY 
03/CCC0: 80 F2        BRA $CCB4
03/CCC2: 7B           TDC 
03/CCC3: AA           TAX 
03/CCC4: A8           TAY 
03/CCC5: BD 9C 28     LDA $289C,X
03/CCC8: 99 C2 33     STA $33C2,Y
03/CCCB: C9 FF        CMP #$FF
03/CCCD: F0 2B        BEQ $CCFA
03/CCCF: C9 FA        CMP #$FA
03/CCD1: B0 23        BCS $CCF6
03/CCD3: C9 E8        CMP #$E8
03/CCD5: B0 06        BCS $CCDD
03/CCD7: C9 C0        CMP #$C0        ; insert damage numeral display after attack
03/CCD9: 90 0C        BCC $CCE7
03/CCDB: 80 19        BRA $CCF6
03/CCDD: E8           INX 
03/CCDE: C8           INY 
03/CCDF: BD 9C 28     LDA $289C,X
03/CCE2: 99 C2 33     STA $33C2,Y
03/CCE5: 80 0F        BRA $CCF6
03/CCE7: C8           INY 
03/CCE8: 8C 96 28     STY $2896
03/CCEB: A9 F8        LDA #$F8        ; display text
03/CCED: 99 C2 33     STA $33C2,Y
03/CCF0: C8           INY 
03/CCF1: A9 04        LDA #$04        ; damage numerals
03/CCF3: 99 C2 33     STA $33C2,Y
03/CCF6: E8           INX 
03/CCF7: C8           INY 
03/CCF8: 80 CB        BRA $CCC5
03/CCFA: 7B           TDC 
03/CCFB: AA           TAX 
03/CCFC: BD C2 33     LDA $33C2,X
03/CCFF: C9 C2        CMP #$C2
03/CD01: D0 07        BNE $CD0A
03/CD03: A9 00        LDA #$00
03/CD05: 9D C2 33     STA $33C2,X
03/CD08: 80 03        BRA $CD0D
03/CD0A: E8           INX 
03/CD0B: 80 EF        BRA $CCFC
03/CD0D: 4C 3E CD     JMP $CD3E
; character attacker
03/CD10: AD D2 26     LDA $26D2       ; magic id
03/CD13: C9 19        CMP #$19
03/CD15: 90 17        BCC $CD2E       ; branch if white magic ($C2)
03/CD17: C9 31        CMP #$31
03/CD19: 90 04        BCC $CD1F       ; branch if black magic ($C3)
03/CD1B: C9 40        CMP #$40
03/CD1D: 90 04        BCC $CD23       ; branch if summon ($C4)
03/CD1F: A9 C3        LDA #$C3        ; otherwise treat as black magic ($C3)
03/CD21: 80 08        BRA $CD2B
03/CD23: 20 53 E0     JSR $E053       ; get summon attack id
03/CD26: A9 C4        LDA #$C4
03/CD28: 8D FF 35     STA $35FF       ; save previous command id
03/CD2B: 8D C4 33     STA $33C4       ; add command id to graphics script
; fallthrough

; [ do magic attack ]

03/CD2E: AD D2 26     LDA $26D2
03/CD31: 8D C5 33     STA $33C5       ; add magic id to graphics script
03/CD34: A9 F8        LDA #$F8        ; display text
03/CD36: 8D C6 33     STA $33C6
03/CD39: A9 04        LDA #$04        ; damage numerals
03/CD3B: 8D C7 33     STA $33C7
03/CD3E: EE 5B 35     INC $355B       ; allow zero damage
03/CD41: A5 CE        LDA $CE
03/CD43: 29 80        AND #$80
03/CD45: 8D C4 34     STA $34C4       ; monster target flag
03/CD48: 9C 22 35     STZ $3522       ; clear reflected targets
03/CD4B: 9C 23 35     STZ $3523
03/CD4E: AD D2 26     LDA $26D2
03/CD51: C9 92        CMP #$92
03/CD53: D0 0A        BNE $CD5F       ; branch if not retreat (monster attack)
03/CD55: 48           PHA 
03/CD56: A9 04        LDA #$04
03/CD58: 8D E6 38     STA $38E6
03/CD5B: 68           PLA 
03/CD5C: EE 82 38     INC $3882
03/CD5F: AA           TAX 
03/CD60: 86 E5        STX $E5         ; set array item id
03/CD62: AD 2A 35     LDA $352A
03/CD65: D0 33        BNE $CD9A       ; branch if an item
03/CD67: AD D2 26     LDA $26D2
03/CD6A: 20 2E D3     JSR $D32E       ; check if attack name is shown
03/CD6D: 8D C8 34     STA $34C8       ; show attack name
03/CD70: D0 08        BNE $CD7A
03/CD72: AD C2 34     LDA $34C2       ; disable monster flash
03/CD75: 09 40        ORA #$40
03/CD77: 8D C2 34     STA $34C2
03/CD7A: AD D2 26     LDA $26D2
03/CD7D: 20 54 D3     JSR $D354       ; check if monster flash is disabled
03/CD80: F0 08        BEQ $CD8A
03/CD82: AD C2 34     LDA $34C2       ; disable monster flash
03/CD85: 09 40        ORA #$40
03/CD87: 8D C2 34     STA $34C2
03/CD8A: A9 40        LDA #$40
03/CD8C: 8D C7 34     STA $34C7       ; show magic name
03/CD8F: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/CD92: 86 80        STX $80
03/CD94: A9 0F        LDA #$0F
03/CD96: 85 82        STA $82
03/CD98: 80 1B        BRA $CDB5
; item
03/CD9A: AD D2 26     LDA $26D2
03/CD9D: 8D C8 34     STA $34C8
03/CDA0: A9 20        LDA #$20
03/CDA2: 8D C7 34     STA $34C7       ; show item name
03/CDA5: A2 80 96     LDX #$9680      ; 0F/9680 (item properties)
03/CDA8: 86 80        STX $80
03/CDAA: A9 0F        LDA #$0F
03/CDAC: 85 82        STA $82
03/CDAE: 38           SEC 
03/CDAF: A5 E5        LDA $E5
03/CDB1: E9 B0        SBC #$B0
03/CDB3: 85 E5        STA $E5
03/CDB5: A9 06        LDA #$06
03/CDB7: 20 5E 84     JSR $845E       ; load array item
03/CDBA: AD A0 28     LDA $28A0
03/CDBD: 48           PHA 
03/CDBE: 29 80        AND #$80
03/CDC0: 8D E2 38     STA $38E2       ; set magic damage flag
03/CDC3: 68           PLA 
03/CDC4: 29 7F        AND #$7F
03/CDC6: 85 DF        STA $DF
03/CDC8: A9 03        LDA #$03
03/CDCA: 85 E1        STA $E1
03/CDCC: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/CDCF: A6 E3        LDX $E3
03/CDD1: 7B           TDC 
03/CDD2: A8           TAY 
03/CDD3: BF 90 A5 0F  LDA $0FA590,X   ; element/status effects
03/CDD7: 99 A2 28     STA $28A2,Y
03/CDDA: C8           INY 
03/CDDB: E8           INX 
03/CDDC: C0 03 00     CPY #$0003
03/CDDF: D0 F2        BNE $CDD3
03/CDE1: AD A2 28     LDA $28A2
03/CDE4: 8D 00 36     STA $3600
03/CDE7: A5 CE        LDA $CE
03/CDE9: 29 80        AND #$80
03/CDEB: 8D 4E 35     STA $354E
03/CDEE: 30 0D        BMI $CDFD
03/CDF0: 20 08 C4     JSR $C408       ; find valid character target
03/CDF3: A5 A9        LDA $A9
03/CDF5: F0 06        BEQ $CDFD       ; branch if there is a valid target
03/CDF7: 9C 50 35     STZ $3550       ; clear targets
03/CDFA: 4C 90 D2     JMP $D290
03/CDFD: AD D3 26     LDA $26D3       ; monster targets
03/CE00: D0 03        BNE $CE05
03/CE02: AD D4 26     LDA $26D4       ; character targets
03/CE05: 20 AC D2     JSR $D2AC       ; validate magic targets
03/CE08: 8D 4F 35     STA $354F
03/CE0B: 8D 50 35     STA $3550
03/CE0E: 20 0C 85     JSR $850C       ; count bits
03/CE11: 8A           TXA 
03/CE12: 8D 06 39     STA $3906       ; number of targets hit
03/CE15: 8D 4D 35     STA $354D       ; number of targets remaining
03/CE18: F0 DD        BEQ $CDF7       ; branch if there are no valid targets
03/CE1A: AD 9C 28     LDA $289C       ; item/magic targeting
03/CE1D: 29 60        AND #$60
03/CE1F: C9 40        CMP #$40
03/CE21: D0 05        BNE $CE28       ; branch if not auto-target all
03/CE23: A9 01        LDA #$01
03/CE25: 8D 06 39     STA $3906       ; don't divide damage
03/CE28: AD D2 26     LDA $26D2
03/CE2B: F0 3E        BEQ $CE6B       ; branch if invalid magic/item id
03/CE2D: AD 5D 35     LDA $355D
03/CE30: F0 39        BEQ $CE6B       ; branch if attack doesn't consume mp
03/CE32: A5 CD        LDA $CD
03/CE34: 30 35        BMI $CE6B       ; branch if monster attacker
03/CE36: AD 8B 38     LDA $388B
03/CE39: D0 30        BNE $CE6B       ; branch if auto-battle
03/CE3B: AD A1 28     LDA $28A1
03/CE3E: 29 7F        AND #$7F        ; mp cost
03/CE40: 85 A9        STA $A9
03/CE42: 38           SEC 
03/CE43: AD 8B 26     LDA $268B       ; subtract from attacker's mp
03/CE46: E5 A9        SBC $A9
03/CE48: 85 A9        STA $A9
03/CE4A: AD 8C 26     LDA $268C
03/CE4D: E9 00        SBC #$00
03/CE4F: 85 AA        STA $AA
03/CE51: B0 0E        BCS $CE61
03/CE53: 9C 50 35     STZ $3550       ; clear targets
03/CE56: 20 B1 85     JSR $85B1       ; add message to graphics script
03/CE59: A9 01        LDA #$01        ;  (not enough mp)
03/CE5B: 8D CA 34     STA $34CA
03/CE5E: 4C 90 D2     JMP $D290
03/CE61: A5 A9        LDA $A9
03/CE63: 8D 8B 26     STA $268B       ; set attacker's mp
03/CE66: A5 AA        LDA $AA
03/CE68: 8D 8C 26     STA $268C
03/CE6B: AD 2A 35     LDA $352A
03/CE6E: D0 37        BNE $CEA7       ; branch if an item
03/CE70: AD EB 38     LDA $38EB
03/CE73: D0 32        BNE $CEA7       ; branch if weapon magic
03/CE75: AD 83 26     LDA $2683
03/CE78: 29 04        AND #$04
03/CE7A: F0 07        BEQ $CE83       ; branch if attacker is not mute
03/CE7C: AD D2 26     LDA $26D2
03/CE7F: C9 5F        CMP #$5F
03/CE81: 90 1E        BCC $CEA1       ; branch if white, black, or summon
03/CE83: AD 83 26     LDA $2683
03/CE86: 29 20        AND #$20
03/CE88: F0 09        BEQ $CE93       ; branch if attacker doesn't have mini status
03/CE8A: AD D2 26     LDA $26D2
03/CE8D: C9 19        CMP #$19
03/CE8F: F0 16        BEQ $CEA7       ; branch if using mini spell
03/CE91: D0 0E        BNE $CEA1
03/CE93: AD 83 26     LDA $2683
03/CE96: 29 08        AND #$08
03/CE98: F0 0D        BEQ $CEA7       ; branch if attacker doesn't have piggy status
03/CE9A: AD D2 26     LDA $26D2
03/CE9D: C9 1A        CMP #$1A
03/CE9F: F0 06        BEQ $CEA7       ; branch if using piggy spell
03/CEA1: 9C 50 35     STZ $3550
03/CEA4: 4C 90 D2     JMP $D290
03/CEA7: 7B           TDC 
03/CEA8: AA           TAX 
03/CEA9: AD D2 26     LDA $26D2
03/CEAC: C9 19        CMP #$19
03/CEAE: B0 01        BCS $CEB1       ; branch if not white magic
03/CEB0: E8           INX 
03/CEB1: 86 C7        STX $C7
03/CEB3: BD 97 26     LDA $2697,X     ; magic/item hit rate + (intellect or spirit) / 2
03/CEB6: 4A           LSR 
03/CEB7: 85 A9        STA $A9
03/CEB9: AD 9E 28     LDA $289E
03/CEBC: 29 7F        AND #$7F
03/CEBE: 18           CLC 
03/CEBF: 65 A9        ADC $A9
03/CEC1: 90 02        BCC $CEC5
03/CEC3: A9 FF        LDA #$FF        ; max 255
03/CEC5: 8D FA 38     STA $38FA       ; set hit rate
03/CEC8: AD 83 26     LDA $2683
03/CECB: 29 02        AND #$02
03/CECD: F0 03        BEQ $CED2       ; branch if attacker is not blind
03/CECF: 4E FA 38     LSR $38FA       ; halve hit rate
03/CED2: A5 CD        LDA $CD
03/CED4: 29 7F        AND #$7F
03/CED6: D0 19        BNE $CEF1       ; branch if attacker not in 1st slot
03/CED8: AD FA 38     LDA $38FA
03/CEDB: 85 DF        STA $DF
03/CEDD: A9 05        LDA #$05        ; hit rate +25%
03/CEDF: 85 E1        STA $E1
03/CEE1: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/CEE4: 46 E4        LSR $E4
03/CEE6: 66 E3        ROR $E3
03/CEE8: 46 E4        LSR $E4
03/CEEA: 66 E3        ROR $E3
03/CEEC: A5 E3        LDA $E3
03/CEEE: 8D FA 38     STA $38FA
03/CEF1: AD 9F 28     LDA $289F
03/CEF4: 29 80        AND #$80
03/CEF6: F0 07        BEQ $CEFF       ; branch if not fixed no. of hits
03/CEF8: A9 01        LDA #$01
03/CEFA: 8D FB 38     STA $38FB       ; 1 hit
03/CEFD: 80 0C        BRA $CF0B
03/CEFF: A6 C7        LDX $C7
03/CF01: BD 97 26     LDA $2697,X     ; (intellect or spirit) / 2 + 1
03/CF04: 20 86 84     JSR $8486       ; lsr2
03/CF07: 1A           INC 
03/CF08: 8D FB 38     STA $38FB       ; set base no. of hits
03/CF0B: 20 87 C9     JSR $C987       ; get number of hits
03/CF0E: AD FD 38     LDA $38FD
03/CF11: 8D 51 35     STA $3551       ; set no. of hits
03/CF14: AD 2A 35     LDA $352A
03/CF17: D0 05        BNE $CF1E       ; branch if an item
03/CF19: AD ED 38     LDA $38ED
03/CF1C: F0 05        BEQ $CF23       ; branch if not using a summon
03/CF1E: A9 08        LDA #$08        ; 8 hits
03/CF20: 8D 51 35     STA $3551
03/CF23: AD EB 38     LDA $38EB
03/CF26: F0 06        BEQ $CF2E       ; branch if not weapon magic
03/CF28: AD EC 38     LDA $38EC       ; use weapon magic no. of hits
03/CF2B: 8D 51 35     STA $3551
; start of target loop
03/CF2E: 9C 54 35     STZ $3554       ; clear reflect target flag
03/CF31: 7B           TDC 
03/CF32: AA           TAX 
03/CF33: AD 4F 35     LDA $354F       ; targets
03/CF36: 0A           ASL 
03/CF37: B0 03        BCS $CF3C       ; find first target
03/CF39: E8           INX 
03/CF3A: D0 FA        BNE $CF36
03/CF3C: AD 4F 35     LDA $354F
03/CF3F: 20 5A 85     JSR $855A       ; clear bit
03/CF42: 8D 4F 35     STA $354F
03/CF45: 8A           TXA 
03/CF46: 0D 4E 35     ORA $354E
03/CF49: 85 CE        STA $CE
03/CF4B: A5 CE        LDA $CE
03/CF4D: 10 05        BPL $CF54       ; branch if character target
03/CF4F: 29 7F        AND #$7F
03/CF51: 18           CLC 
03/CF52: 69 05        ADC #$05
03/CF54: AA           TAX 
03/CF55: BD 40 35     LDA $3540,X
03/CF58: F0 03        BEQ $CF5D       ; branch if target present
03/CF5A: 4C 33 D0     JMP $D033
03/CF5D: A5 CE        LDA $CE
03/CF5F: 20 63 B1     JSR $B163       ; get pointer to character/monster properties
03/CF62: A0 7F 00     LDY #$007F
03/CF65: B1 80        LDA ($80),Y
03/CF67: 99 00 27     STA $2700,Y     ; copy target properties to buffer
03/CF6A: 88           DEY 
03/CF6B: 10 F8        BPL $CF65
03/CF6D: AD 06 27     LDA $2706
03/CF70: 29 20        AND #$20
03/CF72: F0 05        BEQ $CF79       ; branch if target doesn't have reflect
03/CF74: AD A1 28     LDA $28A1
03/CF77: 10 03        BPL $CF7C       ; branch if attack can be reflected
03/CF79: 4C 04 D0     JMP $D004
; magic reflected
03/CF7C: A5 CE        LDA $CE
03/CF7E: 10 0D        BPL $CF8D       ; branch if character target
03/CF80: 20 08 C4     JSR $C408       ; find valid character target
03/CF83: A5 A9        LDA $A9
03/CF85: F0 06        BEQ $CF8D       ; branch if a target was found
03/CF87: 9C 50 35     STZ $3550       ; clear targets
03/CF8A: 4C 90 D2     JMP $D290
03/CF8D: 20 30 E0     JSR $E030       ; remove target
03/CF90: A5 CE        LDA $CE
03/CF92: 29 7F        AND #$7F
03/CF94: AA           TAX 
03/CF95: 7B           TDC 
03/CF96: 20 5F 85     JSR $855F       ; set bit
03/CF99: 85 A9        STA $A9
03/CF9B: AD 22 35     LDA $3522       ; set target reflected off of
03/CF9E: 05 A9        ORA $A9
03/CFA0: 8D 22 35     STA $3522
03/CFA3: AD 4E 35     LDA $354E       ; toggle target side
03/CFA6: 49 80        EOR #$80
03/CFA8: 10 04        BPL $CFAE
03/CFAA: A9 07        LDA #$07        ; choose random monster
03/CFAC: 80 02        BRA $CFB0
03/CFAE: A9 04        LDA #$04        ; choose random character
03/CFB0: A2 00 00     LDX #$0000
03/CFB3: 20 79 83     JSR $8379       ; random (X..A)
03/CFB6: 85 A9        STA $A9
03/CFB8: AD 4E 35     LDA $354E
03/CFBB: 49 80        EOR #$80
03/CFBD: 10 07        BPL $CFC6
03/CFBF: A5 A9        LDA $A9
03/CFC1: 18           CLC 
03/CFC2: 69 05        ADC #$05
03/CFC4: 80 02        BRA $CFC8
03/CFC6: A5 A9        LDA $A9
03/CFC8: AA           TAX 
03/CFC9: BD 40 35     LDA $3540,X
03/CFCC: D0 D5        BNE $CFA3       ; branch if target is not present
03/CFCE: AD 4E 35     LDA $354E
03/CFD1: 29 80        AND #$80
03/CFD3: 49 80        EOR #$80
03/CFD5: 05 A9        ORA $A9
03/CFD7: 85 CE        STA $CE
03/CFD9: 20 63 B1     JSR $B163       ; get pointer to character/monster properties
03/CFDC: A0 7F 00     LDY #$007F
03/CFDF: B1 80        LDA ($80),Y
03/CFE1: 99 00 27     STA $2700,Y     ; copy target properties to buffer
03/CFE4: 88           DEY 
03/CFE5: 10 F8        BPL $CFDF
03/CFE7: AD 03 27     LDA $2703
03/CFEA: 29 C0        AND #$C0
03/CFEC: D0 B5        BNE $CFA3       ; branch if target is dead or stone
03/CFEE: A5 CE        LDA $CE
03/CFF0: 29 7F        AND #$7F
03/CFF2: AA           TAX 
03/CFF3: 7B           TDC 
03/CFF4: 20 5F 85     JSR $855F       ; set bit
03/CFF7: 85 A9        STA $A9
03/CFF9: AD 23 35     LDA $3523       ; set target reflected onto
03/CFFC: 05 A9        ORA $A9
03/CFFE: 8D 23 35     STA $3523
03/D001: EE 54 35     INC $3554       ; set reflect target flag
; end of reflect section
03/D004: AD 03 27     LDA $2703
03/D007: 29 C0        AND #$C0
03/D009: D0 0C        BNE $D017       ; branch if target is dead or stone
03/D00B: AD 05 27     LDA $2705
03/D00E: 29 02        AND #$02
03/D010: D0 21        BNE $D033       ; remove target if jumping
03/D012: AD 06 27     LDA $2706
03/D015: 10 22        BPL $D039       ; branch if target is not hiding
03/D017: 29 80        AND #$80
03/D019: D0 0B        BNE $D026       ; branch if hiding or dead
; stone target
03/D01B: AD 9F 28     LDA $289F       ; magic effect
03/D01E: 29 7F        AND #$7F
03/D020: C9 0B        CMP #$0B
03/D022: F0 15        BEQ $D039       ; branch if esuna (heal)
03/D024: D0 0D        BNE $D033       ; otherwise, remove stone target
; dead target
03/D026: AD 9F 28     LDA $289F
03/D029: 29 7F        AND #$7F
03/D02B: C9 0A        CMP #$0A
03/D02D: F0 0A        BEQ $D039       ; branch if life
03/D02F: C9 30        CMP #$30
03/D031: F0 06        BEQ $D039       ; branch if revive monster
03/D033: 20 30 E0     JSR $E030       ; remove target
03/D036: 4C 74 D2     JMP $D274
; valid target
03/D039: A9 02        LDA #$02        ; set damage multipliers to 1x
03/D03B: 8D FE 38     STA $38FE
03/D03E: 8D FF 38     STA $38FF
03/D041: A9 00        LDA #$00
03/D043: 8D 00 39     STA $3900       ; clear crit flag
03/D046: 85 AA        STA $AA
03/D048: AD 9D 28     LDA $289D       ; magic/item attack power
03/D04B: 85 A9        STA $A9
03/D04D: AD 84 35     LDA $3584
03/D050: F0 0E        BEQ $D060       ; branch if not a summon
03/D052: 06 A9        ASL $A9         ; power * 8
03/D054: 26 AA        ROL $AA
03/D056: 06 A9        ASL $A9
03/D058: 26 AA        ROL $AA
03/D05A: 06 A9        ASL $A9
03/D05C: 26 AA        ROL $AA
03/D05E: 80 08        BRA $D068
03/D060: 06 A9        ASL $A9         ; power * 4
03/D062: 26 AA        ROL $AA
03/D064: 06 A9        ASL $A9
03/D066: 26 AA        ROL $AA
03/D068: A6 A9        LDX $A9
03/D06A: 8E 02 39     STX $3902       ; set base attack
03/D06D: 7B           TDC 
03/D06E: AA           TAX 
03/D06F: 86 A4        STX $A4
03/D071: 86 A2        STX $A2
03/D073: A5 CD        LDA $CD
03/D075: 29 80        AND #$80
03/D077: D0 0B        BNE $D084       ; branch if monster attacker
03/D079: A5 CE        LDA $CE
03/D07B: 29 80        AND #$80
03/D07D: D0 05        BNE $D084       ; branch if monster target
; character vs. character
03/D07F: 8E 04 39     STX $3904       ; set defense to zero
03/D082: 80 07        BRA $D08B
03/D084: AD 24 27     LDA $2724       ; mag. def
03/D087: AA           TAX 
03/D088: 8E 04 39     STX $3904
03/D08B: A5 CE        LDA $CE
03/D08D: 10 05        BPL $D094       ; branch if character target
03/D08F: 29 7F        AND #$7F
03/D091: 18           CLC 
03/D092: 69 05        ADC #$05
03/D094: 85 CF        STA $CF
03/D096: 20 89 84     JSR $8489       ; set current character/monster
03/D099: AD 23 27     LDA $2723       ; mag. def rate
03/D09C: 8D FA 38     STA $38FA
03/D09F: AD 03 27     LDA $2703
03/D0A2: 29 02        AND #$02
03/D0A4: F0 03        BEQ $D0A9       ; branch if target is not blind
03/D0A6: 4E FA 38     LSR $38FA       ; halve mag. def rate
03/D0A9: A5 CD        LDA $CD
03/D0AB: 29 7F        AND #$7F
03/D0AD: D0 19        BNE $D0C8       ; branch if attacker not in 1st slot
03/D0AF: AD FA 38     LDA $38FA
03/D0B2: 85 DF        STA $DF
03/D0B4: A9 05        LDA #$05        ; mag. def rate +25%
03/D0B6: 85 E1        STA $E1
03/D0B8: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/D0BB: 46 E4        LSR $E4
03/D0BD: 66 E3        ROR $E3
03/D0BF: 46 E4        LSR $E4
03/D0C1: 66 E3        ROR $E3
03/D0C3: A5 E3        LDA $E3
03/D0C5: 8D FA 38     STA $38FA
03/D0C8: AD 22 27     LDA $2722       ; mag. def multiplier
03/D0CB: 8D FB 38     STA $38FB
03/D0CE: F0 0C        BEQ $D0DC       ; branch if zero mag. def
03/D0D0: AD 9F 28     LDA $289F
03/D0D3: 29 80        AND #$80
03/D0D5: F0 05        BEQ $D0DC       ; branch if not fixed no. of hits
03/D0D7: A9 01        LDA #$01        ; 1 hit
03/D0D9: 8D FB 38     STA $38FB
03/D0DC: AD 03 27     LDA $2703
03/D0DF: 29 20        AND #$20
03/D0E1: D0 07        BNE $D0EA       ; branch if toad
03/D0E3: AD 05 27     LDA $2705
03/D0E6: 29 08        AND #$08
03/D0E8: F0 03        BEQ $D0ED       ; branch if not using focus
03/D0EA: 9C FB 38     STZ $38FB       ; zero mag. def multiplier
03/D0ED: A5 CE        LDA $CE
03/D0EF: 10 0F        BPL $D100       ; branch if character target
03/D0F1: AD 24 27     LDA $2724
03/D0F4: C9 FF        CMP #$FF
03/D0F6: D0 08        BNE $D100       ; branch if not 255 mag.def (katsuhisa higuchi)
03/D0F8: A9 63        LDA #$63
03/D0FA: 8D FB 38     STA $38FB       ; mag. def multiplier = 99
03/D0FD: 8D FA 38     STA $38FA       ; mag. def rate = 99
03/D100: 20 87 C9     JSR $C987       ; get number of hits
03/D103: A5 CD        LDA $CD
03/D105: 29 80        AND #$80
03/D107: D0 0C        BNE $D115       ; branch if monster attacker
03/D109: A5 CE        LDA $CE
03/D10B: 29 80        AND #$80
03/D10D: D0 06        BNE $D115       ; branch if monster target
; character vs. character
03/D10F: 38           SEC 
03/D110: AD 51 35     LDA $3551       ; don't subtract mag.def hits
03/D113: 80 11        BRA $D126
03/D115: AD 70 27     LDA $2770
03/D118: 10 05        BPL $D11F       ; branch if not a boss
03/D11A: AD 9E 28     LDA $289E
03/D11D: 30 0E        BMI $D12D       ; branch if always misses bosses
03/D11F: 38           SEC 
03/D120: AD 51 35     LDA $3551
03/D123: ED FD 38     SBC $38FD       ; subtract mag.def hits from base hits
03/D126: 8D FC 38     STA $38FC
03/D129: F0 02        BEQ $D12D
03/D12B: B0 25        BCS $D152
; no hits
03/D12D: AD 2A 35     LDA $352A
03/D130: D0 1A        BNE $D14C       ; branch if an item
03/D132: AD D2 26     LDA $26D2
03/D135: C9 A0        CMP #$A0
03/D137: F0 0C        BEQ $D145       ; branch if self-destruct (explode)
03/D139: C9 5F        CMP #$5F
03/D13B: 90 0F        BCC $D14C       ; spell $5F
03/D13D: C9 94        CMP #$94
03/D13F: 90 04        BCC $D145
03/D141: C9 A9        CMP #$A9
03/D143: 90 07        BCC $D14C
03/D145: A9 01        LDA #$01        ; do 1 hit anyway
03/D147: 8D FC 38     STA $38FC
03/D14A: 80 06        BRA $D152
03/D14C: 20 30 E0     JSR $E030       ; remove target
03/D14F: 4C B1 D1     JMP $D1B1
; 1 or more hits
03/D152: A5 CE        LDA $CE
03/D154: 10 15        BPL $D16B       ; branch if character target
03/D156: C5 CD        CMP $CD
03/D158: F0 11        BEQ $D16B       ; branch if self-target
03/D15A: AD 81 38     LDA $3881
03/D15D: F0 0C        BEQ $D16B       ; branch if monsters are not invincible
03/D15F: AD 2A 35     LDA $352A
03/D162: F0 E8        BEQ $D14C       ; branch if not an item
03/D164: AD D2 26     LDA $26D2
03/D167: C9 C8        CMP #$C8
03/D169: D0 E1        BNE $D14C       ; branch if not crystal
03/D16B: AD 84 35     LDA $3584
03/D16E: F0 0F        BEQ $D17F       ; branch if summon flag is not set
03/D170: AD D2 26     LDA $26D2
03/D173: C9 5A        CMP #$5A
03/D175: 90 04        BCC $D17B       ; branch if not asura
03/D177: C9 5D        CMP #$5D
03/D179: 90 04        BCC $D17F       ; branch if asura
03/D17B: A5 CE        LDA $CE
03/D17D: 10 AE        BPL $D12D       ; no hits if character target
03/D17F: AD 9F 28     LDA $289F       ; attack effect
03/D182: 29 7F        AND #$7F
03/D184: C9 7E        CMP #$7E
03/D186: F0 0C        BEQ $D194       ; branch if graphics only
03/D188: C9 7F        CMP #$7F
03/D18A: D0 0E        BNE $D19A       ; branch if not no effect
03/D18C: 20 B1 85     JSR $85B1       ; add message to graphics script
03/D18F: A9 00        LDA #$00        ;  (nothing happened)
03/D191: 8D CA 34     STA $34CA
03/D194: 9C 50 35     STZ $3550       ; clear targets
03/D197: 4C 74 D2     JMP $D274
03/D19A: 48           PHA 
03/D19B: A5 CE        LDA $CE
03/D19D: C5 CD        CMP $CD
03/D19F: D0 0C        BNE $D1AD       ; branch if not self-target
03/D1A1: AD 8B 26     LDA $268B       ; copy attacker mp to target
03/D1A4: 8D 0B 27     STA $270B
03/D1A7: AD 8C 26     LDA $268C
03/D1AA: 8D 0C 27     STA $270C
03/D1AD: 68           PLA 
03/D1AE: 20 97 D2     JSR $D297       ; do magic effect
03/D1B1: AD 53 35     LDA $3553
03/D1B4: D0 59        BNE $D20F       ; branch if self-target
03/D1B6: A5 CD        LDA $CD         ; attacker
03/D1B8: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/D1BB: BD D4 34     LDA $34D4,X
03/D1BE: 1D D5 34     ORA $34D5,X
03/D1C1: F0 42        BEQ $D205       ; branch if target hasn't taken damage yet
; add to previous damage (attacker)
03/D1C3: A5 A3        LDA $A3
03/D1C5: 29 3F        AND #$3F
03/D1C7: 85 A3        STA $A3
03/D1C9: BD D5 34     LDA $34D5,X
03/D1CC: 48           PHA 
03/D1CD: 29 80        AND #$80
03/D1CF: 85 A9        STA $A9
03/D1D1: 68           PLA 
03/D1D2: 29 3F        AND #$3F
03/D1D4: 9D D5 34     STA $34D5,X
03/D1D7: 18           CLC 
03/D1D8: BD D4 34     LDA $34D4,X
03/D1DB: 65 A2        ADC $A2
03/D1DD: 9D D4 34     STA $34D4,X
03/D1E0: BD D5 34     LDA $34D5,X
03/D1E3: 65 A3        ADC $A3
03/D1E5: 9D D5 34     STA $34D5,X
03/D1E8: C2 20        REP #$20
03/D1EA: BD D4 34     LDA $34D4,X
03/D1ED: C9 0F 27     CMP #$270F
03/D1F0: 90 06        BCC $D1F8
03/D1F2: A9 0F 27     LDA #$270F
03/D1F5: 9D D4 34     STA $34D4,X
03/D1F8: 7B           TDC 
03/D1F9: E2 20        SEP #$20
03/D1FB: BD D5 34     LDA $34D5,X
03/D1FE: 05 A9        ORA $A9
03/D200: 9D D5 34     STA $34D5,X
03/D203: 80 0A        BRA $D20F
; set attacker damage
03/D205: A5 A2        LDA $A2
03/D207: 9D D4 34     STA $34D4,X
03/D20A: A5 A3        LDA $A3
03/D20C: 9D D5 34     STA $34D5,X
03/D20F: A5 CE        LDA $CE         ; target
03/D211: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/D214: BD D4 34     LDA $34D4,X
03/D217: 1D D5 34     ORA $34D5,X
03/D21A: F0 42        BEQ $D25E       ; branch if no damage
03/D21C: A5 A5        LDA $A5
03/D21E: 29 3F        AND #$3F
03/D220: 85 A5        STA $A5
03/D222: BD D5 34     LDA $34D5,X
03/D225: 48           PHA 
03/D226: 29 80        AND #$80
03/D228: 85 A9        STA $A9         ; save msb
03/D22A: 68           PLA 
03/D22B: 29 3F        AND #$3F
03/D22D: 9D D5 34     STA $34D5,X
03/D230: 18           CLC 
03/D231: BD D4 34     LDA $34D4,X
03/D234: 65 A4        ADC $A4
03/D236: 9D D4 34     STA $34D4,X
03/D239: BD D5 34     LDA $34D5,X
03/D23C: 65 A5        ADC $A5
03/D23E: 9D D5 34     STA $34D5,X
03/D241: C2 20        REP #$20
03/D243: BD D4 34     LDA $34D4,X
03/D246: C9 0F 27     CMP #$270F      ; max 9999
03/D249: 90 06        BCC $D251
03/D24B: A9 0F 27     LDA #$270F
03/D24E: 9D D4 34     STA $34D4,X
03/D251: 7B           TDC 
03/D252: E2 20        SEP #$20
03/D254: BD D5 34     LDA $34D5,X
03/D257: 05 A9        ORA $A9
03/D259: 9D D5 34     STA $34D5,X
03/D25C: 80 0A        BRA $D268
03/D25E: A5 A4        LDA $A4
03/D260: 9D D4 34     STA $34D4,X     ; set target damage
03/D263: A5 A5        LDA $A5
03/D265: 9D D5 34     STA $34D5,X
03/D268: A5 CE        LDA $CE
03/D26A: C5 CD        CMP $CD
03/D26C: D0 03        BNE $D271       ; branch if not self-target
03/D26E: EE 53 35     INC $3553       ; set self-target flag
03/D271: 20 1A 85     JSR $851A       ; copy attacker/target properties from buffer
; next target
03/D274: CE 4D 35     DEC $354D
03/D277: AD 4D 35     LDA $354D
03/D27A: F0 03        BEQ $D27F
03/D27C: 4C 2E CF     JMP $CF2E
03/D27F: A5 CD        LDA $CD
03/D281: 10 0A        BPL $D28D       ; branch if character attacker
03/D283: AE 96 28     LDX $2896
03/D286: BD C2 33     LDA $33C2,X
03/D289: C9 F8        CMP #$F8
03/D28B: D0 03        BNE $D290       ; branch if an attack chain ???
03/D28D: 20 6E CA     JSR $CA6E       ; update hp after damage
03/D290: AD 50 35     LDA $3550
03/D293: 8D C5 34     STA $34C5       ; set targets for graphics ???
03/D296: 60           RTS 

; [ do magic effect ]

03/D297: 0A           ASL 
03/D298: AA           TAX 
03/D299: BF 94 E0 03  LDA $03E094,X   ; magic effect jump table
03/D29D: 85 80        STA $80
03/D29F: BF 95 E0 03  LDA $03E095,X
03/D2A3: 85 81        STA $81
03/D2A5: A9 03        LDA #$03
03/D2A7: 85 82        STA $82
03/D2A9: DC 80 00     JML [$0080]

; [ validate magic targets ]

; A: targets

03/D2AC: 85 A9        STA $A9
03/D2AE: 20 0C 85     JSR $850C       ; count bits
03/D2B1: CA           DEX 
03/D2B2: F0 77        BEQ $D32B
03/D2B4: AD E7 38     LDA $38E7
03/D2B7: D0 72        BNE $D32B       ; branch if must target must be dead
03/D2B9: AD 2A 35     LDA $352A
03/D2BC: D0 1B        BNE $D2D9
03/D2BE: AD D2 26     LDA $26D2
03/D2C1: C9 13        CMP #$13
03/D2C3: F0 66        BEQ $D32B
03/D2C5: C9 14        CMP #$14
03/D2C7: F0 62        BEQ $D32B
03/D2C9: C9 AB        CMP #$AB
03/D2CB: F0 5E        BEQ $D32B
03/D2CD: C9 AC        CMP #$AC
03/D2CF: F0 5A        BEQ $D32B
03/D2D1: C9 8F        CMP #$8F
03/D2D3: F0 56        BEQ $D32B
03/D2D5: C9 5C        CMP #$5C
03/D2D7: F0 52        BEQ $D32B
03/D2D9: A2 05 00     LDX #$0005
03/D2DC: 86 AB        STX $AB
03/D2DE: 7B           TDC 
03/D2DF: AA           TAX 
03/D2E0: A8           TAY 
03/D2E1: AD 4E 35     LDA $354E
03/D2E4: 10 07        BPL $D2ED
03/D2E6: A2 05 00     LDX #$0005
03/D2E9: A9 0D        LDA #$0D
03/D2EB: 85 AB        STA $AB
03/D2ED: BD 40 35     LDA $3540,X
03/D2F0: D0 34        BNE $D326
03/D2F2: DA           PHX 
03/D2F3: 8A           TXA 
03/D2F4: 85 DF        STA $DF
03/D2F6: A9 80        LDA #$80
03/D2F8: 85 E1        STA $E1
03/D2FA: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/D2FD: FA           PLX 
03/D2FE: A4 E3        LDY $E3
03/D300: B9 03 20     LDA $2003,Y
03/D303: 29 C0        AND #$C0
03/D305: D0 0C        BNE $D313
03/D307: B9 05 20     LDA $2005,Y
03/D30A: 29 02        AND #$02
03/D30C: D0 05        BNE $D313
03/D30E: B9 06 20     LDA $2006,Y
03/D311: 10 13        BPL $D326
03/D313: DA           PHX 
03/D314: E0 05 00     CPX #$0005
03/D317: 90 05        BCC $D31E
03/D319: 8A           TXA 
03/D31A: 38           SEC 
03/D31B: E9 05        SBC #$05
03/D31D: AA           TAX 
03/D31E: A5 A9        LDA $A9
03/D320: 20 5A 85     JSR $855A       ; clear bit
03/D323: 85 A9        STA $A9
03/D325: FA           PLX 
03/D326: E8           INX 
03/D327: E4 AB        CPX $AB
03/D329: D0 C2        BNE $D2ED
03/D32B: A5 A9        LDA $A9
03/D32D: 60           RTS 

; [ check if attack name is shown ]

03/D32E: 48           PHA 
03/D32F: 64 A9        STZ $A9
03/D331: 4A           LSR 
03/D332: 66 A9        ROR $A9
03/D334: 4A           LSR 
03/D335: 66 A9        ROR $A9
03/D337: 4A           LSR 
03/D338: 66 A9        ROR $A9
03/D33A: AA           TAX 
03/D33B: A5 A9        LDA $A9
03/D33D: 20 83 84     JSR $8483       ; lsr5
03/D340: 85 A9        STA $A9
03/D342: A5 A9        LDA $A9
03/D344: A8           TAY 
03/D345: BF BC FE 13  LDA $13FEBC,X   ; attacks that don't show attack name
03/D349: 0A           ASL 
03/D34A: 88           DEY 
03/D34B: 10 FC        BPL $D349
03/D34D: 90 03        BCC $D352
03/D34F: 68           PLA 
03/D350: 7B           TDC             ; if set, return zero (don't show name)
03/D351: 60           RTS 
03/D352: 68           PLA             ; otherwise, return attack id
03/D353: 60           RTS 

; [ check if monster flash is disabled ]

03/D354: 64 A9        STZ $A9
03/D356: 4A           LSR 
03/D357: 66 A9        ROR $A9
03/D359: 4A           LSR 
03/D35A: 66 A9        ROR $A9
03/D35C: 4A           LSR 
03/D35D: 66 A9        ROR $A9
03/D35F: AA           TAX 
03/D360: A5 A9        LDA $A9
03/D362: 20 83 84     JSR $8483       ; lsr5
03/D365: 85 A9        STA $A9
03/D367: A5 A9        LDA $A9
03/D369: A8           TAY 
03/D36A: BF D4 FE 13  LDA $13FED4,X   ; attacks with no monster flash
03/D36E: 0A           ASL 
03/D36F: 88           DEY 
03/D370: 10 FC        BPL $D36E
03/D372: 90 02        BCC $D376
03/D374: 6A           ROR 
03/D375: 60           RTS 
03/D376: 7B           TDC 
03/D377: 60           RTS 

; magic effect $00: magic damage
03/D378: 20 00 E1     JSR $E100       ; check elemental resistance
03/D37B: AD FE 38     LDA $38FE
03/D37E: 10 08        BPL $D388
03/D380: 29 7F        AND #$7F
03/D382: 8D FE 38     STA $38FE
03/D385: 4C 16 D4     JMP $D416
03/D388: 20 33 E1     JSR $E133       ; check elemental weakness
03/D38B: AD 04 27     LDA $2704
03/D38E: 29 40        AND #$40
03/D390: F0 1C        BEQ $D3AE
03/D392: AD 2A 35     LDA $352A
03/D395: D0 10        BNE $D3A7
03/D397: AD D2 26     LDA $26D2
03/D39A: C9 28        CMP #$28
03/D39C: F0 13        BEQ $D3B1
03/D39E: C9 55        CMP #$55
03/D3A0: F0 0F        BEQ $D3B1
03/D3A2: C9 A1        CMP #$A1
03/D3A4: D0 08        BNE $D3AE
03/D3A6: 60           RTS 
03/D3A7: AD D2 26     LDA $26D2
03/D3AA: C9 C7        CMP #$C7
03/D3AC: F0 03        BEQ $D3B1
03/D3AE: 20 9F C9     JSR $C99F       ; calculate damage
03/D3B1: 60           RTS 
; magic effect $01: magic damage w/ sap
03/D3B2: 20 00 E1     JSR $E100       ; check elemental resistance
03/D3B5: AD FE 38     LDA $38FE
03/D3B8: 10 08        BPL $D3C2
03/D3BA: 29 7F        AND #$7F
03/D3BC: 8D FE 38     STA $38FE
03/D3BF: 4C 0C D4     JMP $D40C
03/D3C2: 20 33 E1     JSR $E133       ; check elemental weakness
03/D3C5: 20 9F C9     JSR $C99F       ; calculate damage
03/D3C8: AD 2A 35     LDA $352A
03/D3CB: D0 09        BNE $D3D6
03/D3CD: AD D2 26     LDA $26D2
03/D3D0: C9 0B        CMP #$0B
03/D3D2: D0 10        BNE $D3E4
03/D3D4: F0 07        BEQ $D3DD
03/D3D6: AD D2 26     LDA $26D2
03/D3D9: C9 C8        CMP #$C8
03/D3DB: D0 07        BNE $D3E4
03/D3DD: AD 40 27     LDA $2740
03/D3E0: 29 80        AND #$80
03/D3E2: F0 27        BEQ $D40B
03/D3E4: AD 06 27     LDA $2706
03/D3E7: 09 40        ORA #$40
03/D3E9: 8D 06 27     STA $2706
03/D3EC: A9 09        LDA #$09
03/D3EE: 85 D6        STA $D6
03/D3F0: A5 CF        LDA $CF
03/D3F2: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D3F5: A9 06        LDA #$06        ; sap timer
03/D3F7: 20 C8 85     JSR $85C8       ; set timer
03/D3FA: A9 40        LDA #$40
03/D3FC: 9D 06 2A     STA $2A06,X
03/D3FF: A5 CF        LDA $CF
03/D401: 0A           ASL 
03/D402: AA           TAX 
03/D403: BD EB 29     LDA $29EB,X     ; enable sap timer
03/D406: 09 20        ORA #$20
03/D408: 9D EB 29     STA $29EB,X
03/D40B: 60           RTS 
; magic effect $02: restore hp
03/D40C: AD 40 27     LDA $2740
03/D40F: 29 80        AND #$80
03/D411: F0 03        BEQ $D416
03/D413: 4C AE D3     JMP $D3AE
03/D416: AD 2A 35     LDA $352A
03/D419: D0 1E        BNE $D439
03/D41B: AD D2 26     LDA $26D2
03/D41E: C9 11        CMP #$11
03/D420: D0 17        BNE $D439
03/D422: AD 06 39     LDA $3906
03/D425: C9 01        CMP #$01
03/D427: D0 10        BNE $D439
03/D429: C2 20        REP #$20
03/D42B: 38           SEC 
03/D42C: AD 09 27     LDA $2709
03/D42F: ED 07 27     SBC $2707
03/D432: 85 A4        STA $A4
03/D434: 7B           TDC 
03/D435: E2 20        SEP #$20
03/D437: 80 03        BRA $D43C
03/D439: 20 9F C9     JSR $C99F       ; calculate damage
03/D43C: A5 A5        LDA $A5
03/D43E: 09 80        ORA #$80
03/D440: 85 A5        STA $A5
03/D442: 60           RTS 
; magic effect $03: tornado/weak (single digit hp)
03/D443: A2 01 00     LDX #$0001
03/D446: A9 09        LDA #$09
03/D448: 20 79 83     JSR $8379       ; random (X..A)
03/D44B: AA           TAX 
03/D44C: 86 A9        STX $A9
03/D44E: C2 20        REP #$20
03/D450: AD 07 27     LDA $2707
03/D453: C5 A9        CMP $A9
03/D455: 90 08        BCC $D45F
03/D457: A5 A9        LDA $A9
03/D459: 8D 07 27     STA $2707
03/D45C: E2 20        SEP #$20
03/D45E: 60           RTS 
03/D45F: 7B           TDC 
03/D460: E2 20        SEP #$20
03/D462: 20 30 E0     JSR $E030       ; remove target
03/D465: 60           RTS 
; magic effect $04: drain hp
03/D466: A5 CD        LDA $CD
03/D468: C5 CE        CMP $CE
03/D46A: F0 1B        BEQ $D487
03/D46C: 20 9F C9     JSR $C99F       ; calculate damage
03/D46F: A6 A4        LDX $A4
03/D471: 86 A2        STX $A2
03/D473: AD 40 27     LDA $2740
03/D476: 29 80        AND #$80
03/D478: F0 07        BEQ $D481
03/D47A: A5 A5        LDA $A5
03/D47C: 09 80        ORA #$80
03/D47E: 85 A5        STA $A5
03/D480: 60           RTS 
03/D481: A5 A3        LDA $A3
03/D483: 09 80        ORA #$80
03/D485: 85 A3        STA $A3
03/D487: 60           RTS 
; magic effect $05: drain mp
03/D488: A5 CD        LDA $CD
03/D48A: C5 CE        CMP $CE
03/D48C: D0 01        BNE $D48F
03/D48E: 60           RTS 
03/D48F: 20 9F C9     JSR $C99F       ; calculate damage
03/D492: A6 A4        LDX $A4
03/D494: 86 A2        STX $A2
03/D496: AD 40 27     LDA $2740
03/D499: 29 80        AND #$80
03/D49B: F0 02        BEQ $D49F
03/D49D: 80 3D        BRA $D4DC
03/D49F: C2 20        REP #$20
03/D4A1: 38           SEC 
03/D4A2: AD 0B 27     LDA $270B
03/D4A5: E5 A4        SBC $A4
03/D4A7: B0 0C        BCS $D4B5
03/D4A9: AD 0B 27     LDA $270B
03/D4AC: 85 A4        STA $A4
03/D4AE: 85 A2        STA $A2
03/D4B0: 9C 0B 27     STZ $270B
03/D4B3: 80 03        BRA $D4B8
03/D4B5: 8D 0B 27     STA $270B
03/D4B8: 18           CLC 
03/D4B9: AD 8B 26     LDA $268B
03/D4BC: 65 A4        ADC $A4
03/D4BE: 8D 8B 26     STA $268B
03/D4C1: AD 8D 26     LDA $268D
03/D4C4: CD 8B 26     CMP $268B
03/D4C7: B0 03        BCS $D4CC
03/D4C9: 8D 8B 26     STA $268B
03/D4CC: 7B           TDC 
03/D4CD: E2 20        SEP #$20
03/D4CF: A5 A5        LDA $A5
03/D4D1: 09 40        ORA #$40
03/D4D3: 85 A5        STA $A5
03/D4D5: A5 A3        LDA $A3
03/D4D7: 09 C0        ORA #$C0
03/D4D9: 85 A3        STA $A3
03/D4DB: 60           RTS 
03/D4DC: C2 20        REP #$20
03/D4DE: 38           SEC 
03/D4DF: AD 8B 26     LDA $268B
03/D4E2: E5 A4        SBC $A4
03/D4E4: B0 0C        BCS $D4F2
03/D4E6: AD 8B 26     LDA $268B
03/D4E9: 85 A4        STA $A4
03/D4EB: 85 A2        STA $A2
03/D4ED: 9C 8B 26     STZ $268B
03/D4F0: 80 03        BRA $D4F5
03/D4F2: 8D 8B 26     STA $268B
03/D4F5: 7B           TDC 
03/D4F6: E2 20        SEP #$20
03/D4F8: A5 A3        LDA $A3
03/D4FA: 09 40        ORA #$40
03/D4FC: 85 A3        STA $A3
03/D4FE: A5 A5        LDA $A5
03/D500: 09 C0        ORA #$C0
03/D502: 85 A5        STA $A5
03/D504: 60           RTS 
; magic effect $06: set status
03/D505: AD A3 28     LDA $28A3
03/D508: 10 0A        BPL $D514
03/D50A: AD 40 27     LDA $2740
03/D50D: 29 8A        AND #$8A
03/D50F: F0 03        BEQ $D514
03/D511: 4C A2 D5     JMP $D5A2
03/D514: AD 03 27     LDA $2703
03/D517: 85 AC        STA $AC
03/D519: 85 A9        STA $A9
03/D51B: AD 04 27     LDA $2704
03/D51E: 85 AA        STA $AA
03/D520: 29 BF        AND #$BF
03/D522: 85 AB        STA $AB
03/D524: AD A3 28     LDA $28A3
03/D527: 85 AE        STA $AE
03/D529: AD A4 28     LDA $28A4
03/D52C: 85 AD        STA $AD
03/D52E: C2 20        REP #$20
03/D530: A5 AB        LDA $AB
03/D532: C5 AD        CMP $AD
03/D534: 90 06        BCC $D53C
03/D536: 7B           TDC 
03/D537: E2 20        SEP #$20
03/D539: 4C A2 D5     JMP $D5A2
03/D53C: 7B           TDC 
03/D53D: E2 20        SEP #$20
03/D53F: AD 2B 27     LDA $272B
03/D542: 2D A3 28     AND $28A3
03/D545: D0 06        BNE $D54D
03/D547: AD 2C 27     LDA $272C
03/D54A: 2D A4 28     AND $28A4
03/D54D: D0 53        BNE $D5A2
03/D54F: AD 03 27     LDA $2703
03/D552: 05 AE        ORA $AE
03/D554: 8D 03 27     STA $2703
03/D557: AD 04 27     LDA $2704
03/D55A: 05 AD        ORA $AD
03/D55C: 8D 04 27     STA $2704
03/D55F: AD A4 28     LDA $28A4
03/D562: 29 28        AND #$28
03/D564: F0 3A        BEQ $D5A0
03/D566: AD 04 27     LDA $2704
03/D569: 29 FB        AND #$FB
03/D56B: 8D 04 27     STA $2704
03/D56E: A5 CF        LDA $CF
03/D570: 85 DF        STA $DF
03/D572: A9 15        LDA #$15
03/D574: 85 E1        STA $E1
03/D576: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/D579: A6 E3        LDX $E3
03/D57B: 8E 30 35     STX $3530
03/D57E: A9 03        LDA #$03
03/D580: 20 69 85     JSR $8569       ; get pointer to timer
03/D583: AE 98 35     LDX $3598
03/D586: AD 04 27     LDA $2704
03/D589: 29 20        AND #$20
03/D58B: F0 13        BEQ $D5A0
03/D58D: AD 04 27     LDA $2704
03/D590: 29 F7        AND #$F7
03/D592: 8D 04 27     STA $2704
03/D595: A9 01        LDA #$01
03/D597: 9D 04 2A     STA $2A04,X
03/D59A: 9E 05 2A     STZ $2A05,X
03/D59D: 9E 06 2A     STZ $2A06,X
03/D5A0: 80 03        BRA $D5A5
03/D5A2: 20 30 E0     JSR $E030       ; remove target
03/D5A5: 60           RTS 
; magic effect $07: sleep/paralyze
03/D5A6: A9 04        LDA #$04        ; timer duration function $04 (sleep/paralyze)
03/D5A8: 85 D6        STA $D6
03/D5AA: A5 CF        LDA $CF         ; target id
03/D5AC: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D5AF: A9 03        LDA #$03        ; action timer
03/D5B1: 20 69 85     JSR $8569       ; get pointer to timer
03/D5B4: AE 98 35     LDX $3598
03/D5B7: BD 06 2A     LDA $2A06,X
03/D5BA: D0 29        BNE $D5E5       ; branch if action timer is already stopped
03/D5BC: AD 2C 27     LDA $272C
03/D5BF: 2D A4 28     AND $28A4
03/D5C2: D0 21        BNE $D5E5       ; branch if immune to status
03/D5C4: AD 03 27     LDA $2703
03/D5C7: 85 AC        STA $AC
03/D5C9: AD 04 27     LDA $2704
03/D5CC: 29 BF        AND #$BF        ; mask float status
03/D5CE: 85 AB        STA $AB
03/D5D0: AD A3 28     LDA $28A3
03/D5D3: 85 AE        STA $AE
03/D5D5: AD A4 28     LDA $28A4
03/D5D8: 85 AD        STA $AD
03/D5DA: C2 20        REP #$20
03/D5DC: A5 AB        LDA $AB
03/D5DE: C5 AD        CMP $AD
03/D5E0: 90 06        BCC $D5E8       ; branch if higher priority than current status
03/D5E2: 7B           TDC 
03/D5E3: E2 20        SEP #$20
03/D5E5: 4C 30 E0     JMP $E030       ; remove target
03/D5E8: A5 CE        LDA $CE
03/D5EA: 10 08        BPL $D5F4       ; branch if a character
03/D5EC: AD 04 27     LDA $2704       ; clear charm and berserk status
03/D5EF: 29 F3        AND #$F3
03/D5F1: 8D 04 27     STA $2704
03/D5F4: 7B           TDC 
03/D5F5: E2 20        SEP #$20
03/D5F7: AD 04 27     LDA $2704       ; set new status
03/D5FA: 0D A4 28     ORA $28A4
03/D5FD: 8D 04 27     STA $2704
03/D600: AE 98 35     LDX $3598
03/D603: A5 D4        LDA $D4
03/D605: 9D 04 2A     STA $2A04,X     ; set timer duration
03/D608: A5 D5        LDA $D5
03/D60A: 9D 05 2A     STA $2A05,X
03/D60D: A9 40        LDA #$40
03/D60F: 9D 06 2A     STA $2A06,X     ; remove status when timer expires
03/D612: 60           RTS 
; magic effect $08: blink/image
03/D613: AD 06 27     LDA $2706
03/D616: 09 0C        ORA #$0C
03/D618: 8D 06 27     STA $2706
03/D61B: 60           RTS 
; magic effect $09: reflect (wall)
03/D61C: AD 06 27     LDA $2706
03/D61F: 0D A4 28     ORA $28A4
03/D622: 8D 06 27     STA $2706
03/D625: AD 9D 28     LDA $289D
03/D628: 8D 7B 39     STA $397B
03/D62B: A9 08        LDA #$08
03/D62D: 85 D6        STA $D6
03/D62F: A5 CF        LDA $CF
03/D631: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D634: A9 0F        LDA #$0F        ; reflect timer
03/D636: 20 C8 85     JSR $85C8       ; set timer
03/D639: A9 40        LDA #$40
03/D63B: 9D 06 2A     STA $2A06,X
03/D63E: A5 CF        LDA $CF
03/D640: 0A           ASL 
03/D641: AA           TAX 
03/D642: BD EB 29     LDA $29EB,X     ; enable reflect timer
03/D645: 09 04        ORA #$04
03/D647: 9D EB 29     STA $29EB,X
03/D64A: 60           RTS 
; magic effect $0A: life
03/D64B: A9 02        LDA #$02
03/D64D: 8D E6 38     STA $38E6
03/D650: AD 40 27     LDA $2740
03/D653: 29 80        AND #$80
03/D655: F0 0B        BEQ $D662
03/D657: A9 80        LDA #$80
03/D659: 8D A3 28     STA $28A3
03/D65C: 9C A4 28     STZ $28A4
03/D65F: 4C 14 D5     JMP $D514
03/D662: AD 03 27     LDA $2703
03/D665: 30 01        BMI $D668
03/D667: 60           RTS 
03/D668: 29 7E        AND #$7E
03/D66A: 8D 03 27     STA $2703
03/D66D: AD 04 27     LDA $2704
03/D670: 29 C0        AND #$C0
03/D672: 8D 04 27     STA $2704
03/D675: AD 05 27     LDA $2705
03/D678: 29 20        AND #$20
03/D67A: 8D 05 27     STA $2705
03/D67D: AD 06 27     LDA $2706
03/D680: 29 80        AND #$80
03/D682: 8D 06 27     STA $2706
03/D685: 64 D6        STZ $D6
03/D687: A5 CF        LDA $CF
03/D689: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D68C: A9 03        LDA #$03        ; action timer
03/D68E: 20 C8 85     JSR $85C8       ; set timer
03/D691: 9E 06 2A     STZ $2A06,X
03/D694: AD 2F 35     LDA $352F
03/D697: 0A           ASL 
03/D698: AA           TAX 
03/D699: A9 40        LDA #$40
03/D69B: 9D EB 29     STA $29EB,X     ; enable action timer
03/D69E: A5 CF        LDA $CF
03/D6A0: C9 05        CMP #$05
03/D6A2: 90 11        BCC $D6B5
03/D6A4: 38           SEC 
03/D6A5: E9 05        SBC #$05
03/D6A7: AA           TAX 
03/D6A8: BD BD 29     LDA $29BD,X
03/D6AB: 9D B5 29     STA $29B5,X
03/D6AE: AA           TAX 
03/D6AF: FE CA 29     INC $29CA,X
03/D6B2: EE CD 29     INC $29CD
03/D6B5: AD 2A 35     LDA $352A
03/D6B8: D0 0F        BNE $D6C9
03/D6BA: AD D2 26     LDA $26D2
03/D6BD: C9 14        CMP #$14
03/D6BF: F0 1A        BEQ $D6DB
03/D6C1: C9 AB        CMP #$AB
03/D6C3: F0 16        BEQ $D6DB
03/D6C5: C9 AC        CMP #$AC
03/D6C7: F0 12        BEQ $D6DB
03/D6C9: AD 16 27     LDA $2716
03/D6CC: 85 DF        STA $DF
03/D6CE: A9 05        LDA #$05
03/D6D0: 85 E1        STA $E1
03/D6D2: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/D6D5: A6 E3        LDX $E3
03/D6D7: 8E 07 27     STX $2707
03/D6DA: 60           RTS 
03/D6DB: AD 09 27     LDA $2709
03/D6DE: 8D 07 27     STA $2707
03/D6E1: AD 0A 27     LDA $270A
03/D6E4: 8D 08 27     STA $2708
03/D6E7: 60           RTS 
; magic effect $0B: esuna (heal)
03/D6E8: AD 2A 35     LDA $352A
03/D6EB: F0 0A        BEQ $D6F7
03/D6ED: AD D2 26     LDA $26D2
03/D6F0: C9 DD        CMP #$DD
03/D6F2: F0 11        BEQ $D705
03/D6F4: 4C 73 D7     JMP $D773
03/D6F7: AD D2 26     LDA $26D2
03/D6FA: C9 12        CMP #$12
03/D6FC: F0 07        BEQ $D705
03/D6FE: C9 86        CMP #$86
03/D700: F0 03        BEQ $D705
03/D702: 4C 73 D7     JMP $D773
03/D705: A5 CE        LDA $CE
03/D707: 10 03        BPL $D70C
03/D709: 18           CLC 
03/D70A: 69 05        ADC #$05
03/D70C: AA           TAX 
03/D70D: 9E 60 35     STZ $3560,X
03/D710: AD 03 27     LDA $2703
03/D713: 85 A9        STA $A9
03/D715: 29 80        AND #$80
03/D717: 8D 03 27     STA $2703
03/D71A: AD 04 27     LDA $2704
03/D71D: 85 AA        STA $AA
03/D71F: 29 44        AND #$44
03/D721: 8D 04 27     STA $2704
03/D724: A9 10        LDA #$10
03/D726: 8D 3B 27     STA $273B
03/D729: A5 CF        LDA $CF
03/D72B: 0A           ASL 
03/D72C: AA           TAX 
03/D72D: BD EB 29     LDA $29EB,X     ; disable poison and petrify timers
03/D730: 29 E6        AND #$E6
03/D732: 9D EB 29     STA $29EB,X
03/D735: A5 A9        LDA $A9
03/D737: 29 40        AND #$40
03/D739: D0 08        BNE $D743
03/D73B: A5 AA        LDA $AA
03/D73D: 29 30        AND #$30
03/D73F: F0 1D        BEQ $D75E
03/D741: 80 09        BRA $D74C
03/D743: A5 CF        LDA $CF
03/D745: 0A           ASL 
03/D746: AA           TAX 
03/D747: A9 40        LDA #$40
03/D749: 9D EB 29     STA $29EB,X     ; enable action timer
03/D74C: 64 D6        STZ $D6
03/D74E: A5 CF        LDA $CF
03/D750: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D753: A9 03        LDA #$03        ; action timer
03/D755: 20 C8 85     JSR $85C8       ; set timer
03/D758: 9E 06 2A     STZ $2A06,X
03/D75B: 4C 19 D8     JMP $D819
03/D75E: A5 A9        LDA $A9
03/D760: 29 08        AND #$08
03/D762: F0 0E        BEQ $D772
03/D764: AD CE 00     LDA $00CE
03/D767: 10 04        BPL $D76D
03/D769: A9 E1        LDA #$E1
03/D76B: 80 02        BRA $D76F
03/D76D: A9 21        LDA #$21
03/D76F: 8D 51 27     STA $2751
03/D772: 60           RTS 
03/D773: AD 03 27     LDA $2703
03/D776: 85 8A        STA $8A
03/D778: 2D A3 28     AND $28A3
03/D77B: 8D 03 27     STA $2703
03/D77E: AD 04 27     LDA $2704
03/D781: 85 8B        STA $8B
03/D783: 2D A4 28     AND $28A4
03/D786: 8D 04 27     STA $2704
03/D789: AD A3 28     LDA $28A3
03/D78C: 49 FF        EOR #$FF
03/D78E: 85 8C        STA $8C
03/D790: AD A4 28     LDA $28A4
03/D793: 49 FF        EOR #$FF
03/D795: 85 8D        STA $8D
03/D797: A5 8A        LDA $8A
03/D799: 29 01        AND #$01
03/D79B: F0 12        BEQ $D7AF
03/D79D: A5 8C        LDA $8C
03/D79F: 29 01        AND #$01
03/D7A1: F0 0C        BEQ $D7AF
03/D7A3: A5 CF        LDA $CF
03/D7A5: 0A           ASL 
03/D7A6: AA           TAX 
03/D7A7: BD EB 29     LDA $29EB,X     ; disable poison timer
03/D7AA: 29 EF        AND #$EF
03/D7AC: 9D EB 29     STA $29EB,X
03/D7AF: A5 8A        LDA $8A
03/D7B1: 29 40        AND #$40
03/D7B3: F0 11        BEQ $D7C6
03/D7B5: A5 8C        LDA $8C
03/D7B7: 29 40        AND #$40
03/D7B9: F0 0B        BEQ $D7C6
03/D7BB: A5 CF        LDA $CF
03/D7BD: 0A           ASL 
03/D7BE: AA           TAX 
03/D7BF: A9 40        LDA #$40
03/D7C1: 9D EB 29     STA $29EB,X     ; enable action timer
03/D7C4: 80 0C        BRA $D7D2
03/D7C6: A5 8B        LDA $8B
03/D7C8: 29 30        AND #$30
03/D7CA: F0 15        BEQ $D7E1
03/D7CC: A5 8D        LDA $8D
03/D7CE: 29 30        AND #$30
03/D7D0: F0 0F        BEQ $D7E1
03/D7D2: 64 D6        STZ $D6
03/D7D4: A5 CF        LDA $CF
03/D7D6: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D7D9: A9 03        LDA #$03        ; action timer
03/D7DB: 20 C8 85     JSR $85C8       ; set timer
03/D7DE: 9E 06 2A     STZ $2A06,X
03/D7E1: A5 8B        LDA $8B
03/D7E3: 29 08        AND #$08
03/D7E5: F0 1A        BEQ $D801
03/D7E7: A5 8D        LDA $8D
03/D7E9: 29 08        AND #$08
03/D7EB: F0 14        BEQ $D801
03/D7ED: A5 CE        LDA $CE
03/D7EF: 10 07        BPL $D7F8
03/D7F1: A9 E1        LDA #$E1
03/D7F3: 8D 51 27     STA $2751
03/D7F6: 80 09        BRA $D801
03/D7F8: AA           TAX 
03/D7F9: 9E 60 35     STZ $3560,X
03/D7FC: A9 21        LDA #$21
03/D7FE: 8D 51 27     STA $2751
03/D801: A5 8B        LDA $8B
03/D803: 29 03        AND #$03
03/D805: F0 12        BEQ $D819
03/D807: A5 8D        LDA $8D
03/D809: 29 03        AND #$03
03/D80B: F0 0C        BEQ $D819
03/D80D: A5 CF        LDA $CF
03/D80F: 0A           ASL 
03/D810: AA           TAX 
03/D811: BD EB 29     LDA $29EB,X     ; disable petrify timer
03/D814: 29 F7        AND #$F7
03/D816: 9D EB 29     STA $29EB,X
03/D819: 60           RTS 
; magic effect $0C: pig/size/toad
03/D81A: AD 2B 27     LDA $272B
03/D81D: 2D A3 28     AND $28A3
03/D820: D0 10        BNE $D832
03/D822: AD 03 27     LDA $2703
03/D825: 2D A3 28     AND $28A3
03/D828: D0 0B        BNE $D835
03/D82A: AD 03 27     LDA $2703
03/D82D: CD A3 28     CMP $28A3
03/D830: 90 03        BCC $D835
03/D832: 4C 30 E0     JMP $E030       ; remove target
03/D835: AD 03 27     LDA $2703
03/D838: 4D A3 28     EOR $28A3
03/D83B: 8D 03 27     STA $2703
03/D83E: 60           RTS 
; magic effect $0D: protect (armor)
03/D83F: AD 2A 27     LDA $272A
03/D842: C9 FF        CMP #$FF
03/D844: D0 03        BNE $D849
03/D846: 4C 30 E0     JMP $E030       ; remove target
03/D849: AD 00 18     LDA $1800
03/D84C: C9 B7        CMP #$B7
03/D84E: D0 05        BNE $D855
03/D850: AD 01 18     LDA $1801
03/D853: D0 0D        BNE $D862       ; branch if battle $01B7 (zeromus)
03/D855: 18           CLC 
03/D856: AD 2A 27     LDA $272A
03/D859: 69 05        ADC #$05
03/D85B: 90 02        BCC $D85F
03/D85D: A9 FF        LDA #$FF
03/D85F: 8D 2A 27     STA $272A
03/D862: 60           RTS 
; magic effect $0E: shell
03/D863: AD 24 27     LDA $2724       ; base mag.def
03/D866: C9 FF        CMP #$FF
03/D868: D0 03        BNE $D86D       ; branch if not maxed out
03/D86A: 4C 30 E0     JMP $E030       ; remove target
03/D86D: AD 00 18     LDA $1800
03/D870: C9 B7        CMP #$B7
03/D872: D0 05        BNE $D879
03/D874: AD 01 18     LDA $1801
03/D877: D0 0D        BNE $D886       ; branch if battle $01B7 (zeromus)
03/D879: 18           CLC 
03/D87A: AD 24 27     LDA $2724
03/D87D: 69 03        ADC #$03
03/D87F: 90 02        BCC $D883
03/D881: A9 FF        LDA #$FF
03/D883: 8D 24 27     STA $2724
03/D886: 60           RTS 
; magic effect $0F: haste/slow
03/D887: 18           CLC 
03/D888: AD 3B 27     LDA $273B
03/D88B: 6D 9D 28     ADC $289D       ; add modifier (-3 for haste, +8 for slow)
03/D88E: C9 20        CMP #$20
03/D890: B0 08        BCS $D89A
03/D892: C9 0C        CMP #$0C
03/D894: B0 06        BCS $D89C
03/D896: A9 0C        LDA #$0C        ; max 12
03/D898: 80 02        BRA $D89C
03/D89A: A9 20        LDA #$20        ; max 32
03/D89C: 8D 3B 27     STA $273B
03/D89F: 60           RTS 
; magic effect $10: 
03/D8A0: A5 CE        LDA $CE
03/D8A2: 10 03        BPL $D8A7
03/D8A4: 18           CLC 
03/D8A5: 69 05        ADC #$05
03/D8A7: AA           TAX 
03/D8A8: 9E 6D 35     STZ $356D,X
03/D8AB: AD 04 27     LDA $2704
03/D8AE: 85 A9        STA $A9
03/D8B0: 29 FB        AND #$FB
03/D8B2: 8D 04 27     STA $2704
03/D8B5: A5 A9        LDA $A9
03/D8B7: 29 04        AND #$04
03/D8B9: F0 0E        BEQ $D8C9
03/D8BB: AD CE 00     LDA $00CE
03/D8BE: 10 04        BPL $D8C4
03/D8C0: A9 E1        LDA #$E1
03/D8C2: 80 02        BRA $D8C6
03/D8C4: A9 21        LDA #$21
03/D8C6: 8D 51 27     STA $2751
03/D8C9: AD 06 27     LDA $2706
03/D8CC: 29 83        AND #$83
03/D8CE: 8D 06 27     STA $2706
03/D8D1: A5 CF        LDA $CF
03/D8D3: 0A           ASL 
03/D8D4: AA           TAX 
03/D8D5: BD EB 29     LDA $29EB,X     ; disable stop and sap timers
03/D8D8: 29 5F        AND #$5F
03/D8DA: 9D EB 29     STA $29EB,X
03/D8DD: 60           RTS 
; magic effect $11: stop/magnet
03/D8DE: AD 05 27     LDA $2705
03/D8E1: 09 40        ORA #$40
03/D8E3: 8D 05 27     STA $2705
03/D8E6: AD 9D 28     LDA $289D
03/D8E9: 8D 7B 39     STA $397B
03/D8EC: A9 0A        LDA #$0A
03/D8EE: 85 D6        STA $D6
03/D8F0: A5 CF        LDA $CF
03/D8F2: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/D8F5: AE 30 35     LDX $3530
03/D8F8: A5 D4        LDA $D4
03/D8FA: 9D 04 2A     STA $2A04,X
03/D8FD: A5 D5        LDA $D5
03/D8FF: 9D 05 2A     STA $2A05,X
03/D902: A9 40        LDA #$40
03/D904: 9D 06 2A     STA $2A06,X
03/D907: 9E 09 2A     STZ $2A09,X
03/D90A: A5 CF        LDA $CF
03/D90C: 0A           ASL 
03/D90D: AA           TAX 
03/D90E: BD EB 29     LDA $29EB,X     ; enable stop timer
03/D911: 09 80        ORA #$80
03/D913: 9D EB 29     STA $29EB,X
03/D916: 60           RTS 
; magic effect $12: libra (peep)
03/D917: AD 00 18     LDA $1800
03/D91A: C9 B7        CMP #$B7
03/D91C: D0 08        BNE $D926
03/D91E: AD 01 18     LDA $1801
03/D921: F0 03        BEQ $D926       ; branch if not battle $01B7 (zeromus)
03/D923: 4C 30 E0     JMP $E030       ; remove target
03/D926: C2 20        REP #$20
03/D928: AD 07 27     LDA $2707
03/D92B: 8D 9A 35     STA $359A
03/D92E: AD 09 27     LDA $2709
03/D931: 8D 9D 35     STA $359D
03/D934: 7B           TDC 
03/D935: E2 20        SEP #$20
03/D937: 9C 9C 35     STZ $359C
03/D93A: 9C 9F 35     STZ $359F
03/D93D: AD 20 27     LDA $2720
03/D940: 2D 25 27     AND $2725
03/D943: 49 FF        EOR #$FF
03/D945: 2D 20 27     AND $2720
03/D948: 29 3F        AND #$3F
03/D94A: 85 A9        STA $A9
03/D94C: D0 07        BNE $D955
03/D94E: A9 14        LDA #$14
03/D950: 8D CB 34     STA $34CB
03/D953: 80 15        BRA $D96A
03/D955: 7B           TDC 
03/D956: AA           TAX 
03/D957: A8           TAY 
03/D958: 46 A9        LSR $A9
03/D95A: 90 08        BCC $D964
03/D95C: 98           TYA 
03/D95D: 18           CLC 
03/D95E: 69 15        ADC #$15
03/D960: 9D CB 34     STA $34CB,X
03/D963: E8           INX 
03/D964: C8           INY 
03/D965: C0 06 00     CPY #$0006
03/D968: D0 EE        BNE $D958
03/D96A: A9 1E        LDA #$1E
03/D96C: 8D CA 34     STA $34CA
03/D96F: 4C B1 85     JMP $85B1       ; add message to graphics script
; spell effect $13: escape
03/D972: AD E5 38     LDA $38E5
03/D975: 29 01        AND #$01
03/D977: D0 0B        BNE $D984
03/D979: EE F3 38     INC $38F3
03/D97C: 1A           INC 
03/D97D: 8D D3 38     STA $38D3
03/D980: 8D A3 35     STA $35A3
03/D983: 60           RTS 
03/D984: 9C 50 35     STZ $3550
03/D987: 20 B1 85     JSR $85B1       ; add message to graphics script
03/D98A: A9 22        LDA #$22
03/D98C: 8D CA 34     STA $34CA
03/D98F: 60           RTS 
; magic effect $14: damage based on attacker's current hp
03/D990: 20 00 E1     JSR $E100       ; check elemental resistance
03/D993: AD FE 38     LDA $38FE
03/D996: 10 08        BPL $D9A0
03/D998: 29 7F        AND #$7F
03/D99A: 8D FE 38     STA $38FE
03/D99D: 4C 0C D4     JMP $D40C
03/D9A0: 20 33 E1     JSR $E133       ; check elemental weakness
03/D9A3: A9 01        LDA #$01
03/D9A5: 8D FC 38     STA $38FC
03/D9A8: AE 87 26     LDX $2687
03/D9AB: 8E 45 39     STX $3945
03/D9AE: AD 9D 28     LDA $289D
03/D9B1: AA           TAX 
03/D9B2: 8E 47 39     STX $3947
03/D9B5: 20 07 84     JSR $8407       ; divide
03/D9B8: AE 49 39     LDX $3949
03/D9BB: 8E 02 39     STX $3902
03/D9BE: 7B           TDC 
03/D9BF: AA           TAX 
03/D9C0: 8E 04 39     STX $3904
03/D9C3: 20 9F C9     JSR $C99F       ; calculate damage
03/D9C6: AD A3 28     LDA $28A3
03/D9C9: 29 FE        AND #$FE
03/D9CB: D0 07        BNE $D9D4
03/D9CD: AD A4 28     LDA $28A4
03/D9D0: 29 CC        AND #$CC
03/D9D2: F0 03        BEQ $D9D7
03/D9D4: 4C 05 D5     JMP $D505
03/D9D7: AD A3 28     LDA $28A3
03/D9DA: 29 01        AND #$01
03/D9DC: F0 03        BEQ $D9E1
03/D9DE: 4C 34 DA     JMP $DA34
03/D9E1: AD A4 28     LDA $28A4
03/D9E4: 29 30        AND #$30
03/D9E6: F0 03        BEQ $D9EB
03/D9E8: 4C A6 D5     JMP $D5A6       ; sleep/paralyze
03/D9EB: 60           RTS 
; magic effect $15: restore mp
03/D9EC: 20 9F C9     JSR $C99F       ; calculate damage
03/D9EF: C2 20        REP #$20
03/D9F1: 18           CLC 
03/D9F2: A5 A4        LDA $A4
03/D9F4: 6D 0B 27     ADC $270B
03/D9F7: CD 0D 27     CMP $270D
03/D9FA: 90 03        BCC $D9FF
03/D9FC: AD 0D 27     LDA $270D
03/D9FF: 8D 0B 27     STA $270B
03/DA02: 7B           TDC 
03/DA03: E2 20        SEP #$20
03/DA05: A5 A5        LDA $A5
03/DA07: 09 C0        ORA #$C0
03/DA09: 85 A5        STA $A5
03/DA0B: 60           RTS 
; magic effect $16: elixir
03/DA0C: C2 20        REP #$20
03/DA0E: AD 09 27     LDA $2709
03/DA11: 8D 07 27     STA $2707
03/DA14: AD 0D 27     LDA $270D
03/DA17: 8D 0B 27     STA $270B
03/DA1A: 7B           TDC 
03/DA1B: E2 20        SEP #$20
03/DA1D: 60           RTS 
; magic effect $17: poison/venom
03/DA1E: 20 00 E1     JSR $E100       ; check elemental resistance
03/DA21: AD FE 38     LDA $38FE
03/DA24: 10 08        BPL $DA2E
03/DA26: 29 7F        AND #$7F
03/DA28: 8D FE 38     STA $38FE
03/DA2B: 4C 0C D4     JMP $D40C
03/DA2E: 20 33 E1     JSR $E133       ; check elemental weakness
03/DA31: 20 9F C9     JSR $C99F       ; calculate damage
03/DA34: AD 03 27     LDA $2703
03/DA37: 09 01        ORA #$01
03/DA39: 8D 03 27     STA $2703
03/DA3C: A9 06        LDA #$06
03/DA3E: 85 D6        STA $D6
03/DA40: A5 CF        LDA $CF
03/DA42: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/DA45: A9 09        LDA #$09        ; poison timer
03/DA47: 20 C8 85     JSR $85C8       ; set timer
03/DA4A: A9 40        LDA #$40
03/DA4C: 9D 06 2A     STA $2A06,X
03/DA4F: A5 CF        LDA $CF
03/DA51: 0A           ASL 
03/DA52: AA           TAX 
03/DA53: BD EB 29     LDA $29EB,X     ; enable poison timer
03/DA56: 09 10        ORA #$10
03/DA58: 9D EB 29     STA $29EB,X
03/DA5B: A5 D4        LDA $D4
03/DA5D: 9D 2A 2B     STA $2B2A,X
03/DA60: A5 D5        LDA $D5
03/DA62: 9D 2B 2B     STA $2B2B,X
03/DA65: 60           RTS 
; magic effect $18: cockatrice
03/DA66: 20 00 E1     JSR $E100       ; check elemental resistance
03/DA69: AD FE 38     LDA $38FE
03/DA6C: 10 08        BPL $DA76
03/DA6E: 29 7F        AND #$7F
03/DA70: 8D FE 38     STA $38FE
03/DA73: 4C 0C D4     JMP $D40C
03/DA76: 20 33 E1     JSR $E133       ; check elemental weakness
03/DA79: 20 9F C9     JSR $C99F       ; calculate damage
03/DA7C: 4C 05 D5     JMP $D505
; magic effect $19: mindflayer (mage)
03/DA7F: 20 00 E1     JSR $E100       ; check elemental resistance
03/DA82: AD FE 38     LDA $38FE
03/DA85: 10 08        BPL $DA8F
03/DA87: 29 7F        AND #$7F
03/DA89: 8D FE 38     STA $38FE
03/DA8C: 4C 0C D4     JMP $D40C
03/DA8F: 20 33 E1     JSR $E133       ; check elemental weakness
03/DA92: 20 9F C9     JSR $C99F       ; calculate damage
03/DA95: AD 50 35     LDA $3550
03/DA98: 48           PHA 
03/DA99: 20 A6 D5     JSR $D5A6       ; sleep/paralyze
03/DA9C: 68           PLA 
03/DA9D: 8D 50 35     STA $3550
03/DAA0: 60           RTS 
; magic effect $1A: sylph
03/DAA1: 20 00 E1     JSR $E100       ; check elemental resistance
03/DAA4: AD FE 38     LDA $38FE
03/DAA7: 10 08        BPL $DAB1
03/DAA9: 29 7F        AND #$7F
03/DAAB: 8D FE 38     STA $38FE
03/DAAE: 4C 0C D4     JMP $D40C
03/DAB1: 20 33 E1     JSR $E133       ; check elemental weakness
03/DAB4: 20 9F C9     JSR $C99F       ; calculate damage
03/DAB7: AD 06 39     LDA $3906
03/DABA: CD 4D 35     CMP $354D
03/DABD: F0 01        BEQ $DAC0
03/DABF: 60           RTS 
03/DAC0: EE 53 35     INC $3553
03/DAC3: A6 A4        LDX $A4
03/DAC5: DA           PHX 
03/DAC6: 7B           TDC 
03/DAC7: AA           TAX 
03/DAC8: 86 A9        STX $A9
03/DACA: 86 AB        STX $AB
03/DACC: 8E 1C 29     STX $291C
03/DACF: 8E 1E 29     STX $291E
03/DAD2: 8E 20 29     STX $2920
03/DAD5: A6 A9        LDX $A9
03/DAD7: AD 40 35     LDA $3540       ; *** changed to LDA $3540,X in translation ***
03/DADA: D0 27        BNE $DB03
03/DADC: A5 A9        LDA $A9
03/DADE: 85 DF        STA $DF
03/DAE0: A9 80        LDA #$80
03/DAE2: 85 E1        STA $E1
03/DAE4: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/DAE7: A6 E3        LDX $E3
03/DAE9: BD 03 20     LDA $2003,X
03/DAEC: 29 C0        AND #$C0
03/DAEE: D0 13        BNE $DB03
03/DAF0: BD 05 20     LDA $2005,X
03/DAF3: 29 02        AND #$02
03/DAF5: D0 0C        BNE $DB03
03/DAF7: BD 06 20     LDA $2006,X
03/DAFA: 30 07        BMI $DB03
03/DAFC: E6 AB        INC $AB
03/DAFE: A6 A9        LDX $A9
03/DB00: FE 1C 29     INC $291C,X
03/DB03: E6 A9        INC $A9
03/DB05: A5 A9        LDA $A9
03/DB07: C9 05        CMP #$05
03/DB09: D0 CA        BNE $DAD5
03/DB0B: A6 A4        LDX $A4
03/DB0D: 8E 45 39     STX $3945
03/DB10: A6 AB        LDX $AB
03/DB12: 8E 47 39     STX $3947
03/DB15: 20 07 84     JSR $8407       ; divide
03/DB18: AE 49 39     LDX $3949
03/DB1B: 86 A4        STX $A4
03/DB1D: 7B           TDC 
03/DB1E: AA           TAX 
03/DB1F: 86 A9        STX $A9
03/DB21: A6 A9        LDX $A9
03/DB23: BD 1C 29     LDA $291C,X
03/DB26: F0 36        BEQ $DB5E
03/DB28: A5 A9        LDA $A9
03/DB2A: 85 DF        STA $DF
03/DB2C: A9 80        LDA #$80
03/DB2E: 85 E1        STA $E1
03/DB30: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/DB33: C2 20        REP #$20
03/DB35: A6 E3        LDX $E3
03/DB37: 18           CLC 
03/DB38: BD 07 20     LDA $2007,X
03/DB3B: 65 A4        ADC $A4
03/DB3D: DD 09 20     CMP $2009,X
03/DB40: 90 03        BCC $DB45
03/DB42: BD 09 20     LDA $2009,X
03/DB45: 9D 07 20     STA $2007,X
03/DB48: 7B           TDC 
03/DB49: E2 20        SEP #$20
03/DB4B: 20 7E E0     JSR $E07E       ; subtract mp if summon failed
03/DB4E: A5 A9        LDA $A9
03/DB50: 0A           ASL 
03/DB51: AA           TAX 
03/DB52: A5 A4        LDA $A4
03/DB54: 9D D4 34     STA $34D4,X
03/DB57: A5 A5        LDA $A5
03/DB59: 09 80        ORA #$80
03/DB5B: 9D D5 34     STA $34D5,X
03/DB5E: E6 A9        INC $A9
03/DB60: A5 A9        LDA $A9
03/DB62: C9 05        CMP #$05
03/DB64: D0 BB        BNE $DB21
03/DB66: FA           PLX 
03/DB67: 86 A4        STX $A4
03/DB69: 60           RTS 
; magic effect $1B: odin
03/DB6A: A9 01        LDA #$01
03/DB6C: 8D 4D 35     STA $354D
03/DB6F: 20 8B 85     JSR $858B       ; random (0..98)
03/DB72: C9 32        CMP #$32
03/DB74: 90 16        BCC $DB8C
03/DB76: 7B           TDC 
03/DB77: 8D 50 35     STA $3550
03/DB7A: AA           TAX 
03/DB7B: 86 A9        STX $A9
03/DB7D: 20 7E E0     JSR $E07E       ; subtract mp if summon failed
03/DB80: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/DB83: E6 A9        INC $A9
03/DB85: A5 A9        LDA $A9
03/DB87: C9 05        CMP #$05
03/DB89: D0 F2        BNE $DB7D
03/DB8B: 60           RTS 
03/DB8C: AD 03 27     LDA $2703
03/DB8F: 09 80        ORA #$80
03/DB91: 8D 03 27     STA $2703
03/DB94: 64 AB        STZ $AB
03/DB96: AD 4F 35     LDA $354F
03/DB99: 85 A9        STA $A9
03/DB9B: 06 A9        ASL $A9
03/DB9D: 90 18        BCC $DBB7
03/DB9F: 18           CLC 
03/DBA0: A5 AB        LDA $AB
03/DBA2: 69 05        ADC #$05
03/DBA4: 85 DF        STA $DF
03/DBA6: A9 80        LDA #$80
03/DBA8: 85 E1        STA $E1
03/DBAA: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/DBAD: A6 E3        LDX $E3
03/DBAF: BD 03 20     LDA $2003,X
03/DBB2: 09 80        ORA #$80
03/DBB4: 9D 03 20     STA $2003,X
03/DBB7: E6 AB        INC $AB
03/DBB9: A5 AB        LDA $AB
03/DBBB: C9 08        CMP #$08
03/DBBD: D0 DC        BNE $DB9B
03/DBBF: 60           RTS 
; magic effect $1C/$1D: doom (count)
03/DBC0: AD 05 27     LDA $2705
03/DBC3: 09 01        ORA #$01
03/DBC5: 8D 05 27     STA $2705
03/DBC8: A5 CF        LDA $CF
03/DBCA: 20 89 84     JSR $8489       ; set current character/monster
03/DBCD: A9 12        LDA #$12
03/DBCF: 20 69 85     JSR $8569       ; get pointer to timer
03/DBD2: AE 98 35     LDX $3598
03/DBD5: AD 9D 28     LDA $289D
03/DBD8: 9D 04 2A     STA $2A04,X
03/DBDB: 9E 05 2A     STZ $2A05,X
03/DBDE: A9 40        LDA #$40
03/DBE0: 9D 06 2A     STA $2A06,X
03/DBE3: A5 CF        LDA $CF
03/DBE5: 0A           ASL 
03/DBE6: AA           TAX 
03/DBE7: BD EB 29     LDA $29EB,X     ; enable doom timer
03/DBEA: 09 02        ORA #$02
03/DBEC: 9D EB 29     STA $29EB,X
03/DBEF: 60           RTS 
; magic effect $1E: damage based on target max hp
03/DBF0: AD 9D 28     LDA $289D
03/DBF3: 85 A9        STA $A9
03/DBF5: 20 00 E1     JSR $E100       ; check elemental resistance
03/DBF8: AD FE 38     LDA $38FE
03/DBFB: 10 08        BPL $DC05
03/DBFD: 29 7F        AND #$7F
03/DBFF: 8D FE 38     STA $38FE
03/DC02: 4C 0C D4     JMP $D40C
03/DC05: 20 33 E1     JSR $E133       ; check elemental weakness
03/DC08: AD FE 38     LDA $38FE
03/DC0B: C9 02        CMP #$02
03/DC0D: B0 06        BCS $DC15
03/DC0F: A9 0A        LDA #$0A
03/DC11: 85 A9        STA $A9
03/DC13: 80 06        BRA $DC1B
03/DC15: C9 04        CMP #$04
03/DC17: 90 02        BCC $DC1B
03/DC19: 46 A9        LSR $A9
03/DC1B: A5 A9        LDA $A9
03/DC1D: AA           TAX 
03/DC1E: 8E 47 39     STX $3947
03/DC21: AD 09 27     LDA $2709
03/DC24: 8D 45 39     STA $3945
03/DC27: AD 0A 27     LDA $270A
03/DC2A: 8D 46 39     STA $3946
03/DC2D: 20 07 84     JSR $8407       ; divide
03/DC30: AE 49 39     LDX $3949
03/DC33: 86 A4        STX $A4
03/DC35: 60           RTS 
; magic effect $1F: gradual petrify
03/DC36: 20 00 E1     JSR $E100       ; check elemental resistance
03/DC39: AD FE 38     LDA $38FE
03/DC3C: 10 08        BPL $DC46
03/DC3E: 29 7F        AND #$7F
03/DC40: 8D FE 38     STA $38FE
03/DC43: 4C 0C D4     JMP $D40C
03/DC46: AD 2C 27     LDA $272C
03/DC49: 2D A4 28     AND $28A4
03/DC4C: F0 03        BEQ $DC51
03/DC4E: 4C 30 E0     JMP $E030       ; remove target
03/DC51: AD 04 27     LDA $2704
03/DC54: 29 FC        AND #$FC
03/DC56: 85 AA        STA $AA
03/DC58: AD 04 27     LDA $2704
03/DC5B: 29 03        AND #$03
03/DC5D: 18           CLC 
03/DC5E: 69 01        ADC #$01
03/DC60: C9 04        CMP #$04
03/DC62: 90 08        BCC $DC6C
03/DC64: A5 AA        LDA $AA
03/DC66: 8D 04 27     STA $2704
03/DC69: 4C 05 D5     JMP $D505
03/DC6C: 05 AA        ORA $AA
03/DC6E: 8D 04 27     STA $2704
03/DC71: A9 07        LDA #$07
03/DC73: 85 D6        STA $D6
03/DC75: A5 CF        LDA $CF
03/DC77: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/DC7A: A9 0C        LDA #$0C        ; petrify timer
03/DC7C: 20 C8 85     JSR $85C8       ; set timer
03/DC7F: A9 40        LDA #$40
03/DC81: 9D 06 2A     STA $2A06,X
03/DC84: A5 CF        LDA $CF
03/DC86: 0A           ASL 
03/DC87: AA           TAX 
03/DC88: BD EB 29     LDA $29EB,X     ; enable petrify timer
03/DC8B: 09 08        ORA #$08
03/DC8D: 9D EB 29     STA $29EB,X
03/DC90: A5 D4        LDA $D4
03/DC92: 9D 44 2B     STA $2B44,X
03/DC95: A5 D5        LDA $D5
03/DC97: 9D 45 2B     STA $2B45,X
03/DC9A: 60           RTS 
; magic effect $20: gaze
03/DC9B: A2 03 00     LDX #$0003
03/DC9E: A9 05        LDA #$05
03/DCA0: 20 79 83     JSR $8379       ; random (X..A)
03/DCA3: A8           TAY 
03/DCA4: 8D A9 00     STA $00A9
03/DCA7: 38           SEC 
03/DCA8: 6E A4 28     ROR $28A4
03/DCAB: 88           DEY 
03/DCAC: D0 FA        BNE $DCA8
03/DCAE: AD A9 00     LDA $00A9
03/DCB1: C9 05        CMP #$05
03/DCB3: F0 03        BEQ $DCB8
03/DCB5: 4C A6 D5     JMP $D5A6       ; sleep/paralyze
03/DCB8: 4C 14 D5     JMP $D514
; magic effect $21: bluster
03/DCBB: A2 00 00     LDX #$0000
03/DCBE: A9 01        LDA #$01
03/DCC0: 20 79 83     JSR $8379       ; random (X..A)
03/DCC3: AA           TAX 
03/DCC4: D0 08        BNE $DCCE
03/DCC6: A9 80        LDA #$80
03/DCC8: 8D A3 28     STA $28A3
03/DCCB: 4C 14 D5     JMP $D514
03/DCCE: A9 20        LDA #$20
03/DCD0: 8D A4 28     STA $28A4
03/DCD3: 4C A6 D5     JMP $D5A6       ; sleep/paralyze
; magic effect $22: slap
03/DCD6: A2 00 00     LDX #$0000
03/DCD9: A9 02        LDA #$02
03/DCDB: 20 79 83     JSR $8379       ; random (X..A)
03/DCDE: AA           TAX 
03/DCDF: D0 08        BNE $DCE9
03/DCE1: A9 20        LDA #$20
03/DCE3: 8D A4 28     STA $28A4
03/DCE6: 4C A6 D5     JMP $D5A6       ; sleep/paralyze
03/DCE9: 3A           DEC 
03/DCEA: D0 07        BNE $DCF3
03/DCEC: A9 04        LDA #$04
03/DCEE: 8D A3 28     STA $28A3
03/DCF1: 80 05        BRA $DCF8
03/DCF3: A9 80        LDA #$80
03/DCF5: 8D A4 28     STA $28A4
03/DCF8: 4C 14 D5     JMP $D514
; magic effect $23: blast
03/DCFB: A9 20        LDA #$20
03/DCFD: 8D A4 28     STA $28A4
03/DD00: 20 A6 D5     JSR $D5A6       ; sleep/paralyze
03/DD03: 4C E4 D3     JMP $D3E4
; magic effect $24: hug
03/DD06: C2 20        REP #$20
03/DD08: 38           SEC 
03/DD09: AD 09 27     LDA $2709
03/DD0C: ED 07 27     SBC $2707
03/DD0F: 85 A4        STA $A4
03/DD11: 7B           TDC 
03/DD12: E2 20        SEP #$20
03/DD14: A5 A5        LDA $A5
03/DD16: 09 80        ORA #$80
03/DD18: 85 A5        STA $A5
03/DD1A: 4C 05 D5     JMP $D505
; magic effect $25: explode/fission
03/DD1D: A9 05        LDA #$05
03/DD1F: 8D E6 38     STA $38E6
03/DD22: C2 20        REP #$20
03/DD24: AD 87 26     LDA $2687
03/DD27: 85 A4        STA $A4
03/DD29: 7B           TDC 
03/DD2A: E2 20        SEP #$20
03/DD2C: A9 80        LDA #$80
03/DD2E: 8D 83 26     STA $2683
03/DD31: 60           RTS 
; magic effect $26: reaction
03/DD32: A9 05        LDA #$05
03/DD34: 8D E6 38     STA $38E6
03/DD37: A9 80        LDA #$80
03/DD39: 8D 83 26     STA $2683
03/DD3C: 8D 03 27     STA $2703
03/DD3F: A2 80 02     LDX #$0280
03/DD42: A0 08 00     LDY #$0008
03/DD45: A9 80        LDA #$80
03/DD47: 9D 03 20     STA $2003,X
03/DD4A: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/DD4D: 88           DEY 
03/DD4E: D0 F5        BNE $DD45
03/DD50: 60           RTS 
; magic effect $27: remedy
03/DD51: AD 09 27     LDA $2709
03/DD54: 8D 45 39     STA $3945
03/DD57: AD 0A 27     LDA $270A
03/DD5A: 8D 46 39     STA $3946
03/DD5D: A2 0A 00     LDX #$000A
03/DD60: 8E 47 39     STX $3947
03/DD63: 80 12        BRA $DD77
; magic effect $2C: absorb
03/DD65: AD 07 27     LDA $2707
03/DD68: 8D 45 39     STA $3945
03/DD6B: AD 08 27     LDA $2708
03/DD6E: 8D 46 39     STA $3946
03/DD71: A2 03 00     LDX #$0003
03/DD74: 8E 47 39     STX $3947
03/DD77: 20 07 84     JSR $8407       ; divide
03/DD7A: AE 49 39     LDX $3949
03/DD7D: E0 0F 27     CPX #$270F
03/DD80: 90 06        BCC $DD88
03/DD82: A2 0F 27     LDX #$270F
03/DD85: 8E 49 39     STX $3949
03/DD88: AD 49 39     LDA $3949
03/DD8B: 85 A4        STA $A4
03/DD8D: AD 4A 39     LDA $394A
03/DD90: 09 80        ORA #$80
03/DD92: 85 A5        STA $A5
03/DD94: 60           RTS 
; magic effect $28: 
03/DD95: 20 78 D3     JSR $D378
03/DD98: 4C 14 D5     JMP $D514
; magic effect $29: alert/call
03/DD9B: EE E6 38     INC $38E6
03/DD9E: 7B           TDC 
03/DD9F: AA           TAX 
03/DDA0: BD B5 29     LDA $29B5,X
03/DDA3: C9 FF        CMP #$FF
03/DDA5: F0 03        BEQ $DDAA
03/DDA7: E8           INX 
03/DDA8: 80 F6        BRA $DDA0
03/DDAA: 86 8A        STX $8A
03/DDAC: A9 01        LDA #$01
03/DDAE: 4C 5F DF     JMP $DF5F
; magic effect $2A: black hole
03/DDB1: AD 04 27     LDA $2704
03/DDB4: 85 A9        STA $A9
03/DDB6: 29 BB        AND #$BB
03/DDB8: 8D 04 27     STA $2704
03/DDBB: AD 06 27     LDA $2706
03/DDBE: 29 C3        AND #$C3
03/DDC0: 8D 06 27     STA $2706
03/DDC3: A9 10        LDA #$10
03/DDC5: 8D 3B 27     STA $273B
03/DDC8: 60           RTS 
; magic effect $2B: needle/counter
03/DDC9: AD 9D 26     LDA $269D
03/DDCC: AA           TAX 
03/DDCD: 8E 02 39     STX $3902
03/DDD0: 0E 02 39     ASL $3902
03/DDD3: 2E 03 39     ROL $3903
03/DDD6: 4C 9F C9     JMP $C99F       ; calculate damage
; magic effect $2E: make monsters invincible
03/DDD9: EE 81 38     INC $3881
; magic effect $2D: no effect
03/DDDC: 60           RTS 
; magic effect $2F: make monsters un-invincible
03/DDDD: CE 81 38     DEC $3881
03/DDE0: 60           RTS 
; magic effect $30: revive monster
03/DDE1: A9 02        LDA #$02
03/DDE3: 8D E6 38     STA $38E6
03/DDE6: AD 03 27     LDA $2703
03/DDE9: 10 3C        BPL $DE27
03/DDEB: 9C 03 27     STZ $2703
03/DDEE: 9C 04 27     STZ $2704
03/DDF1: 9C 05 27     STZ $2705
03/DDF4: 9C 06 27     STZ $2706
03/DDF7: 64 D6        STZ $D6
03/DDF9: A5 CF        LDA $CF
03/DDFB: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/DDFE: A9 03        LDA #$03        ; action timer
03/DE00: 20 C8 85     JSR $85C8       ; set timer
03/DE03: 9E 06 2A     STZ $2A06,X
03/DE06: AD 2F 35     LDA $352F
03/DE09: 0A           ASL 
03/DE0A: AA           TAX 
03/DE0B: A9 40        LDA #$40
03/DE0D: 9D EB 29     STA $29EB,X     ; enable action timer
03/DE10: A5 CF        LDA $CF
03/DE12: C9 05        CMP #$05
03/DE14: 90 11        BCC $DE27
03/DE16: 38           SEC 
03/DE17: E9 05        SBC #$05
03/DE19: AA           TAX 
03/DE1A: BD BD 29     LDA $29BD,X
03/DE1D: 9D B5 29     STA $29B5,X
03/DE20: AA           TAX 
03/DE21: FE CA 29     INC $29CA,X
03/DE24: EE CD 29     INC $29CD
03/DE27: AD 09 27     LDA $2709
03/DE2A: 8D 07 27     STA $2707
03/DE2D: AD 0A 27     LDA $270A
03/DE30: 8D 08 27     STA $2708
03/DE33: 60           RTS 
; magic effect $31: change form
03/DE34: A9 03        LDA #$03
03/DE36: 8D E6 38     STA $38E6
03/DE39: EE 82 38     INC $3882
03/DE3C: AD 83 26     LDA $2683
03/DE3F: 09 80        ORA #$80
03/DE41: 8D 83 26     STA $2683
03/DE44: AD 03 27     LDA $2703
03/DE47: 09 80        ORA #$80
03/DE49: 8D 03 27     STA $2703
03/DE4C: AD A0 29     LDA $29A0
03/DE4F: 85 A9        STA $A9
03/DE51: 29 03        AND #$03
03/DE53: C9 03        CMP #$03
03/DE55: D0 03        BNE $DE5A
03/DE57: 4C DB DE     JMP $DEDB
03/DE5A: 7B           TDC 
03/DE5B: AA           TAX 
03/DE5C: 86 AB        STX $AB
03/DE5E: 18           CLC 
03/DE5F: BD B5 29     LDA $29B5,X
03/DE62: 30 04        BMI $DE68
03/DE64: 65 AB        ADC $AB
03/DE66: 85 AB        STA $AB
03/DE68: E8           INX 
03/DE69: E0 08 00     CPX #$0008
03/DE6C: D0 F1        BNE $DE5F
03/DE6E: A5 AB        LDA $AB
03/DE70: D0 43        BNE $DEB5
03/DE72: A5 A9        LDA $A9
03/DE74: 29 C0        AND #$C0
03/DE76: 20 82 84     JSR $8482       ; lsr6
03/DE79: AA           TAX 
03/DE7A: 86 8A        STX $8A
03/DE7C: 64 B1        STZ $B1
03/DE7E: 64 B2        STZ $B2
03/DE80: 20 B0 DF     JSR $DFB0
03/DE83: A5 A9        LDA $A9
03/DE85: 29 30        AND #$30
03/DE87: 20 84 84     JSR $8484       ; lsr4
03/DE8A: AA           TAX 
03/DE8B: 86 8C        STX $8C
03/DE8D: F0 0B        BEQ $DE9A
03/DE8F: A9 01        LDA #$01
03/DE91: 20 5F DF     JSR $DF5F
03/DE94: C6 8C        DEC $8C
03/DE96: A5 8C        LDA $8C
03/DE98: D0 F5        BNE $DE8F
03/DE9A: AD A0 29     LDA $29A0
03/DE9D: 29 0C        AND #$0C
03/DE9F: 20 86 84     JSR $8486       ; lsr2
03/DEA2: AA           TAX 
03/DEA3: 86 8C        STX $8C
03/DEA5: F0 0B        BEQ $DEB2
03/DEA7: A9 02        LDA #$02
03/DEA9: 20 5F DF     JSR $DF5F
03/DEAC: C6 8C        DEC $8C
03/DEAE: A5 8C        LDA $8C
03/DEB0: D0 F5        BNE $DEA7
03/DEB2: 4C 5E DF     JMP $DF5E
03/DEB5: A9 01        LDA #$01
03/DEB7: 85 B1        STA $B1
03/DEB9: 1A           INC 
03/DEBA: 85 B2        STA $B2
03/DEBC: 20 B0 DF     JSR $DFB0
03/DEBF: 7B           TDC 
03/DEC0: AA           TAX 
03/DEC1: 86 8A        STX $8A
03/DEC3: A5 A9        LDA $A9
03/DEC5: 29 C0        AND #$C0
03/DEC7: 20 82 84     JSR $8482       ; lsr6
03/DECA: AA           TAX 
03/DECB: 86 8C        STX $8C
03/DECD: A9 00        LDA #$00
03/DECF: 20 5F DF     JSR $DF5F
03/DED2: C6 8C        DEC $8C
03/DED4: A5 8C        LDA $8C
03/DED6: D0 F5        BNE $DECD
03/DED8: 4C 5E DF     JMP $DF5E
03/DEDB: 7B           TDC 
03/DEDC: AA           TAX 
03/DEDD: 18           CLC 
03/DEDE: BD B5 29     LDA $29B5,X
03/DEE1: C9 02        CMP #$02
03/DEE3: D0 02        BNE $DEE7
03/DEE5: 80 3F        BRA $DF26
03/DEE7: E8           INX 
03/DEE8: E0 08 00     CPX #$0008
03/DEEB: D0 F1        BNE $DEDE
03/DEED: A5 A9        LDA $A9
03/DEEF: 29 C0        AND #$C0
03/DEF1: 20 82 84     JSR $8482
03/DEF4: 8D AB 00     STA $00AB
03/DEF7: A5 A9        LDA $A9
03/DEF9: 29 30        AND #$30
03/DEFB: 20 84 84     JSR $8484
03/DEFE: 18           CLC 
03/DEFF: 6D AB 00     ADC $00AB
03/DF02: AA           TAX 
03/DF03: 86 8A        STX $8A
03/DF05: A9 00        LDA #$00
03/DF07: 85 B1        STA $B1
03/DF09: 1A           INC 
03/DF0A: 85 B2        STA $B2
03/DF0C: 20 B0 DF     JSR $DFB0
03/DF0F: A5 A9        LDA $A9
03/DF11: 29 0C        AND #$0C
03/DF13: 20 86 84     JSR $8486       ; lsr2
03/DF16: AA           TAX 
03/DF17: 86 8C        STX $8C
03/DF19: A9 02        LDA #$02
03/DF1B: 20 5F DF     JSR $DF5F
03/DF1E: C6 8C        DEC $8C
03/DF20: A5 8C        LDA $8C
03/DF22: D0 F5        BNE $DF19
03/DF24: 80 38        BRA $DF5E
03/DF26: 7B           TDC 
03/DF27: AA           TAX 
03/DF28: 86 8A        STX $8A
03/DF2A: A9 02        LDA #$02
03/DF2C: 85 B1        STA $B1
03/DF2E: 85 B2        STA $B2
03/DF30: 20 B0 DF     JSR $DFB0
03/DF33: A5 A9        LDA $A9
03/DF35: 29 C0        AND #$C0
03/DF37: 20 82 84     JSR $8482       ; lsr6
03/DF3A: AA           TAX 
03/DF3B: 86 8C        STX $8C
03/DF3D: A9 00        LDA #$00
03/DF3F: 20 5F DF     JSR $DF5F
03/DF42: C6 8C        DEC $8C
03/DF44: A5 8C        LDA $8C
03/DF46: D0 F5        BNE $DF3D
03/DF48: AD A0 29     LDA $29A0
03/DF4B: 29 30        AND #$30
03/DF4D: 20 84 84     JSR $8484       ; lsr4
03/DF50: AA           TAX 
03/DF51: 86 8C        STX $8C
03/DF53: A9 01        LDA #$01
03/DF55: 20 5F DF     JSR $DF5F
03/DF58: C6 8C        DEC $8C
03/DF5A: A5 8C        LDA $8C
03/DF5C: D0 F5        BNE $DF53
03/DF5E: 60           RTS 
03/DF5F: A6 8A        LDX $8A
03/DF61: 9D B5 29     STA $29B5,X
03/DF64: AA           TAX 
03/DF65: FE CA 29     INC $29CA,X
03/DF68: EE CD 29     INC $29CD
03/DF6B: 18           CLC 
03/DF6C: A5 8A        LDA $8A
03/DF6E: 69 05        ADC #$05
03/DF70: 85 88        STA $88
03/DF72: 85 DF        STA $DF
03/DF74: A9 80        LDA #$80
03/DF76: 85 E1        STA $E1
03/DF78: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/DF7B: A6 E3        LDX $E3
03/DF7D: 9E 03 20     STZ $2003,X
03/DF80: 9E 04 20     STZ $2004,X
03/DF83: 9E 05 20     STZ $2005,X
03/DF86: 9E 06 20     STZ $2006,X
03/DF89: BD 09 20     LDA $2009,X
03/DF8C: 9D 07 20     STA $2007,X
03/DF8F: BD 0A 20     LDA $200A,X
03/DF92: 9D 08 20     STA $2008,X
03/DF95: 64 D6        STZ $D6
03/DF97: A5 88        LDA $88
03/DF99: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/DF9C: A9 03        LDA #$03        ; action timer
03/DF9E: 20 C8 85     JSR $85C8       ; set timer
03/DFA1: 9E 06 2A     STZ $2A06,X
03/DFA4: A5 88        LDA $88
03/DFA6: 0A           ASL 
03/DFA7: AA           TAX 
03/DFA8: A9 40        LDA #$40
03/DFAA: 9D EB 29     STA $29EB,X     ; enable action timer
03/DFAD: E6 8A        INC $8A
03/DFAF: 60           RTS 
03/DFB0: A2 80 02     LDX #$0280
03/DFB3: 7B           TDC 
03/DFB4: A8           TAY 
03/DFB5: B9 B5 29     LDA $29B5,Y
03/DFB8: C5 B1        CMP $B1
03/DFBA: F0 04        BEQ $DFC0
03/DFBC: C5 B2        CMP $B2
03/DFBE: D0 08        BNE $DFC8
03/DFC0: BD 03 20     LDA $2003,X
03/DFC3: 09 80        ORA #$80
03/DFC5: 9D 03 20     STA $2003,X
03/DFC8: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/DFCB: C8           INY 
03/DFCC: C0 08 00     CPY #$0008
03/DFCF: D0 E4        BNE $DFB5
03/DFD1: 60           RTS 
; magic effect $32: end battle
03/DFD2: A9 04        LDA #$04
03/DFD4: 8D A8 00     STA $00A8
03/DFD7: 60           RTS 
; magic effect $33: targeting (search)
03/DFD8: A5 CE        LDA $CE         ; target
03/DFDA: A8           TAY 
03/DFDB: A5 CD        LDA $CD
03/DFDD: 29 7F        AND #$7F
03/DFDF: AA           TAX 
03/DFE0: A9 00        LDA #$00
03/DFE2: 38           SEC 
03/DFE3: 6A           ROR 
03/DFE4: 88           DEY 
03/DFE5: 10 FC        BPL $DFE3
03/DFE7: 9D 83 38     STA $3883,X     ; set "targeting" target
03/DFEA: 60           RTS 
; magic effect $34: hatch
03/DFEB: AD 05 27     LDA $2705
03/DFEE: 29 DF        AND #$DF
03/DFF0: 8D 05 27     STA $2705
03/DFF3: A5 CD        LDA $CD
03/DFF5: 29 7F        AND #$7F
03/DFF7: AA           TAX 
03/DFF8: BD B5 29     LDA $29B5,X
03/DFFB: AA           TAX 
03/DFFC: 9E D0 38     STZ $38D0,X
03/DFFF: 60           RTS 
; magic effect $35: mist dragon attack
03/E000: 7B           TDC 
03/E001: AA           TAX 
03/E002: 86 A9        STX $A9
03/E004: BD 00 20     LDA $2000,X
03/E007: 29 1F        AND #$1F
03/E009: C9 11        CMP #$11
03/E00B: F0 07        BEQ $E014
03/E00D: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/E010: E6 A9        INC $A9
03/E012: 80 F0        BRA $E004
03/E014: A5 A9        LDA $A9
03/E016: 20 89 84     JSR $8489       ; set current character/monster
03/E019: A9 03        LDA #$03
03/E01B: 20 69 85     JSR $8569       ; get pointer to timer
03/E01E: AE 98 35     LDX $3598
03/E021: A9 0A        LDA #$0A
03/E023: 9D 04 2A     STA $2A04,X
03/E026: 9E 05 2A     STZ $2A05,X
03/E029: 9E 06 2A     STZ $2A06,X
03/E02C: EE E4 38     INC $38E4       ; delay monster death
03/E02F: 60           RTS 

; [ remove target ]

03/E030: AD 54 35     LDA $3554
03/E033: D0 0F        BNE $E044
03/E035: A5 CE        LDA $CE
03/E037: 29 7F        AND #$7F
03/E039: AA           TAX 
03/E03A: AD 50 35     LDA $3550       ; targets
03/E03D: 20 5A 85     JSR $855A       ; clear bit
03/E040: 8D 50 35     STA $3550
03/E043: 60           RTS 
03/E044: A5 CE        LDA $CE
03/E046: 29 7F        AND #$7F
03/E048: AA           TAX 
03/E049: AD 23 35     LDA $3523       ; targets reflected onto
03/E04C: 20 5A 85     JSR $855A       ; clear bit
03/E04F: 8D 23 35     STA $3523
03/E052: 60           RTS 

; [ get summon attack id ]

03/E053: C9 3E        CMP #$3E
03/E055: 90 1A        BCC $E071
03/E057: C9 3F        CMP #$3F
03/E059: D0 04        BNE $E05F
03/E05B: A9 5D        LDA #$5D
03/E05D: 80 18        BRA $E077
03/E05F: A2 00 00     LDX #$0000
03/E062: A9 02        LDA #$02
03/E064: 20 79 83     JSR $8379       ; random (X..A)
03/E067: 48           PHA 
03/E068: A9 F8        LDA #$F8
03/E06A: 8D D4 26     STA $26D4
03/E06D: 68           PLA 
03/E06E: 18           CLC 
03/E06F: 69 3E        ADC #$3E
03/E071: 38           SEC 
03/E072: E9 31        SBC #$31
03/E074: 18           CLC 
03/E075: 69 4D        ADC #$4D
03/E077: 8D D2 26     STA $26D2
03/E07A: EE 84 35     INC $3584
03/E07D: 60           RTS 

; [ subtract mp if summon failed ]

03/E07E: BD 00 20     LDA $2000,X
03/E081: 29 1F        AND #$1F
03/E083: C9 11        CMP #$11
03/E085: D0 0C        BNE $E093       ; return if not rydia
03/E087: AD 8B 26     LDA $268B
03/E08A: 9D 0B 20     STA $200B,X
03/E08D: AD 8C 26     LDA $268C
03/E090: 9D 0C 20     STA $200C,X
03/E093: 60           RTS 

; magic effect jump table
03/E094: D378 D3B2 D40C D443 D466 D488 D505 D5A6  ; $00
03/E0A4: D613 D61C D64B D6E8 D81A D83F D863 D887
03/E0B4: D8A0 D8DE D917 D972 D990 D9EC DA0C DA1E  ; $10
03/E0C4: DA66 DA7F DAA1 DB6A DBC0 DBC0 DBF0 DC36
03/E0D4: DC9B DCBB DCD6 DCFB DD06 DD1D DD32 DD51  ; $20
03/E0E4: DD95 DD9B DDB1 DDC9 DD65 DDDC DDD9 DDDD
03/E0F4: DDE1 DE34 DFD2 DFD8 DFEB E000            ; $30

; [ check elemental resistance ]

03/E100: AD 26 27     LDA $2726
03/E103: 2D A2 28     AND $28A2
03/E106: F0 11        BEQ $E119
03/E108: 7B           TDC 
03/E109: 8D FE 38     STA $38FE       ; zero damage
03/E10C: AD 26 27     LDA $2726
03/E10F: 29 40        AND #$40
03/E111: F0 1F        BEQ $E132
03/E113: A9 84        LDA #$84        ; 2x hp restored
03/E115: 8D FE 38     STA $38FE
03/E118: 60           RTS 
03/E119: AD 25 27     LDA $2725
03/E11C: 2D A2 28     AND $28A2
03/E11F: F0 11        BEQ $E132
03/E121: A9 01        LDA #$01        ; 1/2x damage
03/E123: 8D FE 38     STA $38FE
03/E126: AD 25 27     LDA $2725
03/E129: 29 40        AND #$40
03/E12B: F0 05        BEQ $E132
03/E12D: A9 82        LDA #$82        ; 1x hp restored
03/E12F: 8D FE 38     STA $38FE
03/E132: 60           RTS 

; [ check elemental weakness ]

03/E133: AD FE 38     LDA $38FE
03/E136: C9 02        CMP #$02
03/E138: D0 1B        BNE $E155
03/E13A: AD 21 27     LDA $2721
03/E13D: 2D A2 28     AND $28A2
03/E140: F0 06        BEQ $E148
03/E142: A9 08        LDA #$08        ; 4x hp restored
03/E144: 8D FE 38     STA $38FE
03/E147: 60           RTS 
03/E148: AD 20 27     LDA $2720
03/E14B: 2D A2 28     AND $28A2
03/E14E: F0 05        BEQ $E155
03/E150: A9 04        LDA #$04        ; 2x hp restored
03/E152: 8D FE 38     STA $38FE
03/E155: 60           RTS 

; [ battle command $14: search (peep) ]

03/E156: AD 70 27     LDA $2770
03/E159: 10 03        BPL $E15E       ; branch if not a boss
03/E15B: 4C B4 E1     JMP $E1B4
03/E15E: C2 20        REP #$20
03/E160: AD 07 27     LDA $2707
03/E163: 8D 9A 35     STA $359A
03/E166: AD 09 27     LDA $2709
03/E169: 8D 9D 35     STA $359D
03/E16C: 7B           TDC 
03/E16D: E2 20        SEP #$20
03/E16F: 9C 9C 35     STZ $359C
03/E172: 9C 9F 35     STZ $359F
03/E175: AD 20 27     LDA $2720
03/E178: 2D 25 27     AND $2725
03/E17B: 49 FF        EOR #$FF
03/E17D: 2D 20 27     AND $2720
03/E180: 29 3F        AND #$3F
03/E182: 85 A9        STA $A9
03/E184: D0 07        BNE $E18D
03/E186: A9 14        LDA #$14
03/E188: 8D CB 34     STA $34CB
03/E18B: 80 15        BRA $E1A2
03/E18D: 7B           TDC 
03/E18E: AA           TAX 
03/E18F: A8           TAY 
03/E190: 46 A9        LSR $A9
03/E192: 90 08        BCC $E19C
03/E194: 98           TYA 
03/E195: 18           CLC 
03/E196: 69 15        ADC #$15
03/E198: 9D CB 34     STA $34CB,X
03/E19B: E8           INX 
03/E19C: C8           INY 
03/E19D: C0 06 00     CPY #$0006
03/E1A0: D0 EE        BNE $E190
03/E1A2: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E1A5: A9 1E        LDA #$1E        ; target's hp text
03/E1A7: 8D CA 34     STA $34CA
03/E1AA: A9 14        LDA #$14
03/E1AC: 8D C8 34     STA $34C8       ; set command name
03/E1AF: A9 10        LDA #$10
03/E1B1: 8D C7 34     STA $34C7       ; show command name
03/E1B4: 60           RTS 

; [ battle command $24: run away ]

03/E1B5: A9 04        LDA #$04
03/E1B7: 8D E6 38     STA $38E6
03/E1BA: A6 A6        LDX $A6
03/E1BC: BD 03 20     LDA $2003,X
03/E1BF: 09 80        ORA #$80
03/E1C1: 9D 03 20     STA $2003,X
03/E1C4: A9 05        LDA #$05
03/E1C6: 8D CA 34     STA $34CA
03/E1C9: EE 0A 39     INC $390A
03/E1CC: 4C 9B 85     JMP $859B       ; add message to graphics script

; [ battle command $17: steal (sneak) ]

; steal rate is (attacker level + 50) - (monster level + 10)
; so 40% if attacker and monster are at the same level
; after a failed steal, there is a (monster level + 10) chance
; that edge takes damage of (max hp) / 16

03/E1CF: A9 17        LDA #$17
03/E1D1: 8D C8 34     STA $34C8       ; set command name
03/E1D4: A9 10        LDA #$10
03/E1D6: 8D C7 34     STA $34C7       ; show command name
03/E1D9: A9 F8        LDA #$F8        ; display text
03/E1DB: 8D C6 33     STA $33C6
03/E1DE: A9 04        LDA #$04        ; damage numerals
03/E1E0: 8D C7 33     STA $33C7
03/E1E3: 20 B1 85     JSR $85B1       ; add message to graphics script
03/E1E6: A5 CE        LDA $CE
03/E1E8: 30 03        BMI $E1ED       ; branch if monster target
03/E1EA: 4C 3C E2     JMP $E23C
03/E1ED: 20 8B 85     JSR $858B       ; random (0..98)
03/E1F0: 85 A9        STA $A9
03/E1F2: 18           CLC 
03/E1F3: A9 32        LDA #$32
03/E1F5: 6D 82 26     ADC $2682       ; attacker level + 50
03/E1F8: 38           SEC 
03/E1F9: ED 2F 27     SBC $272F       ; subtract (monster level + 10)
03/E1FC: B0 04        BCS $E202
03/E1FE: A9 01        LDA #$01        ; min 1
03/E200: 80 06        BRA $E208
03/E202: C9 63        CMP #$63        ; max 99
03/E204: 90 02        BCC $E208
03/E206: A9 63        LDA #$63
03/E208: C5 A9        CMP $A9         ; compare to random value
03/E20A: B0 36        BCS $E242
03/E20C: 20 8B 85     JSR $858B       ; random (0..98)
03/E20F: CD 2F 27     CMP $272F
03/E212: 90 28        BCC $E23C       ; branch if less than (monster level + 10)
; steal failed and caught by monster
03/E214: C2 20        REP #$20
03/E216: AD 89 26     LDA $2689       ; attacker max hp / 16
03/E219: 20 84 84     JSR $8484       ; lsr4
03/E21C: 85 A9        STA $A9
03/E21E: A9 00 00     LDA #$0000
03/E221: E2 20        SEP #$20
03/E223: A5 CD        LDA $CD
03/E225: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/E228: A5 A9        LDA $A9
03/E22A: 9D D4 34     STA $34D4,X
03/E22D: A5 AA        LDA $AA
03/E22F: 9D D5 34     STA $34D5,X
03/E232: 20 6E CA     JSR $CA6E       ; update hp after damage
03/E235: A9 1C        LDA #$1C        ;  (caught by the monster)
03/E237: 8D CA 34     STA $34CA
03/E23A: 80 05        BRA $E241
; steal failed
03/E23C: A9 1B        LDA #$1B        ;  (couldn't steal)
03/E23E: 8D CA 34     STA $34CA
03/E241: 60           RTS 
; steal succeeded
03/E242: AD 73 27     LDA $2773       ; item drop rate
03/E245: 29 C0        AND #$C0
03/E247: C9 C0        CMP #$C0
03/E249: D0 01        BNE $E24C       ; branch if nonzero
03/E24B: 60           RTS 
03/E24C: 7B           TDC 
03/E24D: 1A           INC 
03/E24E: 85 AA        STA $AA         ; qty: 1
03/E250: AD 73 27     LDA $2773       ; monster item set
03/E253: 29 3F        AND #$3F
03/E255: 20 7F 84     JSR $847F       ; asl2
03/E258: AA           TAX 
03/E259: BF 00 9F 0E  LDA $0E9F00,X   ; monster items (always choose 1st item)
03/E25D: F0 DD        BEQ $E23C       ; branch if no item
03/E25F: 85 A9        STA $A9
03/E261: C9 61        CMP #$61
03/E263: B0 08        BCS $E26D
03/E265: C9 54        CMP #$54
03/E267: 90 04        BCC $E26D
03/E269: A9 0A        LDA #$0A        ; qty: 10 (arrows)
03/E26B: 85 AA        STA $AA
03/E26D: 7B           TDC 
03/E26E: AA           TAX 
03/E26F: 9B           TXY 
03/E270: BD 1B 32     LDA $321B,X     ; find item in inventory
03/E273: C5 A9        CMP $A9
03/E275: F0 2D        BEQ $E2A4
03/E277: E8           INX 
03/E278: E8           INX 
03/E279: E8           INX 
03/E27A: E8           INX 
03/E27B: C8           INY 
03/E27C: C0 30 00     CPY #$0030
03/E27F: D0 EF        BNE $E270
03/E281: AD F4 38     LDA $38F4
03/E284: C9 FF        CMP #$FF
03/E286: F0 B4        BEQ $E23C       ; branch if no empty inventory slots
03/E288: A8           TAY 
03/E289: C2 20        REP #$20
03/E28B: 0A           ASL 
03/E28C: 0A           ASL 
03/E28D: AA           TAX 
03/E28E: 7B           TDC 
03/E28F: E2 20        SEP #$20
03/E291: A5 AA        LDA $AA
03/E293: 9D 1C 32     STA $321C,X     ; add item to inventory
03/E296: A5 A9        LDA $A9
03/E298: 9D 1B 32     STA $321B,X
03/E29B: 86 AB        STX $AB
03/E29D: 5A           PHY 
03/E29E: 20 2C EB     JSR $EB2C       ; load stolen item properties
03/E2A1: 7A           PLY 
03/E2A2: 80 20        BRA $E2C4
; item already in inventory
03/E2A4: 18           CLC 
03/E2A5: BD 1C 32     LDA $321C,X     ; add to quantity
03/E2A8: 65 AA        ADC $AA
03/E2AA: C9 64        CMP #$64
03/E2AC: 90 13        BCC $E2C1
03/E2AE: 48           PHA 
03/E2AF: A9 63        LDA #$63        ; max 99
03/E2B1: 9D 1C 32     STA $321C,X
03/E2B4: 20 D2 E2     JSR $E2D2       ; draw stolen item text in inventory
03/E2B7: 68           PLA 
03/E2B8: 38           SEC 
03/E2B9: E9 63        SBC #$63        ; try to put overflow in another slot
03/E2BB: F0 07        BEQ $E2C4
03/E2BD: 85 AA        STA $AA
03/E2BF: 80 B6        BRA $E277
03/E2C1: 9D 1C 32     STA $321C,X
03/E2C4: 20 D2 E2     JSR $E2D2       ; draw stolen item text in inventory
03/E2C7: A5 A9        LDA $A9
03/E2C9: 8D 9A 35     STA $359A       ; item id for message display
03/E2CC: A9 1D        LDA #$1D        ; <item> (stole item)
03/E2CE: 8D CA 34     STA $34CA
03/E2D1: 60           RTS 

; [ draw stolen item text in inventory ]

03/E2D2: DA           PHX 
03/E2D3: 5A           PHY 
03/E2D4: 98           TYA 
03/E2D5: 85 01        STA $01
03/E2D7: A9 06        LDA #$06        ; battle graphics $06: draw inventory item text
03/E2D9: 20 85 80     JSR $8085       ; execute battle graphics
03/E2DC: 7A           PLY 
03/E2DD: FA           PLX 
03/E2DE: 60           RTS 

; [ battle command $0A: salve ]

03/E2DF: A9 C1        LDA #$C1
03/E2E1: 8D C4 33     STA $33C4
03/E2E4: 7B           TDC 
03/E2E5: AA           TAX 
03/E2E6: A8           TAY 
03/E2E7: BD 1B 32     LDA $321B,X
03/E2EA: C9 CE        CMP #$CE
03/E2EC: F0 14        BEQ $E302
03/E2EE: C8           INY 
03/E2EF: E8           INX 
03/E2F0: E8           INX 
03/E2F1: E8           INX 
03/E2F2: E8           INX 
03/E2F3: E0 C0 00     CPX #$00C0
03/E2F6: D0 EF        BNE $E2E7
03/E2F8: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E2FB: A9 0F        LDA #$0F
03/E2FD: 8D CA 34     STA $34CA
03/E300: 80 42        BRA $E344
03/E302: BD 1A 32     LDA $321A,X
03/E305: 29 7F        AND #$7F
03/E307: 9D 1A 32     STA $321A,X
03/E30A: BD 1C 32     LDA $321C,X
03/E30D: C9 01        CMP #$01
03/E30F: 90 E7        BCC $E2F8
03/E311: 38           SEC 
03/E312: BD 1C 32     LDA $321C,X
03/E315: E9 01        SBC #$01
03/E317: 9D 1C 32     STA $321C,X
03/E31A: D0 0B        BNE $E327
03/E31C: 9E 1C 32     STZ $321C,X
03/E31F: 9E 1B 32     STZ $321B,X
03/E322: A9 80        LDA #$80
03/E324: 9D 1A 32     STA $321A,X
03/E327: 98           TYA 
03/E328: 85 01        STA $01
03/E32A: A9 06        LDA #$06        ; battle graphics $06: draw inventory item text
03/E32C: 20 85 80     JSR $8085       ; execute battle graphics
03/E32F: A9 F8        LDA #$F8
03/E331: 8D D4 26     STA $26D4
03/E334: A9 CE        LDA #$CE
03/E336: 8D D2 26     STA $26D2
03/E339: EE 2A 35     INC $352A
03/E33C: 20 2E CD     JSR $CD2E       ; do magic attack
03/E33F: A9 CE        LDA #$CE
03/E341: 8D C5 33     STA $33C5
03/E344: A9 0A        LDA #$0A
03/E346: 8D C8 34     STA $34C8       ; set command name
03/E349: A9 10        LDA #$10
03/E34B: 8D C7 34     STA $34C7       ; show command name
03/E34E: 60           RTS 

; [ battle command $16: throw (dart) ]

03/E34F: A9 16        LDA #$16
03/E351: 8D C8 34     STA $34C8       ; set command name
03/E354: A9 10        LDA #$10
03/E356: 8D C7 34     STA $34C7       ; show command name
03/E359: A9 F8        LDA #$F8        ; display text
03/E35B: 8D C6 33     STA $33C6
03/E35E: A9 04        LDA #$04        ; damage numerals
03/E360: 8D C7 33     STA $33C7
03/E363: A5 CE        LDA $CE
03/E365: 30 10        BMI $E377
03/E367: A9 D3        LDA #$D3
03/E369: 8D C4 33     STA $33C4
03/E36C: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E36F: A9 00        LDA #$00
03/E371: 8D CA 34     STA $34CA
03/E374: 4C D3 E3     JMP $E3D3
03/E377: AD 81 38     LDA $3881
03/E37A: D0 EB        BNE $E367
03/E37C: AD D2 26     LDA $26D2
03/E37F: 8D 80 35     STA $3580       ; thrown item id
03/E382: AA           TAX 
03/E383: 86 E5        STX $E5
03/E385: A2 00 91     LDX #$9100
03/E388: 86 80        STX $80
03/E38A: A9 0F        LDA #$0F
03/E38C: 85 82        STA $82
03/E38E: A9 08        LDA #$08
03/E390: 20 5E 84     JSR $845E       ; load array item
03/E393: AD 9D 28     LDA $289D
03/E396: 85 DF        STA $DF
03/E398: AD 82 26     LDA $2682
03/E39B: 85 E1        STA $E1
03/E39D: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/E3A0: A6 E3        LDX $E3
03/E3A2: 8E 9C 28     STX $289C
03/E3A5: 20 8B 85     JSR $858B       ; random (0..98)
03/E3A8: 18           CLC 
03/E3A9: 6D 9C 28     ADC $289C
03/E3AC: 85 E3        STA $E3
03/E3AE: A9 00        LDA #$00
03/E3B0: 6D 9D 28     ADC $289D
03/E3B3: 85 E4        STA $E4
03/E3B5: A6 E3        LDX $E3
03/E3B7: E0 0F 27     CPX #$270F
03/E3BA: 90 05        BCC $E3C1
03/E3BC: A2 0F 27     LDX #$270F
03/E3BF: 86 E3        STX $E3
03/E3C1: A5 CE        LDA $CE
03/E3C3: 20 62 CA     JSR $CA62       ; get pointer to damage buffer
03/E3C6: A5 E3        LDA $E3
03/E3C8: 9D D4 34     STA $34D4,X
03/E3CB: A5 E4        LDA $E4
03/E3CD: 9D D5 34     STA $34D5,X
03/E3D0: 20 6E CA     JSR $CA6E       ; update hp after damage
03/E3D3: 60           RTS 

; [ battle command $1A: change row ]

03/E3D4: 7B           TDC 
03/E3D5: AA           TAX 
03/E3D6: A8           TAY 
03/E3D7: BD 01 20     LDA $2001,X
03/E3DA: 85 A9        STA $A9
03/E3DC: 29 80        AND #$80
03/E3DE: 49 80        EOR #$80
03/E3E0: 85 AA        STA $AA
03/E3E2: A5 A9        LDA $A9
03/E3E4: 29 7F        AND #$7F
03/E3E6: 05 AA        ORA $AA
03/E3E8: 9D 01 20     STA $2001,X
03/E3EB: C2 20        REP #$20
03/E3ED: 8A           TXA 
03/E3EE: 18           CLC 
03/E3EF: 69 80 00     ADC #$0080
03/E3F2: AA           TAX 
03/E3F3: 7B           TDC 
03/E3F4: E2 20        SEP #$20
03/E3F6: C8           INY 
03/E3F7: C0 05 00     CPY #$0005
03/E3FA: D0 DB        BNE $E3D7
03/E3FC: 60           RTS 

; [ battle command $19: regen ]

03/E3FD: 9C 7C 35     STZ $357C
03/E400: A2 0A 00     LDX #$000A      ; 10 hp gain per tick
03/E403: 8E 7D 35     STX $357D
03/E406: EE 0A 39     INC $390A
03/E409: A9 19        LDA #$19
03/E40B: 8D C8 34     STA $34C8       ; set command name
03/E40E: A9 10        LDA #$10
03/E410: 8D C7 34     STA $34C7       ; show command name
03/E413: A9 22        LDA #$22
03/E415: 8D 7B 39     STA $397B
03/E418: A9 0C        LDA #$0C
03/E41A: 85 D6        STA $D6
03/E41C: A5 CD        LDA $CD
03/E41E: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/E421: A9 03        LDA #$03        ; action timer
03/E423: 20 C8 85     JSR $85C8       ; set timer
03/E426: A9 08        LDA #$08
03/E428: 9D 06 2A     STA $2A06,X
03/E42B: A6 A6        LDX $A6
03/E42D: A9 22        LDA #$22
03/E42F: 9D 51 20     STA $2051,X
03/E432: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E435: A9 36        LDA #$36
03/E437: 8D CA 34     STA $34CA
03/E43A: 60           RTS 

; [ battle command $22: end regen ]

03/E43B: A9 FF        LDA #$FF
03/E43D: 8D 7C 35     STA $357C
03/E440: 60           RTS 

; [ battle command $10: twin 1 ]

03/E441: A2 01 00     LDX #$0001
03/E444: A5 CD        LDA $CD
03/E446: CD 39 35     CMP $3539
03/E449: F0 01        BEQ $E44C
03/E44B: CA           DEX 
03/E44C: BD 39 35     LDA $3539,X
03/E44F: 20 89 84     JSR $8489       ; set current character/monster
03/E452: A6 A6        LDX $A6
03/E454: BD 03 20     LDA $2003,X
03/E457: 29 C0        AND #$C0
03/E459: F0 03        BEQ $E45E
03/E45B: 4C D9 E4     JMP $E4D9
03/E45E: BD 04 20     LDA $2004,X
03/E461: 29 3C        AND #$3C
03/E463: F0 03        BEQ $E468
03/E465: 4C D9 E4     JMP $E4D9
03/E468: BD 05 20     LDA $2005,X
03/E46B: 29 40        AND #$40
03/E46D: F0 03        BEQ $E472
03/E46F: 4C D9 E4     JMP $E4D9
03/E472: BD 05 20     LDA $2005,X
03/E475: 09 04        ORA #$04
03/E477: 9D 05 20     STA $2005,X
03/E47A: AD D0 26     LDA $26D0
03/E47D: 9D 50 20     STA $2050,X
03/E480: AD D3 26     LDA $26D3
03/E483: 9D 53 20     STA $2053,X
03/E486: A9 20        LDA #$20
03/E488: 9D 51 20     STA $2051,X
03/E48B: AE 30 35     LDX $3530
03/E48E: 86 92        STX $92
03/E490: A9 20        LDA #$20
03/E492: 8D 7B 39     STA $397B
03/E495: A9 0C        LDA #$0C
03/E497: 85 D6        STA $D6
03/E499: A5 CD        LDA $CD
03/E49B: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/E49E: A9 03        LDA #$03        ; action timer
03/E4A0: 20 C8 85     JSR $85C8       ; set timer
03/E4A3: A9 08        LDA #$08
03/E4A5: 9D 06 2A     STA $2A06,X
03/E4A8: 18           CLC 
03/E4A9: A5 92        LDA $92
03/E4AB: 69 03        ADC #$03
03/E4AD: 85 92        STA $92
03/E4AF: A5 93        LDA $93
03/E4B1: 69 00        ADC #$00
03/E4B3: 85 93        STA $93
03/E4B5: A6 92        LDX $92
03/E4B7: A5 D4        LDA $D4
03/E4B9: 9D 04 2A     STA $2A04,X
03/E4BC: A5 D5        LDA $D5
03/E4BE: 9D 05 2A     STA $2A05,X
03/E4C1: A9 08        LDA #$08
03/E4C3: 9D 06 2A     STA $2A06,X
03/E4C6: A6 A6        LDX $A6
03/E4C8: BD 05 20     LDA $2005,X
03/E4CB: 09 04        ORA #$04
03/E4CD: 9D 05 20     STA $2005,X
03/E4D0: A9 20        LDA #$20
03/E4D2: 9D 51 20     STA $2051,X
03/E4D5: EE 0A 39     INC $390A
03/E4D8: 60           RTS 
03/E4D9: A9 FF        LDA #$FF
03/E4DB: 8D 7B 35     STA $357B
03/E4DE: A9 11        LDA #$11
03/E4E0: 8D CA 34     STA $34CA
03/E4E3: 4C A6 85     JMP $85A6       ; add message to graphics script

; [ battle command $20: twin 2 ]

03/E4E6: A9 FF        LDA #$FF
03/E4E8: 8D 7B 35     STA $357B
03/E4EB: A6 A6        LDX $A6
03/E4ED: 86 8C        STX $8C
03/E4EF: BD 05 20     LDA $2005,X
03/E4F2: 29 FB        AND #$FB
03/E4F4: 9D 05 20     STA $2005,X
03/E4F7: AD 85 26     LDA $2685
03/E4FA: 29 FB        AND #$FB
03/E4FC: 8D 85 26     STA $2685
03/E4FF: A2 01 00     LDX #$0001
03/E502: A5 CD        LDA $CD
03/E504: CD 39 35     CMP $3539
03/E507: F0 01        BEQ $E50A
03/E509: CA           DEX 
03/E50A: 64 D6        STZ $D6
03/E50C: BD 39 35     LDA $3539,X
03/E50F: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/E512: A6 A6        LDX $A6
03/E514: BD 05 20     LDA $2005,X
03/E517: 29 FB        AND #$FB
03/E519: 9D 05 20     STA $2005,X
03/E51C: BD 03 20     LDA $2003,X
03/E51F: 29 C0        AND #$C0
03/E521: D0 07        BNE $E52A
03/E523: BD 04 20     LDA $2004,X
03/E526: 29 3C        AND #$3C
03/E528: F0 24        BEQ $E54E
03/E52A: A9 21        LDA #$21
03/E52C: 9D 51 20     STA $2051,X
03/E52F: C2 20        REP #$20
03/E531: 8A           TXA 
03/E532: 20 82 84     JSR $8482       ; lsr6
03/E535: 4A           LSR 
03/E536: 85 A9        STA $A9
03/E538: E2 20        SEP #$20
03/E53A: 7B           TDC 
03/E53B: AA           TAX 
03/E53C: BD 39 35     LDA $3539,X
03/E53F: C5 A9        CMP $A9
03/E541: F0 03        BEQ $E546
03/E543: E8           INX 
03/E544: 80 F6        BRA $E53C
03/E546: 09 80        ORA #$80
03/E548: 9D 39 35     STA $3539,X
03/E54B: 4C D9 E4     JMP $E4D9
03/E54E: A9 03        LDA #$03        ; action timer
03/E550: 20 C8 85     JSR $85C8       ; set timer
03/E553: 9E 06 2A     STZ $2A06,X
03/E556: A6 A6        LDX $A6
03/E558: 86 92        STX $92
03/E55A: BD 05 20     LDA $2005,X
03/E55D: 29 40        AND #$40
03/E55F: D0 C9        BNE $E52A
03/E561: A6 8C        LDX $8C
03/E563: BD 03 20     LDA $2003,X
03/E566: 29 C0        AND #$C0
03/E568: D0 C0        BNE $E52A
03/E56A: BD 04 20     LDA $2004,X
03/E56D: 29 3C        AND #$3C
03/E56F: D0 B9        BNE $E52A
03/E571: BD 00 20     LDA $2000,X
03/E574: 29 1F        AND #$1F
03/E576: C9 13        CMP #$13
03/E578: F0 04        BEQ $E57E
03/E57A: C9 15        CMP #$15
03/E57C: D0 04        BNE $E582
03/E57E: A9 5E        LDA #$5E
03/E580: 80 19        BRA $E59B
03/E582: 20 93 85     JSR $8593       ; random (0..255)
03/E585: C9 FF        CMP #$FF
03/E587: 90 08        BCC $E591
03/E589: A9 11        LDA #$11
03/E58B: 8D CA 34     STA $34CA
03/E58E: 4C A6 85     JMP $85A6       ; add message to graphics script
03/E591: C9 40        CMP #$40
03/E593: 90 04        BCC $E599
03/E595: A9 41        LDA #$41
03/E597: 80 02        BRA $E59B
03/E599: A9 40        LDA #$40
03/E59B: 85 94        STA $94
03/E59D: AA           TAX 
03/E59E: 86 E5        STX $E5
03/E5A0: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/E5A3: 86 80        STX $80
03/E5A4: A9 0F        LDA #$0F
03/E5A6: 85 82        STA $82
03/E5A8: A9 06        LDA #$06
03/E5AA: 20 5E 84     JSR $845E       ; load array item
03/E5AD: AD A0 28     LDA $28A0
03/E5B0: 29 7F        AND #$7F        ; element status effect
03/E5B2: 85 DF        STA $DF
03/E5B4: A9 03        LDA #$03
03/E5B6: 85 E1        STA $E1
03/E5B8: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/E5BC: A6 E3        LDX $E3
03/E5BE: 7B           TDC 
03/E5BF: A8           TAY 
03/E5C0: BF 90 A5 0F  LDA $0FA590,X
03/E5C4: 99 A2 28     STA $28A2,Y
03/E5C7: C8           INY 
03/E5C8: E8           INX 
03/E5C9: C0 03 00     CPY #$0003
03/E5CC: D0 F2        BNE $E5C0
03/E5CE: AD 8B 26     LDA $268B
03/E5D1: 85 A9        STA $A9
03/E5D3: AD 8C 26     LDA $268C
03/E5D6: F0 04        BEQ $E5DC
03/E5D8: A9 FF        LDA #$FF
03/E5DA: 85 A9        STA $A9
03/E5DC: AD A1 28     LDA $28A1
03/E5DF: 29 7F        AND #$7F
03/E5E1: 85 AB        STA $AB
03/E5E3: C5 A9        CMP $A9
03/E5E5: F0 02        BEQ $E5E9
03/E5E7: B0 28        BCS $E611
03/E5E9: A6 92        LDX $92
03/E5EB: 38           SEC 
03/E5EC: BD 0B 20     LDA $200B,X
03/E5EF: E5 AB        SBC $AB
03/E5F1: 85 A9        STA $A9
03/E5F3: BD 0C 20     LDA $200C,X
03/E5F6: E9 00        SBC #$00
03/E5F8: 85 AA        STA $AA
03/E5FA: 90 15        BCC $E611
03/E5FC: A5 A9        LDA $A9
03/E5FE: 9D 0B 20     STA $200B,X
03/E601: A5 AA        LDA $AA
03/E603: 9D 0C 20     STA $200C,X
03/E606: A5 94        LDA $94
03/E608: 8D D2 26     STA $26D2
03/E60B: EE 5D 35     INC $355D
03/E60E: 20 2E CD     JSR $CD2E       ; do magic attack
03/E611: 60           RTS 

; [ battle command $13: cover ]

03/E612: A5 CE        LDA $CE
03/E614: 8D 7A 35     STA $357A
03/E617: 20 89 84     JSR $8489       ; set current character/monster
03/E61A: A6 A6        LDX $A6
03/E61C: BD 06 20     LDA $2006,X
03/E61F: 09 02        ORA #$02
03/E621: 9D 06 20     STA $2006,X
03/E624: A5 CD        LDA $CD
03/E626: 20 89 84     JSR $8489       ; set current character/monster
03/E629: AE 34 35     LDX $3534
03/E62C: BD 03 33     LDA $3303,X
03/E62F: C9 13        CMP #$13
03/E631: F0 06        BEQ $E639
03/E633: E8           INX 
03/E634: E8           INX 
03/E635: E8           INX 
03/E636: E8           INX 
03/E637: 80 F3        BRA $E62C
03/E639: A9 1D        LDA #$1D
03/E63B: 9D 03 33     STA $3303,X
03/E63E: 7B           TDC 
03/E63F: 9D 02 33     STA $3302,X
03/E642: A5 CD        LDA $CD
03/E644: 85 00        STA $00
03/E646: A9 09        LDA #$09        ; battle graphics $09: draw battle command list
03/E648: 20 85 80     JSR $8085       ; execute battle graphics
03/E64B: A9 13        LDA #$13
03/E64D: 8D C8 34     STA $34C8       ; set command name
03/E650: A9 10        LDA #$10
03/E652: 8D C7 34     STA $34C7       ; show command name
03/E655: 60           RTS 

; [ battle command $1D: don't cover (off) ]

03/E656: A9 1D        LDA #$1D
03/E658: 8D C8 34     STA $34C8       ; set command name
03/E65B: A9 10        LDA #$10
03/E65D: 8D C7 34     STA $34C7       ; show command name
03/E660: AD 7A 35     LDA $357A
03/E663: 20 89 84     JSR $8489       ; set current character/monster
03/E666: A6 A6        LDX $A6
03/E668: BD 06 20     LDA $2006,X
03/E66B: 29 FD        AND #$FD
03/E66D: 9D 06 20     STA $2006,X
03/E670: A5 CD        LDA $CD
03/E672: 20 89 84     JSR $8489       ; set current character/monster
03/E675: AE 34 35     LDX $3534
03/E678: BD 03 33     LDA $3303,X
03/E67B: C9 1D        CMP #$1D
03/E67D: F0 06        BEQ $E685
03/E67F: E8           INX 
03/E680: E8           INX 
03/E681: E8           INX 
03/E682: E8           INX 
03/E683: 80 F3        BRA $E678
03/E685: A9 13        LDA #$13
03/E687: 9D 03 33     STA $3303,X
03/E68A: A9 18        LDA #$18
03/E68C: 9D 02 33     STA $3302,X
03/E68F: A5 CD        LDA $CD
03/E691: 85 00        STA $00
03/E693: A9 09        LDA #$09        ; battle graphics $09: draw battle command list
03/E695: 20 85 80     JSR $8085       ; execute battle graphics
03/E698: 60           RTS 

; [ battle command $0F: brace ]

03/E699: A9 05        LDA #$05        ; barrier spell (armor)
03/E69B: 8D D2 26     STA $26D2
03/E69E: 9C C4 33     STZ $33C4
03/E6A1: 20 2E CD     JSR $CD2E       ; do magic attack
03/E6A4: 20 B1 85     JSR $85B1       ; add message to graphics script
03/E6A7: A9 3A        LDA #$3A        ;  (no effect)
03/E6A9: 8D CA 34     STA $34CA
03/E6AC: A9 0F        LDA #$0F
03/E6AE: 8D C8 34     STA $34C8       ; set command name
03/E6B1: A9 10        LDA #$10
03/E6B3: 8D C7 34     STA $34C7       ; show command name
03/E6B6: 60           RTS 

; [ battle command $0E: kick ]

03/E6B7: 64 C1        STZ $C1
03/E6B9: 4C BC E6     JMP $E6BC
03/E6BC: A5 CD        LDA $CD
03/E6BE: 10 4A        BPL $E70A
03/E6C0: 8D C7 34     STA $34C7
03/E6C3: A9 F8        LDA #$F8
03/E6C5: 8D C5 34     STA $34C5
03/E6C8: 7B           TDC 
03/E6C9: AA           TAX 
03/E6CA: A8           TAY 
03/E6CB: BD C2 33     LDA $33C2,X
03/E6CE: 99 9C 28     STA $289C,Y
03/E6D1: C9 CE        CMP #$CE
03/E6D3: F0 08        BEQ $E6DD
03/E6D5: C9 C5        CMP #$C5
03/E6D7: F0 04        BEQ $E6DD
03/E6D9: E8           INX 
03/E6DA: C8           INY 
03/E6DB: 80 EE        BRA $E6CB
03/E6DD: C8           INY 
03/E6DE: A9 F8        LDA #$F8
03/E6E0: 99 9C 28     STA $289C,Y
03/E6E3: C8           INY 
03/E6E4: A9 04        LDA #$04
03/E6E6: 99 9C 28     STA $289C,Y
03/E6E9: C8           INY 
03/E6EA: E8           INX 
03/E6EB: BD C2 33     LDA $33C2,X
03/E6EE: 99 9C 28     STA $289C,Y
03/E6F1: C9 FF        CMP #$FF
03/E6F3: F0 04        BEQ $E6F9
03/E6F5: E8           INX 
03/E6F6: C8           INY 
03/E6F7: 80 F2        BRA $E6EB
03/E6F9: 7B           TDC 
03/E6FA: AA           TAX 
03/E6FB: BD 9C 28     LDA $289C,X
03/E6FE: 9D C2 33     STA $33C2,X
03/E701: C9 FF        CMP #$FF
03/E703: F0 03        BEQ $E708
03/E705: E8           INX 
03/E706: 80 F3        BRA $E6FB
03/E708: 80 0A        BRA $E714
03/E70A: A9 F8        LDA #$F8        ; display text
03/E70C: 8D C6 33     STA $33C6
03/E70F: A9 04        LDA #$04        ; damage numerals
03/E711: 8D C7 33     STA $33C7
03/E714: AD 81 38     LDA $3881
03/E717: F0 03        BEQ $E71C
03/E719: 4C F2 E7     JMP $E7F2
03/E71C: A6 A6        LDX $A6
03/E71E: BD 1B 20     LDA $201B,X
03/E721: 85 DF        STA $DF
03/E723: A5 C1        LDA $C1
03/E725: D0 08        BNE $E72F
03/E727: 46 DF        LSR $DF
03/E729: A5 DF        LDA $DF
03/E72B: D0 02        BNE $E72F
03/E72D: E6 DF        INC $DF
03/E72F: A5 DF        LDA $DF
03/E731: 85 84        STA $84
03/E733: BD 1D 20     LDA $201D,X
03/E736: 85 C5        STA $C5
03/E738: 85 E1        STA $E1
03/E73A: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/E73D: 46 E4        LSR $E4
03/E73F: 66 E3        ROR $E3
03/E741: A6 E3        LDX $E3
03/E743: 86 CB        STX $CB
03/E745: A5 CD        LDA $CD
03/E747: 30 0C        BMI $E755
03/E749: A2 05 00     LDX #$0005
03/E74C: 86 C7        STX $C7
03/E74E: A2 0D 00     LDX #$000D
03/E751: 86 C3        STX $C3
03/E753: 80 09        BRA $E75E
03/E755: 7B           TDC 
03/E756: AA           TAX 
03/E757: 86 C7        STX $C7
03/E759: A2 05 00     LDX #$0005
03/E75C: 86 C3        STX $C3
03/E75E: 7B           TDC 
03/E75F: AA           TAX 
03/E760: A5 C5        LDA $C5
03/E762: 20 79 83     JSR $8379       ; random (X..A)
03/E765: 85 C9        STA $C9
03/E767: 18           CLC 
03/E768: A5 CB        LDA $CB
03/E76A: 65 C9        ADC $C9
03/E76C: 85 C9        STA $C9
03/E76E: A5 CC        LDA $CC
03/E770: 69 00        ADC #$00
03/E772: 85 CA        STA $CA
03/E774: A5 C7        LDA $C7
03/E776: AA           TAX 
03/E777: BD 40 35     LDA $3540,X
03/E77A: D0 68        BNE $E7E4
03/E77C: A5 C7        LDA $C7
03/E77E: 20 89 84     JSR $8489       ; set current character/monster
03/E781: A6 A6        LDX $A6
03/E783: BD 03 20     LDA $2003,X
03/E786: 29 C0        AND #$C0
03/E788: D0 5A        BNE $E7E4
03/E78A: BD 05 20     LDA $2005,X
03/E78D: 29 02        AND #$02
03/E78F: D0 53        BNE $E7E4
03/E791: BD 06 20     LDA $2006,X
03/E794: 30 4E        BMI $E7E4
03/E796: BD 40 20     LDA $2040,X
03/E799: 29 20        AND #$20
03/E79B: D0 47        BNE $E7E4
03/E79D: A5 C1        LDA $C1
03/E79F: F0 0D        BEQ $E7AE
03/E7A1: BD 40 20     LDA $2040,X
03/E7A4: 10 08        BPL $E7AE
03/E7A6: 46 CA        LSR $CA
03/E7A8: 66 C9        ROR $C9
03/E7AA: 46 CA        LSR $CA
03/E7AC: 66 C9        ROR $C9
03/E7AE: A5 C1        LDA $C1
03/E7B0: D0 20        BNE $E7D2
03/E7B2: A5 84        LDA $84
03/E7B4: 85 DF        STA $DF
03/E7B6: BD 2A 20     LDA $202A,X
03/E7B9: 85 E1        STA $E1
03/E7BB: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/E7BE: 38           SEC 
03/E7BF: A5 C9        LDA $C9
03/E7C1: E5 E3        SBC $E3
03/E7C3: 85 C9        STA $C9
03/E7C5: A5 CA        LDA $CA
03/E7C7: E5 E4        SBC $E4
03/E7C9: 85 CA        STA $CA
03/E7CB: B0 05        BCS $E7D2
03/E7CD: A2 00 40     LDX #$4000
03/E7D0: 86 C9        STX $C9
03/E7D2: A6 C9        LDX $C9
03/E7D4: F0 F7        BEQ $E7CD
03/E7D6: A5 C7        LDA $C7
03/E7D8: 0A           ASL 
03/E7D9: AA           TAX 
03/E7DA: A5 C9        LDA $C9
03/E7DC: 9D D4 34     STA $34D4,X
03/E7DF: A5 CA        LDA $CA
03/E7E1: 9D D5 34     STA $34D5,X
03/E7E4: E6 C7        INC $C7
03/E7E6: A5 C7        LDA $C7
03/E7E8: C5 C3        CMP $C3
03/E7EA: F0 03        BEQ $E7EF
03/E7EC: 4C 5E E7     JMP $E75E
03/E7EF: 20 6E CA     JSR $CA6E       ; update hp after damage
03/E7F2: 60           RTS 

; [ battle command $0D: focus 1 ]

03/E7F3: EE 0A 39     INC $390A
03/E7F6: A9 1F        LDA #$1F
03/E7F8: 8D 7B 39     STA $397B
03/E7FB: A9 0C        LDA #$0C
03/E7FD: 85 D6        STA $D6
03/E7FF: A5 CD        LDA $CD
03/E801: 20 2C 9E     JSR $9E2C       ; calculate timer duration
03/E804: A9 03        LDA #$03        ; action timer
03/E806: 20 C8 85     JSR $85C8       ; set timer
03/E809: A9 08        LDA #$08
03/E80B: 9D 06 2A     STA $2A06,X
03/E80E: A6 A6        LDX $A6
03/E810: BD 05 20     LDA $2005,X
03/E813: 09 08        ORA #$08
03/E815: 9D 05 20     STA $2005,X
03/E818: A9 1F        LDA #$1F
03/E81A: 9D 51 20     STA $2051,X
03/E81D: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E820: A9 39        LDA #$39
03/E822: 8D CA 34     STA $34CA
03/E825: 60           RTS 

; [ battle command $1F: focus 2 ]

03/E826: 20 89 C4     JSR $C489       ; do fight command
03/E829: A5 CD        LDA $CD
03/E82B: 20 89 84     JSR $8489       ; set current character/monster
03/E82E: A6 A6        LDX $A6
03/E830: BD 05 20     LDA $2005,X
03/E833: 29 F7        AND #$F7
03/E835: 9D 05 20     STA $2005,X
03/E838: 60           RTS 

; [ battle command $0C: aim ]

03/E839: AD 9C 26     LDA $269C
03/E83C: 48           PHA 
03/E83D: AD 29 27     LDA $2729
03/E840: 48           PHA 
03/E841: 7B           TDC 
03/E842: 8D 29 27     STA $2729
03/E845: 3A           DEC 
03/E846: 8D 9C 26     STA $269C
03/E849: 20 89 C4     JSR $C489       ; do fight command
03/E84C: 68           PLA 
03/E84D: 8D 29 27     STA $2729
03/E850: 68           PLA 
03/E851: 8D 9C 26     STA $269C
03/E854: 60           RTS 

; [ battle command $0B: pray ]

03/E855: 20 93 85     JSR $8593       ; random (0..255)
03/E858: C9 80        CMP #$80
03/E85A: 90 0A        BCC $E866
03/E85C: 20 A6 85     JSR $85A6       ; add message to graphics script
03/E85F: A9 10        LDA #$10
03/E861: 8D CA 34     STA $34CA
03/E864: 80 08        BRA $E86E
03/E866: A9 0E        LDA #$0E
03/E868: 8D D2 26     STA $26D2
03/E86B: 20 2E CD     JSR $CD2E       ; do magic attack
03/E86E: A9 0B        LDA #$0B
03/E870: 8D C8 34     STA $34C8       ; set command name
03/E873: A9 10        LDA #$10
03/E875: 8D C7 34     STA $34C7       ; show command name
03/E878: 60           RTS 

; [ battle command $09: hide ]

03/E879: A6 A6        LDX $A6
03/E87B: BD 06 20     LDA $2006,X
03/E87E: 09 80        ORA #$80
03/E880: 9D 06 20     STA $2006,X
03/E883: AE 34 35     LDX $3534
03/E886: 64 A9        STZ $A9
03/E888: BD 03 33     LDA $3303,X
03/E88B: C9 09        CMP #$09
03/E88D: D0 07        BNE $E896
03/E88F: A9 1C        LDA #$1C
03/E891: 9D 03 33     STA $3303,X
03/E894: 80 08        BRA $E89E
03/E896: BD 02 33     LDA $3302,X
03/E899: 09 80        ORA #$80
03/E89B: 9D 02 33     STA $3302,X
03/E89E: E8           INX 
03/E89F: E8           INX 
03/E8A0: E8           INX 
03/E8A1: E8           INX 
03/E8A2: E6 A9        INC $A9
03/E8A4: A5 A9        LDA $A9
03/E8A6: C9 05        CMP #$05
03/E8A8: D0 DE        BNE $E888
03/E8AA: A5 CD        LDA $CD
03/E8AC: 85 00        STA $00
03/E8AE: A9 09        LDA #$09        ; battle graphics $09: draw battle command list
03/E8B0: 20 85 80     JSR $8085       ; execute battle graphics
03/E8B3: A9 09        LDA #$09
03/E8B5: 8D C8 34     STA $34C8       ; set command name
03/E8B8: A9 10        LDA #$10
03/E8BA: 8D C7 34     STA $34C7       ; show command name
03/E8BD: 60           RTS 

; [ battle command $1C: appear (show) ]

03/E8BE: A6 A6        LDX $A6
03/E8C0: BD 06 20     LDA $2006,X
03/E8C3: 29 7F        AND #$7F
03/E8C5: 9D 06 20     STA $2006,X
03/E8C8: AE 34 35     LDX $3534
03/E8CB: 64 A9        STZ $A9
03/E8CD: BD 03 33     LDA $3303,X
03/E8D0: C9 1C        CMP #$1C
03/E8D2: D0 07        BNE $E8DB
03/E8D4: A9 09        LDA #$09
03/E8D6: 9D 03 33     STA $3303,X
03/E8D9: 80 08        BRA $E8E3
03/E8DB: BD 02 33     LDA $3302,X
03/E8DE: 29 7F        AND #$7F
03/E8E0: 9D 02 33     STA $3302,X
03/E8E3: E8           INX 
03/E8E4: E8           INX 
03/E8E5: E8           INX 
03/E8E6: E8           INX 
03/E8E7: E6 A9        INC $A9
03/E8E9: A5 A9        LDA $A9
03/E8EB: C9 05        CMP #$05
03/E8ED: D0 DE        BNE $E8CD
03/E8EF: A5 CD        LDA $CD
03/E8F1: 85 00        STA $00
03/E8F3: A9 09        LDA #$09        ; battle graphics $09: draw battle command list
03/E8F5: 20 85 80     JSR $8085       ; execute battle graphics
03/E8F8: A9 1C        LDA #$1C
03/E8FA: 8D C8 34     STA $34C8       ; set command name
03/E8FD: A9 10        LDA #$10
03/E8FF: 8D C7 34     STA $34C7       ; show command name
03/E902: 60           RTS 

; [ battle command $08: sing ]

03/E903: AD 83 26     LDA $2683
03/E906: 29 20        AND #$20
03/E908: F0 09        BEQ $E913
03/E90A: A9 0B        LDA #$0B
03/E90C: 8D CA 34     STA $34CA
03/E90F: A9 19        LDA #$19
03/E911: 80 31        BRA $E944
03/E913: 20 93 85     JSR $8593       ; random (0..255)
03/E916: C9 C0        CMP #$C0
03/E918: 90 09        BCC $E923
03/E91A: A9 00        LDA #$00
03/E91C: 8D CA 34     STA $34CA
03/E91F: A9 00        LDA #$00
03/E921: 80 21        BRA $E944
03/E923: C9 80        CMP #$80
03/E925: 90 09        BCC $E930
03/E927: A9 0E        LDA #$0E
03/E929: 8D CA 34     STA $34CA
03/E92C: A9 02        LDA #$02
03/E92E: 80 14        BRA $E944
03/E930: C9 40        CMP #$40
03/E932: 90 09        BCC $E93D
03/E934: A9 0D        LDA #$0D
03/E936: 8D CA 34     STA $34CA
03/E939: A9 03        LDA #$03
03/E93B: 80 07        BRA $E944
03/E93D: A9 0C        LDA #$0C
03/E93F: 8D CA 34     STA $34CA
03/E942: A9 29        LDA #$29
03/E944: 8D D2 26     STA $26D2
03/E947: 20 2E CD     JSR $CD2E       ; do magic attack
03/E94A: A9 08        LDA #$08
03/E94C: 8D C8 34     STA $34C8       ; set command name
03/E94F: A9 10        LDA #$10
03/E951: 8D C7 34     STA $34C7       ; show command name
03/E954: 4C B1 85     JMP $85B1       ; add message to graphics script

; [ battle command $06: jump 1 ]

03/E957: A5 CD        LDA $CD
03/E959: 30 11        BMI $E96C       ; branch if monster attacker
03/E95B: A5 CE        LDA $CE
03/E95D: 30 0D        BMI $E96C       ; branch if monster target
03/E95F: A9 D3        LDA #$D3
03/E961: 8D C4 33     STA $33C4
03/E964: A9 00        LDA #$00        ;  (nothing happened)
03/E966: 8D CA 34     STA $34CA
03/E969: 4C A6 85     JMP $85A6       ; add message to graphics script
03/E96C: EE 0A 39     INC $390A       ; disable retaliation
03/E96F: A2 04 00     LDX #$0004
03/E972: 86 D4        STX $D4         ; timer duration: 4
03/E974: A9 03        LDA #$03        ; action timer
03/E976: 20 C8 85     JSR $85C8       ; set timer
03/E979: A9 08        LDA #$08
03/E97B: 9D 06 2A     STA $2A06,X     ; do command when timer expires
03/E97E: A6 A6        LDX $A6
03/E980: BD 05 20     LDA $2005,X     ; set jumping status
03/E983: 09 02        ORA #$02
03/E985: 9D 05 20     STA $2005,X
03/E988: A5 CD        LDA $CD
03/E98A: 10 04        BPL $E990       ; branch if character attacker
03/E98C: A9 DE        LDA #$DE        ; jump 2 command (monster)
03/E98E: 80 02        BRA $E992
03/E990: A9 1E        LDA #$1E        ; jump 2 command
03/E992: 9D 51 20     STA $2051,X     ; set pending command
03/E995: A5 CD        LDA $CD
03/E997: 0A           ASL 
03/E998: AA           TAX 
03/E999: BD EA 29     LDA $29EA,X     ; save enabled timers *** bug, should be $29EB ***
03/E99C: 8D 7F 35     STA $357F
03/E99F: A9 40        LDA #$40        ; enable action timer only
03/E9A1: 9D EA 29     STA $29EA,X
03/E9A4: 60           RTS 

; [ battle command $1E: jump 2 ]

03/E9A5: 20 89 C4     JSR $C489       ; do fight command
03/E9A8: A5 CD        LDA $CD
03/E9AA: 10 05        BPL $E9B1       ; branch if character attacker
03/E9AC: 29 7F        AND #$7F
03/E9AE: 18           CLC 
03/E9AF: 69 05        ADC #$05
03/E9B1: 20 89 84     JSR $8489       ; set current character/monster
03/E9B4: A6 A6        LDX $A6
03/E9B6: BD 05 20     LDA $2005,X     ; clear jump status
03/E9B9: 29 FD        AND #$FD
03/E9BB: 9D 05 20     STA $2005,X
03/E9BE: A5 CD        LDA $CD
03/E9C0: 0A           ASL 
03/E9C1: AA           TAX 
03/E9C2: AD 7F 35     LDA $357F       ; restore enabled timers *** bug, should be $29EB ***
03/E9C5: 9D EA 29     STA $29EA,X
03/E9C8: A5 CD        LDA $CD
03/E9CA: 10 14        BPL $E9E0       ; return if character attacker
03/E9CC: A9 DE        LDA #$DE        ; jump 2 command (monster)
03/E9CE: 8D C2 33     STA $33C2
03/E9D1: A9 F8        LDA #$F8        ; display text
03/E9D3: 8D C3 33     STA $33C3
03/E9D6: A9 04        LDA #$04        ; damage numerals
03/E9D8: 8D C4 33     STA $33C4
03/E9DB: A9 FF        LDA #$FF
03/E9DD: 8D C5 33     STA $33C5
03/E9E0: 60           RTS 

; [ battle command $1B: defend ]

03/E9E1: A6 A6        LDX $A6
03/E9E3: BD 05 20     LDA $2005,X     ; set defend status
03/E9E6: 09 10        ORA #$10
03/E9E8: 9D 05 20     STA $2005,X
03/E9EB: 60           RTS 

; [ battle command $05: dark wave ]

03/E9EC: A5 CD        LDA $CD
03/E9EE: 30 26        BMI $EA16
03/E9F0: C2 20        REP #$20
03/E9F2: A6 A6        LDX $A6
03/E9F4: BD 09 20     LDA $2009,X
03/E9F7: 20 85 84     JSR $8485       ; lsr3
03/E9FA: 85 A9        STA $A9
03/E9FC: 38           SEC 
03/E9FD: BD 07 20     LDA $2007,X
03/EA00: E5 A9        SBC $A9
03/EA02: 9D 07 20     STA $2007,X
03/EA05: B0 0C        BCS $EA13
03/EA07: A9 00 00     LDA #$0000
03/EA0A: 9D 07 20     STA $2007,X
03/EA0D: A9 80 00     LDA #$0080
03/EA10: 9D 03 20     STA $2003,X
03/EA13: 7B           TDC 
03/EA14: E2 20        SEP #$20
03/EA16: A9 01        LDA #$01
03/EA18: 85 C1        STA $C1
03/EA1A: 4C BC E6     JMP $E6BC

; [ battle command $07: recall ]

03/EA1D: 7B           TDC 
03/EA1E: AA           TAX 
03/EA1F: A9 A0        LDA #$A0
03/EA21: 20 79 83     JSR $8379       ; random (X..A)
03/EA24: C9 08        CMP #$08
03/EA26: B0 04        BCS $EA2C
03/EA28: A9 2A        LDA #$2A
03/EA2A: 80 40        BRA $EA6C
03/EA2C: C9 10        CMP #$10
03/EA2E: B0 04        BCS $EA34
03/EA30: A9 26        LDA #$26
03/EA32: 80 38        BRA $EA6C
03/EA34: C9 18        CMP #$18
03/EA36: B0 04        BCS $EA3C
03/EA38: A9 27        LDA #$27
03/EA3A: 80 30        BRA $EA6C
03/EA3C: C9 20        CMP #$20
03/EA3E: B0 04        BCS $EA44
03/EA40: A9 2B        LDA #$2B
03/EA42: 80 28        BRA $EA6C
03/EA44: C9 38        CMP #$38
03/EA46: B0 04        BCS $EA4C
03/EA48: A9 1D        LDA #$1D
03/EA4A: 80 20        BRA $EA6C
03/EA4C: C9 50        CMP #$50
03/EA4E: B0 04        BCS $EA54
03/EA50: A9 20        LDA #$20
03/EA52: 80 18        BRA $EA6C
03/EA54: C9 68        CMP #$68
03/EA56: B0 04        BCS $EA5C
03/EA58: A9 23        LDA #$23
03/EA5A: 80 10        BRA $EA6C
03/EA5C: C9 80        CMP #$80
03/EA5E: B0 04        BCS $EA64
03/EA60: A9 19        LDA #$19
03/EA62: 80 08        BRA $EA6C
03/EA64: A9 09        LDA #$09
03/EA66: 8D CA 34     STA $34CA
03/EA69: 4C B1 85     JMP $85B1       ; add message to graphics script
03/EA6C: 48           PHA 
03/EA6D: AA           TAX 
03/EA6E: 86 E5        STX $E5
03/EA58: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/EA5B: 86 80        STX $80
03/EA5D: A9 0F        LDA #$0F
03/EA5F: 85 82        STA $82
03/EA61: A9 06        LDA #$06
03/EA63: 20 5E 84     JSR $845E       ; load array item
03/EA66: AD A0 28     LDA $28A0
03/EA69: 29 7F        AND #$7F
03/EA6B: 85 DF        STA $DF
03/EA6D: A9 03        LDA #$03
03/EA6F: 85 E1        STA $E1
03/EA71: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/EA8C: A6 E3        LDX $E3
03/EA8E: 7B           TDC 
03/EA8F: A8           TAY 
03/EA90: BF 90 A5 0F  LDA $0FA590,X
03/EA94: 99 A2 28     STA $28A2,Y
03/EA97: C8           INY 
03/EA98: E8           INX 
03/EA99: C0 03 00     CPY #$0003
03/EA9C: D0 F2        BNE $EA90
03/EA9E: AD 8B 26     LDA $268B
03/EAA1: 85 A9        STA $A9
03/EAA3: AD 8C 26     LDA $268C
03/EAA6: F0 04        BEQ $EAAC
03/EAA8: A9 FF        LDA #$FF
03/EAAA: 85 A9        STA $A9
03/EAAC: AD A1 28     LDA $28A1
03/EAAF: 29 7F        AND #$7F
03/EAB1: C5 A9        CMP $A9
03/EAB3: F0 06        BEQ $EABB
03/EAB5: 90 04        BCC $EABB
03/EAB7: 68           PLA 
03/EAB8: 4C C5 EA     JMP $EAC5
03/EABB: 68           PLA 
03/EABC: 8D D2 26     STA $26D2
03/EABF: EE 5D 35     INC $355D
03/EAC2: 20 36 CC     JSR $CC36
03/EAC5: 60           RTS 

; [ battle command $11: bluff ]

03/EAC6: A9 11        LDA #$11
03/EAC8: 8D C8 34     STA $34C8       ; set command name
03/EACB: A9 10        LDA #$10
03/EACD: 8D C7 34     STA $34C7       ; show command name
03/EAD0: A6 A6        LDX $A6
03/EAD2: 18           CLC 
03/EAD3: BD 17 20     LDA $2017,X
03/EAD6: 69 10        ADC #$10
03/EAD8: C9 63        CMP #$63
03/EADA: 90 02        BCC $EADE
03/EADC: A9 63        LDA #$63
03/EADE: 9D 17 20     STA $2017,X
03/EAE1: A9 12        LDA #$12
03/EAE3: 8D CA 34     STA $34CA
03/EAE6: 4C A6 85     JMP $85A6       ; add message to graphics script

; [ battle command $12: cry ]

; set each monster's level stat to 1 if it is less than
; half porom's level stat

03/EAE9: A9 12        LDA #$12
03/EAEB: 8D C8 34     STA $34C8       ; set command name
03/EAEE: A9 10        LDA #$10
03/EAF0: 8D C7 34     STA $34C7       ; show command name
03/EAF3: A6 A6        LDX $A6
03/EAF5: BD 2F 20     LDA $202F,X     ; porom's (level + 10) / 2
03/EAF8: 4A           LSR 
03/EAF9: 85 A9        STA $A9
03/EAFB: A2 05 00     LDX #$0005
03/EAFE: 86 AB        STX $AB
; start of monster loop
03/EB00: A6 AB        LDX $AB
03/EB02: BD 40 35     LDA $3540,X
03/EB05: D0 15        BNE $EB1C       ; branch if monster is not present
03/EB07: 8A           TXA 
03/EB08: 20 89 84     JSR $8489       ; set current character/monster
03/EB0B: A6 A6        LDX $A6
03/EB0D: 38           SEC 
03/EB0E: BD 2F 20     LDA $202F,X
03/EB11: E5 A9        SBC $A9
03/EB13: F0 02        BEQ $EB17
03/EB15: B0 02        BCS $EB19
03/EB17: A9 01        LDA #$01
03/EB19: 9D 2F 20     STA $202F,X     ; set level stat to 1
03/EB1C: E6 AB        INC $AB         ; next monsters
03/EB1E: A5 AB        LDA $AB
03/EB20: C9 0D        CMP #$0D
03/EB22: D0 DC        BNE $EB00
03/EB24: A9 13        LDA #$13        ; 
03/EB26: 8D CA 34     STA $34CA
03/EB29: 4C A6 85     JMP $85A6       ; add message to graphics script

; [ load stolen item properties ]

03/EB2C: F0 73        BEQ $EBA1       ; return if no item
03/EB2E: C9 DE        CMP #$DE
03/EB30: B0 6F        BCS $EBA1
03/EB32: C9 B0        CMP #$B0
03/EB34: B0 44        BCS $EB7A       ; branch if consumable
03/EB36: C9 6D        CMP #$6D
03/EB38: B0 67        BCS $EBA1       ; branch if armor
03/EB3A: C9 61        CMP #$61
03/EB3C: 90 04        BCC $EB42       ; branch if shield
03/EB3E: A9 00        LDA #$00
03/EB40: F0 5C        BEQ $EB9E
03/EB42: AA           TAX 
03/EB43: 86 E5        STX $E5
03/EB45: A2 00 91     LDX #$9100
03/EB48: 86 80        STX $80
03/EB4A: A9 0F        LDA #$0F
03/EB4C: 85 82        STA $82
03/EB4E: A9 08        LDA #$08
03/EB50: 20 5E 84     JSR $845E       ; load array item
03/EB53: 48           PHA 
03/EB54: AD 9C 28     LDA $289C
03/EB57: 20 85 84     JSR $8485       ; lsr3
03/EB5A: 29 08        AND #$08
03/EB5C: 85 C7        STA $C7
03/EB5E: 68           PLA 
03/EB5F: AA           TAX 
03/EB60: 86 E5        STX $E5
03/EB62: A2 A0 97     LDX #$97A0      ; 0F/97A0 (attack properties)
03/EB65: 86 80        STX $80
03/EB67: A9 0F        LDA #$0F
03/EB69: 85 82        STA $82
03/EB6B: A9 06        LDA #$06
03/EB6D: 20 5E 84     JSR $845E       ; load array item
03/EB70: A6 AB        LDX $AB
03/EB72: AD 9F 28     LDA $289F
03/EB75: 9D 1D 32     STA $321D,X     ; set spell id
03/EB78: 80 1C        BRA $EB96
; consumable
03/EB7A: 38           SEC 
03/EB7B: E9 B0        SBC #$B0
03/EB7D: AA           TAX 
03/EB7E: 86 E5        STX $E5
03/EB80: A2 80 96     LDX #$9680      ; 0F/9680 (item properties)
03/EB83: 86 80        STX $80
03/EB85: A9 0F        LDA #$0F
03/EB87: 85 82        STA $82
03/EB89: A9 06        LDA #$06
03/EB8B: 20 5E 84     JSR $845E       ; load array item
03/EB8E: A6 AB        LDX $AB
03/EB90: AD 9F 28     LDA $289F
03/EB93: 9D 1D 32     STA $321D,X     ; set spell id
03/EB96: AD 9C 28     LDA $289C
03/EB99: 29 E0        AND #$E0
03/EB9B: 05 C7        ORA $C7
03/EB9D: 4A           LSR 
03/EB9E: 9D 1A 32     STA $321A,X     ; set flags
03/EBA1: 60           RTS 

; [ battle command $01: item ]

03/EBA2: AD 83 26     LDA $2683
03/EBA5: 29 C0        AND #$C0
03/EBA7: D0 68        BNE $EC11
03/EBA9: AD 84 26     LDA $2684
03/EBAC: 29 3C        AND #$3C
03/EBAE: D0 61        BNE $EC11
03/EBB0: AD 85 26     LDA $2685
03/EBB3: 29 C6        AND #$C6
03/EBB5: D0 5A        BNE $EC11
03/EBB7: AD D2 26     LDA $26D2
03/EBBA: 48           PHA 
03/EBBB: AD D2 26     LDA $26D2
03/EBBE: C9 CA        CMP #$CA        ; summon book (call)
03/EBC0: D0 05        BNE $EBC7
03/EBC2: 20 12 EC     JSR $EC12       ; choose a random summon
03/EBC5: 80 33        BRA $EBFA
03/EBC7: C9 B0        CMP #$B0
03/EBC9: 90 07        BCC $EBD2
03/EBCB: AD D0 26     LDA $26D0
03/EBCE: 29 10        AND #$10
03/EBD0: F0 25        BEQ $EBF7
03/EBD2: AE D5 26     LDX $26D5
03/EBD5: 86 80        STX $80
03/EBD7: AD D2 26     LDA $26D2
03/EBDA: C9 61        CMP #$61
03/EBDC: 90 04        BCC $EBE2
03/EBDE: A9 00        LDA #$00
03/EBE0: 80 10        BRA $EBF2
03/EBE2: AA           TAX 
03/EBE3: BF 70 90 0F  LDA $0F9070,X   ; weapon magic no. of hits
03/EBE7: 8D EC 38     STA $38EC
03/EBEA: EE EB 38     INC $38EB       ; set weapon magic flag
03/EBED: A0 03 00     LDY #$0003
03/EBF0: B1 80        LDA ($80),Y
03/EBF2: 8D D2 26     STA $26D2
03/EBF5: 80 03        BRA $EBFA
03/EBF7: EE 2A 35     INC $352A
03/EBFA: 20 2E CD     JSR $CD2E       ; do magic attack
03/EBFD: AD ED 38     LDA $38ED
03/EC00: F0 03        BEQ $EC05
03/EC02: 68           PLA 
03/EC03: 80 04        BRA $EC09
03/EC05: 68           PLA 
03/EC06: 8D C5 33     STA $33C5
03/EC09: 8D C8 34     STA $34C8
03/EC0C: A9 20        LDA #$20
03/EC0E: 8D C7 34     STA $34C7       ; show item name
03/EC11: 60           RTS 

; [ choose a random summon ]

03/EC12: A9 E5        LDA #$E5
03/EC14: 8D C4 33     STA $33C4
03/EC17: EE ED 38     INC $38ED
03/EC1A: EE 84 35     INC $3584
03/EC1D: 7B           TDC 
03/EC1E: AA           TAX 
03/EC1F: A9 09        LDA #$09
03/EC21: 20 79 83     JSR $8379       ; random (X..A)
03/EC24: AA           TAX 
03/EC25: BF EC FE 13  LDA $13FEEC,X   ; summon book attacks
03/EC29: 48           PHA 
03/EC2A: 29 7F        AND #$7F
03/EC2C: 8D D2 26     STA $26D2
03/EC2F: 8D C5 33     STA $33C5
03/EC32: 68           PLA 
03/EC33: 10 33        BPL $EC68       ; branch if target all
03/EC35: A2 05 00     LDX #$0005
03/EC38: A9 0C        LDA #$0C
03/EC3A: 20 79 83     JSR $8379       ; random (X..A)
03/EC3D: A8           TAY 
03/EC3E: 84 A9        STY $A9
03/EC40: B9 40 35     LDA $3540,Y
03/EC43: D0 F0        BNE $EC35
03/EC45: 98           TYA 
03/EC46: 85 DF        STA $DF
03/EC48: A9 80        LDA #$80
03/EC4A: 85 E1        STA $E1
03/EC4C: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/EC4F: A6 E3        LDX $E3
03/EC51: BD 03 20     LDA $2003,X
03/EC54: 29 C0        AND #$C0
03/EC56: D0 DD        BNE $EC35
03/EC58: 38           SEC 
03/EC59: A5 A9        LDA $A9
03/EC5B: E9 05        SBC #$05
03/EC5D: AA           TAX 
03/EC5E: 09 80        ORA #$80
03/EC60: 85 CE        STA $CE
03/EC62: 7B           TDC 
03/EC63: 20 5F 85     JSR $855F       ; set bit
03/EC66: 80 06        BRA $EC6E
03/EC68: A9 80        LDA #$80
03/EC6A: 85 CE        STA $CE
03/EC6C: A9 FF        LDA #$FF
03/EC6E: 8D D3 26     STA $26D3
03/EC71: 60           RTS 

; --------------------------------------------------------------------------

; [ update party after victory ]

03/EC72: 7B           TDC 
03/EC73: AA           TAX 
03/EC74: 8E 91 35     STX $3591
03/EC77: 8E 93 35     STX $3593
03/EC7A: 8E 94 35     STX $3594
03/EC7D: 8E 95 35     STX $3595
03/EC80: 86 B5        STX $B5
03/EC82: 86 B7        STX $B7
03/EC84: A6 B7        LDX $B7
03/EC86: BD 85 35     LDA $3585,X
03/EC89: 85 B1        STA $B1
03/EC8B: D0 03        BNE $EC90
03/EC8D: 4C 68 ED     JMP $ED68
03/EC90: A6 B7        LDX $B7
03/EC92: BD 8B 35     LDA $358B,X
03/EC95: 85 AF        STA $AF
03/EC97: 64 B0        STZ $B0
03/EC99: 06 AF        ASL $AF
03/EC9B: 26 B0        ROL $B0
03/EC9D: A6 AF        LDX $AF
03/EC9F: 18           CLC 
03/ECA0: BF C0 A1 0E  LDA $0EA1C0,X
03/ECA4: 6D 91 35     ADC $3591
03/ECA7: 8D 91 35     STA $3591
03/ECAA: BF C1 A1 0E  LDA $0EA1C1,X
03/ECAE: 6D 92 35     ADC $3592
03/ECB1: 8D 92 35     STA $3592
03/ECB4: AD 93 35     LDA $3593
03/ECB7: 69 00        ADC #$00
03/ECB9: 8D 93 35     STA $3593
03/ECBC: A6 B7        LDX $B7
03/ECBE: BD 88 35     LDA $3588,X
03/ECC1: 85 AF        STA $AF
03/ECC3: 64 B0        STZ $B0
03/ECC5: 06 AF        ASL $AF
03/ECC7: 26 B0        ROL $B0
03/ECC9: A6 AF        LDX $AF
03/ECCB: 18           CLC 
03/ECCC: BF 00 A0 0E  LDA $0EA000,X
03/ECD0: 6D 94 35     ADC $3594
03/ECD3: 8D 94 35     STA $3594
03/ECD6: BF 01 A0 0E  LDA $0EA001,X
03/ECDA: 6D 95 35     ADC $3595
03/ECDD: 8D 95 35     STA $3595
03/ECE0: AD 96 35     LDA $3596
03/ECE3: 69 00        ADC #$00
03/ECE5: 8D 96 35     STA $3596
03/ECE8: A6 B7        LDX $B7
03/ECEA: BD 8E 35     LDA $358E,X
03/ECED: 85 B3        STA $B3
03/ECEF: BD 8E 35     LDA $358E,X
03/ECF2: 29 C0        AND #$C0
03/ECF4: C9 C0        CMP #$C0
03/ECF6: F0 17        BEQ $ED0F
03/ECF8: C9 40        CMP #$40
03/ECFA: D0 04        BNE $ED00
03/ECFC: A9 05        LDA #$05
03/ECFE: 80 06        BRA $ED06
03/ED00: C9 80        CMP #$80
03/ED02: D0 5B        BNE $ED5F
03/ED04: A9 19        LDA #$19
03/ED06: 85 B4        STA $B4
03/ED08: 20 8B 85     JSR $858B       ; random (0..98)
03/ED0B: C5 B4        CMP $B4
03/ED0D: B0 50        BCS $ED5F
03/ED0F: 06 B3        ASL $B3
03/ED11: 06 B3        ASL $B3
03/ED13: A5 B3        LDA $B3
03/ED15: AA           TAX 
03/ED16: 7B           TDC 
03/ED17: A8           TAY 
03/ED18: 84 A9        STY $A9
03/ED1A: BF 00 9F 0E  LDA $0E9F00,X
03/ED1E: 99 9C 28     STA $289C,Y
03/ED21: E8           INX 
03/ED22: C8           INY 
03/ED23: E6 A9        INC $A9
03/ED25: A5 A9        LDA $A9
03/ED27: C9 04        CMP #$04
03/ED29: D0 EF        BNE $ED1A
03/ED2B: AD A3 16     LDA $16A3
03/ED2E: 65 97        ADC $97
03/ED30: 85 97        STA $97
03/ED32: 20 93 85     JSR $8593       ; random (0..255)
03/ED35: C9 80        CMP #$80
03/ED37: B0 04        BCS $ED3D
03/ED39: A9 00        LDA #$00
03/ED3B: 80 12        BRA $ED4F
03/ED3D: C9 D0        CMP #$D0
03/ED3F: B0 04        BCS $ED45
03/ED41: A9 01        LDA #$01
03/ED43: 80 0A        BRA $ED4F
03/ED45: C9 FC        CMP #$FC
03/ED47: B0 04        BCS $ED4D
03/ED49: A9 02        LDA #$02
03/ED4B: 80 02        BRA $ED4F
03/ED4D: A9 03        LDA #$03
03/ED4F: AA           TAX 
03/ED50: BD 9C 28     LDA $289C,X
03/ED53: A6 B5        LDX $B5
03/ED55: E0 08 00     CPX #$0008
03/ED58: F0 05        BEQ $ED5F
03/ED5A: 9D 04 18     STA $1804,X
03/ED5D: E6 B5        INC $B5
03/ED5F: C6 B1        DEC $B1
03/ED61: A5 B1        LDA $B1
03/ED63: F0 03        BEQ $ED68
03/ED65: 4C 90 EC     JMP $EC90
03/ED68: E6 B7        INC $B7
03/ED6A: A5 B7        LDA $B7
03/ED6C: C9 03        CMP #$03
03/ED6E: F0 03        BEQ $ED73
03/ED70: 4C 84 EC     JMP $EC84
03/ED73: 18           CLC 
03/ED74: AD A0 16     LDA $16A0
03/ED77: 6D 94 35     ADC $3594
03/ED7A: 8D A0 16     STA $16A0
03/ED7D: AD A1 16     LDA $16A1
03/ED80: 6D 95 35     ADC $3595
03/ED83: 8D A1 16     STA $16A1
03/ED86: AD A2 16     LDA $16A2
03/ED89: 6D 96 35     ADC $3596
03/ED8C: 8D A2 16     STA $16A2
03/ED8F: 38           SEC 
03/ED90: AD A0 16     LDA $16A0
03/ED93: E9 7F        SBC #$7F
03/ED95: AD A1 16     LDA $16A1
03/ED98: E9 96        SBC #$96
03/ED9A: AD A2 16     LDA $16A2
03/ED9D: E9 98        SBC #$98
03/ED9F: 90 0F        BCC $EDB0
03/EDA1: A9 7F        LDA #$7F
03/EDA3: 8D A0 16     STA $16A0
03/EDA6: A9 96        LDA #$96
03/EDA8: 8D A1 16     STA $16A1
03/EDAB: A9 98        LDA #$98
03/EDAD: 8D A2 16     STA $16A2
03/EDB0: 7B           TDC 
03/EDB1: AA           TAX 
03/EDB2: 86 A9        STX $A9
03/EDB4: 86 AB        STX $AB
03/EDB6: 86 AD        STX $AD
03/EDB8: 8E 5F 40     STX $405F
03/EDBB: 8E 61 40     STX $4061
03/EDBE: 8E 63 40     STX $4063
03/EDC1: 8E 65 40     STX $4065
03/EDC4: 8E 67 40     STX $4067
03/EDC7: A6 A9        LDX $A9
03/EDC9: E0 05 00     CPX #$0005
03/EDCC: B0 05        BCS $EDD3
03/EDCE: BD 40 35     LDA $3540,X
03/EDD1: D0 1C        BNE $EDEF
03/EDD3: A6 AD        LDX $AD
03/EDD5: BD 00 10     LDA $1000,X
03/EDD8: 29 1F        AND #$1F
03/EDDA: F0 13        BEQ $EDEF
03/EDDC: BD 03 10     LDA $1003,X
03/EDDF: 29 C0        AND #$C0
03/EDE1: D0 0C        BNE $EDEF
03/EDE3: A6 A9        LDX $A9
03/EDE5: FE 5F 40     INC $405F,X
03/EDE8: E0 05 00     CPX #$0005
03/EDEB: B0 02        BCS $EDEF
03/EDED: E6 AB        INC $AB
03/EDEF: C2 20        REP #$20
03/EDF1: 18           CLC 
03/EDF2: A5 AD        LDA $AD
03/EDF4: 69 40 00     ADC #$0040
03/EDF7: 85 AD        STA $AD
03/EDF9: 7B           TDC 
03/EDFA: E2 20        SEP #$20
03/EDFC: E6 A9        INC $A9
03/EDFE: A5 A9        LDA $A9
03/EE00: C9 0A        CMP #$0A
03/EE02: D0 C3        BNE $EDC7
03/EE04: AD 91 35     LDA $3591
03/EE07: 0D 92 35     ORA $3592
03/EE0A: 0D 93 35     ORA $3593
03/EE0D: F0 31        BEQ $EE40
03/EE0F: 7B           TDC 
03/EE10: AA           TAX 
03/EE11: 86 AD        STX $AD
03/EE13: 86 AF        STX $AF
03/EE15: AD 91 35     LDA $3591
03/EE18: 0D 92 35     ORA $3592
03/EE1B: 0D 93 35     ORA $3593
03/EE1E: D0 08        BNE $EE28
03/EE20: 64 AD        STZ $AD
03/EE22: 64 AE        STZ $AE
03/EE24: 64 AF        STZ $AF
03/EE26: 80 04        BRA $EE2C
03/EE28: 22 5F FF 13  JSL $13FF5F
03/EE2C: A5 AD        LDA $AD
03/EE2E: 05 AE        ORA $AE
03/EE30: 05 AF        ORA $AF
03/EE32: D0 02        BNE $EE36
03/EE34: E6 AD        INC $AD
03/EE36: A6 AD        LDX $AD
03/EE38: 8E 91 35     STX $3591
03/EE3B: A5 AF        LDA $AF
03/EE3D: 8D 93 35     STA $3593
03/EE40: 20 FD B2     JSR $B2FD       ; init graphics script
03/EE43: 20 9B 85     JSR $859B       ; add message to graphics script
03/EE46: AD 94 35     LDA $3594
03/EE49: 8D 9A 35     STA $359A
03/EE4C: AD 95 35     LDA $3595
03/EE4F: 8D 9B 35     STA $359B
03/EE52: AD 96 35     LDA $3596
03/EE55: 8D 9C 35     STA $359C
03/EE58: AD 91 35     LDA $3591
03/EE5B: 8D 9D 35     STA $359D
03/EE5E: AD 92 35     LDA $3592
03/EE61: 8D 9E 35     STA $359E
03/EE64: AD 93 35     LDA $3593
03/EE67: 8D 9F 35     STA $359F
03/EE6A: 7B           TDC 
03/EE6B: AA           TAX 
03/EE6C: AD 94 35     LDA $3594
03/EE6F: 0D 95 35     ORA $3595
03/EE72: F0 06        BEQ $EE7A
03/EE74: A9 1F        LDA #$1F
03/EE76: 8D CA 34     STA $34CA
03/EE79: E8           INX 
03/EE7A: AD 91 35     LDA $3591
03/EE7D: 0D 92 35     ORA $3592
03/EE80: F0 06        BEQ $EE88
03/EE82: A9 20        LDA #$20
03/EE84: 9D CA 34     STA $34CA,X
03/EE87: E8           INX 
03/EE88: 8A           TXA 
03/EE89: F0 05        BEQ $EE90
03/EE8B: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/EE8D: 20 85 80     JSR $8085       ; execute battle graphics
03/EE90: A9 FF        LDA #$FF
03/EE92: 8D CB 34     STA $34CB
03/EE95: 7B           TDC 
03/EE96: AA           TAX 
03/EE97: 86 A9        STX $A9
03/EE99: 86 AB        STX $AB
03/EE9B: A6 A9        LDX $A9
03/EE9D: BD 5F 40     LDA $405F,X
03/EEA0: F0 3F        BEQ $EEE1
03/EEA2: A6 AB        LDX $AB
03/EEA4: 18           CLC 
03/EEA5: BD 37 10     LDA $1037,X
03/EEA8: 6D 91 35     ADC $3591
03/EEAB: 9D 37 10     STA $1037,X
03/EEAE: BD 38 10     LDA $1038,X
03/EEB1: 6D 92 35     ADC $3592
03/EEB4: 9D 38 10     STA $1038,X
03/EEB7: BD 39 10     LDA $1039,X
03/EEBA: 6D 93 35     ADC $3593
03/EEBD: 9D 39 10     STA $1039,X
03/EEC0: 38           SEC 
03/EEC1: BD 37 10     LDA $1037,X
03/EEC4: E9 7F        SBC #$7F
03/EEC6: BD 38 10     LDA $1038,X
03/EEC9: E9 96        SBC #$96
03/EECB: BD 39 10     LDA $1039,X
03/EECE: E9 98        SBC #$98
03/EED0: 90 0F        BCC $EEE1
03/EED2: A9 7F        LDA #$7F
03/EED4: 9D 37 10     STA $1037,X
03/EED7: A9 96        LDA #$96
03/EED9: 9D 38 10     STA $1038,X
03/EEDC: A9 98        LDA #$98
03/EEDE: 9D 39 10     STA $1039,X
03/EEE1: C2 20        REP #$20
03/EEE3: 18           CLC 
03/EEE4: A5 AB        LDA $AB
03/EEE6: 69 40 00     ADC #$0040
03/EEE9: 85 AB        STA $AB
03/EEEB: 7B           TDC 
03/EEEC: E2 20        SEP #$20
03/EEEE: E6 A9        INC $A9
03/EEF0: A5 A9        LDA $A9
03/EEF2: C9 0A        CMP #$0A
03/EEF4: D0 A5        BNE $EE9B
03/EEF6: 7B           TDC 
03/EEF7: AA           TAX 
03/EEF8: 86 98        STX $98
03/EEFA: 86 A6        STX $A6
03/EEFC: A6 98        LDX $98
03/EEFE: BD 5F 40     LDA $405F,X
03/EF01: D0 03        BNE $EF06
03/EF03: 4C F6 EF     JMP $EFF6
03/EF06: A6 A6        LDX $A6
03/EF08: BD 00 10     LDA $1000,X
03/EF0B: 29 1F        AND #$1F
03/EF0D: 3A           DEC 
03/EF0E: 0A           ASL 
03/EF0F: AA           TAX 
03/EF10: BF 00 B5 0F  LDA $0FB500,X
03/EF14: 85 80        STA $80
03/EF16: BF 01 B5 0F  LDA $0FB501,X
03/EF1A: 85 81        STA $81
03/EF1C: A9 0F        LDA #$0F
03/EF1E: 85 82        STA $82
03/EF20: A6 A6        LDX $A6
03/EF22: BD 02 10     LDA $1002,X
03/EF25: C9 46        CMP #$46
03/EF27: 90 02        BCC $EF2B
03/EF29: A9 45        LDA #$45
03/EF2B: 3A           DEC 
03/EF2C: 85 DF        STA $DF
03/EF2E: A9 05        LDA #$05
03/EF30: 85 E1        STA $E1
03/EF32: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/EF35: A4 E3        LDY $E3
03/EF37: 7B           TDC 
03/EF38: AA           TAX 
03/EF39: B7 80        LDA [$80],Y
03/EF3B: 9D 9C 28     STA $289C,X
03/EF3E: C8           INY 
03/EF3F: E8           INX 
03/EF40: E0 05 00     CPX #$0005
03/EF43: D0 F4        BNE $EF39
03/EF45: A6 A6        LDX $A6
03/EF47: BD 02 10     LDA $1002,X
03/EF4A: C9 46        CMP #$46
03/EF4C: 90 1C        BCC $EF6A
03/EF4E: 5A           PHY 
03/EF4F: A2 00 00     LDX #$0000
03/EF52: A9 07        LDA #$07
03/EF54: 20 79 83     JSR $8379       ; random (X..A)
03/EF57: AA           TAX 
03/EF58: 86 AD        STX $AD
03/EF5A: 7A           PLY 
03/EF5B: C2 20        REP #$20
03/EF5D: 98           TYA 
03/EF5E: 18           CLC 
03/EF5F: 65 AD        ADC $AD
03/EF61: A8           TAY 
03/EF62: 7B           TDC 
03/EF63: E2 20        SEP #$20
03/EF65: B7 80        LDA [$80],Y
03/EF67: 8D 9C 28     STA $289C
03/EF6A: AD 9F 28     LDA $289F
03/EF6D: 85 AD        STA $AD
03/EF6F: AD A0 28     LDA $28A0
03/EF72: 85 AE        STA $AE
03/EF74: AD 9E 28     LDA $289E
03/EF77: 20 83 84     JSR $8483       ; lsr5
03/EF7A: 85 AF        STA $AF
03/EF7C: A6 A6        LDX $A6
03/EF7E: 18           CLC 
03/EF7F: BD 3D 10     LDA $103D,X
03/EF82: 65 AD        ADC $AD
03/EF84: 85 AD        STA $AD
03/EF86: BD 3E 10     LDA $103E,X
03/EF89: 65 AE        ADC $AE
03/EF8B: 85 AE        STA $AE
03/EF8D: BD 3F 10     LDA $103F,X
03/EF90: 65 AF        ADC $AF
03/EF92: 85 AF        STA $AF
03/EF94: 38           SEC 
03/EF95: BD 37 10     LDA $1037,X
03/EF98: E5 AD        SBC $AD
03/EF9A: BD 38 10     LDA $1038,X
03/EF9D: E5 AE        SBC $AE
03/EF9F: BD 39 10     LDA $1039,X
03/EFA2: E5 AF        SBC $AF
03/EFA4: 90 50        BCC $EFF6
03/EFA6: A5 AD        LDA $AD
03/EFA8: 9D 3D 10     STA $103D,X
03/EFAB: A5 AE        LDA $AE
03/EFAD: 9D 3E 10     STA $103E,X
03/EFB0: A5 AF        LDA $AF
03/EFB2: 9D 3F 10     STA $103F,X
03/EFB5: BD 02 10     LDA $1002,X
03/EFB8: C9 63        CMP #$63
03/EFBA: B0 3A        BCS $EFF6
03/EFBC: FE 02 10     INC $1002,X
03/EFBF: 20 2E F0     JSR $F02E       ; update character at level up
03/EFC2: A5 98        LDA $98
03/EFC4: C9 05        CMP #$05
03/EFC6: B0 2B        BCS $EFF3
03/EFC8: 8D 9A 35     STA $359A
03/EFCB: A9 21        LDA #$21
03/EFCD: 8D CA 34     STA $34CA
03/EFD0: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/EFD2: 20 85 80     JSR $8085       ; execute battle graphics
03/EFD5: A9 23        LDA #$23
03/EFD7: 8D CA 34     STA $34CA
03/EFDA: 7B           TDC 
03/EFDB: AA           TAX 
03/EFDC: 86 AF        STX $AF
03/EFDE: A6 AF        LDX $AF
03/EFE0: BD 1C 29     LDA $291C,X
03/EFE3: C9 FF        CMP #$FF
03/EFE5: F0 0C        BEQ $EFF3
03/EFE7: 8D 9A 35     STA $359A
03/EFEA: A9 05        LDA #$05        ; battle graphics $05: graphics script
03/EFEC: 20 85 80     JSR $8085       ; execute battle graphics
03/EFEF: E6 AF        INC $AF
03/EFF1: 80 EB        BRA $EFDE
03/EFF3: 4C 06 EF     JMP $EF06
03/EFF6: C2 20        REP #$20
03/EFF8: 18           CLC 
03/EFF9: A5 A6        LDA $A6
03/EFFB: 69 40 00     ADC #$0040
03/EFFE: 85 A6        STA $A6
03/F000: 7B           TDC 
03/F001: E2 20        SEP #$20
03/F003: E6 98        INC $98
03/F005: A5 98        LDA $98
03/F007: C9 0A        CMP #$0A
03/F009: F0 03        BEQ $F00E
03/F00B: 4C FC EE     JMP $EEFC
03/F00E: 20 A8 94     JSR $94A8       ; load character properties
03/F011: 20 CC 8E     JSR $8ECC       ; load equipment properties
03/F014: 9C 75 39     STZ $3975
03/F017: AD 75 39     LDA $3975
03/F01A: AA           TAX 
03/F01B: BD 40 35     LDA $3540,X
03/F01E: D0 03        BNE $F023
03/F020: 20 37 98     JSR $9837       ; update character stats
03/F023: EE 75 39     INC $3975
03/F026: AD 75 39     LDA $3975
03/F029: C9 05        CMP #$05
03/F02B: D0 EA        BNE $F017
03/F02D: 60           RTS 

; [ update character at level up ]

03/F02E: AD 9C 28     LDA $289C
03/F031: 29 07        AND #$07
03/F033: 85 AF        STA $AF
03/F035: C2 20        REP #$20
03/F037: A5 A6        LDA $A6
03/F039: 69 0F 00     ADC #$000F
03/F03C: AA           TAX 
03/F03D: 7B           TDC 
03/F03E: E2 20        SEP #$20
03/F040: A0 05 00     LDY #$0005
03/F043: 0E 9C 28     ASL $289C
03/F046: 90 23        BCC $F06B
03/F048: A5 AF        LDA $AF
03/F04A: C9 07        CMP #$07
03/F04C: D0 0E        BNE $F05C
03/F04E: 38           SEC 
03/F04F: BD 00 10     LDA $1000,X
03/F052: E9 01        SBC #$01
03/F054: C9 01        CMP #$01
03/F056: B0 10        BCS $F068
03/F058: A9 01        LDA #$01
03/F05A: 80 0C        BRA $F068
03/F05C: 18           CLC 
03/F05D: BD 00 10     LDA $1000,X
03/F060: 65 AF        ADC $AF
03/F062: C9 63        CMP #$63
03/F064: 90 02        BCC $F068
03/F066: A9 63        LDA #$63
03/F068: 9D 00 10     STA $1000,X
03/F06B: E8           INX 
03/F06C: 88           DEY 
03/F06D: D0 D4        BNE $F043
03/F06F: AD 9D 28     LDA $289D
03/F072: 85 B1        STA $B1
03/F074: A2 0F 27     LDX #$270F
03/F077: 86 B3        STX $B3
03/F079: A9 09        LDA #$09
03/F07B: 20 CD F0     JSR $F0CD       ; increase hp/mp at level up
03/F07E: AD 9E 28     LDA $289E
03/F081: 29 1F        AND #$1F
03/F083: 85 B1        STA $B1
03/F085: A2 E7 03     LDX #$03E7
03/F088: 86 B3        STX $B3
03/F08A: A9 0D        LDA #$0D
03/F08C: 20 CD F0     JSR $F0CD       ; increase hp/mp at level up
03/F08F: A2 7F 00     LDX #$007F
03/F092: A9 FF        LDA #$FF
03/F094: 9D 1C 29     STA $291C,X
03/F097: CA           DEX 
03/F098: 10 FA        BPL $F094
03/F09A: A6 A6        LDX $A6
03/F09C: BD 02 10     LDA $1002,X
03/F09F: 85 B5        STA $B5
03/F0A1: BD 01 10     LDA $1001,X
03/F0A4: 29 0F        AND #$0F
03/F0A6: 85 AF        STA $AF
03/F0A8: 0A           ASL 
03/F0A9: 18           CLC 
03/F0AA: 65 AF        ADC $AF
03/F0AC: AA           TAX 
03/F0AD: 86 B1        STX $B1
03/F0AF: 64 B3        STZ $B3
03/F0B1: 64 9A        STZ $9A
03/F0B3: 64 9B        STZ $9B
03/F0B5: A6 B1        LDX $B1
03/F0B7: BF DD FD 13  LDA $13FDDD,X   ; spell lists for each character
03/F0BB: C9 FF        CMP #$FF
03/F0BD: F0 03        BEQ $F0C2
03/F0BF: 20 08 F1     JSR $F108       ; update spell list at level up
03/F0C2: E6 B1        INC $B1
03/F0C4: E6 B3        INC $B3
03/F0C6: A5 B3        LDA $B3
03/F0C8: C9 03        CMP #$03
03/F0CA: D0 E9        BNE $F0B5
03/F0CC: 60           RTS 

; [ increase hp/mp at level up ]

03/F0CD: 85 B5        STA $B5
03/F0CF: 64 B6        STZ $B6
03/F0D1: C2 20        REP #$20
03/F0D3: 18           CLC 
03/F0D4: A5 A6        LDA $A6
03/F0D6: 65 B5        ADC $B5
03/F0D8: 85 B5        STA $B5
03/F0DA: 7B           TDC 
03/F0DB: E2 20        SEP #$20
03/F0DD: 7B           TDC 
03/F0DE: AA           TAX 
03/F0DF: A5 B1        LDA $B1
03/F0E1: 20 85 84     JSR $8485       ; lsr3
03/F0E4: 20 79 83     JSR $8379       ; random (X..A)
03/F0E7: 18           CLC 
03/F0E8: 65 B1        ADC $B1
03/F0EA: 85 AF        STA $AF
03/F0EC: A9 00        LDA #$00
03/F0EE: 69 00        ADC #$00
03/F0F0: 85 B0        STA $B0
03/F0F2: C2 20        REP #$20
03/F0F4: A6 B5        LDX $B5
03/F0F6: BD 00 10     LDA $1000,X
03/F0F9: 65 AF        ADC $AF
03/F0FB: C5 B3        CMP $B3
03/F0FD: 90 02        BCC $F101
03/F0FF: A5 B3        LDA $B3
03/F101: 9D 00 10     STA $1000,X
03/F104: 7B           TDC 
03/F105: E2 20        SEP #$20
03/F107: 60           RTS 

; [ update spell list at level up ]

03/F108: 48           PHA 
03/F109: 85 E5        STA $E5
03/F10B: A0 00 C7     LDY #$C700
03/F10E: A9 0F        LDA #$0F
03/F110: 20 43 84     JSR $8443       ; get script length
03/F113: BB           TYX 
03/F114: 7B           TDC 
03/F115: A8           TAY 
03/F116: BF 00 C7 0F  LDA $0FC700,X
03/F11A: 99 9C 28     STA $289C,Y
03/F11D: E8           INX 
03/F11E: C8           INY 
03/F11F: C9 FF        CMP #$FF
03/F121: D0 F3        BNE $F116
03/F123: 7B           TDC 
03/F124: AA           TAX 
03/F125: BD 9C 28     LDA $289C,X
03/F128: C9 FF        CMP #$FF
03/F12A: F0 12        BEQ $F13E
03/F12C: C5 B5        CMP $B5
03/F12E: D0 0A        BNE $F13A
03/F130: A4 9A        LDY $9A
03/F132: BD 9D 28     LDA $289D,X
03/F135: 99 1C 29     STA $291C,Y
03/F138: E6 9A        INC $9A
03/F13A: E8           INX 
03/F13B: E8           INX 
03/F13C: 80 E7        BRA $F125
03/F13E: 68           PLA 
03/F13F: 85 DF        STA $DF
03/F141: A9 18        LDA #$18
03/F143: 85 E1        STA $E1
03/F145: 20 E0 83     JSR $83E0       ; multiply (8-bit)
03/F148: A6 E3        LDX $E3
03/F14A: 7B           TDC 
03/F14B: A8           TAY 
03/F14C: 84 B7        STY $B7
03/F14E: BD 60 15     LDA $1560,X
03/F151: D0 2E        BNE $F181
03/F153: B9 1C 29     LDA $291C,Y
03/F156: 85 B9        STA $B9
03/F158: C9 FF        CMP #$FF
03/F15A: F0 2E        BEQ $F18A
03/F15C: C9 19        CMP #$19
03/F15E: B0 06        BCS $F166
03/F160: A5 B3        LDA $B3
03/F162: D0 1D        BNE $F181
03/F164: 80 15        BRA $F17B
03/F166: C9 31        CMP #$31
03/F168: B0 07        BCS $F171
03/F16A: A5 B3        LDA $B3
03/F16C: 3A           DEC 
03/F16D: D0 12        BNE $F181
03/F16F: 80 0A        BRA $F17B
03/F171: C9 42        CMP #$42
03/F173: B0 F5        BCS $F16A
03/F175: A5 B3        LDA $B3
03/F177: C9 02        CMP #$02
03/F179: D0 06        BNE $F181
03/F17B: A5 B9        LDA $B9
03/F17D: 9D 60 15     STA $1560,X
03/F180: C8           INY 
03/F181: E8           INX 
03/F182: E6 B7        INC $B7
03/F184: A5 B7        LDA $B7
03/F186: C9 18        CMP #$18
03/F188: D0 C4        BNE $F14E
03/F18A: 60           RTS 

; [ restore character properties after battle ]

03/F18B: 7B           TDC 
03/F18C: AA           TAX 
03/F18D: A8           TAY 
03/F18E: BD 41 20     LDA $2041,X     ; restore crit % and bonus
03/F191: 9D 2D 20     STA $202D,X
03/F194: BD 42 20     LDA $2042,X
03/F197: 9D 2E 20     STA $202E,X
03/F19A: B9 BF 38     LDA $38BF,Y     ; restore status
03/F19D: 9D 03 20     STA $2003,X
03/F1A0: B9 C0 38     LDA $38C0,Y
03/F1A3: 9D 04 20     STA $2004,X
03/F1A6: B9 C1 38     LDA $38C1,Y
03/F1A9: 9D 06 20     STA $2006,X
03/F1AC: 20 BC 85     JSR $85BC       ; increment character/monster pointer
03/F1AF: C8           INY 
03/F1B0: C8           INY 
03/F1B1: C8           INY 
03/F1B2: C0 0F 00     CPY #$000F
03/F1B5: D0 D7        BNE $F18E
03/F1B7: 7B           TDC 
03/F1B8: AA           TAX 
03/F1B9: A8           TAY 
03/F1BA: 64 A9        STZ $A9
03/F1BC: 64 AB        STZ $AB
03/F1BE: BD 00 20     LDA $2000,X     ; copy character properties to sram
03/F1C1: 99 00 10     STA $1000,Y
03/F1C4: E8           INX 
03/F1C5: C8           INY 
03/F1C6: E6 AB        INC $AB
03/F1C8: A5 AB        LDA $AB
03/F1CA: C9 40        CMP #$40
03/F1CC: D0 F0        BNE $F1BE
03/F1CE: C2 20        REP #$20
03/F1D0: 8A           TXA 
03/F1D1: 18           CLC 
03/F1D2: 69 40 00     ADC #$0040
03/F1D5: AA           TAX 
03/F1D6: 7B           TDC 
03/F1D7: E2 20        SEP #$20
03/F1D9: E6 A9        INC $A9
03/F1DB: A5 A9        LDA $A9
03/F1DD: C9 05        CMP #$05
03/F1DF: D0 DB        BNE $F1BC
03/F1E1: 7B           TDC 
03/F1E2: AA           TAX 
03/F1E3: A8           TAY 
03/F1E4: 86 A9        STX $A9
03/F1E6: BD 1B 32     LDA $321B,X     ; copy inventory to sram
03/F1E9: 99 40 14     STA $1440,Y
03/F1EC: F0 04        BEQ $F1F2
03/F1EE: C9 60        CMP #$60
03/F1F0: D0 06        BNE $F1F8
03/F1F2: 7B           TDC 
03/F1F3: 99 40 14     STA $1440,Y
03/F1F6: 80 03        BRA $F1FB
03/F1F8: BD 1C 32     LDA $321C,X
03/F1FB: 99 41 14     STA $1441,Y
03/F1FE: D0 04        BNE $F204
03/F200: 7B           TDC 
03/F201: 99 40 14     STA $1440,Y
03/F204: E8           INX 
03/F205: E8           INX 
03/F206: E8           INX 
03/F207: E8           INX 
03/F208: C8           INY 
03/F209: C8           INY 
03/F20A: E6 A9        INC $A9
03/F20C: A5 A9        LDA $A9
03/F20E: C9 30        CMP #$30
03/F210: D0 D4        BNE $F1E6
03/F212: 4C CE 95     JMP $95CE

03/F215:                FF FF FF FF FF FF FF FF FF FF FF
03/F220: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
03/F230: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
03/F240: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
03/F250: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
03/F260: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
03/F270: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

; powers of 10
03/F280: 00989680  ; 10000000
03/F284: 000F4240  ; 1000000
03/F288: 000186A0  ; 100000
03/F28C: 00002710  ; 10000
03/F290: 000003E8  ; 1000
03/F294: 00000064  ; 100
03/F298: 0000000A  ; 10

; [  ]

03/F29C: 7B           TDC 
03/F29D: AA           TAX 
03/F29E: 9E AD F4     STZ $F4AD,X
03/F2A1: E8           INX 
03/F2A2: E0 08 00     CPX #$0008
03/F2A5: D0 F7        BNE $F29E
03/F2A7: A2 00 00     LDX #$0000
03/F2AA: DA           PHX 
03/F2AB: 8A           TXA 
03/F2AC: 0A           ASL 
03/F2AD: 0A           ASL 
03/F2AE: AA           TAX 
03/F2AF: BF 80 F2 03  LDA $03F280,X   ; powers of 10
03/F2B3: 85 04        STA $04
03/F2B5: BF 81 F2 03  LDA $03F281,X
03/F2B9: 85 05        STA $05
03/F2BB: BF 82 F2 03  LDA $03F282,X
03/F2BF: 85 06        STA $06
03/F2C1: 20 DC F2     JSR $F2DC
03/F2C4: FA           PLX 
03/F2C5: A5 08        LDA $08
03/F2C7: 18           CLC 
03/F2C8: 69 80        ADC #$80
03/F2CA: 9D AD F4     STA $F4AD,X
03/F2CD: E8           INX 
03/F2CE: E0 07 00     CPX #$0007
03/F2D1: D0 D7        BNE $F2AA
03/F2D3: A5 00        LDA $00
03/F2D5: 18           CLC 
03/F2D6: 69 80        ADC #$80
03/F2D8: 8D B4 F4     STA $F4B4
03/F2DB: 6B           RTL 

; [  ]

03/F2DC: 64 08        STZ $08
03/F2DE: A5 00        LDA $00
03/F2E0: 38           SEC 
03/F2E1: E5 04        SBC $04
03/F2E3: 85 00        STA $00
03/F2E5: A5 01        LDA $01
03/F2E7: E5 05        SBC $05
03/F2E9: 85 01        STA $01
03/F2EB: A5 02        LDA $02
03/F2ED: E5 06        SBC $06
03/F2EF: 85 02        STA $02
03/F2F1: E6 08        INC $08
03/F2F3: B0 E9        BCS $F2DE
03/F2F5: C6 08        DEC $08
03/F2F7: A5 00        LDA $00
03/F2F9: 18           CLC 
03/F2FA: 65 04        ADC $04
03/F2FC: 85 00        STA $00
03/F2FE: A5 01        LDA $01
03/F300: 65 05        ADC $05
03/F302: 85 01        STA $01
03/F304: A5 02        LDA $02
03/F306: 65 06        ADC $06
03/F308: 85 02        STA $02
03/F30A: 60           RTS 

; [  ]

03/F30B: DA           PHX 
03/F30C: AD 94 28     LDA $2894
03/F30F: D0 04        BNE $F315
03/F311: A9 80        LDA #$80
03/F313: 80 2B        BRA $F340
03/F315: C9 44        CMP #$44
03/F317: B0 04        BCS $F31D
03/F319: A9 01        LDA #$01
03/F31B: 80 23        BRA $F340
03/F31D: C9 4D        CMP #$4D
03/F31F: B0 04        BCS $F325
03/F321: A9 02        LDA #$02
03/F323: 80 1B        BRA $F340
03/F325: C9 54        CMP #$54
03/F327: B0 04        BCS $F32D
03/F329: A9 04        LDA #$04
03/F32B: 80 13        BRA $F340
03/F32D: C9 61        CMP #$61
03/F32F: B0 04        BCS $F335
03/F331: A9 08        LDA #$08
03/F333: 80 0B        BRA $F340
03/F335: C9 6D        CMP #$6D
03/F337: B0 04        BCS $F33D
03/F339: A9 10        LDA #$10
03/F33B: 80 03        BRA $F340
03/F33D: 4C 04 F4     JMP $F404
03/F340: 85 0F        STA $0F
03/F342: AD 95 28     LDA $2895
03/F345: D0 04        BNE $F34B
03/F347: A9 80        LDA #$80
03/F349: 80 2B        BRA $F376
03/F34B: C9 44        CMP #$44
03/F34D: B0 04        BCS $F353
03/F34F: A9 01        LDA #$01
03/F351: 80 23        BRA $F376
03/F353: C9 4D        CMP #$4D
03/F355: B0 04        BCS $F35B
03/F357: A9 02        LDA #$02
03/F359: 80 1B        BRA $F376
03/F35B: C9 54        CMP #$54
03/F35D: B0 04        BCS $F363
03/F35F: A9 04        LDA #$04
03/F361: 80 13        BRA $F376
03/F363: C9 61        CMP #$61
03/F365: B0 04        BCS $F36B
03/F367: A9 08        LDA #$08
03/F369: 80 0B        BRA $F376
03/F36B: C9 6D        CMP #$6D
03/F36D: B0 04        BCS $F373
03/F36F: A9 10        LDA #$10
03/F371: 80 03        BRA $F376
03/F373: 4C 04 F4     JMP $F404
03/F376: 85 0E        STA $0E
03/F378: AD 22 18     LDA $1822
03/F37B: C2 20        REP #$20
03/F37D: 0A           ASL 
03/F37E: 0A           ASL 
03/F37F: 0A           ASL 
03/F380: 0A           ASL 
03/F381: 0A           ASL 
03/F382: 0A           ASL 
03/F383: 0A           ASL 
03/F384: AA           TAX 
03/F385: 7B           TDC 
03/F386: E2 20        SEP #$20
03/F388: BD 00 20     LDA $2000,X
03/F38B: 85 10        STA $10
03/F38D: 29 C0        AND #$C0
03/F38F: C9 C0        CMP #$C0
03/F391: F0 2E        BEQ $F3C1
03/F393: A5 10        LDA $10
03/F395: 30 15        BMI $F3AC
03/F397: C2 20        REP #$20
03/F399: A5 0E        LDA $0E
03/F39B: C9 01 80     CMP #$8001
03/F39E: F0 6B        BEQ $F40B
03/F3A0: C9 01 10     CMP #$1001
03/F3A3: F0 66        BEQ $F40B
03/F3A5: C9 80 10     CMP #$1080
03/F3A8: F0 61        BEQ $F40B
03/F3AA: 80 28        BRA $F3D4
03/F3AC: C2 20        REP #$20
03/F3AE: A5 0E        LDA $0E
03/F3B0: C9 80 01     CMP #$0180
03/F3B3: F0 56        BEQ $F40B
03/F3B5: C9 10 01     CMP #$0110
03/F3B8: F0 51        BEQ $F40B
03/F3BA: C9 10 80     CMP #$8010
03/F3BD: F0 4C        BEQ $F40B
03/F3BF: 80 13        BRA $F3D4
03/F3C1: C2 20        REP #$20
03/F3C3: A5 0E        LDA $0E
03/F3C5: C9 01 01     CMP #$0101
03/F3C8: F0 41        BEQ $F40B
03/F3CA: C9 80 01     CMP #$0180
03/F3CD: F0 3C        BEQ $F40B
03/F3CF: C9 01 80     CMP #$8001
03/F3D2: F0 37        BEQ $F40B
03/F3D4: C9 80 80     CMP #$8080
03/F3D7: F0 32        BEQ $F40B
03/F3D9: C9 04 08     CMP #$0804
03/F3DC: F0 2D        BEQ $F40B
03/F3DE: C9 08 04     CMP #$0408
03/F3E1: F0 28        BEQ $F40B
03/F3E3: C9 80 02     CMP #$0280
03/F3E6: F0 23        BEQ $F40B
03/F3E8: C9 02 80     CMP #$8002
03/F3EB: F0 1E        BEQ $F40B
03/F3ED: C9 80 04     CMP #$0480
03/F3F0: F0 19        BEQ $F40B
03/F3F2: C9 80 08     CMP #$0880
03/F3F5: F0 14        BEQ $F40B
03/F3F7: C9 08 80     CMP #$8008
03/F3FA: F0 0F        BEQ $F40B
03/F3FC: C9 04 80     CMP #$8004
03/F3FF: F0 0A        BEQ $F40B
03/F401: 7B           TDC 
03/F402: E2 20        SEP #$20
03/F404: A9 01        LDA #$01
03/F406: 8D 93 28     STA $2893
03/F409: FA           PLX 
03/F40A: 6B           RTL 
03/F40B: 7B           TDC 
03/F40C: E2 20        SEP #$20
03/F40E: A9 01        LDA #$01
03/F410: 8D 2B 35     STA $352B
03/F413: 9C 93 28     STZ $2893
03/F416: FA           PLX 
03/F417: 6B           RTL 

; [  ]

03/F418: A9 5E        LDA #$5E
03/F41A: 22 D7 F5 02  JSL $02F5D7
03/F41E: 7B           TDC 
03/F41F: AA           TAX 
03/F420: 8E 06 F4     STX $F406
03/F423: 8E 08 F4     STX $F408
03/F426: 8E 73 F1     STX $F173
03/F429: A2 10 00     LDX #$0010
03/F42C: 20 67 F8     JSR $F867
03/F42F: 7B           TDC 
03/F430: AA           TAX 
03/F431: A8           TAY 
03/F432: 8E A2 F4     STX $F4A2
03/F435: C2 20        REP #$20
03/F437: BF 79 F4 03  LDA $03F479,X
03/F43B: 0A           ASL 
03/F43C: 29 00 01     AND #$0100
03/F43F: 99 E6 DB     STA $DBE6,Y
03/F442: E8           INX 
03/F443: C8           INY 
03/F444: C8           INY 
03/F445: C0 40 00     CPY #$0040
03/F448: D0 ED        BNE $F437
03/F44A: 7B           TDC 
03/F44B: E2 20        SEP #$20
03/F44D: 22 06 80 02  JSL $028006     ; wait one frame
03/F451: EE 73 F1     INC $F173
03/F454: AD 73 F1     LDA $F173
03/F457: 29 07        AND #$07
03/F459: AA           TAX 
03/F45A: BF DD FF 0D  LDA $0DFFDD,X
03/F45E: A8           TAY 
03/F45F: 8C 06 F4     STY $F406
03/F462: 20 9A F4     JSR $F49A
03/F465: AD 73 F1     LDA $F173
03/F468: 29 03        AND #$03
03/F46A: D0 E1        BNE $F44D
03/F46C: AE A2 F4     LDX $F4A2
03/F46F: E8           INX 
03/F470: 8E A2 F4     STX $F4A2
03/F473: E0 80 00     CPX #$0080
03/F476: D0 D5        BNE $F44D
03/F478: 6B           RTL 

03/F479: 80 00 80 00 80 00 80 00 80 00 80 00 80 00 00 80
03/F489: 00 00 80 00 00 00 80 00 00 00 00 80 00 00 00 00
03/F499: 00

; [  ]

03/F49A: DA           PHX 
03/F49B: C2 20        REP #$20
03/F49D: AD A2 F4     LDA $F4A2
03/F4A0: 85 02        STA $02
03/F4A2: A9 00 01     LDA #$0100
03/F4A5: 85 00        STA $00
03/F4A7: 7B           TDC 
03/F4A8: A8           TAY 
03/F4A9: AA           TAX 
03/F4AA: A5 00        LDA $00
03/F4AC: 99 12 76     STA $7612,Y
03/F4AF: C6 02        DEC $02
03/F4B1: 10 17        BPL $F4CA
03/F4B3: AD 06 F4     LDA $F406
03/F4B6: 85 00        STA $00
03/F4B8: E0 40 00     CPX #$0040
03/F4BB: F0 0D        BEQ $F4CA
03/F4BD: BD E6 DB     LDA $DBE6,X
03/F4C0: 85 04        STA $04
03/F4C2: A5 00        LDA $00
03/F4C4: 45 04        EOR $04
03/F4C6: 85 00        STA $00
03/F4C8: E8           INX 
03/F4C9: E8           INX 
03/F4CA: C8           INY 
03/F4CB: C8           INY 
03/F4CC: C8           INY 
03/F4CD: C8           INY 
03/F4CE: C0 30 02     CPY #$0230
03/F4D1: D0 D7        BNE $F4AA
03/F4D3: 7B           TDC 
03/F4D4: E2 20        SEP #$20
03/F4D6: FA           PLX 
03/F4D7: 60           RTS 

; [  ]

03/F4D8: 48           PHA 
03/F4D9: 29 1F        AND #$1F
03/F4DB: C9 1F        CMP #$1F
03/F4DD: D0 04        BNE $F4E3
03/F4DF: 68           PLA 
03/F4E0: 4C 1E F5     JMP $F51E
03/F4E3: AA           TAX 
03/F4E4: BF CB FC 16  LDA $16FCCB,X
03/F4E8: 99 E8 EB     STA $EBE8,Y
03/F4EB: A5 12        LDA $12
03/F4ED: 99 E6 EB     STA $EBE6,Y
03/F4F0: A5 13        LDA $13
03/F4F2: 99 E7 EB     STA $EBE7,Y
03/F4F5: 68           PLA 
03/F4F6: 0A           ASL 
03/F4F7: 29 C0        AND #$C0
03/F4F9: 09 0F        ORA #$0F
03/F4FB: 05 1A        ORA $1A
03/F4FD: 99 E9 EB     STA $EBE9,Y
03/F500: AD 61 F2     LDA $F261
03/F503: F0 15        BEQ $F51A
03/F505: B9 E9 EB     LDA $EBE9,Y
03/F508: 49 40        EOR #$40
03/F50A: 99 E9 EB     STA $EBE9,Y
03/F50D: A5 10        LDA $10
03/F50F: 3A           DEC 
03/F510: 0A           ASL 
03/F511: 0A           ASL 
03/F512: 0A           ASL 
03/F513: 0A           ASL 
03/F514: 18           CLC 
03/F515: 65 14        ADC $14
03/F517: 99 E6 EB     STA $EBE6,Y
03/F51A: C8           INY 
03/F51B: C8           INY 
03/F51C: C8           INY 
03/F51D: C8           INY 
03/F51E: A5 12        LDA $12
03/F520: 18           CLC 
03/F521: 69 10        ADC #$10
03/F523: 85 12        STA $12
03/F525: C6 10        DEC $10
03/F527: D0 16        BNE $F53F
03/F529: A5 14        LDA $14
03/F52B: 85 12        STA $12
03/F52D: A5 13        LDA $13
03/F52F: 18           CLC 
03/F530: 69 10        ADC #$10
03/F532: 85 13        STA $13
03/F534: AD 4D F2     LDA $F24D
03/F537: 85 10        STA $10
03/F539: C6 11        DEC $11
03/F53B: D0 02        BNE $F53F
03/F53D: 18           CLC 
03/F53E: 6B           RTL 
03/F53F: 38           SEC 
03/F540: 6B           RTL 

; [  ]

03/F541: 64 4E        STZ $4E
03/F543: 7B           TDC 
03/F544: AA           TAX 
03/F545: A8           TAY 
03/F546: BF 50 CB 0E  LDA $0ECB50,X
03/F54A: 99 30 EE     STA $EE30,Y
03/F54D: E8           INX 
03/F54E: C8           INY 
03/F54F: C0 20 00     CPY #$0020
03/F552: D0 F2        BNE $F546
03/F554: 6B           RTL 

; [  ]

03/F555: 7B           TDC 
03/F556: AA           TAX 
03/F557: BD B5 29     LDA $29B5,X     ; copy monster types
03/F55A: 9D 2B F1     STA $F12B,X
03/F55D: BD 23 F1     LDA $F123,X
03/F560: 9D B5 29     STA $29B5,X
03/F563: E8           INX 
03/F564: E0 08 00     CPX #$0008
03/F567: D0 EE        BNE $F557
03/F569: 6B           RTL 

; [  ]

03/F56A: 7B           TDC 
03/F56B: AA           TAX 
03/F56C: BD B5 29     LDA $29B5,X
03/F56F: 9D 23 F1     STA $F123,X
03/F572: BD 2B F1     LDA $F12B,X
03/F575: 9D B5 29     STA $29B5,X
03/F578: E8           INX 
03/F579: E0 08 00     CPX #$0008
03/F57C: D0 EE        BNE $F56C
03/F57E: 6B           RTL 

03/F57F: 0E 1B 2E 57

03/F583: A5 13        LDA $13
03/F585: 29 03        AND #$03
03/F587: AA           TAX 
03/F588: BF 7F F5 03  LDA $03F57F,X
03/F58C: 22 D7 F5 02  JSL $02F5D7
03/F590: 60           RTS 

; [  ]

03/F591: A9 42        LDA #$42
03/F593: 8D BE 38     STA $38BE
03/F596: EE BD 38     INC $38BD
03/F599: 20 83 F5     JSR $F583
03/F59C: 20 09 F6     JSR $F609
03/F59F: A2 40 00     LDX #$0040
03/F5A2: 20 67 F8     JSR $F867
03/F5A5: 20 83 F5     JSR $F583
03/F5A8: 22 B5 EE 01  JSL $01EEB5
03/F5AC: A2 20 00     LDX #$0020
03/F5AF: 20 67 F8     JSR $F867
03/F5B2: 20 09 F6     JSR $F609
03/F5B5: A2 00 00     LDX #$0000
03/F5B8: 8E 06 F4     STX $F406
03/F5BB: 8E 08 F4     STX $F408
03/F5BE: 8D 33 F1     STA $F133
03/F5C1: 22 06 80 02  JSL $028006     ; wait one frame
03/F5C5: AD 33 F1     LDA $F133
03/F5C8: 29 07        AND #$07
03/F5CA: AA           TAX 
03/F5CB: BF DD FF 0D  LDA $0DFFDD,X
03/F5CF: A8           TAY 
03/F5D0: 8C 06 F4     STY $F406
03/F5D3: AD 33 F1     LDA $F133
03/F5D6: 29 0F        AND #$0F
03/F5D8: D0 07        BNE $F5E1
03/F5DA: AC 08 F4     LDY $F408
03/F5DD: 88           DEY 
03/F5DE: 8C 08 F4     STY $F408
03/F5E1: AD 33 F1     LDA $F133
03/F5E4: C9 8C        CMP #$8C
03/F5E6: F0 08        BEQ $F5F0
03/F5E8: C9 10        CMP #$10
03/F5EA: F0 04        BEQ $F5F0
03/F5EC: C9 20        CMP #$20
03/F5EE: D0 03        BNE $F5F3
03/F5F0: 20 09 F6     JSR $F609
03/F5F3: EE 33 F1     INC $F133
03/F5F6: 22 70 ED 01  JSL $01ED70
03/F5FA: AC 08 F4     LDY $F408
03/F5FD: C0 60 FF     CPY #$FF60
03/F600: D0 BF        BNE $F5C1
03/F602: A9 20        LDA #$20
03/F604: 22 D7 F5 02  JSL $02F5D7
03/F608: 6B           RTL 

; [  ]

03/F609: 20 83 F5     JSR $F583
03/F60C: 22 C5 EE 01  JSL $01EEC5
03/F610: A9 03        LDA #$03
03/F612: 8D 87 EF     STA $EF87
03/F615: 22 06 80 02  JSL $028006     ; wait one frame
03/F619: 22 B5 EE 01  JSL $01EEB5
03/F61D: A9 03        LDA #$03
03/F61F: 8D 87 EF     STA $EF87
03/F622: 22 06 80 02  JSL $028006     ; wait one frame
03/F626: 22 B9 EE 01  JSL $01EEB9
03/F62A: A9 03        LDA #$03
03/F62C: 8D 87 EF     STA $EF87
03/F62F: 60           RTS 

; [  ]

03/F630: DA           PHX 
03/F631: 20 4E F6     JSR $F64E
03/F634: BD C5 EF     LDA $EFC5,X
03/F637: 38           SEC 
03/F638: E5 00        SBC $00
03/F63A: 9D C5 EF     STA $EFC5,X
03/F63D: FA           PLX 
03/F63E: 6B           RTL 

; [  ]

03/F63F: DA           PHX 
03/F640: 20 4E F6     JSR $F64E
03/F643: BD C5 EF     LDA $EFC5,X
03/F646: 18           CLC 
03/F647: 65 00        ADC $00
03/F649: 9D C5 EF     STA $EFC5,X
03/F64C: FA           PLX 
03/F64D: 6B           RTL 

; [  ]

03/F64E: 8A           TXA 
03/F64F: 9E C8 EF     STZ $EFC8,X
03/F652: 4A           LSR 
03/F653: 4A           LSR 
03/F654: A8           TAY 
03/F655: B9 15 F0     LDA $F015,Y
03/F658: 29 30        AND #$30
03/F65A: F0 17        BEQ $F673
03/F65C: 29 20        AND #$20
03/F65E: F0 0F        BEQ $F66F
03/F660: BD D1 EF     LDA $EFD1,X
03/F663: 29 07        AND #$07
03/F665: DA           PHX 
03/F666: AA           TAX 
03/F667: BF E5 FF 0D  LDA $0DFFE5,X
03/F66B: FA           PLX 
03/F66C: 9D C8 EF     STA $EFC8,X
03/F66F: A9 01        LDA #$01
03/F671: 80 02        BRA $F675
03/F673: A9 02        LDA #$02
03/F675: 85 00        STA $00
03/F677: 60           RTS 

03/F678: 7F 3F 1F 0F 07 03 01 00

; [  ]

03/F680: A0 00 00     LDY #$0000
03/F683: A2 00 00     LDX #$0000
03/F686: BD BD 29     LDA $29BD,X
03/F689: C9 FF        CMP #$FF
03/F68B: D0 14        BNE $F6A1
03/F68D: 99 43 F0     STA $F043,Y
03/F690: 99 44 F0     STA $F044,Y
03/F693: 99 5D F0     STA $F05D,Y
03/F696: 99 5E F0     STA $F05E,Y
03/F699: 99 29 F0     STA $F029,Y
03/F69C: 99 2A F0     STA $F02A,Y
03/F69F: 80 48        BRA $F6E9
03/F6A1: DA           PHX 
03/F6A2: 48           PHA 
03/F6A3: BD A5 29     LDA $29A5,X
03/F6A6: 29 F0        AND #$F0
03/F6A8: 4A           LSR 
03/F6A9: 18           CLC 
03/F6AA: 69 10        ADC #$10
03/F6AC: 85 02        STA $02
03/F6AE: BD A5 29     LDA $29A5,X
03/F6B1: 29 0F        AND #$0F
03/F6B3: 0A           ASL 
03/F6B4: 0A           ASL 
03/F6B5: 0A           ASL 
03/F6B6: 85 03        STA $03
03/F6B8: 68           PLA 
03/F6B9: 0A           ASL 
03/F6BA: AA           TAX 
03/F6BB: BD C3 6C     LDA $6CC3,X
03/F6BE: 0A           ASL 
03/F6BF: 0A           ASL 
03/F6C0: 18           CLC 
03/F6C1: 65 02        ADC $02
03/F6C3: 99 43 F0     STA $F043,Y
03/F6C6: 99 5D F0     STA $F05D,Y
03/F6C9: 99 29 F0     STA $F029,Y
03/F6CC: A5 03        LDA $03
03/F6CE: 99 2A F0     STA $F02A,Y
03/F6D1: BD C4 6C     LDA $6CC4,X
03/F6D4: 0A           ASL 
03/F6D5: 0A           ASL 
03/F6D6: 18           CLC 
03/F6D7: 65 03        ADC $03
03/F6D9: 99 44 F0     STA $F044,Y
03/F6DC: BD C4 6C     LDA $6CC4,X
03/F6DF: 0A           ASL 
03/F6E0: 0A           ASL 
03/F6E1: 0A           ASL 
03/F6E2: 18           CLC 
03/F6E3: 65 03        ADC $03
03/F6E5: 99 5E F0     STA $F05E,Y
03/F6E8: FA           PLX 
03/F6E9: C8           INY 
03/F6EA: C8           INY 
03/F6EB: E8           INX 
03/F6EC: E0 08 00     CPX #$0008
03/F6EF: F0 03        BEQ $F6F4
03/F6F1: 4C 86 F6     JMP $F686
03/F6F4: 6B           RTL 

; [  ]

03/F6F5: AA           TAX 
03/F6F6: DA           PHX 
03/F6F7: C2 20        REP #$20
03/F6F9: 0A           ASL 
03/F6FA: 0A           ASL 
03/F6FB: 0A           ASL 
03/F6FC: 0A           ASL 
03/F6FD: 0A           ASL 
03/F6FE: 0A           ASL 
03/F6FF: 0A           ASL 
03/F700: AA           TAX 
03/F701: 7B           TDC 
03/F702: E2 20        SEP #$20
03/F704: BD 01 20     LDA $2001,X
03/F707: 29 1F        AND #$1F
03/F709: C9 0F        CMP #$0F
03/F70B: D0 01        BNE $F70E
03/F70D: 3A           DEC 
03/F70E: FA           PLX 
03/F70F: 9D A3 F0     STA $F0A3,X
03/F712: 6B           RTL 

03/F713: 10 59 59 59 21 10

; [  ]

03/F719: 7B           TDC 
03/F71A: A8           TAY 
03/F71B: AA           TAX 
03/F71C: BD 15 F0     LDA $F015,X
03/F71F: 29 C0        AND #$C0
03/F721: D0 13        BNE $F736
03/F723: BD 16 F0     LDA $F016,X
03/F726: 29 3C        AND #$3C
03/F728: D0 0C        BNE $F736
03/F72A: 8A           TXA 
03/F72B: 18           CLC 
03/F72C: 69 04        ADC #$04
03/F72E: AA           TAX 
03/F72F: C8           INY 
03/F730: E0 14 00     CPX #$0014
03/F733: D0 E7        BNE $F71C
03/F735: 60           RTS 
03/F736: A9 00        LDA #$00
03/F738: 99 99 F0     STA $F099,Y
03/F73B: 99 9E F0     STA $F09E,Y
03/F73E: 4C 2A F7     JMP $F72A

; [  ]

03/F741: 20 19 F7     JSR $F719
03/F744: AD 22 18     LDA $1822
03/F747: 0A           ASL 
03/F748: 0A           ASL 
03/F749: AA           TAX 
03/F74A: BD 15 F0     LDA $F015,X
03/F74D: 29 C0        AND #$C0
03/F74F: D0 1B        BNE $F76C
03/F751: BD 16 F0     LDA $F016,X
03/F754: 29 3C        AND #$3C
03/F756: D0 14        BNE $F76C
03/F758: A2 00 00     LDX #$0000
03/F75B: BD B5 29     LDA $29B5,X
03/F75E: C9 FF        CMP #$FF
03/F760: D0 08        BNE $F76A
03/F762: E8           INX 
03/F763: E0 08 00     CPX #$0008
03/F766: D0 F3        BNE $F75B
03/F768: 80 02        BRA $F76C
03/F76A: 18           CLC 
03/F76B: 6B           RTL 
03/F76C: 38           SEC 
03/F76D: 6B           RTL 

; [ load battle bg palette ]

03/F76E: AD 02 18     LDA $1802       ; battle bg id
03/F771: 29 1F        AND #$1F
03/F773: 85 00        STA $00
03/F775: AA           TAX 
03/F776: AD 02 18     LDA $1802
03/F779: 29 20        AND #$20
03/F77B: F0 06        BEQ $F783       ; branch if not using alternate palette
03/F77D: BF BC F7 03  LDA $03F7BC,X   ; alternate battle bg palette id
03/F781: D0 03        BNE $F786
03/F783: 18           CLC 
03/F784: 65 00        ADC $00
03/F786: A2 01 00     LDX #$0001
03/F789: 85 2A        STA $2A
03/F78B: C2 20        REP #$20
03/F78D: 06 2A        ASL $2A
03/F78F: 06 2A        ASL $2A
03/F791: 06 2A        ASL $2A
03/F793: 06 2A        ASL $2A
03/F795: 06 2A        ASL $2A
03/F797: 8A           TXA 
03/F798: 0A           ASL 
03/F799: 0A           ASL 
03/F79A: 0A           ASL 
03/F79B: 0A           ASL 
03/F79C: 0A           ASL 
03/F79D: A8           TAY 
03/F79E: 7B           TDC 
03/F79F: E2 20        SEP #$20
03/F7A1: A6 2A        LDX $2A
03/F7A3: A9 10        LDA #$10
03/F7A5: 85 00        STA $00
03/F7A7: BF 00 D2 0F  LDA $0FD200,X
03/F7AB: 99 50 ED     STA $ED50,Y
03/F7AE: BF 10 D2 0F  LDA $0FD210,X
03/F7B2: 99 70 ED     STA $ED70,Y
03/F7B5: E8           INX 
03/F7B6: C8           INY 
03/F7B7: C6 00        DEC $00
03/F7B9: D0 EC        BNE $F7A7
03/F7BB: 6B           RTL 

; alternate battle bg palette id
03/F7BC: 16 00 00 00 11 00 00 12 14 00 00 13 15 00 00 00 00

; [ increment game time ]

03/F7CD: EE A3 16     INC $16A3       ; increment game time
03/F7D0: AD A3 16     LDA $16A3
03/F7D3: C9 3C        CMP #$3C
03/F7D5: 90 10        BCC $F7E7
03/F7D7: 9C A3 16     STZ $16A3
03/F7DA: EE A4 16     INC $16A4
03/F7DD: D0 08        BNE $F7E7
03/F7DF: EE A5 16     INC $16A5
03/F7E2: D0 03        BNE $F7E7
03/F7E4: EE A6 16     INC $16A6
03/F7E7: 6B           RTL 

; [  ]

03/F7E8: A5 0E        LDA $0E
03/F7EA: F0 0A        BEQ $F7F6
03/F7EC: C6 0E        DEC $0E
03/F7EE: A9 31        LDA #$31
03/F7F0: 85 10        STA $10
03/F7F2: A9 FF        LDA #$FF
03/F7F4: 18           CLC 
03/F7F5: 6B           RTL 
03/F7F6: A7 1C        LDA [$1C]
03/F7F8: C9 FE        CMP #$FE
03/F7FA: F0 12        BEQ $F80E
03/F7FC: C9 FF        CMP #$FF
03/F7FE: F0 18        BEQ $F818
03/F800: A6 1C        LDX $1C
03/F802: E8           INX 
03/F803: 86 1C        STX $1C
03/F805: 48           PHA 
03/F806: AD 30 F3     LDA $F330
03/F809: 85 10        STA $10
03/F80B: 68           PLA 
03/F80C: 38           SEC 
03/F80D: 6B           RTL 
03/F80E: A6 1C        LDX $1C
03/F810: E8           INX 
03/F811: 86 1C        STX $1C
03/F813: A7 1C        LDA [$1C]
03/F815: 3A           DEC 
03/F816: 85 0E        STA $0E
03/F818: A9 31        LDA #$31
03/F81A: 85 10        STA $10
03/F81C: A9 FF        LDA #$FF
03/F81E: A6 1C        LDX $1C
03/F820: E8           INX 
03/F821: 86 1C        STX $1C
03/F823: 18           CLC 
03/F824: 6B           RTL 

; [  ]

03/F825: A9 40        LDA #$40
03/F827: 20 48 FD     JSR $FD48
03/F82A: A9 1F        LDA #$1F
03/F82C: 8D 33 F4     STA $F433
03/F82F: 8D 35 F4     STA $F435
03/F832: 8D 34 F4     STA $F434
03/F835: A9 E0        LDA #$E0
03/F837: 8D 88 EF     STA $EF88
03/F83A: A9 10        LDA #$10
03/F83C: 8D 9B F4     STA $F49B
03/F83F: A9 05        LDA #$05
03/F841: 8D 87 EF     STA $EF87
03/F844: 6B           RTL 

; [  ]

03/F845: A9 24        LDA #$24
03/F847: 22 D7 F5 02  JSL $02F5D7
03/F84B: 22 B9 EE 01  JSL $01EEB9
03/F84F: 20 64 F8     JSR $F864
03/F852: 22 B5 EE 01  JSL $01EEB5
03/F856: 20 64 F8     JSR $F864
03/F859: 22 C5 EE 01  JSL $01EEC5
03/F85D: 20 64 F8     JSR $F864
03/F860: 9C 87 EF     STZ $EF87
03/F863: 6B           RTL 

; [ wait 8 frames ]

03/F864: A2 08 00     LDX #$0008      ; repeat 8 times
03/F867: 22 06 80 02  JSL $028006     ; wait one frame
03/F86B: CA           DEX 
03/F86C: D0 F9        BNE $F867
03/F86E: 60           RTS 

; [ big bang ]

03/F86F: 20 BE F8     JSR $F8BE       ; make final battle bg scroll backward
03/F872: A2 B0 80     LDX #$80B0
03/F875: 8E 89 F2     STX $F289       ; sprite $B0 is highest priority
03/F878: EE 8B F2     INC $F28B
03/F87B: 7B           TDC 
03/F87C: 22 5D EB 02  JSL $02EB5D
03/F880: 22 03 E7 02  JSL $02E703
03/F884: 7B           TDC 
03/F885: AA           TAX 
03/F886: 8E 89 F2     STX $F289       ; disable sprite priority order shifting
03/F889: EE 8B F2     INC $F28B
03/F88C: A2 04 00     LDX #$0004      ; repeat 4 times
03/F88F: DA           PHX 
03/F890: 22 BD EE 01  JSL $01EEBD
03/F894: 20 64 F8     JSR $F864
03/F897: 22 B9 EE 01  JSL $01EEB9
03/F89B: 20 64 F8     JSR $F864
03/F89E: 22 B5 EE 01  JSL $01EEB5
03/F8A2: 20 64 F8     JSR $F864
03/F8A5: 22 C1 EE 01  JSL $01EEC1
03/F8A9: 20 64 F8     JSR $F864
03/F8AC: 22 C5 EE 01  JSL $01EEC5
03/F8B0: 20 64 F8     JSR $F864
03/F8B3: FA           PLX 
03/F8B4: CA           DEX 
03/F8B5: D0 D8        BNE $F88F
03/F8B7: 9C 87 EF     STZ $EF87
03/F8BA: 20 E0 F8     JSR $F8E0       ; make final battle bg scroll forward
03/F8BD: 6B           RTL 

; [ make final battle bg scroll backward ]

03/F8BE: 22 06 80 02  JSL $028006     ; wait one frame
03/F8C2: 64 00        STZ $00
03/F8C4: A2 00 00     LDX #$0000
03/F8C7: BD 88 F4     LDA $F488,X
03/F8CA: DF 5C F9 03  CMP $03F95C,X   ; backward scroll rate
03/F8CE: F0 05        BEQ $F8D5
03/F8D0: DE 88 F4     DEC $F488,X     ; decrement to backward scroll rate
03/F8D3: E6 00        INC $00
03/F8D5: E8           INX 
03/F8D6: E0 12 00     CPX #$0012
03/F8D9: D0 EC        BNE $F8C7
03/F8DB: A5 00        LDA $00
03/F8DD: D0 DF        BNE $F8BE
03/F8DF: 60           RTS 

; [ make final battle bg scroll forward ]

03/F8E0: 22 06 80 02  JSL $028006     ; wait one frame
03/F8E4: 64 00        STZ $00
03/F8E6: A2 00 00     LDX #$0000
03/F8E9: BD 88 F4     LDA $F488,X
03/F8EC: DF 4A F9 03  CMP $03F94A,X   ; forward scroll rate
03/F8F0: F0 05        BEQ $F8F7
03/F8F2: FE 88 F4     INC $F488,X     ; increment to forward scroll rate
03/F8F5: E6 00        INC $00
03/F8F7: E8           INX 
03/F8F8: E0 12 00     CPX #$0012
03/F8FB: D0 EC        BNE $F8E9
03/F8FD: A5 00        LDA $00
03/F8FF: D0 DF        BNE $F8E0
03/F901: 60           RTS 

; [ update final battle bg hdma data ]

03/F902: DA           PHX 
03/F903: 5A           PHY 
03/F904: AD A9 F4     LDA $F4A9
03/F907: D0 3E        BNE $F947
03/F909: AD 02 18     LDA $1802
03/F90C: C9 10        CMP #$10
03/F90E: D0 37        BNE $F947       ; branch if not final battle bg
03/F910: 7B           TDC 
03/F911: AA           TAX 
03/F912: BF 6E F9 03  LDA $03F96E,X   ; hdma strip size
03/F916: A8           TAY 
03/F917: 84 0E        STY $0E
03/F919: 64 11        STZ $11
03/F91B: BD 88 F4     LDA $F488,X     ; scroll rate for this strip
03/F91E: 85 10        STA $10
03/F920: 10 02        BPL $F924       ; convert to 16-bit
03/F922: C6 11        DEC $11
03/F924: C2 20        REP #$20
03/F926: 8A           TXA 
03/F927: 0A           ASL 
03/F928: 0A           ASL 
03/F929: 0A           ASL 
03/F92A: 0A           ASL 
03/F92B: 0A           ASL 
03/F92C: A8           TAY 
03/F92D: B9 92 79     LDA $7992,Y     ; add to bg2 hdma h-scroll value
03/F930: 18           CLC 
03/F931: 65 10        ADC $10
03/F933: 99 92 79     STA $7992,Y
03/F936: C8           INY 
03/F937: C8           INY 
03/F938: C8           INY 
03/F939: C8           INY 
03/F93A: C6 0E        DEC $0E
03/F93C: D0 F5        BNE $F933
03/F93E: 7B           TDC 
03/F93F: E2 20        SEP #$20
03/F941: E8           INX 
03/F942: E0 12 00     CPX #$0012
03/F945: D0 CB        BNE $F912
03/F947: 7A           PLY 
03/F948: FA           PLX 
03/F949: 6B           RTL 

; final battle bg hdma data (3 * 18 bytes)

; forward scroll rate (1x)
03/F94A: 05 04 03 02 01 00 01 02 03 04 05 06 07 08 09 0A 0B 0C

; backward scroll rate (3x)
03/F95C: F1 F4 F7 FA FD 00 FD FA F7 F4 F1 EE EB E8 E5 E2 DF DC

; hdma strip sizes (pixels)
03/F96E: 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 08 04

; [  ]

03/F980: 64 4E        STZ $4E
03/F982: 7B           TDC 
03/F983: AA           TAX 
03/F984: 8E 06 F4     STX $F406
03/F987: 8E 08 F4     STX $F408
03/F98A: 22 06 80 02  JSL $028006     ; wait one frame
03/F98E: 22 70 ED 01  JSL $01ED70
03/F992: A5 4E        LDA $4E
03/F994: 29 07        AND #$07
03/F996: 0A           ASL 
03/F997: AA           TAX 
03/F998: C2 20        REP #$20
03/F99A: BF C5 FC 13  LDA $13FCC5,X
03/F99E: 8D 06 F4     STA $F406
03/F9A1: 7B           TDC 
03/F9A2: E2 20        SEP #$20
03/F9A4: E6 4E        INC $4E
03/F9A6: A5 4E        LDA $4E
03/F9A8: C9 40        CMP #$40
03/F9AA: D0 DE        BNE $F98A
03/F9AC: 7B           TDC 
03/F9AD: AA           TAX 
03/F9AE: 8E 06 F4     STX $F406
03/F9B1: 22 70 ED 01  JSL $01ED70
03/F9B5: 6B           RTL 

; [  ]

03/F9B6: DA           PHX 
03/F9B7: E6 97        INC $97
03/F9B9: A5 97        LDA $97
03/F9BB: AA           TAX 
03/F9BC: BD 00 19     LDA $1900,X     ; rng table
03/F9BF: FA           PLX 
03/F9C0: 60           RTS 

; [  ]

03/F9C1: A9 20        LDA #$20
03/F9C3: 8D 11 F1     STA $F111
03/F9C6: 7B           TDC 
03/F9C7: AA           TAX 
03/F9C8: 20 31 FA     JSR $FA31
03/F9CB: E0 10 00     CPX #$0010
03/F9CE: D0 F8        BNE $F9C8
03/F9D0: 7B           TDC 
03/F9D1: AA           TAX 
03/F9D2: 3A           DEC 
03/F9D3: 9D A8 F3     STA $F3A8,X
03/F9D6: E8           INX 
03/F9D7: E0 08 00     CPX #$0008
03/F9DA: D0 F7        BNE $F9D3
03/F9DC: 9C A8 F3     STZ $F3A8
03/F9DF: 22 B9 EE 01  JSL $01EEB9
03/F9E3: A9 02        LDA #$02
03/F9E5: 8D 87 EF     STA $EF87
03/F9E8: A2 04 00     LDX #$0004
03/F9EB: 22 06 80 02  JSL $028006     ; wait one frame
03/F9EF: CA           DEX 
03/F9F0: D0 F9        BNE $F9EB
03/F9F2: EE 2B F4     INC $F42B
03/F9F5: 20 48 FA     JSR $FA48
03/F9F8: 9C 2B F4     STZ $F42B
03/F9FB: A2 16 00     LDX #$0016
03/F9FE: BD 98 F3     LDA $F398,X
03/FA01: 9D 99 F3     STA $F399,X
03/FA04: CA           DEX 
03/FA05: E0 0F 00     CPX #$000F
03/FA08: D0 F4        BNE $F9FE
03/FA0A: AD A8 F3     LDA $F3A8
03/FA0D: 1A           INC 
03/FA0E: 29 07        AND #$07
03/FA10: 8D A8 F3     STA $F3A8
03/FA13: 7B           TDC 
03/FA14: AA           TAX 
03/FA15: BD A8 F3     LDA $F3A8,X
03/FA18: D0 08        BNE $FA22
03/FA1A: DA           PHX 
03/FA1B: 8A           TXA 
03/FA1C: 0A           ASL 
03/FA1D: AA           TAX 
03/FA1E: 20 31 FA     JSR $FA31
03/FA21: FA           PLX 
03/FA22: E8           INX 
03/FA23: E0 08 00     CPX #$0008
03/FA26: D0 ED        BNE $FA15
03/FA28: CE 11 F1     DEC $F111
03/FA2B: D0 BB        BNE $F9E8
03/FA2D: 9C 87 EF     STZ $EF87
03/FA30: 6B           RTL 

; [  ]

03/FA31: 20 B6 F9     JSR $F9B6
03/FA34: 29 7F        AND #$7F
03/FA36: 18           CLC 
03/FA37: 9D 98 F3     STA $F398,X
03/FA3A: E8           INX 
03/FA3B: 20 B6 F9     JSR $F9B6
03/FA3E: 29 3F        AND #$3F
03/FA40: 18           CLC 
03/FA41: 69 20        ADC #$20
03/FA43: 9D 98 F3     STA $F398,X
03/FA46: E8           INX 
03/FA47: 60           RTS 
03/FA48: 7B           TDC 
03/FA49: AA           TAX 
03/FA4A: A8           TAY 
03/FA4B: BD A8 F3     LDA $F3A8,X
03/FA4E: C9 FF        CMP #$FF
03/FA50: F0 69        BEQ $FABB
03/FA52: 0A           ASL 
03/FA53: DA           PHX 
03/FA54: AA           TAX 
03/FA55: BF 09 F9 13  LDA $13F909,X
03/FA59: 85 00        STA $00
03/FA5B: BF 0A F9 13  LDA $13F90A,X
03/FA5F: 85 01        STA $01
03/FA61: A9 13        LDA #$13
03/FA63: 85 02        STA $02
03/FA65: FA           PLX 
03/FA66: DA           PHX 
03/FA67: 8A           TXA 
03/FA68: 0A           ASL 
03/FA69: AA           TAX 
03/FA6A: BD 98 F3     LDA $F398,X
03/FA6D: 85 04        STA $04
03/FA6F: BD 99 F3     LDA $F399,X
03/FA72: 85 05        STA $05
03/FA74: A7 00        LDA [$00]
03/FA76: C9 FF        CMP #$FF
03/FA78: F0 40        BEQ $FABA
03/FA7A: 18           CLC 
03/FA7B: 65 04        ADC $04
03/FA7D: 48           PHA 
03/FA7E: AD C0 6C     LDA $6CC0
03/FA81: F0 04        BEQ $FA87
03/FA83: 68           PLA 
03/FA84: 49 FF        EOR #$FF
03/FA86: 48           PHA 
03/FA87: 68           PLA 
03/FA88: 99 40 03     STA $0340,Y
03/FA8B: 20 C2 FA     JSR $FAC2
03/FA8E: A7 00        LDA [$00]
03/FA90: 18           CLC 
03/FA91: 65 05        ADC $05
03/FA93: 99 41 03     STA $0341,Y
03/FA96: 20 C2 FA     JSR $FAC2
03/FA99: A7 00        LDA [$00]
03/FA9B: 99 42 03     STA $0342,Y
03/FA9E: 20 C2 FA     JSR $FAC2
03/FAA1: A7 00        LDA [$00]
03/FAA3: 48           PHA 
03/FAA4: AD C0 6C     LDA $6CC0
03/FAA7: F0 04        BEQ $FAAD
03/FAA9: 68           PLA 
03/FAAA: 49 40        EOR #$40
03/FAAC: 48           PHA 
03/FAAD: 68           PLA 
03/FAAE: 99 43 03     STA $0343,Y
03/FAB1: C8           INY 
03/FAB2: C8           INY 
03/FAB3: C8           INY 
03/FAB4: C8           INY 
03/FAB5: 20 C2 FA     JSR $FAC2
03/FAB8: 80 BA        BRA $FA74
03/FABA: FA           PLX 
03/FABB: E8           INX 
03/FABC: E0 08 00     CPX #$0008
03/FABF: D0 8A        BNE $FA4B
03/FAC1: 60           RTS 

; [  ]

03/FAC2: A6 00        LDX $00
03/FAC4: E8           INX 
03/FAC5: 86 00        STX $00
03/FAC7: 60           RTS 

; [  ]

03/FAC8: AD E6 38     LDA $38E6
03/FACB: D0 04        BNE $FAD1
03/FACD: 20 E5 FA     JSR $FAE5
03/FAD0: 6B           RTL 
03/FAD1: C9 01        CMP #$01
03/FAD3: D0 04        BNE $FAD9
03/FAD5: 20 E5 FA     JSR $FAE5
03/FAD8: 6B           RTL 
03/FAD9: C9 02        CMP #$02
03/FADB: D0 04        BNE $FAE1
03/FADD: 20 E5 FA     JSR $FAE5
03/FAE0: 6B           RTL 

; [  ]

03/FAE1: 20 E5 FA     JSR $FAE5
03/FAE4: 6B           RTL 

; [  ]

03/FAE5: 7B           TDC 
03/FAE6: A8           TAY 
03/FAE7: A5 4E        LDA $4E
03/FAE9: 0A           ASL 
03/FAEA: AA           TAX 
03/FAEB: BF 9D F9 13  LDA $13F99D,X
03/FAEF: 85 01        STA $01
03/FAF1: BF 9E F9 13  LDA $13F99E,X
03/FAF5: 85 00        STA $00
03/FAF7: E8           INX 
03/FAF8: E8           INX 
03/FAF9: C2 20        REP #$20
03/FAFB: 06 00        ASL $00
03/FAFD: 26 02        ROL $02
03/FAFF: 7B           TDC 
03/FB00: E2 20        SEP #$20
03/FB02: A5 02        LDA $02
03/FB04: 29 01        AND #$01
03/FB06: 49 01        EOR #$01
03/FB08: 99 13 76     STA $7613,Y
03/FB0B: 99 93 76     STA $7693,Y
03/FB0E: 99 13 77     STA $7713,Y
03/FB11: 99 93 77     STA $7793,Y
03/FB14: 99 13 78     STA $7813,Y
03/FB17: 99 93 78     STA $7893,Y
03/FB1A: C8           INY 
03/FB1B: C8           INY 
03/FB1C: C8           INY 
03/FB1D: C8           INY 
03/FB1E: C0 40 00     CPY #$0040
03/FB21: D0 C8        BNE $FAEB
03/FB23: A0 40 00     LDY #$0040
03/FB26: A5 4E        LDA $4E
03/FB28: 0A           ASL 
03/FB29: AA           TAX 
03/FB2A: BF 9D F9 13  LDA $13F99D,X
03/FB2E: 85 01        STA $01
03/FB30: BF 9E F9 13  LDA $13F99E,X
03/FB34: 85 00        STA $00
03/FB36: E8           INX 
03/FB37: E8           INX 
03/FB38: C2 20        REP #$20
03/FB3A: 06 00        ASL $00
03/FB3C: 26 02        ROL $02
03/FB3E: 7B           TDC 
03/FB3F: E2 20        SEP #$20
03/FB41: A5 02        LDA $02
03/FB43: 29 01        AND #$01
03/FB45: 49 01        EOR #$01
03/FB47: 99 4F 76     STA $764F,Y
03/FB4A: 99 CF 76     STA $76CF,Y
03/FB4D: 99 4F 77     STA $774F,Y
03/FB50: 99 CF 77     STA $77CF,Y
03/FB53: 99 4F 78     STA $784F,Y
03/FB56: 88           DEY 
03/FB57: 88           DEY 
03/FB58: 88           DEY 
03/FB59: 88           DEY 
03/FB5A: D0 CE        BNE $FB2A
03/FB5C: 60           RTS 

; [  ]

03/FB5D: 7B           TDC 
03/FB5E: AA           TAX 
03/FB5F: BD 32 8C     LDA $8C32,X
03/FB62: 48           PHA 
03/FB63: BD 12 7E     LDA $7E12,X
03/FB66: 9D 32 8C     STA $8C32,X
03/FB69: 68           PLA 
03/FB6A: 9D 12 7E     STA $7E12,X
03/FB6D: E8           INX 
03/FB6E: E0 80 00     CPX #$0080
03/FB71: D0 EC        BNE $FB5F
03/FB73: 60           RTS 

; [ update sound for pause/unpause ]

; pause
03/FB74: A9 8A        LDA #$8A        ; quarter volume
03/FB76: 8D 00 1E     STA $1E00
03/FB79: 22 04 80 04  JSL $048004     ; execute sound command
03/FB7D: 80 09        BRA $FB88
; unpause
03/FB7F: A9 88        LDA #$88        ; full volume
03/FB81: 8D 00 1E     STA $1E00
03/FB84: 22 04 80 04  JSL $048004     ; execute sound command
03/FB88: A9 02        LDA #$02
03/FB8A: 8D 00 1E     STA $1E00
03/FB8D: A9 5A        LDA #$5A        ; play sound effect $5A
03/FB8F: 8D 01 1E     STA $1E01
03/FB92: A9 80        LDA #$80
03/FB94: 8D 02 1E     STA $1E02
03/FB97: 22 04 80 04  JSL $048004     ; execute sound command
03/FB9B: 60           RTS 

; [  ]

03/FB9C: AF 19 42 00  LDA $004219
03/FBA0: 0F 1B 42 00  ORA $00421B
03/FBA4: 29 10        AND #$10        ; start button (controller 1 or 2)
03/FBA6: 05 38        ORA $38
03/FBA8: 85 38        STA $38         ; set controller 1 buttons pressed
03/FBAA: AD 4B F4     LDA $F44B
03/FBAD: C9 FF        CMP #$FF
03/FBAF: F0 3C        BEQ $FBED
03/FBB1: AD 4A F4     LDA $F44A
03/FBB4: F0 37        BEQ $FBED
03/FBB6: AD 48 F4     LDA $F448
03/FBB9: F0 34        BEQ $FBEF
03/FBBB: C9 01        CMP #$01
03/FBBD: F0 1C        BEQ $FBDB
03/FBBF: EE 49 F4     INC $F449
03/FBC2: AD 49 F4     LDA $F449
03/FBC5: C9 0F        CMP #$0F
03/FBC7: D0 73        BNE $FC3C
03/FBC9: 9C 48 F4     STZ $F448
03/FBCC: 9C D9 38     STZ $38D9
03/FBCF: AD 4B F4     LDA $F44B
03/FBD2: C9 FE        CMP #$FE
03/FBD4: D0 66        BNE $FC3C
03/FBD6: EE 4B F4     INC $F44B
03/FBD9: 80 61        BRA $FC3C
03/FBDB: CE 49 F4     DEC $F449
03/FBDE: AD 49 F4     LDA $F449
03/FBE1: C9 04        CMP #$04
03/FBE3: D0 57        BNE $FC3C
03/FBE5: 9C 48 F4     STZ $F448
03/FBE8: EE D9 38     INC $38D9
03/FBEB: 80 E2        BRA $FBCF
03/FBED: 80 4B        BRA $FC3A
03/FBEF: AD D9 38     LDA $38D9
03/FBF2: D0 24        BNE $FC18
03/FBF4: AD 4B F4     LDA $F44B
03/FBF7: F0 07        BEQ $FC00
03/FBF9: A9 FE        LDA #$FE
03/FBFB: 8D 4B F4     STA $F44B
03/FBFE: 80 0C        BRA $FC0C
03/FC00: A5 38        LDA $38
03/FC02: 29 10        AND #$10
03/FC04: F0 34        BEQ $FC3A
03/FC06: 20 74 FB     JSR $FB74       ; update sound for pause
03/FC09: 20 5D FB     JSR $FB5D
03/FC0C: A9 01        LDA #$01
03/FC0E: 8D 48 F4     STA $F448
03/FC11: A9 0F        LDA #$0F
03/FC13: 8D 49 F4     STA $F449
03/FC16: 80 24        BRA $FC3C
03/FC18: AD 4B F4     LDA $F44B
03/FC1B: F0 07        BEQ $FC24
03/FC1D: A9 FE        LDA #$FE
03/FC1F: 8D 4B F4     STA $F44B
03/FC22: 80 06        BRA $FC2A
03/FC24: A5 38        LDA $38
03/FC26: 29 10        AND #$10
03/FC28: F0 12        BEQ $FC3C       ; branch if start button is not pressed
03/FC2A: 20 7F FB     JSR $FB7F       ; update sound for unpause
03/FC2D: 20 5D FB     JSR $FB5D
03/FC30: A9 02        LDA #$02
03/FC32: 8D 48 F4     STA $F448
03/FC35: A9 04        LDA #$04
03/FC37: 8D 49 F4     STA $F449
03/FC3A: 18           CLC 
03/FC3B: 6B           RTL 
03/FC3C: 38           SEC 
03/FC3D: 6B           RTL 

; [  ]

03/FC3E: AD 87 EF     LDA $EF87
03/FC41: D0 03        BNE $FC46
03/FC43: 4C 24 FD     JMP $FD24
03/FC46: AD 9B F4     LDA $F49B
03/FC49: F0 05        BEQ $FC50
03/FC4B: AD 9B F4     LDA $F49B
03/FC4E: 80 02        BRA $FC52
03/FC50: A9 03        LDA #$03
03/FC52: 20 48 FD     JSR $FD48
03/FC55: A9 E0        LDA #$E0
03/FC57: 8F 32 21 00  STA $002132
03/FC5B: AD 87 EF     LDA $EF87
03/FC5E: C9 01        CMP #$01
03/FC60: F0 72        BEQ $FCD4
03/FC62: C9 02        CMP #$02
03/FC64: F0 3B        BEQ $FCA1
03/FC66: C9 03        CMP #$03
03/FC68: F0 6A        BEQ $FCD4
03/FC6A: C9 04        CMP #$04
03/FC6C: F0 20        BEQ $FC8E
03/FC6E: C9 05        CMP #$05
03/FC70: F0 04        BEQ $FC76
03/FC72: C9 06        CMP #$06
03/FC74: F0 2B        BEQ $FCA1
03/FC76: AD 35 F4     LDA $F435
03/FC79: F0 0B        BEQ $FC86
03/FC7B: CE 35 F4     DEC $F435
03/FC7E: CE 34 F4     DEC $F434
03/FC81: CE 33 F4     DEC $F433
03/FC84: 80 55        BRA $FCDB
03/FC86: 9C 9B F4     STZ $F49B
03/FC89: 9C 87 EF     STZ $EF87
03/FC8C: 80 4D        BRA $FCDB
03/FC8E: AD 35 F4     LDA $F435
03/FC91: CD 36 F4     CMP $F436
03/FC94: F0 09        BEQ $FC9F
03/FC96: EE 35 F4     INC $F435
03/FC99: EE 34 F4     INC $F434
03/FC9C: EE 33 F4     INC $F433
03/FC9F: 80 3A        BRA $FCDB
03/FCA1: AD 8A EF     LDA $EF8A
03/FCA4: D0 19        BNE $FCBF
03/FCA6: AD 35 F4     LDA $F435
03/FCA9: C9 1F        CMP #$1F
03/FCAB: F0 0B        BEQ $FCB8
03/FCAD: EE 35 F4     INC $F435
03/FCB0: EE 34 F4     INC $F434
03/FCB3: EE 33 F4     INC $F433
03/FCB6: 80 23        BRA $FCDB
03/FCB8: A9 01        LDA #$01
03/FCBA: 8D 8A EF     STA $EF8A
03/FCBD: 80 1C        BRA $FCDB
03/FCBF: AD 35 F4     LDA $F435
03/FCC2: F0 0B        BEQ $FCCF
03/FCC4: CE 35 F4     DEC $F435
03/FCC7: CE 34 F4     DEC $F434
03/FCCA: CE 33 F4     DEC $F433
03/FCCD: 80 0C        BRA $FCDB
03/FCCF: 9C 8A EF     STZ $EF8A
03/FCD2: 80 07        BRA $FCDB
03/FCD4: AD 89 EF     LDA $EF89
03/FCD7: 29 02        AND #$02
03/FCD9: D0 45        BNE $FD20
03/FCDB: AD 88 EF     LDA $EF88
03/FCDE: 29 80        AND #$80
03/FCE0: F0 09        BEQ $FCEB
03/FCE2: AD 33 F4     LDA $F433
03/FCE5: 09 80        ORA #$80
03/FCE7: 8F 32 21 00  STA $002132
03/FCEB: AD 88 EF     LDA $EF88
03/FCEE: 29 40        AND #$40
03/FCF0: F0 09        BEQ $FCFB
03/FCF2: AD 34 F4     LDA $F434
03/FCF5: 09 40        ORA #$40
03/FCF7: 8F 32 21 00  STA $002132
03/FCFB: AD 88 EF     LDA $EF88
03/FCFE: 29 20        AND #$20
03/FD00: F0 09        BEQ $FD0B
03/FD02: AD 35 F4     LDA $F435
03/FD05: 09 20        ORA #$20
03/FD07: 8F 32 21 00  STA $002132
03/FD0B: AD 87 EF     LDA $EF87
03/FD0E: C9 03        CMP #$03
03/FD10: D0 0E        BNE $FD20
03/FD12: EE 89 EF     INC $EF89
03/FD15: AD 89 EF     LDA $EF89
03/FD18: 29 02        AND #$02
03/FD1A: D0 03        BNE $FD1F
03/FD1C: 9C 87 EF     STZ $EF87
03/FD1F: 6B           RTL 
03/FD20: EE 89 EF     INC $EF89
03/FD23: 6B           RTL 
03/FD24: AD 4E ED     LDA $ED4E
03/FD27: 29 80        AND #$80
03/FD29: F0 10        BEQ $FD3B       ; branch if monsters are not transparent
03/FD2B: A9 02        LDA #$02
03/FD2D: 8F 30 21 00  STA $002130
03/FD31: 8F 2D 21 00  STA $00212D
03/FD35: A9 41        LDA #$41
03/FD37: 20 48 FD     JSR $FD48
03/FD3A: 6B           RTL 

; [  ]

03/FD3B: 7B           TDC 
03/FD3C: 8F 30 21 00  STA $002130
03/FD40: 8F 2D 21 00  STA $00212D
03/FD44: 20 48 FD     JSR $FD48
03/FD47: 6B           RTL 

; [  ]

03/FD48: 8F 31 21 00  STA $002131
03/FD4C: 8D 3D F4     STA $F43D
03/FD4F: 8D 3F F4     STA $F43F
03/FD52: 60           RTS 

; [  ]

03/FD53: 9C 26 F3     STZ $F326
03/FD56: 9C 27 F3     STZ $F327
03/FD59: 9C 29 F3     STZ $F329
03/FD5C: 9C 2B F3     STZ $F32B
03/FD5F: 9C 2C F3     STZ $F32C
03/FD62: 9C 2D F3     STZ $F32D
03/FD65: 48           PHA 
03/FD66: 38           SEC 
03/FD67: E9 4D        SBC #$4D
03/FD69: 8D 25 F3     STA $F325
03/FD6C: C9 0D        CMP #$0D
03/FD6E: 90 15        BCC $FD85
03/FD70: C9 10        CMP #$10
03/FD72: F0 11        BEQ $FD85
03/FD74: 48           PHA 
03/FD75: EE 27 F3     INC $F327
03/FD78: AD 13 18     LDA $1813
03/FD7B: A8           TAY 
03/FD7C: B9 00 19     LDA $1900,Y     ; rng table
03/FD7F: 29 03        AND #$03
03/FD81: 8D 26 F3     STA $F326
03/FD84: 68           PLA 
03/FD85: C9 0A        CMP #$0A
03/FD87: D0 1A        BNE $FDA3
03/FD89: 48           PHA 
03/FD8A: 9C 33 F1     STZ $F133
03/FD8D: A9 40        LDA #$40
03/FD8F: 8D 73 F1     STA $F173
03/FD92: A9 08        LDA #$08
03/FD94: 8D B3 F1     STA $F1B3
03/FD97: 8D F3 F1     STA $F1F3
03/FD9A: A9 02        LDA #$02
03/FD9C: 8D 2D F3     STA $F32D
03/FD9F: EE 2C F3     INC $F32C
03/FDA2: 68           PLA 
03/FDA3: 0A           ASL 
03/FDA4: 0A           ASL 
03/FDA5: AA           TAX 
03/FDA6: 7B           TDC 
03/FDA7: A8           TAY 
03/FDA8: BF 59 FA 13  LDA $13FA59,X
03/FDAC: 99 21 F3     STA $F321,Y
03/FDAF: E8           INX 
03/FDB0: C8           INY 
03/FDB1: C0 04 00     CPY #$0004
03/FDB4: D0 F2        BNE $FDA8
03/FDB6: 68           PLA 
03/FDB7: A9 38        LDA #$38
03/FDB9: 8D 30 F3     STA $F330
03/FDBC: 7B           TDC 
03/FDBD: A8           TAY 
03/FDBE: 7B           TDC 
03/FDBF: 99 90 EE     STA $EE90,Y
03/FDC2: E8           INX 
03/FDC3: C8           INY 
03/FDC4: C0 20 00     CPY #$0020
03/FDC7: D0 F5        BNE $FDBE
03/FDC9: A2 FF 7F     LDX #$7FFF
03/FDCC: 8E 92 EE     STX $EE92
03/FDCF: 6B           RTL 

; [ update controller ]

03/FDD0: AD 4A F4     LDA $F44A
03/FDD3: F0 2D        BEQ $FE02
03/FDD5: 0B           PHD 
03/FDD6: A2 37 00     LDX #$0037
03/FDD9: DA           PHX 
03/FDDA: 2B           PLD 
03/FDDB: 22 28 80 01  JSL $018028     ; update controller
03/FDDF: 2B           PLD 
03/FDE0: AF 18 42 00  LDA $004218
03/FDE4: 0F 1A 42 00  ORA $00421A
03/FDE8: 29 30        AND #$30
03/FDEA: C9 30        CMP #$30
03/FDEC: D0 06        BNE $FDF4       ; branch if not holding R and L buttons
03/FDEE: A5 37        LDA $37
03/FDF0: 29 7F        AND #$7F        ; ignore A button
03/FDF2: 85 37        STA $37
03/FDF4: AD 3A F4     LDA $F43A
03/FDF7: F0 09        BEQ $FE02       ; branch if not waiting for battle message keypress
03/FDF9: A5 37        LDA $37
03/FDFB: 05 38        ORA $38
03/FDFD: F0 03        BEQ $FE02       ; branch if no keypress
03/FDFF: 9C 3A F4     STZ $F43A
03/FE02: 6B           RTL 

; [ transfer sprite data to ppu ]

03/FE03: AD 2B F4     LDA $F42B
03/FE06: D0 3D        BNE $FE45
03/FE08: 8B           PHB 
03/FE09: 7B           TDC 
03/FE0A: 48           PHA 
03/FE0B: AB           PLB 
03/FE0C: A2 00 00     LDX #$0000
03/FE0F: 8E 02 21     STX $2102
03/FE12: A2 00 04     LDX #$0400
03/FE15: 8E 40 43     STX $4340
03/FE18: A2 00 03     LDX #$0300
03/FE1B: 8E 42 43     STX $4342
03/FE1E: 7B           TDC 
03/FE1F: 8D 44 43     STA $4344
03/FE22: 8D 47 43     STA $4347
03/FE25: A2 20 02     LDX #$0220
03/FE28: 8E 45 43     STX $4345
03/FE2B: A9 10        LDA #$10
03/FE2D: 8D 0B 42     STA $420B
03/FE30: AF 8A F2 7E  LDA $7EF28A
03/FE34: 10 0E        BPL $FE44       ; branch if no priority order shifting
03/FE36: AF 8A F2 7E  LDA $7EF28A     ; set highest priority sprite
03/FE3A: 8D 03 21     STA $2103
03/FE3D: AF 89 F2 7E  LDA $7EF289
03/FE41: 8D 02 21     STA $2102
03/FE44: AB           PLB 
03/FE45: 6B           RTL 

; [ init hdma tables ]

03/FE46: A9 64        LDA #$64
03/FE48: 8D 3C F4     STA $F43C
03/FE4B: A9 28        LDA #$28
03/FE4D: 8D 3E F4     STA $F43E
03/FE50: A9 01        LDA #$01
03/FE52: 8D 40 F4     STA $F440
03/FE55: 9C 41 F4     STZ $F441
03/FE58: 9C 42 F4     STZ $F442
03/FE5B: 8B           PHB 
03/FE5C: 7B           TDC 
03/FE5D: 48           PHA 
03/FE5E: AB           PLB 
03/FE5F: A9 43        LDA #$43
03/FE61: 8D 00 43     STA $4300
03/FE64: 8D 10 43     STA $4310
03/FE67: 8D 20 43     STA $4320
03/FE6A: A9 0D        LDA #$0D        ; bg1 scroll
03/FE6C: 8D 01 43     STA $4301
03/FE6F: A9 0F        LDA #$0F        ; bg2 scroll
03/FE71: 8D 11 43     STA $4311
03/FE74: A9 11        LDA #$11        ; bg3 scroll
03/FE76: 8D 21 43     STA $4321
03/FE79: A2 FD 75     LDX #$75FD
03/FE7C: 8E 02 43     STX $4302
03/FE7F: A2 04 76     LDX #$7604
03/FE82: 8E 12 43     STX $4312
03/FE85: A2 0B 76     LDX #$760B
03/FE88: 8E 22 43     STX $4322
03/FE8B: A9 7E        LDA #$7E
03/FE8D: 8D 04 43     STA $4304
03/FE90: 8D 14 43     STA $4314
03/FE93: 8D 24 43     STA $4324
03/FE96: 8D 07 43     STA $4307
03/FE99: 8D 17 43     STA $4317
03/FE9C: 8D 27 43     STA $4327
03/FE9F: A9 00        LDA #$00
03/FEA1: 8D 70 43     STA $4370
03/FEA4: A9 31        LDA #$31        ; color math
03/FEA6: 8D 71 43     STA $4371
03/FEA9: A2 3C F4     LDX #$F43C
03/FEAC: 8E 72 43     STX $4372
03/FEAF: A9 7E        LDA #$7E
03/FEB1: 8D 77 43     STA $4377
03/FEB4: 8D 74 43     STA $4374
03/FEB7: A9 87        LDA #$87        ; enable hdma
03/FEB9: 8D 0C 42     STA $420C
03/FEBC: AB           PLB 
03/FEBD: 6B           RTL 

; [ transfer color palettes to ppu ]

03/FEBE: 8B           PHB 
03/FEBF: 7B           TDC 
03/FEC0: 48           PHA 
03/FEC1: AB           PLB 
03/FEC2: 8D 21 21     STA $2121
03/FEC5: A2 02 22     LDX #$2202
03/FEC8: 8E 40 43     STX $4340
03/FECB: A2 50 ED     LDX #$ED50
03/FECE: 8E 42 43     STX $4342
03/FED1: A9 7E        LDA #$7E
03/FED3: 8D 44 43     STA $4344
03/FED6: A2 00 02     LDX #$0200
03/FED9: 8E 45 43     STX $4345
03/FEDC: A9 10        LDA #$10
03/FEDE: 8D 0B 42     STA $420B
03/FEE1: AB           PLB 
03/FEE2: 6B           RTL 

; --------------------------------------------------------------------------

04/8000: 20 08 80     JSR $8008       ; init sound/music
04/8003: 6B           RTL 

04/8004: 20 07 81     JSR $8107       ; execute sound command
04/8007: 6B           RTL 

; [ init sound/music ]

04/8008: 8B           PHB 
04/8009: 0B           PHD 
04/800A: 08           PHP 
04/800B: C2 20        REP #$20
04/800D: C2 10        REP #$10
04/800F: 48           PHA 
04/8010: DA           PHX 
04/8011: 5A           PHY 
04/8012: E2 20        SEP #$20
04/8014: A9 04        LDA #$04
04/8016: 48           PHA 
04/8017: AB           PLB 
04/8018: A2 00 1E     LDX #$1E00
04/801B: DA           PHX 
04/801C: 2B           PLD 
04/801D: E2 20        SEP #$20
04/801F: A2 00 00     LDX #$0000
04/8022: 9E 00 1E     STZ $1E00,X
04/8025: E8           INX 
04/8026: E0 00 02     CPX #$0200
04/8029: D0 F7        BNE $8022
04/802B: C2 20        REP #$20
04/802D: A9 AA BB     LDA #$BBAA
04/8030: CD 40 21     CMP $2140
04/8033: D0 FB        BNE $8030
04/8035: E2 20        SEP #$20
04/8037: A2 00 00     LDX #$0000
04/803A: BD 84 86     LDA $8684,X
04/803D: EB           XBA 
04/803E: BD 83 86     LDA $8683,X
04/8041: C2 20        REP #$20
04/8043: A8           TAY 
04/8044: E2 20        SEP #$20
04/8046: E8           INX 
04/8047: E8           INX 
04/8048: BD 83 86     LDA $8683,X
04/804B: 8D 42 21     STA $2142
04/804E: BD 84 86     LDA $8684,X
04/8051: 8D 43 21     STA $2143
04/8054: A9 01        LDA #$01
04/8056: 8D 41 21     STA $2141
04/8059: E8           INX 
04/805A: E8           INX 
04/805B: A9 CC        LDA #$CC
04/805D: 8D 40 21     STA $2140
04/8060: CD 40 21     CMP $2140
04/8063: D0 FB        BNE $8060
04/8065: 64 08        STZ $08
04/8067: BD 83 86     LDA $8683,X
04/806A: 8D 41 21     STA $2141
04/806D: A5 08        LDA $08
04/806F: 8D 40 21     STA $2140
04/8072: E6 08        INC $08
04/8074: CD 40 21     CMP $2140
04/8077: D0 FB        BNE $8074
04/8079: E8           INX 
04/807A: 88           DEY 
04/807B: D0 EA        BNE $8067
04/807D: E6 08        INC $08
04/807F: E6 08        INC $08
04/8081: E6 08        INC $08
04/8083: C2 20        REP #$20
04/8085: BD 83 86     LDA $8683,X
04/8088: E8           INX 
04/8089: E8           INX 
04/808A: A8           TAY 
04/808B: F0 23        BEQ $80B0
04/808D: E2 20        SEP #$20
04/808F: BD 83 86     LDA $8683,X
04/8092: 8D 42 21     STA $2142
04/8095: BD 84 86     LDA $8684,X
04/8098: 8D 43 21     STA $2143
04/809B: A9 01        LDA #$01
04/809D: 8D 41 21     STA $2141
04/80A0: E8           INX 
04/80A1: E8           INX 
04/80A2: A5 08        LDA $08
04/80A4: 8D 40 21     STA $2140
04/80A7: CD 40 21     CMP $2140
04/80AA: D0 FB        BNE $80A7
04/80AC: 64 08        STZ $08
04/80AE: 80 B7        BRA $8067
04/80B0: E2 20        SEP #$20
04/80B2: BD 83 86     LDA $8683,X
04/80B5: 8D 42 21     STA $2142
04/80B8: BD 84 86     LDA $8684,X
04/80BB: 8D 43 21     STA $2143
04/80BE: A9 00        LDA #$00
04/80C0: 8D 41 21     STA $2141
04/80C3: A5 08        LDA $08
04/80C5: 8D 40 21     STA $2140
04/80C8: CD 40 21     CMP $2140
04/80CB: D0 FB        BNE $80C8
04/80CD: 9C 40 21     STZ $2140
04/80D0: E2 20        SEP #$20
04/80D2: A2 00 00     LDX #$0000
04/80D5: 74 40        STZ $40,X
04/80D7: 74 60        STZ $60,X
04/80D9: 74 80        STZ $80,X
04/80DB: E8           INX 
04/80DC: E0 20 00     CPX #$0020
04/80DF: D0 F4        BNE $80D5
04/80E1: 64 00        STZ $00
04/80E3: 64 01        STZ $01
04/80E5: 64 02        STZ $02
04/80E7: 64 03        STZ $03
04/80E9: 64 04        STZ $04
04/80EB: 64 05        STZ $05
04/80ED: 64 06        STZ $06
04/80EF: 64 07        STZ $07
04/80F1: A2 00 30     LDX #$3000
04/80F4: 86 60        STX $60
04/80F6: A2 00 08     LDX #$0800
04/80F9: CA           DEX 
04/80FA: D0 FD        BNE $80F9
04/80FC: C2 10        REP #$10
04/80FE: 7A           PLY 
04/80FF: FA           PLX 
04/8100: C2 20        REP #$20
04/8102: 68           PLA 
04/8103: 28           PLP 
04/8104: 2B           PLD 
04/8105: AB           PLB 
04/8106: 60           RTS 

; [ execute sound command ]

04/8107: 8B           PHB 
04/8108: 0B           PHD 
04/8109: 08           PHP 
04/810A: C2 20        REP #$20
04/810C: C2 10        REP #$10
04/810E: 48           PHA 
04/810F: DA           PHX 
04/8110: 5A           PHY 
04/8111: E2 20        SEP #$20
04/8113: A9 04        LDA #$04
04/8115: 48           PHA 
04/8116: AB           PLB 
04/8117: A2 00 1E     LDX #$1E00
04/811A: DA           PHX 
04/811B: 2B           PLD 
04/811C: E2 20        SEP #$20
04/811E: A5 00        LDA $00
04/8120: F0 38        BEQ $815A
04/8122: C9 01        CMP #$01
04/8124: D0 05        BNE $812B
04/8126: 20 6F 81     JSR $816F
04/8129: 80 2F        BRA $815A
04/812B: C9 02        CMP #$02
04/812D: D0 05        BNE $8134
04/812F: 20 E1 85     JSR $85E1
04/8132: 80 26        BRA $815A
04/8134: C9 03        CMP #$03
04/8136: D0 05        BNE $813D
04/8138: 20 6F 81     JSR $816F
04/813B: 80 1D        BRA $815A
04/813D: C9 04        CMP #$04
04/813F: D0 05        BNE $8146
04/8141: 20 6F 81     JSR $816F
04/8144: 80 14        BRA $815A
04/8146: C9 10        CMP #$10
04/8148: 90 09        BCC $8153
04/814A: C9 1F        CMP #$1F
04/814C: B0 05        BCS $8153
04/814E: 20 08 86     JSR $8608
04/8151: 80 07        BRA $815A
04/8153: C9 80        CMP #$80
04/8155: 90 03        BCC $815A
04/8157: 20 1E 86     JSR $861E
04/815A: E2 20        SEP #$20
04/815C: 64 00        STZ $00
04/815E: 64 01        STZ $01
04/8160: 64 02        STZ $02
04/8162: 64 03        STZ $03
04/8164: C2 10        REP #$10
04/8166: 7A           PLY 
04/8167: FA           PLX 
04/8168: C2 20        REP #$20
04/816A: 68           PLA 
04/816B: 28           PLP 
04/816C: 2B           PLD 
04/816D: AB           PLB 
04/816E: 60           RTS 

; [ play song ]

04/816F: E2 20        SEP #$20
04/8171: 85 08        STA $08
04/8173: 85 04        STA $04
04/8175: A9 00        LDA #$00
04/8177: EB           XBA 
04/8178: A5 01        LDA $01
04/817A: C5 05        CMP $05
04/817C: D0 01        BNE $817F       ; branch if song isn't playing
04/817E: 60           RTS 
04/817F: E2 20        SEP #$20
04/8181: 85 05        STA $05
04/8183: 8D 02 42     STA $4202       ; multiply by 3
04/8186: A9 03        LDA #$03
04/8188: 8D 03 42     STA $4203
04/818B: AD 00 C0     LDA $C000       ; pointer to song script pointer table
04/818E: 85 20        STA $20
04/8190: AD 01 C0     LDA $C001
04/8193: 85 21        STA $21
04/8195: AD 02 C0     LDA $C002
04/8198: 85 22        STA $22
04/819A: 20 4E 86     JSR $864E       ; add pointer offset
04/819D: A5 20        LDA $20
04/819F: 85 10        STA $10
04/81A1: A5 21        LDA $21
04/81A3: 85 11        STA $11
04/81A5: A5 22        LDA $22
04/81A7: 85 12        STA $12
04/81A9: A5 22        LDA $22
04/81AB: 85 12        STA $12
04/81AD: C2 20        REP #$20
04/81AF: A5 20        LDA $20
04/81B1: 18           CLC 
04/81B2: 6D 16 42     ADC $4216       ; song id * 3
04/81B5: 90 05        BCC $81BC
04/81B7: E6 12        INC $12
04/81B9: E9 00 80     SBC #$8000
04/81BC: 85 10        STA $10
04/81BE: E2 20        SEP #$20
04/81C0: A7 10        LDA [$10]       ; pointer to song script
04/81C2: 85 20        STA $20
04/81C4: A4 10        LDY $10
04/81C6: C8           INY 
04/81C7: D0 05        BNE $81CE
04/81C9: E6 12        INC $12
04/81CB: A0 00 80     LDY #$8000
04/81CE: 84 10        STY $10
04/81D0: A7 10        LDA [$10]
04/81D2: 85 21        STA $21
04/81D4: A4 10        LDY $10
04/81D6: C8           INY 
04/81D7: D0 05        BNE $81DE
04/81D9: E6 12        INC $12
04/81DB: A0 00 80     LDY #$8000
04/81DE: 84 10        STY $10
04/81E0: A7 10        LDA [$10]
04/81E2: 85 22        STA $22
04/81E4: 20 4E 86     JSR $864E       ; add pointer offset
04/81E7: A5 20        LDA $20
04/81E9: 85 10        STA $10
04/81EB: A5 21        LDA $21
04/81ED: 85 11        STA $11
04/81EF: A5 22        LDA $22
04/81F1: 85 12        STA $12
04/81F3: A7 10        LDA [$10]       ; song script length
04/81F5: EB           XBA 
04/81F6: A4 10        LDY $10
04/81F8: C8           INY 
04/81F9: D0 05        BNE $8200
04/81FB: E6 12        INC $12
04/81FD: A0 00 80     LDY #$8000
04/8200: 84 10        STY $10
04/8202: A7 10        LDA [$10]
04/8204: EB           XBA 
04/8205: A4 10        LDY $10
04/8207: C8           INY 
04/8208: D0 05        BNE $820F
04/820A: E6 12        INC $12
04/820C: A0 00 80     LDY #$8000
04/820F: 84 10        STY $10
04/8211: C2 20        REP #$20
04/8213: AA           TAX 
04/8214: E2 20        SEP #$20
04/8216: A7 10        LDA [$10]       ; transfer song script to spc
04/8218: 8D 42 21     STA $2142
04/821B: A5 08        LDA $08
04/821D: 8D 40 21     STA $2140
04/8220: A4 10        LDY $10
04/8222: C8           INY 
04/8223: D0 05        BNE $822A
04/8225: E6 12        INC $12
04/8227: A0 00 80     LDY #$8000
04/822A: 84 10        STY $10
04/822C: E6 08        INC $08
04/822E: D0 02        BNE $8232
04/8230: E6 08        INC $08
04/8232: CD 40 21     CMP $2140
04/8235: D0 FB        BNE $8232
04/8237: CA           DEX 
04/8238: D0 DC        BNE $8216
04/823A: AD 06 C0     LDA $C006       ; pointer to samples used in each song
04/823D: 85 20        STA $20
04/823F: AD 07 C0     LDA $C007
04/8242: 85 21        STA $21
04/8244: AD 08 C0     LDA $C008
04/8247: 85 22        STA $22
04/8249: 20 4E 86     JSR $864E       ; add pointer offset
04/824C: A5 20        LDA $20
04/824E: 85 10        STA $10
04/8250: A5 21        LDA $21
04/8252: 85 11        STA $11
04/8254: A5 22        LDA $22
04/8256: 85 12        STA $12
04/8258: A9 00        LDA #$00
04/825A: EB           XBA 
04/825B: A5 01        LDA $01
04/825D: C2 20        REP #$20
04/825F: 0A           ASL 
04/8260: 0A           ASL 
04/8261: 0A           ASL 
04/8262: 0A           ASL 
04/8263: 0A           ASL 
04/8264: 18           CLC 
04/8265: 65 10        ADC $10
04/8267: 90 05        BCC $826E
04/8269: E6 12        INC $12
04/826B: E9 00 80     SBC #$8000
04/826E: 85 10        STA $10
04/8270: A2 00 00     LDX #$0000
04/8273: E2 20        SEP #$20
04/8275: A7 10        LDA [$10]       ; samples used
04/8277: 95 C0        STA $C0,X
04/8279: 95 E0        STA $E0,X
04/827B: A4 10        LDY $10
04/827D: C8           INY 
04/827E: D0 05        BNE $8285
04/8280: E6 12        INC $12
04/8282: A0 00 80     LDY #$8000
04/8285: 84 10        STY $10
04/8287: A7 10        LDA [$10]
04/8289: 95 C1        STA $C1,X
04/828B: 95 E1        STA $E1,X
04/828D: A4 10        LDY $10
04/828F: C8           INY 
04/8290: D0 05        BNE $8297
04/8292: E6 12        INC $12
04/8294: A0 00 80     LDY #$8000
04/8297: 84 10        STY $10
04/8299: A9 00        LDA #$00
04/829B: 95 A0        STA $A0,X
04/829D: 95 A1        STA $A1,X
04/829F: E8           INX 
04/82A0: E8           INX 
04/82A1: E0 20 00     CPX #$0020
04/82A4: D0 CF        BNE $8275
04/82A6: A0 00 00     LDY #$0000
04/82A9: C2 20        REP #$20
04/82AB: B9 40 1E     LDA $1E40,Y
04/82AE: F0 1F        BEQ $82CF
04/82B0: A2 00 00     LDX #$0000
04/82B3: D5 E0        CMP $E0,X
04/82B5: F0 09        BEQ $82C0
04/82B7: E8           INX 
04/82B8: E8           INX 
04/82B9: E0 20 00     CPX #$0020
04/82BC: D0 F5        BNE $82B3
04/82BE: 80 08        BRA $82C8
04/82C0: 99 A0 1E     STA $1EA0,Y
04/82C3: A9 00 00     LDA #$0000
04/82C6: 95 E0        STA $E0,X
04/82C8: C8           INY 
04/82C9: C8           INY 
04/82CA: C0 20 00     CPY #$0020
04/82CD: D0 DC        BNE $82AB
04/82CF: A9 00 00     LDA #$0000
04/82D2: 8D 41 21     STA $2141
04/82D5: 98           TYA 
04/82D6: F0 2A        BEQ $8302
04/82D8: A2 00 00     LDX #$0000
04/82DB: A9 00 00     LDA #$0000
04/82DE: 18           CLC 
04/82DF: 75 E0        ADC $E0,X
04/82E1: E8           INX 
04/82E2: E8           INX 
04/82E3: E0 20 00     CPX #$0020
04/82E6: D0 F7        BNE $82DF
04/82E8: AA           TAX 
04/82E9: D0 2E        BNE $8319
04/82EB: E2 20        SEP #$20
04/82ED: A9 FF        LDA #$FF        ; no transfer needed
04/82EF: 8D 41 21     STA $2141
04/82F2: A9 00        LDA #$00
04/82F4: 8D 40 21     STA $2140
04/82F7: CD 40 21     CMP $2140
04/82FA: D0 FB        BNE $82F7
04/82FC: 1A           INC 
04/82FD: 85 08        STA $08
04/82FF: 4C CA 84     JMP $84CA
04/8302: E2 20        SEP #$20
04/8304: A9 11        LDA #$11
04/8306: 8D 41 21     STA $2141
04/8309: A9 00        LDA #$00
04/830B: 8D 40 21     STA $2140
04/830E: CD 40 21     CMP $2140
04/8311: D0 FB        BNE $830E
04/8313: 1A           INC 
04/8314: 85 08        STA $08
04/8316: 4C A3 83     JMP $83A3
04/8319: C2 20        REP #$20
04/831B: 64 08        STZ $08
04/831D: A2 00 00     LDX #$0000
04/8320: B5 A0        LDA $A0,X
04/8322: F0 0A        BEQ $832E
04/8324: E8           INX 
04/8325: E8           INX 
04/8326: E0 20 00     CPX #$0020
04/8329: D0 F5        BNE $8320
04/832B: 4C A3 83     JMP $83A3
04/832E: 9B           TXY 
04/832F: E8           INX 
04/8330: E8           INX 
04/8331: B5 A0        LDA $A0,X
04/8333: D0 0F        BNE $8344
04/8335: E8           INX 
04/8336: E8           INX 
04/8337: E0 20 00     CPX #$0020
04/833A: D0 F5        BNE $8331
04/833C: B9 60 1E     LDA $1E60,Y
04/833F: 8D 42 21     STA $2142
04/8342: 80 4C        BRA $8390
04/8344: 99 40 1E     STA $1E40,Y
04/8347: B5 60        LDA $60,X
04/8349: 8D 42 21     STA $2142
04/834C: A5 08        LDA $08
04/834E: 8D 40 21     STA $2140
04/8351: E6 08        INC $08
04/8353: CD 40 21     CMP $2140
04/8356: D0 FB        BNE $8353
04/8358: B5 80        LDA $80,X
04/835A: 99 80 1E     STA $1E80,Y
04/835D: 18           CLC 
04/835E: 79 60 1E     ADC $1E60,Y
04/8361: 99 62 1E     STA $1E62,Y
04/8364: B9 60 1E     LDA $1E60,Y
04/8367: 8D 42 21     STA $2142
04/836A: A5 08        LDA $08
04/836C: 8D 40 21     STA $2140
04/836F: E6 08        INC $08
04/8371: CD 40 21     CMP $2140
04/8374: D0 FB        BNE $8371
04/8376: B5 80        LDA $80,X
04/8378: 8D 42 21     STA $2142
04/837B: A5 08        LDA $08
04/837D: 8D 40 21     STA $2140
04/8380: E6 08        INC $08
04/8382: CD 40 21     CMP $2140
04/8385: D0 FB        BNE $8382
04/8387: C8           INY 
04/8388: C8           INY 
04/8389: A9 00 00     LDA #$0000
04/838C: 95 A0        STA $A0,X
04/838E: 80 A5        BRA $8335
04/8390: E2 20        SEP #$20
04/8392: A9 22        LDA #$22
04/8394: 8D 41 21     STA $2141
04/8397: A5 08        LDA $08
04/8399: 8D 40 21     STA $2140
04/839C: E6 08        INC $08
04/839E: CD 40 21     CMP $2140
04/83A1: D0 FB        BNE $839E
04/83A3: E2 20        SEP #$20
04/83A5: 84 0A        STY $0A
04/83A7: AD 03 C0     LDA $C003       ; pointer to sample pointer table
04/83AA: 85 20        STA $20
04/83AC: AD 04 C0     LDA $C004
04/83AF: 85 21        STA $21
04/83B1: AD 05 C0     LDA $C005
04/83B4: 85 22        STA $22
04/83B6: 20 4E 86     JSR $864E       ; add pointer offset
04/83B9: A5 20        LDA $20
04/83BB: 85 10        STA $10
04/83BD: A5 21        LDA $21
04/83BF: 85 11        STA $11
04/83C1: A5 22        LDA $22
04/83C3: 85 12        STA $12
04/83C5: A0 00 00     LDY #$0000
; start of sample transfer loop
04/83C8: C2 20        REP #$20
04/83CA: B9 E0 1E     LDA $1EE0,Y
04/83CD: D0 0A        BNE $83D9       ; branch if sample is used
04/83CF: C8           INY 
04/83D0: C8           INY 
04/83D1: C0 20 00     CPY #$0020
04/83D4: 90 F2        BCC $83C8
04/83D6: 4C B6 84     JMP $84B6
04/83D9: C8           INY 
04/83DA: C8           INY 
04/83DB: 5A           PHY 
04/83DC: 85 28        STA $28
04/83DE: E2 20        SEP #$20
04/83E0: 8D 02 42     STA $4202
04/83E3: A9 03        LDA #$03
04/83E5: 8D 03 42     STA $4203
04/83E8: A5 12        LDA $12
04/83EA: 85 15        STA $15
04/83EC: C2 20        REP #$20
04/83EE: A5 10        LDA $10
04/83F0: 18           CLC 
04/83F1: 6D 16 42     ADC $4216       ; sample id * 3
04/83F4: 90 05        BCC $83FB
04/83F6: E6 15        INC $15
04/83F8: E9 00 80     SBC #$8000
04/83FB: 85 13        STA $13
04/83FD: E2 20        SEP #$20
04/83FF: A7 13        LDA [$13]
04/8401: 85 20        STA $20
04/8403: A4 13        LDY $13
04/8405: C8           INY 
04/8406: D0 05        BNE $840D
04/8408: E6 15        INC $15
04/840A: A0 00 80     LDY #$8000
04/840D: 84 13        STY $13
04/840F: A7 13        LDA [$13]
04/8411: 85 21        STA $21
04/8413: A4 13        LDY $13
04/8415: C8           INY 
04/8416: D0 05        BNE $841D
04/8418: E6 15        INC $15
04/841A: A0 00 80     LDY #$8000
04/841D: 84 13        STY $13
04/841F: A7 13        LDA [$13]
04/8421: 85 22        STA $22
04/8423: 20 4E 86     JSR $864E       ; add pointer offset
04/8426: A5 20        LDA $20
04/8428: 85 18        STA $18
04/842A: A5 21        LDA $21
04/842C: 85 19        STA $19
04/842E: A5 22        LDA $22
04/8430: 85 1A        STA $1A
04/8432: A7 18        LDA [$18]
04/8434: EB           XBA 
04/8435: A4 18        LDY $18
04/8437: C8           INY 
04/8438: D0 05        BNE $843F
04/843A: E6 1A        INC $1A
04/843C: A0 00 80     LDY #$8000
04/843F: 84 18        STY $18
04/8441: A7 18        LDA [$18]
04/8443: EB           XBA 
04/8444: A4 18        LDY $18
04/8446: C8           INY 
04/8447: D0 05        BNE $844E
04/8449: E6 1A        INC $1A
04/844B: A0 00 80     LDY #$8000
04/844E: 84 18        STY $18
04/8450: C2 20        REP #$20
04/8452: AA           TAX 
04/8453: A4 0A        LDY $0A
04/8455: 99 80 1E     STA $1E80,Y
04/8458: 18           CLC 
04/8459: 79 60 1E     ADC $1E60,Y
04/845C: 99 62 1E     STA $1E62,Y
04/845F: A5 28        LDA $28
04/8461: 99 40 1E     STA $1E40,Y
04/8464: C8           INY 
04/8465: C8           INY 
04/8466: 84 0A        STY $0A
04/8468: E2 20        SEP #$20
04/846A: A7 18        LDA [$18]       ; transfer sample brr data to spc
04/846C: 8D 41 21     STA $2141
04/846F: A4 18        LDY $18
04/8471: C8           INY 
04/8472: D0 05        BNE $8479
04/8474: E6 1A        INC $1A
04/8476: A0 00 80     LDY #$8000
04/8479: 84 18        STY $18
04/847B: A7 18        LDA [$18]
04/847D: 8D 42 21     STA $2142
04/8480: A4 18        LDY $18
04/8482: C8           INY 
04/8483: D0 05        BNE $848A
04/8485: E6 1A        INC $1A
04/8487: A0 00 80     LDY #$8000
04/848A: 84 18        STY $18
04/848C: A7 18        LDA [$18]
04/848E: 8D 43 21     STA $2143
04/8491: A4 18        LDY $18
04/8493: C8           INY 
04/8494: D0 05        BNE $849B
04/8496: E6 1A        INC $1A
04/8498: A0 00 80     LDY #$8000
04/849B: 84 18        STY $18
04/849D: A5 08        LDA $08
04/849F: 8D 40 21     STA $2140
04/84A2: E6 08        INC $08
04/84A4: D0 02        BNE $84A8
04/84A6: E6 08        INC $08
04/84A8: CD 40 21     CMP $2140
04/84AB: D0 FB        BNE $84A8
04/84AD: CA           DEX 
04/84AE: CA           DEX 
04/84AF: CA           DEX 
04/84B0: D0 B8        BNE $846A
04/84B2: 7A           PLY 
04/84B3: 4C C8 83     JMP $83C8
04/84B6: A6 0A        LDX $0A
04/84B8: C2 20        REP #$20
04/84BA: A9 00 00     LDA #$0000
04/84BD: 80 04        BRA $84C3
04/84BF: 95 40        STA $40,X
04/84C1: E8           INX 
04/84C2: E8           INX 
04/84C3: E0 20 00     CPX #$0020
04/84C6: D0 F7        BNE $84BF
04/84C8: 64 08        STZ $08
04/84CA: E2 20        SEP #$20
04/84CC: AD 09 C0     LDA $C009       ; pointer to sample loop start values
04/84CF: 85 20        STA $20
04/84D1: AD 0A C0     LDA $C00A
04/84D4: 85 21        STA $21
04/84D6: AD 0B C0     LDA $C00B
04/84D9: 85 22        STA $22
04/84DB: 20 4E 86     JSR $864E       ; add pointer offset
04/84DE: A5 20        LDA $20
04/84E0: 85 10        STA $10
04/84E2: A5 21        LDA $21
04/84E4: 85 11        STA $11
04/84E6: A5 22        LDA $22
04/84E8: 85 12        STA $12
04/84EA: A0 00 00     LDY #$0000
; start of sample pointer transfer loop
04/84ED: C2 20        REP #$20
04/84EF: B9 C0 1E     LDA $1EC0,Y
04/84F2: D0 03        BNE $84F7
04/84F4: 4C 7C 85     JMP $857C
04/84F7: 5A           PHY 
04/84F8: A6 11        LDX $11
04/84FA: 86 19        STX $19
04/84FC: A2 00 00     LDX #$0000
04/84FF: D5 40        CMP $40,X
04/8501: F0 04        BEQ $8507
04/8503: E8           INX 
04/8504: E8           INX 
04/8505: 80 F8        BRA $84FF
04/8507: 0A           ASL 
04/8508: 0A           ASL 
04/8509: 18           CLC 
04/850A: 65 10        ADC $10
04/850C: 90 05        BCC $8513
04/850E: E6 1A        INC $1A
04/8510: E9 00 80     SBC #$8000
04/8513: 85 18        STA $18
04/8515: E2 20        SEP #$20
04/8517: A7 18        LDA [$18]       ; sample start (always zero)
04/8519: EB           XBA 
04/851A: A4 18        LDY $18
04/851C: C8           INY 
04/851D: D0 05        BNE $8524
04/851F: E6 1A        INC $1A
04/8521: A0 00 80     LDY #$8000
04/8524: 84 18        STY $18
04/8526: A7 18        LDA [$18]
04/8528: EB           XBA 
04/8529: A4 18        LDY $18
04/852B: C8           INY 
04/852C: D0 05        BNE $8533
04/852E: E6 1A        INC $1A
04/8530: A0 00 80     LDY #$8000
04/8533: 84 18        STY $18
04/8535: C2 20        REP #$20
04/8537: 18           CLC 
04/8538: 75 60        ADC $60,X       ; add to sample offset
04/853A: 8D 42 21     STA $2142       ; transfer sample pointers to spc
04/853D: A5 08        LDA $08
04/853F: 8D 40 21     STA $2140
04/8542: E6 08        INC $08
04/8544: CD 40 21     CMP $2140
04/8547: D0 FB        BNE $8544
04/8549: E2 20        SEP #$20
04/854B: A7 18        LDA [$18]       ; loop start
04/854D: EB           XBA 
04/854E: A4 18        LDY $18
04/8550: C8           INY 
04/8551: D0 05        BNE $8558
04/8553: E6 1A        INC $1A
04/8555: A0 00 80     LDY #$8000
04/8558: 84 18        STY $18
04/855A: A7 18        LDA [$18]
04/855C: EB           XBA 
04/855D: C2 20        REP #$20
04/855F: 18           CLC 
04/8560: 75 60        ADC $60,X
04/8562: 8D 42 21     STA $2142
04/8565: A5 08        LDA $08
04/8567: 8D 40 21     STA $2140
04/856A: E6 08        INC $08
04/856C: CD 40 21     CMP $2140
04/856F: D0 FB        BNE $856C
04/8571: 7A           PLY 
04/8572: C8           INY 
04/8573: C8           INY 
04/8574: C0 20 00     CPY #$0020
04/8577: F0 03        BEQ $857C
04/8579: 4C ED 84     JMP $84ED
04/857C: 64 08        STZ $08
04/857E: E2 20        SEP #$20
04/8580: AD 0C C0     LDA $C00C       ; pointer to frequency multipliers
04/8583: 85 20        STA $20
04/8585: AD 0D C0     LDA $C00D
04/8588: 85 21        STA $21
04/858A: AD 0E C0     LDA $C00E
04/858D: 85 22        STA $22
04/858F: 20 4E 86     JSR $864E       ; add pointer offset
04/8592: A5 20        LDA $20
04/8594: 85 10        STA $10
04/8596: A5 21        LDA $21
04/8598: 85 11        STA $11
04/859A: A5 22        LDA $22
04/859C: 85 12        STA $12
04/859E: A2 00 00     LDX #$0000
04/85A1: C2 20        REP #$20
; start of frequency multiplier transfer loop
04/85A3: A5 11        LDA $11
04/85A5: 85 19        STA $19
04/85A7: BD C0 1E     LDA $1EC0,X
04/85AA: F0 24        BEQ $85D0
04/85AC: 18           CLC 
04/85AD: 65 10        ADC $10
04/85AF: 90 05        BCC $85B6
04/85B1: E6 1A        INC $1A
04/85B3: E9 00 80     SBC #$8000
04/85B6: 85 18        STA $18
04/85B8: A7 18        LDA [$18]       ; transfer sample frequency multipliers to spc
04/85BA: 8D 42 21     STA $2142
04/85BD: A5 08        LDA $08
04/85BF: 8D 40 21     STA $2140
04/85C2: E6 08        INC $08
04/85C4: CD 40 21     CMP $2140
04/85C7: D0 FB        BNE $85C4
04/85C9: E8           INX 
04/85CA: E8           INX 
04/85CB: E0 20 00     CPX #$0020
04/85CE: D0 D3        BNE $85A3
04/85D0: A5 08        LDA $08
04/85D2: 8D 40 21     STA $2140
04/85D5: CD 40 21     CMP $2140
04/85D8: D0 FB        BNE $85D5
04/85DA: A9 00 00     LDA #$0000
04/85DD: 8D 40 21     STA $2140
04/85E0: 60           RTS 

; [ play game sound effect ]

04/85E1: E2 20        SEP #$20
04/85E3: A5 03        LDA $03
04/85E5: 8D 43 21     STA $2143
04/85E8: A5 02        LDA $02
04/85EA: 8D 42 21     STA $2142
04/85ED: A5 01        LDA $01
04/85EF: 8D 41 21     STA $2141
04/85F2: A5 00        LDA $00
04/85F4: 8D 40 21     STA $2140
04/85F7: CD 40 21     CMP $2140
04/85FA: D0 FB        BNE $85F7
04/85FC: 9C 40 21     STZ $2140
04/85FF: 64 00        STZ $00
04/8601: 64 01        STZ $01
04/8603: 64 02        STZ $02
04/8605: 64 03        STZ $03
04/8607: 60           RTS 

; [ play system sound effect ]

04/8608: E2 20        SEP #$20
04/860A: 8D 40 21     STA $2140
04/860D: CD 40 21     CMP $2140
04/8610: D0 FB        BNE $860D
04/8612: 9C 40 21     STZ $2140
04/8615: 64 00        STZ $00
04/8617: 64 01        STZ $01
04/8619: 64 02        STZ $02
04/861B: 64 03        STZ $03
04/861D: 60           RTS 

; [ sound interrupt ]

04/861E: E2 20        SEP #$20
04/8620: A5 01        LDA $01
04/8622: 8D 41 21     STA $2141
04/8625: A5 02        LDA $02
04/8627: 8D 42 21     STA $2142
04/862A: A5 03        LDA $03
04/862C: 8D 43 21     STA $2143
04/862F: A5 00        LDA $00
04/8631: 8D 40 21     STA $2140
04/8634: CD 40 21     CMP $2140
04/8637: D0 FB        BNE $8634
04/8639: 9C 40 21     STZ $2140
04/863C: 9C 41 21     STZ $2141
04/863F: 9C 42 21     STZ $2142
04/8642: 9C 43 21     STZ $2143
04/8645: 64 00        STZ $00
04/8647: 64 01        STZ $01
04/8649: 64 02        STZ $02
04/864B: 64 03        STZ $03
04/864D: 60           RTS 

; [ add pointer offset ]

04/864E: 08           PHP 
04/864F: C2 20        REP #$20
04/8651: A5 21        LDA $21
04/8653: C9 40 00     CMP #$0040
04/8656: B0 05        BCS $865D
04/8658: 69 C0 04     ADC #$04C0      ; add 04/C000
04/865B: 80 22        BRA $867F
04/865D: C9 C0 00     CMP #$00C0
04/8660: B0 05        BCS $8667
04/8662: 69 40 05     ADC #$0540      ; add 05/4000
04/8665: 80 18        BRA $867F
04/8667: C9 40 01     CMP #$0140
04/866A: B0 05        BCS $8671
04/866C: 69 C0 05     ADC #$05C0      ; add 05/C000
04/866F: 80 0E        BRA $867F
04/8671: C9 C0 01     CMP #$01C0
04/8674: B0 05        BCS $867B
04/8676: 69 40 06     ADC #$0640      ; add 06/4000
04/8679: 80 04        BRA $867F
04/867B: 18           CLC 
04/867C: 69 C0 06     ADC #$06C0
04/867F: 85 21        STA $21
04/8681: 28           PLP 
04/8682: 60           RTS 

; --------------------------------------------------------------------------

; battle message durations (in frames, based on battle message speed)
0D/F800: 0020 0040 0060 0080 00A0 00C0

0D/F80C: C0 C2 8E C2 C0 C2 8E C2 8E 8C 8E 8C 8E 8C 8E 8C
0D/F81C: 3F 7F 7F FF BF 3F 3F BF 3F 3F 3F 3F 3F 3F 3F 3F
0D/F82C: 00 0D 00 0D 00 0D 00 0D 00 ED 00 ED 00 ED 00 ED

; battle character sprite frame data
0D/F83C: 00 00 00 00 00 00 00 00 00 02 00 00 04 04 04 04
0D/F84C: 04 04 04 00 04 04 04 04 04 04 04 04 04 00 00 00
0D/F85C: 00 00 00 02 06

; battle character sprite data
0D/F861: 00 00 00 30 08 00 00 30 00 08 00 30 08 08 00 30
0D/F871: 00 10 00 30 08 10 00 30 00 00 00 00 00 00 00 00
0D/F881: 08 00 00 70 00 00 00 70 08 08 00 70 00 08 00 70
0D/F891: 08 10 00 70 00 10 00 70 00 00 00 00 00 00 00 00
0D/F8A1: F8 08 00 30 00 08 00 30 08 08 00 30 F8 10 00 30
0D/F8B1: 00 10 00 30 08 10 00 30 00 00 00 00 00 00 00 00
0D/F8C1: 10 08 00 70 08 08 00 70 00 08 00 70 10 10 00 70
0D/F8D1: 08 10 00 70 00 10 00 70 00 00 00 00 00 00 00 00
0D/F8E1: 04 00 00 30 0C 00 00 30 04 08 00 30 0C 08 00 30
0D/F8F1: 04 10 00 30 0C 10 00 30 00 00 00 00 00 00 00 00
0D/F901: 04 00 00 70 FC 00 00 70 04 08 00 70 FC 08 00 70
0D/F911: 04 10 00 70 FC 10 00 70 00 00 00 00 00 00 00 00
0D/F921: F8 00 00 30 00 00 00 30 08 00 00 30 F8 08 00 30
0D/F931: 00 08 00 30 08 08 00 30 00 10 00 30 08 10 00 30
0D/F941: 08 00 00 70 00 00 00 70 F8 00 00 70 08 08 00 70
0D/F951: 00 08 00 70 F8 08 00 70 00 10 00 70 F8 10 00 70

; battle character sprite tile id
0D/F961: 00 01 02 03 04 05
0D/F967: 06 07 08 09 0A 0B
0D/F96D: 00 01 02 03 0C 0D
0D/F973: 0E 0F 10 11 12 13
0D/F979: 00 01 14 03 15 0D
0D/F97F: 00 01 16 17 18 19
0D/F985: 00 1A 02 1B 1C 1D
0D/F98B: 1E 1F 20 21 22 23
0D/F991: 24 25 26 27 28 29
0D/F997: 2A 2B 2C 2D 2E 2F
0D/F99D: 39 3A 3B 3C 3D 3E
0D/F9A3: 39 3A 3F 3C 3D 3E
0D/F9A9: FF FF FF FF 40 FF
0D/F9AF: FF FF FF FF 41 FF
0D/F9B5: FF FF FF FF 42 FF
0D/F9BB: FF FF FF FF 43 FF
0D/F9C1: FF FF FF FF 44 FF
0D/F9C7: FF FF FF FF 45 FF
0D/F9CD: FF FF FF FF 46 FF
0D/F9D3: FF FF FF FF 47 48
0D/F9D9: FF FF FF FF 49 FF
0D/F9DF: FF FF FF FF 50 FF
0D/F9E5: FF FF FF FF 51 FF
0D/F9EB: FF FF FF FF 52 FF
0D/F9F1: FF FF FF FF 53 FF
0D/F9F7: FF FF FF FF 54 FF
0D/F9FD: FF FF FF FF 55 FF
0D/FA03: FF FF FF FF 56 FF
0D/FA09: FF FF FF FF 57 FF
0D/FA0F: FF FF FF FF 58 59
0D/FA15: FF FF FF FF FF FF
0D/FA1B: 00 01 02 03 06 07
0D/FA21: 08 09 0A 0B 0C 0D
0D/FA27: 08 09 0E 0B 0C 0D
0D/FA2D: 0F 10 11 12 13 14
0D/FA33: 15 16 17 18 19 1A
0D/FA39: 30 31 32 33 34 35 37 38

0D/FA41: 02 08 20 80

0D/FA45: FC F3 CF 3F

0D/FA49: 20 20 00 01 02 03 04 20 20 20 00 01 05 03 04 20
0D/FA59: 20 20 00 01 06 03 04 20 20 20 07 08 09 0A 0B 20
0D/FA69: 20 20 0C 0D 0E 0F 10 20 20 20 11 12 13 14 15 20
0D/FA79: 20 20 16 17 18 19 1A 20 20 20 1B 1C 1D 1E 1F 20

0D/FA89: FAD2 FADD FAEC FB03 FB12 FB1D FB36 FB4F
0D/FA99: FB54 FB5D FB6A FB75 FB82 FB8B FB9A FBAF
0D/FAA9: FBCA FB82 FB8B FB9A FBAF FBCA FBEB FBFA
0D/FAB9: FC0F FC2A FC4B FC5A FC63 FC74 FC89 FCA6
0D/FAC9: FCC7 FCC8 FACF

0D/FACF: 33 60 FF
0D/FAD2: 50 00 41 01 51 02 32 03 42 04 FF
0D/FADD: 50 00 41 01 51 02 32 01 42 05 23 03 33 04 FF
0D/FAEC: 50 00 41 01 51 02 32 01 42 05 23 01 33 05 14 01
0D/FAFC: 24 05 05 03 15 04 FF
0D/FB03: 32 00 23 01 33 02 14 01 24 05 05 03 15 04 FF
0D/FB12: 23 00 14 01 24 02 05 03 15 04 FF
0D/FB1D: 50 00 41 01 51 02 22 0A 32 0B 42 05 23 0C 33 0D
0D/FB2D: 14 01 24 05 05 03 15 04 FF
0D/FB36: 50 00 41 01 51 02 22 06 32 07 42 05 23 08 33 09
0D/FB46: 14 01 24 05 05 03 15 04 FF
0D/FB4F: 21 00 31 01 FF
0D/FB54: 21 00 31 01 12 02 22 03 FF
0D/FB5D: 21 00 31 01 12 02 22 03 13 04 14 05 FF
0D/FB6A: 12 02 22 03 13 04 14 05 24 06 FF
0D/FB75: 13 04 14 05 24 06 34 07 44 08 43 09 FF
0D/FB82: 40 00 50 01 41 02 51 03 FF
0D/FB8B: 40 04 50 05 31 00 41 01 51 06 32 02 42 03 FF
0D/FB9A: 40 07 50 08 31 04 41 05 51 09 22 00 32 01 42 06
0D/FBAA: 23 02 33 03 FF
0D/FBAF: 40 04 50 05 31 07 41 08 51 06 22 04 32 05 42 09
0D/FBBF: 13 00 23 01 33 06 14 02 24 03 FF
0D/FBCA: 40 07 50 08 31 04 41 05 51 09 22 07 32 08 42 06
0D/FBDA: 13 04 23 05 33 09 04 00 14 01 24 06 05 02 15 03 FF
0D/FBEB: 40 00 50 01 31 02 41 03 51 04 32 05 42 06 FF
0D/FBFA: 40 00 50 01 31 07 41 08 51 04 22 02 32 03 42 09
0D/FC0A: 23 05 33 06 FF
0D/FC0F: 40 00 50 01 31 0A 41 0B 51 04 22 07 32 08 42 0C
0D/FC1F: 13 02 23 03 33 09 14 05 24 06 FF
0D/FC2A: 40 00 50 01 31 07 41 08 51 04 22 0A 32 0B 42 09
0D/FC3A: 13 07 23 08 33 0C 04 02 14 03 24 09 05 05 15 06 FF
0D/FC4B: 13 00 23 01 04 02 14 03 24 04 05 05 15 06 FF
0D/FC5A: 40 01 50 02 41 09 51 0A FF
0D/FC63: 40 03 50 04 60 05 31 01 41 07 51 08 32 09 42 0A FF
0D/FC74: 40 01 50 02 31 01 41 02 51 0A 22 01 32 02 42 0A
0D/FC84: 23 09 33 0A FF
0D/FC89: 40 03 50 04 60 05 31 01 41 07 51 08 22 03 32 04
0D/FC99: 42 05 13 01 23 07 33 08 14 09 24 0A FF
0D/FCA6: 40 01 50 02 31 01 41 02 51 0A 22 01 32 02 42 0A
0D/FCB6: 13 03 23 04 33 05 04 01 14 07 24 08 05 09 15 0A FF
0D/FCC7: FF
0D/FCC8: 00 00 FF

battle bg properties (17 * 4 bytes)
0D/FCCB: 00 08 00 00
0D/FCCF: 01 00 03 0D
0D/FCD3: 02 00 01 00
0D/FCD7: 03 00 03 12
0D/FCDB: 04 00 04 22
0D/FCDF: 05 00 03 19
0D/FCE3: 06 00 02 00
0D/FCE7: 07 00 03 00
0D/FCEB: 07 00 03 00
0D/FCEF: 07 00 03 00
0D/FCF3: 07 00 03 00
0D/FCF7: 07 00 03 00
0D/FCFB: 07 00 03 00
0D/FCFF: 07 00 03 00
0D/FD03: 07 00 03 00
0D/FD07: 07 00 03 00
0D/FD0B: 09 0A 06 00

0D/FD0F: 00 04 08 0C 12 17 1B 1F
0D/FD17: 00 15 2A 3F 54
0D/FD1C: 60 F9 60 F9 0F 0F F6 F6
0D/FD24: 00 A0 00 98 04 03 C5 F5
0D/FD2C: 00 B8 00 C0 07 08 C5 F5
0D/FD34: 00 B0 00 D0 06 0A C5 F5
0D/FD3C: 00 E8 00 F6 0D 0E C5 F5
0D/FD44: 60 F9 60 F9 0F 0F B6 B6

0D/FD4C: 10 80 18 43 3F 00 00 00
0D/FD54: 10 80 38 50 7F 00 00 00

0D/FD5C: 00 00 80 80 C0 C0 E0 E0 F0 F0 F8 F8 FC FC FE FE FF

0D/FD6D: FD89 FD92 FD9B FDA4 FDAD FDB6 FDBF FDC8
0D/FD7D: FDD1 FDDA FDE3 FDEC FDF5 FDFE

0D/FD89: 01 00 FF 03 02 FF 05 04 FF
0D/FD92: 07 06 FF 09 08 FF 0B 0A FF
0D/FD9B: 01 00 FF 03 02 FF 0D 0C FF
0D/FDA4: 0F 0E FF 11 10 FF 13 12 FF
0D/FDAD: 01 00 FF 03 14 FF 0D 15 FF
0D/FDB6: 01 00 FF 17 16 FF 19 18 FF
0D/FDBF: 1A 00 FF 1B 02 FF 1D 1C FF
0D/FDC8: 1F 1E FF 21 20 FF 23 22 FF
0D/FDD1: 25 24 FF 27 26 FF 29 28 FF
0D/FDDA: 2B 2A FF 2D 2C FF 2F 2E FF
0D/FDE3: FF FF FF FF FF FF FF FF FF
0D/FDEC: 3A 39 FF 3C 3B FF 3E 3D FF
0D/FDF5: 32 31 30 35 34 33 38 37 FF
0D/FDFE: 30 31 32 33 34 35 FF 37 38

0D/FE07: 82 84 86 E0 82 84 86 E0

0D/FE0F: E0 86 84 82
0D/FE13: 86 88 86 AA
0D/FE17: 88 86 AA AA
0D/FE1B: A4 8A AA A4

0D/FE1F: 00 00 10 00 00 10 10 10 20 10 00 20 10 20 20 20

0D/FE2F: 30 20 10 30 20 30 30 30

0D/FE37: 4C 38 2C 20 10

0D/FE3C: 10 18 20 18 10

0D/FE41: 50 58 60 58 50

0D/FE46: 00 18 30 48 60 78

0D/FE4C: 00 55 24 3F CD CE CF D0 D1 A1 D2 BC BD C0 C0 C0 BE

; swap left and right button (xor 3)
0D/FE5D: 00 02 01 03

0D/FE61: 00 F0 EC 3D 00 00 EC BD

; bg scroll hdma properties -> $183F (32 * 6 bytes)

;  +$00: source address
;  +$02: destination address
;   $04: number of rows (8 scanlines per row)
;   $05: 0 = open, 1 = close

0D/FE69: 8092 7F42 0A 00  ; 0: scanline 140-219, 10 rows
0D/FE6F: 81B2 8062 0A 01
0D/FE75: 8312 7F42 0A 00
0D/FE7B: 8432 8062 0A 01
0D/FE81: 81D2 7F52 0A 00
0D/FE87: 82F2 8072 0A 01
0D/FE8D: 8452 7F62 05 00
0D/FE93: 84D2 7FE2 05 01
0D/FE99: 84F2 7BF2 08 00
0D/FE9F: 85D2 7CD2 08 01
0D/FEA5: 8872 7BC2 04 00
0D/FEAB: 88D2 7C22 04 01
0D/FEB1: 88F2 7BF2 04 00
0D/FEB7: 8952 7C52 04 01
0D/FEBD: 8972 7C22 04 00
0D/FEC3: 89D2 7C82 04 01
0D/FEC9: 89F2 7C52 04 00
0D/FECF: 8A52 7CB2 04 01
0D/FED5: 8A72 7C82 04 00
0D/FEDB: 8AD2 7CE2 04 01
0D/FEE1: 85F2 7BC2 04 00
0D/FEE7: 8652 7C22 04 01
0D/FEED: 8672 7BF2 04 00
0D/FEF3: 86D2 7C52 04 01
0D/FEF9: 86F2 7C22 04 00
0D/FEFF: 8752 7C82 04 01
0D/FF05: 8772 7C52 04 00
0D/FF0B: 87D2 7CB2 04 01
0D/FF11: 87F2 7C82 04 00
0D/FF17: 8852 7CE2 04 01
0D/FF1D: 8AF2 7F62 0A 00
0D/FF23: 8C12 8082 0A 01

; bg scroll hdma tables (3 * 7 bytes)
0D/FF29: F0 12 76 F0 D2 77 80
0D/FF30: F0 92 79 F0 52 7B 80
0D/FF37: F0 12 7D F0 D2 7E 80

; animation frame sizes (16 * 2 bytes)
0D/FF3E: 01 01 03 03 02 02 05 09 0C 09 10 09 04 04 04 09
0D/FF4E: 03 04 0C 01 02 03 06 09 01 02 04 09 06 09 06 06

; monster graphics sizes (43 * 2 bytes)
0D/FF5E: 02 02 04 04 04 06 06 04 06 06 06 08 08 06 08 08
0D/FF6E: 06 0C 0C 06 14 12 0A 06 05 03 02 03 03 03 04 03
0D/FF7E: 04 02 0A 08 12 0C 05 05 07 0E 0A 06 0B 07 08 05
0D/FF8E: 08 0A 04 0B 10 12 03 04 02 03 12 0D 11 08 05 09
0D/FF9E: 09 0D 0A 09 06 0A 08 0C 09 09 03 03 08 0E 0B 10
0D/FFAE: 0C 08 13 10 02 04

; flying monster y-offsets (16 * 1 byte)
0D/FFB4: 00 00 00 00 01 01 01 02 02 03 03 03 02 02 01 01

; flying monster shadow data (16 * 1 byte)
0D/FFC4: C0 C0 C0 C0 80 80 80 40 40 00 00 00 40 40 80 80

0D/FFD4: 00 1C 38 54 70

0D/FFD9: 07 03 01 00

0D/FFDD: 01 02 04 02 01 00 02 02

0D/FFE5: 00 FB F6 F3 F0 F0 F6 FA

0D/FFED: 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 06 1F

0D/FFFE: FF FF

; --------------------------------------------------------------------------

; [ play fanfare ]

; called when rydia learns a spell from a summon item

0F/C600: AD 05 1E     LDA $1E05       ; current song
0F/C603: 48           PHA 
0F/C604: A9 29        LDA #$29        ; song $29 (fanfare)
0F/C606: 20 18 C6     JSR $C618       ; play song
0F/C609: A2 4A 01     LDX #$014A      ; 330 frames (5.5 seconds)
0F/C60C: 22 86 81 01  JSL $018186     ; wait for vblank
0F/C610: CA           DEX 
0F/C611: D0 F9        BNE $C60C
0F/C613: 68           PLA 
0F/C614: 20 18 C6     JSR $C618       ; play song
0F/C617: 6B           RTL 

; [ play song ]

0F/C618: 8D 01 1E     STA $1E01
0F/C61B: A9 01        LDA #$01
0F/C61D: 8D 00 1E     STA $1E00
0F/C620: 22 04 80 04  JSL $048004     ; execute sound command
0F/C624: 60           RTS 

; pointers to character properties
0F/C625: 1000 1040 1080 10C0 1100

; --------------------------------------------------------------------------

; [ end credits ]

13/D610: C2 10        REP #$10
13/D612: E2 20        SEP #$20
13/D614: 08           PHP 
13/D615: 8B           PHB 
13/D616: 0B           PHD 
13/D617: A9 02        LDA #$02
13/D619: 8F 64 00 00  STA $000064
13/D61D: A9 20        LDA #$20
13/D61F: 8F 6A 00 00  STA $00006A
13/D623: A9 0A        LDA #$0A
13/D625: 8F 6B 00 00  STA $00006B
13/D629: 80 40        BRA $D66B

; [ solar system (moon departs) ]

13/D62B: C2 10        REP #$10
13/D62D: E2 20        SEP #$20
13/D62F: 08           PHP 
13/D630: 8B           PHB 
13/D631: 0B           PHD 
13/D632: A2 08 00     LDX #$0008
13/D635: 8E A1 00     STX $00A1
13/D638: A2 F2 FF     LDX #$FFF2
13/D63B: 8E A3 00     STX $00A3
13/D63E: A9 01        LDA #$01
13/D640: 8F 64 00 00  STA $000064
13/D644: A9 80        LDA #$80
13/D646: 8F 6A 00 00  STA $00006A
13/D64A: A9 0A        LDA #$0A
13/D64C: 8F 6B 00 00  STA $00006B
13/D650: 80 19        BRA $D66B

; [ solar system (prophecy) ]

13/D652: C2 10        REP #$10
13/D654: E2 20        SEP #$20
13/D656: 08           PHP 
13/D657: 8B           PHB 
13/D658: 0B           PHD 
13/D659: A9 00        LDA #$00
13/D65B: 8F 64 00 00  STA $000064
13/D65F: A9 E0        LDA #$E0
13/D661: 8F 6A 00 00  STA $00006A
13/D665: A9 13        LDA #$13
13/D667: 8F 6B 00 00  STA $00006B
13/D66B: 20 14 DE     JSR $DE14
13/D66E: 20 FB DD     JSR $DDFB
13/D671: 20 09 DC     JSR $DC09
13/D674: 20 B5 D8     JSR $D8B5
13/D677: 20 64 D7     JSR $D764
13/D67A: 20 30 D7     JSR $D730
13/D67D: 20 02 D8     JSR $D802
13/D680: 64 95        STZ $95
13/D682: A2 00 80     LDX #$8000
13/D685: 86 57        STX $57
13/D687: 7B           TDC 
13/D688: AA           TAX 
13/D689: 86 66        STX $66
13/D68B: A5 64        LDA $64
13/D68D: C9 01        CMP #$01
13/D68F: F0 1A        BEQ $D6AB
13/D691: C9 02        CMP #$02
13/D693: F0 08        BEQ $D69D
13/D695: 20 2D D9     JSR $D92D
13/D698: 20 4B DB     JSR $DB4B
13/D69B: 80 0E        BRA $D6AB
13/D69D: A2 50 00     LDX #$0050
13/D6A0: 86 96        STX $96
13/D6A2: 20 E9 D8     JSR $D8E9
13/D6A5: 20 5E EC     JSR $EC5E
13/D6A8: 20 4B DB     JSR $DB4B
13/D6AB: 9C 1F 7D     STZ $7D1F
13/D6AE: 9C 20 7D     STZ $7D20
13/D6B1: 9C 03 33     STZ $3303
13/D6B4: E6 63        INC $63
13/D6B6: AF 10 42 00  LDA $004210
13/D6BA: 10 FA        BPL $D6B6
13/D6BC: A9 11        LDA #$11
13/D6BE: 8D 28 7D     STA $7D28
13/D6C1: 8F 2C 21 00  STA $00212C
13/D6C5: A9 81        LDA #$81
13/D6C7: 8F 00 42 00  STA $004200     ; enable nmi
13/D6CB: 20 18 D7     JSR $D718
13/D6CE: 7B           TDC 
13/D6CF: AA           TAX 
13/D6D0: 8E 68 00     STX $0068
13/D6D3: 20 41 DF     JSR $DF41
13/D6D6: AE 68 00     LDX $0068
13/D6D9: E8           INX 
13/D6DA: 8E 68 00     STX $0068
13/D6DD: EC 6A 00     CPX $006A
13/D6E0: 90 F1        BCC $D6D3
13/D6E2: A5 64        LDA $64
13/D6E4: C9 02        CMP #$02
13/D6E6: D0 03        BNE $D6EB
13/D6E8: 4C 07 EE     JMP $EE07
13/D6EB: 20 05 D7     JSR $D705
13/D6EE: 7B           TDC 
13/D6EF: 8F 00 42 00  STA $004200     ; disable nmi and irq
13/D6F3: 8F 0B 42 00  STA $00420B
13/D6F7: 8F 0C 42 00  STA $00420C
13/D6FB: A9 80        LDA #$80
13/D6FD: 8F 00 21 00  STA $002100     ; screen off
13/D701: 2B           PLD 
13/D702: AB           PLB 
13/D703: 28           PLP 
13/D704: 6B           RTL 

; [  ]

13/D705: 64 9A        STZ $9A
13/D707: 20 41 DF     JSR $DF41
13/D70A: E6 9A        INC $9A
13/D70C: A5 9A        LDA $9A
13/D70E: 29 0F        AND #$0F
13/D710: D0 F5        BNE $D707
13/D712: CE 03 33     DEC $3303
13/D715: D0 F0        BNE $D707
13/D717: 60           RTS 

; [  ]

13/D718: 64 9A        STZ $9A
13/D71A: 20 41 DF     JSR $DF41
13/D71D: E6 9A        INC $9A
13/D71F: A5 9A        LDA $9A
13/D721: 29 0F        AND #$0F
13/D723: D0 F5        BNE $D71A
13/D725: EE 03 33     INC $3303
13/D728: AD 03 33     LDA $3303
13/D72B: C9 0F        CMP #$0F
13/D72D: D0 EB        BNE $D71A
13/D72F: 60           RTS 

; [  ]

13/D730: A5 64        LDA $64
13/D732: C9 02        CMP #$02
13/D734: D0 2D        BNE $D763
13/D736: A2 1B 00     LDX #$001B
13/D739: 8E 07 21     STX $2107
13/D73C: 8B           PHB 
13/D73D: 7B           TDC 
13/D73E: 48           PHA 
13/D73F: AB           PLB 
13/D740: A2 00 30     LDX #$3000
13/D743: 8E 16 21     STX $2116
13/D746: 7B           TDC 
13/D747: AA           TAX 
13/D748: BF 16 F0 13  LDA $13F016,X
13/D74C: 48           PHA 
13/D74D: 29 0F        AND #$0F
13/D74F: 8D 19 21     STA $2119
13/D752: 68           PLA 
13/D753: 29 F0        AND #$F0
13/D755: 4A           LSR 
13/D756: 4A           LSR 
13/D757: 4A           LSR 
13/D758: 4A           LSR 
13/D759: 8D 19 21     STA $2119
13/D75C: E8           INX 
13/D75D: E0 20 03     CPX #$0320
13/D760: D0 E6        BNE $D748
13/D762: AB           PLB 
13/D763: 60           RTS 

; [  ]

13/D764: A2 00 00     LDX #$0000
13/D767: A0 00 80     LDY #$8000
13/D76A: 20 19 DF     JSR $DF19
13/D76D: 8B           PHB 
13/D76E: 7B           TDC 
13/D76F: 48           PHA 
13/D770: AB           PLB 
13/D771: A2 00 00     LDX #$0000
13/D774: 8E 16 21     STX $2116
13/D777: 64 04        STZ $04
13/D779: A5 64        LDA $64
13/D77B: C9 01        CMP #$01
13/D77D: F0 27        BEQ $D7A6
13/D77F: C9 02        CMP #$02
13/D781: D0 04        BNE $D787
13/D783: A9 40        LDA #$40
13/D785: 85 04        STA $04
13/D787: 7B           TDC 
13/D788: AA           TAX 
13/D789: BF 01 F0 0A  LDA $0AF001,X
13/D78D: 85 00        STA $00
13/D78F: A0 08 00     LDY #$0008
13/D792: 06 00        ASL $00
13/D794: 2A           ROL 
13/D795: 29 01        AND #$01
13/D797: 8D 19 21     STA $2119
13/D79A: 88           DEY 
13/D79B: D0 F5        BNE $D792
13/D79D: E8           INX 
13/D79E: E8           INX 
13/D79F: E0 00 10     CPX #$1000
13/D7A2: D0 E5        BNE $D789
13/D7A4: AB           PLB 
13/D7A5: 60           RTS 
13/D7A6: A2 40 00     LDX #$0040
13/D7A9: 7B           TDC 
13/D7AA: 8D 19 21     STA $2119
13/D7AD: CA           DEX 
13/D7AE: D0 FA        BNE $D7AA
13/D7B0: 7B           TDC 
13/D7B1: AA           TAX 
13/D7B2: BF 40 D8 15  LDA $15D840,X
13/D7B6: 48           PHA 
13/D7B7: 29 0F        AND #$0F
13/D7B9: F0 02        BEQ $D7BD
13/D7BB: 09 10        ORA #$10
13/D7BD: 8D 19 21     STA $2119
13/D7C0: 68           PLA 
13/D7C1: 29 F0        AND #$F0
13/D7C3: F0 06        BEQ $D7CB
13/D7C5: 4A           LSR 
13/D7C6: 4A           LSR 
13/D7C7: 4A           LSR 
13/D7C8: 4A           LSR 
13/D7C9: 09 10        ORA #$10
13/D7CB: 8D 19 21     STA $2119
13/D7CE: E8           INX 
13/D7CF: E0 00 08     CPX #$0800
13/D7D2: D0 DE        BNE $D7B2
13/D7D4: AB           PLB 
13/D7D5: 60           RTS 

; [  ]

13/D7D6: 7B           TDC 
13/D7D7: 8D A0 00     STA $00A0
13/D7DA: 8F 1A 21 00  STA $00211A
13/D7DE: AA           TAX 
13/D7DF: 9F 00 80 7E  STA $7E8000,X
13/D7E3: E8           INX 
13/D7E4: E0 00 80     CPX #$8000
13/D7E7: D0 F6        BNE $D7DF
13/D7E9: A2 00 80     LDX #$8000
13/D7EC: 8E 1B 7D     STX $7D1B
13/D7EF: A2 36 F3     LDX #$F336
13/D7F2: 8E 19 7D     STX $7D19
13/D7F5: A9 13        LDA #$13
13/D7F7: 8D 1E 7D     STA $7D1E
13/D7FA: A9 20        LDA #$20
13/D7FC: 8D 1D 7D     STA $7D1D
13/D7FF: 4C CD EA     JMP $EACD

; [  ]

13/D802: A5 64        LDA $64
13/D804: C9 01        CMP #$01
13/D806: F0 26        BEQ $D82E
13/D808: C9 02        CMP #$02
13/D80A: D0 06        BNE $D812
13/D80C: 20 D6 D7     JSR $D7D6
13/D80F: 4C 5D D8     JMP $D85D
13/D812: A2 1E 3D     LDX #$3D1E
13/D815: 8E 1B 7D     STX $7D1B
13/D818: A2 C5 E9     LDX #$E9C5
13/D81B: 8E 19 7D     STX $7D19
13/D81E: A9 13        LDA #$13
13/D820: 8D 1E 7D     STA $7D1E
13/D823: A9 80        LDA #$80
13/D825: 8D 1D 7D     STA $7D1D
13/D828: 20 CD EA     JSR $EACD
13/D82B: 4C 5D D8     JMP $D85D
13/D82E: 7B           TDC 
13/D82F: AA           TAX 
13/D830: A0 19 3D     LDY #$3D19
13/D833: 84 06        STY $06
13/D835: A9 06        LDA #$06
13/D837: 85 02        STA $02
13/D839: A9 01        LDA #$01
13/D83B: 85 04        STA $04
13/D83D: 7B           TDC 
13/D83E: A8           TAY 
13/D83F: A5 04        LDA $04
13/D841: 91 06        STA ($06),Y
13/D843: E6 04        INC $04
13/D845: C8           INY 
13/D846: E8           INX 
13/D847: C0 05 00     CPY #$0005
13/D84A: D0 F3        BNE $D83F
13/D84C: C2 20        REP #$20
13/D84E: A5 06        LDA $06
13/D850: 18           CLC 
13/D851: 69 80 00     ADC #$0080
13/D854: 85 06        STA $06
13/D856: 7B           TDC 
13/D857: E2 20        SEP #$20
13/D859: C6 02        DEC $02
13/D85B: D0 E0        BNE $D83D
13/D85D: 7B           TDC 
13/D85E: 8F 15 21 00  STA $002115
13/D862: 8F 16 21 00  STA $002116
13/D866: 8F 17 21 00  STA $002117
13/D86A: AA           TAX 
13/D86B: BD 19 3D     LDA $3D19,X
13/D86E: 8F 18 21 00  STA $002118
13/D872: E8           INX 
13/D873: E0 00 40     CPX #$4000
13/D876: D0 F3        BNE $D86B
13/D878: A9 80        LDA #$80
13/D87A: 8F 15 21 00  STA $002115
13/D87E: 60           RTS 

; [  ]

13/D87F: 3E 0A 2B     ROL $2B0A,X
13/D882: 3E 09 2B     ROL $2B09,X
13/D885: 3E 08 2B     ROL $2B08,X
13/D888: 3E 07 2B     ROL $2B07,X
13/D88B: 3E 06 2B     ROL $2B06,X
13/D88E: 3E 05 2B     ROL $2B05,X
13/D891: 3E 04 2B     ROL $2B04,X
13/D894: 3E 03 2B     ROL $2B03,X
13/D897: 26 02        ROL $02
13/D899: 60           RTS 

; [  ]

13/D89A: 66 02        ROR $02
13/D89C: 7E 03 2F     ROR $2F03,X
13/D89F: 7E 04 2F     ROR $2F04,X
13/D8A2: 7E 05 2F     ROR $2F05,X
13/D8A5: 7E 06 2F     ROR $2F06,X
13/D8A8: 7E 07 2F     ROR $2F07,X
13/D8AB: 7E 08 2F     ROR $2F08,X
13/D8AE: 7E 09 2F     ROR $2F09,X
13/D8B1: 7E 0A 2F     ROR $2F0A,X
13/D8B4: 60           RTS 

; [  ]

13/D8B5: 20 47 E2     JSR $E247
13/D8B8: A2 00 CC     LDX #$CC00
13/D8BB: 86 00        STX $00
13/D8BD: A9 15        LDA #$15
13/D8BF: 85 02        STA $02
13/D8C1: 7B           TDC 
13/D8C2: AA           TAX 
13/D8C3: 86 0A        STX $0A
13/D8C5: A4 0A        LDY $0A
13/D8C7: A9 20        LDA #$20
13/D8C9: 85 08        STA $08
13/D8CB: B7 00        LDA [$00],Y
13/D8CD: 9D 03 27     STA $2703,X
13/D8D0: C2 20        REP #$20
13/D8D2: 98           TYA 
13/D8D3: 18           CLC 
13/D8D4: 69 20 00     ADC #$0020
13/D8D7: A8           TAY 
13/D8D8: 7B           TDC 
13/D8D9: E2 20        SEP #$20
13/D8DB: E8           INX 
13/D8DC: C6 08        DEC $08
13/D8DE: D0 EB        BNE $D8CB
13/D8E0: E6 0A        INC $0A
13/D8E2: A5 0A        LDA $0A
13/D8E4: C9 20        CMP #$20
13/D8E6: D0 DD        BNE $D8C5
13/D8E8: 60           RTS 

; [  ]

13/D8E9: A2 32 00     LDX #$0032
13/D8EC: 86 00        STX $00
13/D8EE: A2 00 D3     LDX #$D300
13/D8F1: A0 00 40     LDY #$4000
13/D8F4: A9 13        LDA #$13
13/D8F6: 20 FA D8     JSR $D8FA
13/D8F9: 60           RTS 

; [  ]

13/D8FA: 8B           PHB 
13/D8FB: 48           PHA 
13/D8FC: AB           PLB 
13/D8FD: 8C 16 21     STY $2116
13/D900: 86 02        STX $02
13/D902: A0 00 00     LDY #$0000
13/D905: C2 20        REP #$20
13/D907: 48           PHA 
13/D908: A2 08 00     LDX #$0008
13/D90B: B1 02        LDA ($02),Y
13/D90D: 8D 18 21     STA $2118
13/D910: C8           INY 
13/D911: C8           INY 
13/D912: CA           DEX 
13/D913: D0 F6        BNE $D90B
13/D915: A2 08 00     LDX #$0008
13/D918: 68           PLA 
13/D919: E2 20        SEP #$20
13/D91B: B1 02        LDA ($02),Y
13/D91D: 8D 18 21     STA $2118
13/D920: 9C 19 21     STZ $2119
13/D923: C8           INY 
13/D924: CA           DEX 
13/D925: D0 F4        BNE $D91B
13/D927: C6 00        DEC $00
13/D929: D0 DA        BNE $D905
13/D92B: AB           PLB 
13/D92C: 60           RTS 

; [  ]

13/D92D: A2 00 FE     LDX #$FE00
13/D930: 86 66        STX $66
13/D932: A2 00 80     LDX #$8000
13/D935: 86 53        STX $53
13/D937: A9 7E        LDA #$7E
13/D939: 85 55        STA $55
13/D93B: A2 00 00     LDX #$0000
13/D93E: DA           PHX 
13/D93F: 20 90 D9     JSR $D990
13/D942: A2 03 2F     LDX #$2F03
13/D945: 86 00        STX $00
13/D947: 7B           TDC 
13/D948: AA           TAX 
13/D949: 86 0A        STX $0A
13/D94B: A4 0A        LDY $0A
13/D94D: A9 20        LDA #$20
13/D94F: 85 08        STA $08
13/D951: B1 00        LDA ($00),Y
13/D953: 87 53        STA [$53]
13/D955: C2 20        REP #$20
13/D957: E6 53        INC $53
13/D959: 98           TYA 
13/D95A: 18           CLC 
13/D95B: 69 20 00     ADC #$0020
13/D95E: A8           TAY 
13/D95F: 7B           TDC 
13/D960: E2 20        SEP #$20
13/D962: E8           INX 
13/D963: C6 08        DEC $08
13/D965: D0 EA        BNE $D951
13/D967: E6 0A        INC $0A
13/D969: A5 0A        LDA $0A
13/D96B: C9 20        CMP #$20
13/D96D: D0 DC        BNE $D94B
13/D96F: FA           PLX 
13/D970: E8           INX 
13/D971: E0 20 00     CPX #$0020
13/D974: D0 C8        BNE $D93E
13/D976: 60           RTS 

; [  ]

13/D977: 3E 0A 27     ROL $270A,X
13/D97A: 3E 09 27     ROL $2709,X
13/D97D: 3E 08 27     ROL $2708,X
13/D980: 3E 07 27     ROL $2707,X
13/D983: 3E 06 27     ROL $2706,X
13/D986: 3E 05 27     ROL $2705,X
13/D989: 3E 04 27     ROL $2704,X
13/D98C: 3E 03 27     ROL $2703,X
13/D98F: 60           RTS 

; [  ]

13/D990: 7B           TDC 
13/D991: AA           TAX 
13/D992: 86 00        STX $00
13/D994: 64 0A        STZ $0A
13/D996: BD 03 27     LDA $2703,X
13/D999: 0A           ASL 
13/D99A: 20 77 D9     JSR $D977
13/D99D: 20 77 D9     JSR $D977
13/D9A0: C2 20        REP #$20
13/D9A2: BD 03 27     LDA $2703,X
13/D9A5: 9D 03 2B     STA $2B03,X
13/D9A8: BD 05 27     LDA $2705,X
13/D9AB: 9D 05 2B     STA $2B05,X
13/D9AE: BD 07 27     LDA $2707,X
13/D9B1: 9D 07 2B     STA $2B07,X
13/D9B4: BD 09 27     LDA $2709,X
13/D9B7: 9D 09 2B     STA $2B09,X
13/D9BA: 9E 03 2F     STZ $2F03,X
13/D9BD: 9E 05 2F     STZ $2F05,X
13/D9C0: 9E 07 2F     STZ $2F07,X
13/D9C3: 9E 08 2F     STZ $2F08,X
13/D9C6: 7B           TDC 
13/D9C7: E2 20        SEP #$20
13/D9C9: DA           PHX 
13/D9CA: A5 00        LDA $00
13/D9CC: 18           CLC 
13/D9CD: 65 01        ADC $01
13/D9CF: AA           TAX 
13/D9D0: 7B           TDC 
13/D9D1: A8           TAY 
13/D9D2: BF 57 DF 13  LDA $13DF57,X
13/D9D6: 99 42 00     STA $0042,Y
13/D9D9: E8           INX 
13/D9DA: C8           INY 
13/D9DB: C0 08 00     CPY #$0008
13/D9DE: D0 F2        BNE $D9D2
13/D9E0: FA           PLX 
13/D9E1: A9 30        LDA #$30
13/D9E3: 85 04        STA $04
13/D9E5: 20 7F D8     JSR $D87F
13/D9E8: 06 47        ASL $47
13/D9EA: 26 46        ROL $46
13/D9EC: 26 45        ROL $45
13/D9EE: 26 44        ROL $44
13/D9F0: 26 43        ROL $43
13/D9F2: 26 42        ROL $42
13/D9F4: 90 03        BCC $D9F9
13/D9F6: 20 9A D8     JSR $D89A
13/D9F9: C6 04        DEC $04
13/D9FB: D0 E8        BNE $D9E5
13/D9FD: DA           PHX 
13/D9FE: A5 00        LDA $00
13/DA00: 4A           LSR 
13/DA01: 4A           LSR 
13/DA02: 4A           LSR 
13/DA03: 85 04        STA $04
13/DA05: A5 01        LDA $01
13/DA07: 4A           LSR 
13/DA08: 4A           LSR 
13/DA09: 4A           LSR 
13/DA0A: 18           CLC 
13/DA0B: 65 04        ADC $04
13/DA0D: 29 1F        AND #$1F
13/DA0F: AA           TAX 
13/DA10: BF F2 E4 13  LDA $13E4F2,X
13/DA14: F0 20        BEQ $DA36
13/DA16: FA           PLX 
13/DA17: 85 04        STA $04
13/DA19: 5E 03 2F     LSR $2F03,X
13/DA1C: 7E 04 2F     ROR $2F04,X
13/DA1F: 7E 05 2F     ROR $2F05,X
13/DA22: 7E 06 2F     ROR $2F06,X
13/DA25: 7E 07 2F     ROR $2F07,X
13/DA28: 7E 08 2F     ROR $2F08,X
13/DA2B: 7E 09 2F     ROR $2F09,X
13/DA2E: 7E 0A 2F     ROR $2F0A,X
13/DA31: C6 04        DEC $04
13/DA33: D0 E4        BNE $DA19
13/DA35: DA           PHX 
13/DA36: A5 00        LDA $00
13/DA38: 18           CLC 
13/DA39: 69 40        ADC #$40
13/DA3B: 85 00        STA $00
13/DA3D: E6 0A        INC $0A
13/DA3F: A5 0A        LDA $0A
13/DA41: 29 07        AND #$07
13/DA43: D0 07        BNE $DA4C
13/DA45: A5 01        LDA $01
13/DA47: 18           CLC 
13/DA48: 69 08        ADC #$08
13/DA4A: 85 01        STA $01
13/DA4C: A5 0A        LDA $0A
13/DA4E: 29 3F        AND #$3F
13/DA50: D0 02        BNE $DA54
13/DA52: 64 01        STZ $01
13/DA54: FA           PLX 
13/DA55: C2 20        REP #$20
13/DA57: 8A           TXA 
13/DA58: 18           CLC 
13/DA59: 69 08 00     ADC #$0008
13/DA5C: AA           TAX 
13/DA5D: 7B           TDC 
13/DA5E: E2 20        SEP #$20
13/DA60: E0 00 04     CPX #$0400
13/DA63: F0 03        BEQ $DA68
13/DA65: 4C 96 D9     JMP $D996
13/DA68: 60           RTS 

; [  ]

13/DA69: 0A           ASL 
13/DA6A: 85 52        STA $52
13/DA6C: 80 02        BRA $DA70
13/DA6E: 64 52        STZ $52
13/DA70: A5 4F        LDA $4F
13/DA72: C2 20        REP #$20
13/DA74: 0A           ASL 
13/DA75: 0A           ASL 
13/DA76: AA           TAX 
13/DA77: A5 50        LDA $50
13/DA79: 29 FF 00     AND #$00FF
13/DA7C: 0A           ASL 
13/DA7D: 0A           ASL 
13/DA7E: A8           TAY 
13/DA7F: 7B           TDC 
13/DA80: E2 20        SEP #$20
13/DA82: A5 50        LDA $50
13/DA84: 85 30        STA $30
13/DA86: BF 60 F6 12  LDA $12F660,X
13/DA8A: 85 28        STA $28
13/DA8C: 64 29        STZ $29
13/DA8E: BF 61 F6 12  LDA $12F661,X
13/DA92: 18           CLC 
13/DA93: 65 4D        ADC $4D
13/DA95: 99 01 03     STA $0301,Y
13/DA98: C2 20        REP #$20
13/DA9A: A5 28        LDA $28
13/DA9C: 18           CLC 
13/DA9D: 65 4B        ADC $4B
13/DA9F: 29 FF 01     AND #$01FF
13/DAA2: 85 28        STA $28
13/DAA4: 7B           TDC 
13/DAA5: E2 20        SEP #$20
13/DAA7: A5 28        LDA $28
13/DAA9: 99 00 03     STA $0300,Y
13/DAAC: BF 62 F6 12  LDA $12F662,X
13/DAB0: 99 02 03     STA $0302,Y
13/DAB3: A5 52        LDA $52
13/DAB5: F0 0A        BEQ $DAC1
13/DAB7: BF 63 F6 12  LDA $12F663,X
13/DABB: 29 F1        AND #$F1
13/DABD: 05 52        ORA $52
13/DABF: 80 04        BRA $DAC5
13/DAC1: BF 63 F6 12  LDA $12F663,X
13/DAC5: 99 03 03     STA $0303,Y
13/DAC8: DA           PHX 
13/DAC9: A5 30        LDA $30
13/DACB: 4A           LSR 
13/DACC: 4A           LSR 
13/DACD: 85 2C        STA $2C
13/DACF: A5 30        LDA $30
13/DAD1: 29 03        AND #$03
13/DAD3: 85 2E        STA $2E
13/DAD5: AA           TAX 
13/DAD6: BF 0C DB 13  LDA $13DB0C,X
13/DADA: 85 2D        STA $2D
13/DADC: A5 2E        LDA $2E
13/DADE: F0 08        BEQ $DAE8
13/DAE0: 06 29        ASL $29
13/DAE2: 06 29        ASL $29
13/DAE4: C6 2E        DEC $2E
13/DAE6: D0 F8        BNE $DAE0
13/DAE8: A5 2C        LDA $2C
13/DAEA: AA           TAX 
13/DAEB: BD 00 05     LDA $0500,X
13/DAEE: 25 2D        AND $2D
13/DAF0: 05 29        ORA $29
13/DAF2: 9D 00 05     STA $0500,X
13/DAF5: FA           PLX 
13/DAF6: E6 30        INC $30
13/DAF8: E6 4F        INC $4F
13/DAFA: E6 50        INC $50
13/DAFC: E8           INX 
13/DAFD: E8           INX 
13/DAFE: E8           INX 
13/DAFF: E8           INX 
13/DB00: C8           INY 
13/DB01: C8           INY 
13/DB02: C8           INY 
13/DB03: C8           INY 
13/DB04: C6 51        DEC $51
13/DB06: F0 03        BEQ $DB0B
13/DB08: 4C 86 DA     JMP $DA86
13/DB0B: 60           RTS 

13/DB0C: FC F3 CF 3F

; [  ]

13/DB10: A2 08 00     LDX #$0008
13/DB13: 8E 80 20     STX $2080
13/DB16: 8E 82 20     STX $2082
13/DB19: A2 10 00     LDX #$0010
13/DB1C: 8E C0 20     STX $20C0
13/DB1F: 8E C2 20     STX $20C2
13/DB22: 60           RTS 

; [  ]

13/DB23: A2 20 00     LDX #$0020
13/DB26: 8E 80 20     STX $2080
13/DB29: 8E 82 20     STX $2082
13/DB2C: A2 40 00     LDX #$0040
13/DB2F: 8E C0 20     STX $20C0
13/DB32: 8E C2 20     STX $20C2
13/DB35: 60           RTS 

13/DB36: F0 19 33 F0 D9 34 00 F0 19 37 F0 D9 38 00 F0 19
13/DB46: 3B F0 F9 3B 00

; [  ]

13/DB4B: 7B           TDC 
13/DB4C: AA           TAX 
13/DB4D: BF 36 DB 13  LDA $13DB36,X
13/DB51: 9D 04 33     STA $3304,X
13/DB54: E8           INX 
13/DB55: E0 15 00     CPX #$0015
13/DB58: D0 F3        BNE $DB4D
13/DB5A: 8B           PHB 
13/DB5B: 7B           TDC 
13/DB5C: 48           PHA 
13/DB5D: AB           PLB 
13/DB5E: A9 43        LDA #$43
13/DB60: 8D 00 43     STA $4300
13/DB63: 8D 10 43     STA $4310
13/DB66: A9 42        LDA #$42
13/DB68: 8D 20 43     STA $4320
13/DB6B: A9 1B        LDA #$1B
13/DB6D: 8D 01 43     STA $4301
13/DB70: A9 1D        LDA #$1D
13/DB72: 8D 11 43     STA $4311
13/DB75: A9 0E        LDA #$0E
13/DB77: 8D 21 43     STA $4321
13/DB7A: A2 04 33     LDX #$3304
13/DB7D: 8E 02 43     STX $4302
13/DB80: A2 0B 33     LDX #$330B
13/DB83: 8E 12 43     STX $4312
13/DB86: A2 12 33     LDX #$3312
13/DB89: 8E 22 43     STX $4322
13/DB8C: A9 7E        LDA #$7E
13/DB8E: 8D 04 43     STA $4304
13/DB91: 8D 07 43     STA $4307
13/DB94: 8D 14 43     STA $4314
13/DB97: 8D 17 43     STA $4317
13/DB9A: 8D 24 43     STA $4324
13/DB9D: 8D 27 43     STA $4327
13/DBA0: A9 03        LDA #$03
13/DBA2: 8D 0C 42     STA $420C
13/DBA5: AB           PLB 
13/DBA6: 60           RTS 

13/DBA7: 00 E0

; [  ]

13/DBA9: A5 4A        LDA $4A
13/DBAB: 4A           LSR 
13/DBAC: 29 01        AND #$01
13/DBAE: AA           TAX 
13/DBAF: BF A7 DB 13  LDA $13DBA7,X
13/DBB3: AA           TAX 
13/DBB4: 7B           TDC 
13/DBB5: A8           TAY 
13/DBB6: BF 00 D2 13  LDA $13D200,X
13/DBBA: 99 03 22     STA $2203,Y
13/DBBD: E8           INX 
13/DBBE: C8           INY 
13/DBBF: C0 20 00     CPY #$0020
13/DBC2: D0 F2        BNE $DBB6
13/DBC4: A5 4A        LDA $4A
13/DBC6: 29 07        AND #$07
13/DBC8: D0 1D        BNE $DBE7
13/DBCA: C2 20        REP #$20
13/DBCC: AD C1 22     LDA $22C1
13/DBCF: 48           PHA 
13/DBD0: A2 1C 00     LDX #$001C
13/DBD3: BD A3 22     LDA $22A3,X
13/DBD6: 9D A5 22     STA $22A5,X
13/DBD9: CA           DEX 
13/DBDA: CA           DEX 
13/DBDB: E0 12 00     CPX #$0012
13/DBDE: D0 F3        BNE $DBD3
13/DBE0: 68           PLA 
13/DBE1: 8D B7 22     STA $22B7
13/DBE4: 7B           TDC 
13/DBE5: E2 20        SEP #$20
13/DBE7: 60           RTS 

; [  ]

13/DBE8: DA           PHX 
13/DBE9: C2 20        REP #$20
13/DBEB: 8A           TXA 
13/DBEC: A2 00 00     LDX #$0000
13/DBEF: 9D 19 33     STA $3319,X
13/DBF2: 9D 1B 37     STA $371B,X
13/DBF5: 9E 1B 33     STZ $331B,X
13/DBF8: 9E 19 37     STZ $3719,X
13/DBFB: E8           INX 
13/DBFC: E8           INX 
13/DBFD: E8           INX 
13/DBFE: E8           INX 
13/DBFF: E0 00 04     CPX #$0400
13/DC02: D0 EB        BNE $DBEF
13/DC04: 7B           TDC 
13/DC05: E2 20        SEP #$20
13/DC07: FA           PLX 
13/DC08: 60           RTS 

; [  ]

13/DC09: 9C 25 7D     STZ $7D25
13/DC0C: A2 80 00     LDX #$0080
13/DC0F: 86 08        STX $08
13/DC11: 86 0A        STX $0A
13/DC13: A2 00 01     LDX #$0100
13/DC16: 86 00        STX $00
13/DC18: 86 06        STX $06
13/DC1A: A2 00 01     LDX #$0100
13/DC1D: 20 E8 DB     JSR $DBE8
13/DC20: C2 20        REP #$20
13/DC22: 7B           TDC 
13/DC23: AA           TAX 
13/DC24: A0 80 02     LDY #$0280
13/DC27: A5 00        LDA $00
13/DC29: 99 19 33     STA $3319,Y
13/DC2C: A5 06        LDA $06
13/DC2E: 99 1B 37     STA $371B,Y
13/DC31: A5 00        LDA $00
13/DC33: 38           SEC 
13/DC34: E9 02 00     SBC #$0002
13/DC37: 85 00        STA $00
13/DC39: A5 06        LDA $06
13/DC3B: 38           SEC 
13/DC3C: E9 01 00     SBC #$0001
13/DC3F: 85 06        STA $06
13/DC41: 98           TYA 
13/DC42: 18           CLC 
13/DC43: 69 04 00     ADC #$0004
13/DC46: A8           TAY 
13/DC47: E8           INX 
13/DC48: C0 00 04     CPY #$0400
13/DC4B: D0 DA        BNE $DC27
13/DC4D: A5 64        LDA $64
13/DC4F: 29 FF 00     AND #$00FF
13/DC52: AA           TAX 
13/DC53: E0 02 00     CPX #$0002
13/DC56: F0 23        BEQ $DC7B
13/DC58: A0 80 02     LDY #$0280
13/DC5B: A2 04 01     LDX #$0104
13/DC5E: B9 19 33     LDA $3319,Y
13/DC61: 9D 19 33     STA $3319,X
13/DC64: B9 1B 37     LDA $371B,Y
13/DC67: 9D 1B 37     STA $371B,X
13/DC6A: 8A           TXA 
13/DC6B: 38           SEC 
13/DC6C: E9 04 00     SBC #$0004
13/DC6F: AA           TAX 
13/DC70: 98           TYA 
13/DC71: 18           CLC 
13/DC72: 69 04 00     ADC #$0004
13/DC75: A8           TAY 
13/DC76: C0 00 04     CPY #$0400
13/DC79: D0 E3        BNE $DC5E
13/DC7B: 7B           TDC 
13/DC7C: E2 20        SEP #$20
13/DC7E: A5 64        LDA $64
13/DC80: C9 01        CMP #$01
13/DC82: F0 0E        BEQ $DC92
13/DC84: A2 80 00     LDX #$0080
13/DC87: 8E 8C 00     STX $008C
13/DC8A: 8E 8E 00     STX $008E
13/DC8D: A2 00 01     LDX #$0100
13/DC90: 80 0E        BRA $DCA0
13/DC92: 7B           TDC 
13/DC93: AA           TAX 
13/DC94: 8E 8C 00     STX $008C
13/DC97: A2 20 00     LDX #$0020
13/DC9A: 8E 8E 00     STX $008E
13/DC9D: A2 00 0A     LDX #$0A00
13/DCA0: 8E 61 00     STX $0061
13/DCA3: 7B           TDC 
13/DCA4: AA           TAX 
13/DCA5: 86 40        STX $40
13/DCA7: 86 5D        STX $5D
13/DCA9: 86 5F        STX $5F
13/DCAB: 85 63        STA $63
13/DCAD: 85 4A        STA $4A
13/DCAF: 8D 5B 00     STA $005B
13/DCB2: A2 00 10     LDX #$1000
13/DCB5: 86 92        STX $92
13/DCB7: A2 00 80     LDX #$8000
13/DCBA: 86 90        STX $90
13/DCBC: 7B           TDC 
13/DCBD: AA           TAX 
13/DCBE: A5 64        LDA $64
13/DCC0: C9 02        CMP #$02
13/DCC2: D0 06        BNE $DCCA
13/DCC4: BF 10 D5 13  LDA $13D510,X
13/DCC8: 80 04        BRA $DCCE
13/DCCA: BF 00 D2 13  LDA $13D200,X
13/DCCE: 9D 03 21     STA $2103,X
13/DCD1: 9D 03 22     STA $2203,X
13/DCD4: E8           INX 
13/DCD5: E0 00 01     CPX #$0100
13/DCD8: D0 E4        BNE $DCBE
13/DCDA: 9C 00 21     STZ $2100       ; screen on, zero brightness
13/DCDD: A2 00 10     LDX #$1000
13/DCE0: 86 00        STX $00
13/DCE2: A2 00 CC     LDX #$CC00
13/DCE5: A0 00 40     LDY #$4000
13/DCE8: A9 15        LDA #$15
13/DCEA: 20 D6 DD     JSR $DDD6
13/DCED: A2 70 00     LDX #$0070
13/DCF0: 86 6C        STX $6C
13/DCF2: A2 50 00     LDX #$0050
13/DCF5: 86 6E        STX $6E
13/DCF7: A2 70 00     LDX #$0070
13/DCFA: 86 70        STX $70
13/DCFC: A2 50 00     LDX #$0050
13/DCFF: 86 72        STX $72
13/DD01: 20 23 DB     JSR $DB23
13/DD04: 20 22 E1     JSR $E122
13/DD07: A2 40 00     LDX #$0040
13/DD0A: 8E 84 20     STX $2084
13/DD0D: A2 80 01     LDX #$0180
13/DD10: 8E C4 20     STX $20C4
13/DD13: A2 40 00     LDX #$0040
13/DD16: 8E 8A 20     STX $208A
13/DD19: A2 C0 00     LDX #$00C0
13/DD1C: 8E CA 20     STX $20CA
13/DD1F: A2 80 01     LDX #$0180
13/DD22: 8E 0A 20     STX $200A
13/DD25: A2 00 03     LDX #$0300
13/DD28: 8E 4A 20     STX $204A
13/DD2B: A2 18 00     LDX #$0018
13/DD2E: 8E 86 20     STX $2086
13/DD31: A2 00 01     LDX #$0100
13/DD34: 8E C6 20     STX $20C6
13/DD37: A2 08 00     LDX #$0008
13/DD3A: 8E 88 20     STX $2088
13/DD3D: A2 A0 00     LDX #$00A0
13/DD40: 8E C8 20     STX $20C8
13/DD43: A2 00 00     LDX #$0000
13/DD46: A0 00 01     LDY #$0100
13/DD49: 20 0C E1     JSR $E10C
13/DD4C: A2 02 00     LDX #$0002
13/DD4F: A0 00 00     LDY #$0000
13/DD52: 20 0C E1     JSR $E10C
13/DD55: A2 04 00     LDX #$0004
13/DD58: A0 00 01     LDY #$0100
13/DD5B: 20 0C E1     JSR $E10C
13/DD5E: A2 06 00     LDX #$0006
13/DD61: A0 54 01     LDY #$0154
13/DD64: 20 0C E1     JSR $E10C
13/DD67: A2 08 00     LDX #$0008
13/DD6A: A0 F4 02     LDY #$02F4
13/DD6D: 20 0C E1     JSR $E10C
13/DD70: 20 7F DD     JSR $DD7F
13/DD73: 7B           TDC 
13/DD74: AA           TAX 
13/DD75: 9D 19 3D     STA $3D19,X
13/DD78: E8           INX 
13/DD79: E0 00 40     CPX #$4000
13/DD7C: D0 F7        BNE $DD75
13/DD7E: 60           RTS 

; [  ]

13/DD7F: A2 00 00     LDX #$0000
13/DD82: A0 08 00     LDY #$0008
13/DD85: 20 BB DD     JSR $DDBB
13/DD88: A2 02 00     LDX #$0002
13/DD8B: A0 0C 00     LDY #$000C
13/DD8E: 20 BB DD     JSR $DDBB
13/DD91: A2 04 00     LDX #$0004
13/DD94: A0 10 00     LDY #$0010
13/DD97: 20 BB DD     JSR $DDBB
13/DD9A: A2 06 00     LDX #$0006
13/DD9D: A0 14 00     LDY #$0014
13/DDA0: 20 BB DD     JSR $DDBB
13/DDA3: A2 08 00     LDX #$0008
13/DDA6: A0 18 00     LDY #$0018
13/DDA9: 20 BB DD     JSR $DDBB
13/DDAC: AD 5B 00     LDA $005B
13/DDAF: F0 09        BEQ $DDBA
13/DDB1: A2 0A 00     LDX #$000A
13/DDB4: A0 1C 00     LDY #$001C
13/DDB7: 20 BB DD     JSR $DDBB
13/DDBA: 60           RTS 

; [  ]

13/DDBB: 20 78 E5     JSR $E578
13/DDBE: C2 20        REP #$20
13/DDC0: A5 1E        LDA $1E
13/DDC2: 99 6C 00     STA $006C,Y
13/DDC5: 7B           TDC 
13/DDC6: E2 20        SEP #$20
13/DDC8: 20 65 E5     JSR $E565
13/DDCB: C2 20        REP #$20
13/DDCD: A5 1E        LDA $1E
13/DDCF: 99 6E 00     STA $006E,Y
13/DDD2: 7B           TDC 
13/DDD3: E2 20        SEP #$20
13/DDD5: 60           RTS 

; [  ]

13/DDD6: 8B           PHB 
13/DDD7: 48           PHA 
13/DDD8: 7B           TDC 
13/DDD9: 48           PHA 
13/DDDA: AB           PLB 
13/DDDB: 68           PLA 
13/DDDC: 8C 16 21     STY $2116
13/DDDF: 8E 52 43     STX $4352
13/DDE2: 8D 54 43     STA $4354
13/DDE5: A9 01        LDA #$01
13/DDE7: 8D 50 43     STA $4350
13/DDEA: A9 18        LDA #$18
13/DDEC: 8D 51 43     STA $4351
13/DDEF: A6 00        LDX $00
13/DDF1: 8E 55 43     STX $4355
13/DDF4: A9 20        LDA #$20
13/DDF6: 8D 0B 42     STA $420B
13/DDF9: AB           PLB 
13/DDFA: 60           RTS 

; [ clear sprite data ]

13/DDFB: A2 20 02     LDX #$0220
13/DDFE: 7B           TDC 
13/DDFF: 9D FF 02     STA $02FF,X
13/DE02: CA           DEX 
13/DE03: D0 FA        BNE $DDFF
13/DE05: 60           RTS 

; [  ]

13/DE06: 7B           TDC 
13/DE07: AA           TAX 
13/DE08: A9 F0        LDA #$F0
13/DE0A: 9D 00 03     STA $0300,X
13/DE0D: E8           INX 
13/DE0E: E0 18 01     CPX #$0118
13/DE11: D0 F7        BNE $DE0A
13/DE13: 60           RTS 

; [ init hardware registers ]

13/DE14: A9 00        LDA #$00
13/DE16: 8D 00 42     STA $4200       ; disable nmi and irq
13/DE19: 48           PHA 
13/DE1A: AB           PLB 
13/DE1B: A2 00 00     LDX #$0000
13/DE1E: DA           PHX 
13/DE1F: 2B           PLD 
13/DE20: A9 80        LDA #$80
13/DE22: 8D 00 21     STA $2100       ; screen off
13/DE25: A9 07        LDA #$07
13/DE27: 8D 05 21     STA $2105
13/DE2A: A2 00 03     LDX #$0300
13/DE2D: 8E 02 21     STX $2102
13/DE30: A9 80        LDA #$80
13/DE32: 8D A0 00     STA $00A0
13/DE35: 8D 1A 21     STA $211A
13/DE38: A9 02        LDA #$02
13/DE3A: 8D 01 21     STA $2101
13/DE3D: A9 00        LDA #$00
13/DE3F: 8D 0B 21     STA $210B
13/DE42: 8D 0C 21     STA $210C
13/DE45: A9 80        LDA #$80
13/DE47: 8D 15 21     STA $2115
13/DE4A: 7B           TDC 
13/DE4B: AA           TAX 
13/DE4C: 8D 1B 21     STA $211B
13/DE4F: 8D 1B 21     STA $211B
13/DE52: 8D 1C 21     STA $211C
13/DE55: 8D 1C 21     STA $211C
13/DE58: 8D 1D 21     STA $211D
13/DE5B: 8D 1D 21     STA $211D
13/DE5E: 8D 1E 21     STA $211E
13/DE61: 8D 1E 21     STA $211E
13/DE64: 8D 1F 21     STA $211F
13/DE67: 8D 1F 21     STA $211F
13/DE6A: 8D 20 21     STA $2120
13/DE6D: 8D 20 21     STA $2120
13/DE70: 8D 06 21     STA $2106
13/DE73: 8D 07 21     STA $2107
13/DE76: 8D 08 21     STA $2108
13/DE79: 8D 09 21     STA $2109
13/DE7C: 8D 0A 21     STA $210A
13/DE7F: 8D 0D 21     STA $210D
13/DE82: 8D 0D 21     STA $210D
13/DE85: 8D 0E 21     STA $210E
13/DE88: 8D 0E 21     STA $210E
13/DE8B: 8D 0F 21     STA $210F
13/DE8E: 8D 0F 21     STA $210F
13/DE91: 8D 10 21     STA $2110
13/DE94: 8D 10 21     STA $2110
13/DE97: 8D 11 21     STA $2111
13/DE9A: 8D 11 21     STA $2111
13/DE9D: 8D 12 21     STA $2112
13/DEA0: 8D 12 21     STA $2112
13/DEA3: 8D 13 21     STA $2113
13/DEA6: 8D 13 21     STA $2113
13/DEA9: 8D 14 21     STA $2114
13/DEAC: 8D 14 21     STA $2114
13/DEAF: 8D 28 21     STA $2128
13/DEB2: 8D 29 21     STA $2129
13/DEB5: 8E 2A 21     STX $212A
13/DEB8: 8D 2C 21     STA $212C
13/DEBB: 8D 2D 21     STA $212D
13/DEBE: 8D 2E 21     STA $212E
13/DEC1: 8D 2F 21     STA $212F
13/DEC4: 8D 0B 42     STA $420B
13/DEC7: 8D 0C 42     STA $420C
13/DECA: 8D 31 21     STA $2131
13/DECD: 8D 33 21     STA $2133
13/DED0: 8D 30 21     STA $2130
13/DED3: 8E 8C 00     STX $008C
13/DED6: 8E 8E 00     STX $008E
13/DED9: A9 08        LDA #$08
13/DEDB: 8D 26 21     STA $2126
13/DEDE: A9 FF        LDA #$FF
13/DEE0: 8D 27 21     STA $2127
13/DEE3: A9 11        LDA #$11
13/DEE5: 8D 2C 21     STA $212C
13/DEE8: 8D 2E 21     STA $212E
13/DEEB: A9 33        LDA #$33
13/DEED: 8D 23 21     STA $2123
13/DEF0: 8D 24 21     STA $2124
13/DEF3: 8D 25 21     STA $2125
13/DEF6: A9 13        LDA #$13        ; set up interrupt jump code
13/DEF8: 8D 03 02     STA $0203
13/DEFB: A2 B3 E3     LDX #$E3B3
13/DEFE: 8E 01 02     STX $0201
13/DF01: A9 13        LDA #$13
13/DF03: 8D 07 02     STA $0207
13/DF06: A2 57 E0     LDX #$E057
13/DF09: 8E 05 02     STX $0205
13/DF0C: A9 5C        LDA #$5C
13/DF0E: 8D 00 02     STA $0200
13/DF11: 8D 04 02     STA $0204
13/DF14: A9 7E        LDA #$7E
13/DF16: 48           PHA 
13/DF17: AB           PLB 
13/DF18: 60           RTS 

; [  ]

13/DF19: 8B           PHB 
13/DF1A: 7B           TDC 
13/DF1B: 48           PHA 
13/DF1C: AB           PLB 
13/DF1D: 8E 16 21     STX $2116
13/DF20: A2 3F DF     LDX #$DF3F
13/DF23: 8E 52 43     STX $4352
13/DF26: A9 09        LDA #$09
13/DF28: 8D 50 43     STA $4350
13/DF2B: A9 18        LDA #$18
13/DF2D: 8D 51 43     STA $4351
13/DF30: A9 13        LDA #$13
13/DF32: 8D 54 43     STA $4354
13/DF35: 8C 55 43     STY $4355
13/DF38: A9 20        LDA #$20
13/DF3A: 8D 0B 42     STA $420B
13/DF3D: AB           PLB 
13/DF3E: 60           RTS 

13/DF3F: 0000

; [  ]

13/DF41: DA           PHX 
13/DF42: E6 41        INC $41
13/DF44: A5 41        LDA $41
13/DF46: D0 FC        BNE $DF44
13/DF48: 20 4D DF     JSR $DF4D
13/DF4B: FA           PLX 
13/DF4C: 60           RTS 

; [  ]

13/DF4D: A5 64        LDA $64
13/DF4F: C9 02        CMP #$02
13/DF51: D0 03        BNE $DF56
13/DF53: 20 81 EC     JSR $EC81
13/DF56: 60           RTS 

13/DF57: 40 02 08 20 01 00 00 00
13/DF5F: 88 21 1C 42 08 80 00 00
13/DF67: A2 22 3E 22 22 80 00 00
13/DF6F: 92 49 3E 49 24 80 00 00
13/DF77: A4 92 FF A4 92 80 00 00
13/DF7F: A4 95 FF D4 92 80 00 00
13/DF87: A4 95 FF D4 92 80 00 00
13/DF8F: A4 AB FF EA 92 80 00 00
13/DF97: A4 AF FF FA 92 80 00 00
13/DF9F: A4 AF FF FA 92 80 00 00
13/DFA7: A4 BF FF FE 92 80 00 00
13/DFAF: A4 BF FF FE 92 80 00 00
13/DFB7: A4 BF FF FE 92 80 00 00
13/DFBF: C9 7F FF FF 49 80 00 00
13/DFC7: C9 7F FF FF 49 80 00 00
13/DFCF: C9 7F FF FF 49 80 00 00
13/DFD7: C9 7F FF FF 49 80 00 00
13/DFDF: C9 7F FF FF 49 80 00 00
13/DFE7: C9 7F FF FF 49 80 00 00
13/DFEF: A4 BF FF FE 92 80 00 00
13/DFF7: A4 BF FF FE 92 80 00 00
13/DFFF: A4 BF FF FE 92 80 00 00
13/E007: A4 AF FF FA 92 80 00 00
13/E00F: A4 AF FF FA 92 80 00 00
13/E017: A4 AB FF EA 92 80 00 00
13/E01F: A4 95 FF D4 92 80 00 00
13/E027: A4 95 FF D4 92 80 00 00
13/E02F: A4 92 FF A4 92 80 00 00
13/E037: 92 49 3E 49 24 80 00 00
13/E03F: A2 22 3E 22 22 80 00 00
13/E047: 88 21 1C 42 08 80 00 00
13/E04F: 40 02 08 20 01 00 00 00

; [ cinematic irq ]

; *** bug *** unused, but should be RTI

13/E057: 6B           RTL 

; [  ]

13/E058: 8B           PHB 
13/E059: 48           PHA 
13/E05A: 7B           TDC 
13/E05B: 48           PHA 
13/E05C: AB           PLB 
13/E05D: 68           PLA 
13/E05E: 8C 16 21     STY $2116
13/E061: 8E 42 43     STX $4342
13/E064: 8D 44 43     STA $4344
13/E067: A9 01        LDA #$01
13/E069: 8D 40 43     STA $4340
13/E06C: A9 18        LDA #$18
13/E06E: 8D 41 43     STA $4341
13/E071: A6 28        LDX $28
13/E073: 8E 45 43     STX $4345
13/E076: A9 10        LDA #$10
13/E078: 8D 0B 42     STA $420B
13/E07B: AB           PLB 
13/E07C: 60           RTS 

; [  ]

13/E07D: A5 4A        LDA $4A
13/E07F: 29 0F        AND #$0F
13/E081: D0 22        BNE $E0A5
13/E083: A2 00 04     LDX #$0400
13/E086: 86 28        STX $28
13/E088: A6 57        LDX $57
13/E08A: A0 00 40     LDY #$4000
13/E08D: A9 7E        LDA #$7E
13/E08F: 20 58 E0     JSR $E058
13/E092: C2 20        REP #$20
13/E094: A5 57        LDA $57
13/E096: 18           CLC 
13/E097: 69 00 04     ADC #$0400
13/E09A: 29 FF 7F     AND #$7FFF
13/E09D: 09 00 80     ORA #$8000
13/E0A0: 85 57        STA $57
13/E0A2: 7B           TDC 
13/E0A3: E2 20        SEP #$20
13/E0A5: 60           RTS 

; [  ]

13/E0A6: 8B           PHB 
13/E0A7: 7B           TDC 
13/E0A8: 48           PHA 
13/E0A9: AB           PLB 
13/E0AA: 8D 21 21     STA $2121
13/E0AD: A2 02 22     LDX #$2202
13/E0B0: 8E 40 43     STX $4340
13/E0B3: A2 03 21     LDX #$2103
13/E0B6: 8E 42 43     STX $4342
13/E0B9: A9 7E        LDA #$7E
13/E0BB: 8D 44 43     STA $4344
13/E0BE: A2 00 02     LDX #$0200
13/E0C1: 8E 45 43     STX $4345
13/E0C4: A9 10        LDA #$10
13/E0C6: 8D 0B 42     STA $420B
13/E0C9: AB           PLB 
13/E0CA: 60           RTS 

; [ transfer sprite data to ppu ]

13/E0CB: 8B           PHB 
13/E0CC: 7B           TDC 
13/E0CD: 48           PHA 
13/E0CE: AB           PLB 
13/E0CF: AA           TAX 
13/E0D0: 8E 02 21     STX $2102
13/E0D3: A2 00 04     LDX #$0400
13/E0D6: 8E 40 43     STX $4340
13/E0D9: A2 00 03     LDX #$0300
13/E0DC: 8E 42 43     STX $4342
13/E0DF: 7B           TDC 
13/E0E0: 8D 44 43     STA $4344
13/E0E3: 8D 47 43     STA $4347
13/E0E6: A2 20 02     LDX #$0220
13/E0E9: 8E 45 43     STX $4345
13/E0EC: A9 10        LDA #$10
13/E0EE: 8D 0B 42     STA $420B
13/E0F1: AB           PLB 
13/E0F2: 60           RTS 

; [ multiply (8-bit) ]

13/E0F3: DA           PHX 
13/E0F4: A5 18        LDA $18
13/E0F6: 8F 02 42 00  STA $004202
13/E0FA: A5 1A        LDA $1A
13/E0FC: 8F 03 42 00  STA $004203
13/E100: 8B           PHB 
13/E101: 7B           TDC 
13/E102: 48           PHA 
13/E103: AB           PLB 
13/E104: AE 16 42     LDX $4216
13/E107: 86 1C        STX $1C
13/E109: AB           PLB 
13/E10A: FA           PLX 
13/E10B: 60           RTS 

; [  ]

13/E10C: C2 20        REP #$20
13/E10E: 98           TYA 
13/E10F: 18           CLC 
13/E110: 7D 00 20     ADC $2000,X
13/E113: 9D 00 20     STA $2000,X
13/E116: 98           TYA 
13/E117: 18           CLC 
13/E118: 7D 40 20     ADC $2040,X
13/E11B: 9D 40 20     STA $2040,X
13/E11E: 7B           TDC 
13/E11F: E2 20        SEP #$20
13/E121: 60           RTS 

; [  ]

13/E122: 7B           TDC 
13/E123: AA           TAX 
13/E124: A9 80        LDA #$80
13/E126: C2 20        REP #$20
13/E128: 9E 00 20     STZ $2000,X
13/E12B: 9D 40 20     STA $2040,X
13/E12E: E8           INX 
13/E12F: E8           INX 
13/E130: E0 40 00     CPX #$0040
13/E133: D0 F3        BNE $E128
13/E135: 7B           TDC 
13/E136: E2 20        SEP #$20
13/E138: 60           RTS 
13/E139: C2 20        REP #$20
13/E13B: A5 6C        LDA $6C
13/E13D: 18           CLC 
13/E13E: 65 7C        ADC $7C
13/E140: 85 4B        STA $4B
13/E142: A5 6E        LDA $6E
13/E144: 18           CLC 
13/E145: 65 7E        ADC $7E
13/E147: 85 4D        STA $4D
13/E149: 7B           TDC 
13/E14A: E2 20        SEP #$20
13/E14C: 60           RTS 

; [  ]

13/E14D: AD 00 21     LDA $2100
13/E150: F0 0F        BEQ $E161
13/E152: 20 39 E1     JSR $E139
13/E155: A9 4C        LDA #$4C
13/E157: 85 4F        STA $4F
13/E159: A9 04        LDA #$04
13/E15B: 85 51        STA $51
13/E15D: 20 6E DA     JSR $DA6E
13/E160: 60           RTS 
13/E161: 20 39 E1     JSR $E139
13/E164: A9 52        LDA #$52
13/E166: 85 4F        STA $4F
13/E168: A9 0F        LDA #$0F
13/E16A: 85 51        STA $51
13/E16C: 20 6E DA     JSR $DA6E
13/E16F: 20 39 E1     JSR $E139
13/E172: 64 4F        STZ $4F
13/E174: A9 10        LDA #$10
13/E176: 85 51        STA $51
13/E178: 20 6E DA     JSR $DA6E
13/E17B: 60           RTS 

; [  ]

13/E17C: A5 4A        LDA $4A
13/E17E: 29 07        AND #$07
13/E180: F0 13        BEQ $E195
13/E182: A6 70        LDX $70
13/E184: 86 4B        STX $4B
13/E186: A6 72        LDX $72
13/E188: 86 4D        STX $4D
13/E18A: A9 30        LDA #$30
13/E18C: 85 4F        STA $4F
13/E18E: A9 18        LDA #$18
13/E190: 85 51        STA $51
13/E192: 20 6E DA     JSR $DA6E
13/E195: 60           RTS 

; [  ]

13/E196: A2 06 00     LDX #$0006
13/E199: 20 DC E2     JSR $E2DC
13/E19C: C2 20        REP #$20
13/E19E: A5 80        LDA $80
13/E1A0: 18           CLC 
13/E1A1: 65 70        ADC $70
13/E1A3: 85 4B        STA $4B
13/E1A5: A5 82        LDA $82
13/E1A7: 18           CLC 
13/E1A8: 65 72        ADC $72
13/E1AA: 69 0C 00     ADC #$000C
13/E1AD: 85 4D        STA $4D
13/E1AF: 7B           TDC 
13/E1B0: E2 20        SEP #$20
13/E1B2: A9 04        LDA #$04
13/E1B4: 85 51        STA $51
13/E1B6: A9 02        LDA #$02
13/E1B8: 20 69 DA     JSR $DA69
13/E1BB: A2 08 00     LDX #$0008
13/E1BE: 20 DC E2     JSR $E2DC
13/E1C1: C2 20        REP #$20
13/E1C3: A5 84        LDA $84
13/E1C5: 18           CLC 
13/E1C6: 65 70        ADC $70
13/E1C8: 85 4B        STA $4B
13/E1CA: A5 86        LDA $86
13/E1CC: 18           CLC 
13/E1CD: 65 72        ADC $72
13/E1CF: 69 0C 00     ADC #$000C
13/E1D2: 85 4D        STA $4D
13/E1D4: 7B           TDC 
13/E1D5: E2 20        SEP #$20
13/E1D7: A9 04        LDA #$04
13/E1D9: 85 51        STA $51
13/E1DB: A9 03        LDA #$03
13/E1DD: 20 69 DA     JSR $DA69
13/E1E0: 60           RTS 

; [  ]

13/E1E1: A2 00 00     LDX #$0000
13/E1E4: 20 E2 E2     JSR $E2E2
13/E1E7: C2 20        REP #$20
13/E1E9: A5 74        LDA $74
13/E1EB: 18           CLC 
13/E1EC: 65 6C        ADC $6C
13/E1EE: 65 7C        ADC $7C
13/E1F0: 69 08 00     ADC #$0008
13/E1F3: 85 4B        STA $4B
13/E1F5: A5 76        LDA $76
13/E1F7: 18           CLC 
13/E1F8: 65 6E        ADC $6E
13/E1FA: 65 7E        ADC $7E
13/E1FC: 69 08 00     ADC #$0008
13/E1FF: 85 4D        STA $4D
13/E201: 7B           TDC 
13/E202: E2 20        SEP #$20
13/E204: A9 04        LDA #$04
13/E206: 85 51        STA $51
13/E208: AD 5B 00     LDA $005B
13/E20B: F0 36        BEQ $E243
13/E20D: C2 20        REP #$20
13/E20F: A5 70        LDA $70
13/E211: 18           CLC 
13/E212: 65 88        ADC $88
13/E214: 49 FF FF     EOR #$FFFF
13/E217: 38           SEC 
13/E218: E5 A1        SBC $A1
13/E21A: 85 5D        STA $5D
13/E21C: A5 72        LDA $72
13/E21E: 18           CLC 
13/E21F: 65 8A        ADC $8A
13/E221: 49 FF FF     EOR #$FFFF
13/E224: 38           SEC 
13/E225: E5 A3        SBC $A3
13/E227: 85 5F        STA $5F
13/E229: 7B           TDC 
13/E22A: E2 20        SEP #$20
13/E22C: AE 61 00     LDX $0061
13/E22F: E0 04 00     CPX #$0004
13/E232: 90 0E        BCC $E242
13/E234: CA           DEX 
13/E235: CA           DEX 
13/E236: CA           DEX 
13/E237: 8E 61 00     STX $0061
13/E23A: AE C0 20     LDX $20C0
13/E23D: E8           INX 
13/E23E: E8           INX 
13/E23F: 8E C0 20     STX $20C0
13/E242: 60           RTS 
13/E243: 20 6E DA     JSR $DA6E
13/E246: 60           RTS 

; [  ]

13/E247: A9 48        LDA #$48
13/E249: 85 50        STA $50
13/E24B: 7B           TDC 
13/E24C: AA           TAX 
13/E24D: EE 27 7D     INC $7D27
13/E250: 48           PHA 
13/E251: DA           PHX 
13/E252: BF 00 EE 14  LDA $14EE00,X
13/E256: A8           TAY 
13/E257: 84 4B        STY $4B
13/E259: AA           TAX 
13/E25A: BF 00 EE 14  LDA $14EE00,X
13/E25E: A8           TAY 
13/E25F: 84 4D        STY $4D
13/E261: 98           TYA 
13/E262: AD 27 7D     LDA $7D27
13/E265: 29 07        AND #$07
13/E267: F0 02        BEQ $E26B
13/E269: A9 01        LDA #$01
13/E26B: 18           CLC 
13/E26C: 69 50        ADC #$50
13/E26E: 85 4F        STA $4F
13/E270: A9 01        LDA #$01
13/E272: 85 51        STA $51
13/E274: 20 6E DA     JSR $DA6E
13/E277: FA           PLX 
13/E278: E8           INX 
13/E279: E8           INX 
13/E27A: 68           PLA 
13/E27B: 1A           INC 
13/E27C: C9 38        CMP #$38
13/E27E: D0 CD        BNE $E24D
13/E280: 60           RTS 

; [  ]

13/E281: A2 02 00     LDX #$0002
13/E284: 20 E2 E2     JSR $E2E2
13/E287: C2 20        REP #$20
13/E289: A5 78        LDA $78
13/E28B: 18           CLC 
13/E28C: 65 6C        ADC $6C
13/E28E: 65 7C        ADC $7C
13/E290: 69 08 00     ADC #$0008
13/E293: 85 4B        STA $4B
13/E295: A5 7A        LDA $7A
13/E297: 18           CLC 
13/E298: 65 6E        ADC $6E
13/E29A: 65 7E        ADC $7E
13/E29C: 69 08 00     ADC #$0008
13/E29F: 85 4D        STA $4D
13/E2A1: 7B           TDC 
13/E2A2: E2 20        SEP #$20
13/E2A4: A9 04        LDA #$04
13/E2A6: 85 51        STA $51
13/E2A8: 20 6E DA     JSR $DA6E
13/E2AB: 60           RTS 

13/E2AC: 04 03 02 01 00 01 02 03 04 05 06 07 07 07 06 05
13/E2BC: 07 06 06 06 06 06 06 06 07 07 07 07 07 07 07 07
13/E2CC: 05 04 04 03 02 03 04 04 05 05 06 06 07 06 06 05

; [  ]

13/E2DC: A9 20        LDA #$20
13/E2DE: 85 28        STA $28
13/E2E0: 80 0B        BRA $E2ED
13/E2E2: 64 28        STZ $28
13/E2E4: AD 00 21     LDA $2100
13/E2E7: F0 04        BEQ $E2ED
13/E2E9: A9 10        LDA #$10
13/E2EB: 85 28        STA $28
13/E2ED: C2 20        REP #$20
13/E2EF: BD 00 20     LDA $2000,X
13/E2F2: 29 FF 01     AND #$01FF
13/E2F5: 4A           LSR 
13/E2F6: 4A           LSR 
13/E2F7: 4A           LSR 
13/E2F8: 4A           LSR 
13/E2F9: 4A           LSR 
13/E2FA: 85 2A        STA $2A
13/E2FC: 7B           TDC 
13/E2FD: E2 20        SEP #$20
13/E2FF: A5 2A        LDA $2A
13/E301: 18           CLC 
13/E302: 65 28        ADC $28
13/E304: AA           TAX 
13/E305: BF AC E2 13  LDA $13E2AC,X
13/E309: 0A           ASL 
13/E30A: 0A           ASL 
13/E30B: 18           CLC 
13/E30C: 69 10        ADC #$10
13/E30E: 85 4F        STA $4F
13/E310: 60           RTS 

; [  ]

13/E311: 9C 01 21     STZ $2101
13/E314: 9C 02 21     STZ $2102
13/E317: 64 50        STZ $50
13/E319: AD 05 20     LDA $2005
13/E31C: 29 01        AND #$01
13/E31E: 8D 00 21     STA $2100
13/E321: AD 01 20     LDA $2001
13/E324: 29 01        AND #$01
13/E326: D0 06        BNE $E32E
13/E328: 20 E1 E1     JSR $E1E1
13/E32B: EE 01 21     INC $2101
13/E32E: AD 03 20     LDA $2003
13/E331: 29 01        AND #$01
13/E333: D0 06        BNE $E33B
13/E335: 20 81 E2     JSR $E281
13/E338: EE 02 21     INC $2102
13/E33B: 20 4D E1     JSR $E14D
13/E33E: AD 01 21     LDA $2101
13/E341: D0 03        BNE $E346
13/E343: 20 E1 E1     JSR $E1E1
13/E346: AD 02 21     LDA $2102
13/E349: D0 03        BNE $E34E
13/E34B: 20 81 E2     JSR $E281
13/E34E: AD 07 20     LDA $2007
13/E351: 29 01        AND #$01
13/E353: F0 08        BEQ $E35D
13/E355: 20 7C E1     JSR $E17C
13/E358: 20 96 E1     JSR $E196
13/E35B: 80 06        BRA $E363
13/E35D: 20 96 E1     JSR $E196
13/E360: 20 7C E1     JSR $E17C
13/E363: AD 00 21     LDA $2100
13/E366: D0 05        BNE $E36D
13/E368: 20 23 DB     JSR $DB23
13/E36B: 80 03        BRA $E370
13/E36D: 20 10 DB     JSR $DB10
13/E370: 20 7F DD     JSR $DD7F
13/E373: A2 00 00     LDX #$0000
13/E376: A0 FF FF     LDY #$FFFF
13/E379: 20 0C E1     JSR $E10C
13/E37C: A2 02 00     LDX #$0002
13/E37F: A0 FF FF     LDY #$FFFF
13/E382: 20 0C E1     JSR $E10C
13/E385: AD 00 21     LDA $2100
13/E388: AA           TAX 
13/E389: BF B1 E3 13  LDA $13E3B1,X
13/E38D: 85 28        STA $28
13/E38F: A5 4A        LDA $4A
13/E391: 25 28        AND $28
13/E393: D0 1B        BNE $E3B0
13/E395: A2 04 00     LDX #$0004
13/E398: A0 FF FF     LDY #$FFFF
13/E39B: 20 0C E1     JSR $E10C
13/E39E: A2 06 00     LDX #$0006
13/E3A1: A0 FF FF     LDY #$FFFF
13/E3A4: 20 0C E1     JSR $E10C
13/E3A7: A2 08 00     LDX #$0008
13/E3AA: A0 FF FF     LDY #$FFFF
13/E3AD: 20 0C E1     JSR $E10C
13/E3B0: 60           RTS 

13/E3B1: 03 07

; [ cinematic nmi ]

13/E3B3: 08           PHP 
13/E3B4: C2 30        REP #$30
13/E3B6: 48           PHA 
13/E3B7: DA           PHX 
13/E3B8: 5A           PHY 
13/E3B9: 8B           PHB 
13/E3BA: 0B           PHD 
13/E3BB: A2 00 00     LDX #$0000
13/E3BE: DA           PHX 
13/E3BF: 2B           PLD 
13/E3C0: 7B           TDC 
13/E3C1: E2 20        SEP #$20
13/E3C3: AF 10 42 00  LDA $004210
13/E3C7: A9 7E        LDA #$7E
13/E3C9: 48           PHA 
13/E3CA: AB           PLB 
13/E3CB: A5 40        LDA $40
13/E3CD: F0 03        BEQ $E3D2
13/E3CF: 4C E9 E4     JMP $E4E9
13/E3D2: E6 40        INC $40
13/E3D4: AD 03 33     LDA $3303
13/E3D7: 8F 00 21 00  STA $002100     ; set screen brightness
13/E3DB: A5 A0        LDA $A0
13/E3DD: 8F 1A 21 00  STA $00211A
13/E3E1: AD 28 7D     LDA $7D28
13/E3E4: 8F 2C 21 00  STA $00212C
13/E3E8: A5 64        LDA $64
13/E3EA: C9 01        CMP #$01
13/E3EC: F0 5B        BEQ $E449
13/E3EE: A5 4A        LDA $4A
13/E3F0: 29 03        AND #$03
13/E3F2: F0 03        BEQ $E3F7
13/E3F4: 4C 95 E4     JMP $E495
13/E3F7: A5 66        LDA $66
13/E3F9: 8F 0E 21 00  STA $00210E
13/E3FD: A5 67        LDA $67
13/E3FF: 8F 0E 21 00  STA $00210E
13/E403: A5 8C        LDA $8C
13/E405: 8F 1F 21 00  STA $00211F
13/E409: A5 8D        LDA $8D
13/E40B: 8F 1F 21 00  STA $00211F
13/E40F: A5 8E        LDA $8E
13/E411: 8F 20 21 00  STA $002120
13/E415: A5 8F        LDA $8F
13/E417: 8F 20 21 00  STA $002120
13/E41B: AD 1F 7D     LDA $7D1F
13/E41E: D0 75        BNE $E495
13/E420: A5 64        LDA $64
13/E422: F0 0D        BEQ $E431
13/E424: C2 20        REP #$20
13/E426: A5 66        LDA $66
13/E428: 1A           INC 
13/E429: C9 00 04     CMP #$0400
13/E42C: D0 0E        BNE $E43C
13/E42E: 7B           TDC 
13/E42F: 80 0B        BRA $E43C
13/E431: C2 20        REP #$20
13/E433: A5 66        LDA $66
13/E435: 1A           INC 
13/E436: C9 00 04     CMP #$0400
13/E439: D0 01        BNE $E43C
13/E43B: 3A           DEC 
13/E43C: 85 66        STA $66
13/E43E: 18           CLC 
13/E43F: 69 80 00     ADC #$0080
13/E442: 85 8E        STA $8E
13/E444: 7B           TDC 
13/E445: E2 20        SEP #$20
13/E447: 80 4C        BRA $E495
13/E449: AD 61 00     LDA $0061
13/E44C: 8F 1B 21 00  STA $00211B
13/E450: AD 62 00     LDA $0062
13/E453: 8F 1B 21 00  STA $00211B
13/E457: AD 61 00     LDA $0061
13/E45A: 8F 1E 21 00  STA $00211E
13/E45E: AD 62 00     LDA $0062
13/E461: 8F 1E 21 00  STA $00211E
13/E465: A5 5D        LDA $5D
13/E467: 8F 0D 21 00  STA $00210D
13/E46B: A5 5E        LDA $5E
13/E46D: 8F 0D 21 00  STA $00210D
13/E471: A5 5F        LDA $5F
13/E473: 8F 0E 21 00  STA $00210E
13/E477: A5 60        LDA $60
13/E479: 8F 0E 21 00  STA $00210E
13/E47D: A5 8C        LDA $8C
13/E47F: 8F 1F 21 00  STA $00211F
13/E483: A5 8D        LDA $8D
13/E485: 8F 1F 21 00  STA $00211F
13/E489: A5 8E        LDA $8E
13/E48B: 8F 20 21 00  STA $002120
13/E48F: A5 8F        LDA $8F
13/E491: 8F 20 21 00  STA $002120
13/E495: 20 CB E0     JSR $E0CB
13/E498: 20 A6 E0     JSR $E0A6
13/E49B: A5 64        LDA $64
13/E49D: C9 02        CMP #$02
13/E49F: D0 09        BNE $E4AA
13/E4A1: 20 B8 EB     JSR $EBB8
13/E4A4: 20 66 ED     JSR $ED66
13/E4A7: 4C C7 E4     JMP $E4C7
13/E4AA: 20 7D E0     JSR $E07D
13/E4AD: 20 06 DE     JSR $DE06
13/E4B0: 20 A9 DB     JSR $DBA9
13/E4B3: 20 11 E3     JSR $E311
13/E4B6: A5 64        LDA $64
13/E4B8: F0 0D        BEQ $E4C7
13/E4BA: AE 04 20     LDX $2004
13/E4BD: E0 80 FF     CPX #$FF80
13/E4C0: D0 05        BNE $E4C7
13/E4C2: A9 01        LDA #$01
13/E4C4: 8D 5B 00     STA $005B
13/E4C7: AD 5B 00     LDA $005B
13/E4CA: F0 0F        BEQ $E4DB
13/E4CC: A5 4A        LDA $4A
13/E4CE: 29 03        AND #$03
13/E4D0: D0 09        BNE $E4DB
13/E4D2: A2 0A 00     LDX #$000A
13/E4D5: A0 01 00     LDY #$0001
13/E4D8: 20 0C E1     JSR $E10C
13/E4DB: AD 25 7D     LDA $7D25
13/E4DE: F0 03        BEQ $E4E3
13/E4E0: 20 19 EF     JSR $EF19
13/E4E3: 64 40        STZ $40
13/E4E5: 64 41        STZ $41
13/E4E7: E6 4A        INC $4A
13/E4E9: C2 30        REP #$30
13/E4EB: 2B           PLD 
13/E4EC: AB           PLB 
13/E4ED: 7A           PLY 
13/E4EE: FA           PLX 
13/E4EF: 68           PLA 
13/E4F0: 28           PLP 
13/E4F1: 40           RTI 

13/E4F2: 0D 0A 08 07 05 04 04 03 02 02 01 01 01 00 00 00
13/E502: 00 00 00 01 01 01 02 02 03 04 04 05 07 08 0A 0D

; [  ]

13/E512: DA           PHX 
13/E513: C2 20        REP #$20
13/E515: 48           PHA 
13/E516: 64 16        STZ $16
13/E518: 64 12        STZ $12
13/E51A: 64 14        STZ $14
13/E51C: A2 10 00     LDX #$0010
13/E51F: 46 0E        LSR $0E
13/E521: 90 0D        BCC $E530
13/E523: 18           CLC 
13/E524: A5 12        LDA $12
13/E526: 65 10        ADC $10
13/E528: 85 12        STA $12
13/E52A: A5 14        LDA $14
13/E52C: 65 16        ADC $16
13/E52E: 85 14        STA $14
13/E530: 06 10        ASL $10
13/E532: 26 16        ROL $16
13/E534: CA           DEX 
13/E535: D0 E8        BNE $E51F
13/E537: 68           PLA 
13/E538: E2 20        SEP #$20
13/E53A: FA           PLX 
13/E53B: 60           RTS 

; [  ]

13/E53C: DA           PHX 
13/E53D: C2 20        REP #$20
13/E53F: 64 20        STZ $20
13/E541: 64 1C        STZ $1C
13/E543: 64 1E        STZ $1E
13/E545: A2 10 00     LDX #$0010
13/E548: 46 18        LSR $18
13/E54A: 90 0D        BCC $E559
13/E54C: 18           CLC 
13/E54D: A5 1C        LDA $1C
13/E54F: 65 1A        ADC $1A
13/E551: 85 1C        STA $1C
13/E553: A5 1E        LDA $1E
13/E555: 65 20        ADC $20
13/E557: 85 1E        STA $1E
13/E559: 06 1A        ASL $1A
13/E55B: 26 20        ROL $20
13/E55D: CA           DEX 
13/E55E: D0 E8        BNE $E548
13/E560: 7B           TDC 
13/E561: E2 20        SEP #$20
13/E563: FA           PLX 
13/E564: 60           RTS 

; [  ]

13/E565: DA           PHX 
13/E566: C2 20        REP #$20
13/E568: BD 80 20     LDA $2080,X
13/E56B: 85 18        STA $18
13/E56D: BD 00 20     LDA $2000,X
13/E570: 20 8B E5     JSR $E58B
13/E573: 7B           TDC 
13/E574: E2 20        SEP #$20
13/E576: FA           PLX 
13/E577: 60           RTS 

; [  ]

13/E578: DA           PHX 
13/E579: C2 20        REP #$20
13/E57B: BD C0 20     LDA $20C0,X
13/E57E: 85 18        STA $18
13/E580: BD 40 20     LDA $2040,X
13/E583: 20 8B E5     JSR $E58B
13/E586: 7B           TDC 
13/E587: E2 20        SEP #$20
13/E589: FA           PLX 
13/E58A: 60           RTS 

; [  ]

13/E58B: C2 20        REP #$20
13/E58D: 29 FF 01     AND #$01FF
13/E590: 0A           ASL 
13/E591: AA           TAX 
13/E592: BF C5 E5 13  LDA $13E5C5,X
13/E596: 10 19        BPL $E5B1
13/E598: 49 FF FF     EOR #$FFFF
13/E59B: 85 1A        STA $1A
13/E59D: 20 3C E5     JSR $E53C
13/E5A0: C2 20        REP #$20
13/E5A2: A5 1E        LDA $1E
13/E5A4: 49 FF FF     EOR #$FFFF
13/E5A7: 1A           INC 
13/E5A8: 10 14        BPL $E5BE
13/E5AA: 85 1E        STA $1E
13/E5AC: 7B           TDC 
13/E5AD: E2 20        SEP #$20
13/E5AF: 38           SEC 
13/E5B0: 60           RTS 
13/E5B1: C2 20        REP #$20
13/E5B3: 85 1A        STA $1A
13/E5B5: 20 3C E5     JSR $E53C
13/E5B8: C2 20        REP #$20
13/E5BA: A5 1E        LDA $1E
13/E5BC: 30 EC        BMI $E5AA
13/E5BE: 85 1E        STA $1E
13/E5C0: 7B           TDC 
13/E5C1: E2 20        SEP #$20
13/E5C3: 18           CLC 
13/E5C4: 60           RTS 

; sine table
13/E5C5: 0000 0192 0324 04B6 0648 07D9 096A 0AFB
13/E5D5: 0C8C 0E1C 0FAB 113A 12C8 1455 15E2 176E
13/E5E5: 18F9 1A82 1C0B 1D93 1F1A 209F 2223 23A6
13/E5F5: 2528 26A8 2826 29A3 2B1F 2C99 2E11 2F87
13/E605: 30FB 326E 33DF 354D 36BA 3824 398C 3AF2
13/E615: 3C56 3DB8 3F17 4073 41CE 4325 447A 45CD
13/E625: 471C 4869 49B3 4AFB 4C3F 4D81 4EBF 4FFB
13/E635: 5133 5268 539B 54C9 55F5 571D 5842 5964
13/E645: 5A82 5B9C 5CB3 5DC7 5ED7 5FE3 60EB 61F0
13/E655: 62F1 63EE 64E8 65DD 66CF 67BC 68A6 698B
13/E665: 6A6D 6B4A 6C23 6CF8 6DC9 6E96 6F5E 7022
13/E675: 70E2 719D 7254 7307 73B5 745F 7504 75A5
13/E685: 7641 76D8 776B 77FA 7884 7909 7989 7A05
13/E695: 7A7C 7AEE 7B5C 7BC5 7C29 7C88 7CE3 7D39
13/E6A5: 7D89 7DD5 7E1D 7E5F 7E9C 7ED5 7F09 7F37
13/E6B5: 7F61 7F86 7FA6 7FC1 7FD8 7FE9 7FF5 7FFD
13/E6C5: 7FFF 7FFD 7FF5 7FE9 7FD8 7FC1 7FA6 7F86
13/E6D5: 7F61 7F37 7F09 7ED5 7E9C 7E5F 7E1D 7DD5
13/E6E5: 7D89 7D39 7CE3 7C88 7C29 7BC5 7B5C 7AEE
13/E6F5: 7A7C 7A05 7989 7909 7884 77FA 776B 76D8
13/E705: 7641 75A5 7504 745F 73B5 7307 7254 719D
13/E715: 70E2 7022 6F5E 6E96 6DC9 6CF8 6C23 6B4A
13/E725: 6A6D 698B 68A6 67BC 66CF 65DD 64E8 63EE
13/E735: 62F1 61F0 60EB 5FE3 5ED7 5DC7 5CB3 5B9C
13/E745: 5A82 5964 5842 571D 55F5 54C9 539A 5268
13/E755: 5133 4FFB 4EBF 4D81 4C3F 4AFB 49B3 4869
13/E765: 471C 45CD 447A 4325 41CE 4073 3F17 3DB8
13/E775: 3C56 3AF2 398C 3824 36BA 354D 33DE 326E
13/E785: 30FB 2F87 2E11 2C99 2B1F 29A3 2826 26A8
13/E795: 2528 23A6 2223 209F 1F1A 1D93 1C0B 1A82
13/E7A5: 18F8 176E 15E2 1455 12C8 113A 0FAB 0E1C
13/E7B5: 0C8C 0AFB 096A 07D9 0648 04B6 0324 0192
13/E7C5: 0000 FE6E FCDC FB4A F9B8 F827 F695 F505
13/E7D5: F374 F1E4 F055 EEC6 ED38 EBAB EA1E E892
13/E7E5: E707 E57D E3F5 E26D E0E6 DF61 DDDC DC5A
13/E7F5: DAD8 D958 D7D9 D65C D4E1 D367 D1EF D079
13/E805: CF04 CD92 CC21 CAB3 C946 C7DC C673 C50D
13/E815: C3AA C248 C0E9 BF8C BE32 BCDB BB86 BA33
13/E825: B8E3 B796 B64C B505 B3C1 B27F B141 B005
13/E835: AECD AD97 AC65 AB36 AA0B A8E3 A7BE A69C
13/E845: A57E A463 A34C A239 A129 A01D 9F14 9E10
13/E855: 9D0F 9C11 9B18 9A23 9931 9844 975A 9675
13/E865: 9593 94B6 93DD 9308 9237 916A 90A2 8FDE
13/E875: 8F1E 8E63 8DAC 8CF9 8C4B 8BA1 8AFC 8A5B
13/E885: 89BF 8928 8895 8806 877C 86F7 8677 85FB
13/E895: 8584 8511 84A4 843B 83D7 8378 831D 82C7
13/E8A5: 8277 822B 81E3 81A1 8164 812B 80F7 80C9
13/E8B5: 809F 807A 805A 803F 8028 8017 800B 8003
13/E8C5: 8001 8003 800B 8017 8028 803F 805A 807A
13/E8D5: 809F 80C9 80F7 812B 8164 81A1 81E3 822B
13/E8E5: 8277 82C8 831D 8378 83D7 843B 84A4 8512
13/E8F5: 8584 85FB 8677 86F7 877D 8806 8895 8928
13/E905: 89BF 8A5C 8AFC 8BA1 8C4B 8CF9 8DAC 8E63
13/E915: 8F1E 8FDE 90A2 916A 9237 9308 93DD 94B6
13/E925: 9593 9675 975A 9844 9932 9A23 9B18 9C12
13/E935: 9D0F 9E10 9F15 A01D A12A A239 A34D A464
13/E945: A57E A69D A7BE A8E3 AA0B AB37 AC66 AD98
13/E955: AECD B006 B141 B280 B3C1 B505 B64D B797
13/E965: B8E4 BA34 BB86 BCDB BE33 BF8D C0EA C249
13/E975: C3AA C50E C674 C7DC C947 CAB3 CC22 CD92
13/E985: CF05 D079 D1F0 D368 D4E2 D65D D7DA D959
13/E995: DAD9 DC5A DDDD DF61 E0E7 E26D E3F5 E57E
13/E9A5: E708 E893 EA1F EBAB ED39 EEC7 F055 F1E5
13/E9B5: F375 F505 F696 F827 F9B9 FB4A FCDC FE6E

; prophecy text
13/E9C5: 02 03 B1 7E 8C A2 91 9A AF B1 FF 8C A8 B3 95 AC
13/E9D5: A2 01 01 02 05 9C B6 99 8F 91 FF A8 8B 8A 10 B1
13/E9E5: 01 01 02 05 AD A9 9D A4 8F B1 7B FF 8F 8F 13 01
13/E9F5: 01 A1 AA B1 A2 9A 9F FF 94 B0 9E B2 AD 91 98 91
13/EA05: 7B FF AC 99 B0 94 B6 C1 01 01 01 01 02 02 9B 90
13/EA15: A3 FF A3 9C 95 9E 90 FF A4 8F B1 9F 9B 9B A8 B3
13/EA25: 01 01 02 02 A3 A3 9E B2 1A 8B 9A 9F FF 8E 8E 8B
13/EA35: 9E B2 FF AB 12 A9 9D 01 01 02 06 16 A4 7B FF 8A
13/EA45: 99 8D B6 C1 01 01 01 02 03 94 B3 1E FF 9B 8F A2
13/EA55: A8 A2 FF 90 7E 8C 98 91 9E B1 C1 01 01 FF 98 A2
13/EA65: 9B 90 A3 FF A9 17 8F B0 A2 A4 8F B1 7B FF AC 9D
13/EA75: AB 9C 01 01 02 03 94 B0 9E B2 FF 99 20 9F FF A9
13/EA85: 9A 20 8F B3 B6 C1 01 01 FF 8E 9E 16 FF 9A 7B FF
13/EA95: A4 91 AC A2 FF A4 9D B1 A3 FF 9B 90 9F 01 01 02
13/EAA5: 04 A4 9D B1 A3 FF A3 A3 9E B2 A7 95 9F 01 01 9D
13/EAB5: 90 A2 9E 10 B3 10 FF 98 A2 AC A2 99 9A 7B FF A4
13/EAC5: 90 A3 9E 94 B6 C1 FF 00

; [  ]

13/EACD: AE 19 7D     LDX $7D19
13/EAD0: 86 36        STX $36
13/EAD2: AD 1E 7D     LDA $7D1E
13/EAD5: 85 38        STA $38
13/EAD7: AE 1B 7D     LDX $7D1B
13/EADA: 86 39        STX $39
13/EADC: A5 39        LDA $39
13/EADE: 18           CLC 
13/EADF: 6D 1D 7D     ADC $7D1D
13/EAE2: 85 3C        STA $3C
13/EAE4: A5 3A        LDA $3A
13/EAE6: 69 00        ADC #$00
13/EAE8: 85 3D        STA $3D
13/EAEA: 7B           TDC 
13/EAEB: A8           TAY 
13/EAEC: A7 36        LDA [$36]
13/EAEE: F0 14        BEQ $EB04
13/EAF0: C9 0F        CMP #$0F
13/EAF2: 90 08        BCC $EAFC
13/EAF4: 20 41 EB     JSR $EB41
13/EAF7: 20 3B EB     JSR $EB3B
13/EAFA: 80 F0        BRA $EAEC
13/EAFC: 20 05 EB     JSR $EB05
13/EAFF: 20 3B EB     JSR $EB3B
13/EB02: 80 E8        BRA $EAEC
13/EB04: 60           RTS 

; [  ]

13/EB05: C9 01        CMP #$01
13/EB07: F0 18        BEQ $EB21
13/EB09: C9 0A        CMP #$0A
13/EB0B: D0 03        BNE $EB10
13/EB0D: 4C 45 EB     JMP $EB45
13/EB10: 20 3B EB     JSR $EB3B
13/EB13: A7 36        LDA [$36]
13/EB15: 85 00        STA $00
13/EB17: A9 FF        LDA #$FF
13/EB19: 20 45 EB     JSR $EB45
13/EB1C: C6 00        DEC $00
13/EB1E: D0 F7        BNE $EB17
13/EB20: 60           RTS 
13/EB21: 4C 24 EB     JMP $EB24

; [  ]

13/EB24: AD 1D 7D     LDA $7D1D
13/EB27: C2 20        REP #$20
13/EB29: 48           PHA 
13/EB2A: 0A           ASL 
13/EB2B: 18           CLC 
13/EB2C: 65 39        ADC $39
13/EB2E: 85 39        STA $39
13/EB30: 68           PLA 
13/EB31: 18           CLC 
13/EB32: 65 39        ADC $39
13/EB34: 85 3C        STA $3C
13/EB36: 7B           TDC 
13/EB37: A8           TAY 
13/EB38: E2 20        SEP #$20
13/EB3A: 60           RTS 
13/EB3B: A6 36        LDX $36
13/EB3D: E8           INX 
13/EB3E: 86 36        STX $36
13/EB40: 60           RTS 

; [  ]

13/EB41: C9 42        CMP #$42
13/EB43: 90 08        BCC $EB4D
13/EB45: 91 3C        STA ($3C),Y
13/EB47: A9 FF        LDA #$FF
13/EB49: 91 39        STA ($39),Y
13/EB4B: C8           INY 
13/EB4C: 60           RTS 
13/EB4D: 38           SEC 
13/EB4E: E9 0F        SBC #$0F
13/EB50: 0A           ASL 
13/EB51: AA           TAX 
13/EB52: BF 40 FA 16  LDA $16FA40,X   ; dakuten
13/EB56: 91 39        STA ($39),Y
13/EB58: BF 41 FA 16  LDA $16FA41,X   ; kana
13/EB5C: 91 3C        STA ($3C),Y
13/EB5E: C8           INY 
13/EB5F: 60           RTS 

; [  ]

13/EB60: AD 20 7D     LDA $7D20
13/EB63: F0 52        BEQ $EBB7
13/EB65: 8B           PHB 
13/EB66: 7B           TDC 
13/EB67: 48           PHA 
13/EB68: AB           PLB 
13/EB69: A9 00        LDA #$00
13/EB6B: 8D 15 21     STA $2115
13/EB6E: A6 92        LDX $92
13/EB70: 8E 16 21     STX $2116
13/EB73: A6 90        LDX $90
13/EB75: 8E 52 43     STX $4352
13/EB78: A9 7E        LDA #$7E
13/EB7A: 8D 54 43     STA $4354
13/EB7D: A9 00        LDA #$00
13/EB7F: 8D 50 43     STA $4350
13/EB82: A9 18        LDA #$18
13/EB84: 8D 51 43     STA $4351
13/EB87: A2 00 01     LDX #$0100
13/EB8A: 8E 55 43     STX $4355
13/EB8D: A9 20        LDA #$20
13/EB8F: 8D 0B 42     STA $420B
13/EB92: A9 80        LDA #$80
13/EB94: 8D 15 21     STA $2115
13/EB97: AB           PLB 
13/EB98: C2 20        REP #$20
13/EB9A: A5 90        LDA $90
13/EB9C: 18           CLC 
13/EB9D: 69 00 01     ADC #$0100
13/EBA0: 85 90        STA $90
13/EBA2: A5 92        LDA $92
13/EBA4: 18           CLC 
13/EBA5: 69 00 01     ADC #$0100
13/EBA8: 85 92        STA $92
13/EBAA: 7B           TDC 
13/EBAB: E2 20        SEP #$20
13/EBAD: A6 92        LDX $92
13/EBAF: E0 00 40     CPX #$4000
13/EBB2: D0 03        BNE $EBB7
13/EBB4: 9C 20 7D     STZ $7D20
13/EBB7: 60           RTS 

; [  ]

13/EBB8: AD 1F 7D     LDA $7D1F
13/EBBB: D0 57        BNE $EC14
13/EBBD: A5 4A        LDA $4A
13/EBBF: 29 1F        AND #$1F
13/EBC1: D0 51        BNE $EC14
13/EBC3: 8B           PHB 
13/EBC4: 7B           TDC 
13/EBC5: 48           PHA 
13/EBC6: AB           PLB 
13/EBC7: A9 00        LDA #$00
13/EBC9: 8D 15 21     STA $2115
13/EBCC: A6 92        LDX $92
13/EBCE: 8E 16 21     STX $2116
13/EBD1: A6 90        LDX $90
13/EBD3: 8E 52 43     STX $4352
13/EBD6: A9 7E        LDA #$7E
13/EBD8: 8D 54 43     STA $4354
13/EBDB: A9 00        LDA #$00
13/EBDD: 8D 50 43     STA $4350
13/EBE0: A9 18        LDA #$18
13/EBE2: 8D 51 43     STA $4351
13/EBE5: A2 80 00     LDX #$0080
13/EBE8: 8E 55 43     STX $4355
13/EBEB: A9 20        LDA #$20
13/EBED: 8D 0B 42     STA $420B
13/EBF0: A9 80        LDA #$80
13/EBF2: 8D 15 21     STA $2115
13/EBF5: AB           PLB 
13/EBF6: C2 20        REP #$20
13/EBF8: A5 90        LDA $90
13/EBFA: 18           CLC 
13/EBFB: 69 20 00     ADC #$0020
13/EBFE: 29 FF 7F     AND #$7FFF
13/EC01: 09 00 80     ORA #$8000
13/EC04: 85 90        STA $90
13/EC06: A5 92        LDA $92
13/EC08: 18           CLC 
13/EC09: 69 80 00     ADC #$0080
13/EC0C: 29 FF 3F     AND #$3FFF
13/EC0F: 85 92        STA $92
13/EC11: 7B           TDC 
13/EC12: E2 20        SEP #$20
13/EC14: 20 60 EB     JSR $EB60
13/EC17: 60           RTS 

; [  ]

13/EC18: DA           PHX 
13/EC19: E6 94        INC $94
13/EC1B: A5 94        LDA $94
13/EC1D: AA           TAX 
13/EC1E: BF 00 EE 14  LDA $14EE00,X
13/EC22: FA           PLX 
13/EC23: 60           RTS 

; [  ]

13/EC24: C2 20        REP #$20
13/EC26: 29 FF 01     AND #$01FF
13/EC29: 0A           ASL 
13/EC2A: AA           TAX 
13/EC2B: BF C5 E5 13  LDA $13E5C5,X
13/EC2F: 10 19        BPL $EC4A
13/EC31: 49 FF FF     EOR #$FFFF
13/EC34: 85 10        STA $10
13/EC36: 20 12 E5     JSR $E512
13/EC39: C2 20        REP #$20
13/EC3B: A5 14        LDA $14
13/EC3D: 49 FF FF     EOR #$FFFF
13/EC40: 1A           INC 
13/EC41: 10 14        BPL $EC57
13/EC43: 85 14        STA $14
13/EC45: 7B           TDC 
13/EC46: E2 20        SEP #$20
13/EC48: 38           SEC 
13/EC49: 60           RTS 
13/EC4A: C2 20        REP #$20
13/EC4C: 85 10        STA $10
13/EC4E: 20 12 E5     JSR $E512
13/EC51: C2 20        REP #$20
13/EC53: A5 14        LDA $14
13/EC55: 30 EC        BMI $EC43
13/EC57: 85 14        STA $14
13/EC59: 7B           TDC 
13/EC5A: E2 20        SEP #$20
13/EC5C: 18           CLC 
13/EC5D: 60           RTS 

; [  ]

13/EC5E: 7B           TDC 
13/EC5F: AA           TAX 
13/EC60: 9D 03 23     STA $2303,X
13/EC63: E8           INX 
13/EC64: E0 00 09     CPX #$0900
13/EC67: D0 F7        BNE $EC60
13/EC69: 7B           TDC 
13/EC6A: AA           TAX 
13/EC6B: BF 00 EE 14  LDA $14EE00,X
13/EC6F: 9D 83 28     STA $2883,X
13/EC72: E8           INX 
13/EC73: E0 80 00     CPX #$0080
13/EC76: D0 F3        BNE $EC6B
13/EC78: 60           RTS 

13/EC79: 1000 2000 A000 4000

; [  ]

13/EC81: 7B           TDC 
13/EC82: AA           TAX 
13/EC83: A8           TAY 
13/EC84: BD 03 23     LDA $2303,X
13/EC87: D0 0D        BNE $EC96
13/EC89: DE 83 28     DEC $2883,X
13/EC8C: F0 03        BEQ $EC91
13/EC8E: 4C 59 ED     JMP $ED59
13/EC91: FE 03 23     INC $2303,X
13/EC94: 80 0D        BRA $ECA3
13/EC96: C2 20        REP #$20
13/EC98: B9 03 2A     LDA $2A03,Y
13/EC9B: C9 40 01     CMP #$0140
13/EC9E: 90 4B        BCC $ECEB
13/ECA0: 7B           TDC 
13/ECA1: E2 20        SEP #$20
13/ECA3: 20 18 EC     JSR $EC18
13/ECA6: 85 00        STA $00
13/ECA8: 29 03        AND #$03
13/ECAA: 9D 83 26     STA $2683,X
13/ECAD: 64 01        STZ $01
13/ECAF: A5 00        LDA $00
13/ECB1: C2 20        REP #$20
13/ECB3: 99 03 29     STA $2903,Y
13/ECB6: 0A           ASL 
13/ECB7: 99 83 27     STA $2783,Y
13/ECBA: A5 00        LDA $00
13/ECBC: 99 03 29     STA $2903,Y
13/ECBF: A5 00        LDA $00
13/ECC1: 29 3F 00     AND #$003F
13/ECC4: 85 02        STA $02
13/ECC6: 29 0F 00     AND #$000F
13/ECC9: 65 02        ADC $02
13/ECCB: 99 03 2A     STA $2A03,Y
13/ECCE: A9 01 00     LDA #$0001
13/ECD1: 99 03 2B     STA $2B03,Y
13/ECD4: DA           PHX 
13/ECD5: A5 00        LDA $00
13/ECD7: 29 03 00     AND #$0003
13/ECDA: 0A           ASL 
13/ECDB: AA           TAX 
13/ECDC: BF 79 EC 13  LDA $13EC79,X
13/ECE0: 99 83 25     STA $2583,Y
13/ECE3: BF 7A EC 13  LDA $13EC7A,X
13/ECE7: 99 84 25     STA $2584,Y
13/ECEA: FA           PLX 
13/ECEB: C2 20        REP #$20
13/ECED: B9 03 2A     LDA $2A03,Y
13/ECF0: 85 00        STA $00
13/ECF2: 85 0E        STA $0E
13/ECF4: B9 83 27     LDA $2783,Y
13/ECF7: 85 02        STA $02
13/ECF9: DA           PHX 
13/ECFA: 20 24 EC     JSR $EC24
13/ECFD: FA           PLX 
13/ECFE: C2 20        REP #$20
13/ED00: A5 14        LDA $14
13/ED02: 18           CLC 
13/ED03: 69 70 00     ADC #$0070
13/ED06: 99 83 24     STA $2483,Y
13/ED09: A5 00        LDA $00
13/ED0B: 85 0E        STA $0E
13/ED0D: A5 02        LDA $02
13/ED0F: 18           CLC 
13/ED10: 69 80 00     ADC #$0080
13/ED13: DA           PHX 
13/ED14: 20 24 EC     JSR $EC24
13/ED17: FA           PLX 
13/ED18: C2 20        REP #$20
13/ED1A: A5 14        LDA $14
13/ED1C: 18           CLC 
13/ED1D: 69 80 00     ADC #$0080
13/ED20: 99 83 23     STA $2383,Y
13/ED23: B9 83 25     LDA $2583,Y
13/ED26: 85 98        STA $98
13/ED28: B9 03 29     LDA $2903,Y
13/ED2B: 18           CLC 
13/ED2C: 65 98        ADC $98
13/ED2E: 99 03 29     STA $2903,Y
13/ED31: B9 03 2B     LDA $2B03,Y
13/ED34: 08           PHP 
13/ED35: 69 00 00     ADC #$0000
13/ED38: 28           PLP 
13/ED39: 69 00 00     ADC #$0000
13/ED3C: 99 03 2B     STA $2B03,Y
13/ED3F: 85 02        STA $02
13/ED41: A5 00        LDA $00
13/ED43: 18           CLC 
13/ED44: 65 02        ADC $02
13/ED46: 99 03 2A     STA $2A03,Y
13/ED49: 4A           LSR 
13/ED4A: 4A           LSR 
13/ED4B: 4A           LSR 
13/ED4C: 4A           LSR 
13/ED4D: 85 00        STA $00
13/ED4F: 7B           TDC 
13/ED50: E2 20        SEP #$20
13/ED52: A5 00        LDA $00
13/ED54: 29 0F        AND #$0F
13/ED56: 9D 03 27     STA $2703,X
13/ED59: C8           INY 
13/ED5A: C8           INY 
13/ED5B: E8           INX 
13/ED5C: E4 96        CPX $96
13/ED5E: F0 03        BEQ $ED63
13/ED60: 4C 84 EC     JMP $EC84
13/ED63: E6 95        INC $95
13/ED65: 60           RTS 

; [  ]

13/ED66: A5 95        LDA $95
13/ED68: D0 01        BNE $ED6B
13/ED6A: 60           RTS 
13/ED6B: 64 95        STZ $95
13/ED6D: 20 FB DD     JSR $DDFB
13/ED70: 7B           TDC 
13/ED71: AA           TAX 
13/ED72: A8           TAY 
13/ED73: DA           PHX 
13/ED74: BD 03 23     LDA $2303,X
13/ED77: F0 47        BEQ $EDC0
13/ED79: DA           PHX 
13/ED7A: 8A           TXA 
13/ED7B: 0A           ASL 
13/ED7C: AA           TAX 
13/ED7D: BD 84 23     LDA $2384,X
13/ED80: 1D 84 24     ORA $2484,X
13/ED83: F0 0A        BEQ $ED8F
13/ED85: A9 F0        LDA #$F0
13/ED87: 99 00 03     STA $0300,Y
13/ED8A: 99 01 03     STA $0301,Y
13/ED8D: 80 0C        BRA $ED9B
13/ED8F: BD 83 23     LDA $2383,X
13/ED92: 99 00 03     STA $0300,Y
13/ED95: BD 83 24     LDA $2483,X
13/ED98: 99 01 03     STA $0301,Y
13/ED9B: FA           PLX 
13/ED9C: BD 83 26     LDA $2683,X
13/ED9F: 0A           ASL 
13/EDA0: 0A           ASL 
13/EDA1: 0A           ASL 
13/EDA2: 0A           ASL 
13/EDA3: 18           CLC 
13/EDA4: 7D 03 27     ADC $2703,X
13/EDA7: AA           TAX 
13/EDA8: BF C7 ED 13  LDA $13EDC7,X
13/EDAC: 85 28        STA $28
13/EDAE: 29 3F        AND #$3F
13/EDB0: 99 02 03     STA $0302,Y
13/EDB3: A5 28        LDA $28
13/EDB5: 29 C0        AND #$C0
13/EDB7: 09 0E        ORA #$0E
13/EDB9: 99 03 03     STA $0303,Y
13/EDBC: C8           INY 
13/EDBD: C8           INY 
13/EDBE: C8           INY 
13/EDBF: C8           INY 
13/EDC0: FA           PLX 
13/EDC1: E8           INX 
13/EDC2: E4 96        CPX $96
13/EDC4: D0 AD        BNE $ED73
13/EDC6: 60           RTS 

13/EDC7: 08 08 08 08 07 07 07 07 06 06 06 06 06 05 05 05
13/EDD7: 08 08 07 07 06 06 05 05 04 04 03 03 02 02 01 01
13/EDE7: 08 07 06 05 04 03 02 03 02 01 00 09 0A 0B 0C 0D
13/EDF7: 08 07 06 05 04 03 02 03 02 01 00 09 0A 0B 0C 0D

; [  ]

13/EE07: EE 1F 7D     INC $7D1F
13/EE0A: A2 00 01     LDX #$0100
13/EE0D: 20 41 DF     JSR $DF41
13/EE10: 20 E8 DB     JSR $DBE8
13/EE13: 8A           TXA 
13/EE14: 38           SEC 
13/EE15: E9 08        SBC #$08
13/EE17: AA           TAX 
13/EE18: E0 78 00     CPX #$0078
13/EE1B: D0 F0        BNE $EE0D
13/EE1D: 7B           TDC 
13/EE1E: AA           TAX 
13/EE1F: 86 9C        STX $9C
13/EE21: A2 80 00     LDX #$0080
13/EE24: 20 12 EF     JSR $EF12
13/EE27: A2 00 01     LDX #$0100
13/EE2A: 86 9E        STX $9E
13/EE2C: 7B           TDC 
13/EE2D: AA           TAX 
13/EE2E: 86 9A        STX $9A
13/EE30: 20 41 DF     JSR $DF41
13/EE33: C2 20        REP #$20
13/EE35: A5 9C        LDA $9C
13/EE37: 38           SEC 
13/EE38: E9 08 00     SBC #$0008
13/EE3B: 85 9C        STA $9C
13/EE3D: C6 9E        DEC $9E
13/EE3F: C6 9E        DEC $9E
13/EE41: A5 9E        LDA $9E
13/EE43: 85 0E        STA $0E
13/EE45: A5 9C        LDA $9C
13/EE47: 18           CLC 
13/EE48: 69 80 00     ADC #$0080
13/EE4B: 20 24 EC     JSR $EC24
13/EE4E: C2 20        REP #$20
13/EE50: A5 14        LDA $14
13/EE52: 85 00        STA $00
13/EE54: 85 06        STA $06
13/EE56: A5 9E        LDA $9E
13/EE58: 85 0E        STA $0E
13/EE5A: A5 9C        LDA $9C
13/EE5C: 20 24 EC     JSR $EC24
13/EE5F: C2 20        REP #$20
13/EE61: E6 9A        INC $9A
13/EE63: A5 9A        LDA $9A
13/EE65: 29 03 00     AND #$0003
13/EE68: D0 0C        BNE $EE76
13/EE6A: AD 05 21     LDA $2105
13/EE6D: F0 07        BEQ $EE76
13/EE6F: 38           SEC 
13/EE70: E9 21 04     SBC #$0421
13/EE73: 8D 05 21     STA $2105
13/EE76: A5 14        LDA $14
13/EE78: 85 02        STA $02
13/EE7A: 49 FF FF     EOR #$FFFF
13/EE7D: 85 04        STA $04
13/EE7F: 20 EF EF     JSR $EFEF
13/EE82: E2 20        SEP #$20
13/EE84: AD 05 21     LDA $2105
13/EE87: D0 A7        BNE $EE30
13/EE89: 20 41 DF     JSR $DF41
13/EE8C: A9 10        LDA #$10
13/EE8E: 8D 28 7D     STA $7D28
13/EE91: A2 FF 7F     LDX #$7FFF
13/EE94: 8E 05 21     STX $2105
13/EE97: A2 C0 0C     LDX #$0CC0
13/EE9A: 8E 07 21     STX $2107
13/EE9D: 7B           TDC 
13/EE9E: AA           TAX 
13/EE9F: 20 41 DF     JSR $DF41
13/EEA2: 7B           TDC 
13/EEA3: 9D 19 3D     STA $3D19,X
13/EEA6: E8           INX 
13/EEA7: E0 00 10     CPX #$1000
13/EEAA: D0 F7        BNE $EEA3
13/EEAC: 20 41 DF     JSR $DF41
13/EEAF: 7B           TDC 
13/EEB0: 9D 19 3D     STA $3D19,X
13/EEB3: E8           INX 
13/EEB4: E0 00 20     CPX #$2000
13/EEB7: D0 F7        BNE $EEB0
13/EEB9: 20 41 DF     JSR $DF41
13/EEBC: 7B           TDC 
13/EEBD: 9D 19 3D     STA $3D19,X
13/EEC0: E8           INX 
13/EEC1: E0 00 30     CPX #$3000
13/EEC4: D0 F7        BNE $EEBD
13/EEC6: 20 41 DF     JSR $DF41
13/EEC9: 7B           TDC 
13/EECA: 9D 19 3D     STA $3D19,X
13/EECD: E8           INX 
13/EECE: E0 00 40     CPX #$4000
13/EED1: D0 F7        BNE $EECA
13/EED3: A9 C0        LDA #$C0
13/EED5: 85 00        STA $00
13/EED7: A9 CC        LDA #$CC
13/EED9: 85 02        STA $02
13/EEDB: 7B           TDC 
13/EEDC: AA           TAX 
13/EEDD: A5 00        LDA $00
13/EEDF: 9D A3 43     STA $43A3,X
13/EEE2: A5 02        LDA $02
13/EEE4: 9D 23 44     STA $4423,X
13/EEE7: E6 00        INC $00
13/EEE9: E6 02        INC $02
13/EEEB: E8           INX 
13/EEEC: E0 0C 00     CPX #$000C
13/EEEF: D0 EC        BNE $EEDD
13/EEF1: 20 41 DF     JSR $DF41
13/EEF4: 7B           TDC 
13/EEF5: AA           TAX 
13/EEF6: 86 66        STX $66
13/EEF8: 86 92        STX $92
13/EEFA: A2 70 00     LDX #$0070
13/EEFD: 86 8E        STX $8E
13/EEFF: A2 19 3D     LDX #$3D19
13/EF02: 86 90        STX $90
13/EF04: EE 20 7D     INC $7D20
13/EF07: 20 41 DF     JSR $DF41
13/EF0A: AD 20 7D     LDA $7D20
13/EF0D: D0 F8        BNE $EF07
13/EF0F: 4C 65 EF     JMP $EF65

; [  ]

13/EF12: 20 41 DF     JSR $DF41
13/EF15: CA           DEX 
13/EF16: D0 FA        BNE $EF12
13/EF18: 60           RTS 

; [  ]

13/EF19: AD 21 7D     LDA $7D21
13/EF1C: D0 25        BNE $EF43
13/EF1E: C2 20        REP #$20
13/EF20: A2 1C 00     LDX #$001C
13/EF23: AD 21 21     LDA $2121
13/EF26: 48           PHA 
13/EF27: BD 03 21     LDA $2103,X
13/EF2A: 9D 05 21     STA $2105,X
13/EF2D: CA           DEX 
13/EF2E: CA           DEX 
13/EF2F: E0 04 00     CPX #$0004
13/EF32: D0 F3        BNE $EF27
13/EF34: 68           PLA 
13/EF35: 8D 09 21     STA $2109
13/EF38: 7B           TDC 
13/EF39: E2 20        SEP #$20
13/EF3B: CE 24 7D     DEC $7D24
13/EF3E: D0 0B        BNE $EF4B
13/EF40: EE 21 7D     INC $7D21
13/EF43: CE 22 7D     DEC $7D22
13/EF46: D0 03        BNE $EF4B
13/EF48: 4C 4C EF     JMP $EF4C
13/EF4B: 60           RTS 
13/EF4C: 9C 21 7D     STZ $7D21
13/EF4F: 9C 23 7D     STZ $7D23
13/EF52: A9 1A        LDA #$1A
13/EF54: 8D 24 7D     STA $7D24
13/EF57: AD 26 7D     LDA $7D26
13/EF5A: EE 26 7D     INC $7D26
13/EF5D: AA           TAX 
13/EF5E: BD 00 EE     LDA $EE00,X
13/EF61: 8D 22 7D     STA $7D22
13/EF64: 60           RTS 

; [  ]

13/EF65: A2 00 00     LDX #$0000
13/EF68: 86 02        STX $02
13/EF6A: 86 04        STX $04
13/EF6C: A2 00 40     LDX #$4000
13/EF6F: 86 00        STX $00
13/EF71: 86 06        STX $06
13/EF73: 20 EF EF     JSR $EFEF
13/EF76: 20 41 DF     JSR $DF41
13/EF79: A9 80        LDA #$80
13/EF7B: 85 A0        STA $A0
13/EF7D: A9 11        LDA #$11
13/EF7F: 8D 28 7D     STA $7D28
13/EF82: 7B           TDC 
13/EF83: AA           TAX 
13/EF84: 86 9C        STX $9C
13/EF86: A2 00 08     LDX #$0800
13/EF89: 86 9E        STX $9E
13/EF8B: 20 41 DF     JSR $DF41
13/EF8E: C2 20        REP #$20
13/EF90: A5 9E        LDA $9E
13/EF92: 38           SEC 
13/EF93: E9 10 00     SBC #$0010
13/EF96: 85 9E        STA $9E
13/EF98: A5 9E        LDA $9E
13/EF9A: 85 0E        STA $0E
13/EF9C: A5 9C        LDA $9C
13/EF9E: 18           CLC 
13/EF9F: 69 80 00     ADC #$0080
13/EFA2: 20 24 EC     JSR $EC24
13/EFA5: C2 20        REP #$20
13/EFA7: A5 14        LDA $14
13/EFA9: 85 00        STA $00
13/EFAB: 85 06        STA $06
13/EFAD: A5 9E        LDA $9E
13/EFAF: 85 0E        STA $0E
13/EFB1: A5 9C        LDA $9C
13/EFB3: 20 24 EC     JSR $EC24
13/EFB6: C2 20        REP #$20
13/EFB8: A5 14        LDA $14
13/EFBA: 85 02        STA $02
13/EFBC: 49 FF FF     EOR #$FFFF
13/EFBF: 85 04        STA $04
13/EFC1: 20 EF EF     JSR $EFEF
13/EFC4: E2 20        SEP #$20
13/EFC6: A6 9E        LDX $9E
13/EFC8: E0 00 02     CPX #$0200
13/EFCB: D0 BE        BNE $EF8B
13/EFCD: A2 B4 00     LDX #$00B4
13/EFD0: 20 12 EF     JSR $EF12
13/EFD3: A9 01        LDA #$01        ; play song $15 (the prelude)
13/EFD5: 8F 00 1E 00  STA $001E00
13/EFD9: A9 15        LDA #$15
13/EFDB: 8F 01 1E 00  STA $001E01
13/EFDF: 22 04 80 04  JSL $048004     ; execute sound command
13/EFE3: 20 4C EF     JSR $EF4C
13/EFE6: EE 25 7D     INC $7D25
13/EFE9: 20 41 DF     JSR $DF41
13/EFEC: 4C E9 EF     JMP $EFE9

; [  ]

13/EFEF: DA           PHX 
13/EFF0: C2 20        REP #$20
13/EFF2: 7B           TDC 
13/EFF3: AA           TAX 
13/EFF4: A5 00        LDA $00
13/EFF6: 9D 19 33     STA $3319,X
13/EFF9: A5 06        LDA $06
13/EFFB: 9D 1B 37     STA $371B,X
13/EFFE: A5 02        LDA $02
13/F000: 9D 1B 33     STA $331B,X
13/F003: A5 04        LDA $04
13/F005: 9D 19 37     STA $3719,X
13/F008: E8           INX 
13/F009: E8           INX 
13/F00A: E8           INX 
13/F00B: E8           INX 
13/F00C: E0 00 04     CPX #$0400
13/F00F: D0 E3        BNE $EFF4
13/F011: 7B           TDC 
13/F012: E2 20        SEP #$20
13/F014: FA           PLX 
13/F015: 60           RTS 

; --------------------------------------------------------------------------

13/F900: 01 04 02 01 04 02 01 04 02

; pointers to megaflare sprite data
13/F909: F919 F91E F923 F934 F959 F96A F97B F98C

; megaflare sprite data
13/F919: 10 10 84 3F FF
13/F91E: 10 10 82 3F FF
13/F923: 08 08 CA 3F 18 08 CA 7F 08 18 CA BF 18 18 CA FF FF
13/F934: 00 00 8C 3F 10 00 8E 3F 20 00 8C 7F 00 10 AC 3F
13/F944: 10 10 AE 3F 20 10 AC 7F 00 20 8C BF 10 20 8E BF
13/F954: 20 20 8C FF FF
13/F959: 08 08 C0 3F 18 08 C2 3F 08 18 A8 3F 18 18 AA 3F FF
13/F96A: 08 08 C2 7F 18 08 C0 7F 08 18 AA 7F 18 18 A8 7F FF
13/F97B: 08 08 AA FF 18 08 A8 FF 08 18 C2 FF 18 18 C0 FF FF
13/F98C: 08 08 A8 BF 18 08 AA BF 08 18 C0 BF 18 18 C2 BF FF

; monster death hdma data
13/F99D: 0101 0202 0404 0808 1010 2120 4240 8480
13/F9AD: 0801 1002 2104 4208 8410 0821 1142 2284
13/F9BD: 4408 8910 1221 2542 4A84 9508 2B11 5622
13/F9CD: AD44 5B89 B712 6F25 DE4A BD95 7B2B F756
13/F9DD: EFAD DF5B BEB7 7D6F FBDE F7BD EF7B DFF7
13/F9ED: BFEF 7FDF FFBE FE7D FDFB FBF7 F7EF EFDF
13/F9FD: DFBF BF7F 7FFF FFFE FFFD FFFB FFF7 FFEF
13/FA0D: FFDF FFBF FF7F FFFF FFFF FFFF FFFF FFFF
13/FA1D: FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF
13/FA2D: FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF
13/FA3D: FFFF FFFF FFFF FFFF FFFF FFFF FFFF FFFF
13/FA4D: FFFF FFFF FFFF FFFF FFFF FFFF

; summon sprite position data (17 * 4 bytes)
;   $00: x position
;   $01: y position
;   $02: width (in 16x16 tiles)
;   $03: height
13/FA59: C8 44 02 02 C8 44 02 02 C0 44 03 02 C0 3C 03 03
13/FA69: C8 44 02 02 C0 3C 03 03 C0 3C 03 03 B8 3C 04 03
13/FA79: C0 30 03 04 B0 3C 05 04 D0 2A 01 05 B8 2C 04 05
13/FA89: B8 2C 03 05 B8 2C 04 05 B8 2C 04 05 B8 2C 04 05
13/FA99: A8 30 05 04

13/FA9D: 00 00 00 00 01 01 01 01 02 02 02 02 03 03 03 03
13/FAAD: 04 05 04 05 06 07 06 07 08 09 08 09 0A 0B 0A 0B
13/FABD: 0C 0D 0C 0D 0E 0F 0E 0F 10 11 12 12 13 14 15 15
13/FACD: 16 17 16 17 18 19 1A 18 19 1A 18 19 1A 18 19 1A
13/FADD: 1B 1C 1B 1C

; character status sprite data
; 2 frames per status, 2 sprites per frame, 4 bytes per sprite
13/FAE1: 00 00 FF 01 00 00 FF 01 00 00 FF 01 00 00 FF 01
13/FAF1: 08 F8 60 3D 10 F8 61 3D 00 00 FF 01 00 00 FF 01
13/FB01: 10 00 62 3D 18 00 63 3D 10 00 64 3D 18 00 65 3D
13/FB11: 10 F8 6C 3D 18 F8 6C 7D 10 F8 6D 3D 18 F8 6D 7D
13/FB21: 08 00 66 3D 08 08 67 3D 20 00 66 7D 20 08 67 7D
13/FB31: 10 08 68 3D 10 08 68 3D 10 08 69 3D 10 08 69 3D
13/FB41: 10 10 7C 3D 18 10 7C 7D 10 10 7C 3D 18 10 7C 7D
13/FB51: 10 F0 6A 3D 18 F0 6B 3D 10 F0 6B FD 18 F0 6A FD
13/FB61: 18 F8 6E 3D 20 F8 6F 3D 18 F8 6F 7D 20 F8 6E 7D
13/FB71: 10 F8 00 3D 18 F8 00 3D 10 F8 00 3D 18 F8 00 3D

; character animated pose table
13/FB81: 1E 1E 1E 1E 00 00 00 00 01 01 01 01 00 02 00 02
13/FB91: 03 03 03 03 04 04 02 02 06 06 05 05 07 07 07 07
13/FBA1: 00 08 00 08 09 09 09 09 0A 0B 0A 0B 0A 0A 0A 0A
13/FBB1: 08 08 08 08 04 04 04 04 24 24 24 24 24 24 24 24
13/FBC1: 00 00 00 00 0C 0C 0C 0C 0D 0D 0D 0D 0E 0C 0E 0C
13/FBD1: 0F 0F 0F 0F 10 10 0E 0E 10 10 0E 0E 11 11 11 11
13/FBE1: 0C 12 0C 12 13 13 13 13 14 15 14 15 14 14 14 14
13/FBF1: 0C 0C 0C 0C 10 10 10 10 0C 0C 0C 0C 0C 0C 0C 0C
13/FC01: 00 00 00 00 16 16 16 16 17 17 17 17 16 18 16 18
13/FC11: 19 19 19 19 1A 1A 18 18 1A 1A 18 18 1B 1B 1B 1B
13/FC21: 16 1C 16 1C 1D 1D 1D 1D 16 16 16 16 16 16 16 16
13/FC31: 16 16 16 16 1A 1A 1A 1A 16 16 16 16 16 16 16 16
13/FC41: 00 00 00 00 00 00 00 00 00 00 00 00 00 1F 00 1F
13/FC51: 00 00 00 00 00 00 00 00 00 00 00 00 1F 1F 1F 1F
13/FC61: 00 22 00 22 23 23 23 23 20 21 20 21 20 20 20 20
13/FC71: 22 22 22 22 00 00 00 00 00 00 00 00 00 00 00 00
13/FC81: 00 00 00 00 00 00 00 00 01 01 01 01 00 02 00 02
13/FC91: 03 03 03 03 04 04 02 02 06 06 05 05 07 07 07 07
13/FCA1: 00 08 00 08 09 09 09 09 01 01 01 01 00 08 00 08
13/FCB1: 08 08 08 08 04 04 04 04 08 08 08 08 08 08 08 08
13/FCC1: 08 08 08 08

; h-scroll values for shaking monster frame transition
13/FCC5: FFFE FFFF FFFE FFFD FFFF 0000 FFFE FFFD

13/FCD5:                FF FF FF FF FF FF FF FF FF FF FF
13/FCE5: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF
13/FCF5: FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

; battles with no party update
13/FD00: 00EB 00F5 00F0 00F6 00FA 01A9 00FE 00F3
13/FD10: 01B3 01B4 01B7 01B8 FF

; status 1 and 2 that disable each command (30 * 2 bytes)
13/FD19: 00 00  ; $00: fight
13/FD1B: 00 00  ; $01: item
13/FD1D: 2C 00  ; $02: white magic          toad, pig, mute
13/FD1F: 04 00  ; $03: black magic          mute
13/FD21: 2C 00  ; $04: summon               toad, pig, mute
13/FD23: 38 00  ; $05: dark wave            toad, mini, pig
13/FD25: 30 00  ; $06: jump 1               toad, mini
13/FD27: 2C 00  ; $07: recall               toad, pig, mute
13/FD29: 04 00  ; $08: sing                 mute
13/FD2B: 00 00  ; $09: hide    
13/FD2D: 00 00  ; $0A: salve    
13/FD2F: 00 00  ; $0B: pray    
13/FD31: 38 00  ; $0C: aim                  toad, mini, pig
13/FD33: 39 00  ; $0D: focus 1              toad, mini, poison
13/FD35: 38 40  ; $0E: kick                 toad, mini, pig, float
13/FD37: 38 00  ; $0F: brace                toad, mini, pig
13/FD39: 3C 00  ; $10: twin 1               toad, mini, pig, mute
13/FD3B: 38 00  ; $11: bluff                toad, mini, pig
13/FD3D: 38 00  ; $12: cry                  toad, mini, pig
13/FD3F: 30 00  ; $13: cover                toad, mini
13/FD41: 38 00  ; $14: search (peep)        toad, mini, pig
13/FD43: 38 00  ; $15: airship ???          toad, mini, pig
13/FD45: 30 00  ; $16: throw (dart)         toad, mini
13/FD47: 20 00  ; $17: steal (sneak)        toad
13/FD49: 2C 00  ; $18: ninjutsu             toad, pig, mute
13/FD4B: 38 00  ; $19: regen                toad, mini, pig
13/FD4D: 00 00  ; $1A: change row
13/FD4F: 00 00  ; $1B: defend
13/FD51: 00 00  ; $1C: appear (show)
13/FD53: 00 00  ; $1D: don't cover (off)

; battle commands for each character (22 * 5 bytes)
13/FD55: 00 05 01 FF FF
13/FD5A: 00 06 01 FF FF
13/FD5F: 00 02 03 04 01
13/FD64: 00 02 03 07 01
13/FD69: 00 08 0A 09 01
13/FD6E: 00 02 0B 0C 01
13/FD73: 00 0D 0E 0F 01
13/FD78: 00 03 10 11 01
13/FD7D: 00 02 10 12 01
13/FD82: 00 02 03 07 01
13/FD87: 00 02 13 01 FF
13/FD8C: 00 02 03 01 FF
13/FD91: 00 0D 0E 0F 01
13/FD96: 00 14 01 FF FF
13/FD9B: 00 06 01 FF FF
13/FDA0: 00 02 0B 0C 01
13/FDA5: 00 03 04 01 FF
13/FDAA: 00 18 16 17 01
13/FDAF: 00 02 03 19 01
13/FDB4: 00 06 01 FF FF
13/FDB9: 00 FF FF FF FF
13/FDBE: 00 FF FF FF FF

; battle command targeting flags -> $3302 (26 * 1 byte)
13/FDC3: 50 00 00 00 00 60 58 60 50 00 20 20 50 50 60 00
13/FDD3: 60 00 60 18 58 60 50 50 00 28

; spell lists for each character (see 14/FFA2 for menu)
13/FDDD: FF FF FF
13/FDE0: FF FF FF
13/FDE3: 02 03 04
13/FDE6: 05 06 FF
13/FDE9: FF FF FF
13/FDEC: 07 FF FF
13/FDEF: FF FF FF
13/FDF2: FF 08 FF
13/FDF5: 09 FF FF
13/FDF8: 00 FF FF
13/FDFB: FF FF FF
13/FDFE: FF 03 04
13/FE01: FF 0C FF
13/FE04: 0A 0B FF
13/FE07: 0A 0B FF
13/FE0A: FF FF FF

; battles with auto-battle scripts
13/FE0D: 00EB 00F5 00EE 00F0 00F3 00FD 01B3 01B4

; pointers to auto-battle scripts
13/FE1D: FE2D FE30 FE33 FE36 FE3B FE46 FE4B FE5D

; auto-battle scripts
;   00: use magic
;   01: use item
;   C0+: use command
;   FF: end of script (loop to beginning)

; 0: 1st intro battle
13/FE2D: 01 C0  ; use item: fire bomb
13/FE2F: FF     ; end of script

; 1: 2nd intro battle
13/FE30: 01 C2  ; use item: lit-bolt
13/FE32: FF     ; end of script

; 2: cecil vs. mirror
13/FE33: C0 00  ; use command: fight
13/FE35: FF     ; end of script

; 3: yang
13/FE36: CE 00  ; use command: kick
13/FE38: C0 00  ; use command: fight
13/FE3A: FF     ; end of script

; 4: tellah vs. golbez
13/FE3B: 00 26  ; use magic: virus
13/FE3D: 00 1F  ; use magic: fire 3
13/FE3F: 00 25  ; use magic: lit 3
13/FE41: 00 22  ; use magic: ice 3
13/FE43: 00 2F  ; use magic: meteo
13/FE45: FF     ; end of script

; 5: edge vs. rubicante
13/FE46: C0 00  ; use command: fight
13/FE48: 00 42  ; use magic: flame
13/FE4A: FF     ; end of script

; 6: 1st fusoya and golbez vs. zemus
13/FE4B: 00 07  ; use magic: slow
13/FE4D: 00 01  ; use magic: hold
13/FE4F: 00 0B  ; use magic: holy
13/FE51: 00 0B  ; use magic: holy
13/FE53: FF     ; end of script
; golbez
13/FE54: 00 1F  ; use magic: fire 3
13/FE56: 00 22  ; use magic: ice 3
13/FE58: 00 25  ; use magic: lit 3
13/FE5A: D0 00  ; use command: twin
13/FE5C: FF     ; end of script

; 7: 2nd fusoya and golbez vs. zemus
13/FE5D: 00 2F  ; use magic: meteo
13/FE5F: 00 0C  ; use magic: dispel
13/FE61: FF     ; end of script
; golbez
13/FE62: 00 2F  ; use magic: meteo
13/FE64: 01 C8  ; use item: crystal
13/FE66: FF     ; end of script

; battles with no victory fanfare
13/FE67: 00DC 00DD 00E1 00E7 01A7 01AF 01B6 FF

; battles with no victory animation
13/FE76: 00EB 00F5 00F0 00FA 01A9 00FE 00F3 01B4 01B7 FF

; action delay for each command (35 * 1 bytes)

; if msb set, delay is turn duration * x, otherwise delay is turn duration / x

13/FE89: 00 00 00 00 00 02 01 01 00 00 04 02 04 00 81 00
13/FE99: 00 00 00 00 00 00 04 00 00 00 00 00 00 00 00 82
13/FEA9: 83 00 8A

; equipment stat modifiers (8 * 2 bytes)
;   0: modifier for stats with bit set
;   1: modifier for stats with bit clear
13/FEAC: 03 00  ; +3/+0
13/FEAE: 05 00  ; +5/+0
13/FEB0: 0A 00  ; +10/+0
13/FEB2: 0F 00  ; +15/+0
13/FEB4: 05 FB  ; +5/-5
13/FEC6: 0A F6  ; +10/-10
13/FEC8: 0F F1  ; +15/-15
13/FECA: 05 F6  ; +5/-10

; attacks with no name display (192 * 1 bit)

; $73:  (dimensional distortion/zeromus shakes)
; $76:  (curse song)
; $7B:  (dark regression/vanish)
; $7E:  (princess song/dancing)
; $8E: no effect
; $8F:  (dark regression/vanish)
; $93:  (remove curse/heal)
; $A9: make monsters invincible
; $AA: make monsters un-invincible
; $AD: change to next form
; $AE: end battle
; $AF: graphics only
; $B0-$BF: special animations

13/FEBC: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 12 12
13/FECC: 00 03 10 00 00 67 FF FF

; attacks with no monster flash (192 * 1 bit)

; $73: disrupt
; $77: hold gas
; $7B: vanish
; $7D: black hole
; $7E: dancing
; $81: magnet
; $83: hatch
; $87: big bang
; $8C: alert
; $8D: call
; $8F: vanish
; $95: globe199
; $AD: change to next form

13/FED4: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 11 16
13/FEE4: 51 0D 04 00 00 04 00 00

; summon book attacks (single random target if msb set)
13/FEEC: D1 52 53 54 55 56 D7 58 59 5D

; inverted bit masks
13/FEF6: 7F BF DF EF F7 FB FD FE

; bit masks
13/FEFE: 80 40 20 10 08 04 02 01

; battle speed constants
13/FF06: 00 01 03 05 07 0A

; battle songs
13/FF0C: 27 1A 0B

; monster run difficulty (based on monster level)
;   97:  (lil' murderer/tricker)
;        (ging-ryu)
;        (red giant)
;        (king-ryu)
;   98:  (zemus' breath)
;        (zemus' mind)
;        (blue dragon)
;   99:  (phase/evil mask)
;        (ahriman/fatal eye)
;        (lunar saurus)
;        (dark bahamut/wyvern)
;        (red dragon)
;        (behemoth)
13/FF0F: 03 07 0A

; [ play battle song ]

13/FF12: 85 A9        STA $A9
13/FF14: 9C 00 1E     STZ $1E00
13/FF17: 9C 01 1E     STZ $1E01
13/FF1A: 9C 05 1E     STZ $1E05
13/FF1D: A5 A9        LDA $A9
13/FF1F: 8D 01 1E     STA $1E01
13/FF22: A9 01        LDA #$01
13/FF24: 8D 00 1E     STA $1E00
13/FF27: 22 04 80 04  JSL $048004     ; execute sound command
13/FF2B: AD 05 1E     LDA $1E05
13/FF2E: C5 A9        CMP $A9
13/FF30: D0 EB        BNE $FF1D
13/FF32: AD 04 1E     LDA $1E04
13/FF35: C9 01        CMP #$01
13/FF37: D0 E4        BNE $FF1D
13/FF39: 6B           RTL 

; [ validate dead character hp ]

; set all dead characters' hp to zero

13/FF3A: 7B           TDC 
13/FF3B: AA           TAX 
13/FF3C: A8           TAY 
13/FF3D: B9 40 35     LDA $3540,Y
13/FF40: D0 0B        BNE $FF4D       ; branch if not present
13/FF42: BD 03 20     LDA $2003,X
13/FF45: 10 06        BPL $FF4D       ; branch if not dead
13/FF47: 9E 07 20     STZ $2007,X     ; set hp to zero
13/FF4A: 9E 08 20     STZ $2008,X
13/FF4D: C2 20        REP #$20
13/FF4F: 8A           TXA 
13/FF50: 18           CLC 
13/FF51: 69 80 00     ADC #$0080
13/FF54: AA           TAX 
13/FF55: 7B           TDC 
13/FF56: E2 20        SEP #$20
13/FF58: C8           INY 
13/FF59: C0 05 00     CPY #$0005
13/FF5C: D0 DF        BNE $FF3D
13/FF5E: 6B           RTL 

; [ divide (16-bit) ]

13/FF5F: A6 AB        LDX $AB
13/FF61: DA           PHX 
13/FF62: A2 0F 00     LDX #$000F
13/FF65: 74 A9        STZ $A9,X
13/FF67: CA           DEX 
13/FF68: 10 FB        BPL $FF65
13/FF6A: FA           PLX 
13/FF6B: 86 AD        STX $AD
13/FF6D: AE 91 35     LDX $3591
13/FF70: 86 A9        STX $A9
13/FF72: AD 93 35     LDA $3593
13/FF75: 85 AB        STA $AB
13/FF77: C2 20        REP #$20
13/FF79: 18           CLC 
13/FF7A: A2 20 00     LDX #$0020
13/FF7D: 26 A9        ROL $A9
13/FF7F: 26 AB        ROL $AB
13/FF81: 26 B5        ROL $B5
13/FF83: 26 B7        ROL $B7
13/FF85: 38           SEC 
13/FF86: A5 B5        LDA $B5
13/FF88: E5 AD        SBC $AD
13/FF8A: 85 B5        STA $B5
13/FF8C: A5 B7        LDA $B7
13/FF8E: E5 AF        SBC $AF
13/FF90: 85 B7        STA $B7
13/FF92: B0 0D        BCS $FFA1
13/FF94: A5 B5        LDA $B5
13/FF96: 65 AD        ADC $AD
13/FF98: 85 B5        STA $B5
13/FF9A: A5 B7        LDA $B7
13/FF9C: 65 AF        ADC $AF
13/FF9E: 85 B7        STA $B7
13/FFA0: 18           CLC 
13/FFA1: 26 B1        ROL $B1
13/FFA3: 26 B3        ROL $B3
13/FFA5: CA           DEX 
13/FFA6: D0 D5        BNE $FF7D
13/FFA8: A5 B1        LDA $B1
13/FFAA: 85 AD        STA $AD
13/FFAC: A5 B3        LDA $B3
13/FFAE: 85 AF        STA $AF
13/FFB0: 7B           TDC 
13/FFB1: E2 20        SEP #$20
13/FFB3: 6B           RTL 

; [ disable regen based on fusoya's status ]

13/FFB4: A0 05 00     LDY #$0005
13/FFB7: 7B           TDC 
13/FFB8: AA           TAX 
13/FFB9: BD 00 20     LDA $2000,X
13/FFBC: 29 1F        AND #$1F
13/FFBE: C9 13        CMP #$13
13/FFC0: D0 15        BNE $FFD7       ; branch if not fusoya
13/FFC2: BD 03 20     LDA $2003,X
13/FFC5: 29 C0        AND #$C0
13/FFC7: D0 07        BNE $FFD0       ; branch if dead or stone
13/FFC9: BD 04 20     LDA $2004,X
13/FFCC: 29 3C        AND #$3C
13/FFCE: F0 15        BEQ $FFE5       ; paralyze, sleep, charm, berserk
13/FFD0: A9 FF        LDA #$FF
13/FFD2: 8D 7C 35     STA $357C       ; disable regen
13/FFD5: 80 0E        BRA $FFE5
13/FFD7: C2 20        REP #$20
13/FFD9: 8A           TXA 
13/FFDA: 18           CLC 
13/FFDB: 69 80 00     ADC #$0080
13/FFDE: AA           TAX 
13/FFDF: 7B           TDC 
13/FFE0: E2 20        SEP #$20
13/FFE2: 88           DEY 
13/FFE3: D0 D4        BNE $FFB9
13/FFE5: 6B           RTL 

13/FFE6:                   FF FF FF FF FF FF FF FF FF FF
13/FFF0: FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

13/FFF7: 4C 52 D6     JMP $D652       ; solar system (prophecy)
13/FFFA: 4C 2B D6     JMP $D62B       ; solar system (moon departs)
13/FFFD: 4C 10 D6     JMP $D610       ; end credits

; --------------------------------------------------------------------------

14/F380: 00 03 07 0A 0F 13 17 1B 20 25 2A 2F 34 39 3E 44
14/F390: 4A 50 56 5D 64 6B 72 7A 82 8B 94 9D A8 B3 BF CC
14/F3A0: DA

14/F3A1: 00 02 04 06 09 0C 0F 12 16 19 1C 1F 23 27 2A 2D
14/F3B1: 31 35 39 3D 41 46 4A 4F 54 59 5E 63 68 6D 73 79
14/F3C1: 7F 86 8C 93 9A A2 AA B2 BB C4 CD D8 E4

; airship zoom data
14/F3CE: 80 7F 7E 7E 7D 7C 7C 7B 7A 7A 79 78 78 77 76 76
14/F3DE: 75 75 74 73 73 72 71 71 70 70 6F 6E 6E 6D 6D 6C
14/F3EE: 6B 6B 6A 6A 69 69 68 67 67 66 66 65 65 64 64 63
14/F3FE: 63 62 61 61 60 60 5F 5F 5E 5E 5D 5D 5C 5C 5B 5B
14/F40E: 5A 5A 59 59 58 58 57 57 56 56 55 55 54 54 53 53
14/F41E: 52 52 52 51 51 50 50 4F 4F 4E 4E 4D 4D 4D 4C 4C
14/F42E: 4B 4B 4A 4A 4A 49 49 48 48 47 47 47 46 46 45 45
14/F43E: 45 44 44 43 43 42 42 42 41 41 41 40 40 3F 3F 3F
14/F44E: 3E 3E 3D 3D 3D 3C 3C 3C 3B 3B 3A 3A 3A 39 39 39
14/F45E: 38 38 38 37 37 37 36 36 35 35 35 34 34 34 33 33
14/F46E: 33 32 32 32 31 31 31 30 30 30 2F 2F 2F 2E 2E 2E
14/F47E: 2E 2D 2D 2D 2C 2C 2C 2B 2B 2B 2A 2A 2A 29 29 29
14/F48E: 29 28 28 28 27 27 27 26 26 26 26 25 25 25 24 24
14/F49E: 24 24 23 23 23 22 22 22 22 21 21 21 21 20 20 20

; big whale zoom data
14/F4AE: C0 BF BE BD BC BB BA B9 B8 B7 B6 B6 B5 B4 B3 B2
14/F4BE: B1 B0 AF AF AE AD AC AB AA AA A9 A8 A7 A6 A5 A5
14/F4CE: A4 A3 A2 A1 A1 A0 9F 9E 9E 9D 9C 9B 9B 9A 99 98
14/F4DE: 98 97 96 95 95 94 93 93 92 91 90 90 8F 8E 8E 8D
14/F4EE: 8C 8C 8B 8A 8A 89 88 88 87 86 86 85 85 84 83 83
14/F4FE: 82 81 81 80 80 7F 7E 7E 7D 7D 7C 7B 7B 7A 7A 79
14/F50E: 78 78 77 77 76 76 75 74 74 73 73 72 72 71 71 70
14/F51E: 70 6F 6E 6E 6D 6D 6C 6C 6B 6B 6A 6A 69 69 68 68
14/F52E: 67 67 66 66 65 65 64 64 63 63 62 62 61 61 60 60
14/F53E: 5F 5F 5F 5E 5E 5D 5D 5C 5C 5B 5B 5A 5A 5A 59 59
14/F54E: 58 58 57 57 56 56 56 55 55 54 54 53 53 53 52 52
14/F55E: 51 51 51 50 50 4F 4F 4F 4E 4E 4D 4D 4D 4C 4C 4B
14/F56E: 4B 4B 4A 4A 49 49 49 48 48 48 47 47 46 46 46 45
14/F57E: 45 45 44 44 44 43 43 42 42 42 41 41 41 40 40 40

; ??? sprite data (3 * 6*4 bytes)
14/F58E: 00 00 38 15
14/F592: 10 00 3A 15
14/F596: 00 10 3C 15
14/F59A: 10 10 3E 15
14/F59E: 00 20 50 15
14/F5A2: 10 20 52 15

14/F5A6: 00 00 3A 55
14/F5AA: 10 00 38 55
14/F5AE: 00 10 3E 55
14/F5B2: 10 10 3C 55
14/F5B6: 00 20 52 55
14/F5BA: 10 20 50 55

14/F5BE: 00 00 54 15
14/F5C2: 10 00 56 15
14/F5C6: 00 10 58 15
14/F5CA: 10 10 5A 15
14/F5CE: 00 20 5C 15
14/F5D2: 10 20 5E 15

14/F5D6: A0 15 A2 15 A8 15 AA 15 A4 15 A6 15 AC 15 AE 15
14/F5E6: AE D5 AC D5 A6 D5 A4 D5 AA D5 A8 D5 A2 D5 A0 D5

; gp window tile data
14/F5F6: 16 20 17 20 17 20 17 20 17 20 17 20 17 20 17 20
14/F606: 17 20 17 20 17 20 18 20 19 20 FF 20 FF 20 FF 20
14/F616: FF 20 FF 20 FF 20 FF 20 FF 20 C0 20 FF 20 1A 20
14/F626: 19 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20
14/F636: FF 20 D0 20 F2 20 1A 20 1B 20 1C 20 1C 20 1C 20
14/F646: 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1D 20

; selection window tile data
14/F656: 16 20 17 20 17 20 17 20 17 20 17 20 17 20 18 20
14/F666: 19 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 1A 20
14/F676: 19 20 FF 20 14 20 A3 20 8B 20 FF 20 FF 20 1A 20
14/F686: 19 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 1A 20
14/F696: 19 20 FF 20 FF 20 8B 20 8B 20 8D 20 FF 20 1A 20
14/F6A6: 19 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 1A 20
14/F6B6: 1B 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1D 20
14/F6C6: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

; dialogue window tile data
14/F6D6: 00 20 00 20 16 20 17 20 17 20 17 20 17 20 17 20
14/F6E6: 17 20 17 20 17 20 17 20 17 20 17 20 17 20 17 20
14/F6F6: 17 20 17 20 17 20 17 20 17 20 17 20 17 20 17 20
14/F706: 17 20 17 20 17 20 17 20 17 20 18 20 00 20 00 20
14/F716: 00 20 00 20 1B 20 1C 20 1C 20 1C 20 1C 20 1C 20
14/F726: 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20
14/F736: 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20
14/F746: 1C 20 1C 20 1C 20 1C 20 1C 20 1D 20 00 20 00 20
14/F756: 00 20 00 20 19 20 FF 20 FF 20 FF 20 FF 20 FF 20
14/F766: FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20
14/F776: FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20 FF 20
14/F786: FF 20 FF 20 FF 20 FF 20 FF 20 1A 20 00 20 00 20

; map name window tile data
14/F796: 16 20 17 20 17 20 17 20 17 20 17 20 17 20 17 20
14/F7A6: 17 20 17 20 17 20 17 20 17 20 17 20 17 20 18 20
14/F7B6: 1B 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20
14/F7C6: 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1C 20 1D 20

; big whale, tower of zot/babil, giant of babil animated palette data

; animated tower/giant colors
14/F7D6: 76C0 5A00 3D60 1CA0 1CA0 3D60 5A00 76C0  ; blue light
14/F7E6: 0007 0007 000D 0014 001B 001B 0014 000D  ; red light
14/F7F6: 018F 0256 033D 033D 0256 018F 00C7 00C7  ; yellow light

; unused ???
14/F806: 01F7 0112 008E 000B 0007 0005 0002 0000
14/F816: 0000 0000 0000 0000 0000 0000 0000 0000

; blue shifted palette
14/F826: 7FFF 7B91 76C0 6620 5940 44A0 2800 0000
14/F836: 0000 2800 44A0 5940 6620 76C0 7B91 7FFF

; npc sprite data
14/F846: 00 01 04 2C 00 09 06 2C 08 01 05 2C 08 09 07 2C
14/F856: 00 01 04 2C 00 09 07 6C 08 01 05 2C 08 09 06 6C
14/F866: 00 01 09 6C 00 09 0B 6C 08 01 08 6C 08 09 0A 6C
14/F876: 00 00 0D 6C 00 08 0F 6C 08 00 0C 6C 08 08 0E 6C
14/F886: 00 01 00 2C 00 09 02 2C 08 01 01 2C 08 09 03 2C
14/F896: 00 01 00 2C 00 09 03 6C 08 01 01 2C 08 09 02 6C
14/F8A6: 00 01 08 2C 00 09 0A 2C 08 01 09 2C 08 09 0B 2C
14/F8B6: 00 00 0C 2C 00 08 0E 2C 08 00 0D 2C 08 08 0F 2C
14/F8C6: 00 00 14 2C 08 00 15 2C 00 08 16 2C 08 08 17 2C
14/F8D6: 00 00 18 2C 08 00 19 2C 00 08 1A 2C 08 08 1B 2C
14/F8E6: 00 00 18 2C 08 00 19 2C 00 08 1A 2C 08 08 1B 2C
14/F8F6: 00 00 18 2C 08 00 19 2C 00 08 1A 2C 08 08 1B 2C
14/F906: 00 00 10 2C 08 00 11 2C 00 08 12 2C 08 08 13 2C
14/F916: 00 00 10 2C 08 00 11 2C 00 08 12 2C 08 08 13 2C
14/F926: 00 00 1C 2C 08 00 1D 2C 00 08 1E 2C 08 08 1F 2C
14/F936: 00 00 1C 2C 08 00 1D 2C 00 08 1E 2C 08 08 1F 2C
14/F946: 00 01 00 2C 00 09 02 2C 08 01 01 2C 08 09 03 2C
14/F956: 00 01 04 2C 00 09 06 2C 08 01 05 2C 08 09 07 2C
14/F966: 00 01 08 2C 00 09 0A 2C 08 01 09 2C 08 09 0B 2C
14/F976: 00 01 0C 2C 00 09 0E 2C 08 01 0D 2C 08 09 0F 2C
14/F986: 00 01 01 6C 00 09 03 6C 08 01 00 6C 08 09 02 6C

14/F996: 4000 4000 4000 4000 4000 4000 4000 4000
14/F9A6: 4000 4000 4000 4000 4000 4000 4000 4000
14/F9B6: 4000 4400 4800 4C00 5000 5400 5800 5C00
14/F9C6: 6000 6400 6800 6C00 7000 7400 7800 7C00

14/F9D6: F8 F8 C8 31 00 FF C8 71 F0 FF C8 B1 00 FF C8 F1
14/F9E6: F8 F8 CA 31 00 FF CA 71 F0 FF CA B1 00 FF CA F1
14/F9F6: F0 F0 CC 31 00 F0 CE 31 F0 00 CC B1 00 00 CE B1
14/FA06: F0 F0 E0 31 00 F0 E2 31 F0 00 E0 B1 00 00 E2 B1

; animated lava palette (underground)
14/FA16: 63FF 4BFF 2F9F 2F3F 265F 150E 0095 0C0E
14/FA26: 5BFF 3F9F 337F 2AFF 1A1E 150E 0074 0C0E
14/FA36: 53FF 335F 2B1F 2ABF 11BC 150E 0074 080E
14/FA46: 4BFF 277F 26FF 267F 095B 150E 0053 080E

14/FA56: 40 68 00 30 48 68 01 30 40 70 02 30 48 70 03 30

; mosaic data (event)
14/FA66: 0F 1F 2F 3F 4F 5F 6F 7F 8F 9F AF BF CF DF EF FF
14/FA76: EF DF CF BF AF 9F 8F 7F 6F 5F 4F 3F 2F 1F 0F 0F

; tunnel to underground y-offsets
14/FA86: 10 11 11 12 13 14 15 16 17 18 19 1B 1C 1E 1F 21
14/FA96: 23 24 26 28 2A 2D 2F 31 33 36 38 3B 3E 40 43 46
14/FAA6: 49 4C 4F 53 56 59 5D 60 64 68 6B 6F 73 77 7B 7F

; tunnel to underground rotation angles
14/FAB6: 01 02 04 06 09 0C 10 14 19 1E 23 29 30 36 3E 45
14/FAC6: 4E 56 5F 69 73 7D 88 94 9F AC B8 C6 D3 E1 F0 FF

14/FAD6: 70 70 00 00 78 70 01 00 70 78 02 00 78 78 03 00

14/FAE6: 70 70 04 00 78 70 05 00 70 78 06 00 78 78 07 00

14/FAF6: 20 21 21 22 23 24 25 26 28 29 2B 2C 2E 30 32 34
14/FB06: 36 38 3A 3D 3F 42 44 47 4A 4D 50 53 57 5A 5E 61
14/FB16: 65 69 6C 70 75 79 7D 81

; scanlines for screen wipe
14/FB1E: 7F 6E 7E 6E 7E 6E 7D 6D 7C 6C 7B 6B 79 6A 77 68
14/FB2E: 75 66 72 64 70 61 6C 5F 69 5C 66 59 62 55 5E 52
14/FB3E: 59 4E 55 4A 50 46 4B 42 46 3D 41 39 3B 34 36 2F
14/FB4E: 30 2A 2A 25 24 20 1E 1A 18 15 12 10 0C 0A 06 05

; world map battle effect zoom values
14/FB5E: 10 11 12 13 14 15 16 15 14 13 12 11 10 11 12 13
14/FB6E: 14 15 16 15 14 13 12 11 10 0F 0E 0D 0C 0B 0A 08
14/FB7E: 07 06 05 04 03 02 01 00

14/FB86: 00 03 06 09 0B 0D 0F 10 10 10 0F 0D 0B 09 06 03
14/FB96: 00 FD FA F7 F5 F3 F1 F0 F0 F0 F1 F3 F5 F7 FA FD

; shop types
14/FBA6: 00 00 00 00 00 00 00 00 00 00 01 01 01 01 01 01
14/FBB6: 01 01 02 02 02 02 00 01 02 02 00 01 00 01 02 02

; cave of monsters animated palette
14/FBC6: 00D0 00AE 008C 006A 0048 006A 008C 00AE
14/FBD6: 000A 004A 0048 0026 0024 0026 0028 004A
14/FBE6: 0054 0008 0006 0004 0002 0004 0006 0008
14/FBF6: 01A0 0132 0110 00EE 00CC 00EE 0110 0132

; sylvan cave animated palette
14/FC06: 26C0 2280 1E40 2200 15C0 1A00 1E40 2280
14/FC16: 19E0 1580 1140 0D00 08C0 0D00 1140 1580
14/FC26: 0CA0 0CC0 08A0 0880 0460 0480 08A0 08C0
14/FC36: 26AD 2280 1E40 2200 15C0 1A00 1E40 2280

14/FC46: 40 AE AF CB BC BD BE DB E8 E9 EA BF F8 F9 FA FB

14/FC56: 00 40 A0 A0 30 80 80 20 C0 B0 20 20 A0 80 80 30

; cave animated water data (offset of row to shift each frame)
; 0, 9, 2, 11, 4, 13, 6, 15, 8, 1, 10, 3, 12, 5, 14, 7
14/FC66: 00 21 02 23 04 25 06 27 20 01 22 03 24 05 26 07

14/FC76: A0 A0 A0 A0 A0 A0 A0 A0 A0 A0 C0 C0 C0 E0 E0 E0
14/FC86: 40 40 40 40 20 20 20 60 60 60 20 20 20 60 60 60

14/FC96: 40 A0 30 B0 20 20 20 C0 C0 C0 10 10 10 D0 D0 D0

14/FCA6: 2D 2D 3D 3D 5D 6D 7D 5D 6D 7D 5D 6D 7D 5D 6D 7D

14/FCB6: 09 09 09 09 09 09 09 09 09 09 0B 0B 0B 09 09 09

; npc y-offset for jumping
14/FCC6: 00 03 06 08 0B 0D 0F 11 13 14 15 17 17 18 19 19
14/FCD6: 19 19 19 18 17 17 15 14 13 11 0F 0D 0B 08 06 03

; title screen sprite colors (for fade in)
14/FCE6: 7FFF 739C 6318 5294 4210 318C 2108 1084

14/FCF6:                   FF FF FF FF FF FF FF FF FF FF

; --------------------------------------------------------------------------

14/FD00: 4C D9 FD     JMP $FDD9       ; init controller
14/FD03: 4C 12 FD     JMP $FD12       ; update controller
14/FD06: 4C 9E FE     JMP $FE9E       ; clear text
14/FD09: 4C D6 FE     JMP $FED6       ; update window color
14/FD0C: 4C 0A FF     JMP $FF0A
14/FD0F: 4C 62 FF     JMP $FF62       ; save dialogue window graphics

; [ update controller ]

14/FD12: 8B           PHB 
14/FD13: DA           PHX 
14/FD14: 5A           PHY 
14/FD15: 0B           PHD 
14/FD16: A9 00        LDA #$00
14/FD18: 48           PHA 
14/FD19: AB           PLB 
14/FD1A: A2 00 01     LDX #$0100
14/FD1D: DA           PHX 
14/FD1E: 2B           PLD 
14/FD1F: AD 12 42     LDA $4212       ; wait for hardware to read controller data
14/FD22: 29 01        AND #$01
14/FD24: D0 F9        BNE $FD1F
14/FD26: 64 EC        STZ $EC
14/FD28: A0 18 42     LDY #$4218
14/FD2B: A2 04 00     LDX #$0004
14/FD2E: A9 04        LDA #$04
14/FD30: 48           PHA 
14/FD31: 5A           PHY 
14/FD32: 20 90 FD     JSR $FD90       ; read controller register
14/FD35: 7A           PLY 
14/FD36: 68           PLA 
14/FD37: E8           INX 
14/FD38: C8           INY 
14/FD39: 3A           DEC 
14/FD3A: D0 F4        BNE $FD30
14/FD3C: AD 64 1A     LDA $1A64       ; controller setting (default or custom)
14/FD3F: 29 01        AND #$01
14/FD41: 0A           ASL 
14/FD42: 0A           ASL 
14/FD43: 85 1D        STA $1D
14/FD45: 0A           ASL 
14/FD46: 65 1D        ADC $1D
14/FD48: 0A           ASL 
14/FD49: 85 43        STA $43
14/FD4B: A6 43        LDX $43         ; 0 or 24
14/FD4D: C2 20        REP #$20
14/FD4F: A5 04        LDA $04         ; controller 1 buttons
14/FD51: DA           PHX 
14/FD52: A0 0C 00     LDY #$000C
14/FD55: 85 1D        STA $1D
14/FD57: A9 00 00     LDA #$0000
14/FD5A: 06 1D        ASL $1D
14/FD5C: 90 04        BCC $FD62
14/FD5E: 1F 05 1A 00  ORA $001A05,X   ; apply button mapping
14/FD62: E8           INX 
14/FD63: E8           INX 
14/FD64: 88           DEY 
14/FD65: D0 F3        BNE $FD5A
14/FD67: FA           PLX 
14/FD68: 85 1F        STA $1F
14/FD6A: A5 08        LDA $08         ; controller 2 buttons
14/FD6C: A0 0C 00     LDY #$000C
14/FD6F: 85 1D        STA $1D
14/FD71: A9 00 00     LDA #$0000
14/FD74: 06 1D        ASL $1D
14/FD76: 90 04        BCC $FD7C
14/FD78: 1F 05 1A 00  ORA $001A05,X   ; apply button mapping
14/FD7C: E8           INX 
14/FD7D: E8           INX 
14/FD7E: 88           DEY 
14/FD7F: D0 F3        BNE $FD74
14/FD81: 2B           PLD 
14/FD82: 85 02        STA $02         ; set mapped controller 2 buttons
14/FD84: AF 1F 01 00  LDA $00011F
14/FD88: 85 00        STA $00         ; set mapped controller 1 buttons
14/FD8A: E2 20        SEP #$20
14/FD8C: 7A           PLY 
14/FD8D: FA           PLX 
14/FD8E: AB           PLB 
14/FD8F: 6B           RTL 

; [ read controller register ]

; +Y: controller hardware register address
; +X: dp offset for this register

14/FD90: AD B8 16     LDA $16B8       ; multi-controller flag
14/FD93: 25 40        AND $40         ; in-battle flag
14/FD95: F0 1D        BEQ $FDB4       ; branch unless both flags are set
14/FD97: AF 22 18 00  LDA $001822     ; selected character
14/FD9B: 85 43        STA $43
14/FD9D: 5A           PHY 
14/FD9E: A4 43        LDY $43
14/FDA0: B9 B9 16     LDA $16B9,Y     ; controller for this character (0 or 2)
14/FDA3: 7A           PLY 
14/FDA4: 85 43        STA $43
14/FDA6: C2 20        REP #$20
14/FDA8: 98           TYA 
14/FDA9: 18           CLC 
14/FDAA: 65 43        ADC $43
14/FDAC: A8           TAY 
14/FDAD: E2 20        SEP #$20
14/FDAF: B9 00 00     LDA $0000,Y
14/FDB2: 80 06        BRA $FDBA
14/FDB4: B9 00 00     LDA $0000,Y     ; combine input from both controllers
14/FDB7: 19 02 00     ORA $0002,Y
14/FDBA: F0 04        BEQ $FDC0       ; branch if no buttons pressed
14/FDBC: D5 04        CMP $04,X
14/FDBE: F0 09        BEQ $FDC9       ; branch if no changes
14/FDC0: 95 04        STA $04,X
14/FDC2: 95 00        STA $00,X
14/FDC4: A9 18        LDA #$18        ; set first repeat counter
14/FDC6: 95 08        STA $08,X
14/FDC8: 60           RTS 
; buttons held (unchanged from previous frame)
14/FDC9: D6 08        DEC $08,X       ; decrement repeat counter
14/FDCB: F0 03        BEQ $FDD0
14/FDCD: 74 00        STZ $00,X
14/FDCF: 60           RTS 
14/FDD0: A9 03        LDA #$03        ; set multi-repeat counter
14/FDD2: 95 08        STA $08,X
14/FDD4: B5 04        LDA $04,X
14/FDD6: 95 00        STA $00,X
14/FDD8: 60           RTS 

; [ init controller ]

14/FDD9: 8B           PHB 
14/FDDA: 0B           PHD 
14/FDDB: A2 00 01     LDX #$0100
14/FDDE: DA           PHX 
14/FDDF: 2B           PLD 
14/FDE0: C2 20        REP #$20
14/FDE2: A9 17 00     LDA #$0017      ; load default button mapping
14/FDE5: A2 86 FE     LDX #$FE86
14/FDE8: A0 05 1A     LDY #$1A05
14/FDEB: 54 7E 14     MVN $7E,$14
14/FDEE: A9 17 00     LDA #$0017
14/FDF1: A2 86 FE     LDX #$FE86
14/FDF4: A0 1D 1A     LDY #$1A1D
14/FDF7: 54 7E 14     MVN $7E,$14
14/FDFA: E2 20        SEP #$20
14/FDFC: AD A9 16     LDA $16A9
14/FDFF: 8D 64 1A     STA $1A64
14/FE02: AD 3A 1A     LDA $1A3A
14/FE05: 0A           ASL 
14/FE06: 85 43        STA $43
14/FE08: A6 43        LDX $43
14/FE0A: C2 20        REP #$20
14/FE0C: 9C 2D 1A     STZ $1A2D       ; clear A, B, X, Y, and select buttons
14/FE0F: 9C 1D 1A     STZ $1A1D
14/FE12: 9C 2F 1A     STZ $1A2F
14/FE15: 9C 1F 1A     STZ $1A1F
14/FE18: 9C 21 1A     STZ $1A21
14/FE1B: BF 7E FE 14  LDA $14FE7E,X   ; set action for L button
14/FE1F: 8D 31 1A     STA $1A31
14/FE22: E2 20        SEP #$20
14/FE24: AD 3B 1A     LDA $1A3B
14/FE27: 0A           ASL 
14/FE28: 85 43        STA $43
14/FE2A: C2 20        REP #$20
14/FE2C: A6 43        LDX $43
14/FE2E: BF 7E FE 14  LDA $14FE7E,X   ; set action for start button
14/FE32: 8D 23 1A     STA $1A23
14/FE35: E2 20        SEP #$20
14/FE37: AD 37 1A     LDA $1A37
14/FE3A: A2 80 00     LDX #$0080      ; confirm
14/FE3D: 20 63 FE     JSR $FE63       ; set button mapping
14/FE40: AD 38 1A     LDA $1A38
14/FE43: A2 00 80     LDX #$8000      ; cancel
14/FE46: 20 63 FE     JSR $FE63       ; set button mapping
14/FE49: AD 39 1A     LDA $1A39
14/FE4C: A2 40 00     LDX #$0040      ; menu
14/FE4F: 20 63 FE     JSR $FE63       ; set button mapping
14/FE52: A9 FF        LDA #$FF
14/FE54: 85 04        STA $04
14/FE56: 85 05        STA $05
14/FE58: A5 DD        LDA $DD         ; repeat rate
14/FE5A: 85 08        STA $08
14/FE5C: 85 09        STA $09
14/FE5E: 2B           PLD 
14/FE5F: AB           PLB 
14/FE60: 7B           TDC 
14/FE61: EB           XBA 
14/FE62: 6B           RTL 

; [ set button mapping ]

14/FE63: DA           PHX 
14/FE64: 85 43        STA $43
14/FE66: A6 43        LDX $43
14/FE68: BF 79 FE 14  LDA $14FE79,X
14/FE6C: 85 43        STA $43
14/FE6E: A6 43        LDX $43
14/FE70: C2 20        REP #$20
14/FE72: 68           PLA 
14/FE73: 9D 05 1A     STA $1A05,X
14/FE76: E2 20        SEP #$20
14/FE78: 60           RTS 

; button mapping choices (A, B, X, Y, select)
14/FE79: 28 18 2A 1A 1C

; L and start button actions (none, confirm, cancel, menu)
14/FE7E: 0000 0080 8000 0040

; default button mapping
14/FE86: 8000 4000 8000 0000 0800 0400 0200 0100
14/FE96: 0080 0040 0000 0010

; [ clear text ]

; +Y: tilemap offset
;  A: width
; set tiles to zero if carry clear, $FF if carry set

14/FE9E: 64 1F        STZ $1F
14/FEA0: B0 02        BCS $FEA4
14/FEA2: C6 1F        DEC $1F
14/FEA4: 48           PHA 
14/FEA5: 85 1D        STA $1D
14/FEA7: 85 1E        STA $1E
14/FEA9: C2 20        REP #$20
14/FEAB: 98           TYA 
14/FEAC: 18           CLC 
14/FEAD: 65 29        ADC $29
14/FEAF: A8           TAY 
14/FEB0: E2 20        SEP #$20
14/FEB2: 5A           PHY 
14/FEB3: A5 1F        LDA $1F
14/FEB5: 99 00 00     STA $0000,Y
14/FEB8: C8           INY 
14/FEB9: C8           INY 
14/FEBA: C6 1D        DEC $1D
14/FEBC: D0 F7        BNE $FEB5
14/FEBE: 7A           PLY 
14/FEBF: C2 20        REP #$20
14/FEC1: 98           TYA 
14/FEC2: 18           CLC 
14/FEC3: 69 40 00     ADC #$0040      ; next line
14/FEC6: A8           TAY 
14/FEC7: E2 20        SEP #$20
14/FEC9: A5 1F        LDA $1F
14/FECB: 99 00 00     STA $0000,Y
14/FECE: C8           INY 
14/FECF: C8           INY 
14/FED0: C6 1E        DEC $1E
14/FED2: D0 F7        BNE $FECB
14/FED4: 68           PLA 
14/FED5: 6B           RTL 

; [ update window color ]

14/FED6: AE AA 16     LDX $16AA       ; window color
14/FED9: 8E 02 A0     STX $A002
14/FEDC: 8E 0A A0     STX $A00A
14/FEDF: 8E 12 A0     STX $A012
14/FEE2: 8E 1A A0     STX $A01A
14/FEE5: 8E 42 A0     STX $A042
14/FEE8: 8E 4A A0     STX $A04A
14/FEEB: 8E 52 A0     STX $A052
14/FEEE: 8E 5A A0     STX $A05A
14/FEF1: 8E 82 A0     STX $A082
14/FEF4: 8E 8A A0     STX $A08A
14/FEF7: 8E 92 A0     STX $A092
14/FEFA: 8E 9A A0     STX $A09A
14/FEFD: 8E C2 A0     STX $A0C2
14/FF00: 8E CA A0     STX $A0CA
14/FF03: 8E D2 A0     STX $A0D2
14/FF06: 8E DA A0     STX $A0DA
14/FF09: 6B           RTL 

; [  ]

14/FF0A: 48           PHA 
14/FF0B: 8B           PHB 
14/FF0C: 7B           TDC 
14/FF0D: 48           PHA 
14/FF0E: AB           PLB 
14/FF0F: A5 8A        LDA $8A
14/FF11: 8D 0F 21     STA $210F
14/FF14: A5 8B        LDA $8B
14/FF16: 8D 0F 21     STA $210F
14/FF19: A5 8D        LDA $8D
14/FF1B: 8D 10 21     STA $2110
14/FF1E: A5 8E        LDA $8E
14/FF20: 8D 10 21     STA $2110
14/FF23: A5 90        LDA $90
14/FF25: 8D 0D 21     STA $210D
14/FF28: A5 91        LDA $91
14/FF2A: 8D 0D 21     STA $210D
14/FF2D: A5 93        LDA $93
14/FF2F: 8D 0E 21     STA $210E
14/FF32: A5 94        LDA $94
14/FF34: 8D 0E 21     STA $210E
14/FF37: A5 96        LDA $96
14/FF39: 8D 13 21     STA $2113
14/FF3C: A5 97        LDA $97
14/FF3E: 8D 13 21     STA $2113
14/FF41: A5 99        LDA $99
14/FF43: 8D 14 21     STA $2114
14/FF46: A5 9A        LDA $9A
14/FF48: 8D 14 21     STA $2114
14/FF4B: A5 9C        LDA $9C
14/FF4D: 8D 11 21     STA $2111
14/FF50: A5 9D        LDA $9D
14/FF52: 8D 11 21     STA $2111
14/FF55: A5 9F        LDA $9F
14/FF57: 8D 12 21     STA $2112
14/FF5A: A5 A0        LDA $A0
14/FF5C: 8D 12 21     STA $2112
14/FF5F: AB           PLB 
14/FF60: 68           PLA 
14/FF61: 6B           RTL 

; [ save dialogue window graphics (bg3) ]

14/FF62: 8B           PHB 
14/FF63: 7B           TDC 
14/FF64: 48           PHA 
14/FF65: AB           PLB 
14/FF66: A9 80        LDA #$80
14/FF68: 8D 00 21     STA $2100       ; screen off
14/FF6B: 85 88        STA $88
14/FF6D: A9 80        LDA #$80
14/FF6F: 8D 15 21     STA $2115
14/FF72: A2 00 20     LDX #$2000      ; ppu $2000
14/FF75: 8E 16 21     STX $2116
14/FF78: AE 39 21     LDX $2139       ; read "dummy" value
14/FF7B: A9 81        LDA #$81        ; single address, auto-increment
14/FF7D: 8D 00 43     STA $4300
14/FF80: A9 39        LDA #$39        ; source: $2139 (vram data read)
14/FF82: 8D 01 43     STA $4301
14/FF85: A2 00 E6     LDX #$E600      ; destination: $7EE600
14/FF88: 8E 02 43     STX $4302
14/FF8B: A9 7E        LDA #$7E
14/FF8D: 8D 04 43     STA $4304
14/FF90: A2 00 10     LDX #$1000      ; size: $1000
14/FF93: 8E 05 43     STX $4305
14/FF96: A9 01        LDA #$01
14/FF98: 8D 0B 42     STA $420B
14/FF9B: AB           PLB 
14/FF9C: 6B           RTL 

; character display order
14/FF9D: 01 03 00 04 02

; spell lists for each character (see 13/FDDD for battle)
14/FFA2: FF FF FF
14/FFA5: FF FF FF
14/FFA8: 02 03 04
14/FFAB: 05 06 FF
14/FFAE: FF FF FF
14/FFB1: 07 FF FF
14/FFB4: FF FF FF
14/FFB7: FF 08 FF
14/FFBA: 09 FF FF
14/FFBD: 00 FF FF
14/FFC0: FF FF FF
14/FFC3: FF 03 04
14/FFC6: FF 0C FF
14/FFC9: 0A 0B FF

; something for name change menu ???
14/FFCC: 38 48 58 68 78 90 A0 B0 C0 D0

; [ restore dialogue window graphics (bg3) ]

14/FFD6: A9 00        LDA #$00
14/FFD8: 48           PHA 
14/FFD9: AB           PLB 
14/FFDA: A2 00 20     LDX #$2000
14/FFDD: 8E 1D 01     STX $011D
14/FFE0: A2 00 E6     LDX #$E600
14/FFE3: 8E 1F 01     STX $011F
14/FFE6: A9 7E        LDA #$7E
14/FFE8: 8D 21 01     STA $0121
14/FFEB: A2 00 10     LDX #$1000
14/FFEE: 8E 22 01     STX $0122
14/FFF1: 6B           RTL 

; multi-target flag for white magic (starts at cure1)
14/FFF2: 01 01 01 01 00 00 00 01 00 00 01 01 01 01

; --------------------------------------------------------------------------

; [ transfer 3bpp graphics to vram ]

;  $49: source bank
; +$4A: source address
; +$4C: destination address (vram)
; +$4E: size

15/B000: 9C 0B 42     STZ $420B
15/B003: A9 80        LDA #$80
15/B005: 8D 15 21     STA $2115
15/B008: A9 08        LDA #$08
15/B00A: 8D 00 43     STA $4300
15/B00D: A9 19        LDA #$19
15/B00F: 8D 01 43     STA $4301
15/B012: 9C 04 43     STZ $4304
15/B015: A6 4C        LDX $4C
15/B017: 8E 16 21     STX $2116
15/B01A: 64 10        STZ $10
15/B01C: A2 10 06     LDX #$0610
15/B01F: 8E 02 43     STX $4302
15/B022: A6 4E        LDX $4E
15/B024: 8E 05 43     STX $4305
15/B027: A9 01        LDA #$01
15/B029: 8D 0B 42     STA $420B
15/B02C: 9C 0B 42     STZ $420B
15/B02F: 46 4F        LSR $4F         ; size / 16
15/B031: 66 4E        ROR $4E
15/B033: 46 4F        LSR $4F
15/B035: 66 4E        ROR $4E
15/B037: 46 4F        LSR $4F
15/B039: 66 4E        ROR $4E
15/B03B: 46 4F        LSR $4F
15/B03D: 66 4E        ROR $4E
15/B03F: A9 18        LDA #$18
15/B041: 8D 01 43     STA $4301
15/B044: A6 4C        LDX $4C
15/B046: 8E 16 21     STX $2116
15/B049: A6 4A        LDX $4A
15/B04B: 8E 02 43     STX $4302
15/B04E: A5 49        LDA $49
15/B050: 8D 04 43     STA $4304
15/B053: A0 00 00     LDY #$0000
15/B056: 9C 0B 42     STZ $420B
15/B059: A9 80        LDA #$80
15/B05B: 8D 15 21     STA $2115
15/B05E: A9 01        LDA #$01
15/B060: 8D 00 43     STA $4300
15/B063: A2 10 00     LDX #$0010      ; transfer 16 bytes
15/B066: 8E 05 43     STX $4305
15/B069: A9 01        LDA #$01
15/B06B: 8D 0B 42     STA $420B
15/B06E: 9C 0B 42     STZ $420B
15/B071: 9C 15 21     STZ $2115
15/B074: 9C 00 43     STZ $4300
15/B077: A2 08 00     LDX #$0008      ; transfer 8 bytes
15/B07A: 8E 05 43     STX $4305
15/B07D: A9 01        LDA #$01
15/B07F: 8D 0B 42     STA $420B
15/B082: C8           INY 
15/B083: C4 4E        CPY $4E
15/B085: D0 CF        BNE $B056
15/B087: 6B           RTL 

; [ load map bg graphics ]

15/B088: AD DD 0F     LDA $0FDD
15/B08B: F0 04        BEQ $B091       ; airship and ship graphics are 4bpp
15/B08D: C9 0F        CMP #$0F
15/B08F: D0 03        BNE $B094
15/B091: 4C BE B0     JMP $B0BE
; 3bpp
15/B094: 22 14 B1 15  JSL $15B114     ; clear bg1/bg2 graphics in vram
15/B098: 9C 0B 42     STZ $420B
15/B09B: AD DD 0F     LDA $0FDD
15/B09E: 0A           ASL 
15/B09F: AA           TAX 
15/B0A0: BF 00 80 1E  LDA $1E8000,X   ; map graphics pointers
15/B0A4: 8D 02 43     STA $4302
15/B0A7: BF 01 80 1E  LDA $1E8001,X
15/B0AB: 8D 03 43     STA $4303
15/B0AE: AD DD 0F     LDA $0FDD
15/B0B1: AA           TAX 
15/B0B2: BF 04 B1 15  LDA $15B104,X   ; bank byte for map graphics pointers
15/B0B6: 8D 04 43     STA $4304
15/B0B9: 22 43 B1 15  JSL $15B143     ; transfer bg1/bg2 graphics to vram (3bpp)
15/B0BD: 6B           RTL 
; 4bpp
15/B0BE: A2 00 00     LDX #$0000
15/B0C1: 86 47        STX $47
15/B0C3: A2 00 24     LDX #$2400
15/B0C6: 86 45        STX $45
15/B0C8: A9 15        LDA #$15        ; bank 15
15/B0CA: 85 3C        STA $3C
15/B0CC: AF 00 80 1E  LDA $1E8000
15/B0D0: 85 3D        STA $3D
15/B0D2: AF 01 80 1E  LDA $1E8001
15/B0D6: 85 3E        STA $3E
15/B0D8: A9 80        LDA #$80
15/B0DA: 8D 15 21     STA $2115
15/B0DD: 9C 0B 42     STZ $420B
15/B0E0: A9 01        LDA #$01
15/B0E2: 8D 00 43     STA $4300
15/B0E5: A9 18        LDA #$18
15/B0E7: 8D 01 43     STA $4301
15/B0EA: A5 3C        LDA $3C
15/B0EC: 8D 04 43     STA $4304
15/B0EF: A6 47        LDX $47
15/B0F1: 8E 16 21     STX $2116
15/B0F4: A6 3D        LDX $3D
15/B0F6: 8E 02 43     STX $4302
15/B0F9: A6 45        LDX $45
15/B0FB: 8E 05 43     STX $4305
15/B0FE: A9 01        LDA #$01
15/B100: 8D 0B 42     STA $420B
15/B103: 6B           RTL 

; bank byte for map graphics pointers (at 1E/8000)
15/B104: 15 1E 1E 1D 1E 1E 1E 1E 1F 1F 1F 1F 1E 1F 1F 15

; [ clear bg1/bg2 graphics in vram ]

15/B114: 9C 0B 42     STZ $420B
15/B117: A9 80        LDA #$80
15/B119: 8D 15 21     STA $2115
15/B11C: A9 08        LDA #$08
15/B11E: 8D 00 43     STA $4300
15/B121: A9 19        LDA #$19
15/B123: 8D 01 43     STA $4301
15/B126: A2 00 00     LDX #$0000
15/B129: 8E 16 21     STX $2116
15/B12C: 64 06        STZ $06         ; fixed value for clearing vram
15/B12E: A2 06 06     LDX #$0606
15/B131: 8E 02 43     STX $4302
15/B134: 9C 04 43     STZ $4304
15/B137: A2 00 18     LDX #$1800      ; clear $0000-$17FF
15/B13A: 8E 05 43     STX $4305
15/B13D: A9 01        LDA #$01
15/B13F: 8D 0B 42     STA $420B
15/B142: 6B           RTL 

; [ transfer bg1/bg2 graphics to vram (3bpp) ]

15/B143: A9 18        LDA #$18
15/B145: 8D 01 43     STA $4301
15/B148: A2 00 00     LDX #$0000
15/B14B: 8E 16 21     STX $2116
15/B14E: A0 00 00     LDY #$0000
15/B151: A9 80        LDA #$80
15/B153: 8D 15 21     STA $2115
15/B156: A9 01        LDA #$01
15/B158: 8D 00 43     STA $4300
15/B15B: A2 10 00     LDX #$0010
15/B15E: 8E 05 43     STX $4305
15/B161: A9 01        LDA #$01
15/B163: 8D 0B 42     STA $420B
15/B166: 9C 0B 42     STZ $420B
15/B169: 9C 15 21     STZ $2115
15/B16C: 9C 00 43     STZ $4300
15/B16F: A2 08 00     LDX #$0008
15/B172: 8E 05 43     STX $4305
15/B175: A9 01        LDA #$01
15/B177: 8D 0B 42     STA $420B
15/B17A: C8           INY 
15/B17B: C0 80 01     CPY #$0180      ; copy 384 tiles (vram $0000-$17FF)
15/B17E: D0 D1        BNE $B151
15/B180: 6B           RTL 

; [ transfer world map graphics to vram ]

15/B181: A9 80        LDA #$80
15/B183: 8D 15 21     STA $2115
15/B186: A2 00 00     LDX #$0000
15/B189: 8E 16 21     STX $2116
15/B18C: AD 00 17     LDA $1700
15/B18F: 85 3E        STA $3E
15/B191: 64 3D        STZ $3D
15/B193: A6 3D        LDX $3D
15/B195: A0 00 00     LDY #$0000
15/B198: BF 00 86 14  LDA $148600,X   ; world map tile palettes
15/B19C: 99 DB 0B     STA $0BDB,Y
15/B19F: E8           INX 
15/B1A0: C8           INY 
15/B1A1: C0 00 01     CPY #$0100
15/B1A4: D0 F2        BNE $B198
15/B1A6: AD 00 17     LDA $1700
15/B1A9: 0A           ASL 
15/B1AA: 0A           ASL 
15/B1AB: 0A           ASL 
15/B1AC: 0A           ASL 
15/B1AD: 0A           ASL 
15/B1AE: 85 3E        STA $3E
15/B1B0: 64 3D        STZ $3D
15/B1B2: A6 3D        LDX $3D
15/B1B4: A0 00 00     LDY #$0000
15/B1B7: BF 00 80 1D  LDA $1D8000,X   ; world map graphics
15/B1BB: 85 08        STA $08
15/B1BD: E8           INX 
15/B1BE: 29 0F        AND #$0F
15/B1C0: 18           CLC 
15/B1C1: 79 DB 0B     ADC $0BDB,Y
15/B1C4: 8D 19 21     STA $2119
15/B1C7: A5 08        LDA $08
15/B1C9: 4A           LSR 
15/B1CA: 4A           LSR 
15/B1CB: 4A           LSR 
15/B1CC: 4A           LSR 
15/B1CD: 18           CLC 
15/B1CE: 79 DB 0B     ADC $0BDB,Y
15/B1D1: 8D 19 21     STA $2119
15/B1D4: 8A           TXA 
15/B1D5: 29 1F        AND #$1F
15/B1D7: D0 DE        BNE $B1B7
15/B1D9: C8           INY 
15/B1DA: C0 00 01     CPY #$0100
15/B1DD: D0 D8        BNE $B1B7
15/B1DF: 6B           RTL 

; --------------------------------------------------------------------------

; [ draw player sprite (sub-map) ]

15/B1E0: A5 D3        LDA $D3
15/B1E2: F0 01        BEQ $B1E5
15/B1E4: 6B           RTL 
15/B1E5: 8B           PHB 
15/B1E6: A9 15        LDA #$15
15/B1E8: 48           PHA 
15/B1E9: AB           PLB 
15/B1EA: AD 03 17     LDA $1703
15/B1ED: 64 4A        STZ $4A
15/B1EF: 4A           LSR 
15/B1F0: 66 4A        ROR $4A
15/B1F2: 4A           LSR 
15/B1F3: 66 4A        ROR $4A
15/B1F5: 85 4B        STA $4B
15/B1F7: A6 4A        LDX $4A
15/B1F9: BD 01 10     LDA $1001,X     ; character id
15/B1FC: 29 1F        AND #$1F
15/B1FE: AA           TAX 
15/B1FF: BD FA B2     LDA $B2FA,X     ; color palette for each character
15/B202: 0A           ASL 
15/B203: 8D 10 07     STA $0710
15/B206: A5 D8        LDA $D8
15/B208: F0 05        BEQ $B20F
15/B20A: A9 08        LDA #$08
15/B20C: 8D 05 17     STA $1705
15/B20F: AD 05 17     LDA $1705
15/B212: C9 08        CMP #$08
15/B214: D0 0A        BNE $B220
15/B216: A5 7B        LDA $7B
15/B218: 18           CLC 
15/B219: 69 10        ADC #$10
15/B21B: 4A           LSR 
15/B21C: 4A           LSR 
15/B21D: 4A           LSR 
15/B21E: 29 03        AND #$03
15/B220: 0A           ASL 
15/B221: 0A           ASL 
15/B222: 0A           ASL 
15/B223: 0A           ASL 
15/B224: 85 07        STA $07
15/B226: 64 06        STZ $06
15/B228: AD 05 17     LDA $1705
15/B22B: C9 08        CMP #$08
15/B22D: F0 20        BEQ $B24F
15/B22F: C9 04        CMP #$04
15/B231: B0 04        BCS $B237
15/B233: A5 AB        LDA $AB
15/B235: F0 18        BEQ $B24F
15/B237: A5 7B        LDA $7B
15/B239: 29 08        AND #$08
15/B23B: 18           CLC 
15/B23C: 65 07        ADC $07
15/B23E: 85 07        STA $07
15/B240: A5 AB        LDA $AB
15/B242: 29 01        AND #$01
15/B244: D0 09        BNE $B24F
15/B246: A5 7B        LDA $7B
15/B248: 29 08        AND #$08
15/B24A: 4A           LSR 
15/B24B: 4A           LSR 
15/B24C: 4A           LSR 
15/B24D: 85 06        STA $06
15/B24F: A5 07        LDA $07
15/B251: AA           TAX 
15/B252: A0 00 00     LDY #$0000
15/B255: B9 B4 C0     LDA $C0B4,Y
15/B258: 99 70 04     STA $0470,Y
15/B25B: C8           INY 
15/B25C: B9 B4 C0     LDA $C0B4,Y
15/B25F: 38           SEC 
15/B260: E5 06        SBC $06
15/B262: 99 70 04     STA $0470,Y
15/B265: C8           INY 
15/B266: BD C4 C0     LDA $C0C4,X
15/B269: 99 70 04     STA $0470,Y
15/B26C: E8           INX 
15/B26D: C8           INY 
15/B26E: BD C4 C0     LDA $C0C4,X
15/B271: 29 F1        AND #$F1
15/B273: 18           CLC 
15/B274: 6D 10 07     ADC $0710
15/B277: 99 70 04     STA $0470,Y
15/B27A: E8           INX 
15/B27B: C8           INY 
15/B27C: C0 08 00     CPY #$0008
15/B27F: D0 D4        BNE $B255
15/B281: A0 00 00     LDY #$0000
15/B284: B9 BC C0     LDA $C0BC,Y
15/B287: 99 F0 04     STA $04F0,Y
15/B28A: C8           INY 
15/B28B: B9 BC C0     LDA $C0BC,Y
15/B28E: 38           SEC 
15/B28F: E5 06        SBC $06
15/B291: 99 F0 04     STA $04F0,Y
15/B294: C8           INY 
15/B295: BD C4 C0     LDA $C0C4,X
15/B298: 99 F0 04     STA $04F0,Y
15/B29B: E8           INX 
15/B29C: C8           INY 
15/B29D: BD C4 C0     LDA $C0C4,X
15/B2A0: 29 F1        AND #$F1
15/B2A2: 18           CLC 
15/B2A3: 6D 10 07     ADC $0710
15/B2A6: 99 F0 04     STA $04F0,Y
15/B2A9: E8           INX 
15/B2AA: C8           INY 
15/B2AB: C0 08 00     CPY #$0008
15/B2AE: D0 D4        BNE $B284
15/B2B0: A5 A2        LDA $A2
15/B2B2: 29 08        AND #$08
15/B2B4: F0 20        BEQ $B2D6
15/B2B6: AD 73 04     LDA $0473
15/B2B9: 09 20        ORA #$20
15/B2BB: 8D 73 04     STA $0473
15/B2BE: AD 77 04     LDA $0477
15/B2C1: 09 20        ORA #$20
15/B2C3: 8D 77 04     STA $0477
15/B2C6: AD F3 04     LDA $04F3
15/B2C9: 29 CF        AND #$CF
15/B2CB: 8D F3 04     STA $04F3
15/B2CE: AD F7 04     LDA $04F7
15/B2D1: 29 CF        AND #$CF
15/B2D3: 8D F7 04     STA $04F7
15/B2D6: A5 A2        LDA $A2
15/B2D8: 29 04        AND #$04
15/B2DA: F0 1C        BEQ $B2F8
15/B2DC: A5 A1        LDA $A1
15/B2DE: 29 04        AND #$04
15/B2E0: F0 08        BEQ $B2EA
15/B2E2: A5 A1        LDA $A1
15/B2E4: 29 03        AND #$03
15/B2E6: 25 D2        AND $D2
15/B2E8: D0 0E        BNE $B2F8
15/B2EA: A9 F8        LDA #$F8
15/B2EC: 8D 71 04     STA $0471
15/B2EF: 8D 75 04     STA $0475
15/B2F2: 8D F1 04     STA $04F1
15/B2F5: 8D F5 04     STA $04F5
15/B2F8: AB           PLB 
15/B2F9: 6B           RTL 

; color palette for each character (map sprite)
15/B2FA: 00 00 01 02 02 02 00 01 01 03 00 01 00 00 00 00
15/B30A: 00 00

; [ draw player sprite (world map) ]

15/B30C: A5 D3        LDA $D3
15/B30E: F0 01        BEQ $B311
15/B310: 6B           RTL 
15/B311: A5 AD        LDA $AD
15/B313: C9 10        CMP #$10
15/B315: D0 05        BNE $B31C
15/B317: AD 04 17     LDA $1704
15/B31A: F0 01        BEQ $B31D
15/B31C: 6B           RTL 
15/B31D: 8B           PHB 
15/B31E: A9 15        LDA #$15
15/B320: 48           PHA 
15/B321: AB           PLB 
15/B322: AD 03 17     LDA $1703
15/B325: 64 4A        STZ $4A
15/B327: 4A           LSR 
15/B328: 66 4A        ROR $4A
15/B32A: 4A           LSR 
15/B32B: 66 4A        ROR $4A
15/B32D: 85 4B        STA $4B
15/B32F: A6 4A        LDX $4A
15/B331: BD 01 10     LDA $1001,X
15/B334: 29 1F        AND #$1F
15/B336: AA           TAX 
15/B337: BD FA B2     LDA $B2FA,X     ; color palette for each character
15/B33A: 0A           ASL 
15/B33B: 8D 10 07     STA $0710
15/B33E: AD 05 17     LDA $1705
15/B341: 0A           ASL 
15/B342: 0A           ASL 
15/B343: 0A           ASL 
15/B344: 0A           ASL 
15/B345: 85 07        STA $07
15/B347: 64 06        STZ $06
15/B349: A5 AB        LDA $AB
15/B34B: F0 18        BEQ $B365
15/B34D: A5 7B        LDA $7B
15/B34F: 29 08        AND #$08
15/B351: 18           CLC 
15/B352: 65 07        ADC $07
15/B354: 85 07        STA $07
15/B356: A5 AB        LDA $AB
15/B358: 29 01        AND #$01
15/B35A: D0 09        BNE $B365
15/B35C: A5 7B        LDA $7B
15/B35E: 29 08        AND #$08
15/B360: 4A           LSR 
15/B361: 4A           LSR 
15/B362: 4A           LSR 
15/B363: 85 06        STA $06
15/B365: A5 07        LDA $07
15/B367: AA           TAX 
15/B368: A0 00 00     LDY #$0000
15/B36B: B9 B4 C0     LDA $C0B4,Y
15/B36E: 99 44 04     STA $0444,Y
15/B371: C8           INY 
15/B372: B9 B4 C0     LDA $C0B4,Y
15/B375: 38           SEC 
15/B376: E5 06        SBC $06
15/B378: 99 44 04     STA $0444,Y
15/B37B: C8           INY 
15/B37C: BD C4 C0     LDA $C0C4,X
15/B37F: 99 44 04     STA $0444,Y
15/B382: E8           INX 
15/B383: C8           INY 
15/B384: BD C4 C0     LDA $C0C4,X
15/B387: 29 F1        AND #$F1
15/B389: 18           CLC 
15/B38A: 6D 10 07     ADC $0710
15/B38D: 99 44 04     STA $0444,Y
15/B390: E8           INX 
15/B391: C8           INY 
15/B392: C0 10 00     CPY #$0010
15/B395: D0 D4        BNE $B36B
15/B397: A5 A2        LDA $A2
15/B399: 29 08        AND #$08
15/B39B: F0 10        BEQ $B3AD
15/B39D: AD 4F 04     LDA $044F
15/B3A0: 29 CF        AND #$CF
15/B3A2: 8D 4F 04     STA $044F
15/B3A5: AD 53 04     LDA $0453
15/B3A8: 29 CF        AND #$CF
15/B3AA: 8D 53 04     STA $0453
15/B3AD: AB           PLB 
15/B3AE: 6B           RTL 

; [ set sprite x position msb ]

15/B3AF: DA           PHX 
15/B3B0: 5A           PHY 
15/B3B1: 48           PHA 
15/B3B2: C2 20        REP #$20
15/B3B4: 98           TYA 
15/B3B5: 4A           LSR 
15/B3B6: 4A           LSR 
15/B3B7: E2 20        SEP #$20
15/B3B9: 85 07        STA $07
15/B3BB: 68           PLA 
15/B3BC: 18           CLC 
15/B3BD: 65 07        ADC $07
15/B3BF: 48           PHA 
15/B3C0: 29 03        AND #$03
15/B3C2: AA           TAX 
15/B3C3: BF D8 B3 15  LDA $15B3D8,X
15/B3C7: 85 07        STA $07
15/B3C9: 68           PLA 
15/B3CA: 4A           LSR 
15/B3CB: 4A           LSR 
15/B3CC: A8           TAY 
15/B3CD: B9 00 05     LDA $0500,Y
15/B3D0: 05 07        ORA $07
15/B3D2: 99 00 05     STA $0500,Y
15/B3D5: 7A           PLY 
15/B3D6: FA           PLX 
15/B3D7: 6B           RTL 

; sprite x position msb masks
15/B3D8: 01 04 10 40

; [ draw chocobo sprite ]

15/B3DC: 8B           PHB 
15/B3DD: A9 15        LDA #$15
15/B3DF: 48           PHA 
15/B3E0: AB           PLB 
15/B3E1: AD 0F 17     LDA $170F
15/B3E4: F0 0F        BEQ $B3F5
15/B3E6: C9 02        CMP #$02
15/B3E8: F0 2F        BEQ $B419
15/B3EA: AD 01 17     LDA $1701
15/B3ED: D0 06        BNE $B3F5
15/B3EF: A5 AD        LDA $AD
15/B3F1: C9 10        CMP #$10
15/B3F3: F0 03        BEQ $B3F8
15/B3F5: 4C B5 B4     JMP $B4B5
15/B3F8: AD 04 17     LDA $1704
15/B3FB: C9 01        CMP #$01
15/B3FD: F0 27        BEQ $B426
15/B3FF: AD 10 17     LDA $1710
15/B402: 85 0C        STA $0C
15/B404: AD 11 17     LDA $1711
15/B407: 85 0E        STA $0E
15/B409: 22 47 BE 15  JSL $15BE47
15/B40D: A5 D7        LDA $D7
15/B40F: D0 03        BNE $B414
15/B411: 4C B5 B4     JMP $B4B5
15/B414: A9 03        LDA #$03
15/B416: 4C 35 B4     JMP $B435
15/B419: AD 10 17     LDA $1710
15/B41C: 85 0C        STA $0C
15/B41E: AD 11 17     LDA $1711
15/B421: 85 0E        STA $0E
15/B423: 4C 2E B4     JMP $B42E
15/B426: A9 70        LDA #$70
15/B428: 85 0C        STA $0C
15/B42A: A9 70        LDA #$70
15/B42C: 85 0E        STA $0E
15/B42E: 64 0D        STZ $0D
15/B430: 64 0F        STZ $0F
15/B432: AD 05 17     LDA $1705
15/B435: 0A           ASL 
15/B436: 0A           ASL 
15/B437: 0A           ASL 
15/B438: 0A           ASL 
15/B439: 0A           ASL 
15/B43A: 85 07        STA $07
15/B43C: AD 04 17     LDA $1704
15/B43F: C9 01        CMP #$01
15/B441: D0 0D        BNE $B450
15/B443: A5 AB        LDA $AB
15/B445: F0 0B        BEQ $B452
15/B447: A5 7A        LDA $7A
15/B449: 29 04        AND #$04
15/B44B: 0A           ASL 
15/B44C: 0A           ASL 
15/B44D: 4C 52 B4     JMP $B452
15/B450: A9 00        LDA #$00
15/B452: 18           CLC 
15/B453: 65 07        ADC $07
15/B455: AA           TAX 
15/B456: A0 00 00     LDY #$0000
15/B459: BD 34 C0     LDA $C034,X
15/B45C: 18           CLC 
15/B45D: 65 0C        ADC $0C
15/B45F: 99 90 04     STA $0490,Y
15/B462: A5 0D        LDA $0D
15/B464: 69 00        ADC #$00
15/B466: 29 01        AND #$01
15/B468: F0 06        BEQ $B470
15/B46A: A9 64        LDA #$64
15/B46C: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B470: BD 35 C0     LDA $C035,X
15/B473: 18           CLC 
15/B474: 65 0E        ADC $0E
15/B476: 99 91 04     STA $0491,Y
15/B479: BD 36 C0     LDA $C036,X
15/B47C: 99 92 04     STA $0492,Y
15/B47F: BD 37 C0     LDA $C037,X
15/B482: 99 93 04     STA $0493,Y
15/B485: E8           INX 
15/B486: E8           INX 
15/B487: E8           INX 
15/B488: E8           INX 
15/B489: C8           INY 
15/B48A: C8           INY 
15/B48B: C8           INY 
15/B48C: C8           INY 
15/B48D: C0 10 00     CPY #$0010
15/B490: D0 C7        BNE $B459
15/B492: AD 04 17     LDA $1704
15/B495: C9 01        CMP #$01
15/B497: D0 07        BNE $B4A0
15/B499: A5 A2        LDA $A2
15/B49B: 29 08        AND #$08
15/B49D: 8D 0E 17     STA $170E
15/B4A0: AD 0E 17     LDA $170E
15/B4A3: F0 10        BEQ $B4B5
15/B4A5: AD 9B 04     LDA $049B
15/B4A8: 29 CF        AND #$CF
15/B4AA: 8D 9B 04     STA $049B
15/B4AD: AD 9F 04     LDA $049F
15/B4B0: 29 CF        AND #$CF
15/B4B2: 8D 9F 04     STA $049F
15/B4B5: AB           PLB 
15/B4B6: 6B           RTL 

; [  ]

15/B4B7: 38           SEC 
15/B4B8: E9 02        SBC #$02
15/B4BA: AA           TAX 
15/B4BB: 0A           ASL 
15/B4BC: 0A           ASL 
15/B4BD: A8           TAY 
15/B4BE: A5 0C        LDA $0C
15/B4C0: 38           SEC 
15/B4C1: E9 04        SBC #$04
15/B4C3: B0 08        BCS $B4CD
15/B4C5: A9 F8        LDA #$F8
15/B4C7: 99 F1 04     STA $04F1,Y
15/B4CA: 4C D8 B4     JMP $B4D8
15/B4CD: 99 F0 04     STA $04F0,Y
15/B4D0: A5 0E        LDA $0E
15/B4D2: 38           SEC 
15/B4D3: E9 05        SBC #$05
15/B4D5: 99 F1 04     STA $04F1,Y
15/B4D8: A5 AD        LDA $AD
15/B4DA: 4A           LSR 
15/B4DB: 4A           LSR 
15/B4DC: 4A           LSR 
15/B4DD: 4A           LSR 
15/B4DE: 3A           DEC 
15/B4DF: 3A           DEC 
15/B4E0: 85 06        STA $06
15/B4E2: 8A           TXA 
15/B4E3: 0A           ASL 
15/B4E4: 18           CLC 
15/B4E5: 65 06        ADC $06
15/B4E7: 69 30        ADC #$30
15/B4E9: 99 F2 04     STA $04F2,Y
15/B4EC: BF F5 B4 15  LDA $15B4F5,X
15/B4F0: 99 F3 04     STA $04F3,Y
15/B4F3: AB           PLB 
15/B4F4: 6B           RTL 

15/B4F5: 1A 18 18 1C

; [ draw black chocobo sprite ]

15/B4F9: 8B           PHB 
15/B4FA: A9 15        LDA #$15
15/B4FC: 48           PHA 
15/B4FD: AB           PLB 
15/B4FE: AD 12 17     LDA $1712
15/B501: F0 24        BEQ $B527
15/B503: AD 01 17     LDA $1701
15/B506: D0 1F        BNE $B527
15/B508: AD 04 17     LDA $1704
15/B50B: C9 02        CMP #$02
15/B50D: F0 2B        BEQ $B53A
15/B50F: A5 AD        LDA $AD
15/B511: 29 0F        AND #$0F
15/B513: D0 12        BNE $B527
15/B515: AD 13 17     LDA $1713
15/B518: 85 0C        STA $0C
15/B51A: AD 14 17     LDA $1714
15/B51D: 85 0E        STA $0E
15/B51F: 22 47 BE 15  JSL $15BE47
15/B523: A5 D7        LDA $D7
15/B525: D0 03        BNE $B52A
15/B527: 4C ED B5     JMP $B5ED
15/B52A: A5 AD        LDA $AD
15/B52C: C9 10        CMP #$10
15/B52E: F0 05        BEQ $B535
15/B530: A9 02        LDA #$02
15/B532: 4C B7 B4     JMP $B4B7
15/B535: A9 03        LDA #$03
15/B537: 4C 52 B5     JMP $B552
15/B53A: A9 00        LDA #$00
15/B53C: 22 66 B8 15  JSL $15B866
15/B540: 64 0D        STZ $0D
15/B542: 64 0F        STZ $0F
15/B544: A9 70        LDA #$70
15/B546: 85 0C        STA $0C
15/B548: A9 70        LDA #$70
15/B54A: 38           SEC 
15/B54B: E5 B5        SBC $B5
15/B54D: 85 0E        STA $0E
15/B54F: AD 05 17     LDA $1705
15/B552: 0A           ASL 
15/B553: 0A           ASL 
15/B554: 0A           ASL 
15/B555: 0A           ASL 
15/B556: 0A           ASL 
15/B557: 85 07        STA $07
15/B559: AD 04 17     LDA $1704
15/B55C: C9 02        CMP #$02
15/B55E: D0 09        BNE $B569
15/B560: A5 7A        LDA $7A
15/B562: 29 04        AND #$04
15/B564: 0A           ASL 
15/B565: 0A           ASL 
15/B566: 4C 6B B5     JMP $B56B
15/B569: A9 00        LDA #$00
15/B56B: 18           CLC 
15/B56C: 65 07        ADC $07
15/B56E: AA           TAX 
15/B56F: A0 00 00     LDY #$0000
15/B572: BD B4 BF     LDA $BFB4,X
15/B575: 18           CLC 
15/B576: 65 0C        ADC $0C
15/B578: 99 14 04     STA $0414,Y
15/B57B: A5 0D        LDA $0D
15/B57D: 69 00        ADC #$00
15/B57F: 29 01        AND #$01
15/B581: F0 06        BEQ $B589
15/B583: A9 45        LDA #$45
15/B585: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B589: BD B5 BF     LDA $BFB5,X
15/B58C: 18           CLC 
15/B58D: 65 0E        ADC $0E
15/B58F: 99 15 04     STA $0415,Y
15/B592: BD B6 BF     LDA $BFB6,X
15/B595: 18           CLC 
15/B596: 69 90        ADC #$90
15/B598: 99 16 04     STA $0416,Y
15/B59B: BD B7 BF     LDA $BFB7,X
15/B59E: 18           CLC 
15/B59F: 69 1A        ADC #$1A
15/B5A1: 99 17 04     STA $0417,Y
15/B5A4: E8           INX 
15/B5A5: E8           INX 
15/B5A6: E8           INX 
15/B5A7: E8           INX 
15/B5A8: C8           INY 
15/B5A9: C8           INY 
15/B5AA: C8           INY 
15/B5AB: C8           INY 
15/B5AC: C0 10 00     CPY #$0010
15/B5AF: D0 C1        BNE $B572
15/B5B1: AD 04 17     LDA $1704
15/B5B4: C9 02        CMP #$02
15/B5B6: F0 0B        BEQ $B5C3
15/B5B8: A9 F8        LDA #$F8
15/B5BA: 8D 1D 04     STA $041D
15/B5BD: 8D 21 04     STA $0421
15/B5C0: 4C ED B5     JMP $B5ED
15/B5C3: A5 A1        LDA $A1
15/B5C5: 29 08        AND #$08
15/B5C7: F0 24        BEQ $B5ED
15/B5C9: A9 70        LDA #$70
15/B5CB: 8D 0C 04     STA $040C
15/B5CE: A9 78        LDA #$78
15/B5D0: 8D 0D 04     STA $040D
15/B5D3: A9 43        LDA #$43
15/B5D5: 8D 0E 04     STA $040E
15/B5D8: 9C 0F 04     STZ $040F
15/B5DB: A9 78        LDA #$78
15/B5DD: 8D 10 04     STA $0410
15/B5E0: A9 78        LDA #$78
15/B5E2: 8D 11 04     STA $0411
15/B5E5: A9 43        LDA #$43
15/B5E7: 8D 12 04     STA $0412
15/B5EA: 9C 13 04     STZ $0413
15/B5ED: AB           PLB 
15/B5EE: 6B           RTL 

; [ draw dwarf tank sprites ]

15/B5EF: 8B           PHB 
15/B5F0: A9 15        LDA #$15
15/B5F2: 48           PHA 
15/B5F3: AB           PLB 
15/B5F4: AD 01 17     LDA $1701
15/B5F7: C9 01        CMP #$01
15/B5F9: D0 68        BNE $B663
15/B5FB: 64 0B        STZ $0B
15/B5FD: A5 0B        LDA $0B
15/B5FF: AA           TAX 
15/B600: BD 65 B6     LDA $B665,X
15/B603: 85 0C        STA $0C
15/B605: BD 6A B6     LDA $B66A,X
15/B608: 85 0E        STA $0E
15/B60A: 22 47 BE 15  JSL $15BE47
15/B60E: A5 D7        LDA $D7
15/B610: F0 49        BEQ $B65B
15/B612: A2 00 00     LDX #$0000
15/B615: A5 0B        LDA $0B
15/B617: 0A           ASL 
15/B618: 0A           ASL 
15/B619: 0A           ASL 
15/B61A: 0A           ASL 
15/B61B: A8           TAY 
15/B61C: BD B4 BF     LDA $BFB4,X
15/B61F: 18           CLC 
15/B620: 65 0C        ADC $0C
15/B622: 99 80 04     STA $0480,Y
15/B625: A5 0D        LDA $0D
15/B627: 69 00        ADC #$00
15/B629: 29 01        AND #$01
15/B62B: F0 06        BEQ $B633
15/B62D: A9 60        LDA #$60
15/B62F: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B633: BD B5 BF     LDA $BFB5,X
15/B636: 18           CLC 
15/B637: 65 0E        ADC $0E
15/B639: 99 81 04     STA $0481,Y
15/B63C: BD B6 BF     LDA $BFB6,X
15/B63F: 18           CLC 
15/B640: 69 A8        ADC #$A8
15/B642: 99 82 04     STA $0482,Y
15/B645: BD B7 BF     LDA $BFB7,X
15/B648: 18           CLC 
15/B649: 69 18        ADC #$18
15/B64B: 99 83 04     STA $0483,Y
15/B64E: E8           INX 
15/B64F: E8           INX 
15/B650: E8           INX 
15/B651: E8           INX 
15/B652: C8           INY 
15/B653: C8           INY 
15/B654: C8           INY 
15/B655: C8           INY 
15/B656: E0 10 00     CPX #$0010
15/B659: D0 C1        BNE $B61C
15/B65B: E6 0B        INC $0B
15/B65D: A5 0B        LDA $0B
15/B65F: C9 05        CMP #$05
15/B661: D0 9A        BNE $B5FD
15/B663: AB           PLB 
15/B664: 6B           RTL 

; dwarf tank x positions
15/B665: 2E 2F 30 31 32
; dwarf tank y positions
15/B66A: 13 14 13 14 13

; [ draw ship sprite ]

15/B66F: 8B           PHB 
15/B670: A9 15        LDA #$15
15/B672: 48           PHA 
15/B673: AB           PLB 
15/B674: AD 28 17     LDA $1728
15/B677: F0 1E        BEQ $B697
15/B679: AD 01 17     LDA $1701
15/B67C: D0 19        BNE $B697
15/B67E: AD 04 17     LDA $1704
15/B681: C9 07        CMP #$07
15/B683: F0 1A        BEQ $B69F
15/B685: AD 29 17     LDA $1729
15/B688: 85 0C        STA $0C
15/B68A: AD 2A 17     LDA $172A
15/B68D: 85 0E        STA $0E
15/B68F: 22 47 BE 15  JSL $15BE47
15/B693: A5 D7        LDA $D7
15/B695: D0 03        BNE $B69A
15/B697: 4C 0D B7     JMP $B70D
15/B69A: A9 00        LDA #$00
15/B69C: 4C AE B6     JMP $B6AE
15/B69F: 64 0D        STZ $0D
15/B6A1: 64 0F        STZ $0F
15/B6A3: A9 70        LDA #$70
15/B6A5: 85 0C        STA $0C
15/B6A7: A9 70        LDA #$70
15/B6A9: 85 0E        STA $0E
15/B6AB: AD 05 17     LDA $1705
15/B6AE: 0A           ASL 
15/B6AF: 0A           ASL 
15/B6B0: 0A           ASL 
15/B6B1: 0A           ASL 
15/B6B2: 0A           ASL 
15/B6B3: 85 07        STA $07
15/B6B5: AD 04 17     LDA $1704
15/B6B8: C9 07        CMP #$07
15/B6BA: D0 09        BNE $B6C5
15/B6BC: A5 7A        LDA $7A
15/B6BE: 29 04        AND #$04
15/B6C0: 0A           ASL 
15/B6C1: 0A           ASL 
15/B6C2: 4C C7 B6     JMP $B6C7
15/B6C5: A9 00        LDA #$00
15/B6C7: 18           CLC 
15/B6C8: 65 07        ADC $07
15/B6CA: AA           TAX 
15/B6CB: A0 00 00     LDY #$0000
15/B6CE: BD B4 BF     LDA $BFB4,X
15/B6D1: 18           CLC 
15/B6D2: 65 0C        ADC $0C
15/B6D4: 99 80 04     STA $0480,Y
15/B6D7: A5 0D        LDA $0D
15/B6D9: 69 00        ADC #$00
15/B6DB: 29 01        AND #$01
15/B6DD: F0 06        BEQ $B6E5
15/B6DF: A9 60        LDA #$60
15/B6E1: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B6E5: BD B5 BF     LDA $BFB5,X
15/B6E8: 18           CLC 
15/B6E9: 65 0E        ADC $0E
15/B6EB: 99 81 04     STA $0481,Y
15/B6EE: BD B6 BF     LDA $BFB6,X
15/B6F1: 18           CLC 
15/B6F2: 69 60        ADC #$60
15/B6F4: 99 82 04     STA $0482,Y
15/B6F7: BD B7 BF     LDA $BFB7,X
15/B6FA: 18           CLC 
15/B6FB: 69 18        ADC #$18
15/B6FD: 99 83 04     STA $0483,Y
15/B700: E8           INX 
15/B701: E8           INX 
15/B702: E8           INX 
15/B703: E8           INX 
15/B704: C8           INY 
15/B705: C8           INY 
15/B706: C8           INY 
15/B707: C8           INY 
15/B708: C0 10 00     CPY #$0010
15/B70B: D0 C1        BNE $B6CE
15/B70D: AB           PLB 
15/B70E: 6B           RTL 

; [ draw hovercraft sprite ]

15/B70F: 8B           PHB 
15/B710: A9 15        LDA #$15
15/B712: 48           PHA 
15/B713: AB           PLB 
15/B714: AD 18 17     LDA $1718
15/B717: F0 2F        BEQ $B748
15/B719: AD 01 17     LDA $1701
15/B71C: CD 1B 17     CMP $171B
15/B71F: D0 27        BNE $B748
15/B721: AD 04 17     LDA $1704
15/B724: C9 03        CMP #$03
15/B726: F0 33        BEQ $B75B
15/B728: AD D0 06     LDA $06D0
15/B72B: F0 03        BEQ $B730
15/B72D: 4C D6 B7     JMP $B7D6
15/B730: A5 AD        LDA $AD
15/B732: 29 0F        AND #$0F
15/B734: D0 12        BNE $B748
15/B736: AD 19 17     LDA $1719
15/B739: 85 0C        STA $0C
15/B73B: AD 1A 17     LDA $171A
15/B73E: 85 0E        STA $0E
15/B740: 22 47 BE 15  JSL $15BE47
15/B744: A5 D7        LDA $D7
15/B746: D0 03        BNE $B74B
15/B748: 4C 14 B8     JMP $B814
15/B74B: A5 AD        LDA $AD
15/B74D: C9 10        CMP #$10
15/B74F: F0 05        BEQ $B756
15/B751: A9 03        LDA #$03
15/B753: 4C B7 B4     JMP $B4B7
15/B756: A9 03        LDA #$03
15/B758: 4C 73 B7     JMP $B773
15/B75B: A9 00        LDA #$00
15/B75D: 22 66 B8 15  JSL $15B866
15/B761: 64 0D        STZ $0D
15/B763: 64 0F        STZ $0F
15/B765: A9 70        LDA #$70
15/B767: 85 0C        STA $0C
15/B769: A9 70        LDA #$70
15/B76B: 38           SEC 
15/B76C: E5 B6        SBC $B6
15/B76E: 85 0E        STA $0E
15/B770: AD 05 17     LDA $1705
15/B773: 0A           ASL 
15/B774: 0A           ASL 
15/B775: 0A           ASL 
15/B776: 0A           ASL 
15/B777: 0A           ASL 
15/B778: 85 07        STA $07
15/B77A: AD 04 17     LDA $1704
15/B77D: C9 03        CMP #$03
15/B77F: D0 0A        BNE $B78B
15/B781: A5 7A        LDA $7A
15/B783: 29 02        AND #$02
15/B785: 0A           ASL 
15/B786: 0A           ASL 
15/B787: 0A           ASL 
15/B788: 4C 8D B7     JMP $B78D
15/B78B: A9 00        LDA #$00
15/B78D: 18           CLC 
15/B78E: 65 07        ADC $07
15/B790: AA           TAX 
15/B791: A0 00 00     LDY #$0000
15/B794: BD B4 BF     LDA $BFB4,X
15/B797: 18           CLC 
15/B798: 65 0C        ADC $0C
15/B79A: 99 80 04     STA $0480,Y
15/B79D: A5 0D        LDA $0D
15/B79F: 69 00        ADC #$00
15/B7A1: 29 01        AND #$01
15/B7A3: F0 06        BEQ $B7AB
15/B7A5: A9 60        LDA #$60
15/B7A7: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B7AB: BD B5 BF     LDA $BFB5,X
15/B7AE: 18           CLC 
15/B7AF: 65 0E        ADC $0E
15/B7B1: 99 81 04     STA $0481,Y
15/B7B4: BD B6 BF     LDA $BFB6,X
15/B7B7: 18           CLC 
15/B7B8: 69 48        ADC #$48
15/B7BA: 99 82 04     STA $0482,Y
15/B7BD: BD B7 BF     LDA $BFB7,X
15/B7C0: 18           CLC 
15/B7C1: 69 18        ADC #$18
15/B7C3: 99 83 04     STA $0483,Y
15/B7C6: E8           INX 
15/B7C7: E8           INX 
15/B7C8: E8           INX 
15/B7C9: E8           INX 
15/B7CA: C8           INY 
15/B7CB: C8           INY 
15/B7CC: C8           INY 
15/B7CD: C8           INY 
15/B7CE: C0 10 00     CPY #$0010
15/B7D1: D0 C1        BNE $B794
15/B7D3: 4C 14 B8     JMP $B814
15/B7D6: AD F8 06     LDA $06F8
15/B7D9: D0 0A        BNE $B7E5
15/B7DB: AD 05 17     LDA $1705
15/B7DE: 0A           ASL 
15/B7DF: 0A           ASL 
15/B7E0: 0A           ASL 
15/B7E1: 0A           ASL 
15/B7E2: 4C E7 B7     JMP $B7E7
15/B7E5: A9 40        LDA #$40
15/B7E7: AA           TAX 
15/B7E8: A0 00 00     LDY #$0000
15/B7EB: BD 16 B8     LDA $B816,X
15/B7EE: 99 80 04     STA $0480,Y
15/B7F1: BD 17 B8     LDA $B817,X
15/B7F4: 18           CLC 
15/B7F5: 6D F8 06     ADC $06F8
15/B7F8: 99 81 04     STA $0481,Y
15/B7FB: BD 18 B8     LDA $B818,X
15/B7FE: 99 82 04     STA $0482,Y
15/B801: BD 19 B8     LDA $B819,X
15/B804: 99 83 04     STA $0483,Y
15/B807: E8           INX 
15/B808: E8           INX 
15/B809: E8           INX 
15/B80A: E8           INX 
15/B80B: C8           INY 
15/B80C: C8           INY 
15/B80D: C8           INY 
15/B80E: C8           INY 
15/B80F: C0 10 00     CPY #$0010
15/B812: D0 D7        BNE $B7EB
15/B814: AB           PLB 
15/B815: 6B           RTL 

; ??? hovercraft sprite data
15/B816: 70 6A C0 2A
15/B81A: 78 6A C1 2A
15/B81E: 70 72 C2 2A
15/B822: 78 72 C3 2A
15/B826: 70 6A C4 2A
15/B82A: 78 6A C5 2A
15/B82E: 70 72 C6 2A
15/B832: 78 72 C7 2A
15/B836: 70 6A C8 2A
15/B83A: 78 6A C9 2A
15/B83E: 70 72 CA 2A
15/B842: 78 72 CB 2A
15/B846: 70 6A CC 2A
15/B84A: 78 6A CD 2A
15/B84E: 70 72 CE 2A
15/B852: 78 72 CF 2A
15/B856: 70 6A 2A 2B
15/B85A: 78 6A 2B 2B
15/B85E: 70 72 2C 2B
15/B862: 78 72 2D 2B

; [  ]

15/B866: C9 10        CMP #$10
15/B868: 90 02        BCC $B86C
15/B86A: A9 10        LDA #$10
15/B86C: 29 FC        AND #$FC
15/B86E: AA           TAX 
15/B86F: C9 10        CMP #$10
15/B871: F0 06        BEQ $B879
15/B873: A5 7A        LDA $7A         ; animation frame counter
15/B875: 29 01        AND #$01
15/B877: D0 4F        BNE $B8C8
15/B879: A5 C8        LDA $C8
15/B87B: D0 4B        BNE $B8C8
15/B87D: A5 A1        LDA $A1
15/B87F: 29 08        AND #$08
15/B881: D0 06        BNE $B889
15/B883: A5 A1        LDA $A1
15/B885: 29 04        AND #$04
15/B887: D0 05        BNE $B88E
15/B889: A9 FE        LDA #$FE
15/B88B: 4C 90 B8     JMP $B890
15/B88E: A9 00        LDA #$00
15/B890: 85 06        STA $06
15/B892: A9 70        LDA #$70
15/B894: 8D C0 04     STA $04C0
15/B897: A9 78        LDA #$78
15/B899: 18           CLC 
15/B89A: 65 06        ADC $06
15/B89C: 8D C1 04     STA $04C1
15/B89F: BF C9 B8 15  LDA $15B8C9,X
15/B8A3: 8D C2 04     STA $04C2
15/B8A6: BF CA B8 15  LDA $15B8CA,X
15/B8AA: 8D C3 04     STA $04C3
15/B8AD: A9 78        LDA #$78
15/B8AF: 8D C4 04     STA $04C4
15/B8B2: A9 78        LDA #$78
15/B8B4: 18           CLC 
15/B8B5: 65 06        ADC $06
15/B8B7: 8D C5 04     STA $04C5
15/B8BA: BF CB B8 15  LDA $15B8CB,X
15/B8BE: 8D C6 04     STA $04C6
15/B8C1: BF CC B8 15  LDA $15B8CC,X
15/B8C5: 8D C7 04     STA $04C7
15/B8C8: 6B           RTL 

15/B8C9: 3B 28 3B 68 3A 28 3A 68 39 28 39 68 38 28 38 68
15/B8D9: 38 28 38 68

; [ draw enterprise sprite ]

15/B8DD: 8B           PHB 
15/B8DE: A9 15        LDA #$15
15/B8E0: 48           PHA 
15/B8E1: AB           PLB 
15/B8E2: AD 04 17     LDA $1704
15/B8E5: C9 04        CMP #$04
15/B8E7: F0 38        BEQ $B921
15/B8E9: AD 1C 17     LDA $171C
15/B8EC: F0 20        BEQ $B90E
15/B8EE: AD 01 17     LDA $1701
15/B8F1: CD 1F 17     CMP $171F
15/B8F4: D0 18        BNE $B90E
15/B8F6: A5 AD        LDA $AD
15/B8F8: 29 0F        AND #$0F
15/B8FA: D0 12        BNE $B90E
15/B8FC: AD 1D 17     LDA $171D
15/B8FF: 85 0C        STA $0C
15/B901: AD 1E 17     LDA $171E
15/B904: 85 0E        STA $0E
15/B906: 22 47 BE 15  JSL $15BE47
15/B90A: A5 D7        LDA $D7
15/B90C: D0 03        BNE $B911
15/B90E: 4C CA B9     JMP $B9CA
15/B911: A5 AD        LDA $AD
15/B913: C9 10        CMP #$10
15/B915: F0 05        BEQ $B91C
15/B917: A9 04        LDA #$04
15/B919: 4C B7 B4     JMP $B4B7
15/B91C: A9 03        LDA #$03
15/B91E: 4C 39 B9     JMP $B939
15/B921: A5 B7        LDA $B7
15/B923: 22 66 B8 15  JSL $15B866
15/B927: A9 70        LDA #$70
15/B929: 85 0C        STA $0C
15/B92B: A9 70        LDA #$70
15/B92D: 38           SEC 
15/B92E: E5 B7        SBC $B7
15/B930: 85 0E        STA $0E
15/B932: 64 0D        STZ $0D
15/B934: 64 0F        STZ $0F
15/B936: AD 05 17     LDA $1705
15/B939: 0A           ASL 
15/B93A: 0A           ASL 
15/B93B: 0A           ASL 
15/B93C: 0A           ASL 
15/B93D: 0A           ASL 
15/B93E: 85 07        STA $07
15/B940: AD 04 17     LDA $1704
15/B943: C9 04        CMP #$04
15/B945: D0 10        BNE $B957
15/B947: AD FD 06     LDA $06FD       ; set airship animation speed
15/B94A: AA           TAX 
15/B94B: A5 7A        LDA $7A
15/B94D: 3D 37 BE     AND $BE37,X
15/B950: D0 05        BNE $B957
15/B952: A9 10        LDA #$10
15/B954: 4C 59 B9     JMP $B959
15/B957: A9 00        LDA #$00
15/B959: 18           CLC 
15/B95A: 65 07        ADC $07
15/B95C: AA           TAX 
15/B95D: A0 00 00     LDY #$0000
15/B960: BD B4 BF     LDA $BFB4,X
15/B963: 18           CLC 
15/B964: 65 0C        ADC $0C
15/B966: 99 6C 04     STA $046C,Y
15/B969: A5 0D        LDA $0D
15/B96B: 69 00        ADC #$00
15/B96D: 29 01        AND #$01
15/B96F: F0 06        BEQ $B977
15/B971: A9 5B        LDA #$5B
15/B973: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/B977: BD B5 BF     LDA $BFB5,X
15/B97A: 18           CLC 
15/B97B: 65 0E        ADC $0E
15/B97D: 99 6D 04     STA $046D,Y
15/B980: BD B6 BF     LDA $BFB6,X
15/B983: 18           CLC 
15/B984: 69 78        ADC #$78
15/B986: 99 6E 04     STA $046E,Y
15/B989: BD B7 BF     LDA $BFB7,X
15/B98C: 18           CLC 
15/B98D: 69 18        ADC #$18
15/B98F: 99 6F 04     STA $046F,Y
15/B992: E8           INX 
15/B993: E8           INX 
15/B994: E8           INX 
15/B995: E8           INX 
15/B996: C8           INY 
15/B997: C8           INY 
15/B998: C8           INY 
15/B999: C8           INY 
15/B99A: C0 10 00     CPY #$0010
15/B99D: D0 C1        BNE $B960
15/B99F: AD 04 17     LDA $1704
15/B9A2: C9 04        CMP #$04
15/B9A4: D0 24        BNE $B9CA
15/B9A6: A5 AD        LDA $AD
15/B9A8: C9 20        CMP #$20
15/B9AA: D0 1E        BNE $B9CA
15/B9AC: A5 B7        LDA $B7
15/B9AE: C9 10        CMP #$10
15/B9B0: D0 18        BNE $B9CA
15/B9B2: A9 74        LDA #$74
15/B9B4: 8D 7C 04     STA $047C
15/B9B7: AD F8 06     LDA $06F8
15/B9BA: 18           CLC 
15/B9BB: 69 68        ADC #$68
15/B9BD: 8D 7D 04     STA $047D
15/B9C0: A9 2E        LDA #$2E
15/B9C2: 8D 7E 04     STA $047E
15/B9C5: A9 21        LDA #$21
15/B9C7: 8D 7F 04     STA $047F
15/B9CA: AB           PLB 
15/B9CB: 6B           RTL 

; [ draw falcon sprite ]

15/B9CC: 8B           PHB 
15/B9CD: A9 15        LDA #$15
15/B9CF: 48           PHA 
15/B9D0: AB           PLB 
15/B9D1: AD 04 17     LDA $1704
15/B9D4: C9 05        CMP #$05
15/B9D6: F0 38        BEQ $BA10
15/B9D8: AD 20 17     LDA $1720
15/B9DB: F0 20        BEQ $B9FD
15/B9DD: AD 01 17     LDA $1701
15/B9E0: CD 23 17     CMP $1723
15/B9E3: D0 18        BNE $B9FD
15/B9E5: A5 AD        LDA $AD
15/B9E7: 29 0F        AND #$0F
15/B9E9: D0 12        BNE $B9FD
15/B9EB: AD 21 17     LDA $1721
15/B9EE: 85 0C        STA $0C
15/B9F0: AD 22 17     LDA $1722
15/B9F3: 85 0E        STA $0E
15/B9F5: 22 47 BE 15  JSL $15BE47
15/B9F9: A5 D7        LDA $D7
15/B9FB: D0 03        BNE $BA00
15/B9FD: 4C 12 BB     JMP $BB12
15/BA00: A5 AD        LDA $AD
15/BA02: C9 10        CMP #$10
15/BA04: F0 05        BEQ $BA0B
15/BA06: A9 05        LDA #$05
15/BA08: 4C B7 B4     JMP $B4B7
15/BA0B: A9 03        LDA #$03
15/BA0D: 4C 28 BA     JMP $BA28
15/BA10: A5 B8        LDA $B8
15/BA12: 22 66 B8 15  JSL $15B866
15/BA16: A9 70        LDA #$70
15/BA18: 85 0C        STA $0C
15/BA1A: A9 70        LDA #$70
15/BA1C: 38           SEC 
15/BA1D: E5 B8        SBC $B8
15/BA1F: 85 0E        STA $0E
15/BA21: 64 0D        STZ $0D
15/BA23: 64 0F        STZ $0F
15/BA25: AD 05 17     LDA $1705
15/BA28: 0A           ASL 
15/BA29: 0A           ASL 
15/BA2A: 0A           ASL 
15/BA2B: 0A           ASL 
15/BA2C: 0A           ASL 
15/BA2D: 85 07        STA $07
15/BA2F: AD 04 17     LDA $1704
15/BA32: C9 05        CMP #$05
15/BA34: D0 10        BNE $BA46
15/BA36: AD FD 06     LDA $06FD       ; set airship animation speed
15/BA39: AA           TAX 
15/BA3A: A5 7A        LDA $7A
15/BA3C: 3D 37 BE     AND $BE37,X
15/BA3F: D0 05        BNE $BA46
15/BA41: A9 10        LDA #$10
15/BA43: 4C 48 BA     JMP $BA48
15/BA46: A9 00        LDA #$00
15/BA48: 18           CLC 
15/BA49: 65 07        ADC $07
15/BA4B: AA           TAX 
15/BA4C: A0 00 00     LDY #$0000
15/BA4F: BD B4 BF     LDA $BFB4,X
15/BA52: 18           CLC 
15/BA53: 65 0C        ADC $0C
15/BA55: 99 58 04     STA $0458,Y
15/BA58: A5 0D        LDA $0D
15/BA5A: 69 00        ADC #$00
15/BA5C: 29 01        AND #$01
15/BA5E: F0 06        BEQ $BA66
15/BA60: A9 56        LDA #$56
15/BA62: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/BA66: BD B5 BF     LDA $BFB5,X
15/BA69: 18           CLC 
15/BA6A: 65 0E        ADC $0E
15/BA6C: 99 59 04     STA $0459,Y
15/BA6F: BD B6 BF     LDA $BFB6,X
15/BA72: 18           CLC 
15/BA73: 69 D8        ADC #$D8
15/BA75: 99 5A 04     STA $045A,Y
15/BA78: BD B7 BF     LDA $BFB7,X
15/BA7B: 18           CLC 
15/BA7C: 69 1C        ADC #$1C
15/BA7E: 99 5B 04     STA $045B,Y
15/BA81: E8           INX 
15/BA82: E8           INX 
15/BA83: E8           INX 
15/BA84: E8           INX 
15/BA85: C8           INY 
15/BA86: C8           INY 
15/BA87: C8           INY 
15/BA88: C8           INY 
15/BA89: C0 10 00     CPY #$0010
15/BA8C: D0 C1        BNE $BA4F
15/BA8E: AD 87 12     LDA $1287
15/BA91: 29 20        AND #$20
15/BA93: F0 7D        BEQ $BB12
15/BA95: AD 04 17     LDA $1704
15/BA98: C9 05        CMP #$05
15/BA9A: F0 09        BEQ $BAA5
15/BA9C: A5 AD        LDA $AD
15/BA9E: C9 10        CMP #$10
15/BAA0: F0 09        BEQ $BAAB
15/BAA2: 4C 12 BB     JMP $BB12
15/BAA5: AD 05 17     LDA $1705
15/BAA8: 4C AD BA     JMP $BAAD
15/BAAB: A9 03        LDA #$03
15/BAAD: 85 07        STA $07
15/BAAF: AA           TAX 
15/BAB0: BF 14 BB 15  LDA $15BB14,X
15/BAB4: A8           TAY 
15/BAB5: A5 07        LDA $07
15/BAB7: 0A           ASL 
15/BAB8: 0A           ASL 
15/BAB9: 0A           ASL 
15/BABA: 85 07        STA $07
15/BABC: AD 04 17     LDA $1704
15/BABF: C9 05        CMP #$05
15/BAC1: D0 10        BNE $BAD3
15/BAC3: AD FD 06     LDA $06FD       ; set airship animation speed
15/BAC6: AA           TAX 
15/BAC7: A5 7A        LDA $7A         ; animation frame counter
15/BAC9: 3D 37 BE     AND $BE37,X
15/BACC: F0 05        BEQ $BAD3
15/BACE: A9 04        LDA #$04
15/BAD0: 4C D5 BA     JMP $BAD5
15/BAD3: A9 00        LDA #$00
15/BAD5: 18           CLC 
15/BAD6: 65 07        ADC $07
15/BAD8: AA           TAX 
15/BAD9: A5 0C        LDA $0C
15/BADB: 38           SEC 
15/BADC: E9 08        SBC #$08
15/BADE: 85 0C        STA $0C
15/BAE0: A5 0D        LDA $0D
15/BAE2: E9 00        SBC #$00
15/BAE4: 85 0D        STA $0D
15/BAE6: A5 0C        LDA $0C
15/BAE8: 18           CLC 
15/BAE9: 7D 18 BB     ADC $BB18,X
15/BAEC: 99 54 04     STA $0454,Y
15/BAEF: A5 0D        LDA $0D
15/BAF1: 69 00        ADC #$00
15/BAF3: 29 01        AND #$01
15/BAF5: F0 06        BEQ $BAFD
15/BAF7: A9 55        LDA #$55
15/BAF9: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/BAFD: A5 0E        LDA $0E
15/BAFF: 18           CLC 
15/BB00: 7D 19 BB     ADC $BB19,X
15/BB03: 99 55 04     STA $0455,Y
15/BB06: BD 1A BB     LDA $BB1A,X
15/BB09: 99 56 04     STA $0456,Y
15/BB0C: BD 1B BB     LDA $BB1B,X
15/BB0F: 99 57 04     STA $0457,Y
15/BB12: AB           PLB 
15/BB13: 6B           RTL 

15/BB14: 14 00 00 00

; ??? falcon sprite data
15/BB18: 0C FC F4 3C
15/BB1C: 0C FC F5 3C
15/BB20: 18 08 F0 7C
15/BB24: 18 08 F1 7C
15/BB28: 0D 0D F2 3C
15/BB2C: 0D 0D F3 3C
15/BB30: 00 08 F0 3C
15/BB34: 00 08 F1 3C

; unused
15/BB38: 6B           RTL 

; [  ]

15/BB39: 8B           PHB 
15/BB3A: A9 15        LDA #$15
15/BB3C: 48           PHA 
15/BB3D: AB           PLB 
15/BB3E: A5 C8        LDA $C8
15/BB40: D0 26        BNE $BB68
15/BB42: A5 7A        LDA $7A
15/BB44: 29 01        AND #$01
15/BB46: D0 20        BNE $BB68
15/BB48: A5 B9        LDA $B9
15/BB4A: 38           SEC 
15/BB4B: E9 10        SBC #$10
15/BB4D: C9 10        CMP #$10
15/BB4F: D0 01        BNE $BB52
15/BB51: 3A           DEC 
15/BB52: 29 0C        AND #$0C
15/BB54: 0A           ASL 
15/BB55: 0A           ASL 
15/BB56: 0A           ASL 
15/BB57: AA           TAX 
15/BB58: A0 00 00     LDY #$0000
15/BB5B: BD 6A BB     LDA $BB6A,X
15/BB5E: 99 C0 04     STA $04C0,Y
15/BB61: E8           INX 
15/BB62: C8           INY 
15/BB63: C0 20 00     CPY #$0020
15/BB66: D0 F3        BNE $BB5B
15/BB68: AB           PLB 
15/BB69: 6B           RTL 

15/BB6A: 68 72 42 28
15/BB6E: 70 72 43 28
15/BB72: 78 72 43 68
15/BB76: 80 72 42 68
15/BB7A: 68 7A 42 A8
15/BB7E: 70 7A 43 A8
15/BB82: 78 7A 43 E8
15/BB86: 80 7A 42 E8

15/BB8A: 68 72 40 28
15/BB8E: 70 72 41 28
15/BB92: 78 72 41 68
15/BB96: 80 72 40 68
15/BB9A: 68 7A 40 A8
15/BB9E: 70 7A 41 A8
15/BBA2: 78 7A 41 E8
15/BBA6: 80 7A 40 E8

15/BBAA: 68 72 3E 28
15/BBAE: 70 72 3F 28
15/BBB2: 78 72 3F 68
15/BBB6: 80 72 3E 68
15/BBBA: 68 7A 3E A8
15/BBBE: 70 7A 3F A8
15/BBC2: 78 7A 3F E8
15/BBC6: 80 7A 3E E8

15/BBCA: 68 72 3C 28
15/BBCE: 70 72 3D 28
15/BBD2: 78 72 3D 68
15/BBD6: 80 72 3C 68
15/BBDA: 68 7A 3C A8
15/BBDE: 70 7A 3D A8
15/BBE2: 78 7A 3D E8
15/BBE6: 80 7A 3C E8

; [  ]

15/BBEA: A5 0E        LDA $0E
15/BBEC: 38           SEC 
15/BBED: E9 08        SBC #$08
15/BBEF: 85 0E        STA $0E
15/BBF1: A2 00 00     LDX #$0000
15/BBF4: BD 1F BC     LDA $BC1F,X
15/BBF7: 18           CLC 
15/BBF8: 65 0C        ADC $0C
15/BBFA: B0 18        BCS $BC14
15/BBFC: 9D E0 04     STA $04E0,X
15/BBFF: BD 20 BC     LDA $BC20,X
15/BC02: 18           CLC 
15/BC03: 65 0E        ADC $0E
15/BC05: 9D E1 04     STA $04E1,X
15/BC08: BD 21 BC     LDA $BC21,X
15/BC0B: 9D E2 04     STA $04E2,X
15/BC0E: BD 22 BC     LDA $BC22,X
15/BC11: 9D E3 04     STA $04E3,X
15/BC14: E8           INX 
15/BC15: E8           INX 
15/BC16: E8           INX 
15/BC17: E8           INX 
15/BC18: E0 10 00     CPX #$0010
15/BC1B: D0 D7        BNE $BBF4
15/BC1D: AB           PLB 
15/BC1E: 6B           RTL 

15/BC1F: 00 00 44 3E
15/BC23: 08 00 45 3E
15/BC27: 00 08 46 3E
15/BC2B: 08 08 47 3E

; [ draw big whale sprite ]

15/BC2F: 8B           PHB 
15/BC30: A9 15        LDA #$15
15/BC32: 48           PHA 
15/BC33: AB           PLB 
15/BC34: AD 04 17     LDA $1704
15/BC37: C9 06        CMP #$06
15/BC39: D0 03        BNE $BC3E       ; branch if player is not in big whale
15/BC3B: 4C D3 BC     JMP $BCD3
15/BC3E: AD 24 17     LDA $1724
15/BC41: F0 7F        BEQ $BCC2
15/BC43: AD 01 17     LDA $1701
15/BC46: CD 27 17     CMP $1727
15/BC49: D0 77        BNE $BCC2
15/BC4B: A5 AD        LDA $AD
15/BC4D: 29 0F        AND #$0F
15/BC4F: D0 71        BNE $BCC2
15/BC51: AD 25 17     LDA $1725
15/BC54: 3A           DEC 
15/BC55: 85 0C        STA $0C
15/BC57: AD 26 17     LDA $1726
15/BC5A: 3A           DEC 
15/BC5B: 85 0E        STA $0E
15/BC5D: AD 00 17     LDA $1700
15/BC60: C9 02        CMP #$02
15/BC62: D0 56        BNE $BCBA
15/BC64: AD 25 17     LDA $1725
15/BC67: 85 0C        STA $0C
15/BC69: AD 26 17     LDA $1726
15/BC6C: 85 0E        STA $0E
15/BC6E: AD 06 17     LDA $1706
15/BC71: C9 08        CMP #$08
15/BC73: B0 0E        BCS $BC83
15/BC75: A5 0C        LDA $0C
15/BC77: C9 30        CMP #$30
15/BC79: 90 17        BCC $BC92
15/BC7B: 38           SEC 
15/BC7C: E9 40        SBC #$40
15/BC7E: 85 0C        STA $0C
15/BC80: 4C 92 BC     JMP $BC92
15/BC83: C9 38        CMP #$38
15/BC85: 90 0B        BCC $BC92
15/BC87: A5 0C        LDA $0C
15/BC89: C9 10        CMP #$10
15/BC8B: B0 05        BCS $BC92
15/BC8D: 18           CLC 
15/BC8E: 69 40        ADC #$40
15/BC90: 85 0C        STA $0C
15/BC92: AD 07 17     LDA $1707
15/BC95: C9 08        CMP #$08
15/BC97: B0 0E        BCS $BCA7
15/BC99: A5 0E        LDA $0E
15/BC9B: C9 30        CMP #$30
15/BC9D: 90 17        BCC $BCB6
15/BC9F: 38           SEC 
15/BCA0: E9 40        SBC #$40
15/BCA2: 85 0E        STA $0E
15/BCA4: 4C B6 BC     JMP $BCB6
15/BCA7: C9 38        CMP #$38
15/BCA9: 90 0B        BCC $BCB6
15/BCAB: A5 0E        LDA $0E
15/BCAD: C9 10        CMP #$10
15/BCAF: B0 05        BCS $BCB6
15/BCB1: 18           CLC 
15/BCB2: 69 40        ADC #$40
15/BCB4: 85 0E        STA $0E
15/BCB6: C6 0C        DEC $0C
15/BCB8: C6 0E        DEC $0E
15/BCBA: 22 47 BE 15  JSL $15BE47
15/BCBE: A5 D7        LDA $D7
15/BCC0: D0 03        BNE $BCC5
15/BCC2: 4C 95 BD     JMP $BD95
15/BCC5: A5 AD        LDA $AD
15/BCC7: C9 10        CMP #$10
15/BCC9: F0 03        BEQ $BCCE
15/BCCB: 4C EA BB     JMP $BBEA
15/BCCE: A9 03        LDA #$03
15/BCD0: 4C FF BC     JMP $BCFF
15/BCD3: A5 B9        LDA $B9
15/BCD5: C9 10        CMP #$10
15/BCD7: B0 07        BCS $BCE0
15/BCD9: 22 39 BB 15  JSL $15BB39
15/BCDD: 4C ED BC     JMP $BCED
15/BCE0: 38           SEC 
15/BCE1: E9 10        SBC #$10
15/BCE3: C9 10        CMP #$10
15/BCE5: 90 02        BCC $BCE9
15/BCE7: A9 10        LDA #$10
15/BCE9: 22 66 B8 15  JSL $15B866
15/BCED: A9 60        LDA #$60
15/BCEF: 85 0C        STA $0C
15/BCF1: A9 60        LDA #$60
15/BCF3: 38           SEC 
15/BCF4: E5 B9        SBC $B9
15/BCF6: 85 0E        STA $0E
15/BCF8: 64 0D        STZ $0D
15/BCFA: 64 0F        STZ $0F
15/BCFC: AD 05 17     LDA $1705       ; player facing direction
15/BCFF: 0A           ASL 
15/BD00: 0A           ASL 
15/BD01: 0A           ASL 
15/BD02: 0A           ASL 
15/BD03: 0A           ASL 
15/BD04: 85 07        STA $07
15/BD06: A5 07        LDA $07
15/BD08: AA           TAX 
15/BD09: 86 40        STX $40
15/BD0B: A0 00 00     LDY #$0000
15/BD0E: 84 43        STY $43
15/BD10: A6 43        LDX $43
15/BD12: BD 97 BD     LDA $BD97,X
15/BD15: 18           CLC 
15/BD16: 65 0C        ADC $0C
15/BD18: 99 24 04     STA $0424,Y
15/BD1B: A5 0D        LDA $0D
15/BD1D: 69 00        ADC #$00
15/BD1F: 29 01        AND #$01
15/BD21: F0 06        BEQ $BD29
15/BD23: A9 49        LDA #$49
15/BD25: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/BD29: BD 98 BD     LDA $BD98,X
15/BD2C: 18           CLC 
15/BD2D: 65 0E        ADC $0E
15/BD2F: 99 25 04     STA $0425,Y
15/BD32: A6 40        LDX $40
15/BD34: BD B7 BD     LDA $BDB7,X
15/BD37: 99 26 04     STA $0426,Y
15/BD3A: BD B8 BD     LDA $BDB8,X
15/BD3D: 99 27 04     STA $0427,Y
15/BD40: E6 40        INC $40
15/BD42: E6 40        INC $40
15/BD44: E6 43        INC $43
15/BD46: E6 43        INC $43
15/BD48: C8           INY 
15/BD49: C8           INY 
15/BD4A: C8           INY 
15/BD4B: C8           INY 
15/BD4C: C0 20 00     CPY #$0020
15/BD4F: D0 BF        BNE $BD10
15/BD51: A0 00 00     LDY #$0000
15/BD54: A6 43        LDX $43
15/BD56: BD 97 BD     LDA $BD97,X     ; x position
15/BD59: 18           CLC 
15/BD5A: 65 0C        ADC $0C
15/BD5C: 99 A0 04     STA $04A0,Y
15/BD5F: A5 0D        LDA $0D
15/BD61: 69 00        ADC #$00
15/BD63: 29 01        AND #$01
15/BD65: F0 06        BEQ $BD6D
15/BD67: A9 68        LDA #$68
15/BD69: 22 AF B3 15  JSL $15B3AF     ; set sprite x position msb
15/BD6D: BD 98 BD     LDA $BD98,X     ; y position
15/BD70: 18           CLC 
15/BD71: 65 0E        ADC $0E
15/BD73: 99 A1 04     STA $04A1,Y
15/BD76: A6 40        LDX $40
15/BD78: BD B7 BD     LDA $BDB7,X
15/BD7B: 99 A2 04     STA $04A2,Y
15/BD7E: BD B8 BD     LDA $BDB8,X
15/BD81: 99 A3 04     STA $04A3,Y
15/BD84: E6 40        INC $40
15/BD86: E6 40        INC $40
15/BD88: E6 43        INC $43
15/BD8A: E6 43        INC $43
15/BD8C: C8           INY 
15/BD8D: C8           INY 
15/BD8E: C8           INY 
15/BD8F: C8           INY 
15/BD90: C0 20 00     CPY #$0020
15/BD93: D0 BF        BNE $BD54
15/BD95: AB           PLB 
15/BD96: 6B           RTL 

; big whale sprite xy positions
15/BD97: 08 FD
15/BD99: 10 FD
15/BD9B: 18 FD
15/BD9D: 20 FD
15/BD9F: 08 05
15/BDA1: 10 05
15/BDA3: 18 05
15/BDA5: 20 05
15/BDA7: 08 0D
15/BDA9: 10 0D
15/BDAB: 18 0D
15/BDAD: 20 0D
15/BDAF: 08 15
15/BDB1: 10 15
15/BDB3: 18 15
15/BDB5: 20 15

; big whale sprite tile id and flags

; up
15/BDB7: 0A 2F
15/BDB9: 0B 2F
15/BDBB: 0C 2F
15/BDBD: 0A 6F
15/BDBF: 0E 2F
15/BDC1: 0F 2F
15/BDC3: 10 2F
15/BDC5: 0E 6F
15/BDC7: 12 2F
15/BDC9: 13 2F
15/BDCB: 14 2F
15/BDCD: 12 6F
15/BDCF: 16 2F
15/BDD1: 17 2F
15/BDD3: 18 2F
15/BDD5: 19 2F
; right
15/BDD7: 1D 6F
15/BDD9: 0D 6F
15/BDDB: 1B 6F
15/BDDD: 1A 6F
15/BDDF: 21 6F
15/BDE1: 20 6F
15/BDE3: 1F 6F
15/BDE5: 1E 6F
15/BDE7: 25 6F
15/BDE9: 24 6F
15/BDEB: 23 6F
15/BDED: 22 6F
15/BDEF: 0D 6F
15/BDF1: 28 6F
15/BDF3: 27 6F
15/BDF5: 26 6F
; down
15/BDF7: FA 2E
15/BDF9: FB 2E
15/BDFB: FC 2E
15/BDFD: FA 6E
15/BDFF: FE 2E
15/BE01: FF 2E
15/BE03: 00 2F
15/BE05: 0D 6F
15/BE07: 02 2F
15/BE09: 03 2F
15/BE0B: 04 2F
15/BE0D: 02 6F
15/BE0F: 06 2F
15/BE11: 07 2F
15/BE13: 08 2F
15/BE15: 06 6F
; left
15/BE17: 1A 2F
15/BE19: 1B 2F
15/BE1B: 0D 2F
15/BE1D: 1D 2F
15/BE1F: 1E 2F
15/BE21: 1F 2F
15/BE23: 20 2F
15/BE25: 21 2F
15/BE27: 22 2F
15/BE29: 23 2F
15/BE2B: 24 2F
15/BE2D: 25 2F
15/BE2F: 26 2F
15/BE31: 27 2F
15/BE33: 28 2F
15/BE35: 0D 2F

; airship animation speed frame masks
15/BE37: 10 10 10 08 08 08 08 04 08 04 04 04 02 02 02 02

; [  ]

15/BE47: 8B           PHB 
15/BE48: A9 15        LDA #$15
15/BE4A: 48           PHA 
15/BE4B: AB           PLB 
15/BE4C: 64 D7        STZ $D7
15/BE4E: A5 AD        LDA $AD
15/BE50: 4A           LSR 
15/BE51: 4A           LSR 
15/BE52: 4A           LSR 
15/BE53: 4A           LSR 
15/BE54: 3A           DEC 
15/BE55: A8           TAY 
15/BE56: A5 0C        LDA $0C
15/BE58: 18           CLC 
15/BE59: 79 A8 BF     ADC $BFA8,Y
15/BE5C: 38           SEC 
15/BE5D: ED 06 17     SBC $1706
15/BE60: D9 AB BF     CMP $BFAB,Y
15/BE63: 90 03        BCC $BE68
15/BE65: 4C A6 BF     JMP $BFA6
15/BE68: 85 0C        STA $0C
15/BE6A: C0 00 00     CPY #$0000
15/BE6D: D0 1D        BNE $BE8C
15/BE6F: 3A           DEC 
15/BE70: 3A           DEC 
15/BE71: 0A           ASL 
15/BE72: 0A           ASL 
15/BE73: 0A           ASL 
15/BE74: 0A           ASL 
15/BE75: 26 0D        ROL $0D
15/BE77: 85 0C        STA $0C
15/BE79: A5 5A        LDA $5A
15/BE7B: 29 0F        AND #$0F
15/BE7D: 85 06        STA $06
15/BE7F: A5 0C        LDA $0C
15/BE81: 38           SEC 
15/BE82: E5 06        SBC $06
15/BE84: 85 0C        STA $0C
15/BE86: A5 0D        LDA $0D
15/BE88: E9 00        SBC #$00
15/BE8A: 85 0D        STA $0D
15/BE8C: A5 0E        LDA $0E
15/BE8E: 18           CLC 
15/BE8F: 79 AE BF     ADC $BFAE,Y
15/BE92: 38           SEC 
15/BE93: ED 07 17     SBC $1707
15/BE96: D9 B1 BF     CMP $BFB1,Y
15/BE99: 90 03        BCC $BE9E
15/BE9B: 4C A6 BF     JMP $BFA6
15/BE9E: 85 0E        STA $0E
15/BEA0: C0 00 00     CPY #$0000
15/BEA3: D0 14        BNE $BEB9
15/BEA5: 3A           DEC 
15/BEA6: 0A           ASL 
15/BEA7: 0A           ASL 
15/BEA8: 0A           ASL 
15/BEA9: 0A           ASL 
15/BEAA: 85 0E        STA $0E
15/BEAC: A5 5C        LDA $5C
15/BEAE: 29 0F        AND #$0F
15/BEB0: 85 06        STA $06
15/BEB2: A5 0E        LDA $0E
15/BEB4: 38           SEC 
15/BEB5: E5 06        SBC $06
15/BEB7: 85 0E        STA $0E
15/BEB9: C0 00 00     CPY #$0000
15/BEBC: D0 03        BNE $BEC1
15/BEBE: 4C A4 BF     JMP $BFA4
15/BEC1: 64 0A        STZ $0A
15/BEC3: C0 02 00     CPY #$0002
15/BEC6: F0 60        BEQ $BF28
15/BEC8: A5 5C        LDA $5C
15/BECA: 29 0F        AND #$0F
15/BECC: D0 0A        BNE $BED8
15/BECE: A5 0E        LDA $0E
15/BED0: AA           TAX 
15/BED1: BF 80 F3 14  LDA $14F380,X
15/BED5: 4C F0 BE     JMP $BEF0
15/BED8: A5 0E        LDA $0E
15/BEDA: D0 03        BNE $BEDF
15/BEDC: 4C A6 BF     JMP $BFA6
15/BEDF: 3A           DEC 
15/BEE0: AA           TAX 
15/BEE1: BF 81 F3 14  LDA $14F381,X
15/BEE5: 38           SEC 
15/BEE6: FF 80 F3 14  SBC $14F380,X
15/BEEA: 4A           LSR 
15/BEEB: 18           CLC 
15/BEEC: 7F 80 F3 14  ADC $14F380,X
15/BEF0: 85 0E        STA $0E
15/BEF2: 85 18        STA $18
15/BEF4: 64 19        STZ $19
15/BEF6: 06 18        ASL $18
15/BEF8: 26 19        ROL $19
15/BEFA: A6 18        LDX $18
15/BEFC: BF 00 F0 14  LDA $14F000,X
15/BF00: 85 18        STA $18
15/BF02: BF 01 F0 14  LDA $14F001,X
15/BF06: 85 19        STA $19
15/BF08: A5 5A        LDA $5A
15/BF0A: 29 08        AND #$08
15/BF0C: 4A           LSR 
15/BF0D: 4A           LSR 
15/BF0E: 4A           LSR 
15/BF0F: 85 1A        STA $1A
15/BF11: A5 0C        LDA $0C
15/BF13: 0A           ASL 
15/BF14: 38           SEC 
15/BF15: E5 1A        SBC $1A
15/BF17: 38           SEC 
15/BF18: E9 26        SBC #$26
15/BF1A: 10 05        BPL $BF21
15/BF1C: E6 0A        INC $0A
15/BF1E: 49 FF        EOR #$FF
15/BF20: 1A           INC 
15/BF21: 85 1A        STA $1A
15/BF23: 64 1B        STZ $1B
15/BF25: 4C 85 BF     JMP $BF85
15/BF28: A5 5C        LDA $5C
15/BF2A: 29 0F        AND #$0F
15/BF2C: D0 0A        BNE $BF38
15/BF2E: A5 0E        LDA $0E
15/BF30: AA           TAX 
15/BF31: BF A1 F3 14  LDA $14F3A1,X
15/BF35: 4C 50 BF     JMP $BF50
15/BF38: A5 0E        LDA $0E
15/BF3A: D0 03        BNE $BF3F
15/BF3C: 4C A6 BF     JMP $BFA6
15/BF3F: 3A           DEC 
15/BF40: AA           TAX 
15/BF41: BF A2 F3 14  LDA $14F3A2,X
15/BF45: 38           SEC 
15/BF46: FF A1 F3 14  SBC $14F3A1,X
15/BF4A: 4A           LSR 
15/BF4B: 18           CLC 
15/BF4C: 7F A1 F3 14  ADC $14F3A1,X
15/BF50: 85 0E        STA $0E
15/BF52: 85 18        STA $18
15/BF54: 64 19        STZ $19
15/BF56: 06 18        ASL $18
15/BF58: 26 19        ROL $19
15/BF5A: A6 18        LDX $18
15/BF5C: BF C0 F1 14  LDA $14F1C0,X
15/BF60: 85 18        STA $18
15/BF62: BF C1 F1 14  LDA $14F1C1,X
15/BF66: 85 19        STA $19
15/BF68: A5 5A        LDA $5A
15/BF6A: 29 08        AND #$08
15/BF6C: 4A           LSR 
15/BF6D: 4A           LSR 
15/BF6E: 4A           LSR 
15/BF6F: 85 1A        STA $1A
15/BF71: A5 0C        LDA $0C
15/BF73: 0A           ASL 
15/BF74: 38           SEC 
15/BF75: E5 1A        SBC $1A
15/BF77: 38           SEC 
15/BF78: E9 40        SBC #$40
15/BF7A: 10 05        BPL $BF81
15/BF7C: E6 0A        INC $0A
15/BF7E: 49 FF        EOR #$FF
15/BF80: 1A           INC 
15/BF81: 85 1A        STA $1A
15/BF83: 64 1B        STZ $1B
15/BF85: 22 8F C3 15  JSL $15C38F
15/BF89: 46 32        LSR $32
15/BF8B: 66 31        ROR $31
15/BF8D: A5 0A        LDA $0A
15/BF8F: D0 0A        BNE $BF9B
15/BF91: A5 31        LDA $31
15/BF93: 18           CLC 
15/BF94: 69 78        ADC #$78
15/BF96: B0 0E        BCS $BFA6
15/BF98: 4C A2 BF     JMP $BFA2
15/BF9B: A9 78        LDA #$78
15/BF9D: 38           SEC 
15/BF9E: E5 31        SBC $31
15/BFA0: 90 04        BCC $BFA6
15/BFA2: 85 0C        STA $0C
15/BFA4: E6 D7        INC $D7
15/BFA6: AB           PLB 
15/BFA7: 6B           RTL 

15/BFA8: 09 13 20 13 2C 42
15/BFAE: 08 17 1F 10 21 2C

15/BFB4: 00 00 08 20
15/BFB8: 08 00 09 20
15/BFBC: 00 08 0A 20
15/BFC0: 08 08 0B 20

15/BFC4: 00 00 0C 20
15/BFC8: 08 00 0D 20
15/BFCC: 00 08 0E 20
15/BFD0: 08 08 0F 20

15/BFD4: 00 00 11 60
15/BFD8: 08 00 10 60
15/BFDC: 00 08 13 60
15/BFE0: 08 08 12 60

15/BFE4: 00 00 15 60
15/BFE8: 08 00 14 60
15/BFEC: 00 08 17 60
15/BFF0: 08 08 16 60

15/BFF4: 00 00 00 20
15/BFF8: 08 00 01 20
15/BFFC: 00 08 02 20
15/C000: 08 08 03 20

15/C004: 00 00 04 20
15/C008: 08 00 05 20
15/C00C: 00 08 06 20
15/C010: 08 08 07 20

15/C014: 00 00 10 20
15/C018: 08 00 11 20
15/C01C: 00 08 12 20
15/C020: 08 08 13 20

15/C024: 00 00 14 20
15/C028: 08 00 15 20
15/C02C: 00 08 16 20
15/C030: 08 08 17 20

15/C034: 00 00 24 38
15/C038: 08 00 25 38
15/C03C: 00 08 26 38
15/C040: 08 08 27 38

15/C044: 00 00 25 78
15/C048: 08 00 24 78
15/C04C: 00 08 27 78
15/C050: 08 08 26 78

15/C054: 00 00 29 78
15/C058: 08 00 28 78
15/C05C: 00 08 2B 78
15/C060: 08 08 2A 78

15/C064: 00 00 2D 78
15/C06C: 08 00 2C 78
15/C06C: 00 08 2F 78
15/C070: 08 08 2E 78

15/C074: 00 00 20 38
15/C078: 08 00 21 38
15/C07C: 00 08 22 38
15/C080: 08 08 23 38

15/C084: 00 00 21 78
15/C088: 08 00 20 78
15/C08C: 00 08 23 78
15/C090: 08 08 22 78

15/C094: 00 00 28 38
15/C098: 08 00 29 38
15/C09C: 00 08 2A 38
15/C0A0: 08 08 2B 38

15/C0A4: 00 00 2C 38
15/C0A8: 08 00 2D 38
15/C0AC: 00 08 2E 38
15/C0B0: 08 08 2F 38

15/C0B4: 70 6D 00 00
15/C0B8: 78 6D 00 00
15/C0BC: 70 75 00 00
15/C0C0: 78 75 00 00

15/C0C4: 04 20 05 20 06 20 07 20 04 20 05 20 07 60 06 60
15/C0D4: 09 60 08 60 0B 60 0A 60 0D 60 0C 60 0F 60 0E 60
15/C0E4: 00 20 01 20 02 20 03 20 00 20 01 20 03 60 02 60
15/C0F4: 08 20 09 20 0A 20 0B 20 0C 20 0D 20 0E 20 0F 20
15/C104: 14 20 15 20 16 20 17 20 18 20 19 20 1A 20 1B 20
15/C114: 18 20 19 20 1A 20 1B 20 18 20 19 20 1A 20 1B 20
15/C124: 10 20 11 2012 20 13 20 10 20 11 20 12 20 13 20
15/C134: 1C 20 1D 20 1E 20 1F 20 1C 20 1D 20 1E 20 1F 20

; [  ]

15/C144: AD 8A 12     LDA $128A       ; check event switch $56
15/C147: 29 40        AND #$40
15/C149: D0 17        BNE $C162
15/C14B: A2 00 5A     LDX #$5A00
15/C14E: 86 4C        STX $4C
15/C150: A2 00 06     LDX #$0600
15/C153: 86 4E        STX $4E
15/C155: A2 00 9E     LDX #$9E00      ; 1C/9E00
15/C158: 86 4A        STX $4A
15/C15A: A9 1C        LDA #$1C
15/C15C: 85 49        STA $49
15/C15E: 22 00 B0 15  JSL $15B000     ; transfer 3bpp graphics to vram
15/C162: 6B           RTL 

; [ update mode 7 zoom hdma table ]

15/C163: AD 00 17     LDA $1700
15/C166: C9 03        CMP #$03
15/C168: D0 01        BNE $C16B       ; return if not on a world map
15/C16A: 6B           RTL 
15/C16B: 9C 1C 21     STZ $211C       ; clear off-diagonal matrix elements
15/C16E: 9C 1C 21     STZ $211C
15/C171: 9C 1D 21     STZ $211D
15/C174: 9C 1D 21     STZ $211D
15/C177: A9 F0        LDA #$F0        ; 224 scanlines total
15/C179: 8F 00 5A 7F  STA $7F5A00
15/C17D: 8F 03 5A 7F  STA $7F5A03
15/C181: AD 04 17     LDA $1704
15/C184: C9 06        CMP #$06
15/C186: F0 20        BEQ $C1A8       ; branch if in big whale
; not big whale
15/C188: A5 AD        LDA $AD
15/C18A: 38           SEC 
15/C18B: E9 10        SBC #$10
15/C18D: 0A           ASL 
15/C18E: 18           CLC 
15/C18F: 69 00        ADC #$00
15/C191: 8F 02 5A 7F  STA $7F5A02
15/C195: 8F 05 5A 7F  STA $7F5A05
15/C199: A9 00        LDA #$00
15/C19B: 8F 01 5A 7F  STA $7F5A01
15/C19F: A9 E0        LDA #$E0
15/C1A1: 8F 04 5A 7F  STA $7F5A04
15/C1A5: 4C C6 C1     JMP $C1C6
; big whale
15/C1A8: A5 AD        LDA $AD
15/C1AA: 38           SEC 
15/C1AB: E9 10        SBC #$10
15/C1AD: 29 FE        AND #$FE
15/C1AF: 18           CLC 
15/C1B0: 69 22        ADC #$22
15/C1B2: 8F 02 5A 7F  STA $7F5A02
15/C1B6: 8F 05 5A 7F  STA $7F5A05
15/C1BA: A9 00        LDA #$00
15/C1BC: 8F 01 5A 7F  STA $7F5A01
15/C1C0: A9 E0        LDA #$E0
15/C1C2: 8F 04 5A 7F  STA $7F5A04
15/C1C6: A9 80        LDA #$80        ; hdma terminator
15/C1C8: 8F 06 5A 7F  STA $7F5A06
15/C1CC: 9C 0C 42     STZ $420C       ; disable hdma
15/C1CF: A9 42        LDA #$42
15/C1D1: 8D 40 43     STA $4340
15/C1D4: 8D 50 43     STA $4350
15/C1D7: A9 1B        LDA #$1B        ; $211B (top left matrix element)
15/C1D9: 8D 41 43     STA $4341
15/C1DC: A9 1E        LDA #$1E        ; $211E (bottom right matrix element)
15/C1DE: 8D 51 43     STA $4351
15/C1E1: A2 00 5A     LDX #$5A00      ; both hdma channels use the same data
15/C1E4: 8E 42 43     STX $4342
15/C1E7: 8E 52 43     STX $4352
15/C1EA: A9 7F        LDA #$7F
15/C1EC: 8D 44 43     STA $4344
15/C1EF: 8D 54 43     STA $4354
15/C1F2: 8D 47 43     STA $4347
15/C1F5: 8D 57 43     STA $4357
15/C1F8: 6B           RTL 

; [ load map palette ]

15/C1F9: AD E0 0F     LDA $0FE0
15/C1FC: 85 19        STA $19
15/C1FE: 64 18        STZ $18
15/C200: 46 19        LSR $19
15/C202: 66 18        ROR $18
15/C204: A6 18        LDX $18
15/C206: A0 20 00     LDY #$0020
15/C209: BF 10 DE 14  LDA $14DE10,X   ; map palettes
15/C20D: 99 DB 0C     STA $0CDB,Y
15/C210: BF 90 DE 14  LDA $14DE90,X
15/C214: 99 EB 0C     STA $0CEB,Y
15/C217: E8           INX 
15/C218: C8           INY 
15/C219: 98           TYA 
15/C21A: 29 0F        AND #$0F
15/C21C: D0 EB        BNE $C209
15/C21E: 98           TYA 
15/C21F: 18           CLC 
15/C220: 69 10        ADC #$10
15/C222: A8           TAY 
15/C223: D0 E4        BNE $C209
15/C225: 6B           RTL 

; [ load text window palette ]

15/C226: A2 00 00     LDX #$0000
15/C229: BF D0 87 0D  LDA $0D87D0,X   ; window palette
15/C22D: 9D DB 0C     STA $0CDB,X
15/C230: E8           INX 
15/C231: E0 20 00     CPX #$0020
15/C234: D0 F3        BNE $C229
15/C236: AE AA 16     LDX $16AA
15/C239: 8E DD 0C     STX $0CDD
15/C23C: 6B           RTL 

; [ no effect ]

; called at beginning of vblank, probably a debug subroutine

15/C23D: 6B           RTL 

; [ load initial spell lists ]

15/C23E: A2 00 00     LDX #$0000
15/C241: A0 00 00     LDY #$0000
15/C244: 64 07        STZ $07
15/C246: BF C0 C8 0F  LDA $0FC8C0,X   ; initial spell lists
15/C24A: C9 FF        CMP #$FF
15/C24C: F0 11        BEQ $C25F
15/C24E: 99 60 15     STA $1560,Y
15/C251: C8           INY 
15/C252: E6 07        INC $07
15/C254: A5 07        LDA $07
15/C256: C9 18        CMP #$18
15/C258: D0 15        BNE $C26F
15/C25A: 64 07        STZ $07
15/C25C: 4C 6F C2     JMP $C26F
15/C25F: A9 00        LDA #$00
15/C261: 99 60 15     STA $1560,Y
15/C264: C8           INY 
15/C265: E6 07        INC $07
15/C267: A5 07        LDA $07
15/C269: C9 18        CMP #$18
15/C26B: D0 F2        BNE $C25F
15/C26D: 64 07        STZ $07
15/C26F: E8           INX 
15/C270: C0 38 01     CPY #$0138
15/C273: D0 D1        BNE $C246
15/C275: 6B           RTL 

; [  ]

15/C276: A9 80        LDA #$80
15/C278: 8D 15 21     STA $2115
15/C27B: A2 82 28     LDX #$2882
15/C27E: 8E 16 21     STX $2116
15/C281: A5 86        LDA $86
15/C283: 4A           LSR 
15/C284: 4A           LSR 
15/C285: 4A           LSR 
15/C286: 4A           LSR 
15/C287: C9 0A        CMP #$0A
15/C289: 90 06        BCC $C291
15/C28B: 18           CLC 
15/C28C: 69 38        ADC #$38
15/C28E: 4C 93 C2     JMP $C293
15/C291: 09 80        ORA #$80
15/C293: 8D 18 21     STA $2118
15/C296: A9 20        LDA #$20
15/C298: 8D 19 21     STA $2119
15/C29B: A5 86        LDA $86
15/C29D: 29 0F        AND #$0F
15/C29F: C9 0A        CMP #$0A
15/C2A1: 90 06        BCC $C2A9
15/C2A3: 18           CLC 
15/C2A4: 69 38        ADC #$38
15/C2A6: 4C AB C2     JMP $C2AB
15/C2A9: 09 80        ORA #$80
15/C2AB: 8D 18 21     STA $2118
15/C2AE: A9 20        LDA #$20
15/C2B0: 8D 19 21     STA $2119
15/C2B3: 9C 18 21     STZ $2118
15/C2B6: 9C 19 21     STZ $2119
15/C2B9: A5 87        LDA $87
15/C2BB: 4A           LSR 
15/C2BC: 4A           LSR 
15/C2BD: 4A           LSR 
15/C2BE: 4A           LSR 
15/C2BF: C9 0A        CMP #$0A
15/C2C1: 90 06        BCC $C2C9
15/C2C3: 18           CLC 
15/C2C4: 69 38        ADC #$38
15/C2C6: 4C CB C2     JMP $C2CB
15/C2C9: 09 80        ORA #$80
15/C2CB: 8D 18 21     STA $2118
15/C2CE: A9 20        LDA #$20
15/C2D0: 8D 19 21     STA $2119
15/C2D3: A5 87        LDA $87
15/C2D5: 29 0F        AND #$0F
15/C2D7: C9 0A        CMP #$0A
15/C2D9: 90 06        BCC $C2E1
15/C2DB: 18           CLC 
15/C2DC: 69 38        ADC #$38
15/C2DE: 4C E3 C2     JMP $C2E3
15/C2E1: 09 80        ORA #$80
15/C2E3: 8D 18 21     STA $2118
15/C2E6: A9 20        LDA #$20
15/C2E8: 8D 19 21     STA $2119
15/C2EB: A2 C2 28     LDX #$28C2
15/C2EE: 8E 16 21     STX $2116
15/C2F1: A5 88        LDA $88
15/C2F3: 4A           LSR 
15/C2F4: 4A           LSR 
15/C2F5: 4A           LSR 
15/C2F6: 4A           LSR 
15/C2F7: C9 0A        CMP #$0A
15/C2F9: 90 06        BCC $C301
15/C2FB: 18           CLC 
15/C2FC: 69 38        ADC #$38
15/C2FE: 4C 03 C3     JMP $C303
15/C301: 09 80        ORA #$80
15/C303: 8D 18 21     STA $2118
15/C306: A9 20        LDA #$20
15/C308: 8D 19 21     STA $2119
15/C30B: A5 88        LDA $88
15/C30D: 29 0F        AND #$0F
15/C30F: C9 0A        CMP #$0A
15/C311: 90 06        BCC $C319
15/C313: 18           CLC 
15/C314: 69 38        ADC #$38
15/C316: 4C 1B C3     JMP $C31B
15/C319: 09 80        ORA #$80
15/C31B: 8D 18 21     STA $2118
15/C31E: A9 20        LDA #$20
15/C320: 8D 19 21     STA $2119
15/C323: 6B           RTL 

; [ convert hex to decimal ]

15/C324: DA           PHX 
15/C325: 5A           PHY 
15/C326: A2 00 00     LDX #$0000
15/C329: A0 80 00     LDY #$0080
15/C32C: 64 33        STZ $33
15/C32E: C2 20        REP #$20
15/C330: A5 30        LDA $30
15/C332: 38           SEC 
15/C333: FF 6F C3 15  SBC $15C36F,X
15/C337: 85 30        STA $30
15/C339: A5 32        LDA $32
15/C33B: FF 7F C3 15  SBC $15C37F,X
15/C33F: 85 32        STA $32
15/C341: 90 04        BCC $C347
15/C343: C8           INY 
15/C344: 4C 2E C3     JMP $C32E
15/C347: A5 30        LDA $30
15/C349: 18           CLC 
15/C34A: 7F 6F C3 15  ADC $15C36F,X
15/C34E: 85 30        STA $30
15/C350: A5 32        LDA $32
15/C352: 7F 7F C3 15  ADC $15C37F,X
15/C356: 85 32        STA $32
15/C358: A9 00 00     LDA #$0000
15/C35B: E2 20        SEP #$20
15/C35D: DA           PHX 
15/C35E: 8A           TXA 
15/C35F: 4A           LSR 
15/C360: AA           TAX 
15/C361: 98           TYA 
15/C362: 95 34        STA $34,X
15/C364: FA           PLX 
15/C365: E8           INX 
15/C366: E8           INX 
15/C367: E0 10 00     CPX #$0010
15/C36A: D0 BD        BNE $C329
15/C36C: 7A           PLY 
15/C36D: FA           PLX 
15/C36E: 6B           RTL 

; powers of 10 (lo word)
15/C36F: 9680 4240 86A0 2710 03E8 0064 000A 0001

; powers of 10 (hi word)
15/C37F: 0098 000F 0001 0000 0000 0000 0000 0000

; [  ]

15/C38F: 64 1C        STZ $1C
15/C391: 64 30        STZ $30
15/C393: 64 31        STZ $31
15/C395: 64 32        STZ $32
15/C397: A0 10 00     LDY #$0010
15/C39A: 46 19        LSR $19
15/C39C: 66 18        ROR $18
15/C39E: 90 13        BCC $C3B3
15/C3A0: A5 30        LDA $30
15/C3A2: 18           CLC 
15/C3A3: 65 1A        ADC $1A
15/C3A5: 85 30        STA $30
15/C3A7: A5 31        LDA $31
15/C3A9: 65 1B        ADC $1B
15/C3AB: 85 31        STA $31
15/C3AD: A5 32        LDA $32
15/C3AF: 65 1C        ADC $1C
15/C3B1: 85 32        STA $32
15/C3B3: 06 1A        ASL $1A
15/C3B5: 26 1B        ROL $1B
15/C3B7: 26 1C        ROL $1C
15/C3B9: 88           DEY 
15/C3BA: D0 DE        BNE $C39A
15/C3BC: 6B           RTL 

; [ update big whale palette animation ]

15/C3BD: AD 04 17     LDA $1704
15/C3C0: C9 06        CMP #$06
15/C3C2: D0 15        BNE $C3D9       ; return if not in big whale
15/C3C4: A5 7A        LDA $7A
15/C3C6: 4A           LSR 
15/C3C7: 4A           LSR 
15/C3C8: 29 0E        AND #$0E
15/C3CA: AA           TAX 
15/C3CB: BF DA C3 15  LDA $15C3DA,X
15/C3CF: 8D C7 0E     STA $0EC7
15/C3D2: BF DB C3 15  LDA $15C3DB,X
15/C3D6: 8D C8 0E     STA $0EC8
15/C3D9: 6B           RTL 

; big whale palette animation colors
15/C3DA: 021F 0198 0110 0088 0088 0110 0198 021F

; [ update tower of bab-il palette animation ]

15/C3EA: AD 00 17     LDA $1700
15/C3ED: C9 02        CMP #$02
15/C3EF: B0 28        BCS $C419       ; return if not overworld or underground
; overworld
15/C3F1: C9 00        CMP #$00
15/C3F3: D0 06        BNE $C3FB
15/C3F5: A2 1E 00     LDX #$001E      ; bg palette 0
15/C3F8: 4C FE C3     JMP $C3FE
; underground
15/C3FB: A2 7E 00     LDX #$007E      ; bg palette 3
15/C3FE: AD 88 12     LDA $1288
15/C401: 29 04        AND #$04
15/C403: F0 0E        BEQ $C413       ; branch if not flashing
15/C405: A5 7A        LDA $7A
15/C407: 0A           ASL 
15/C408: 9D DB 0C     STA $0CDB,X
15/C40B: 49 FF        EOR #$FF
15/C40D: 9D DC 0C     STA $0CDC,X
15/C410: 4C 19 C4     JMP $C419
15/C413: 9E DB 0C     STZ $0CDB,X
15/C416: 9E DC 0C     STZ $0CDC,X
15/C419: 6B           RTL 

; [  ]

15/C41A: AD DD 0F     LDA $0FDD
15/C41D: C9 09        CMP #$09
15/C41F: F0 72        BEQ $C493
15/C421: C9 08        CMP #$08
15/C423: F0 08        BEQ $C42D
15/C425: C9 0A        CMP #$0A
15/C427: 90 69        BCC $C492
15/C429: C9 0C        CMP #$0C
15/C42B: B0 65        BCS $C492
15/C42D: A5 7A        LDA $7A
15/C42F: 4A           LSR 
15/C430: 4A           LSR 
15/C431: 29 0E        AND #$0E
15/C433: AA           TAX 
15/C434: C2 20        REP #$20
15/C436: BF D6 F7 14  LDA $14F7D6,X
15/C43A: 8D FD 0C     STA $0CFD
15/C43D: BF E6 F7 14  LDA $14F7E6,X
15/C441: 8D 1D 0D     STA $0D1D
15/C444: BF F6 F7 14  LDA $14F7F6,X
15/C448: 8D 5D 0D     STA $0D5D
15/C44B: A9 00 00     LDA #$0000
15/C44E: E2 20        SEP #$20
15/C450: AD DD 0F     LDA $0FDD
15/C453: C9 0B        CMP #$0B
15/C455: F0 20        BEQ $C477
15/C457: A5 7A        LDA $7A
15/C459: 4A           LSR 
15/C45A: 4A           LSR 
15/C45B: 4A           LSR 
15/C45C: 29 0F        AND #$0F
15/C45E: C9 08        CMP #$08
15/C460: 90 05        BCC $C467
15/C462: 49 FF        EOR #$FF
15/C464: 18           CLC 
15/C465: 69 09        ADC #$09
15/C467: 0A           ASL 
15/C468: AA           TAX 
15/C469: A0 00 00     LDY #$0000
15/C46C: BF 06 F8 14  LDA $14F806,X
15/C470: E8           INX 
15/C471: C8           INY 
15/C472: C0 10 00     CPY #$0010
15/C475: D0 F5        BNE $C46C
15/C477: A5 7A        LDA $7A
15/C479: 4A           LSR 
15/C47A: 29 1E        AND #$1E
15/C47C: AA           TAX 
15/C47D: A0 00 00     LDY #$0000
15/C480: BF 26 F8 14  LDA $14F826,X
15/C484: 99 BD 0D     STA $0DBD,Y
15/C487: E8           INX 
15/C488: 8A           TXA 
15/C489: 29 1F        AND #$1F
15/C48B: AA           TAX 
15/C48C: C8           INY 
15/C48D: C0 10 00     CPY #$0010
15/C490: D0 EE        BNE $C480
15/C492: 6B           RTL 
15/C493: A5 7A        LDA $7A
15/C495: 4A           LSR 
15/C496: 4A           LSR 
15/C497: 29 0E        AND #$0E
15/C499: AA           TAX 
15/C49A: AD E0 0F     LDA $0FE0
15/C49D: C9 0F        CMP #$0F
15/C49F: D0 05        BNE $C4A6
15/C4A1: 8A           TXA 
15/C4A2: 18           CLC 
15/C4A3: 69 40        ADC #$40
15/C4A5: AA           TAX 
15/C4A6: C2 20        REP #$20
15/C4A8: BF C6 FB 14  LDA $14FBC6,X
15/C4AC: 8D FD 0C     STA $0CFD
15/C4AF: BF D6 FB 14  LDA $14FBD6,X
15/C4B3: 8D FF 0C     STA $0CFF
15/C4B6: 8D 7F 0D     STA $0D7F
15/C4B9: BF E6 FB 14  LDA $14FBE6,X
15/C4BD: 8D 01 0D     STA $0D01
15/C4C0: BF F6 FB 14  LDA $14FBF6,X
15/C4C4: 8D 7D 0D     STA $0D7D
15/C4C7: A9 00 00     LDA #$0000
15/C4CA: E2 20        SEP #$20
15/C4CC: 6B           RTL 

; [  ]

15/C4CD: AD 00 17     LDA $1700
15/C4D0: C9 01        CMP #$01
15/C4D2: D0 28        BNE $C4FC
15/C4D4: A5 7A        LDA $7A
15/C4D6: 29 70        AND #$70
15/C4D8: 4A           LSR 
15/C4D9: 4A           LSR 
15/C4DA: 4A           LSR 
15/C4DB: 4A           LSR 
15/C4DC: AA           TAX 
15/C4DD: BF FD C4 15  LDA $15C4FD,X
15/C4E1: AA           TAX 
15/C4E2: A0 00 00     LDY #$0000
15/C4E5: C2 20        REP #$20
15/C4E7: BF 16 FA 14  LDA $14FA16,X
15/C4EB: 99 FF 0C     STA $0CFF,Y
15/C4EE: E8           INX 
15/C4EF: E8           INX 
15/C4F0: C8           INY 
15/C4F1: C8           INY 
15/C4F2: C0 10 00     CPY #$0010
15/C4F5: D0 F0        BNE $C4E7
15/C4F7: A9 00 00     LDA #$0000
15/C4FA: E2 20        SEP #$20
15/C4FC: 6B           RTL 

15/C4FD: 00 10 20 30 30 20 10 00

; [ update world map zoomed bg palettes ]

; this is what causes the ocean to be a solid color when in an airship

; A: zoom level

15/C505: 29 FE        AND #$FE
15/C507: AA           TAX 
15/C508: AD 00 17     LDA $1700
15/C50B: D0 16        BNE $C523
; overworld
15/C50D: C2 20        REP #$20
15/C50F: BF B1 C6 15  LDA $15C6B1,X
15/C513: 8D 25 0D     STA $0D25       ; bg palette 2, color 5 (light ocean)
15/C516: BF C3 C6 15  LDA $15C6C3,X
15/C51A: 8D 29 0D     STA $0D29       ; bg palette 2, color 7 (dark ocean)
15/C51D: A9 00 00     LDA #$0000
15/C520: E2 20        SEP #$20
15/C522: 6B           RTL 
; underground
15/C523: C9 01        CMP #$01
15/C525: D0 40        BNE $C567
15/C527: C2 20        REP #$20
15/C529: BF 21 C6 15  LDA $15C621,X
15/C52D: 8D F3 0C     STA $0CF3       ; bg palette 0, color 12
15/C530: BF 33 C6 15  LDA $15C633,X
15/C534: 8D F5 0C     STA $0CF5       ; bg palette 0, color 13
15/C537: BF 45 C6 15  LDA $15C645,X
15/C53B: 8D 1D 0D     STA $0D1D       ; bg palette 2, color 1
15/C53E: BF 57 C6 15  LDA $15C657,X
15/C542: 8D 1F 0D     STA $0D1F       ; bg palette 2, color 2
15/C545: BF 69 C6 15  LDA $15C669,X
15/C549: 8D 21 0D     STA $0D21       ; bg palette 2, color 3
15/C54C: BF 7B C6 15  LDA $15C67B,X
15/C550: 8D DF 0C     STA $0CDF       ; bg palette 0, color 2
15/C553: BF 8D C6 15  LDA $15C68D,X
15/C557: 8D E5 0C     STA $0CE5       ; bg palette 0, color 5
15/C55A: BF 9F C6 15  LDA $15C69F,X
15/C55E: 8D DD 0C     STA $0CDD       ; bg palette 0, color 1
15/C561: A9 00 00     LDA #$0000
15/C564: E2 20        SEP #$20
15/C566: 6B           RTL 
; moon
15/C567: C2 20        REP #$20
15/C569: BF A3 C5 15  LDA $15C5A3,X
15/C56D: 8D DD 0C     STA $0CDD
15/C570: BF B5 C5 15  LDA $15C5B5,X
15/C574: 8D E5 0C     STA $0CE5
15/C577: BF C7 C5 15  LDA $15C5C7,X
15/C57B: 8D F3 0C     STA $0CF3
15/C57E: 8D 13 0D     STA $0D13
15/C581: BF D9 C5 15  LDA $15C5D9,X
15/C585: 8D DF 0C     STA $0CDF
15/C588: BF EB C5 15  LDA $15C5EB,X
15/C58C: 8D 0B 0D     STA $0D0B
15/C58F: BF FD C5 15  LDA $15C5FD,X
15/C593: 8D 0D 0D     STA $0D0D
15/C596: BF 0F C6 15  LDA $15C60F,X
15/C59A: 8D 11 0D     STA $0D11
15/C59D: A9 00 00     LDA #$0000
15/C5A0: E2 20        SEP #$20
15/C5A2: 6B           RTL 

; world map zoomed bg palettes (17 * 2 bytes each)

;     $00: on foot
; $01-$0F: transitioning up or down
;     $10: in airship

; moon
15/C5A3: 3DEE 3DEE 3DED 39CD 39CC 39CC 35AB 35AB 35AB
15/C5B5: 56D4 52B2 4A71 464F 420E 3DED 39CC 35AB 35AB
15/C5C7: 35EF 35EF 31EF 31CE 2DCE 2DCE 29AD 29AD 29AD
15/C5D9: 35AB 35AB 318B 318A 2D6A 2D6A 2949 2949 2949
15/C5EB: 333C 333C 331B 2F1A 2EFA 2EF9 2AD9 2AD8 2AD8
15/C5FD: 2AD8 2AB7 2675 2654 2232 2211 1DD0 1DAF 1DAF
15/C60F: 4F9E 4B7C 473A 4319 36D7 3296 2E55 2A33 2A33
; underground
15/C621: 24A6 20A6 1CA6 1886 1487 0C87 0867 0067 0067
15/C633: 0067 0067 0047 0046 0026 0026 0005 0005 0005
15/C645: 25D0 25CF 21AF 1D8E 1D8E 196C 156C 114D 114D
15/C657: 21AF 1DAF 1D8F 198E 196E 156E 154D 114D 114D
15/C669: 196E 196E 196E 156E 154D 154D 114D 114D 114D
15/C67B: 155B 115A 1159 0D58 0937 0936 0535 0135 0135
15/C68D: 15DD 11BA 11B9 0D98 0977 0976 0555 0135 0135
15/C69F: 37DF 2F7D 2B1C 22BA 1A59 11F7 0976 0135 0135
; overworld
15/C6B1: 6520 5D20 5900 5500 50E0 4CE0 48C0 44C0 3CA0  ; light ocean
15/C6C3: 2460 2860 2C60 3080 3480 3880 3CA0 3CA0 3CA0  ; dark ocean

; [ invert map palette ]

15/C6D5: C2 20        REP #$20
15/C6D7: A2 00 00     LDX #$0000
15/C6DA: BD DB 0C     LDA $0CDB,X
15/C6DD: 49 FF 7F     EOR #$7FFF
15/C6E0: 29 DE 7B     AND #$7BDE
15/C6E3: 4A           LSR 
15/C6E4: 9D DB 0B     STA $0BDB,X
15/C6E7: E8           INX 
15/C6E8: E8           INX 
15/C6E9: E0 00 01     CPX #$0100
15/C6EC: D0 EC        BNE $C6DA
15/C6EE: A9 00 00     LDA #$0000
15/C6F1: E2 20        SEP #$20
15/C6F3: 6B           RTL 

; [ modify overworld tilemap ]

; modifies tiles in a row based on event switches

15/C6F4: A5 93        LDA $93
15/C6F6: 29 3F        AND #$3F
15/C6F8: 85 3E        STA $3E
15/C6FA: 64 3D        STZ $3D
15/C6FC: A6 3D        LDX $3D
15/C6FE: AD 82 12     LDA $1282       ; check event switch $0C
15/C701: 29 10        AND #$10
15/C703: F0 22        BEQ $C727
15/C705: A5 93        LDA $93
15/C707: C9 39        CMP #$39        ; destroyed damcyan (118,57)
15/C709: D0 0C        BNE $C717
15/C70B: A9 2D        LDA #$2D
15/C70D: 9F E7 5C 7F  STA $7F5CE7,X
15/C711: 1A           INC 
15/C712: 9F E8 5C 7F  STA $7F5CE8,X
15/C716: 6B           RTL 
15/C717: C9 3A        CMP #$3A
15/C719: D0 0C        BNE $C727
15/C71B: A9 3D        LDA #$3D
15/C71D: 9F E7 5C 7F  STA $7F5CE7,X
15/C721: 1A           INC 
15/C722: 9F E8 5C 7F  STA $7F5CE8,X
15/C726: 6B           RTL 
15/C727: AD 81 12     LDA $1281       ; check event switch $0E
15/C72A: 29 40        AND #$40
15/C72C: F0 57        BEQ $C785
15/C72E: A5 93        LDA $93
15/C730: C9 76        CMP #$76        ; mist mountains (97,118)
15/C732: D0 17        BNE $C74B
15/C734: A9 13        LDA #$13
15/C736: 9F D2 5C 7F  STA $7F5CD2,X
15/C73A: 9F D3 5C 7F  STA $7F5CD3,X
15/C73E: 9F D4 5C 7F  STA $7F5CD4,X
15/C742: 9F D5 5C 7F  STA $7F5CD5,X
15/C746: 9F D6 5C 7F  STA $7F5CD6,X
15/C74A: 6B           RTL 
15/C74B: C9 77        CMP #$77
15/C74D: D0 1B        BNE $C76A
15/C74F: A9 12        LDA #$12
15/C751: 9F D2 5C 7F  STA $7F5CD2,X
15/C755: A9 13        LDA #$13
15/C757: 9F D3 5C 7F  STA $7F5CD3,X
15/C75B: 9F D4 5C 7F  STA $7F5CD4,X
15/C75F: 9F D5 5C 7F  STA $7F5CD5,X
15/C763: A9 14        LDA #$14
15/C765: 9F D6 5C 7F  STA $7F5CD6,X
15/C769: 6B           RTL 
15/C76A: C9 78        CMP #$78
15/C76C: D0 17        BNE $C785
15/C76E: A9 13        LDA #$13
15/C770: 9F D2 5C 7F  STA $7F5CD2,X
15/C774: 9F D3 5C 7F  STA $7F5CD3,X
15/C778: 9F D4 5C 7F  STA $7F5CD4,X
15/C77C: 9F D5 5C 7F  STA $7F5CD5,X
15/C780: 9F D6 5C 7F  STA $7F5CD6,X
15/C784: 6B           RTL 
15/C785: AD 86 12     LDA $1286       ; check event switch $30
15/C788: 29 01        AND #$01
15/C78A: D0 58        BNE $C7E4
15/C78C: A5 93        LDA $93
15/C78E: C9 D2        CMP #$D2        ; agart hole to underground (106,210)
15/C790: D0 07        BNE $C799
15/C792: A9 13        LDA #$13
15/C794: 9F DB 5C 7F  STA $7F5CDB,X
15/C798: 6B           RTL 
15/C799: C9 D3        CMP #$D3
15/C79B: D0 0F        BNE $C7AC
15/C79D: A9 13        LDA #$13
15/C79F: 9F DA 5C 7F  STA $7F5CDA,X
15/C7A3: 9F DB 5C 7F  STA $7F5CDB,X
15/C7A7: 9F DC 5C 7F  STA $7F5CDC,X
15/C7AB: 6B           RTL 
15/C7AC: C9 D4        CMP #$D4
15/C7AE: D0 17        BNE $C7C7
15/C7B0: A9 13        LDA #$13
15/C7B2: 9F D9 5C 7F  STA $7F5CD9,X
15/C7B6: 9F DA 5C 7F  STA $7F5CDA,X
15/C7BA: 9F DB 5C 7F  STA $7F5CDB,X
15/C7BE: 9F DC 5C 7F  STA $7F5CDC,X
15/C7C2: 9F DD 5C 7F  STA $7F5CDD,X
15/C7C6: 6B           RTL 
15/C7C7: C9 D5        CMP #$D5
15/C7C9: D0 0F        BNE $C7DA
15/C7CB: A9 13        LDA #$13
15/C7CD: 9F DA 5C 7F  STA $7F5CDA,X
15/C7D1: 9F DB 5C 7F  STA $7F5CDB,X
15/C7D5: 9F DC 5C 7F  STA $7F5CDC,X
15/C7D9: 6B           RTL 
15/C7DA: C9 D6        CMP #$D6
15/C7DC: D0 06        BNE $C7E4
15/C7DE: A9 13        LDA #$13
15/C7E0: 9F DB 5C 7F  STA $7F5CDB,X
15/C7E4: 6B           RTL 

; [ transfer chest/door tilemap to vram ]

15/C7E5: A5 D4        LDA $D4
15/C7E7: D0 01        BNE $C7EA
15/C7E9: 6B           RTL 
15/C7EA: 64 D4        STZ $D4
15/C7EC: A9 80        LDA #$80
15/C7EE: 8D 15 21     STA $2115
15/C7F1: AE FE 06     LDX $06FE
15/C7F4: 8E 16 21     STX $2116
15/C7F7: AE 00 07     LDX $0700
15/C7FA: 8E 18 21     STX $2118
15/C7FD: AE 02 07     LDX $0702
15/C800: 8E 18 21     STX $2118
15/C803: AD FE 06     LDA $06FE
15/C806: 18           CLC 
15/C807: 69 20        ADC #$20
15/C809: 8D FE 06     STA $06FE
15/C80C: AD FF 06     LDA $06FF
15/C80F: 69 00        ADC #$00
15/C811: 8D FF 06     STA $06FF
15/C814: AE FE 06     LDX $06FE
15/C817: 8E 16 21     STX $2116
15/C81A: AE 04 07     LDX $0704
15/C81D: 8E 18 21     STX $2118
15/C820: AE 06 07     LDX $0706
15/C823: 8E 18 21     STX $2118
15/C826: 6B           RTL 

; [ load player sprite palettes ]

15/C827: A0 00 00     LDY #$0000
15/C82A: A2 00 00     LDX #$0000
15/C82D: BF 00 80 0D  LDA $0D8000,X
15/C831: 99 DB 0D     STA $0DDB,Y
15/C834: E8           INX 
15/C835: C8           INY 
15/C836: 98           TYA 
15/C837: 29 0F        AND #$0F
15/C839: D0 F2        BNE $C82D
15/C83B: A9 00        LDA #$00
15/C83D: 99 DB 0D     STA $0DDB,Y
15/C840: C8           INY 
15/C841: 98           TYA 
15/C842: 29 0F        AND #$0F
15/C844: D0 F5        BNE $C83B
15/C846: C0 80 00     CPY #$0080
15/C849: D0 E2        BNE $C82D
15/C84B: 6B           RTL 

; [ update showing character ]

15/C84C: AD 04 17     LDA $1704
15/C84F: D0 0A        BNE $C85B       ; return if in a vehicle
15/C851: A5 02        LDA $02
15/C853: 29 10        AND #$10
15/C855: F0 04        BEQ $C85B       ; branch if top r button is not pressed
15/C857: A5 53        LDA $53
15/C859: F0 01        BEQ $C85C
15/C85B: 6B           RTL 
15/C85C: E6 53        INC $53         ; reset top r button
; fallthrough

; [ validate showing character ]

15/C85E: EE 03 17     INC $1703
15/C861: AD 03 17     LDA $1703
15/C864: C9 05        CMP #$05
15/C866: D0 05        BNE $C86D
15/C868: A9 00        LDA #$00
15/C86A: 8D 03 17     STA $1703
15/C86D: 22 7B C8 15  JSL $15C87B     ; get showing character properties pointer
15/C871: BD 00 10     LDA $1000,X
15/C874: F0 E8        BEQ $C85E
15/C876: A9 01        LDA #$01
15/C878: 85 CC        STA $CC
15/C87A: 6B           RTL 

; [ get showing character properties pointer ]

15/C87B: AD 03 17     LDA $1703
15/C87E: 64 4A        STZ $4A
15/C880: 4A           LSR 
15/C881: 66 4A        ROR $4A
15/C883: 4A           LSR 
15/C884: 66 4A        ROR $4A
15/C886: 85 4B        STA $4B
15/C888: A6 4A        LDX $4A
15/C88A: 6B           RTL 

; [ load player sprite graphics ]

15/C88B: A5 CC        LDA $CC
15/C88D: D0 01        BNE $C890
15/C88F: 6B           RTL 
15/C890: 64 CC        STZ $CC
15/C892: 22 7B C8 15  JSL $15C87B     ; get showing character properties pointer
15/C896: BD 03 10     LDA $1003,X
15/C899: 29 20        AND #$20
15/C89B: F0 05        BEQ $C8A2
15/C89D: A9 0F        LDA #$0F
15/C89F: 4C BF C8     JMP $C8BF
15/C8A2: BD 03 10     LDA $1003,X
15/C8A5: 29 10        AND #$10
15/C8A7: F0 05        BEQ $C8AE
15/C8A9: A9 0E        LDA #$0E
15/C8AB: 4C BF C8     JMP $C8BF
15/C8AE: BD 03 10     LDA $1003,X
15/C8B1: 29 08        AND #$08
15/C8B3: F0 05        BEQ $C8BA
15/C8B5: A9 10        LDA #$10
15/C8B7: 4C BF C8     JMP $C8BF
15/C8BA: BD 01 10     LDA $1001,X
15/C8BD: 29 1F        AND #$1F
15/C8BF: 85 06        STA $06
15/C8C1: 0A           ASL 
15/C8C2: 18           CLC 
15/C8C3: 65 06        ADC $06
15/C8C5: 18           CLC 
15/C8C6: 69 80        ADC #$80
15/C8C8: 85 4B        STA $4B
15/C8CA: 64 4A        STZ $4A
15/C8CC: A2 00 40     LDX #$4000
15/C8CF: 86 4C        STX $4C
15/C8D1: A2 00 02     LDX #$0200
15/C8D4: 86 4E        STX $4E
15/C8D6: A9 1B        LDA #$1B
15/C8D8: 85 49        STA $49
15/C8DA: 22 00 B0 15  JSL $15B000     ; transfer 3bpp graphics to vram
15/C8DE: 6B           RTL 

; --------------------------------------------------------------------------

; [ init hardware registers ]

15/C8DF: A9 80        LDA #$80
15/C8E1: 8D 00 21     STA $2100       ; screen off
15/C8E4: A9 00        LDA #$00
15/C8E6: 8D 00 42     STA $4200       ; disable nmi and irq
15/C8E9: A9 02        LDA #$02
15/C8EB: 8D 01 21     STA $2101
15/C8EE: 9C 02 21     STZ $2102
15/C8F1: 9C 03 21     STZ $2103
15/C8F4: 9C 06 21     STZ $2106
15/C8F7: A9 19        LDA #$19
15/C8F9: 8D 07 21     STA $2107
15/C8FC: A9 33        LDA #$33
15/C8FE: 8D 08 21     STA $2108
15/C901: A9 29        LDA #$29
15/C903: 8D 09 21     STA $2109
15/C906: A9 00        LDA #$00
15/C908: 8D 0B 21     STA $210B
15/C90B: A9 02        LDA #$02
15/C90D: 8D 0C 21     STA $210C
15/C910: 9C 11 21     STZ $2111
15/C913: 9C 11 21     STZ $2111
15/C916: 9C 12 21     STZ $2112
15/C919: 9C 12 21     STZ $2112
15/C91C: A9 80        LDA #$80
15/C91E: 8D 15 21     STA $2115
15/C921: 9C 1A 21     STZ $211A
15/C924: 9C 1B 21     STZ $211B
15/C927: A9 04        LDA #$04
15/C929: 8D 1B 21     STA $211B
15/C92C: 9C 1C 21     STZ $211C
15/C92F: 9C 1C 21     STZ $211C
15/C932: 9C 1D 21     STZ $211D
15/C935: 9C 1D 21     STZ $211D
15/C938: 9C 1E 21     STZ $211E
15/C93B: A9 04        LDA #$04
15/C93D: 8D 1E 21     STA $211E
15/C940: A9 80        LDA #$80
15/C942: 8D 1F 21     STA $211F
15/C945: 8D 1F 21     STA $211F
15/C948: 8D 20 21     STA $2120
15/C94B: 8D 20 21     STA $2120
15/C94E: 8D 21 21     STA $2121
15/C951: A9 33        LDA #$33
15/C953: 8D 23 21     STA $2123
15/C956: A9 00        LDA #$00
15/C958: 8D 24 21     STA $2124
15/C95B: A9 F3        LDA #$F3
15/C95D: 8D 25 21     STA $2125
15/C960: A9 01        LDA #$01
15/C962: 8D 26 21     STA $2126
15/C965: A9 FE        LDA #$FE
15/C967: 8D 27 21     STA $2127
15/C96A: 9C 28 21     STZ $2128
15/C96D: A9 FF        LDA #$FF
15/C96F: 8D 29 21     STA $2129
15/C972: 9C 2A 21     STZ $212A
15/C975: 9C 2B 21     STZ $212B
15/C978: A9 17        LDA #$17
15/C97A: 8D 2C 21     STA $212C
15/C97D: A9 11        LDA #$11
15/C97F: 8D 2D 21     STA $212D
15/C982: A9 17        LDA #$17
15/C984: 8D 2E 21     STA $212E
15/C987: 9C 2F 21     STZ $212F
15/C98A: A9 E0        LDA #$E0
15/C98C: 8D 32 21     STA $2132
15/C98F: 9C 33 21     STZ $2133
15/C992: A9 FF        LDA #$FF
15/C994: 8D 01 42     STA $4201
15/C997: 9C 07 42     STZ $4207
15/C99A: 9C 08 42     STZ $4208
15/C99D: 9C 09 42     STZ $4209
15/C9A0: 9C 0A 42     STZ $420A
15/C9A3: 9C 0B 42     STZ $420B
15/C9A6: 9C 0C 42     STZ $420C
15/C9A9: 6B           RTL 

; [ clear ram ]

15/C9AA: A2 00 00     LDX #$0000
15/C9AD: BD 00 19     LDA $1900,X
15/C9B0: DF 00 EE 14  CMP $14EE00,X   ; rng table
15/C9B4: D0 09        BNE $C9BF
15/C9B6: E8           INX 
15/C9B7: E0 00 01     CPX #$0100
15/C9BA: F0 0F        BEQ $C9CB
15/C9BC: 4C AD C9     JMP $C9AD
; rng table not loaded (hard reset)
15/C9BF: A2 00 1A     LDX #$1A00
15/C9C2: 9E 00 00     STZ $0000,X     ; clear menu ram ($1A00-$1A64)
15/C9C5: E8           INX 
15/C9C6: E0 65 1A     CPX #$1A65
15/C9C9: D0 F7        BNE $C9C2
15/C9CB: A2 00 00     LDX #$0000
15/C9CE: 9E 00 00     STZ $0000,X     ; clear battle and menu dp ($0000-$01FF)
15/C9D1: E8           INX 
15/C9D2: E0 00 02     CPX #$0200
15/C9D5: D0 F7        BNE $C9CE
15/C9D7: A2 00 03     LDX #$0300
15/C9DA: 9E 00 00     STZ $0000,X     ; clear ram ($0300-$19FF)
15/C9DD: E8           INX 
15/C9DE: E0 FF 0F     CPX #$0FFF      ; skip frame counter ($0FFF)
15/C9E1: D0 F7        BNE $C9DA
15/C9E3: E8           INX 
15/C9E4: 9E 00 00     STZ $0000,X
15/C9E7: E8           INX 
15/C9E8: E0 00 1A     CPX #$1A00
15/C9EB: D0 F7        BNE $C9E4
15/C9ED: A2 65 1A     LDX #$1A65
15/C9F0: 9E 00 00     STZ $0000,X     ; clear more ram ($1A65-$1DFF)
15/C9F3: E8           INX 
15/C9F4: E0 00 1E     CPX #$1E00
15/C9F7: D0 F7        BNE $C9F0
15/C9F9: A2 00 20     LDX #$2000
15/C9FC: A9 00        LDA #$00
15/C9FE: 9F 00 00 7E  STA $7E0000,X   ; clear work ram ($7E2000-$7FFFFF)
15/CA02: E8           INX 
15/CA03: D0 F9        BNE $C9FE
15/CA05: 9F 00 00 7F  STA $7F0000,X
15/CA09: E8           INX 
15/CA0A: D0 F9        BNE $CA05
15/CA0C: A2 00 00     LDX #$0000
15/CA0F: BF 00 EE 14  LDA $14EE00,X   ; copy rng table to buffer
15/CA13: 9D 00 19     STA $1900,X
15/CA16: E8           INX 
15/CA17: E0 00 01     CPX #$0100
15/CA1A: D0 F3        BNE $CA0F
15/CA1C: 6B           RTL 

; [ reset controller inputs ]

; clears flags that ensure that each input is only processed once

15/CA1D: A5 02        LDA $02         ; A button
15/CA1F: 29 80        AND #$80
15/CA21: D0 02        BNE $CA25
15/CA23: 64 54        STZ $54
15/CA25: A5 02        LDA $02         ; X button
15/CA27: 29 40        AND #$40
15/CA29: D0 02        BNE $CA2D
15/CA2B: 64 50        STZ $50
15/CA2D: A5 02        LDA $02         ; top left button
15/CA2F: 29 20        AND #$20
15/CA31: D0 02        BNE $CA35
15/CA33: 64 52        STZ $52
15/CA35: A5 02        LDA $02         ; top right button
15/CA37: 29 10        AND #$10
15/CA39: D0 02        BNE $CA3D
15/CA3B: 64 53        STZ $53
15/CA3D: A5 03        LDA $03         ; B button
15/CA3F: 29 80        AND #$80
15/CA41: D0 02        BNE $CA45
15/CA43: 64 55        STZ $55
15/CA45: A5 03        LDA $03         ; Y button
15/CA47: 29 40        AND #$40
15/CA49: D0 02        BNE $CA4D
15/CA4B: 64 51        STZ $51
15/CA4D: A5 03        LDA $03         ; select button
15/CA4F: 29 20        AND #$20
15/CA51: D0 02        BNE $CA55
15/CA53: 64 56        STZ $56
15/CA55: A5 03        LDA $03         ; start button
15/CA57: 29 10        AND #$10
15/CA59: D0 02        BNE $CA5D
15/CA5B: 64 57        STZ $57
15/CA5D: 6B           RTL 

; [ transfer palettes to ppu ]

15/CA5E: 9C 0B 42     STZ $420B
15/CA61: 9C 21 21     STZ $2121
15/CA64: A9 02        LDA #$02
15/CA66: 8D 00 43     STA $4300
15/CA69: A9 22        LDA #$22
15/CA6B: 8D 01 43     STA $4301
15/CA6E: A9 00        LDA #$00
15/CA70: 8D 04 43     STA $4304
15/CA73: A2 DB 0C     LDX #$0CDB
15/CA76: 8E 02 43     STX $4302
15/CA79: A2 00 02     LDX #$0200
15/CA7C: 8E 05 43     STX $4305
15/CA7F: A9 01        LDA #$01
15/CA81: 8D 0B 42     STA $420B
15/CA84: 6B           RTL 

; [ transfer data to vram ]

15/CA85: A9 80        LDA #$80
15/CA87: 8D 15 21     STA $2115
15/CA8A: 9C 0B 42     STZ $420B
15/CA8D: A9 01        LDA #$01
15/CA8F: 8D 00 43     STA $4300
15/CA92: A9 18        LDA #$18
15/CA94: 8D 01 43     STA $4301
15/CA97: A5 3C        LDA $3C
15/CA99: 8D 04 43     STA $4304
15/CA9C: A6 47        LDX $47
15/CA9E: 8E 16 21     STX $2116
15/CAA1: A6 3D        LDX $3D
15/CAA3: 8E 02 43     STX $4302
15/CAA6: A6 45        LDX $45
15/CAA8: 8E 05 43     STX $4305
15/CAAB: A9 01        LDA #$01
15/CAAD: 8D 0B 42     STA $420B
15/CAB0: 6B           RTL 

; [ clear vram ]

15/CAB1: A9 80        LDA #$80
15/CAB3: 8D 15 21     STA $2115
15/CAB6: 9C 0B 42     STZ $420B
15/CAB9: A9 09        LDA #$09
15/CABB: 8D 00 43     STA $4300
15/CABE: A9 18        LDA #$18
15/CAC0: 8D 01 43     STA $4301
15/CAC3: A6 47        LDX $47
15/CAC5: 8E 16 21     STX $2116
15/CAC8: A2 76 06     LDX #$0676
15/CACB: 8E 02 43     STX $4302
15/CACE: 9C 04 43     STZ $4304
15/CAD1: A6 45        LDX $45
15/CAD3: 8E 05 43     STX $4305
15/CAD6: A9 01        LDA #$01
15/CAD8: 8D 0B 42     STA $420B
15/CADB: 6B           RTL 

; [ transfer sprite data to ppu ]

15/CADC: 9C 02 21     STZ $2102
15/CADF: 9C 0B 42     STZ $420B
15/CAE2: 9C 00 43     STZ $4300
15/CAE5: A9 04        LDA #$04
15/CAE7: 8D 01 43     STA $4301
15/CAEA: A2 00 03     LDX #$0300
15/CAED: 8E 02 43     STX $4302
15/CAF0: A9 00        LDA #$00
15/CAF2: 8D 04 43     STA $4304
15/CAF5: A2 20 02     LDX #$0220
15/CAF8: 8E 05 43     STX $4305
15/CAFB: A9 01        LDA #$01
15/CAFD: 8D 0B 42     STA $420B
15/CB00: 6B           RTL 

; [ load bg animation graphics ]

15/CB01: AD DD 0F     LDA $0FDD
15/CB04: AA           TAX 
15/CB05: BF 4F CB 15  LDA $15CB4F,X
15/CB09: 85 3E        STA $3E
15/CB0B: 64 3D        STZ $3D
15/CB0D: 46 3E        LSR $3E
15/CB0F: 66 3D        ROR $3D
15/CB11: A5 3E        LDA $3E
15/CB13: 18           CLC 
15/CB14: 7F 4F CB 15  ADC $15CB4F,X
15/CB18: 85 3E        STA $3E
15/CB1A: A6 3D        LDX $3D
15/CB1C: A0 00 00     LDY #$0000
15/CB1F: A9 7F        LDA #$7F
15/CB21: 48           PHA 
15/CB22: AB           PLB 
15/CB23: BF C0 B9 1F  LDA $1FB9C0,X
15/CB27: 99 00 50     STA $5000,Y
15/CB2A: E8           INX 
15/CB2B: C8           INY 
15/CB2C: 98           TYA 
15/CB2D: 29 0F        AND #$0F
15/CB2F: D0 F2        BNE $CB23
15/CB31: BF C0 B9 1F  LDA $1FB9C0,X
15/CB35: 99 00 50     STA $5000,Y
15/CB38: E8           INX 
15/CB39: C8           INY 
15/CB3A: A9 00        LDA #$00
15/CB3C: 99 00 50     STA $5000,Y
15/CB3F: C8           INY 
15/CB40: 98           TYA 
15/CB41: 29 0F        AND #$0F
15/CB43: D0 EC        BNE $CB31
15/CB45: C0 00 08     CPY #$0800
15/CB48: D0 D9        BNE $CB23
15/CB4A: A9 00        LDA #$00
15/CB4C: 48           PHA 
15/CB4D: AB           PLB 
15/CB4E: 6B           RTL 

; bg animation graphics for each map tileset
15/CB4F: 00 00 00 02 03 06 07 0A 0A 0A 0A 0A 0D 0D 0D 10

; [ transfer bg animation graphics to vram ]

15/CB5F: AD 00 17     LDA $1700
15/CB62: C9 03        CMP #$03
15/CB64: D0 06        BNE $CB6C
15/CB66: A5 7A        LDA $7A
15/CB68: 29 06        AND #$06
15/CB6A: F0 01        BEQ $CB6D
15/CB6C: 6B           RTL 
15/CB6D: A5 7A        LDA $7A
15/CB6F: 29 18        AND #$18
15/CB71: 85 12        STA $12
15/CB73: 64 13        STZ $13
15/CB75: C2 20        REP #$20
15/CB77: 06 12        ASL $12
15/CB79: 06 12        ASL $12
15/CB7B: 06 12        ASL $12
15/CB7D: 06 12        ASL $12
15/CB7F: A5 12        LDA $12
15/CB81: 18           CLC 
15/CB82: 69 00 50     ADC #$5000
15/CB85: 85 12        STA $12
15/CB87: A9 00 00     LDA #$0000
15/CB8A: E2 20        SEP #$20
15/CB8C: A9 80        LDA #$80
15/CB8E: 8D 15 21     STA $2115
15/CB91: 9C 0B 42     STZ $420B
15/CB94: A9 01        LDA #$01
15/CB96: 8D 00 43     STA $4300
15/CB99: A9 18        LDA #$18
15/CB9B: 8D 01 43     STA $4301
15/CB9E: A2 00 12     LDX #$1200
15/CBA1: 8E 16 21     STX $2116
15/CBA4: A9 7F        LDA #$7F
15/CBA6: 8D 04 43     STA $4304
15/CBA9: A2 00 12     LDX #$1200
15/CBAC: 8E 16 21     STX $2116
15/CBAF: A0 04 00     LDY #$0004
15/CBB2: A6 12        LDX $12
15/CBB4: 8E 02 43     STX $4302
15/CBB7: A2 80 00     LDX #$0080
15/CBBA: 8E 05 43     STX $4305
15/CBBD: A9 01        LDA #$01
15/CBBF: 8D 0B 42     STA $420B
15/CBC2: A5 13        LDA $13
15/CBC4: 18           CLC 
15/CBC5: 69 02        ADC #$02
15/CBC7: 85 13        STA $13
15/CBC9: 88           DEY 
15/CBCA: D0 E6        BNE $CBB2
15/CBCC: 6B           RTL 

; --------------------------------------------------------------------------

; dakuten table (battle)
; 2 bytes each, dakuten then kana
16/FA40:                                           C0 CC
16/FA42: C0 8F C0 90 C0 91 C0 92 C0 93 C0 94 C0 95 C0 96  ; $10
16/FA52: C0 97 C0 98 C0 99 C0 9A C0 9B C0 9C C0 9D C0 A3
16/FA62: C0 A4 C0 A5 C0 A6 C0 A7 C1 A3 C1 A4 C1 A5 C1 A6  ; $20
16/FA72: C1 A7 C0 CF C0 D0 C0 D1 C0 D2 C0 D3 C0 D4 C0 D5
16/FA82: C0 D6 C0 D7 C0 D8 C0 D9 C0 DA C0 DB C0 DC C0 DD  ; $30
16/FA92: C0 E3 C0 E4 C0 E5 C0 E6 C0 E7 C1 E3 C1 E4 C1 E5
16/FAA2: C1 E6 C1 E7                                      ; $40

16/FAA6: 00 09 12 1B 24 2D 36 3F 48

16/FAAF: 00 01 01 01 01 02 02 02 02
16/FAB8: 00 00 00 00 01 01 01 01 02
16/FAC1: 00 00 00 00 01 02 02 02 02
16/FACA: 01 02 02 02 02 00 00 00 00
16/FAD3: 01 01 01 01 02 02 02 02 00
16/FADC: 01 01 01 01 02 00 00 00 00
16/FAE5: 02 00 00 00 00 01 01 01 01
16/FAEE: 02 02 02 02 00 00 00 00 01
16/FAF7: 02 02 02 02 00 01 01 01 01

16/FB00: 00 12 24 00 12 24 00 12 24

16/FB09: 08 08 F0 00 F0 00 00 00 00 00 E0 F0 10 E0 F0 F0 F0 F0
16/FB1B: 00 00 00 00 E0 10 10 00 F0 F0 F0 F0 00 F0 00 F0 E8 E8
16/FB2D: 00 00 00 00 E0 10 10 00 F8 F8 E0 F0 10 E0 F0 F0 F0 F0

; name for each character (see 01/8457 for menu)
16/FB3F: 00 01 02 03 04 05 06 07 08 03 00 03 06 09 01 05
16/FB4F: 02 0A 0B 01 0C 0D 0E 0F

; weapon frame data tile offset
16/FB57: 98 98 98 A6 B0 BA C4 D0 64 68 6C 70 74 78 7C 80
16/FB67: 84 88 8C 90 94 0C 00 04 08 0C 10 14 18 1C 20 24
16/FB77: 28 2C 30 34 38 3C 40 44 48 4C 50 54 58 5C 60 64

; menu tiles used in bg2 battle menu

;       $DB: little "m"
;       $DC: little "p"
;       $DD: 
;   $DE-$E1:  (consumed)
;       $E2: 
;       $E3: 
;   $E4-$E7:  (change row)
;       $E8: (dakuten)
;   $E9-$EC:  (defend)
;       $ED: 
;       $EE: 
;       $EF: 
;       $F0: 
;       $F1: 
;       $F2: 
;       $F3: 
;       $F4: 
;       $F5: 
;       $F6: 
;       $F7: top-left border
;       $F8: top-center border
;       $F9: top-right border
;       $FA: mid-left border
;       $FB: mid-right border
;       $FC: bottom-left border
;       $FD: bottom-center border
;       $FE: bottom-right border
;       $FF: blank

16/FB87:                                  76 78 C7 95 7F  ; $D0
16/FB9C: 8C A4 4E 51 DA BA F6 D5 C0 A7 8C 90 7F 80 81 82  ; $E0
16/FBAC: 83 84 85 86 87 88 89 16 17 18 FA FB FC FD FE FF  ; $F0

; number of tiles for boss graphics
16/FBAC: 00FF 0000 0000 0000
16/FBB4: 00FF 00FF 0000 0000
16/FBBC: 007F 007F 007F 007F
16/FBC4: 00FF 007F 007F 0000
16/FBCC: 007F 007F 00FF 0000
16/FBD4: 007F 00FF 007F 0000

; monster graphics vram locations for each mold
16/FBDC: 2000 0000 0000 0000
16/FBE4: 2000 3000 0000 0000
16/FBEC: 2000 2800 3000 3800
16/FBF4: 2000 3000 3800 0000
16/FBFC: 2000 2800 3000 0000
16/FC04: 2000 2800 3800 0000

; monster palette, msb for tilemap
16/FC0C: 2C 20 20 20
16/FC10: 2C 31 20 20
16/FC14: 2C 30 35 39
16/FC18: 2C 31 35 20
16/FC1C: 2C 30 35 20
16/FC20: 2C 30 35 20

; monster lo byte of tilemap
16/FC24: 00 00 00 00
16/FC28: 00 00 00 00
16/FC2C: 00 80 00 80
16/FC30: 00 00 80 00
16/FC34: 00 80 00 00
16/FC38: 00 80 80 00

16/FC3C: EC 90 4F B1
16/FC40: EC 98 4E B1
16/FC44: EC CC 4E 31
16/FC48: EC D4 4F 31

16/FC4C: 00 01 02 03 04

; spell list cursor y positions
16/FC51: 98 A4 B0 BC C8
; spell list cursor x positions
16/FC56: 04 3C 74

; inventory cursor x positions
16/FC59: 0C 7C
; inventory cursor y positions
16/FC5B: 9C A8 B4 C0 CC 

16/FC60: 02 02 0A 0A 0A 0B 02 02 02 02 02 0B 02 0B 02 02
16/FC70: 00 02 02 02 0B 02 02 02 0A 0B 08 02 01 02 

; bit masks
16/FC7E: 80 40 20 10 08 04 02 01

; pointers to golbez/anna graphics
16/FC86: 7600 7960

; damage numeral y-offsets (for bouncing)
16/FC8A: 00 00 00 00 00 FD FA F7 F4 F2 F1 F1 F0 F0 F0 F1
16/FC9A: F1 F2 F4 F7 FA FD 00 FE FC FC FB FB FB FC FC FE
16/FCAA: FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
16/FCBA: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
16/FCCA: 00

16/FCCB: 80 82 84 86 88 8A 8C 8E A0 A2 A4 A6 A8 AA AC AE
16/FCDB: C0 C2 C4 C6 C8 CA CC CE E0 E2 E4 E6 E8 EA EC EE

16/FCEB: 11 03 0F

16/FCEE: 10 10 10 18 18
16/FCF3: 18 18 18 10 10
16/FCF8: 10 10 10 08 08
16/FCFD: 08 08 08 10 10

16/FD02: 00 08 00 10

16/FD06: 0000 0040 0080 00C0 0100

16/FD10: 6A 7A 5A 72 62
16/FD15: 68 78 58 70 60
16/FD1A: 4C 24 74 38 60
16/FD1F: D0 D0 D0 E0 E0
16/FD24: E0 E0 E0 D0 D0

16/FD29: FF FF FF 00
16/FD2D: FF FF 00 00
16/FD31: FF 00 00 00
16/FD35: 00 00 00 00

16/FD39: 01 FF 01 FF
16/FD3D: 01 FF 01 FF
16/FD41: 01 FF 01 FF
16/FD45: 01 FF 01 FF

;  (all)
;  (miss)
16/FD49: 18 B6 21 00
16/FD4C: E9 D6 00

16/FD50: 80 00 00 3F
16/FD54: 82 00 00 BF
16/FD58: 80 10 F8 7F
16/FD5C: 80 F0 00 3F
16/FD60: 80 F0 F8 3F
16/FD64: 80 10 00 7F

16/FD68: 80 80 82 82 3F 7F 7F 3F 3F 3F 3F 3F

; battle messages that wait for keypress
16/FD74: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
16/FD84: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01
16/FD94: 01 01 00 01 00 00 00 00 00 00 00 00 00 00 00 00
16/FDA4: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00

; pointers to battle bg graphics (+$1C0000)
16/FDB4: A800 ABC0 AF08 B250 B520 B880 BB38 BD90
16/FDC4: C030 C2D0 C570 C810 CAB0 CD50 CFF0 D290
16/FDD4: D530

; menu tilemap vram transfer data (init)
;  +$00 source
;  +$02 destination (vram)
;  +$04 size
16/FDD6: BE66 7000 0340  ; 0: main window (13 rows)
16/FDDC: C1A6 71A0 0340  ; 1: battle command window (13 rows)
16/FDE2: C4E6 7400 0400  ; 2: inventory 1 (16 rows)
16/FDE8: C8E6 7600 0400  ; 3: inventory 2 (16 rows)
16/FDEE: CCE6 7C00 04C0  ; 4: inventory 3 (19 rows)
16/FDF4: D1A6 7800 01C0  ; 5: equipped items (7 rows)
16/FDFA: D366 5E60 0340  ; 6: mp cost, row, defend (bg2, 13 rows)
16/FE00: D6A6 7980 0340  ; 7: status window (13 rows)
16/FE06: DBE6 7E80 0100  ; 8: pause window (4 rows)

; menu tilemap vram transfer data (update)
;  +$00 source
;  +$02 destination (vram)
;  +$04 size
16/FE0C: BEA6 7020 0280  ; 0: main window (10 rows)
16/FE12: C1E6 71C0 0280  ; 1: battle command window (10 rows)
16/FE18: C526 7420 0400  ; 2: spell list (16 rows)
16/FE1E: C4E6 7400 0400  ; 3: inventory 1 (16 rows)
16/FE24: C8E6 7600 0400  ; 4: inventory 2 (16 rows)
16/FE2A: CCE6 7C00 0440  ; 5: inventory 3 (17 rows)
16/FE30: D366 5E60 0140  ; 6: mp cost (bg2, 5 rows)
16/FE36: D1A6 7800 01C0  ; 7: equipped items (7 rows)
16/FE3C: D6E6 79A0 0280  ; 8: status window (10 rows)

; main menu text update data
;   $00: width
;   $01: height
;  +$02: text buffer
;  +$04: tilemap buffer
16/FE42: 14 08 BB1E BEAA  ; 0: monster names
16/FE48: 0C 0A B966 BEC2  ; 1: character names
16/FE4E: 12 0A B9DE BED0  ; 2: character hp
16/FE54: 0A 0A 8CB2 C1F4  ; 3: battle commands

; menu window data -> $EF56 (13 * 6 bytes)
;   $00: x position
;   $01: y position
;   $02: width
;   $03: height
16/FE5A: 01 00 0C 0D C1A6  ; 0: monster names
16/FE60: 0D 00 12 0D C1A6  ; 1: character names and hp
16/FE66: 06 00 07 0D C1A6  ; 2: battle commands
16/FE6C: 01 00 0C 0D BE66  ; 3: monster names
16/FE72: 0D 00 12 0D BE66  ; 4: character names and hp
16/FE78: 01 00 1E 33 C4E6  ; 5: inventory
16/FE7E: 01 00 1E 07 D1A6  ; 6: equipped items
16/FE84: 16 00 09 08 D366  ; 7: mp cost
16/FE8A: 00 09 06 04 D366  ; 8: defend
16/FE90: 1A 09 06 04 D366  ; 9: row
16/FE96: 01 00 13 0D D6A6  ; A: character names and hp
16/FE9C: 14 00 0B 0D D6A6  ; B: status
16/FEA2: 0C 00 09 03 DBE6  ; C: pause

; pause window text
16/FEA8: 51 42 56 54 46  ; "PAUSE"

; pointers to battle command text buffers
16/FEAD: 8CB2 8D16 8D7A 8DDE 8E42

; pointers to battle command data
16/FEB7: 3302 331E 333A 3356 3372

; pointers to equipped item text buffer
16/FEC1: BC86 BCE6 BD46 BDA6 BE06

; pointers to equipped item data
16/FECB: 32DA 32E2 32EA 32F2 32FA

; right/left hand text

; no main hand
16/FED5: FF C0 FF C0 FF A9 90 8C 9C FF  ;  (right hand)
16/FEDF: FF C0 FF FF C0 A4 99 B1 8C 9C  ;  (left hand)
; left handed
16/FEE9: FF C0 FF C0 FF A9 90 8C 9C FF  ;  (right hand)
16/FEF3: FF FF FF C0 FF 90 90 8C 9C FF  ;  (main hand)
; right handed
16/FEFD: FF FF FF C0 FF 90 90 8C 9C FF  ;  (main hand)
16/FF07: FF C0 FF FF C0 A4 99 B1 8C 9C  ;  (left hand)
; ambidextrous
16/FF11: FF FF FF C0 FF 90 90 8C 9C FF  ;  (main hand)
16/FF1B: FF FF FF C0 FF 90 90 8C 9C FF  ;  (main hand)

; pointers to right/left hand text buffers
16/FF25: BBBE BBE6 BC0E BC36 BC5E

; pointers to spell list text buffers
16/FF2F: 97A6 9E66 A526 ABE6 B2A6

; pointers to spell lists
16/FF39: 2C7A 2D9A 2EBA 2FDA 30FA

; battle menu text buffer data
16/FF43: 74FD BB1E 0A 00  ; monster names
16/FF49: 74FD B966 06 00  ; character names
16/FF4F: 74FD B9DE 09 00  ; character hp
16/FF55: 74FD BA92 07 02  ; character mp

; pointers to battle menu text
16/FF5B: FF63 FF7B FF8A FFA8

; battle menu text

; 0: monster names and counts
16/FF63: 0C 00 FF 0D 00 01
16/FF69: 0C 01 FF 0D 01 01
16/FF6F: 0C 02 FF 0D 02 01
16/FF75: 0C 03 FF 0D 03 01

; 1: character names
16/FF7B: 02 01 01
16/FF7E: 02 03 01
16/FF81: 02 00 01
16/FF84: 02 04 01
16/FF87: 02 02 01

; 2: character current/max hp
16/FF8A: 08 01 C7 08 02 01
16/FF90: 0A 01 C7 0A 02 01
16/FF96: 07 01 C7 07 02 01
16/FF9C: 0B 01 C7 0B 02 01
16/FFA2: 09 01 C7 09 02 01

; 3: character current/max mp
16/FFA8: 07 03 DD 07 04 01
16/FFAE: 08 03 DD 08 04 01
16/FFB4: 09 03 DD 09 04 01
16/FFBA: 0A 03 DD 0A 04 01
16/FFC0: 0B 03 DD 0B 04 00

; battle palette animation data
16/FFC6: 00 00 09 08 08 0A 08 0B 09 0B 0A 0B 0F 08 0C 0C
16/FFD6: 0C 0A 13 13 08 08 08 16 05 06 05 0E 08 14 09 12

16/FFE6: E8 3F E6 3F E6 BF E6 BF

16/FFEE: 30 18 20 28

16/FFF2: 0C 02 10 08 00 00 18 00 10 00 00 00

16/FFFE: FF FF

; --------------------------------------------------------------------------

1E/FC28: A5 E2        LDA $E2
1E/FC2A: C9 11        CMP #$11
1E/FC2C: F0 12        BEQ $FC40
1E/FC2E: A9 0A        LDA #$0A
1E/FC30: 85 45        STA $45
1E/FC32: AD B2 1B     LDA $1BB2
1E/FC35: 3A           DEC 
1E/FC36: 48           PHA 
1E/FC37: 20 58 FC     JSR $FC58
1E/FC3A: 68           PLA 
1E/FC3B: 1A           INC 
1E/FC3C: C6 45        DEC $45
1E/FC3E: D0 F6        BNE $FC36
1E/FC40: 6B           RTL 

; [  ]

1E/FC41: A5 E2        LDA $E2
1E/FC43: C9 11        CMP #$11
1E/FC45: F0 10        BEQ $FC57
1E/FC47: AD B2 1B     LDA $1BB2
1E/FC4A: 3A           DEC 
1E/FC4B: 20 58 FC     JSR $FC58
1E/FC4E: AD B2 1B     LDA $1BB2
1E/FC51: 18           CLC 
1E/FC52: 69 08        ADC #$08
1E/FC54: 20 58 FC     JSR $FC58
1E/FC57: 6B           RTL 

1E/FC58: 85 43        STA $43
1E/FC5A: C2 20        REP #$20
1E/FC5C: A5 43        LDA $43
1E/FC5E: EB           XBA 
1E/FC5F: 4A           LSR 
1E/FC60: 48           PHA 
1E/FC61: 18           CLC 
1E/FC62: 29 FF 1F     AND #$1FFF
1E/FC65: 18           CLC 
1E/FC66: 69 00 A6     ADC #$A600
1E/FC69: AA           TAX 
1E/FC6A: 68           PLA 
1E/FC6B: 18           CLC 
1E/FC6C: 29 FF 0F     AND #$0FFF
1E/FC6F: 18           CLC 
1E/FC70: 69 00 C6     ADC #$C600
1E/FC73: A8           TAY 
1E/FC74: A9 7F 00     LDA #$007F
1E/FC77: 54 7E 7E     MVN $7E,$7E
1E/FC7A: E2 20        SEP #$20
1E/FC7C: 60           RTS 

1E/FC7D: 08 08 60 02
1E/FC81: 10 08 61 02
1E/FC85: 18 08 64 02
1E/FC89: 20 08 65 02
1E/FC8D: 08 10 62 02
1E/FC91: 10 10 63 02
1E/FC95: 18 10 66 02
1E/FC99: 20 10 67 02
1E/FC9D: 08 18 68 02
1E/FCA1: 10 18 69 02
1E/FCA5: 18 18 6C 02
1E/FCA9: 20 18 6D 02
1E/FCAD: 08 20 6A 02
1E/FCB1: 10 20 6B 02
1E/FCB5: 18 20 6E 02
1E/FCB9: 20 20 6F 02

1E/FCBD: E8C0 E8C0 EA40 EA40 EBC0 EBC0 EBC0 EBC0

; [ init hardware registers ]

1E/FCCD: A9 02        LDA #$02
1E/FCCF: 85 01        STA $01
1E/FCD1: A9 00        LDA #$00
1E/FCD3: 85 02        STA $02
1E/FCD5: 85 03        STA $03
1E/FCD7: 85 05        STA $05
1E/FCD9: 85 06        STA $06
1E/FCDB: A9 62        LDA #$62
1E/FCDD: 85 07        STA $07
1E/FCDF: A9 6A        LDA #$6A
1E/FCE1: 85 08        STA $08
1E/FCE3: A9 72        LDA #$72
1E/FCE5: 85 09        STA $09
1E/FCE7: A9 7A        LDA #$7A
1E/FCE9: 85 0A        STA $0A
1E/FCEB: A9 22        LDA #$22
1E/FCED: 85 0B        STA $0B
1E/FCEF: A9 22        LDA #$22
1E/FCF1: 85 0C        STA $0C
1E/FCF3: A9 00        LDA #$00
1E/FCF5: 8D 0B 42     STA $420B
1E/FCF8: 8D 0C 42     STA $420C
1E/FCFB: A9 80        LDA #$80
1E/FCFD: 85 15        STA $15
1E/FCFF: 7B           TDC 
1E/FD00: 85 16        STA $16
1E/FD02: 85 17        STA $17
1E/FD04: A9 1F        LDA #$1F
1E/FD06: 85 2C        STA $2C
1E/FD08: 7B           TDC 
1E/FD09: 85 2D        STA $2D
1E/FD0B: 85 2E        STA $2E
1E/FD0D: 85 2F        STA $2F
1E/FD0F: 85 30        STA $30
1E/FD11: 85 31        STA $31
1E/FD13: 85 33        STA $33
1E/FD15: A9 E0        LDA #$E0
1E/FD17: 85 32        STA $32
1E/FD19: 6B           RTL 

; [  ]

1E/FD1A: C2 20        REP #$20
1E/FD1C: A2 D0 87     LDX #$87D0
1E/FD1F: A0 00 A0     LDY #$A000
1E/FD22: A9 1F 00     LDA #$001F
1E/FD25: 54 7E 0D     MVN $7E,$0D
1E/FD28: A2 D0 87     LDX #$87D0
1E/FD2B: A0 40 A0     LDY #$A040
1E/FD2E: A9 1F 00     LDA #$001F
1E/FD31: 54 7E 0D     MVN $7E,$0D
1E/FD34: A2 D0 87     LDX #$87D0
1E/FD37: A0 80 A0     LDY #$A080
1E/FD3A: A9 1F 00     LDA #$001F
1E/FD3D: 54 7E 0D     MVN $7E,$0D
1E/FD40: A2 D0 87     LDX #$87D0
1E/FD43: A0 C0 A0     LDY #$A0C0
1E/FD46: A9 1F 00     LDA #$001F
1E/FD49: 54 7E 0D     MVN $7E,$0D
1E/FD4C: A2 D0 87     LDX #$87D0
1E/FD4F: A0 60 A0     LDY #$A060
1E/FD52: A9 07 00     LDA #$0007
1E/FD55: 54 7E 0D     MVN $7E,$0D
1E/FD58: E2 20        SEP #$20
1E/FD5A: 6B           RTL 

1E/FD5B: 20 84 FE     JSR $FE84       ; tax
1E/FD5E: BF 66 FD 1E  LDA $1EFD66,X
1E/FD62: 5C 5C 87 01  JML $01875C     ; play sound effect

1E/FD66: 58 58 58 58 66 27 27 58 58 3D 1F 58 58

; ppu address for character graphics
1E/FD73: 4800 4B00 4E00 5100 5400

1E/FD7D: 039E 019E 059E 029E 049E 0384 0184 0584
1E/FD8D: 0284 0484

; [ get pointer to magic menu cursor positions ]

1E/FD91: A5 E8        LDA $E8         ; character id
1E/FD93: 0A           ASL 
1E/FD94: 85 45        STA $45         ; multiply by 6
1E/FD96: 0A           ASL 
1E/FD97: 65 45        ADC $45
1E/FD99: 4C 84 FE     JMP $FE84       ; tax

; [ load magic menu cursor positions ]

1E/FD9C: 20 91 FD     JSR $FD91
1E/FD9F: C2 20        REP #$20
1E/FDA1: BD CD 1B     LDA $1BCD,X
1E/FDA4: 8D 81 1B     STA $1B81
1E/FDA7: BD CF 1B     LDA $1BCF,X
1E/FDAA: 8D 83 1B     STA $1B83
1E/FDAD: BD D1 1B     LDA $1BD1,X
1E/FDB0: 8D 85 1B     STA $1B85
1E/FDB3: E2 20        SEP #$20
1E/FDB5: 6B           RTL 

; [ save magic menu cursor positions ]

1E/FDB6: 20 91 FD     JSR $FD91
1E/FDB9: C2 20        REP #$20
1E/FDBB: AD 81 1B     LDA $1B81
1E/FDBE: 9D CD 1B     STA $1BCD,X
1E/FDC1: AD 83 1B     LDA $1B83
1E/FDC4: 9D CF 1B     STA $1BCF,X
1E/FDC7: AD 85 1B     LDA $1B85
1E/FDCA: 9D D1 1B     STA $1BD1,X
1E/FDCD: E2 20        SEP #$20
1E/FDCF: 6B           RTL 

; [  ]

1E/FDD0: A5 D9        LDA $D9
1E/FDD2: 20 93 FD     JSR $FD93
1E/FDD5: 9B           TXY 
1E/FDD6: A5 DA        LDA $DA
1E/FDD8: 20 93 FD     JSR $FD93
1E/FDDB: C2 20        REP #$20
1E/FDDD: BD CD 1B     LDA $1BCD,X
1E/FDE0: 48           PHA 
1E/FDE1: BD CF 1B     LDA $1BCF,X
1E/FDE4: 48           PHA 
1E/FDE5: BD D1 1B     LDA $1BD1,X
1E/FDE8: 48           PHA 
1E/FDE9: B9 CD 1B     LDA $1BCD,Y
1E/FDEC: 9D CD 1B     STA $1BCD,X
1E/FDEF: B9 CF 1B     LDA $1BCF,Y
1E/FDF2: 9D CF 1B     STA $1BCF,X
1E/FDF5: B9 D1 1B     LDA $1BD1,Y
1E/FDF8: 9D D1 1B     STA $1BD1,X
1E/FDFB: 68           PLA 
1E/FDFC: 99 D1 1B     STA $1BD1,Y
1E/FDFF: 68           PLA 
1E/FE00: 99 CF 1B     STA $1BCF,Y
1E/FE03: 68           PLA 
1E/FE04: 99 CD 1B     STA $1BCD,Y
1E/FE07: E2 20        SEP #$20
1E/FE09: 6B           RTL 

; portrait positions (10 * 2 bytes)
1E/FE0A: 10 60
1E/FE0C: 10 10
1E/FE0E: 10 B0
1E/FE10: 18 38
1E/FE12: 18 88

1E/FE14: 18 60
1E/FE16: 18 10
1E/FE18: 18 B0
1E/FE1A: 10 38
1E/FE1C: 10 88

; dakuten table (menu)
; 2 bytes each, kana then dakuten
1E/FE1E:                                           CC C0
1E/FE20: 8F C0 90 C0 91 C0 92 C0 93 C0 94 C0 95 C0 96 C0  ; $10
1E/FE30: 97 C0 98 C0 99 C0 9A C0 9B C0 9C C0 9D C0 A3 C0
1E/FE40: A4 C0 A5 C0 A6 C0 A7 C0 A3 C1 A4 C1 A5 C1 A6 C1  ; $20
1E/FE50: A7 C1 CF C0 D0 C0 D1 C0 D2 C0 D3 C0 D4 C0 D5 C0
1E/FE60: D6 C0 D7 C0 D8 C0 D9 C0 DA C0 DB C0 DC C0 DD C0  ; $30
1E/FE70: E3 C0 E4 C0 E5 C0 E6 C0 E7 C0 E3 C1 E4 C1 E5 C1
1E/FE80: E6 C1 E7 C1                                      ; $40

; [ tax ]

1E/FE84: 85 43        STA $43
1E/FE86: A6 43        LDX $43
1E/FE88: 60           RTS 

1E/FE89: 20 00 70 20 88 30 88 30 88 30 88 30 70 00 20 00
1E/FE99: 00 00 00 00 50 00 50 00 50 00 50 00 20 00 00 00

; portrait positions for spell target select
1E/FEA9: 58 68 58 18 58 B8 60 40 60 90  ; 3 front/2 back
1E/FEB3: 60 68 60 18 60 B8 58 40 58 90  ; 2 front/3 back

1E/FEBD: 6C 02 5A 02 48 02

; status mask for items $D5-$DD
1E/FEC3: BF FF DF FF EF FF F7 FF FB FF FD FF FE FF FF 7F

1E/FED3:          FF FF FF FF FF FF FF FF FF FF FF FF FF

; --------------------------------------------------------------------------
